% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
% 中文支持
\usepackage{xeCJK}
\setCJKmainfont{Noto Serif CJK SC}
\setCJKsansfont{Noto Sans CJK SC} 
\setCJKmonofont{Noto Sans Mono CJK SC}

% 页面设置
\usepackage[top=2.5cm, bottom=2.5cm, left=3cm, right=3cm]{geometry}

% 数学支持
\usepackage{amsmath,amssymb,amsthm}
\usepackage{bm}

% 章节标题样式
\usepackage{titlesec}
\titleformat{\chapter}[display]
  {\normalfont\Huge\bfseries\filcenter}{\chaptertitlename\ \thechapter}{20pt}{\Huge}
\titleformat{\section}
  {\normalfont\Large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}
  {\normalfont\large\bfseries}{\thesubsection}{1em}{}

% 图表标题
\usepackage{caption}
\DeclareCaptionFont{heiti}{\CJKfamily{hei}}
\captionsetup{font=small,labelsep=quad}

% 超链接
\usepackage{hyperref}
\hypersetup{
  colorlinks=true,
  linkcolor=blue,
  filecolor=magenta,      
  urlcolor=cyan,
  pdftitle={生态统计学},
  pdfauthor={沈国春、李勤}
}

% 代码环境
\usepackage{listings}
\lstset{
  basicstyle=\small\ttfamily,
  breaklines=true,
  frame=single,
  numbers=left,
  numberstyle=\tiny,
  stepnumber=1,
  numbersep=5pt
}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{apalike}
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={生态统计学},
  pdfauthor={沈国春、李勤},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{生态统计学}
\author{沈国春、李勤}
\date{2025-09-15}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{ux524dux8a00}{%
\chapter*{前言}\label{ux524dux8a00}}
\addcontentsline{toc}{chapter}{前言}

这是一本关于生态统计学的教材，旨在为生态学研究者提供实用的数据分析方法。本书结合R语言，介绍生态学研究中常用的统计方法。

本书特点：

\begin{itemize}
\tightlist
\item
  面向生态学研究实际问题
\item
  基于R语言实现
\item
  包含大量生态数据案例
\item
  循序渐进的教学安排
\end{itemize}

本书使用以下R包：

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\FunctionTok{c}\NormalTok{(}
  \StringTok{"tidyverse"}\NormalTok{, }\StringTok{"vegan"}\NormalTok{, }\StringTok{"lme4"}\NormalTok{, }\StringTok{"ggplot2"}\NormalTok{, }
  \StringTok{"bookdown"}\NormalTok{, }\StringTok{"knitr"}\NormalTok{, }\StringTok{"rmarkdown"}
\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux8bfeux7a0bux5728ux7ebfux8d44ux6e90}{%
\section{课程在线资源}\label{ux8bfeux7a0bux5728ux7ebfux8d44ux6e90}}

课程简明手册

\begin{itemize}
\tightlist
\item
  网页版 \url{https://guochunshen.github.io/ecological-statistics}
\item
  PDF版 \url{https://gitee.com/gcshen/ecological-statistics/blob/master/docs/ecological-statistics.pdf}
\item
  原代码 \url{https://gitee.com/gcshen/ecological-statistics}
\end{itemize}

\hypertarget{ux5b66ux4e60ux65b9ux5f0f}{%
\section{学习方式}\label{ux5b66ux4e60ux65b9ux5f0f}}

\includegraphics{imgs/how to learn R.png}

\includegraphics{imgs/how to learn R 2.png}

\hypertarget{ux7edfux8ba1ux7f16ux7a0bux57faux7840}{%
\chapter{统计编程基础}\label{ux7edfux8ba1ux7f16ux7a0bux57faux7840}}

\hypertarget{rux8bedux8a00ux4ecbux7ecd}{%
\section{R语言介绍}\label{rux8bedux8a00ux4ecbux7ecd}}

\begin{itemize}
\tightlist
\item
  理解为什么生态学专业需要学习R语言
\item
  掌握R和RStudio的安装和配置
\item
  建立良好的项目文件组织习惯
\item
  了解R包管理的基本方法
\end{itemize}

\hypertarget{ux4e3aux4ec0ux4e48ux751fux6001ux5b66ux4e13ux4e1aux9700ux8981ux5b66ux4e60r}{%
\subsection{为什么生态学专业需要学习R？}\label{ux4e3aux4ec0ux4e48ux751fux6001ux5b66ux4e13ux4e1aux9700ux8981ux5b66ux4e60r}}

\hypertarget{ux6570ux636eux5206ux6790ux80fdux529bux7684ux5fc5ux8981ux6027}{%
\subsubsection{数据分析能力的必要性}\label{ux6570ux636eux5206ux6790ux80fdux529bux7684ux5fc5ux8981ux6027}}

现代生态学研究产生海量数据：野外调查数据、实验室测量数据、遥感影像数据、基因序列数据等。传统的Excel已无法满足复杂的统计分析需求，而R语言提供了完整的数据科学工具链。

\hypertarget{ux53efux91cdux73b0ux7814ux7a76ux7684ux79d1ux5b66ux8981ux6c42}{%
\subsubsection{可重现研究的科学要求}\label{ux53efux91cdux73b0ux7814ux7a76ux7684ux79d1ux5b66ux8981ux6c42}}

\begin{itemize}
\tightlist
\item
  \textbf{重现性危机}：越来越多的科学研究无法被重现，影响科学可信度
\item
  \textbf{R脚本的优势}：

  \begin{itemize}
  \tightlist
  \item
    每一步分析都有记录，任何人都可以重现你的分析过程
  \item
    错误检查：代码可以被审查，减少人为错误
  \item
    版本控制：分析过程的每次修改都有记录
  \end{itemize}
\end{itemize}

\hypertarget{ux804cux4e1aux53d1ux5c55ux7684ux6838ux5fc3ux7adeux4e89ux529b}{%
\subsubsection{职业发展的核心竞争力}\label{ux804cux4e1aux53d1ux5c55ux7684ux6838ux5fc3ux7adeux4e89ux529b}}

\begin{itemize}
\tightlist
\item
  \textbf{学术界要求}：顶级期刊越来越要求提供数据和代码
\item
  \textbf{就业市场需求}：环保部门、研究院所、咨询公司都需要数据分析能力
\item
  \textbf{跨学科合作}：与计算机科学、统计学等领域合作的桥梁
\item
  \textbf{终身学习}：编程思维有助于快速学习新的分析方法
\end{itemize}

\hypertarget{ux5f00ux6e90ux514dux8d39ux7684ux7ecfux6d4eux4f18ux52bf}{%
\subsubsection{开源免费的经济优势}\label{ux5f00ux6e90ux514dux8d39ux7684ux7ecfux6d4eux4f18ux52bf}}

\begin{itemize}
\tightlist
\item
  \textbf{成本优势}：SPSS单机版数万元，SAS更昂贵，R完全免费
\item
  \textbf{功能更新}：商业软件更新缓慢，R社区每天都有新功能
\item
  \textbf{全球社区}：遇到问题可以在全球社区寻求帮助
\item
  \textbf{未来保障}：开源软件不会因为公司倒闭而消失
\end{itemize}

\hypertarget{ux5b66ux672fux53d1ux8868ux7684ux5fc5ux8981ux5de5ux5177}{%
\subsubsection{学术发表的必要工具}\label{ux5b66ux672fux53d1ux8868ux7684ux5fc5ux8981ux5de5ux5177}}

\begin{itemize}
\tightlist
\item
  \textbf{期刊要求}：Nature、Science等顶级期刊要求提供分析代码
\item
  \textbf{同行评议}：审稿人可以检查你的分析方法是否正确
\item
  \textbf{引用优势}：提供代码的论文被引用次数更高
\item
  \textbf{学术诚信}：透明的分析过程展现严谨的科学态度
\end{itemize}

\hypertarget{ux56fdux9645ux4ea4ux6d41ux7684ux901aux7528ux8bedux8a00}{%
\subsubsection{国际交流的通用语言}\label{ux56fdux9645ux4ea4ux6d41ux7684ux901aux7528ux8bedux8a00}}

\begin{itemize}
\tightlist
\item
  \textbf{国际会议}：生态学国际会议上，R是数据分析的主流工具
\item
  \textbf{合作研究}：与国外学者合作时，R是共同的工作语言
\item
  \textbf{在线学习}：全球最优秀的生态学分析教程都使用R
\item
  \textbf{职业流动}：掌握R可以在全球范围内寻求工作机会
\end{itemize}

\hypertarget{rux8bedux8a00ux7b80ux4ecbux4e0eux8da3ux5473ux5e94ux7528}{%
\subsection{R语言简介与趣味应用}\label{rux8bedux8a00ux7b80ux4ecbux4e0eux8da3ux5473ux5e94ux7528}}

\hypertarget{ux4ec0ux4e48ux662frux8bedux8a00}{%
\subsubsection{什么是R语言？}\label{ux4ec0ux4e48ux662frux8bedux8a00}}

\begin{itemize}
\tightlist
\item
  \textbf{统计计算语言}：专门为统计分析和数据可视化设计的编程语言
\item
  \textbf{开源免费}：由全球统计学家共同维护发展
\item
  \textbf{交互式环境}：可以立即看到代码执行结果
\item
  \textbf{扩展性强}：超过18,000个专业扩展包
\end{itemize}

\hypertarget{ux5982ux4f55ux83b7ux53d6ux5e2eux52a9}{%
\subsubsection{如何获取帮助？}\label{ux5982ux4f55ux83b7ux53d6ux5e2eux52a9}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 查看函数帮助文档}
\NormalTok{?plot}
\FunctionTok{help}\NormalTok{(}\StringTok{"plot"}\NormalTok{)}

\CommentTok{\# 搜索帮助文档}
\NormalTok{??}\StringTok{"regression"}

\CommentTok{\# 示例代码演示}
\FunctionTok{example}\NormalTok{(plot)}
\FunctionTok{example}\NormalTok{(lm)}
\FunctionTok{demo}\NormalTok{(persp)}
\FunctionTok{demo}\NormalTok{(graphics)}
\FunctionTok{demo}\NormalTok{(Hershey)}
\FunctionTok{demo}\NormalTok{(plotmath)}


\CommentTok{\# 在线资源：}
\CommentTok{\# {-} R官方文档：https://cran.r{-}project.org/manuals.html}
\CommentTok{\# {-} RStudio社区：https://community.rstudio.com}
\end{Highlighting}
\end{Shaded}

\hypertarget{rux8bedux8a00ux7684ux8da3ux5473ux5e94ux7528ux793aux4f8b}{%
\subsubsection{R语言的趣味应用示例}\label{rux8bedux8a00ux7684ux8da3ux5473ux5e94ux7528ux793aux4f8b}}

\hypertarget{ux751fux6001ux6570ux636eux52a8ux6001ux53efux89c6ux5316}{%
\paragraph{生态数据动态可视化}\label{ux751fux6001ux6570ux636eux52a8ux6001ux53efux89c6ux5316}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 安装必要包(首次需要)}
\FunctionTok{install.packages}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"ggplot2"}\NormalTok{, }\StringTok{"gganimate"}\NormalTok{, }\StringTok{"gapminder"}\NormalTok{))}
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(gganimate)}
\FunctionTok{library}\NormalTok{(gapminder)}

\CommentTok{\# 使用gapminder数据集(包含各国多年生态经济数据)}
\CommentTok{\# 绘制动态变化图}
\NormalTok{fig }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(gapminder, }\FunctionTok{aes}\NormalTok{(gdpPercap, lifeExp, }\AttributeTok{size =}\NormalTok{ pop, }\AttributeTok{color =}\NormalTok{ continent)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_size}\NormalTok{(}\AttributeTok{range =} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{12}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_log10}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{\textquotesingle{}年份: \{frame\_time\}\textquotesingle{}}\NormalTok{, }\AttributeTok{x =} \StringTok{\textquotesingle{}人均GDP\textquotesingle{}}\NormalTok{, }\AttributeTok{y =} \StringTok{\textquotesingle{}预期寿命\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{transition\_time}\NormalTok{(year) }\SpecialCharTok{+}
  \FunctionTok{ease\_aes}\NormalTok{(}\StringTok{\textquotesingle{}linear\textquotesingle{}}\NormalTok{)}

\CommentTok{\# 渲染并保存动画}
\CommentTok{\# 需要先安装gifski包: install.packages("gifski")}
\FunctionTok{animate}\NormalTok{(fig, }\AttributeTok{renderer =} \FunctionTok{gifski\_renderer}\NormalTok{(}\StringTok{"./imgs/gapminder\_animation.gif"}\NormalTok{), }
        \AttributeTok{width =} \DecValTok{800}\NormalTok{, }\AttributeTok{height =} \DecValTok{600}\NormalTok{, }\AttributeTok{fps =} \DecValTok{10}\NormalTok{, }\AttributeTok{duration =} \DecValTok{15}\NormalTok{)}

\CommentTok{\# 提示：运行后会生成展示生态经济数据随时间变化的动画}
\CommentTok{\# 可以清楚地看到不同大陆国家生态经济指标的变化趋势}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux7535ux5b50ux6c34ux6bcd}{%
\subsubsection{电子水母}\label{ux7535ux5b50ux6c34ux6bcd}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 加载必要的包}
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(gganimate) }\CommentTok{\# 用于创建动画}
\FunctionTok{library}\NormalTok{(dplyr)     }\CommentTok{\# 用于数据处理}

\CommentTok{\# 设置参数 {-} 减少点数提高性能}
\NormalTok{i }\OtherTok{\textless{}{-}} \DecValTok{0}\SpecialCharTok{:}\DecValTok{2000}  \CommentTok{\# 从10000减少到2000个点}
\NormalTok{x }\OtherTok{\textless{}{-}}\NormalTok{ i }\SpecialCharTok{\%\%} \DecValTok{200}      \CommentTok{\# R中的模运算}
\NormalTok{y }\OtherTok{\textless{}{-}}\NormalTok{ i }\SpecialCharTok{/} \DecValTok{43}

\CommentTok{\# 预计算固定变量（不依赖于t）}
\NormalTok{k }\OtherTok{\textless{}{-}} \DecValTok{5} \SpecialCharTok{*} \FunctionTok{cos}\NormalTok{(x}\SpecialCharTok{/}\DecValTok{14}\NormalTok{) }\SpecialCharTok{*} \FunctionTok{cos}\NormalTok{(y}\SpecialCharTok{/}\DecValTok{30}\NormalTok{)}
\NormalTok{e }\OtherTok{\textless{}{-}}\NormalTok{ y}\SpecialCharTok{/}\DecValTok{8} \SpecialCharTok{{-}} \DecValTok{13}
\NormalTok{d }\OtherTok{\textless{}{-}}\NormalTok{ (k}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{+}\NormalTok{ e}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}\SpecialCharTok{/}\DecValTok{59} \SpecialCharTok{+} \DecValTok{4}
\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{atan2}\NormalTok{(k, e)   }\CommentTok{\# 注意R中atan2的参数顺序是(y,x)}

\CommentTok{\# 预计算所有帧数据（向量化操作）}
\NormalTok{t\_values }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{10} \SpecialCharTok{*}\NormalTok{ pi, }\AttributeTok{by =}\NormalTok{ pi }\SpecialCharTok{/} \DecValTok{10}\NormalTok{)  }\CommentTok{\# 减少帧数：从20π到10π，步长从π/20到π/10}

\CommentTok{\# 使用矩阵运算代替循环}
\NormalTok{c\_val\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{outer}\NormalTok{(d }\SpecialCharTok{/} \DecValTok{2} \SpecialCharTok{+}\NormalTok{ e }\SpecialCharTok{/} \DecValTok{99}\NormalTok{, }\SpecialCharTok{{-}}\NormalTok{t\_values }\SpecialCharTok{/} \DecValTok{18}\NormalTok{, }\StringTok{"+"}\NormalTok{)}
\NormalTok{q\_matrix }\OtherTok{\textless{}{-}} \DecValTok{60} \SpecialCharTok{{-}} \DecValTok{3} \SpecialCharTok{*} \FunctionTok{sin}\NormalTok{(a }\SpecialCharTok{*}\NormalTok{ e) }\SpecialCharTok{+} \FunctionTok{outer}\NormalTok{(k }\SpecialCharTok{*}\NormalTok{ (}\DecValTok{3} \SpecialCharTok{+} \DecValTok{4} \SpecialCharTok{/}\NormalTok{ d), }\FunctionTok{sin}\NormalTok{(d }\SpecialCharTok{\^{}} \DecValTok{2} \SpecialCharTok{{-}} \DecValTok{2} \SpecialCharTok{*}\NormalTok{ t\_values), }\StringTok{"*"}\NormalTok{)}

\NormalTok{x\_matrix }\OtherTok{\textless{}{-}}\NormalTok{ q\_matrix }\SpecialCharTok{*} \FunctionTok{sin}\NormalTok{(c\_val\_matrix) }\SpecialCharTok{+} \DecValTok{200}
\NormalTok{y\_matrix }\OtherTok{\textless{}{-}}\NormalTok{ (q\_matrix }\SpecialCharTok{+} \DecValTok{9} \SpecialCharTok{*}\NormalTok{ d) }\SpecialCharTok{*} \FunctionTok{cos}\NormalTok{(c\_val\_matrix) }\SpecialCharTok{+} \DecValTok{200}

\CommentTok{\# 创建数据框（更高效的方式）}
\NormalTok{all\_frames }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{t =} \FunctionTok{rep}\NormalTok{(t\_values, }\AttributeTok{each =} \FunctionTok{length}\NormalTok{(i)),}
  \AttributeTok{X =} \FunctionTok{as.vector}\NormalTok{(x\_matrix),}
  \AttributeTok{Y =} \FunctionTok{as.vector}\NormalTok{(y\_matrix)}
\NormalTok{)}

\CommentTok{\# 创建动画}
\NormalTok{anim }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(all\_frames, }\FunctionTok{aes}\NormalTok{(X, Y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \FloatTok{0.2}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.2}\NormalTok{, }\AttributeTok{color =} \StringTok{"white"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_void}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{plot.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill =} \StringTok{"black"}\NormalTok{, }\AttributeTok{color =} \ConstantTok{NA}\NormalTok{),}
        \AttributeTok{panel.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{fill =} \StringTok{"black"}\NormalTok{, }\AttributeTok{color =} \ConstantTok{NA}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{xlim =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{400}\NormalTok{), }\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{400}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{transition\_time}\NormalTok{(t) }\SpecialCharTok{+}
  \FunctionTok{shadow\_mark}\NormalTok{(}\AttributeTok{past =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.05}\NormalTok{)  }\CommentTok{\# 保留轨迹痕迹}

\CommentTok{\# 渲染动画（可能需要几分钟时间）}
\FunctionTok{animate}\NormalTok{(anim, }
        \AttributeTok{fps =} \DecValTok{20}\NormalTok{, }
        \AttributeTok{duration =} \DecValTok{30}\NormalTok{, }
        \AttributeTok{width =} \DecValTok{900}\NormalTok{, }
        \AttributeTok{height =} \DecValTok{900}\NormalTok{,}
        \AttributeTok{renderer =} \FunctionTok{gifski\_renderer}\NormalTok{())}

\CommentTok{\# 保存动画（可选）}
\CommentTok{\# anim\_save("animation.gif", animation = last\_animation())}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux751fux6210ux97f3ux4e50}{%
\paragraph{生成音乐}\label{ux751fux6210ux97f3ux4e50}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"audio"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"dplyr"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(audio)}
\FunctionTok{library}\NormalTok{(dplyr)}
\NormalTok{notes }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\AttributeTok{A =} \DecValTok{0}\NormalTok{, }\AttributeTok{B =} \DecValTok{2}\NormalTok{, }\AttributeTok{C =} \DecValTok{3}\NormalTok{, }\AttributeTok{D =} \DecValTok{5}\NormalTok{, }\AttributeTok{E =} \DecValTok{7}\NormalTok{, }\AttributeTok{F =} \DecValTok{8}\NormalTok{, }\AttributeTok{G =} \DecValTok{10}\NormalTok{)}
\NormalTok{pitch }\OtherTok{\textless{}{-}} \StringTok{"D D E D G F\# D D E D A G D D D5 B G F\# E C5 C5 B G A G"}
\NormalTok{duration }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\FloatTok{0.75}\NormalTok{, }\FloatTok{0.25}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\DecValTok{2}\NormalTok{),}
              \FloatTok{0.75}\NormalTok{, }\FloatTok{0.25}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\FloatTok{0.75}\NormalTok{, }\FloatTok{0.25}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{)}
\NormalTok{bday }\OtherTok{\textless{}{-}} \FunctionTok{data\_frame}\NormalTok{(}\AttributeTok{pitch =} \FunctionTok{strsplit}\NormalTok{(pitch, }\StringTok{" "}\NormalTok{)[[}\DecValTok{1}\NormalTok{]],}
                   \AttributeTok{duration =}\NormalTok{ duration)}

\NormalTok{bday }\OtherTok{\textless{}{-}}
\NormalTok{  bday }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{octave =} \FunctionTok{substring}\NormalTok{(pitch, }\FunctionTok{nchar}\NormalTok{(pitch)) }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  \{}\FunctionTok{suppressWarnings}\NormalTok{(}\FunctionTok{as.numeric}\NormalTok{(.))\} }\SpecialCharTok{\%\textgreater{}\%}
    \FunctionTok{ifelse}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(.), }\DecValTok{4}\NormalTok{, .),}
  \AttributeTok{note =}\NormalTok{ notes[}\FunctionTok{substr}\NormalTok{(pitch, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{)],}
  \AttributeTok{note =}\NormalTok{ note }\SpecialCharTok{+} \FunctionTok{grepl}\NormalTok{(}\StringTok{"\#"}\NormalTok{, pitch) }\SpecialCharTok{{-}}
    \FunctionTok{grepl}\NormalTok{(}\StringTok{"b"}\NormalTok{, pitch) }\SpecialCharTok{+}\NormalTok{ octave }\SpecialCharTok{*} \DecValTok{12} \SpecialCharTok{+}
    \DecValTok{12} \SpecialCharTok{*}\NormalTok{ (note }\SpecialCharTok{\textless{}} \DecValTok{3}\NormalTok{),}
  \AttributeTok{freq =} \DecValTok{2} \SpecialCharTok{\^{}}\NormalTok{ ((note }\SpecialCharTok{{-}} \DecValTok{60}\NormalTok{) }\SpecialCharTok{/} \DecValTok{12}\NormalTok{) }\SpecialCharTok{*} \DecValTok{440}\NormalTok{)}

\NormalTok{tempo }\OtherTok{\textless{}{-}} \DecValTok{120}
\NormalTok{sample\_rate }\OtherTok{\textless{}{-}} \DecValTok{44100}

\NormalTok{make\_sine }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(freq, duration) \{}
\NormalTok{  wave }\OtherTok{\textless{}{-}} \FunctionTok{sin}\NormalTok{(}\FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, duration }\SpecialCharTok{/}\NormalTok{ tempo }\SpecialCharTok{*} \DecValTok{60}\NormalTok{, }\DecValTok{1} \SpecialCharTok{/}\NormalTok{ sample\_rate) }\SpecialCharTok{*}
\NormalTok{                freq }\SpecialCharTok{*} \DecValTok{2} \SpecialCharTok{*}\NormalTok{ pi)}
\NormalTok{  fade }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{50} \SpecialCharTok{/}\NormalTok{ sample\_rate)}
\NormalTok{  wave }\SpecialCharTok{*} \FunctionTok{c}\NormalTok{(fade, }\FunctionTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, }\FunctionTok{length}\NormalTok{(wave) }\SpecialCharTok{{-}} \DecValTok{2} \SpecialCharTok{*} \FunctionTok{length}\NormalTok{(fade)), }\FunctionTok{rev}\NormalTok{(fade))}
\NormalTok{\}}

\NormalTok{bday\_wave }\OtherTok{\textless{}{-}}
  \FunctionTok{mapply}\NormalTok{(make\_sine, bday}\SpecialCharTok{$}\NormalTok{freq, bday}\SpecialCharTok{$}\NormalTok{duration) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{do.call}\NormalTok{(}\StringTok{"c"}\NormalTok{, .)}

\FunctionTok{play}\NormalTok{(bday\_wave)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux66f4ux591aux6709ux8da3ux529fux80fd}{%
\paragraph{更多有趣功能}\label{ux66f4ux591aux6709ux8da3ux529fux80fd}}

\begin{itemize}
\tightlist
\item
  \textbf{动态报告}：用R Markdown生成可交互报告
\item
  \textbf{网络爬虫}：抓取生态监测站数据
\item
  \textbf{地图绘制}：可视化物种分布
\item
  \textbf{机器学习}：预测生态变化趋势
\end{itemize}

\hypertarget{ux73afux5883ux8bbeux7f6eux548cux914dux7f6e}{%
\subsection{环境设置和配置}\label{ux73afux5883ux8bbeux7f6eux548cux914dux7f6e}}

\hypertarget{rux8bedux8a00ux5b89ux88c5}{%
\subsubsection{R语言安装}\label{rux8bedux8a00ux5b89ux88c5}}

\hypertarget{ux4e0bux8f7dux548cux5b89ux88c5r}{%
\paragraph{下载和安装R}\label{ux4e0bux8f7dux548cux5b89ux88c5r}}

\textbf{Windows系统:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  访问 \url{https://cran.r-project.org/bin/windows/base/}
\item
  下载最新版R安装包(.exe)
\item
  右键以管理员身份运行安装程序
\item
  安装路径不要包含中文或空格
\item
  勾选''创建桌面快捷方式''
\end{enumerate}

\textbf{macOS系统:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  访问 \url{https://cran.r-project.org/bin/macosx/}
\item
  下载最新版R安装包(.pkg)
\item
  双击安装，可能需要右键''打开''绕过Gatekeeper限制
\item
  或通过Homebrew安装: \texttt{brew\ install\ -\/-cask\ r}
\end{enumerate}

\textbf{Linux系统:}
- Ubuntu/Debian: \texttt{sudo\ apt-get\ install\ r-base}
- CentOS/RHEL: \texttt{sudo\ yum\ install\ R}

\hypertarget{ux4e0bux8f7dux548cux5b89ux88c5rstudio}{%
\paragraph{下载和安装RStudio}\label{ux4e0bux8f7dux548cux5b89ux88c5rstudio}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  访问 \url{https://www.rstudio.com/products/rstudio/download/}
\item
  选择适合你系统的RStudio Desktop免费版
\item
  安装注意事项:

  \begin{itemize}
  \tightlist
  \item
    Windows: 确保已安装R后再安装RStudio
  \item
    macOS: 可能需要允许来自''未识别开发者''的应用
  \item
    Linux: 可能需要安装依赖库\texttt{libssl-dev}等
  \end{itemize}
\end{enumerate}

\hypertarget{ux5e38ux89c1ux5b89ux88c5ux95eeux9898ux89e3ux51b3}{%
\paragraph{常见安装问题解决}\label{ux5e38ux89c1ux5b89ux88c5ux95eeux9898ux89e3ux51b3}}

\begin{itemize}
\item
  \textbf{中文路径问题}: 安装路径和用户名不要包含中文
\item
  \textbf{防火墙拦截}: 临时关闭防火墙或添加R/RStudio为例外
\item
  \textbf{镜像源设置}: 安装后运行:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{options}\NormalTok{(}\AttributeTok{repos =} \FunctionTok{c}\NormalTok{(}\AttributeTok{CRAN=}\StringTok{"https://mirrors.tuna.tsinghua.edu.cn/CRAN/"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}
\item
  \textbf{依赖缺失}:

  \begin{itemize}
  \tightlist
  \item
    Windows: 安装Rtools
  \item
    macOS: 安装Xcode命令行工具
  \item
    Linux: 安装开发工具链
  \end{itemize}
\end{itemize}

\hypertarget{ux9a8cux8bc1ux5b89ux88c5}{%
\paragraph{验证安装}\label{ux9a8cux8bc1ux5b89ux88c5}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 在RStudio中运行这行代码，应该显示R的版本信息}
\NormalTok{R.version.string}

\CommentTok{\# 检查基本功能是否正常}
\DecValTok{1}\SpecialCharTok{+}\DecValTok{1}
\FunctionTok{plot}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux5728vscodeux4e2dux914dux7f6erux73afux5883}{%
\paragraph{在VSCode中配置R环境}\label{ux5728vscodeux4e2dux914dux7f6erux73afux5883}}

\textbf{为什么选择VSCode？}\\
- \textbf{轻量高效}：启动速度快，占用资源少\\
- \textbf{扩展性强}：丰富的扩展生态系统\\
- \textbf{多语言支持}：同时支持R、Python、Markdown等多种语言\\
- \textbf{版本控制集成}：内置Git支持，便于代码管理\\
- \textbf{远程开发}：支持SSH、容器、WSL等远程开发环境

\textbf{VSCode安装和配置步骤：}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{安装VSCode}

  \begin{itemize}
  \tightlist
  \item
    访问 \url{https://code.visualstudio.com/}
  \item
    下载适合你操作系统的版本并安装
  \end{itemize}
\item
  \textbf{安装R扩展}

  \begin{itemize}
  \tightlist
  \item
    打开VSCode，点击左侧扩展图标（或按Ctrl+Shift+X）
  \item
    搜索 ``R'' 并安装 ``R'' 扩展（由REditorSupport开发）
  \item
    搜索 ``R Debugger'' 并安装调试器扩展
  \end{itemize}
\item
  \textbf{基本配置}

  \begin{itemize}
  \item
    打开设置（Ctrl+,）
  \item
    搜索 ``r.rterm'' 设置R执行路径
  \item
    搜索 ``r.rpath'' 设置R语言服务器路径
  \item
    推荐设置：

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{\{}
  \DataTypeTok{"r.rterm.windows"}\FunctionTok{:} \StringTok{"C:}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{Program Files}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{R}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{R{-}4.3.1}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{bin}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{x64}\CharTok{\textbackslash{}\textbackslash{}}\StringTok{R.exe"}\FunctionTok{,}
  \DataTypeTok{"r.rterm.mac"}\FunctionTok{:} \StringTok{"/usr/local/bin/R"}\FunctionTok{,}
  \DataTypeTok{"r.rterm.linux"}\FunctionTok{:} \StringTok{"/usr/bin/R"}\FunctionTok{,}
  \DataTypeTok{"r.lsp.path"}\FunctionTok{:} \StringTok{"/usr/lib/R/bin/R"}\FunctionTok{,}
  \DataTypeTok{"r.sessionWatcher"}\FunctionTok{:} \KeywordTok{true}\FunctionTok{,}
  \DataTypeTok{"r.bracketedPaste"}\FunctionTok{:} \KeywordTok{true}
\FunctionTok{\}}
\end{Highlighting}
\end{Shaded}
  \end{itemize}
\item
  \textbf{常用功能}

  \begin{itemize}
  \tightlist
  \item
    \textbf{代码执行}：Ctrl+Enter 执行当前行或选中代码
  \item
    \textbf{代码补全}：自动提供函数和参数建议
  \item
    \textbf{语法高亮}：彩色显示代码结构
  \item
    \textbf{调试功能}：设置断点，逐步调试代码
  \item
    \textbf{绘图查看}：内置绘图查看器
  \item
    \textbf{Markdown支持}：直接编写和预览R Markdown文档
  \end{itemize}
\item
  \textbf{推荐扩展}

  \begin{itemize}
  \tightlist
  \item
    \textbf{Rainbow CSV}：彩色显示CSV文件
  \item
    \textbf{GitLens}：增强的Git功能
  \item
    \textbf{Bracket Pair Colorizer}：彩色匹配括号
  \item
    \textbf{Project Manager}：项目管理工具
  \item
    \textbf{Live Share}：实时协作编程
  \end{itemize}
\item
  \textbf{优势对比}

  \begin{itemize}
  \tightlist
  \item
    \textbf{相比RStudio}：更轻量，启动更快，扩展更多
  \item
    \textbf{相比纯文本编辑器}：提供完整的IDE功能
  \item
    \textbf{适合场景}：大型项目、多语言开发、远程开发
  \end{itemize}
\end{enumerate}

\textbf{注意事项：}\\
- 确保已安装R后再配置VSCode\\
- 路径设置需要根据实际安装位置调整\\
- 首次使用可能需要安装相关依赖包

\hypertarget{ux9879ux76eeux6587ux4ef6ux5939ux7ed3ux6784ux8bbeux7f6e}{%
\subsection{项目文件夹结构设置}\label{ux9879ux76eeux6587ux4ef6ux5939ux7ed3ux6784ux8bbeux7f6e}}

建立良好的文件组织习惯是数据分析的基础：

\begin{verbatim}
生态学R语言课程/
├── 第01课-森林调查/
│   ├── 数据/
│   ├── 脚本/
│   └── 结果/
├── 第02课-物种名称/
│   ├── 数据/
│   ├── 脚本/
│   └── 结果/
├── ...
└── 参考资料/
\end{verbatim}

\hypertarget{ux57faux672cux5305ux7ba1ux7406}{%
\subsection{基本包管理}\label{ux57faux672cux5305ux7ba1ux7406}}

\hypertarget{rux5305ux7684ux6982ux5ff5}{%
\subsubsection{R包的概念}\label{rux5305ux7684ux6982ux5ff5}}

\begin{itemize}
\tightlist
\item
  \textbf{什么是R包}：R包是扩展R功能的代码、数据和文档集合
\item
  \textbf{包的作用}：提供专业统计方法、可视化工具、数据导入等功能
\item
  \textbf{生态学常用包}：vegan(群落分析)、ggplot2(可视化)、dplyr(数据处理)等
\end{itemize}

\hypertarget{rtoolsux7684ux4f5cux7528}{%
\subsubsection{Rtools的作用}\label{rtoolsux7684ux4f5cux7528}}

\begin{itemize}
\tightlist
\item
  \textbf{Windows专用}：用于编译需要C/C++/Fortran代码的R包
\item
  \textbf{适用场景}：

  \begin{itemize}
  \tightlist
  \item
    安装需要编译的包(如部分生态学模型包)
  \item
    开发自己的R包
  \item
    使用某些高性能计算功能
  \end{itemize}
\item
  \textbf{安装方法}：从CRAN下载对应R版本的Rtools安装包
\end{itemize}

\hypertarget{ux5305ux7ba1ux7406ux57faux7840}{%
\subsubsection{包管理基础}\label{ux5305ux7ba1ux7406ux57faux7840}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 检查已安装的包}
\FunctionTok{installed.packages}\NormalTok{()}

\CommentTok{\# 安装新包(从CRAN)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"ggplot2"}\NormalTok{) }

\CommentTok{\# 从GitHub安装开发版包}
\CommentTok{\# install.packages("devtools")}
\CommentTok{\# devtools::install\_github("作者/包名")}

\CommentTok{\# 加载包}
\FunctionTok{library}\NormalTok{(ggplot2)}

\CommentTok{\# 更新所有包}
\FunctionTok{update.packages}\NormalTok{()}

\CommentTok{\# 查看包帮助文档}
\FunctionTok{help}\NormalTok{(}\AttributeTok{package=}\StringTok{"ggplot2"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux5982ux4f55ux5bfbux627eux5408ux9002ux7684ux5305}{%
\subsubsection{如何寻找合适的包}\label{ux5982ux4f55ux5bfbux627eux5408ux9002ux7684ux5305}}

\begin{itemize}
\tightlist
\item
  \textbf{CRAN任务视图}：\url{https://cran.r-project.org/web/views/}

  \begin{itemize}
  \tightlist
  \item
    如Environmetrics任务视图包含生态学相关包
  \end{itemize}
\item
  \textbf{RStudio包推荐}：通过RStudio的Packages面板浏览
\item
  \textbf{学术文献}：参考领域内论文使用的方法和包
\item
  \textbf{社区推荐}：R-bloggers、Stack Overflow等平台
\end{itemize}

\hypertarget{ux5de5ux4f5cux76eeux5f55ux8bbeux7f6e}{%
\subsection{工作目录设置}\label{ux5de5ux4f5cux76eeux5f55ux8bbeux7f6e}}

\hypertarget{ux4ec0ux4e48ux662fux5de5ux4f5cux76eeux5f55}{%
\subsubsection{什么是工作目录？}\label{ux4ec0ux4e48ux662fux5de5ux4f5cux76eeux5f55}}

\begin{itemize}
\tightlist
\item
  \textbf{简单理解}：就像你办公桌上的文件夹，R会默认从这个文件夹里找文件
\item
  \textbf{作用}：告诉R在哪里读取数据和保存结果
\item
  \textbf{类比}：就像在图书馆找书需要知道书架位置一样
\end{itemize}

\hypertarget{ux4e3aux4ec0ux4e48ux8981ux8bbeux7f6eux5de5ux4f5cux76eeux5f55}{%
\subsubsection{为什么要设置工作目录？}\label{ux4e3aux4ec0ux4e48ux8981ux8bbeux7f6eux5de5ux4f5cux76eeux5f55}}

\begin{itemize}
\tightlist
\item
  \textbf{方便管理}：所有课程文件可以分类存放
\item
  \textbf{避免错误}：R能准确找到你的数据文件
\item
  \textbf{提高效率}：不用每次都输入完整文件路径
\end{itemize}

\hypertarget{ux57faux672cux64cdux4f5c}{%
\subsubsection{基本操作}\label{ux57faux672cux64cdux4f5c}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 查看当前工作目录(就像查看你现在在哪个文件夹)}
\FunctionTok{getwd}\NormalTok{()}

\CommentTok{\# 设置工作目录(告诉R使用哪个文件夹)}
\CommentTok{\# 注意：路径中的斜杠方向}
\FunctionTok{setwd}\NormalTok{(}\StringTok{"C:/Users/你的用户名/生态学R语言课程"}\NormalTok{) }

\CommentTok{\# 列出当前目录下的文件(看看这个文件夹里有什么)}
\FunctionTok{list.files}\NormalTok{()}

\CommentTok{\# 小技巧：在RStudio中可以通过菜单设置工作目录更简单：}
\CommentTok{\# Session → Set Working Directory → Choose Directory}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux6ce8ux610fux4e8bux9879}{%
\subsubsection{注意事项}\label{ux6ce8ux610fux4e8bux9879}}

\begin{itemize}
\tightlist
\item
  路径中不要有中文
\item
  Windows系统使用正斜杠''/``或双反斜杠''\textbackslash''
\item
  建议为每节课创建单独的子文件夹
\end{itemize}

\hypertarget{ux8bfeux524dux51c6ux5907ux68c0ux67e5ux6e05ux5355}{%
\subsection{课前准备检查清单}\label{ux8bfeux524dux51c6ux5907ux68c0ux67e5ux6e05ux5355}}

\begin{itemize}
\tightlist
\item[$\square$]
  R软件安装成功
\item[$\square$]
  能够运行简单的R代码
\item[$\square$]
  创建了课程文件夹结构
\item[$\square$]
  理解了学习R语言的重要性
\item[$\square$]
  准备好投入时间学习编程思维
\end{itemize}

\hypertarget{ux6570ux503cux5411ux91cfux521bux5efaux4e0eux57faux672cux7edfux8ba1ux8ba1ux7b97}{%
\section{数值向量创建与基本统计计算}\label{ux6570ux503cux5411ux91cfux521bux5efaux4e0eux57faux672cux7edfux8ba1ux8ba1ux7b97}}

\hypertarget{ux751fux6001ux5b66ux80ccux666f}{%
\subsection{生态学背景}\label{ux751fux6001ux5b66ux80ccux666f}}

在野外森林调查中，测量树木胸径（DBH，距地面1.3米处的直径）是评估森林生长状况的基本方法。我们需要计算样地内树木的平均胸径来了解林分特征。

\hypertarget{ux6f14ux793aux6570ux636e}{%
\subsection{演示数据}\label{ux6f14ux793aux6570ux636e}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 某样地内10棵马尾松的胸径测量值（单位：厘米）}
\NormalTok{tree\_dbh }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{15.2}\NormalTok{, }\FloatTok{18.7}\NormalTok{, }\FloatTok{22.1}\NormalTok{, }\FloatTok{19.5}\NormalTok{, }\FloatTok{16.8}\NormalTok{, }\FloatTok{20.3}\NormalTok{, }\FloatTok{17.9}\NormalTok{, }\FloatTok{21.4}\NormalTok{, }\FloatTok{19.2}\NormalTok{, }\FloatTok{18.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b}{%
\subsection{课堂演示过程}\label{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 1. 创建胸径数据向量}
\NormalTok{tree\_dbh }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{15.2}\NormalTok{, }\FloatTok{18.7}\NormalTok{, }\FloatTok{22.1}\NormalTok{, }\FloatTok{19.5}\NormalTok{, }\FloatTok{16.8}\NormalTok{, }\FloatTok{20.3}\NormalTok{, }\FloatTok{17.9}\NormalTok{, }\FloatTok{21.4}\NormalTok{, }\FloatTok{19.2}\NormalTok{, }\FloatTok{18.6}\NormalTok{)}

\CommentTok{\# 2. 查看数据}
\NormalTok{tree\_dbh}
\FunctionTok{length}\NormalTok{(tree\_dbh)  }\CommentTok{\# 查看测量了多少棵树}

\CommentTok{\# 3. 计算平均胸径}
\NormalTok{mean\_dbh }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(tree\_dbh)}
\NormalTok{mean\_dbh}

\CommentTok{\# 4. 计算总树数}
\NormalTok{tree\_count }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(tree\_dbh)}
\NormalTok{tree\_count}

\CommentTok{\# 5. 简单的数学运算}
\NormalTok{max\_dbh }\OtherTok{\textless{}{-}} \FunctionTok{max}\NormalTok{(tree\_dbh)  }\CommentTok{\# 最大胸径}
\NormalTok{min\_dbh }\OtherTok{\textless{}{-}} \FunctionTok{min}\NormalTok{(tree\_dbh)  }\CommentTok{\# 最小胸径}
\NormalTok{total\_dbh }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(tree\_dbh)  }\CommentTok{\# 胸径总和}
\end{Highlighting}
\end{Shaded}

\hypertarget{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3}{%
\subsection{R语言知识点详解}\label{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3}}

\hypertarget{ux5411ux91cfux521bux5efaux51fdux6570-c}{%
\subsubsection{\texorpdfstring{向量创建函数 \texttt{c()}}{向量创建函数 c()}}\label{ux5411ux91cfux521bux5efaux51fdux6570-c}}

\begin{itemize}
\tightlist
\item
  \textbf{是什么}：\texttt{c()} 是combine的缩写，用于将多个值组合成一个向量
\item
  \textbf{语法}：\texttt{c(值1,\ 值2,\ 值3,\ ...)}
\item
  \textbf{重要特点}：

  \begin{itemize}
  \tightlist
  \item
    向量中的所有元素必须是同一类型（数值、字符或逻辑）
  \item
    如果混合不同类型，R会自动转换为最通用的类型
  \item
    向量是R中最基本的数据结构
  \end{itemize}
\item
  \textbf{常见错误}：忘记加逗号分隔值，如\texttt{c(1\ 2\ 3)}是错误的
\item
  \textbf{最佳实践}：给向量起有意义的名字，如\texttt{tree\_dbh}而不是\texttt{x}
\end{itemize}

\hypertarget{ux53d8ux91cfux8d4bux503cux64cdux4f5cux7b26--}{%
\subsubsection{\texorpdfstring{变量赋值操作符 \texttt{\textless{}-}}{变量赋值操作符 \textless-}}\label{ux53d8ux91cfux8d4bux503cux64cdux4f5cux7b26--}}

\begin{itemize}
\tightlist
\item
  \textbf{是什么}：将右边的值赋给左边的变量名
\item
  \textbf{语法}：\texttt{变量名\ \textless{}-\ 值}
\item
  \textbf{为什么用 \texttt{\textless{}-} 而不是 \texttt{=}}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{\textless{}-} 是R的传统赋值符号，更清晰地表示赋值方向
  \item
    \texttt{=} 也可以用，但在某些情况下可能引起混淆
  \item
    建议统一使用 \texttt{\textless{}-} 保持代码风格一致
  \end{itemize}
\item
  \textbf{变量命名规则}：

  \begin{itemize}
  \tightlist
  \item
    只能包含字母、数字、点(.)和下划线(\_)
  \item
    不能以数字开头
  \item
    区分大小写
  \item
    建议使用有意义的名称
  \end{itemize}
\end{itemize}

\hypertarget{ux57faux672cux7edfux8ba1ux51fdux6570}{%
\subsubsection{基本统计函数}\label{ux57faux672cux7edfux8ba1ux51fdux6570}}

\hypertarget{mean---ux8ba1ux7b97ux5e73ux5747ux503c}{%
\paragraph{\texorpdfstring{\texttt{mean()} - 计算平均值}{mean() - 计算平均值}}\label{mean---ux8ba1ux7b97ux5e73ux5747ux503c}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{mean(x,\ na.rm\ =\ FALSE)}
\item
  \textbf{参数说明}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{x}：数值向量
  \item
    \texttt{na.rm}：是否移除缺失值，默认FALSE
  \end{itemize}
\item
  \textbf{返回值}：数值，向量的算术平均数
\item
  \textbf{注意事项}：如果向量包含NA值，结果会是NA，除非设置\texttt{na.rm\ =\ TRUE}
\end{itemize}

\hypertarget{length---ux8ba1ux7b97ux5411ux91cfux957fux5ea6}{%
\paragraph{\texorpdfstring{\texttt{length()} - 计算向量长度}{length() - 计算向量长度}}\label{length---ux8ba1ux7b97ux5411ux91cfux957fux5ea6}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{length(x)}
\item
  \textbf{作用}：返回向量中元素的个数
\item
  \textbf{应用场景}：统计样本数量、检查数据完整性
\end{itemize}

\hypertarget{max-ux548c-min---ux6700ux5927ux503cux548cux6700ux5c0fux503c}{%
\paragraph{\texorpdfstring{\texttt{max()} 和 \texttt{min()} - 最大值和最小值}{max() 和 min() - 最大值和最小值}}\label{max-ux548c-min---ux6700ux5927ux503cux548cux6700ux5c0fux503c}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{max(x,\ na.rm\ =\ FALSE)}，\texttt{min(x,\ na.rm\ =\ FALSE)}
\item
  \textbf{作用}：找出向量中的最大值和最小值
\item
  \textbf{参数}：与mean()相同，可以设置na.rm参数
\end{itemize}

\hypertarget{sum---ux6c42ux548c}{%
\paragraph{\texorpdfstring{\texttt{sum()} - 求和}{sum() - 求和}}\label{sum---ux6c42ux548c}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{sum(x,\ na.rm\ =\ FALSE)}
\item
  \textbf{作用}：计算向量所有元素的总和
\item
  \textbf{应用}：计算总量、累计值等
\end{itemize}

\hypertarget{ux6570ux636eux67e5ux770b}{%
\subsubsection{数据查看}\label{ux6570ux636eux67e5ux770b}}

\begin{itemize}
\tightlist
\item
  \textbf{直接输入变量名}：最简单的查看方式，直接显示变量内容
\item
  \textbf{自动打印机制}：R会自动显示表达式的结果
\item
  \textbf{向量显示格式}：会显示\texttt{{[}1{]}}表示第一个元素的位置
\end{itemize}

\hypertarget{ux8bfeux540eux7ec3ux4e60}{%
\subsection{课后练习}\label{ux8bfeux540eux7ec3ux4e60}}

\textbf{题目}：某湿地调查中测量了8棵柳树的树高（单位：米）：
\texttt{tree\_height\ \textless{}-\ c(4.2,\ 5.1,\ 3.8,\ 4.7,\ 5.3,\ 4.9,\ 4.1,\ 4.6)}

请完成（仅使用本课学过的向量和基本统计函数）：
1. 创建树高向量并查看数据

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  计算平均树高
\item
  找出最高的树有多高
\item
  统计总共测量了多少棵树
\item
  计算所有树的总高度
\item
  计算树高的标准差（提示：使用sd()函数）
\end{enumerate}

\hypertarget{ux5b57ux7b26ux578bux6570ux636eux5904ux7406ux4e0eux5411ux91cfux7d22ux5f15ux64cdux4f5c}{%
\section{字符型数据处理与向量索引操作}\label{ux5b57ux7b26ux578bux6570ux636eux5904ux7406ux4e0eux5411ux91cfux7d22ux5f15ux64cdux4f5c}}

\hypertarget{ux751fux6001ux5b66ux80ccux666f-1}{%
\subsection{生态学背景}\label{ux751fux6001ux5b66ux80ccux666f-1}}

在野外鸟类观察中，需要记录观察到的鸟类物种名单，这是生物多样性调查的基础工作。我们要学会如何在R中管理物种名称数据。

\hypertarget{ux6f14ux793aux6570ux636e-1}{%
\subsection{演示数据}\label{ux6f14ux793aux6570ux636e-1}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 某公园早晨观察到的鸟类物种}
\NormalTok{bird\_species }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"白头鹎"}\NormalTok{, }\StringTok{"麻雀"}\NormalTok{, }\StringTok{"喜鹊"}\NormalTok{, }\StringTok{"乌鸦"}\NormalTok{, }\StringTok{"红嘴蓝鹊"}\NormalTok{, }\StringTok{"大山雀"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-1}{%
\subsection{课堂演示过程}\label{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-1}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 1. 创建鸟类物种名单}
\NormalTok{bird\_species }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"白头鹎"}\NormalTok{, }\StringTok{"麻雀"}\NormalTok{, }\StringTok{"喜鹊"}\NormalTok{, }\StringTok{"乌鸦"}\NormalTok{, }\StringTok{"红嘴蓝鹊"}\NormalTok{, }\StringTok{"大山雀"}\NormalTok{)}

\CommentTok{\# 2. 查看物种名单}
\NormalTok{bird\_species}
\FunctionTok{print}\NormalTok{(bird\_species)  }\CommentTok{\# 另一种显示方法}

\CommentTok{\# 3. 统计观察到的物种数量}
\NormalTok{species\_count }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(bird\_species)}
\NormalTok{species\_count}

\CommentTok{\# 4. 访问特定位置的物种}
\NormalTok{bird\_species[}\DecValTok{1}\NormalTok{]  }\CommentTok{\# 第一个物种}
\NormalTok{bird\_species[}\DecValTok{3}\NormalTok{]  }\CommentTok{\# 第三个物种}

\CommentTok{\# 5. 添加新观察到的物种}
\NormalTok{bird\_species }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(bird\_species, }\StringTok{"燕子"}\NormalTok{)}
\NormalTok{bird\_species}

\CommentTok{\# 6. 字符串操作}
\FunctionTok{paste}\NormalTok{(}\StringTok{"今天观察到"}\NormalTok{, }\FunctionTok{length}\NormalTok{(bird\_species), }\StringTok{"种鸟类"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-1}{%
\subsection{R语言知识点详解}\label{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-1}}

\hypertarget{ux5b57ux7b26ux578bux6570ux636echaracter-data}{%
\subsubsection{字符型数据（Character Data）}\label{ux5b57ux7b26ux578bux6570ux636echaracter-data}}

\begin{itemize}
\tightlist
\item
  \textbf{是什么}：用引号包围的文本数据，R中的基本数据类型之一
\item
  \textbf{语法}：\texttt{"文本内容"} 或 \texttt{\textquotesingle{}文本内容\textquotesingle{}}
\item
  \textbf{重要特点}：

  \begin{itemize}
  \tightlist
  \item
    单引号和双引号都可以，但要成对使用
  \item
    如果文本中包含引号，需要转义或使用另一种引号包围
  \item
    字符型数据在R中以向量形式存储
  \end{itemize}
\item
  \textbf{与数值的区别}：

  \begin{itemize}
  \tightlist
  \item
    字符型：\texttt{"123"} - 这是文本，不能进行数学运算
  \item
    数值型：\texttt{123} - 这是数字，可以进行数学运算
  \end{itemize}
\item
  \textbf{编码注意}：中文字符需要确保R的编码设置正确
\end{itemize}

\hypertarget{ux5411ux91cfux7d22ux5f15vector-indexing}{%
\subsubsection{向量索引（Vector Indexing）}\label{ux5411ux91cfux7d22ux5f15vector-indexing}}

\begin{itemize}
\tightlist
\item
  \textbf{是什么}：通过位置编号访问向量中特定元素的方法
\item
  \textbf{语法}：\texttt{向量名{[}位置{]}}
\item
  \textbf{索引规则}：

  \begin{itemize}
  \tightlist
  \item
    R的索引从1开始（不是0！）
  \item
    可以使用负数排除特定位置：\texttt{bird\_species{[}-1{]}}（排除第一个）
  \item
    可以一次访问多个位置：\texttt{bird\_species{[}c(1,3,5){]}}
  \end{itemize}
\item
  \textbf{超出范围}：如果索引超出向量长度，返回NA
\item
  \textbf{实际应用}：在生态学中用于提取特定样本、物种等
\end{itemize}

\hypertarget{ux6570ux636eux663eux793aux51fdux6570}{%
\subsubsection{数据显示函数}\label{ux6570ux636eux663eux793aux51fdux6570}}

\hypertarget{print-ux51fdux6570}{%
\paragraph{\texorpdfstring{\texttt{print()} 函数}{print() 函数}}\label{print-ux51fdux6570}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{print(x)}
\item
  \textbf{与直接输入变量名的区别}：

  \begin{itemize}
  \tightlist
  \item
    直接输入：仅在交互模式下显示
  \item
    \texttt{print()}：在脚本和函数中也会显示，更可控
  \end{itemize}
\item
  \textbf{应用场景}：在循环、函数中需要显示结果时
\end{itemize}

\hypertarget{ux5411ux91cfux5408ux5e76ux548cux6269ux5c55}{%
\subsubsection{向量合并和扩展}\label{ux5411ux91cfux5408ux5e76ux548cux6269ux5c55}}

\begin{itemize}
\tightlist
\item
  \textbf{添加元素}：\texttt{c(原向量,\ 新元素)}
\item
  \textbf{重要概念}：R中的向量是不可变的，每次''添加''实际上是创建新向量
\item
  \textbf{效率考虑}：频繁添加元素效率较低，大量数据建议预先分配空间
\item
  \textbf{实际应用}：野外调查中动态添加新发现的物种
\end{itemize}

\hypertarget{ux5b57ux7b26ux4e32ux8fdeux63a5ux51fdux6570-paste}{%
\subsubsection{\texorpdfstring{字符串连接函数 \texttt{paste()}}{字符串连接函数 paste()}}\label{ux5b57ux7b26ux4e32ux8fdeux63a5ux51fdux6570-paste}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{paste(...,\ sep\ =\ "\ ",\ collapse\ =\ NULL)}
\item
  \textbf{参数详解}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{...}：要连接的多个元素
  \item
    \texttt{sep}：分隔符，默认是空格
  \item
    \texttt{collapse}：如果提供，将结果向量合并为单个字符串
  \end{itemize}
\item
  \textbf{相关函数}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{paste0()}：等同于\texttt{paste(...,\ sep\ =\ "")}，不使用分隔符
  \item
    \texttt{sprintf()}：格式化字符串，类似其他语言的printf
  \end{itemize}
\item
  \textbf{实际应用}：生成报告文本、标签、文件名等
\end{itemize}

\hypertarget{ux8bfeux540eux7ec3ux4e60-1}{%
\subsection{课后练习}\label{ux8bfeux540eux7ec3ux4e60-1}}

\textbf{题目}：某湿地调查中记录的水生植物：
\texttt{water\_plants\ \textless{}-\ c("荷花",\ "芦苇",\ "菖蒲",\ "水葫芦",\ "睡莲")}

请完成（使用向量、字符串操作、索引等已学内容）：
1. 创建植物名称向量并显示所有植物名称

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  计算记录了多少种植物（使用length()函数）
\item
  显示第2种和第4种植物的名称（使用向量索引）
\item
  添加''慈姑''到植物名单中（使用c()函数合并）
\item
  用paste()函数创建一句完整的调查报告
\item
  尝试查找''芦苇''在向量中的位置（提示：使用which()函数和==运算符）
\end{enumerate}

\hypertarget{ux6570ux636eux6846ux7ed3ux6784ux7406ux89e3ux4e0eux591aux7c7bux578bux6570ux636eux7ba1ux7406}{%
\section{数据框结构理解与多类型数据管理}\label{ux6570ux636eux6846ux7ed3ux6784ux7406ux89e3ux4e0eux591aux7c7bux578bux6570ux636eux7ba1ux7406}}

\hypertarget{ux751fux6001ux5b66ux80ccux666f-2}{%
\subsection{生态学背景}\label{ux751fux6001ux5b66ux80ccux666f-2}}

在植物群落调查中，需要同时记录多种信息：样方编号、物种名称、株高、是否存活等。这些不同类型的数据需要组织在一个表格中，这就需要用到数据框。

\hypertarget{ux6f14ux793aux6570ux636e-2}{%
\subsection{演示数据}\label{ux6f14ux793aux6570ux636e-2}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 某山坡5个样方的植物调查数据}
\NormalTok{plot\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{plot\_id =} \FunctionTok{c}\NormalTok{(}\StringTok{"S001"}\NormalTok{, }\StringTok{"S002"}\NormalTok{, }\StringTok{"S003"}\NormalTok{, }\StringTok{"S004"}\NormalTok{, }\StringTok{"S005"}\NormalTok{),}
  \AttributeTok{species =} \FunctionTok{c}\NormalTok{(}\StringTok{"马尾松"}\NormalTok{, }\StringTok{"杉木"}\NormalTok{, }\StringTok{"樟树"}\NormalTok{, }\StringTok{"栎树"}\NormalTok{, }\StringTok{"枫香"}\NormalTok{),}
  \AttributeTok{height\_m =} \FunctionTok{c}\NormalTok{(}\FloatTok{12.5}\NormalTok{, }\FloatTok{8.3}\NormalTok{, }\FloatTok{15.2}\NormalTok{, }\FloatTok{10.7}\NormalTok{, }\FloatTok{9.8}\NormalTok{),}
  \AttributeTok{diameter\_cm =} \FunctionTok{c}\NormalTok{(}\FloatTok{18.2}\NormalTok{, }\FloatTok{12.5}\NormalTok{, }\FloatTok{22.1}\NormalTok{, }\FloatTok{16.8}\NormalTok{, }\FloatTok{14.3}\NormalTok{),}
  \AttributeTok{alive =} \FunctionTok{c}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-2}{%
\subsection{课堂演示过程}\label{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-2}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 1. 创建植物调查数据框}
\NormalTok{plot\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{plot\_id =} \FunctionTok{c}\NormalTok{(}\StringTok{"S001"}\NormalTok{, }\StringTok{"S002"}\NormalTok{, }\StringTok{"S003"}\NormalTok{, }\StringTok{"S004"}\NormalTok{, }\StringTok{"S005"}\NormalTok{),}
  \AttributeTok{species =} \FunctionTok{c}\NormalTok{(}\StringTok{"马尾松"}\NormalTok{, }\StringTok{"杉木"}\NormalTok{, }\StringTok{"樟树"}\NormalTok{, }\StringTok{"栎树"}\NormalTok{, }\StringTok{"枫香"}\NormalTok{),}
  \AttributeTok{height\_m =} \FunctionTok{c}\NormalTok{(}\FloatTok{12.5}\NormalTok{, }\FloatTok{8.3}\NormalTok{, }\FloatTok{15.2}\NormalTok{, }\FloatTok{10.7}\NormalTok{, }\FloatTok{9.8}\NormalTok{),}
  \AttributeTok{diameter\_cm =} \FunctionTok{c}\NormalTok{(}\FloatTok{18.2}\NormalTok{, }\FloatTok{12.5}\NormalTok{, }\FloatTok{22.1}\NormalTok{, }\FloatTok{16.8}\NormalTok{, }\FloatTok{14.3}\NormalTok{),}
  \AttributeTok{alive =} \FunctionTok{c}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{)}

\CommentTok{\# 2. 查看数据框}
\NormalTok{plot\_data}
\FunctionTok{print}\NormalTok{(plot\_data)}

\CommentTok{\# 3. 查看数据框结构}
\FunctionTok{str}\NormalTok{(plot\_data)  }\CommentTok{\# 显示每列的数据类型}

\CommentTok{\# 4. 查看数据框维度}
\FunctionTok{nrow}\NormalTok{(plot\_data)  }\CommentTok{\# 行数}
\FunctionTok{ncol}\NormalTok{(plot\_data)  }\CommentTok{\# 列数}
\FunctionTok{dim}\NormalTok{(plot\_data)   }\CommentTok{\# 行数和列数}

\CommentTok{\# 5. 查看前几行和后几行}
\FunctionTok{head}\NormalTok{(plot\_data, }\DecValTok{3}\NormalTok{)  }\CommentTok{\# 前3行}
\FunctionTok{tail}\NormalTok{(plot\_data, }\DecValTok{2}\NormalTok{)   }\CommentTok{\# 后2行}

\CommentTok{\# 6. 访问特定列}
\NormalTok{plot\_data}\SpecialCharTok{$}\NormalTok{species    }\CommentTok{\# 物种列}
\NormalTok{plot\_data}\SpecialCharTok{$}\NormalTok{height\_m   }\CommentTok{\# 高度列}

\CommentTok{\# 7. 计算统计量}
\FunctionTok{mean}\NormalTok{(plot\_data}\SpecialCharTok{$}\NormalTok{height\_m)  }\CommentTok{\# 平均高度}
\FunctionTok{sum}\NormalTok{(plot\_data}\SpecialCharTok{$}\NormalTok{alive)      }\CommentTok{\# 存活植物数量}
\end{Highlighting}
\end{Shaded}

\hypertarget{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-2}{%
\subsection{R语言知识点详解}\label{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-2}}

\hypertarget{ux6570ux636eux6846data-frame}{%
\subsubsection{数据框（Data Frame）}\label{ux6570ux636eux6846data-frame}}

\begin{itemize}
\tightlist
\item
  \textbf{是什么}：R中最重要的数据结构，类似于Excel表格或数据库表
\item
  \textbf{语法}：\texttt{data.frame(列名1\ =\ 向量1,\ 列名2\ =\ 向量2,\ ...)}
\item
  \textbf{核心特点}：

  \begin{itemize}
  \tightlist
  \item
    每列可以是不同的数据类型（数值、字符、逻辑）
  \item
    但每列内部必须是相同类型
  \item
    所有列必须有相同的长度（行数）
  \item
    每行代表一个观察单位，每列代表一个变量
  \end{itemize}
\item
  \textbf{与矩阵的区别}：

  \begin{itemize}
  \tightlist
  \item
    矩阵：所有元素必须是相同类型
  \item
    数据框：不同列可以是不同类型
  \end{itemize}
\item
  \textbf{生态学应用}：完美适合存储野外调查数据
\end{itemize}

\hypertarget{rux4e2dux7684ux6570ux636eux7c7bux578bux7cfbux7edf}{%
\subsubsection{R中的数据类型系统}\label{rux4e2dux7684ux6570ux636eux7c7bux578bux7cfbux7edf}}

\hypertarget{ux6570ux503cux578bnumericdouble}{%
\paragraph{数值型（Numeric/Double）}\label{ux6570ux503cux578bnumericdouble}}

\begin{itemize}
\tightlist
\item
  \textbf{特点}：包含小数点的数字
\item
  \textbf{示例}：\texttt{12.5}, \texttt{8.3}, \texttt{15.2}
\item
  \textbf{用途}：测量值、计数、比例等
\end{itemize}

\hypertarget{ux5b57ux7b26ux578bcharacter}{%
\paragraph{字符型（Character）}\label{ux5b57ux7b26ux578bcharacter}}

\begin{itemize}
\tightlist
\item
  \textbf{特点}：文本数据，用引号包围
\item
  \textbf{示例}：\texttt{"S001"}, \texttt{"马尾松"}, \texttt{"杉木"}
\item
  \textbf{用途}：名称、标识符、分类标签
\end{itemize}

\hypertarget{ux903bux8f91ux578blogical}{%
\paragraph{逻辑型（Logical）}\label{ux903bux8f91ux578blogical}}

\begin{itemize}
\tightlist
\item
  \textbf{特点}：只有两个值：TRUE和FALSE
\item
  \textbf{示例}：\texttt{TRUE}, \texttt{FALSE}
\item
  \textbf{用途}：是/否判断、条件标记
\item
  \textbf{运算}：可以进行数学运算（TRUE=1, FALSE=0）
\end{itemize}

\hypertarget{ux6570ux636eux6846ux7ed3ux6784ux67e5ux770bux51fdux6570}{%
\subsubsection{数据框结构查看函数}\label{ux6570ux636eux6846ux7ed3ux6784ux67e5ux770bux51fdux6570}}

\hypertarget{str---structureux51fdux6570}{%
\paragraph{\texorpdfstring{\texttt{str()} - Structure函数}{str() - Structure函数}}\label{str---structureux51fdux6570}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：显示数据框的完整结构信息
\item
  \textbf{显示内容}：

  \begin{itemize}
  \tightlist
  \item
    数据框类型和维度
  \item
    每列的数据类型
  \item
    前几个值的预览
  \end{itemize}
\item
  \textbf{读法技巧}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{\textquotesingle{}data.frame\textquotesingle{}:\ 5\ obs.\ of\ 5\ variables} - 5行5列的数据框
  \item
    \texttt{\$\ plot\_id\ :\ chr} - plot\_id列是字符型
  \item
    \texttt{\$\ height\_m:\ num} - height\_m列是数值型
  \end{itemize}
\end{itemize}

\hypertarget{head-ux548c-tail}{%
\paragraph{\texorpdfstring{\texttt{head()} 和 \texttt{tail()}}{head() 和 tail()}}\label{head-ux548c-tail}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{head(x,\ n\ =\ 6)}, \texttt{tail(x,\ n\ =\ 6)}
\item
  \textbf{作用}：查看数据框的开头或结尾几行
\item
  \textbf{参数}：n指定显示的行数，默认6行
\item
  \textbf{应用场景}：

  \begin{itemize}
  \tightlist
  \item
    快速了解数据格式
  \item
    检查数据导入是否正确
  \item
    大数据集的初步查看
  \end{itemize}
\end{itemize}

\hypertarget{ux7ef4ux5ea6ux51fdux6570}{%
\paragraph{维度函数}\label{ux7ef4ux5ea6ux51fdux6570}}

\begin{itemize}
\tightlist
\item
  \textbf{\texttt{nrow()}}：返回行数（观察数量）
\item
  \textbf{\texttt{ncol()}}：返回列数（变量数量）
\item
  \textbf{\texttt{dim()}}：返回维度向量c(行数, 列数)
\item
  \textbf{\texttt{names()} 或 \texttt{colnames()}}：返回列名
\end{itemize}

\hypertarget{ux6570ux636eux6846ux5217ux8bbfux95ee}{%
\subsubsection{数据框列访问}\label{ux6570ux636eux6846ux5217ux8bbfux95ee}}

\hypertarget{ux7f8eux5143ux7b26ux53f7-ux64cdux4f5cux7b26}{%
\paragraph{\texorpdfstring{美元符号 \texttt{\$} 操作符}{美元符号 \$ 操作符}}\label{ux7f8eux5143ux7b26ux53f7-ux64cdux4f5cux7b26}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{数据框名\$列名}
\item
  \textbf{特点}：

  \begin{itemize}
  \tightlist
  \item
    返回该列的向量
  \item
    支持名称自动补全（在RStudio中）
  \item
    最常用的列访问方式
  \end{itemize}
\item
  \textbf{注意}：列名不需要引号
\end{itemize}

\hypertarget{ux53ccux62ecux53f7-ux64cdux4f5cux7b26}{%
\paragraph{\texorpdfstring{双括号 \texttt{{[}{[}{]}{]}} 操作符}{双括号 {[}{[}{]}{]} 操作符}}\label{ux53ccux62ecux53f7-ux64cdux4f5cux7b26}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{数据框名{[}{[}"列名"{]}{]}} 或 \texttt{数据框名{[}{[}列位置{]}{]}}
\item
  \textbf{与\$的区别}：

  \begin{itemize}
  \tightlist
  \item
    支持变量名作为列名：\texttt{df{[}{[}var\_name{]}{]}}
  \item
    可以使用数字索引：\texttt{df{[}{[}1{]}{]}}
  \end{itemize}
\end{itemize}

\hypertarget{ux5355ux62ecux53f7-ux64cdux4f5cux7b26}{%
\paragraph{\texorpdfstring{单括号 \texttt{{[}{]}} 操作符}{单括号 {[}{]} 操作符}}\label{ux5355ux62ecux53f7-ux64cdux4f5cux7b26}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{数据框名{[}行,\ 列{]}}
\item
  \textbf{特点}：返回数据框（保持原结构）
\item
  \textbf{示例}：\texttt{plot\_data{[},\ "species"{]}} - 选择species列但保持数据框格式
\end{itemize}

\hypertarget{ux8bfeux540eux7ec3ux4e60-2}{%
\subsection{课后练习}\label{ux8bfeux540eux7ec3ux4e60-2}}

\textbf{题目}：某河流生态调查数据：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{river\_survey }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{site\_id =} \FunctionTok{c}\NormalTok{(}\StringTok{"R01"}\NormalTok{, }\StringTok{"R02"}\NormalTok{, }\StringTok{"R03"}\NormalTok{, }\StringTok{"R04"}\NormalTok{),}
  \AttributeTok{fish\_species =} \FunctionTok{c}\NormalTok{(}\StringTok{"草鱼"}\NormalTok{, }\StringTok{"鲤鱼"}\NormalTok{, }\StringTok{"鲫鱼"}\NormalTok{, }\StringTok{"青鱼"}\NormalTok{),}
  \AttributeTok{length\_cm =} \FunctionTok{c}\NormalTok{(}\FloatTok{25.3}\NormalTok{, }\FloatTok{18.7}\NormalTok{, }\FloatTok{12.4}\NormalTok{, }\FloatTok{31.2}\NormalTok{),}
  \AttributeTok{weight\_g =} \FunctionTok{c}\NormalTok{(}\DecValTok{680}\NormalTok{, }\DecValTok{420}\NormalTok{, }\DecValTok{180}\NormalTok{, }\DecValTok{1200}\NormalTok{),}
  \AttributeTok{mature =} \FunctionTok{c}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

请完成（使用数据框操作、向量计算等已学内容）：

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  创建数据框并显示整个数据框
\item
  使用str()函数查看数据框的结构
\item
  计算鱼类的平均长度和平均重量（使用mean()和\$操作符）
\item
  统计有多少条成熟的鱼（使用sum()和逻辑值运算）
\item
  显示所有鱼类的名称（使用\$操作符）
\item
  计算最大和最小的鱼重量（使用max()和min()函数）
\item
  创建一个包含调查总结的字符串（使用paste()函数）
\end{enumerate}

\hypertarget{ux5217ux8868ux6570ux636eux7ed3ux6784ux4e0eux6570ux636eux5206ux7ec4ux7ba1ux7406}{%
\section{列表数据结构与数据分组管理}\label{ux5217ux8868ux6570ux636eux7ed3ux6784ux4e0eux6570ux636eux5206ux7ec4ux7ba1ux7406}}

\hypertarget{ux751fux6001ux5b66ux80ccux666f-3}{%
\subsection{生态学背景}\label{ux751fux6001ux5b66ux80ccux666f-3}}

不同栖息地类型的物种多样性差异很大。我们需要比较森林、草地、湿地三种生境中的物种数量，这种多组数据的管理需要用到列表结构。

\hypertarget{ux6f14ux793aux6570ux636e-3}{%
\subsection{演示数据}\label{ux6f14ux793aux6570ux636e-3}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 不同栖息地的物种数量调查（每个生境调查了4个样点）}
\NormalTok{forest\_species }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{25}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{28}\NormalTok{, }\DecValTok{32}\NormalTok{)}
\NormalTok{grassland\_species }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{15}\NormalTok{, }\DecValTok{18}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{16}\NormalTok{)  }
\NormalTok{wetland\_species }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{12}\NormalTok{, }\DecValTok{14}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{13}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-3}{%
\subsection{课堂演示过程}\label{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-3}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 1. 创建各栖息地物种数据}
\NormalTok{forest\_species }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{25}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{28}\NormalTok{, }\DecValTok{32}\NormalTok{)}
\NormalTok{grassland\_species }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{15}\NormalTok{, }\DecValTok{18}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{16}\NormalTok{)  }
\NormalTok{wetland\_species }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{12}\NormalTok{, }\DecValTok{14}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{13}\NormalTok{)}

\CommentTok{\# 2. 创建栖息地数据列表}
\NormalTok{habitats }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{forest =}\NormalTok{ forest\_species,}
  \AttributeTok{grassland =}\NormalTok{ grassland\_species,  }
  \AttributeTok{wetland =}\NormalTok{ wetland\_species}
\NormalTok{)}

\CommentTok{\# 3. 查看列表内容}
\NormalTok{habitats}
\FunctionTok{str}\NormalTok{(habitats)  }\CommentTok{\# 查看列表结构}

\CommentTok{\# 4. 访问列表中的元素}
\NormalTok{habitats}\SpecialCharTok{$}\NormalTok{forest      }\CommentTok{\# 使用$访问}
\NormalTok{habitats[[}\StringTok{"forest"}\NormalTok{]] }\CommentTok{\# 使用[[]]访问}
\NormalTok{habitats[[}\DecValTok{1}\NormalTok{]]        }\CommentTok{\# 使用位置索引}

\CommentTok{\# 5. 计算各生境的平均物种数}
\NormalTok{forest\_mean }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(habitats}\SpecialCharTok{$}\NormalTok{forest)}
\NormalTok{grassland\_mean }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(habitats}\SpecialCharTok{$}\NormalTok{grassland)}
\NormalTok{wetland\_mean }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(habitats}\SpecialCharTok{$}\NormalTok{wetland)}

\CommentTok{\# 6. 创建结果向量}
\NormalTok{habitat\_means }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(forest\_mean, grassland\_mean, wetland\_mean)}
\FunctionTok{names}\NormalTok{(habitat\_means) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"森林"}\NormalTok{, }\StringTok{"草地"}\NormalTok{, }\StringTok{"湿地"}\NormalTok{)}

\CommentTok{\# 7. 比较结果}
\NormalTok{habitat\_means}
\FunctionTok{max}\NormalTok{(habitat\_means)  }\CommentTok{\# 哪个生境物种最多}
\FunctionTok{which.max}\NormalTok{(habitat\_means)  }\CommentTok{\# 物种最多的生境位置}
\end{Highlighting}
\end{Shaded}

\hypertarget{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-3}{%
\subsection{R语言知识点详解}\label{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-3}}

\hypertarget{ux5217ux8868listux6570ux636eux7ed3ux6784}{%
\subsubsection{列表（List）数据结构}\label{ux5217ux8868listux6570ux636eux7ed3ux6784}}

\begin{itemize}
\tightlist
\item
  \textbf{是什么}：R中最灵活的数据结构，可以存储不同类型、不同长度的数据
\item
  \textbf{语法}：\texttt{list(名称1\ =\ 数据1,\ 名称2\ =\ 数据2,\ ...)}
\item
  \textbf{核心特点}：

  \begin{itemize}
  \tightlist
  \item
    每个元素可以是不同的数据类型（向量、数据框、甚至其他列表）
  \item
    每个元素可以有不同的长度
  \item
    元素可以有名称，也可以没有
  \item
    是递归数据结构（可以包含其他列表）
  \end{itemize}
\item
  \textbf{与向量、数据框的区别}：

  \begin{itemize}
  \tightlist
  \item
    向量：同类型，一维
  \item
    数据框：不同列可以不同类型，但同列必须同类型，二维表格
  \item
    列表：最灵活，可以存储任何类型的R对象
  \end{itemize}
\end{itemize}

\hypertarget{ux5217ux8868ux5143ux7d20ux8bbfux95eeux65b9ux6cd5}{%
\subsubsection{列表元素访问方法}\label{ux5217ux8868ux5143ux7d20ux8bbfux95eeux65b9ux6cd5}}

\hypertarget{ux7f8eux5143ux7b26ux53f7-ux8bbfux95eeux63a8ux8350}{%
\paragraph{\texorpdfstring{美元符号 \texttt{\$} 访问（推荐）}{美元符号 \$ 访问（推荐）}}\label{ux7f8eux5143ux7b26ux53f7-ux8bbfux95eeux63a8ux8350}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{列表名\$元素名}
\item
  \textbf{特点}：

  \begin{itemize}
  \tightlist
  \item
    最直观、最常用的方法
  \item
    只能用于有名称的元素
  \item
    支持RStudio中的自动补全
  \item
    返回元素的原始类型
  \end{itemize}
\end{itemize}

\hypertarget{ux53ccux62ecux53f7-ux8bbfux95ee}{%
\paragraph{\texorpdfstring{双括号 \texttt{{[}{[}{]}{]}} 访问}{双括号 {[}{[}{]}{]} 访问}}\label{ux53ccux62ecux53f7-ux8bbfux95ee}}

\begin{itemize}
\item
  \textbf{语法}：\texttt{列表名{[}{[}"元素名"{]}{]}} 或 \texttt{列表名{[}{[}位置{]}{]}}
\item
  \textbf{特点}：

  \begin{itemize}
  \tightlist
  \item
    更灵活，可以使用变量作为索引
  \item
    可以使用数字位置索引
  \item
    返回元素的原始类型
  \end{itemize}
\item
  \textbf{示例}：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{element\_name }\OtherTok{\textless{}{-}} \StringTok{"forest"}
\NormalTok{habitats[[element\_name]]  }\CommentTok{\# 使用变量}
\NormalTok{habitats[[}\DecValTok{1}\NormalTok{]]             }\CommentTok{\# 使用位置}
\end{Highlighting}
\end{Shaded}
\end{itemize}

\hypertarget{ux5355ux62ecux53f7-ux8bbfux95ee}{%
\paragraph{\texorpdfstring{单括号 \texttt{{[}{]}} 访问}{单括号 {[}{]} 访问}}\label{ux5355ux62ecux53f7-ux8bbfux95ee}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{列表名{[}元素名或位置{]}}
\item
  \textbf{特点}：返回包含该元素的子列表（仍然是列表类型）
\item
  \textbf{与{[}{[}{]}{]}的区别}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{habitats{[}1{]}} 返回包含第一个元素的列表
  \item
    \texttt{habitats{[}{[}1{]}{]}} 返回第一个元素本身（向量）
  \end{itemize}
\end{itemize}

\hypertarget{ux5411ux91cfux547dux540dux7cfbux7edf}{%
\subsubsection{向量命名系统}\label{ux5411ux91cfux547dux540dux7cfbux7edf}}

\hypertarget{names-ux51fdux6570}{%
\paragraph{\texorpdfstring{\texttt{names()} 函数}{names() 函数}}\label{names-ux51fdux6570}}

\begin{itemize}
\item
  \textbf{作用}：为向量的每个元素分配名称
\item
  \textbf{语法}：\texttt{names(向量)\ \textless{}-\ c("名称1",\ "名称2",\ ...)}
\item
  \textbf{好处}：

  \begin{itemize}
  \tightlist
  \item
    增加数据的可读性
  \item
    便于后续的数据访问和处理
  \item
    在图表中自动显示有意义的标签
  \end{itemize}
\item
  \textbf{应用}：

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 创建时命名}
\NormalTok{scores }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(数学 }\OtherTok{=} \DecValTok{95}\NormalTok{, 英语 }\OtherTok{=} \DecValTok{88}\NormalTok{, 物理 }\OtherTok{=} \DecValTok{92}\NormalTok{)}

\CommentTok{\# 后续命名}
\NormalTok{scores }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{95}\NormalTok{, }\DecValTok{88}\NormalTok{, }\DecValTok{92}\NormalTok{)}
\FunctionTok{names}\NormalTok{(scores) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"数学"}\NormalTok{, }\StringTok{"英语"}\NormalTok{, }\StringTok{"物理"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\end{itemize}

\hypertarget{ux6bd4ux8f83ux548cux67e5ux627eux51fdux6570}{%
\subsubsection{比较和查找函数}\label{ux6bd4ux8f83ux548cux67e5ux627eux51fdux6570}}

\hypertarget{max-ux548c-min}{%
\paragraph{\texorpdfstring{\texttt{max()} 和 \texttt{min()}}{max() 和 min()}}\label{max-ux548c-min}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：找到向量中的最大值或最小值
\item
  \textbf{语法}：\texttt{max(x,\ na.rm\ =\ FALSE)}
\item
  \textbf{参数}：\texttt{na.rm} 控制是否忽略缺失值
\end{itemize}

\hypertarget{which.max-ux548c-which.min}{%
\paragraph{\texorpdfstring{\texttt{which.max()} 和 \texttt{which.min()}}{which.max() 和 which.min()}}\label{which.max-ux548c-which.min}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：返回最大值或最小值的\textbf{位置索引}
\item
  \textbf{语法}：\texttt{which.max(x)}
\item
  \textbf{返回值}：整数，表示最大值在向量中的位置
\item
  \textbf{应用场景}：找到最优样地、最佳条件等
\item
  \textbf{注意}：如果有多个相同的最大值，只返回第一个的位置
\end{itemize}

\hypertarget{ux6570ux636eux7ec4ux7ec7ux7b56ux7565}{%
\subsubsection{数据组织策略}\label{ux6570ux636eux7ec4ux7ec7ux7b56ux7565}}

\begin{itemize}
\tightlist
\item
  \textbf{何时使用列表}：

  \begin{itemize}
  \tightlist
  \item
    存储相关但结构不同的数据
  \item
    分组存储实验数据
  \item
    存储分析结果的不同组成部分
  \end{itemize}
\item
  \textbf{命名的重要性}：

  \begin{itemize}
  \tightlist
  \item
    提高代码可读性
  \item
    便于数据访问
  \item
    减少错误发生
  \end{itemize}
\item
  \textbf{最佳实践}：

  \begin{itemize}
  \tightlist
  \item
    使用有意义的名称
  \item
    保持命名风格一致
  \item
    适当添加注释说明数据来源
  \end{itemize}
\end{itemize}

\hypertarget{ux8bfeux540eux7ec3ux4e60-3}{%
\subsection{课后练习}\label{ux8bfeux540eux7ec3ux4e60-3}}

\textbf{题目}：某保护区三个监测站的哺乳动物目击次数：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{station\_a }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\NormalTok{station\_b }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{15}\NormalTok{, }\DecValTok{18}\NormalTok{, }\DecValTok{14}\NormalTok{, }\DecValTok{16}\NormalTok{)}
\NormalTok{station\_c }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

请完成（使用向量、列表、命名等已学内容）：
1. 将三个监测站的数据组织成一个列表（使用list()函数）

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  计算每个监测站的平均目击次数（使用mean()和列表访问）
\item
  创建一个命名向量显示三个站点的平均值（使用names()函数）
\item
  找出哪个监测站的平均目击次数最高（使用which.max()函数）
\item
  计算所有监测站的总目击次数（使用sum()和向量合并）
\item
  创建一个数据框，包含站点名称和对应的平均目击次数
\item
  比较站点A和站点B的数据变异程度（使用sd()函数计算标准差）
\end{enumerate}

\hypertarget{ux5916ux90e8ux6570ux636eux5bfcux5165ux4e0eux6761ux4ef6ux7b5bux9009ux5206ux6790}{%
\section{外部数据导入与条件筛选分析}\label{ux5916ux90e8ux6570ux636eux5bfcux5165ux4e0eux6761ux4ef6ux7b5bux9009ux5206ux6790}}

\hypertarget{ux751fux6001ux5b66ux80ccux666f-4}{%
\subsection{生态学背景}\label{ux751fux6001ux5b66ux80ccux666f-4}}

长期鸟类监测项目通常将数据保存在Excel或CSV文件中。我们需要学会将这些外部数据导入R中进行分析，并根据研究需要筛选特定时间段的数据。

\hypertarget{ux6f14ux793aux6570ux636eux6587ux4ef6bird_monitoring.csv}{%
\subsection{演示数据文件（bird\_monitoring.csv）}\label{ux6f14ux793aux6570ux636eux6587ux4ef6bird_monitoring.csv}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{date,month,species,count,observer}
\NormalTok{2023{-}03{-}15,3,白头鹎,12,张三}
\NormalTok{2023{-}03{-}15,3,麻雀,25,张三}
\NormalTok{2023{-}04{-}20,4,喜鹊,8,李四}
\NormalTok{2023{-}04{-}20,4,白头鹎,15,李四}
\NormalTok{2023{-}05{-}10,5,燕子,20,王五}
\NormalTok{2023{-}06{-}05,6,麻雀,18,张三}
\NormalTok{2023{-}06{-}05,6,白头鹎,22,张三}
\NormalTok{2023{-}07{-}12,7,喜鹊,10,李四}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-4}{%
\subsection{课堂演示过程}\label{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-4}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 1. 读取鸟类监测数据}
\NormalTok{bird\_data }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"bird\_monitoring.csv"}\NormalTok{, }\AttributeTok{stringsAsFactors =} \ConstantTok{FALSE}\NormalTok{)}

\CommentTok{\# 2. 查看数据概况}
\FunctionTok{head}\NormalTok{(bird\_data)     }\CommentTok{\# 前几行}
\FunctionTok{tail}\NormalTok{(bird\_data)     }\CommentTok{\# 后几行}
\FunctionTok{str}\NormalTok{(bird\_data)      }\CommentTok{\# 数据结构}
\FunctionTok{summary}\NormalTok{(bird\_data)  }\CommentTok{\# 数据摘要}

\CommentTok{\# 3. 查看数据维度}
\FunctionTok{nrow}\NormalTok{(bird\_data)  }\CommentTok{\# 有多少条记录}
\FunctionTok{ncol}\NormalTok{(bird\_data)  }\CommentTok{\# 有多少个变量}

\CommentTok{\# 4. 查看具体列的信息}
\FunctionTok{unique}\NormalTok{(bird\_data}\SpecialCharTok{$}\NormalTok{species)   }\CommentTok{\# 观察到哪些物种}
\FunctionTok{unique}\NormalTok{(bird\_data}\SpecialCharTok{$}\NormalTok{observer)  }\CommentTok{\# 有哪些调查员}
\FunctionTok{range}\NormalTok{(bird\_data}\SpecialCharTok{$}\NormalTok{month)      }\CommentTok{\# 调查的月份范围}

\CommentTok{\# 5. 筛选春季数据（3{-}5月）}
\NormalTok{spring\_birds }\OtherTok{\textless{}{-}} \FunctionTok{subset}\NormalTok{(bird\_data, month }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{))}
\NormalTok{spring\_birds}

\CommentTok{\# 6. 筛选特定物种}
\NormalTok{baijitou\_data }\OtherTok{\textless{}{-}} \FunctionTok{subset}\NormalTok{(bird\_data, species }\SpecialCharTok{==} \StringTok{"白头鹎"}\NormalTok{)}
\NormalTok{baijitou\_data}

\CommentTok{\# 7. 条件组合筛选}
\NormalTok{spring\_baijitou }\OtherTok{\textless{}{-}} \FunctionTok{subset}\NormalTok{(bird\_data, month }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{) }\SpecialCharTok{\&}\NormalTok{ species }\SpecialCharTok{==} \StringTok{"白头鹎"}\NormalTok{)}
\NormalTok{spring\_baijitou}

\CommentTok{\# 8. 计算统计量}
\NormalTok{total\_count }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(bird\_data}\SpecialCharTok{$}\NormalTok{count)}
\NormalTok{mean\_count }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(bird\_data}\SpecialCharTok{$}\NormalTok{count)}
\FunctionTok{paste}\NormalTok{(}\StringTok{"总观察个体数:"}\NormalTok{, total\_count, }\StringTok{"平均每次观察:"}\NormalTok{, }\FunctionTok{round}\NormalTok{(mean\_count, }\DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-4}{%
\subsection{R语言知识点详解}\label{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-4}}

\hypertarget{ux6570ux636eux5bfcux5165ux51fdux6570-read.csv}{%
\subsubsection{\texorpdfstring{数据导入函数 \texttt{read.csv()}}{数据导入函数 read.csv()}}\label{ux6570ux636eux5bfcux5165ux51fdux6570-read.csv}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：从CSV（逗号分隔值）文件中读取数据，创建数据框
\item
  \textbf{语法}：\texttt{read.csv(file,\ header\ =\ TRUE,\ sep\ =\ ",",\ stringsAsFactors\ =\ FALSE,\ ...)}
\item
  \textbf{重要参数详解}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{file}：文件路径，可以是本地文件或网络URL
  \item
    \texttt{header\ =\ TRUE}：第一行是否为列名，默认TRUE
  \item
    \texttt{sep\ =\ ","}：字段分隔符，CSV默认逗号
  \item
    \texttt{stringsAsFactors\ =\ FALSE}：是否将字符串转换为因子，建议设为FALSE
  \item
    \texttt{encoding}：文件编码，中文文件可能需要设置为''UTF-8''
  \end{itemize}
\item
  \textbf{文件路径注意事项}：

  \begin{itemize}
  \tightlist
  \item
    Windows系统使用反斜杠\texttt{\textbackslash{}}，但R中需要转义\texttt{\textbackslash{}\textbackslash{}}或使用正斜杠\texttt{/}
  \item
    使用相对路径时，基于当前工作目录
  \item
    可用\texttt{getwd()}查看当前工作目录，\texttt{setwd()}设置工作目录
  \end{itemize}
\end{itemize}

\hypertarget{ux6570ux636eux6982ux89c8ux51fdux6570ux96c6}{%
\subsubsection{数据概览函数集}\label{ux6570ux636eux6982ux89c8ux51fdux6570ux96c6}}

\hypertarget{summary---ux6570ux636eux6458ux8981}{%
\paragraph{\texorpdfstring{\texttt{summary()} - 数据摘要}{summary() - 数据摘要}}\label{summary---ux6570ux636eux6458ux8981}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：提供每列数据的统计摘要
\item
  \textbf{不同数据类型的摘要}：

  \begin{itemize}
  \tightlist
  \item
    数值型：最小值、第一四分位数、中位数、均值、第三四分位数、最大值
  \item
    字符型：长度、类别、模式
  \item
    因子型：各水平的频数
  \end{itemize}
\item
  \textbf{应用价值}：快速了解数据分布、发现异常值
\end{itemize}

\hypertarget{unique---ux552fux4e00ux503c}{%
\paragraph{\texorpdfstring{\texttt{unique()} - 唯一值}{unique() - 唯一值}}\label{unique---ux552fux4e00ux503c}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：返回向量中的所有不重复值
\item
  \textbf{语法}：\texttt{unique(x)}
\item
  \textbf{应用场景}：

  \begin{itemize}
  \tightlist
  \item
    查看分类变量的所有类别
  \item
    检查数据录入是否有错误（如拼写错误）
  \item
    了解数据的多样性
  \end{itemize}
\item
  \textbf{相关函数}：\texttt{duplicated()}检查重复值
\end{itemize}

\hypertarget{range---ux503cux57dfux8303ux56f4}{%
\paragraph{\texorpdfstring{\texttt{range()} - 值域范围}{range() - 值域范围}}\label{range---ux503cux57dfux8303ux56f4}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：返回向量的最小值和最大值
\item
  \textbf{语法}：\texttt{range(x,\ na.rm\ =\ FALSE)}
\item
  \textbf{返回值}：长度为2的向量，c(最小值, 最大值)
\item
  \textbf{应用}：快速了解数据的取值范围
\end{itemize}

\hypertarget{ux6570ux636eux7b5bux9009ux7cfbux7edf}{%
\subsubsection{数据筛选系统}\label{ux6570ux636eux7b5bux9009ux7cfbux7edf}}

\hypertarget{subset-ux51fdux6570ux63a8ux8350ux65b9ux5f0f}{%
\paragraph{\texorpdfstring{\texttt{subset()} 函数（推荐方式）}{subset() 函数（推荐方式）}}\label{subset-ux51fdux6570ux63a8ux8350ux65b9ux5f0f}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：根据条件筛选数据框的行
\item
  \textbf{语法}：\texttt{subset(x,\ subset,\ select)}
\item
  \textbf{参数详解}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{x}：要筛选的数据框
  \item
    \texttt{subset}：逻辑条件表达式
  \item
    \texttt{select}：选择的列（可选）
  \end{itemize}
\item
  \textbf{优势}：语法简洁，不需要重复写数据框名称
\end{itemize}

\hypertarget{ux903bux8f91ux64cdux4f5cux7b26ux8be6ux89e3}{%
\paragraph{逻辑操作符详解}\label{ux903bux8f91ux64cdux4f5cux7b26ux8be6ux89e3}}

\hypertarget{in-ux64cdux4f5cux7b26}{%
\subparagraph{\texorpdfstring{\texttt{\%in\%} 操作符}{\%in\% 操作符}}\label{in-ux64cdux4f5cux7b26}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：检查左边的值是否在右边的向量中
\item
  \textbf{语法}：\texttt{x\ \%in\%\ y}
\item
  \textbf{示例}：\texttt{month\ \%in\%\ c(3,\ 4,\ 5)} 检查月份是否是3、4、5中的一个
\item
  \textbf{与 \texttt{==} 的区别}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{==} 只能比较单个值
  \item
    \texttt{\%in\%} 可以同时比较多个值
  \end{itemize}
\end{itemize}

\hypertarget{ux7b49ux4e8eux64cdux4f5cux7b26}{%
\subparagraph{\texorpdfstring{\texttt{==} 等于操作符}{== 等于操作符}}\label{ux7b49ux4e8eux64cdux4f5cux7b26}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：检查两个值是否相等
\item
  \textbf{注意事项}：

  \begin{itemize}
  \tightlist
  \item
    区分大小写：\texttt{"A"\ ==\ "a"} 为FALSE
  \item
    精确匹配：\texttt{"cat"\ ==\ "cats"} 为FALSE
  \item
    用于字符串时必须完全匹配
  \end{itemize}
\end{itemize}

\hypertarget{ux903bux8f91ux4e0eux64cdux4f5cux7b26}{%
\subparagraph{\texorpdfstring{\texttt{\&} 逻辑与操作符}{\& 逻辑与操作符}}\label{ux903bux8f91ux4e0eux64cdux4f5cux7b26}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：连接多个条件，所有条件都必须为TRUE
\item
  \textbf{语法}：\texttt{条件1\ \&\ 条件2\ \&\ ...}
\item
  \textbf{相关操作符}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{\textbar{}}：逻辑或，任一条件为TRUE即可
  \item
    \texttt{!}：逻辑非，取反
  \end{itemize}
\end{itemize}

\hypertarget{ux6570ux503cux5904ux7406ux51fdux6570}{%
\subsubsection{4. 数值处理函数}\label{ux6570ux503cux5904ux7406ux51fdux6570}}

\hypertarget{round---ux56dbux820dux4e94ux5165}{%
\paragraph{\texorpdfstring{\texttt{round()} - 四舍五入}{round() - 四舍五入}}\label{round---ux56dbux820dux4e94ux5165}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{round(x,\ digits\ =\ 0)}
\item
  \textbf{参数}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{x}：要舍入的数值
  \item
    \texttt{digits}：保留的小数位数
  \end{itemize}
\item
  \textbf{应用}：美化输出结果，控制精度
\end{itemize}

\hypertarget{ux6570ux636eux5bfcux5165ux6700ux4f73ux5b9eux8df5}{%
\subsubsection{数据导入最佳实践}\label{ux6570ux636eux5bfcux5165ux6700ux4f73ux5b9eux8df5}}

\begin{itemize}
\tightlist
\item
  \textbf{文件检查}：导入前先用文本编辑器查看文件格式
\item
  \textbf{编码处理}：中文数据注意编码问题
\item
  \textbf{数据验证}：导入后立即检查数据结构和内容
\item
  \textbf{备份原始数据}：避免在原始数据上直接修改
\item
  \textbf{路径管理}：使用项目文件夹，保持文件路径的一致性
\end{itemize}

\hypertarget{ux8bfeux540eux7ec3ux4e60-4}{%
\subsection{课后练习}\label{ux8bfeux540eux7ec3ux4e60-4}}

\textbf{题目}：假设有一个植被监测数据文件包含以下列：\\
- date：调查日期\\
- season：季节（春、夏、秋、冬）\\
- plot：样地编号\\
- coverage：植被覆盖度(\%)\\
- height：平均高度(cm)

请完成（使用数据导入、数据框操作、条件筛选等已学内容）：
1. 创建模拟数据或读取数据文件

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  查看数据的基本信息（使用nrow(), ncol(), str(), summary()）
\item
  筛选夏季的数据（使用subset()函数）
\item
  筛选植被覆盖度大于80\%的记录（使用subset()函数和条件）
\item
  计算所有样地的平均植被覆盖度和平均高度（使用mean()函数）
\item
  找出覆盖度最高的样地（使用which.max()函数）
\item
  创建一个汇总报告（使用paste()函数）
\end{enumerate}

\hypertarget{ux7f3aux5931ux503cux548cux5f02ux5e38ux503cux7684ux8bc6ux522bux5904ux7406}{%
\section{缺失值和异常值的识别处理}\label{ux7f3aux5931ux503cux548cux5f02ux5e38ux503cux7684ux8bc6ux522bux5904ux7406}}

\hypertarget{ux751fux6001ux5b66ux80ccux666f-5}{%
\subsection{生态学背景}\label{ux751fux6001ux5b66ux80ccux666f-5}}

在水质监测中，由于仪器故障、人为记录错误等原因，经常出现缺失值和异常值。数据清理是生态学数据分析的重要步骤，需要识别和处理这些问题数据。

\hypertarget{ux6f14ux793aux6570ux636e-4}{%
\subsection{演示数据}\label{ux6f14ux793aux6570ux636e-4}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 湖泊水质监测数据（包含缺失值和异常值）}
\NormalTok{water\_quality }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{site\_id =} \FunctionTok{c}\NormalTok{(}\StringTok{"湖心"}\NormalTok{, }\StringTok{"入水口"}\NormalTok{, }\StringTok{"出水口"}\NormalTok{, }\StringTok{"湖心"}\NormalTok{, }\StringTok{"入水口"}\NormalTok{, }\StringTok{"出水口"}\NormalTok{),}
  \AttributeTok{date =} \FunctionTok{c}\NormalTok{(}\StringTok{"2023{-}05{-}01"}\NormalTok{, }\StringTok{"2023{-}05{-}01"}\NormalTok{, }\StringTok{"2023{-}05{-}01"}\NormalTok{, }\StringTok{"2023{-}05{-}15"}\NormalTok{, }\StringTok{"2023{-}05{-}15"}\NormalTok{, }\StringTok{"2023{-}05{-}15"}\NormalTok{),}
  \AttributeTok{pH =} \FunctionTok{c}\NormalTok{(}\FloatTok{7.2}\NormalTok{, }\FloatTok{6.8}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\FloatTok{7.5}\NormalTok{, }\FloatTok{6.9}\NormalTok{, }\FloatTok{7.1}\NormalTok{),}
  \AttributeTok{temperature\_C =} \FunctionTok{c}\NormalTok{(}\FloatTok{18.5}\NormalTok{, }\FloatTok{19.2}\NormalTok{, }\FloatTok{20.1}\NormalTok{, }\DecValTok{999}\NormalTok{, }\FloatTok{19.8}\NormalTok{, }\FloatTok{20.3}\NormalTok{),  }\CommentTok{\# 999为仪器错误读数}
  \AttributeTok{dissolved\_oxygen =} \FunctionTok{c}\NormalTok{(}\FloatTok{8.2}\NormalTok{, }\FloatTok{7.5}\NormalTok{, }\FloatTok{8.8}\NormalTok{, }\FloatTok{8.1}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\FloatTok{8.4}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-5}{%
\subsection{课堂演示过程}\label{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-5}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 1. 创建包含问题的水质数据}
\NormalTok{water\_quality }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{site\_id =} \FunctionTok{c}\NormalTok{(}\StringTok{"湖心"}\NormalTok{, }\StringTok{"入水口"}\NormalTok{, }\StringTok{"出水口"}\NormalTok{, }\StringTok{"湖心"}\NormalTok{, }\StringTok{"入水口"}\NormalTok{, }\StringTok{"出水口"}\NormalTok{),}
  \AttributeTok{date =} \FunctionTok{c}\NormalTok{(}\StringTok{"2023{-}05{-}01"}\NormalTok{, }\StringTok{"2023{-}05{-}01"}\NormalTok{, }\StringTok{"2023{-}05{-}01"}\NormalTok{, }\StringTok{"2023{-}05{-}15"}\NormalTok{, }\StringTok{"2023{-}05{-}15"}\NormalTok{, }\StringTok{"2023{-}05{-}15"}\NormalTok{),}
  \AttributeTok{pH =} \FunctionTok{c}\NormalTok{(}\FloatTok{7.2}\NormalTok{, }\FloatTok{6.8}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\FloatTok{7.5}\NormalTok{, }\FloatTok{6.9}\NormalTok{, }\FloatTok{7.1}\NormalTok{),}
  \AttributeTok{temperature\_C =} \FunctionTok{c}\NormalTok{(}\FloatTok{18.5}\NormalTok{, }\FloatTok{19.2}\NormalTok{, }\FloatTok{20.1}\NormalTok{, }\DecValTok{999}\NormalTok{, }\FloatTok{19.8}\NormalTok{, }\FloatTok{20.3}\NormalTok{),}
  \AttributeTok{dissolved\_oxygen =} \FunctionTok{c}\NormalTok{(}\FloatTok{8.2}\NormalTok{, }\FloatTok{7.5}\NormalTok{, }\FloatTok{8.8}\NormalTok{, }\FloatTok{8.1}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\FloatTok{8.4}\NormalTok{)}
\NormalTok{)}

\CommentTok{\# 2. 查看原始数据}
\FunctionTok{print}\NormalTok{(water\_quality)}
\FunctionTok{str}\NormalTok{(water\_quality)}

\CommentTok{\# 3. 检查缺失值}
\FunctionTok{is.na}\NormalTok{(water\_quality)  }\CommentTok{\# 显示所有缺失值位置}
\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(water\_quality}\SpecialCharTok{$}\NormalTok{pH))  }\CommentTok{\# pH缺失值个数}
\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(water\_quality}\SpecialCharTok{$}\NormalTok{dissolved\_oxygen))  }\CommentTok{\# 溶解氧缺失值个数}

\CommentTok{\# 4. 识别异常值}
\FunctionTok{summary}\NormalTok{(water\_quality}\SpecialCharTok{$}\NormalTok{temperature\_C)  }\CommentTok{\# 查看温度的统计摘要}
\NormalTok{water\_quality}\SpecialCharTok{$}\NormalTok{temperature\_C }\SpecialCharTok{\textgreater{}} \DecValTok{50}  \CommentTok{\# 找出不合理的高温值}

\CommentTok{\# 5. 处理缺失值 {-} 用均值填补}
\NormalTok{ph\_mean }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(water\_quality}\SpecialCharTok{$}\NormalTok{pH, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)  }\CommentTok{\# 计算pH均值（忽略NA）}
\NormalTok{water\_quality}\SpecialCharTok{$}\NormalTok{pH[}\FunctionTok{is.na}\NormalTok{(water\_quality}\SpecialCharTok{$}\NormalTok{pH)] }\OtherTok{\textless{}{-}}\NormalTok{ ph\_mean}

\CommentTok{\# 6. 处理异常值 {-} 替换为NA}
\NormalTok{water\_quality}\SpecialCharTok{$}\NormalTok{temperature\_C[water\_quality}\SpecialCharTok{$}\NormalTok{temperature\_C }\SpecialCharTok{\textgreater{}} \DecValTok{50}\NormalTok{] }\OtherTok{\textless{}{-}} \ConstantTok{NA}

\CommentTok{\# 7. 查看清理后的数据}
\FunctionTok{print}\NormalTok{(water\_quality)}

\CommentTok{\# 8. 删除包含NA的整行（如果需要）}
\NormalTok{clean\_data }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(water\_quality)}
\FunctionTok{print}\NormalTok{(clean\_data)}

\CommentTok{\# 9. 计算清理后的统计量}
\FunctionTok{mean}\NormalTok{(clean\_data}\SpecialCharTok{$}\NormalTok{temperature\_C)}
\FunctionTok{mean}\NormalTok{(clean\_data}\SpecialCharTok{$}\NormalTok{pH)}
\FunctionTok{mean}\NormalTok{(clean\_data}\SpecialCharTok{$}\NormalTok{dissolved\_oxygen)}
\end{Highlighting}
\end{Shaded}

\hypertarget{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-5}{%
\subsection{R语言知识点详解}\label{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-5}}

\hypertarget{ux7f3aux5931ux503cmissing-valuesux5904ux7406ux7cfbux7edf}{%
\subsubsection{缺失值（Missing Values）处理系统}\label{ux7f3aux5931ux503cmissing-valuesux5904ux7406ux7cfbux7edf}}

\hypertarget{ux7f3aux5931ux503cux7684ux6982ux5ff5}{%
\paragraph{缺失值的概念}\label{ux7f3aux5931ux503cux7684ux6982ux5ff5}}

\begin{itemize}
\tightlist
\item
  \textbf{什么是NA}：Not Available的缩写，表示缺失或不可用的数据
\item
  \textbf{NA的特点}：

  \begin{itemize}
  \tightlist
  \item
    任何包含NA的运算结果都是NA
  \item
    NA具有传染性：\texttt{1\ +\ NA\ =\ NA}
  \item
    NA不等于任何值，包括它自己：\texttt{NA\ ==\ NA} 返回NA而不是TRUE
  \end{itemize}
\end{itemize}

\hypertarget{is.na-ux51fdux6570}{%
\paragraph{\texorpdfstring{\texttt{is.na()} 函数}{is.na() 函数}}\label{is.na-ux51fdux6570}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：检测缺失值的位置
\item
  \textbf{语法}：\texttt{is.na(x)}
\item
  \textbf{返回值}：与输入同样结构的逻辑向量/矩阵，TRUE表示缺失
\item
  \textbf{应用方式}：

  \begin{itemize}
  \tightlist
  \item
    检查单个向量：\texttt{is.na(vector)}
  \item
    检查整个数据框：\texttt{is.na(data.frame)}
  \item
    统计缺失值数量：\texttt{sum(is.na(vector))}
  \end{itemize}
\end{itemize}

\hypertarget{na.rm-ux53c2ux6570}{%
\paragraph{\texorpdfstring{\texttt{na.rm} 参数}{na.rm 参数}}\label{na.rm-ux53c2ux6570}}

\begin{itemize}
\item
  \textbf{作用}：在统计计算中移除缺失值
\item
  \textbf{语法}：\texttt{function(x,\ na.rm\ =\ FALSE)}
\item
  \textbf{适用函数}：\texttt{mean()}, \texttt{sum()}, \texttt{max()}, \texttt{min()}, \texttt{sd()}등
\item
  \textbf{重要性}：不设置\texttt{na.rm\ =\ TRUE}时，有NA的计算结果都是NA
\item
  \textbf{示例对比}：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\FunctionTok{mean}\NormalTok{(x)           }\CommentTok{\# 返回 NA}
\FunctionTok{mean}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)  }\CommentTok{\# 返回 2.33}
\end{Highlighting}
\end{Shaded}
\end{itemize}

\hypertarget{na.omit-ux51fdux6570}{%
\paragraph{\texorpdfstring{\texttt{na.omit()} 函数}{na.omit() 函数}}\label{na.omit-ux51fdux6570}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：删除包含任何缺失值的完整行
\item
  \textbf{语法}：\texttt{na.omit(x)}
\item
  \textbf{返回值}：不含任何NA的数据框
\item
  \textbf{注意事项}：

  \begin{itemize}
  \tightlist
  \item
    可能导致大量数据丢失
  \item
    需要评估删除行对分析的影响
  \item
    适合缺失值较少且随机分布的情况
  \end{itemize}
\end{itemize}

\hypertarget{ux5f02ux5e38ux503coutliersux8bc6ux522bux4e0eux5904ux7406}{%
\subsubsection{异常值（Outliers）识别与处理}\label{ux5f02ux5e38ux503coutliersux8bc6ux522bux4e0eux5904ux7406}}

\hypertarget{ux5f02ux5e38ux503cux7684ux8bc6ux522bux65b9ux6cd5}{%
\paragraph{异常值的识别方法}\label{ux5f02ux5e38ux503cux7684ux8bc6ux522bux65b9ux6cd5}}

\begin{itemize}
\tightlist
\item
  \textbf{统计方法}：使用\texttt{summary()}查看数据分布，识别明显不合理的值
\item
  \textbf{业务逻辑}：基于专业知识判断，如温度999°C明显错误
\item
  \textbf{可视化方法}：使用箱线图、散点图等发现异常值
\item
  \textbf{统计阈值}：如超出3倍标准差的值
\end{itemize}

\hypertarget{ux5f02ux5e38ux503cux5904ux7406ux7b56ux7565}{%
\paragraph{异常值处理策略}\label{ux5f02ux5e38ux503cux5904ux7406ux7b56ux7565}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{删除异常值}：适用于明显的录入错误
\item
  \textbf{替换为NA}：保留数据结构，标记为缺失
\item
  \textbf{替换为合理值}：用中位数、均值等替换
\item
  \textbf{保留但标记}：在分析中特殊处理
\end{enumerate}

\hypertarget{ux6761ux4ef6ux66ffux6362ux6280ux672f}{%
\subsubsection{条件替换技术}\label{ux6761ux4ef6ux66ffux6362ux6280ux672f}}

\hypertarget{ux903bux8f91ux7d22ux5f15ux66ffux6362}{%
\paragraph{逻辑索引替换}\label{ux903bux8f91ux7d22ux5f15ux66ffux6362}}

\begin{itemize}
\item
  \textbf{语法}：\texttt{data{[}condition{]}\ \textless{}-\ new\_value}
\item
  \textbf{原理}：通过逻辑条件选择满足条件的元素进行替换
\item
  \textbf{示例}：

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 将所有负值替换为0}
\NormalTok{data[data }\SpecialCharTok{\textless{}} \DecValTok{0}\NormalTok{] }\OtherTok{\textless{}{-}} \DecValTok{0}

\CommentTok{\# 将异常高值替换为NA}
\NormalTok{data[data }\SpecialCharTok{\textgreater{}}\NormalTok{ threshold] }\OtherTok{\textless{}{-}} \ConstantTok{NA}
\end{Highlighting}
\end{Shaded}
\end{itemize}

\hypertarget{which-ux51fdux6570}{%
\paragraph{\texorpdfstring{\texttt{which()} 函数}{which() 函数}}\label{which-ux51fdux6570}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：返回满足条件的元素位置索引
\item
  \textbf{语法}：\texttt{which(condition)}
\item
  \textbf{与直接逻辑索引的区别}：

  \begin{itemize}
  \tightlist
  \item
    逻辑索引：返回TRUE/FALSE向量
  \item
    \texttt{which()}：返回位置数字向量
  \end{itemize}
\item
  \textbf{应用}：当需要知道具体位置时使用
\end{itemize}

\hypertarget{ux6570ux636eux6e05ux7406ux6d41ux7a0bux548cux6700ux4f73ux5b9eux8df5}{%
\subsubsection{数据清理流程和最佳实践}\label{ux6570ux636eux6e05ux7406ux6d41ux7a0bux548cux6700ux4f73ux5b9eux8df5}}

\hypertarget{ux6807ux51c6ux6570ux636eux6e05ux7406ux6d41ux7a0b}{%
\paragraph{标准数据清理流程}\label{ux6807ux51c6ux6570ux636eux6e05ux7406ux6d41ux7a0b}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{数据探索}：使用\texttt{str()}, \texttt{summary()}, \texttt{head()}, \texttt{tail()}了解数据
\item
  \textbf{缺失值检查}：使用\texttt{is.na()}, \texttt{sum(is.na())}统计缺失情况
\item
  \textbf{异常值识别}：结合统计和专业知识识别异常值
\item
  \textbf{清理决策}：选择合适的处理方法
\item
  \textbf{执行清理}：应用处理方法
\item
  \textbf{验证结果}：检查清理后的数据质量
\end{enumerate}

\hypertarget{ux6570ux636eux6e05ux7406ux7684ux6ce8ux610fux4e8bux9879}{%
\paragraph{数据清理的注意事项}\label{ux6570ux636eux6e05ux7406ux7684ux6ce8ux610fux4e8bux9879}}

\begin{itemize}
\tightlist
\item
  \textbf{保留原始数据}：清理前备份原始数据
\item
  \textbf{记录清理过程}：文档化所有清理步骤和决策理由
\item
  \textbf{验证合理性}：确保清理后的数据符合业务逻辑
\item
  \textbf{评估影响}：分析清理对后续分析的影响
\end{itemize}

\hypertarget{ux7f3aux5931ux503cux586bux8865ux65b9ux6cd5ux9009ux62e9}{%
\paragraph{缺失值填补方法选择}\label{ux7f3aux5931ux503cux586bux8865ux65b9ux6cd5ux9009ux62e9}}

\begin{itemize}
\tightlist
\item
  \textbf{均值填补}：适用于数值变量，数据接近正态分布
\item
  \textbf{中位数填补}：适用于有偏斜的数值变量
\item
  \textbf{众数填补}：适用于分类变量
\item
  \textbf{前向/后向填补}：适用于时间序列数据
\item
  \textbf{预测模型填补}：基于其他变量预测缺失值
\end{itemize}

\hypertarget{ux8bfeux540eux7ec3ux4e60-5}{%
\subsection{课后练习}\label{ux8bfeux540eux7ec3ux4e60-5}}

\textbf{题目}：某森林土壤调查数据：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{soil\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{plot =} \FunctionTok{c}\NormalTok{(}\StringTok{"A1"}\NormalTok{, }\StringTok{"A2"}\NormalTok{, }\StringTok{"A3"}\NormalTok{, }\StringTok{"B1"}\NormalTok{, }\StringTok{"B2"}\NormalTok{, }\StringTok{"B3"}\NormalTok{),}
  \AttributeTok{organic\_matter =} \FunctionTok{c}\NormalTok{(}\FloatTok{3.2}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\FloatTok{2.8}\NormalTok{, }\FloatTok{3.5}\NormalTok{, }\FloatTok{2.9}\NormalTok{, }\FloatTok{3.1}\NormalTok{),}
  \AttributeTok{nitrogen\_mg =} \FunctionTok{c}\NormalTok{(}\DecValTok{45}\NormalTok{, }\DecValTok{52}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{10}\NormalTok{, }\DecValTok{48}\NormalTok{, }\DecValTok{51}\NormalTok{, }\DecValTok{49}\NormalTok{),  }\CommentTok{\# {-}10为异常负值}
  \AttributeTok{moisture =} \FunctionTok{c}\NormalTok{(}\FloatTok{25.5}\NormalTok{, }\FloatTok{28.2}\NormalTok{, }\FloatTok{22.1}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\FloatTok{26.8}\NormalTok{, }\FloatTok{24.9}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

请完成（使用缺失值处理、条件判断、数据清理等已学内容）：
1. 检查每列的缺失值个数（使用is.na()和sum()函数）

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  识别nitrogen\_mg列中的异常值（使用逻辑判断和which()函数）
\item
  用均值填补organic\_matter的缺失值（使用mean()和na.rm参数）
\item
  将nitrogen\_mg中的异常值替换为NA（使用条件赋值）
\item
  创建一个完全没有缺失值的干净数据集（使用na.omit()）
\item
  计算清理后数据的各项平均值（使用mean()函数）
\item
  对比清理前后数据的summary()结果
\end{enumerate}

\hypertarget{ux63cfux8ff0ux6027ux7edfux8ba1ux5206ux6790ux4e0eux57faux7840ux6570ux636eux53efux89c6ux5316}{%
\section{描述性统计分析与基础数据可视化}\label{ux63cfux8ff0ux6027ux7edfux8ba1ux5206ux6790ux4e0eux57faux7840ux6570ux636eux53efux89c6ux5316}}

\hypertarget{ux751fux6001ux5b66ux80ccux666f-6}{%
\subsection{生态学背景}\label{ux751fux6001ux5b66ux80ccux666f-6}}

不同森林类型的物种多样性存在显著差异。通过比较松林、栎林、混交林的物种数量，我们可以了解森林结构对生物多样性的影响。这需要用到描述性统计和基础可视化。

\hypertarget{ux6f14ux793aux6570ux636e-5}{%
\subsection{演示数据}\label{ux6f14ux793aux6570ux636e-5}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 三种森林类型各5个样地的物种数量}
\NormalTok{pine\_forest }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{22}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{28}\NormalTok{, }\DecValTok{24}\NormalTok{)      }\CommentTok{\# 松林}
\NormalTok{oak\_forest }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{35}\NormalTok{, }\DecValTok{32}\NormalTok{, }\DecValTok{38}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{34}\NormalTok{)       }\CommentTok{\# 栎林  }
\NormalTok{mixed\_forest }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{45}\NormalTok{, }\DecValTok{42}\NormalTok{, }\DecValTok{48}\NormalTok{, }\DecValTok{40}\NormalTok{, }\DecValTok{46}\NormalTok{)     }\CommentTok{\# 混交林}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-6}{%
\subsection{课堂演示过程}\label{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-6}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 1. 创建三种森林类型数据}
\NormalTok{pine\_forest }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{22}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{28}\NormalTok{, }\DecValTok{24}\NormalTok{)}
\NormalTok{oak\_forest }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{35}\NormalTok{, }\DecValTok{32}\NormalTok{, }\DecValTok{38}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{34}\NormalTok{)  }
\NormalTok{mixed\_forest }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{45}\NormalTok{, }\DecValTok{42}\NormalTok{, }\DecValTok{48}\NormalTok{, }\DecValTok{40}\NormalTok{, }\DecValTok{46}\NormalTok{)}

\CommentTok{\# 2. 计算描述性统计}
\CommentTok{\# 平均值}
\NormalTok{pine\_mean }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(pine\_forest)}
\NormalTok{oak\_mean }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(oak\_forest)}
\NormalTok{mixed\_mean }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(mixed\_forest)}

\CommentTok{\# 标准差}
\NormalTok{pine\_sd }\OtherTok{\textless{}{-}} \FunctionTok{sd}\NormalTok{(pine\_forest)}
\NormalTok{oak\_sd }\OtherTok{\textless{}{-}} \FunctionTok{sd}\NormalTok{(oak\_forest)}
\NormalTok{mixed\_sd }\OtherTok{\textless{}{-}} \FunctionTok{sd}\NormalTok{(mixed\_forest)}

\CommentTok{\# 最大值和最小值}
\FunctionTok{range}\NormalTok{(pine\_forest)}
\FunctionTok{range}\NormalTok{(oak\_forest)}
\FunctionTok{range}\NormalTok{(mixed\_forest)}

\CommentTok{\# 3. 创建汇总表}
\NormalTok{forest\_summary }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
\NormalTok{  森林类型 }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"松林"}\NormalTok{, }\StringTok{"栎林"}\NormalTok{, }\StringTok{"混交林"}\NormalTok{),}
\NormalTok{  平均物种数 }\OtherTok{=} \FunctionTok{c}\NormalTok{(pine\_mean, oak\_mean, mixed\_mean),}
\NormalTok{  标准差 }\OtherTok{=} \FunctionTok{c}\NormalTok{(pine\_sd, oak\_sd, mixed\_sd),}
\NormalTok{  最大值 }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\FunctionTok{max}\NormalTok{(pine\_forest), }\FunctionTok{max}\NormalTok{(oak\_forest), }\FunctionTok{max}\NormalTok{(mixed\_forest)),}
\NormalTok{  最小值 }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\FunctionTok{min}\NormalTok{(pine\_forest), }\FunctionTok{min}\NormalTok{(oak\_forest), }\FunctionTok{min}\NormalTok{(mixed\_forest))}
\NormalTok{)}
\FunctionTok{print}\NormalTok{(forest\_summary)}

\CommentTok{\# 4. 箱线图比较}
\FunctionTok{boxplot}\NormalTok{(pine\_forest, oak\_forest, mixed\_forest,}
        \AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"松林"}\NormalTok{, }\StringTok{"栎林"}\NormalTok{, }\StringTok{"混交林"}\NormalTok{),}
        \AttributeTok{ylab =} \StringTok{"物种数量"}\NormalTok{, }
        \AttributeTok{main =} \StringTok{"不同森林类型物种多样性比较"}\NormalTok{,}
        \AttributeTok{col =} \FunctionTok{c}\NormalTok{(}\StringTok{"lightgreen"}\NormalTok{, }\StringTok{"lightblue"}\NormalTok{, }\StringTok{"lightyellow"}\NormalTok{))}

\CommentTok{\# 5. 添加平均值点}
\FunctionTok{points}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\FunctionTok{c}\NormalTok{(pine\_mean, oak\_mean, mixed\_mean), }
       \AttributeTok{col =} \StringTok{"red"}\NormalTok{, }\AttributeTok{pch =} \DecValTok{19}\NormalTok{, }\AttributeTok{cex =} \FloatTok{1.5}\NormalTok{)}

\CommentTok{\# 6. 条形图显示平均值}
\FunctionTok{barplot}\NormalTok{(}\FunctionTok{c}\NormalTok{(pine\_mean, oak\_mean, mixed\_mean),}
        \AttributeTok{names.arg =} \FunctionTok{c}\NormalTok{(}\StringTok{"松林"}\NormalTok{, }\StringTok{"栎林"}\NormalTok{, }\StringTok{"混交林"}\NormalTok{),}
        \AttributeTok{ylab =} \StringTok{"平均物种数"}\NormalTok{,}
        \AttributeTok{main =} \StringTok{"各森林类型平均物种数量"}\NormalTok{,}
        \AttributeTok{col =} \FunctionTok{c}\NormalTok{(}\StringTok{"lightgreen"}\NormalTok{, }\StringTok{"lightblue"}\NormalTok{, }\StringTok{"lightyellow"}\NormalTok{))}

\CommentTok{\# 7. 方差分析(简单介绍)}
\NormalTok{all\_data }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(pine\_forest, oak\_forest, mixed\_forest)}
\NormalTok{forest\_type }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"松林"}\NormalTok{, }\StringTok{"栎林"}\NormalTok{, }\StringTok{"混交林"}\NormalTok{), }\AttributeTok{each =} \DecValTok{5}\NormalTok{)}
\NormalTok{forest\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{species\_count =}\NormalTok{ all\_data, }\AttributeTok{type =}\NormalTok{ forest\_type)}
\end{Highlighting}
\end{Shaded}

\hypertarget{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-6}{%
\subsection{R语言知识点详解}\label{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-6}}

\hypertarget{ux63cfux8ff0ux6027ux7edfux8ba1ux51fdux6570ux6df1ux5165ux89e3ux6790}{%
\subsubsection{描述性统计函数深入解析}\label{ux63cfux8ff0ux6027ux7edfux8ba1ux51fdux6570ux6df1ux5165ux89e3ux6790}}

\hypertarget{sd---ux6807ux51c6ux5deeux51fdux6570}{%
\paragraph{\texorpdfstring{\texttt{sd()} - 标准差函数}{sd() - 标准差函数}}\label{sd---ux6807ux51c6ux5deeux51fdux6570}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：计算样本标准差，衡量数据的离散程度
\item
  \textbf{语法}：\texttt{sd(x,\ na.rm\ =\ FALSE)}
\item
  \textbf{数学含义}：

  \begin{itemize}
  \tightlist
  \item
    标准差越大，数据越分散
  \item
    标准差越小，数据越集中在均值附近
  \item
    单位与原数据相同
  \end{itemize}
\item
  \textbf{与方差的关系}：标准差 = √方差
\item
  \textbf{相关函数}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{var()}：计算方差
  \item
    \texttt{mad()}：计算中位数绝对偏差（对异常值更稳健）
  \end{itemize}
\end{itemize}

\hypertarget{range---ux503cux57dfux51fdux6570}{%
\paragraph{\texorpdfstring{\texttt{range()} - 值域函数}{range() - 值域函数}}\label{range---ux503cux57dfux51fdux6570}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：返回最小值和最大值组成的向量
\item
  \textbf{语法}：\texttt{range(x,\ na.rm\ =\ FALSE)}
\item
  \textbf{返回值}：长度为2的数值向量 c(min, max)
\item
  \textbf{应用}：

  \begin{itemize}
  \tightlist
  \item
    快速了解数据的取值范围
  \item
    检查数据是否在合理范围内
  \item
    设置图形的坐标轴范围
  \end{itemize}
\end{itemize}

\hypertarget{rux57faux7840ux7ed8ux56feux7cfbux7edfux8be6ux89e3}{%
\subsubsection{R基础绘图系统详解}\label{rux57faux7840ux7ed8ux56feux7cfbux7edfux8be6ux89e3}}

\hypertarget{boxplot---ux7bb1ux7ebfux56feux51fdux6570}{%
\paragraph{\texorpdfstring{\texttt{boxplot()} - 箱线图函数}{boxplot() - 箱线图函数}}\label{boxplot---ux7bb1ux7ebfux56feux51fdux6570}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：绘制箱线图，显示数据的分布特征
\item
  \textbf{语法}：\texttt{boxplot(...,\ names,\ main,\ xlab,\ ylab,\ col)}
\item
  \textbf{箱线图解读}：

  \begin{itemize}
  \tightlist
  \item
    盒子：第一四分位数(Q1)到第三四分位数(Q3)，包含50\%的数据
  \item
    中线：中位数(Q2)
  \item
    须线：延伸到1.5倍四分位数间距的范围
  \item
    点：超出须线的异常值
  \end{itemize}
\item
  \textbf{参数详解}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{names}：各组的标签
  \item
    \texttt{main}：图形标题
  \item
    \texttt{xlab}, \texttt{ylab}：x轴和y轴标签
  \item
    \texttt{col}：填充颜色
  \item
    \texttt{border}：边框颜色
  \item
    \texttt{notch}：是否显示置信区间缺口
  \end{itemize}
\end{itemize}

\hypertarget{barplot---ux6761ux5f62ux56feux51fdux6570}{%
\paragraph{\texorpdfstring{\texttt{barplot()} - 条形图函数}{barplot() - 条形图函数}}\label{barplot---ux6761ux5f62ux56feux51fdux6570}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：绘制条形图，比较不同组的数值
\item
  \textbf{语法}：\texttt{barplot(height,\ names.arg,\ main,\ xlab,\ ylab,\ col)}
\item
  \textbf{参数详解}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{height}：条形的高度值
  \item
    \texttt{names.arg}：条形的标签
  \item
    \texttt{beside}：并排显示多组数据时设为TRUE
  \item
    \texttt{horiz}：是否绘制水平条形图
  \end{itemize}
\item
  \textbf{应用场景}：

  \begin{itemize}
  \tightlist
  \item
    比较不同组的均值
  \item
    显示分类数据的频数
  \item
    展示比例或百分比
  \end{itemize}
\end{itemize}

\hypertarget{ux56feux5f62ux53c2ux6570ux548cux7f8eux5316}{%
\subsubsection{图形参数和美化}\label{ux56feux5f62ux53c2ux6570ux548cux7f8eux5316}}

\hypertarget{ux989cux8272ux53c2ux6570-col}{%
\paragraph{\texorpdfstring{颜色参数 \texttt{col}}{颜色参数 col}}\label{ux989cux8272ux53c2ux6570-col}}

\begin{itemize}
\tightlist
\item
  \textbf{预定义颜色}：\texttt{"red"}, \texttt{"blue"}, \texttt{"green"} 等
\item
  \textbf{颜色名称}：\texttt{colors()} 查看所有可用颜色名称
\item
  \textbf{十六进制}：\texttt{"\#FF0000"} (红色)
\item
  \textbf{RGB函数}：\texttt{rgb(1,\ 0,\ 0)} (红色)
\item
  \textbf{颜色向量}：为不同元素指定不同颜色
\end{itemize}

\hypertarget{ux70b9ux7684ux5f62ux72b6ux53c2ux6570-pch}{%
\paragraph{\texorpdfstring{点的形状参数 \texttt{pch}}{点的形状参数 pch}}\label{ux70b9ux7684ux5f62ux72b6ux53c2ux6570-pch}}

\begin{itemize}
\tightlist
\item
  \textbf{常用形状}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{pch\ =\ 1}：空心圆 ○
  \item
    \texttt{pch\ =\ 19}：实心圆 ●
  \item
    \texttt{pch\ =\ 2}：空心三角形 △
  \item
    \texttt{pch\ =\ 17}：实心三角形 ▲
  \item
    \texttt{pch\ =\ 15}：实心方形 ■
  \end{itemize}
\item
  \textbf{字符形状}：\texttt{pch\ =\ "A"} 使用字符A作为点
\end{itemize}

\hypertarget{ux5927ux5c0fux53c2ux6570-cex}{%
\paragraph{\texorpdfstring{大小参数 \texttt{cex}}{大小参数 cex}}\label{ux5927ux5c0fux53c2ux6570-cex}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：控制图形元素的大小
\item
  \textbf{默认值}：1.0
\item
  \textbf{用法}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{cex\ =\ 1.5}：放大1.5倍
  \item
    \texttt{cex\ =\ 0.8}：缩小为0.8倍
  \end{itemize}
\item
  \textbf{相关参数}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{cex.main}：标题大小
  \item
    \texttt{cex.lab}：轴标签大小
  \item
    \texttt{cex.axis}：轴数字大小
  \end{itemize}
\end{itemize}

\hypertarget{ux56feux5f62ux53e0ux52a0ux548cux589eux5f3a}{%
\subsubsection{图形叠加和增强}\label{ux56feux5f62ux53e0ux52a0ux548cux589eux5f3a}}

\hypertarget{points---ux6dfbux52a0ux70b9}{%
\paragraph{\texorpdfstring{\texttt{points()} - 添加点}{points() - 添加点}}\label{points---ux6dfbux52a0ux70b9}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：在现有图形上添加点
\item
  \textbf{语法}：\texttt{points(x,\ y,\ col,\ pch,\ cex)}
\item
  \textbf{坐标系统}：使用与原图相同的坐标系统
\item
  \textbf{应用}：在箱线图上标记均值、在散点图上突出特定点
\end{itemize}

\hypertarget{ux56feux5f62ux53e0ux52a0ux7684ux539fux7406}{%
\paragraph{图形叠加的原理}\label{ux56feux5f62ux53e0ux52a0ux7684ux539fux7406}}

\begin{itemize}
\tightlist
\item
  \textbf{图层概念}：R绘图采用图层叠加的方式
\item
  \textbf{顺序重要}：后绘制的元素会覆盖先绘制的元素
\item
  \textbf{坐标统一}：所有叠加元素必须使用相同的坐标系统
\end{itemize}

\hypertarget{ux6570ux636eux91cdux7ec4ux548cux6574ux7406}{%
\subsubsection{数据重组和整理}\label{ux6570ux636eux91cdux7ec4ux548cux6574ux7406}}

\hypertarget{rep---ux91cdux590dux51fdux6570}{%
\paragraph{\texorpdfstring{\texttt{rep()} - 重复函数}{rep() - 重复函数}}\label{rep---ux91cdux590dux51fdux6570}}

\begin{itemize}
\item
  \textbf{作用}：重复向量元素
\item
  \textbf{语法}：\texttt{rep(x,\ times,\ each,\ length.out)}
\item
  \textbf{参数说明}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{times}：整个向量重复的次数
  \item
    \texttt{each}：每个元素重复的次数
  \item
    \texttt{length.out}：输出向量的长度
  \end{itemize}
\item
  \textbf{示例}：

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{), }\AttributeTok{times =} \DecValTok{2}\NormalTok{)    }\CommentTok{\# "A" "B" "A" "B"}
\FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{), }\AttributeTok{each =} \DecValTok{2}\NormalTok{)     }\CommentTok{\# "A" "A" "B" "B"}
\FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{), }\AttributeTok{length.out =} \DecValTok{5}\NormalTok{) }\CommentTok{\# "A" "B" "A" "B" "A"}
\end{Highlighting}
\end{Shaded}
\end{itemize}

\hypertarget{ux56feux5f62ux8bbeux8ba1ux6700ux4f73ux5b9eux8df5}{%
\subsubsection{图形设计最佳实践}\label{ux56feux5f62ux8bbeux8ba1ux6700ux4f73ux5b9eux8df5}}

\hypertarget{ux8272ux5f69ux9009ux62e9ux539fux5219}{%
\paragraph{色彩选择原则}\label{ux8272ux5f69ux9009ux62e9ux539fux5219}}

\begin{itemize}
\tightlist
\item
  \textbf{对比度}：确保不同组别容易区分
\item
  \textbf{色盲友好}：避免仅依赖红绿色区分
\item
  \textbf{一致性}：同一类型数据使用相同色系
\item
  \textbf{专业性}：避免过于鲜艳的颜色
\end{itemize}

\hypertarget{ux6807ux7b7eux548cux6807ux9898}{%
\paragraph{标签和标题}\label{ux6807ux7b7eux548cux6807ux9898}}

\begin{itemize}
\tightlist
\item
  \textbf{信息完整}：包含变量名称和单位
\item
  \textbf{简洁明了}：避免过长的标题
\item
  \textbf{中文支持}：确保中文字符正确显示
\end{itemize}

\hypertarget{ux56feux5f62ux5c3aux5bf8ux548cux6bd4ux4f8b}{%
\paragraph{图形尺寸和比例}\label{ux56feux5f62ux5c3aux5bf8ux548cux6bd4ux4f8b}}

\begin{itemize}
\tightlist
\item
  \textbf{合适的比例}：避免图形过于压缩或拉伸
\item
  \textbf{合理的尺寸}：适合展示媒介的大小
\item
  \textbf{留白空间}：给图形元素足够的空间
\end{itemize}

\hypertarget{ux8bfeux540eux7ec3ux4e60-6}{%
\subsection{课后练习}\label{ux8bfeux540eux7ec3ux4e60-6}}

\textbf{题目}：某保护区三种植被类型的蝴蝶物种数调查：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{shrubland }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{12}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{14}\NormalTok{, }\DecValTok{13}\NormalTok{)    }\CommentTok{\# 灌丛}
\NormalTok{meadow }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{18}\NormalTok{, }\DecValTok{22}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{19}\NormalTok{, }\DecValTok{21}\NormalTok{)       }\CommentTok{\# 草甸}
\NormalTok{riparian }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{25}\NormalTok{, }\DecValTok{28}\NormalTok{, }\DecValTok{23}\NormalTok{, }\DecValTok{27}\NormalTok{, }\DecValTok{26}\NormalTok{)     }\CommentTok{\# 河岸林}
\end{Highlighting}
\end{Shaded}

请完成（使用描述统计、基础绘图等已学内容）：

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  计算三种植被类型的平均物种数和标准差（使用mean()和sd()函数）
\item
  创建一个汇总表显示基本统计信息（使用data.frame()）
\item
  绘制箱线图比较三种植被类型（使用boxplot()函数）
\item
  绘制条形图显示平均物种数（使用barplot()函数）
\item
  在箱线图上添加平均值点（使用points()函数）
\item
  判断哪种植被类型的蝴蝶多样性最高（使用which.max()和max()函数）
\item
  计算每种植被类型的变异系数（标准差/平均值×100）
\end{enumerate}

\hypertarget{ux6761ux4ef6ux5224ux65adux5faaux73afux7ed3ux6784ux4e0eux51fdux6570ux7f16ux7a0b}{%
\section{条件判断、循环结构与函数编程}\label{ux6761ux4ef6ux5224ux65adux5faaux73afux7ed3ux6784ux4e0eux51fdux6570ux7f16ux7a0b}}

\hypertarget{ux751fux6001ux5b66ux80ccux666f-7}{%
\subsection{生态学背景}\label{ux751fux6001ux5b66ux80ccux666f-7}}

在群落生态学研究中，经常需要根据不同条件对物种进行分类处理，或者对大量样地数据进行批量处理。这需要用到编程中的条件判断和循环结构，让R能够自动化完成重复性工作。

\hypertarget{ux6f14ux793aux6570ux636e-6}{%
\subsection{演示数据}\label{ux6f14ux793aux6570ux636e-6}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 某自然保护区不同海拔的物种调查数据}
\NormalTok{sites\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{site\_id =} \FunctionTok{paste0}\NormalTok{(}\StringTok{"S"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{),}
  \AttributeTok{elevation =} \FunctionTok{c}\NormalTok{(}\DecValTok{1200}\NormalTok{, }\DecValTok{1450}\NormalTok{, }\DecValTok{1800}\NormalTok{, }\DecValTok{2100}\NormalTok{, }\DecValTok{2350}\NormalTok{, }\DecValTok{1650}\NormalTok{, }\DecValTok{1900}\NormalTok{, }\DecValTok{2200}\NormalTok{, }\DecValTok{1750}\NormalTok{, }\DecValTok{2050}\NormalTok{),}
  \AttributeTok{species\_count =} \FunctionTok{c}\NormalTok{(}\DecValTok{45}\NormalTok{, }\DecValTok{52}\NormalTok{, }\DecValTok{38}\NormalTok{, }\DecValTok{28}\NormalTok{, }\DecValTok{22}\NormalTok{, }\DecValTok{48}\NormalTok{, }\DecValTok{35}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{42}\NormalTok{, }\DecValTok{30}\NormalTok{),}
  \AttributeTok{dominant\_species =} \FunctionTok{c}\NormalTok{(}\StringTok{"栎树"}\NormalTok{, }\StringTok{"栎树"}\NormalTok{, }\StringTok{"云杉"}\NormalTok{, }\StringTok{"冷杉"}\NormalTok{, }\StringTok{"高山杜鹃"}\NormalTok{, }\StringTok{"栎树"}\NormalTok{, }\StringTok{"云杉"}\NormalTok{, }\StringTok{"冷杉"}\NormalTok{, }\StringTok{"云杉"}\NormalTok{, }\StringTok{"冷杉"}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-7}{%
\subsection{课堂演示过程}\label{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-7}}

\hypertarget{ux6761ux4ef6ux5224ux65adux57faux7840}{%
\subsubsection{条件判断基础}\label{ux6761ux4ef6ux5224ux65adux57faux7840}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 创建示例数据}
\NormalTok{sites\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{site\_id =} \FunctionTok{paste0}\NormalTok{(}\StringTok{"S"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{),}
  \AttributeTok{elevation =} \FunctionTok{c}\NormalTok{(}\DecValTok{1200}\NormalTok{, }\DecValTok{1450}\NormalTok{, }\DecValTok{1800}\NormalTok{, }\DecValTok{2100}\NormalTok{, }\DecValTok{2350}\NormalTok{, }\DecValTok{1650}\NormalTok{, }\DecValTok{1900}\NormalTok{, }\DecValTok{2200}\NormalTok{, }\DecValTok{1750}\NormalTok{, }\DecValTok{2050}\NormalTok{),}
  \AttributeTok{species\_count =} \FunctionTok{c}\NormalTok{(}\DecValTok{45}\NormalTok{, }\DecValTok{52}\NormalTok{, }\DecValTok{38}\NormalTok{, }\DecValTok{28}\NormalTok{, }\DecValTok{22}\NormalTok{, }\DecValTok{48}\NormalTok{, }\DecValTok{35}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{42}\NormalTok{, }\DecValTok{30}\NormalTok{),}
  \AttributeTok{dominant\_species =} \FunctionTok{c}\NormalTok{(}\StringTok{"栎树"}\NormalTok{, }\StringTok{"栎树"}\NormalTok{, }\StringTok{"云杉"}\NormalTok{, }\StringTok{"冷杉"}\NormalTok{, }\StringTok{"高山杜鹃"}\NormalTok{, }\StringTok{"栎树"}\NormalTok{, }\StringTok{"云杉"}\NormalTok{, }\StringTok{"冷杉"}\NormalTok{, }\StringTok{"云杉"}\NormalTok{, }\StringTok{"冷杉"}\NormalTok{)}
\NormalTok{)}

\CommentTok{\# 简单的if语句}
\NormalTok{elevation\_threshold }\OtherTok{\textless{}{-}} \DecValTok{2000}
\ControlFlowTok{if}\NormalTok{ (sites\_data}\SpecialCharTok{$}\NormalTok{elevation[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{\textgreater{}}\NormalTok{ elevation\_threshold) \{}
  \FunctionTok{print}\NormalTok{(}\StringTok{"高海拔样地"}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
  \FunctionTok{print}\NormalTok{(}\StringTok{"低海拔样地"}\NormalTok{)}
\NormalTok{\}}

\CommentTok{\# if{-}else判断所有样地}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(sites\_data)) \{}
  \ControlFlowTok{if}\NormalTok{ (sites\_data}\SpecialCharTok{$}\NormalTok{elevation[i] }\SpecialCharTok{\textgreater{}} \DecValTok{2000}\NormalTok{) \{}
    \FunctionTok{print}\NormalTok{(}\FunctionTok{paste}\NormalTok{(sites\_data}\SpecialCharTok{$}\NormalTok{site\_id[i], }\StringTok{"是高海拔样地"}\NormalTok{))}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{print}\NormalTok{(}\FunctionTok{paste}\NormalTok{(sites\_data}\SpecialCharTok{$}\NormalTok{site\_id[i], }\StringTok{"是低海拔样地"}\NormalTok{))}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux5411ux91cfux5316ux6761ux4ef6ux5224ux65ad}{%
\subsubsection{向量化条件判断}\label{ux5411ux91cfux5316ux6761ux4ef6ux5224ux65ad}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 使用ifelse()函数进行向量化判断}
\NormalTok{sites\_data}\SpecialCharTok{$}\NormalTok{elevation\_zone }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(sites\_data}\SpecialCharTok{$}\NormalTok{elevation }\SpecialCharTok{\textgreater{}} \DecValTok{2000}\NormalTok{, }\StringTok{"高海拔"}\NormalTok{, }\StringTok{"低海拔"}\NormalTok{)}
\FunctionTok{print}\NormalTok{(sites\_data[, }\FunctionTok{c}\NormalTok{(}\StringTok{"site\_id"}\NormalTok{, }\StringTok{"elevation"}\NormalTok{, }\StringTok{"elevation\_zone"}\NormalTok{)])}

\CommentTok{\# 多层条件判断}
\NormalTok{sites\_data}\SpecialCharTok{$}\NormalTok{vegetation\_type }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(sites\_data}\SpecialCharTok{$}\NormalTok{elevation }\SpecialCharTok{\textless{}} \DecValTok{1500}\NormalTok{, }\StringTok{"阔叶林"}\NormalTok{,}
                                    \FunctionTok{ifelse}\NormalTok{(sites\_data}\SpecialCharTok{$}\NormalTok{elevation }\SpecialCharTok{\textless{}} \DecValTok{2000}\NormalTok{, }\StringTok{"混交林"}\NormalTok{, }\StringTok{"针叶林"}\NormalTok{))}
\FunctionTok{print}\NormalTok{(sites\_data[, }\FunctionTok{c}\NormalTok{(}\StringTok{"site\_id"}\NormalTok{, }\StringTok{"elevation"}\NormalTok{, }\StringTok{"vegetation\_type"}\NormalTok{)])}
\end{Highlighting}
\end{Shaded}

\hypertarget{forux5faaux73afux5904ux7406}{%
\subsubsection{for循环处理}\label{forux5faaux73afux5904ux7406}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 计算每个样地的多样性指数类别}
\NormalTok{diversity\_categories }\OtherTok{\textless{}{-}} \FunctionTok{character}\NormalTok{(}\FunctionTok{nrow}\NormalTok{(sites\_data))}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{nrow}\NormalTok{(sites\_data)) \{}
\NormalTok{  species\_num }\OtherTok{\textless{}{-}}\NormalTok{ sites\_data}\SpecialCharTok{$}\NormalTok{species\_count[i]}
  \ControlFlowTok{if}\NormalTok{ (species\_num }\SpecialCharTok{\textgreater{}=} \DecValTok{40}\NormalTok{) \{}
\NormalTok{    diversity\_categories[i] }\OtherTok{\textless{}{-}} \StringTok{"高多样性"}
\NormalTok{  \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (species\_num }\SpecialCharTok{\textgreater{}=} \DecValTok{30}\NormalTok{) \{}
\NormalTok{    diversity\_categories[i] }\OtherTok{\textless{}{-}} \StringTok{"中等多样性"}  
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    diversity\_categories[i] }\OtherTok{\textless{}{-}} \StringTok{"低多样性"}
\NormalTok{  \}}
\NormalTok{\}}

\NormalTok{sites\_data}\SpecialCharTok{$}\NormalTok{diversity\_category }\OtherTok{\textless{}{-}}\NormalTok{ diversity\_categories}
\FunctionTok{print}\NormalTok{(sites\_data[, }\FunctionTok{c}\NormalTok{(}\StringTok{"site\_id"}\NormalTok{, }\StringTok{"species\_count"}\NormalTok{, }\StringTok{"diversity\_category"}\NormalTok{)])}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux81eaux5b9aux4e49ux51fdux6570ux7f16ux5199}{%
\subsubsection{自定义函数编写}\label{ux81eaux5b9aux4e49ux51fdux6570ux7f16ux5199}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 编写海拔带判断函数}
\NormalTok{classify\_elevation\_zone }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(elevation) \{}
  \ControlFlowTok{if}\NormalTok{ (elevation }\SpecialCharTok{\textless{}} \DecValTok{1500}\NormalTok{) \{}
    \FunctionTok{return}\NormalTok{(}\StringTok{"低山带"}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (elevation }\SpecialCharTok{\textless{}} \DecValTok{2000}\NormalTok{) \{}
    \FunctionTok{return}\NormalTok{(}\StringTok{"中山带"}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{return}\NormalTok{(}\StringTok{"高山带"}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{\}}

\CommentTok{\# 测试函数}
\FunctionTok{classify\_elevation\_zone}\NormalTok{(}\DecValTok{1800}\NormalTok{)}
\FunctionTok{classify\_elevation\_zone}\NormalTok{(}\DecValTok{2200}\NormalTok{)}

\CommentTok{\# 批量应用函数}
\NormalTok{sites\_data}\SpecialCharTok{$}\NormalTok{elevation\_belt }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(sites\_data}\SpecialCharTok{$}\NormalTok{elevation, classify\_elevation\_zone)}
\FunctionTok{print}\NormalTok{(sites\_data[, }\FunctionTok{c}\NormalTok{(}\StringTok{"site\_id"}\NormalTok{, }\StringTok{"elevation"}\NormalTok{, }\StringTok{"elevation\_belt"}\NormalTok{)])}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux590dux6742ux6761ux4ef6ux5904ux7406}{%
\subsubsection{复杂条件处理}\label{ux590dux6742ux6761ux4ef6ux5904ux7406}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 编写综合评估函数}
\NormalTok{assess\_conservation\_value }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(elevation, species\_count, dominant\_sp) \{}
\NormalTok{  score }\OtherTok{\textless{}{-}} \DecValTok{0}
  
  \CommentTok{\# 海拔因子}
  \ControlFlowTok{if}\NormalTok{ (elevation }\SpecialCharTok{\textgreater{}} \DecValTok{2000}\NormalTok{) \{}
\NormalTok{    score }\OtherTok{\textless{}{-}}\NormalTok{ score }\SpecialCharTok{+} \DecValTok{2}
\NormalTok{  \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (elevation }\SpecialCharTok{\textgreater{}} \DecValTok{1500}\NormalTok{) \{}
\NormalTok{    score }\OtherTok{\textless{}{-}}\NormalTok{ score }\SpecialCharTok{+} \DecValTok{1}
\NormalTok{  \}}
  
  \CommentTok{\# 物种多样性因子}
  \ControlFlowTok{if}\NormalTok{ (species\_count }\SpecialCharTok{\textgreater{}} \DecValTok{40}\NormalTok{) \{}
\NormalTok{    score }\OtherTok{\textless{}{-}}\NormalTok{ score }\SpecialCharTok{+} \DecValTok{2}
\NormalTok{  \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (species\_count }\SpecialCharTok{\textgreater{}} \DecValTok{30}\NormalTok{) \{}
\NormalTok{    score }\OtherTok{\textless{}{-}}\NormalTok{ score }\SpecialCharTok{+} \DecValTok{1}
\NormalTok{  \}}
  
  \CommentTok{\# 优势种稀有性因子}
\NormalTok{  rare\_species }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"高山杜鹃"}\NormalTok{, }\StringTok{"冷杉"}\NormalTok{)}
  \ControlFlowTok{if}\NormalTok{ (dominant\_sp }\SpecialCharTok{\%in\%}\NormalTok{ rare\_species) \{}
\NormalTok{    score }\OtherTok{\textless{}{-}}\NormalTok{ score }\SpecialCharTok{+} \DecValTok{1}
\NormalTok{  \}}
  
  \CommentTok{\# 返回保护价值等级}
  \ControlFlowTok{if}\NormalTok{ (score }\SpecialCharTok{\textgreater{}=} \DecValTok{4}\NormalTok{) \{}
    \FunctionTok{return}\NormalTok{(}\StringTok{"极高价值"}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (score }\SpecialCharTok{\textgreater{}=} \DecValTok{3}\NormalTok{) \{}
    \FunctionTok{return}\NormalTok{(}\StringTok{"高价值"}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (score }\SpecialCharTok{\textgreater{}=} \DecValTok{2}\NormalTok{) \{}
    \FunctionTok{return}\NormalTok{(}\StringTok{"中等价值"}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{return}\NormalTok{(}\StringTok{"一般价值"}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{\}}

\CommentTok{\# 应用综合评估}
\NormalTok{sites\_data}\SpecialCharTok{$}\NormalTok{conservation\_value }\OtherTok{\textless{}{-}} \FunctionTok{mapply}\NormalTok{(assess\_conservation\_value, }
\NormalTok{                                       sites\_data}\SpecialCharTok{$}\NormalTok{elevation,}
\NormalTok{                                       sites\_data}\SpecialCharTok{$}\NormalTok{species\_count,}
\NormalTok{                                       sites\_data}\SpecialCharTok{$}\NormalTok{dominant\_species)}

\FunctionTok{print}\NormalTok{(sites\_data[, }\FunctionTok{c}\NormalTok{(}\StringTok{"site\_id"}\NormalTok{, }\StringTok{"conservation\_value"}\NormalTok{)])}
\end{Highlighting}
\end{Shaded}

\hypertarget{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-7}{%
\subsection{R语言知识点详解}\label{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-7}}

\hypertarget{ux6761ux4ef6ux5224ux65adux7ed3ux6784}{%
\subsubsection{条件判断结构}\label{ux6761ux4ef6ux5224ux65adux7ed3ux6784}}

\hypertarget{if-ux8bedux53e5}{%
\paragraph{\texorpdfstring{\texttt{if} 语句}{if 语句}}\label{if-ux8bedux53e5}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{if\ (条件)\ \{\ 执行代码\ \}}
\item
  \textbf{条件}：必须是逻辑值（TRUE/FALSE）
\item
  \textbf{执行规则}：条件为TRUE时执行大括号内的代码
\item
  \textbf{注意事项}：条件必须是长度为1的逻辑向量
\end{itemize}

\hypertarget{if-else-ux8bedux53e5}{%
\paragraph{\texorpdfstring{\texttt{if-else} 语句}{if-else 语句}}\label{if-else-ux8bedux53e5}}

\begin{itemize}
\item
  \textbf{语法}：

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{if}\NormalTok{ (条件) \{}
  \CommentTok{\# 条件为TRUE时执行}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
  \CommentTok{\# 条件为FALSE时执行}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}
\item
  \textbf{多重条件}：\texttt{else\ if}可以链式连接
\item
  \textbf{最佳实践}：始终使用大括号，即使只有一行代码
\end{itemize}

\hypertarget{ifelse-ux51fdux6570ux5411ux91cfux5316}{%
\paragraph{\texorpdfstring{\texttt{ifelse()} 函数（向量化）}{ifelse() 函数（向量化）}}\label{ifelse-ux51fdux6570ux5411ux91cfux5316}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{ifelse(test,\ yes,\ no)}
\item
  \textbf{优势}：可以处理向量，一次性判断多个元素
\item
  \textbf{参数}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{test}：逻辑向量条件
  \item
    \texttt{yes}：条件为TRUE时返回的值
  \item
    \texttt{no}：条件为FALSE时返回的值
  \end{itemize}
\item
  \textbf{嵌套使用}：可以嵌套实现多重条件判断
\end{itemize}

\hypertarget{ux5faaux73afux7ed3ux6784}{%
\subsubsection{循环结构}\label{ux5faaux73afux7ed3ux6784}}

\hypertarget{for-ux5faaux73af}{%
\paragraph{\texorpdfstring{\texttt{for} 循环}{for 循环}}\label{for-ux5faaux73af}}

\begin{itemize}
\item
  \textbf{语法}：\texttt{for\ (变量\ in\ 序列)\ \{\ 循环体\ \}}
\item
  \textbf{常见用法}：

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 按索引循环}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{) \{ \}}

\CommentTok{\# 按元素循环}
\ControlFlowTok{for}\NormalTok{ (item }\ControlFlowTok{in}\NormalTok{ vector) \{ \}}

\CommentTok{\# 按名称循环}
\ControlFlowTok{for}\NormalTok{ (name }\ControlFlowTok{in} \FunctionTok{names}\NormalTok{(list)) \{ \}}
\end{Highlighting}
\end{Shaded}
\item
  \textbf{循环控制}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{break}：跳出循环
  \item
    \texttt{next}：跳过当前迭代
  \end{itemize}
\end{itemize}

\hypertarget{ux5176ux4ed6ux5faaux73afux7c7bux578b}{%
\paragraph{其他循环类型}\label{ux5176ux4ed6ux5faaux73afux7c7bux578b}}

\begin{itemize}
\tightlist
\item
  \textbf{\texttt{while} 循环}：\texttt{while\ (条件)\ \{\ 循环体\ \}}
\item
  \textbf{\texttt{repeat} 循环}：\texttt{repeat\ \{\ 循环体;\ if(条件)\ break\ \}}
\end{itemize}

\hypertarget{ux51fdux6570ux5b9aux4e49}{%
\subsubsection{函数定义}\label{ux51fdux6570ux5b9aux4e49}}

\hypertarget{ux57faux672cux51fdux6570ux8bedux6cd5}{%
\paragraph{基本函数语法}\label{ux57faux672cux51fdux6570ux8bedux6cd5}}

\begin{itemize}
\item
  \textbf{语法}：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{函数名 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(参数1, 参数2 }\OtherTok{=}\NormalTok{ 默认值) \{}
  \CommentTok{\# 函数体}
  \FunctionTok{return}\NormalTok{(返回值)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}
\item
  \textbf{参数}：

  \begin{itemize}
  \tightlist
  \item
    必需参数：调用时必须提供
  \item
    可选参数：有默认值，可省略
  \end{itemize}
\item
  \textbf{返回值}：

  \begin{itemize}
  \tightlist
  \item
    显式返回：使用\texttt{return()}
  \item
    隐式返回：函数最后一个表达式的值
  \end{itemize}
\end{itemize}

\hypertarget{ux51fdux6570ux8bbeux8ba1ux539fux5219}{%
\paragraph{函数设计原则}\label{ux51fdux6570ux8bbeux8ba1ux539fux5219}}

\begin{itemize}
\tightlist
\item
  \textbf{单一职责}：一个函数只做一件事
\item
  \textbf{参数验证}：检查输入参数的有效性
\item
  \textbf{错误处理}：使用\texttt{stop()}、\texttt{warning()}处理异常
\item
  \textbf{文档化}：添加注释说明函数用途和参数
\end{itemize}

\hypertarget{ux9ad8ux7ea7ux5e94ux7528ux51fdux6570}{%
\subsubsection{高级应用函数}\label{ux9ad8ux7ea7ux5e94ux7528ux51fdux6570}}

\hypertarget{sapply---ux7b80ux5316ux7684apply}{%
\paragraph{\texorpdfstring{\texttt{sapply()} - 简化的apply}{sapply() - 简化的apply}}\label{sapply---ux7b80ux5316ux7684apply}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：对向量或列表的每个元素应用函数
\item
  \textbf{语法}：\texttt{sapply(X,\ FUN,\ ...)}
\item
  \textbf{返回值}：简化后的向量或矩阵
\item
  \textbf{与\texttt{lapply()}的区别}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{lapply()}总是返回列表
  \item
    \texttt{sapply()}尝试简化结果
  \end{itemize}
\end{itemize}

\hypertarget{mapply---ux591aux53d8ux91cfapply}{%
\paragraph{\texorpdfstring{\texttt{mapply()} - 多变量apply}{mapply() - 多变量apply}}\label{mapply---ux591aux53d8ux91cfapply}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：同时对多个向量应用函数
\item
  \textbf{语法}：\texttt{mapply(FUN,\ ...,\ MoreArgs\ =\ NULL)}
\item
  \textbf{应用场景}：函数需要多个参数时使用
\item
  \textbf{示例}：\texttt{mapply(function(x,\ y)\ x\ +\ y,\ vector1,\ vector2)}
\end{itemize}

\hypertarget{ux903bux8f91ux8fd0ux7b97ux7b26}{%
\subsubsection{逻辑运算符}\label{ux903bux8f91ux8fd0ux7b97ux7b26}}

\hypertarget{ux57faux672cux903bux8f91ux8fd0ux7b97ux7b26}{%
\paragraph{基本逻辑运算符}\label{ux57faux672cux903bux8f91ux8fd0ux7b97ux7b26}}

\begin{itemize}
\tightlist
\item
  \textbf{\texttt{==}}：等于
\item
  \textbf{\texttt{!=}}：不等于
\item
  \textbf{\texttt{\textgreater{}}}、\texttt{\textless{}}\textbf{、\texttt{\textgreater{}=}}、\texttt{\textless{}=}**：比较运算符
\item
  \textbf{\texttt{\&}}：与（向量化）
\item
  \textbf{\texttt{\textbar{}}}：或（向量化）
\item
  \textbf{\texttt{!}}：非
\item
  \textbf{\texttt{\&\&}}、\texttt{\textbar{}\textbar{}}**：短路逻辑运算符（只判断第一个元素）
\end{itemize}

\hypertarget{ux6210ux5458ux6d4bux8bd5}{%
\paragraph{成员测试}\label{ux6210ux5458ux6d4bux8bd5}}

\begin{itemize}
\tightlist
\item
  \textbf{\texttt{\%in\%}}：检查元素是否在向量中
\item
  \textbf{\texttt{is.na()}}：检查缺失值
\item
  \textbf{\texttt{is.null()}}：检查空值
\end{itemize}

\hypertarget{ux7f16ux7a0bux6700ux4f73ux5b9eux8df5}{%
\subsubsection{编程最佳实践}\label{ux7f16ux7a0bux6700ux4f73ux5b9eux8df5}}

\hypertarget{ux4ee3ux7801ux7ec4ux7ec7}{%
\paragraph{代码组织}\label{ux4ee3ux7801ux7ec4ux7ec7}}

\begin{itemize}
\tightlist
\item
  \textbf{缩进}：使用一致的缩进（建议2或4个空格）
\item
  \textbf{命名}：使用有意义的变量名和函数名
\item
  \textbf{注释}：解释复杂逻辑和算法思路
\item
  \textbf{模块化}：将复杂任务分解为简单函数
\end{itemize}

\hypertarget{ux6027ux80fdux8003ux8651}{%
\paragraph{性能考虑}\label{ux6027ux80fdux8003ux8651}}

\begin{itemize}
\tightlist
\item
  \textbf{向量化}：优先使用向量化操作而非循环
\item
  \textbf{预分配}：循环前预分配存储空间
\item
  \textbf{避免增长}：不要在循环中动态增长向量
\end{itemize}

\hypertarget{ux8c03ux8bd5ux6280ux5de7}{%
\paragraph{调试技巧}\label{ux8c03ux8bd5ux6280ux5de7}}

\begin{itemize}
\tightlist
\item
  \textbf{\texttt{print()}}：在关键位置输出变量值
\item
  \textbf{\texttt{browser()}}：设置断点进行交互式调试
\item
  \textbf{\texttt{traceback()}}：查看错误调用堆栈
\item
  \textbf{分步测试}：逐步测试函数的各个部分
\end{itemize}

\hypertarget{ux8bfeux540eux7ec3ux4e60-7}{%
\subsection{课后练习}\label{ux8bfeux540eux7ec3ux4e60-7}}

\textbf{题目}：某湿地鸟类监测数据包含以下信息：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bird\_monitoring }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{site =} \FunctionTok{c}\NormalTok{(}\StringTok{"A1"}\NormalTok{, }\StringTok{"A2"}\NormalTok{, }\StringTok{"B1"}\NormalTok{, }\StringTok{"B2"}\NormalTok{, }\StringTok{"C1"}\NormalTok{, }\StringTok{"C2"}\NormalTok{),}
  \AttributeTok{water\_depth =} \FunctionTok{c}\NormalTok{(}\DecValTok{15}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{45}\NormalTok{, }\DecValTok{35}\NormalTok{, }\DecValTok{65}\NormalTok{, }\DecValTok{55}\NormalTok{),  }\CommentTok{\# 水深(cm)}
  \AttributeTok{bird\_abundance =} \FunctionTok{c}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{16}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{8}\NormalTok{),   }\CommentTok{\# 鸟类丰度}
  \AttributeTok{season =} \FunctionTok{c}\NormalTok{(}\StringTok{"春季"}\NormalTok{, }\StringTok{"春季"}\NormalTok{, }\StringTok{"夏季"}\NormalTok{, }\StringTok{"夏季"}\NormalTok{, }\StringTok{"秋季"}\NormalTok{, }\StringTok{"秋季"}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

请完成（使用if-else、循环、函数等编程内容，结合之前学过的数据处理方法）：

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  使用\texttt{ifelse()}函数，根据水深将栖息地分类（\textless30cm浅水区，30-50cm中等深度，\textgreater50cm深水区）
\item
  编写函数\texttt{classify\_habitat\_quality()}，综合水深和鸟类丰度评估栖息地质量
\item
  使用\texttt{for}循环，计算每个季节的平均鸟类丰度
\item
  创建一个新列，标记高丰度样地（丰度\textgreater15为高丰度，使用ifelse()）
\item
  编写函数处理整个数据集，输出每个样地的综合评估报告
\item
  使用\texttt{apply}族函数重做第3题（比较循环和向量化方法的差异）
\end{enumerate}

\hypertarget{ux73b0ux4ee3ux6570ux636eux79d1ux5b66ux5de5ux5177ux5305ux5e94ux7528}{%
\section{现代数据科学工具包应用}\label{ux73b0ux4ee3ux6570ux636eux79d1ux5b66ux5de5ux5177ux5305ux5e94ux7528}}

\hypertarget{ux751fux6001ux5b66ux80ccux666f-8}{%
\subsection{生态学背景}\label{ux751fux6001ux5b66ux80ccux666f-8}}

现代生态学研究产生的数据日益复杂，传统的基础R语法在处理复杂数据操作时略显繁琐。tidyverse是R语言的现代数据处理工具包，提供了更直观、更高效的数据处理方法，特别适合处理多变量、多时间点的生态学数据。

\hypertarget{ux6f14ux793aux6570ux636e-7}{%
\subsection{演示数据}\label{ux6f14ux793aux6570ux636e-7}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 模拟某森林样地多年监测数据}
\FunctionTok{library}\NormalTok{(tidyverse)}

\CommentTok{\# 创建模拟数据}
\NormalTok{forest\_monitoring }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{plot\_id =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Plot\_"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{), }\AttributeTok{each =} \DecValTok{12}\NormalTok{),}
  \AttributeTok{year =} \FunctionTok{rep}\NormalTok{(}\DecValTok{2018}\SpecialCharTok{:}\DecValTok{2021}\NormalTok{, }\AttributeTok{times =} \DecValTok{15}\NormalTok{),}
  \AttributeTok{season =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"春"}\NormalTok{, }\StringTok{"夏"}\NormalTok{, }\StringTok{"秋"}\NormalTok{), }\AttributeTok{times =} \DecValTok{20}\NormalTok{),}
  \AttributeTok{temperature =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{60}\NormalTok{, }\AttributeTok{mean =} \DecValTok{15}\NormalTok{, }\AttributeTok{sd =} \DecValTok{5}\NormalTok{),}
  \AttributeTok{humidity =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{60}\NormalTok{, }\AttributeTok{mean =} \DecValTok{70}\NormalTok{, }\AttributeTok{sd =} \DecValTok{10}\NormalTok{),}
  \AttributeTok{species\_richness =} \FunctionTok{rpois}\NormalTok{(}\DecValTok{60}\NormalTok{, }\AttributeTok{lambda =} \DecValTok{25}\NormalTok{),}
  \AttributeTok{tree\_height =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{60}\NormalTok{, }\AttributeTok{mean =} \DecValTok{12}\NormalTok{, }\AttributeTok{sd =} \DecValTok{3}\NormalTok{),}
  \AttributeTok{soil\_ph =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{60}\NormalTok{, }\AttributeTok{mean =} \FloatTok{6.5}\NormalTok{, }\AttributeTok{sd =} \FloatTok{0.5}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-8}{%
\subsection{课堂演示过程}\label{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-8}}

\hypertarget{tidyverseux5305ux7684ux52a0ux8f7dux548cux6570ux636eux67e5ux770b}{%
\subsubsection{tidyverse包的加载和数据查看}\label{tidyverseux5305ux7684ux52a0ux8f7dux548cux6570ux636eux67e5ux770b}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 安装和加载tidyverse}
\CommentTok{\# install.packages("tidyverse")}
\FunctionTok{library}\NormalTok{(tidyverse)}

\CommentTok{\# 创建示例数据（简化版）}
\NormalTok{forest\_data }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{plot\_id =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"D"}\NormalTok{), }\AttributeTok{each =} \DecValTok{6}\NormalTok{),}
  \AttributeTok{year =} \FunctionTok{rep}\NormalTok{(}\DecValTok{2020}\SpecialCharTok{:}\DecValTok{2022}\NormalTok{, }\AttributeTok{times =} \DecValTok{8}\NormalTok{),}
  \AttributeTok{season =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"春"}\NormalTok{, }\StringTok{"夏"}\NormalTok{), }\AttributeTok{times =} \DecValTok{12}\NormalTok{),}
  \AttributeTok{temperature =} \FunctionTok{c}\NormalTok{(}\DecValTok{12}\NormalTok{, }\DecValTok{18}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{22}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{16}\NormalTok{, }\DecValTok{14}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{13}\NormalTok{, }\DecValTok{19}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{17}\NormalTok{, }
                  \DecValTok{16}\NormalTok{, }\DecValTok{21}\NormalTok{, }\DecValTok{14}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{18}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{23}\NormalTok{, }\DecValTok{13}\NormalTok{, }\DecValTok{21}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{19}\NormalTok{),}
  \AttributeTok{species\_count =} \FunctionTok{c}\NormalTok{(}\DecValTok{22}\NormalTok{, }\DecValTok{28}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{32}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{24}\NormalTok{, }\DecValTok{26}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{24}\NormalTok{, }\DecValTok{28}\NormalTok{, }\DecValTok{21}\NormalTok{, }\DecValTok{25}\NormalTok{,}
                   \DecValTok{28}\NormalTok{, }\DecValTok{34}\NormalTok{, }\DecValTok{26}\NormalTok{, }\DecValTok{32}\NormalTok{, }\DecValTok{23}\NormalTok{, }\DecValTok{27}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{36}\NormalTok{, }\DecValTok{27}\NormalTok{, }\DecValTok{31}\NormalTok{, }\DecValTok{24}\NormalTok{, }\DecValTok{28}\NormalTok{)}
\NormalTok{)}

\CommentTok{\# 查看数据结构}
\FunctionTok{glimpse}\NormalTok{(forest\_data)}
\FunctionTok{head}\NormalTok{(forest\_data)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux6570ux636eux7b5bux9009ux4e0eux9009ux62e9}{%
\subsubsection{数据筛选与选择}\label{ux6570ux636eux7b5bux9009ux4e0eux9009ux62e9}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 使用filter()筛选行}
\NormalTok{summer\_data }\OtherTok{\textless{}{-}}\NormalTok{ forest\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(season }\SpecialCharTok{==} \StringTok{"夏"}\NormalTok{)}

\NormalTok{high\_diversity }\OtherTok{\textless{}{-}}\NormalTok{ forest\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(species\_count }\SpecialCharTok{\textgreater{}} \DecValTok{30}\NormalTok{)}

\NormalTok{recent\_summer }\OtherTok{\textless{}{-}}\NormalTok{ forest\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{\textgreater{}=} \DecValTok{2021} \SpecialCharTok{\&}\NormalTok{ season }\SpecialCharTok{==} \StringTok{"夏"}\NormalTok{)}

\CommentTok{\# 使用select()选择列}
\NormalTok{temp\_species }\OtherTok{\textless{}{-}}\NormalTok{ forest\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(plot\_id, temperature, species\_count)}

\CommentTok{\# 选择特定范围的列}
\NormalTok{core\_variables }\OtherTok{\textless{}{-}}\NormalTok{ forest\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(plot\_id}\SpecialCharTok{:}\NormalTok{season, species\_count)}

\CommentTok{\# 排除特定列}
\NormalTok{without\_year }\OtherTok{\textless{}{-}}\NormalTok{ forest\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{year)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux6570ux636eux53d8ux6362ux4e0eux65b0ux53d8ux91cfux521bux5efa}{%
\subsubsection{数据变换与新变量创建}\label{ux6570ux636eux53d8ux6362ux4e0eux65b0ux53d8ux91cfux521bux5efa}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 使用mutate()创建新变量}
\NormalTok{forest\_enhanced }\OtherTok{\textless{}{-}}\NormalTok{ forest\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{temp\_category =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{      temperature }\SpecialCharTok{\textless{}} \DecValTok{15} \SpecialCharTok{\textasciitilde{}} \StringTok{"低温"}\NormalTok{,}
\NormalTok{      temperature }\SpecialCharTok{\textless{}} \DecValTok{20} \SpecialCharTok{\textasciitilde{}} \StringTok{"中温"}\NormalTok{,}
      \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \StringTok{"高温"}
\NormalTok{    ),}
    \AttributeTok{diversity\_index =}\NormalTok{ species\_count }\SpecialCharTok{/} \DecValTok{10}\NormalTok{,  }\CommentTok{\# 简化的多样性指数}
    \AttributeTok{temp\_celsius =}\NormalTok{ temperature,}
    \AttributeTok{temp\_fahrenheit =}\NormalTok{ temperature }\SpecialCharTok{*} \DecValTok{9}\SpecialCharTok{/}\DecValTok{5} \SpecialCharTok{+} \DecValTok{32}
\NormalTok{  )}

\CommentTok{\# 查看结果}
\NormalTok{forest\_enhanced }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(plot\_id, temperature, temp\_category, species\_count, diversity\_index)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux6570ux636eux6392ux5e8fux4e0eux5206ux7ec4ux6c47ux603b}{%
\subsubsection{数据排序与分组汇总}\label{ux6570ux636eux6392ux5e8fux4e0eux5206ux7ec4ux6c47ux603b}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 使用arrange()排序}
\NormalTok{forest\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(species\_count)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{head}\NormalTok{()}

\NormalTok{forest\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(plot\_id, year, season)}

\CommentTok{\# 使用group\_by()和summarise()进行分组统计}
\NormalTok{plot\_summary }\OtherTok{\textless{}{-}}\NormalTok{ forest\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(plot\_id) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{n\_observations =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{mean\_temperature =} \FunctionTok{mean}\NormalTok{(temperature),}
    \AttributeTok{mean\_species =} \FunctionTok{mean}\NormalTok{(species\_count),}
    \AttributeTok{max\_species =} \FunctionTok{max}\NormalTok{(species\_count),}
    \AttributeTok{sd\_temperature =} \FunctionTok{sd}\NormalTok{(temperature),}
    \AttributeTok{.groups =} \StringTok{\textquotesingle{}drop\textquotesingle{}}
\NormalTok{  )}

\FunctionTok{print}\NormalTok{(plot\_summary)}

\CommentTok{\# 多变量分组}
\NormalTok{season\_plot\_summary }\OtherTok{\textless{}{-}}\NormalTok{ forest\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(season, plot\_id) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{mean\_temp =} \FunctionTok{mean}\NormalTok{(temperature),}
    \AttributeTok{mean\_species =} \FunctionTok{mean}\NormalTok{(species\_count),}
    \AttributeTok{.groups =} \StringTok{\textquotesingle{}drop\textquotesingle{}}
\NormalTok{  )}

\FunctionTok{print}\NormalTok{(season\_plot\_summary)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux6570ux636eux91cdux5851ux957fux5bbdux683cux5f0fux8f6cux6362}{%
\subsubsection{数据重塑：长宽格式转换}\label{ux6570ux636eux91cdux5851ux957fux5bbdux683cux5f0fux8f6cux6362}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 宽格式转长格式（gather/pivot\_longer）}
\NormalTok{forest\_long }\OtherTok{\textless{}{-}}\NormalTok{ forest\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}
    \AttributeTok{cols =} \FunctionTok{c}\NormalTok{(temperature, species\_count),}
    \AttributeTok{names\_to =} \StringTok{"variable"}\NormalTok{,}
    \AttributeTok{values\_to =} \StringTok{"value"}
\NormalTok{  )}

\FunctionTok{head}\NormalTok{(forest\_long)}

\CommentTok{\# 长格式转宽格式（spread/pivot\_wider）}
\NormalTok{forest\_wide }\OtherTok{\textless{}{-}}\NormalTok{ forest\_long }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_wider}\NormalTok{(}
    \AttributeTok{names\_from =}\NormalTok{ variable,}
    \AttributeTok{values\_from =}\NormalTok{ value}
\NormalTok{  )}

\FunctionTok{head}\NormalTok{(forest\_wide)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux6570ux636eux8fdeux63a5}{%
\subsubsection{数据连接}\label{ux6570ux636eux8fdeux63a5}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 创建额外的样地信息}
\NormalTok{plot\_info }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{plot\_id =} \FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{, }\StringTok{"D"}\NormalTok{),}
  \AttributeTok{elevation =} \FunctionTok{c}\NormalTok{(}\DecValTok{1200}\NormalTok{, }\DecValTok{1450}\NormalTok{, }\DecValTok{1800}\NormalTok{, }\DecValTok{1600}\NormalTok{),}
  \AttributeTok{soil\_type =} \FunctionTok{c}\NormalTok{(}\StringTok{"壤土"}\NormalTok{, }\StringTok{"砂土"}\NormalTok{, }\StringTok{"黏土"}\NormalTok{, }\StringTok{"壤土"}\NormalTok{),}
  \AttributeTok{management =} \FunctionTok{c}\NormalTok{(}\StringTok{"保护"}\NormalTok{, }\StringTok{"管理"}\NormalTok{, }\StringTok{"保护"}\NormalTok{, }\StringTok{"管理"}\NormalTok{)}
\NormalTok{)}

\CommentTok{\# 左连接}
\NormalTok{forest\_complete }\OtherTok{\textless{}{-}}\NormalTok{ forest\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{left\_join}\NormalTok{(plot\_info, }\AttributeTok{by =} \StringTok{"plot\_id"}\NormalTok{)}

\FunctionTok{head}\NormalTok{(forest\_complete)}

\CommentTok{\# 按管理类型分析}
\NormalTok{management\_analysis }\OtherTok{\textless{}{-}}\NormalTok{ forest\_complete }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(management) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{mean\_temperature =} \FunctionTok{mean}\NormalTok{(temperature),}
    \AttributeTok{mean\_species =} \FunctionTok{mean}\NormalTok{(species\_count),}
    \AttributeTok{.groups =} \StringTok{\textquotesingle{}drop\textquotesingle{}}
\NormalTok{  )}

\FunctionTok{print}\NormalTok{(management\_analysis)}
\end{Highlighting}
\end{Shaded}

\hypertarget{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-8}{%
\subsection{R语言知识点详解}\label{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-8}}

\hypertarget{tidyverseux54f2ux5b66ux4e0eux7ba1ux9053ux64cdux4f5c}{%
\subsubsection{tidyverse哲学与管道操作}\label{tidyverseux54f2ux5b66ux4e0eux7ba1ux9053ux64cdux4f5c}}

\hypertarget{ux7ba1ux9053ux64cdux4f5cux7b26}{%
\paragraph{\texorpdfstring{管道操作符 \texttt{\%\textgreater{}\%}}{管道操作符 \%\textgreater\%}}\label{ux7ba1ux9053ux64cdux4f5cux7b26}}

\begin{itemize}
\tightlist
\item
  \textbf{作用}：将左侧结果作为右侧函数的第一个参数
\item
  \textbf{优势}：

  \begin{itemize}
  \tightlist
  \item
    代码更易读：从左到右，从上到下
  \item
    减少中间变量：避免创建临时对象
  \item
    链式操作：多个操作连续进行
  \end{itemize}
\item
  \textbf{语法}：\texttt{data\ \%\textgreater{}\%\ function()}
\item
  \textbf{等价写法}：\texttt{function(data)}
\end{itemize}

\hypertarget{tibble-vs-data.frame}{%
\paragraph{tibble vs data.frame}\label{tibble-vs-data.frame}}

\begin{itemize}
\tightlist
\item
  \textbf{tibble特点}：

  \begin{itemize}
  \tightlist
  \item
    更好的打印输出
  \item
    更严格的子集操作
  \item
    保持字符串为字符串（不自动转因子）
  \item
    支持列名包含空格和特殊字符
  \end{itemize}
\end{itemize}

\hypertarget{ux6570ux636eux7b5bux9009ux4e0eux9009ux62e9-1}{%
\subsubsection{数据筛选与选择}\label{ux6570ux636eux7b5bux9009ux4e0eux9009ux62e9-1}}

\hypertarget{filter---ux884cux7b5bux9009}{%
\paragraph{\texorpdfstring{\texttt{filter()} - 行筛选}{filter() - 行筛选}}\label{filter---ux884cux7b5bux9009}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{filter(data,\ condition1,\ condition2,\ ...)}
\item
  \textbf{多条件}：

  \begin{itemize}
  \tightlist
  \item
    逗号分隔：逻辑与（AND）
  \item
    \texttt{\textbar{}}：逻辑或（OR）
  \item
    \texttt{!}：逻辑非（NOT）
  \end{itemize}
\item
  \textbf{常用条件}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{==}、\texttt{!=}：等于、不等于
  \item
    \texttt{\textgreater{}、\textless{}、\textgreater{}=、\textless{}=}：大小比较
  \item
    \texttt{\%in\%}：成员检查
  \item
    \texttt{is.na()}：缺失值检查
  \end{itemize}
\end{itemize}

\hypertarget{select---ux5217ux9009ux62e9}{%
\paragraph{\texorpdfstring{\texttt{select()} - 列选择}{select() - 列选择}}\label{select---ux5217ux9009ux62e9}}

\begin{itemize}
\tightlist
\item
  \textbf{基本选择}：\texttt{select(data,\ col1,\ col2)}
\item
  \textbf{范围选择}：\texttt{select(data,\ col1:col3)}
\item
  \textbf{排除选择}：\texttt{select(data,\ -col1,\ -col2)}
\item
  \textbf{辅助函数}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{starts\_with()}：以某字符开头
  \item
    \texttt{ends\_with()}：以某字符结尾
  \item
    \texttt{contains()}：包含某字符
  \item
    \texttt{matches()}：正则表达式匹配
  \end{itemize}
\end{itemize}

\hypertarget{ux6570ux636eux53d8ux6362}{%
\subsubsection{数据变换}\label{ux6570ux636eux53d8ux6362}}

\hypertarget{mutate---ux65b0ux53d8ux91cfux521bux5efa}{%
\paragraph{\texorpdfstring{\texttt{mutate()} - 新变量创建}{mutate() - 新变量创建}}\label{mutate---ux65b0ux53d8ux91cfux521bux5efa}}

\begin{itemize}
\tightlist
\item
  \textbf{基本用法}：\texttt{mutate(data,\ new\_col\ =\ expression)}
\item
  \textbf{多变量}：可同时创建多个新变量
\item
  \textbf{引用新建变量}：在同一个\texttt{mutate()}中可引用前面创建的变量
\item
  \textbf{变量类型转换}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{as.numeric()}：转数值
  \item
    \texttt{as.character()}：转字符
  \item
    \texttt{as.factor()}：转因子
  \end{itemize}
\end{itemize}

\hypertarget{case_when---ux591aux6761ux4ef6ux5206ux7c7b}{%
\paragraph{\texorpdfstring{\texttt{case\_when()} - 多条件分类}{case\_when() - 多条件分类}}\label{case_when---ux591aux6761ux4ef6ux5206ux7c7b}}

\begin{itemize}
\item
  \textbf{语法}：

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{case\_when}\NormalTok{(}
\NormalTok{  condition1 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ value1,}
\NormalTok{  condition2 }\SpecialCharTok{\textasciitilde{}}\NormalTok{ value2,}
  \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}}\NormalTok{ default\_value}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  \textbf{优势}：替代复杂的嵌套\texttt{ifelse()}
\item
  \textbf{注意}：条件从上到下评估，满足即停止
\end{itemize}

\hypertarget{ux6570ux636eux6392ux5e8fux4e0eux6c47ux603b}{%
\subsubsection{数据排序与汇总}\label{ux6570ux636eux6392ux5e8fux4e0eux6c47ux603b}}

\hypertarget{arrange---ux6570ux636eux6392ux5e8f}{%
\paragraph{\texorpdfstring{\texttt{arrange()} - 数据排序}{arrange() - 数据排序}}\label{arrange---ux6570ux636eux6392ux5e8f}}

\begin{itemize}
\tightlist
\item
  \textbf{基本排序}：\texttt{arrange(data,\ col)}
\item
  \textbf{降序排序}：\texttt{arrange(data,\ desc(col))}
\item
  \textbf{多列排序}：\texttt{arrange(data,\ col1,\ col2)}
\end{itemize}

\hypertarget{group_by-ux4e0e-summarise}{%
\paragraph{\texorpdfstring{\texttt{group\_by()} 与 \texttt{summarise()}}{group\_by() 与 summarise()}}\label{group_by-ux4e0e-summarise}}

\begin{itemize}
\tightlist
\item
  \textbf{分组概念}：将数据按指定变量分组
\item
  \textbf{汇总函数}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{n()}：计数
  \item
    \texttt{mean()}、\texttt{median()}：均值、中位数
  \item
    \texttt{sum()}、\texttt{min()}、\texttt{max()}：求和、最小值、最大值
  \item
    \texttt{sd()}、\texttt{var()}：标准差、方差
  \end{itemize}
\item
  \textbf{\texttt{.groups} 参数}：控制结果的分组状态
\end{itemize}

\hypertarget{ux6570ux636eux91cdux5851}{%
\subsubsection{数据重塑}\label{ux6570ux636eux91cdux5851}}

\hypertarget{ux957fux5bbdux683cux5f0fux6982ux5ff5}{%
\paragraph{长宽格式概念}\label{ux957fux5bbdux683cux5f0fux6982ux5ff5}}

\begin{itemize}
\tightlist
\item
  \textbf{宽格式}：每个变量一列，观察单位一行
\item
  \textbf{长格式}：变量名和变量值分别存储在不同列中
\item
  \textbf{选择原则}：

  \begin{itemize}
  \tightlist
  \item
    分析时通常用长格式
  \item
    展示时通常用宽格式
  \end{itemize}
\end{itemize}

\hypertarget{pivot_longer---ux5bbdux8f6cux957f}{%
\paragraph{\texorpdfstring{\texttt{pivot\_longer()} - 宽转长}{pivot\_longer() - 宽转长}}\label{pivot_longer---ux5bbdux8f6cux957f}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{pivot\_longer(data,\ cols,\ names\_to,\ values\_to)}
\item
  \textbf{参数}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{cols}：要转换的列
  \item
    \texttt{names\_to}：存储变量名的新列名
  \item
    \texttt{values\_to}：存储变量值的新列名
  \end{itemize}
\end{itemize}

\hypertarget{pivot_wider---ux957fux8f6cux5bbd}{%
\paragraph{\texorpdfstring{\texttt{pivot\_wider()} - 长转宽}{pivot\_wider() - 长转宽}}\label{pivot_wider---ux957fux8f6cux5bbd}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{pivot\_wider(data,\ names\_from,\ values\_from)}
\item
  \textbf{参数}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{names\_from}：提供新列名的列
  \item
    \texttt{values\_from}：提供新列值的列
  \end{itemize}
\end{itemize}

\hypertarget{ux6570ux636eux8fdeux63a5-1}{%
\subsubsection{数据连接}\label{ux6570ux636eux8fdeux63a5-1}}

\hypertarget{ux8fdeux63a5ux7c7bux578b}{%
\paragraph{连接类型}\label{ux8fdeux63a5ux7c7bux578b}}

\begin{itemize}
\tightlist
\item
  \textbf{\texttt{left\_join()}}：保留左表所有行
\item
  \textbf{\texttt{right\_join()}}：保留右表所有行
\item
  \textbf{\texttt{inner\_join()}}：仅保留匹配行
\item
  \textbf{\texttt{full\_join()}}：保留所有行
\end{itemize}

\hypertarget{ux8fdeux63a5ux8bedux6cd5}{%
\paragraph{连接语法}\label{ux8fdeux63a5ux8bedux6cd5}}

\begin{itemize}
\tightlist
\item
  \textbf{基本语法}：\texttt{left\_join(x,\ y,\ by\ =\ "key")}
\item
  \textbf{多键连接}：\texttt{by\ =\ c("key1",\ "key2")}
\item
  \textbf{不同列名}：\texttt{by\ =\ c("x\_key"\ =\ "y\_key")}
\end{itemize}

\hypertarget{ux8bfeux540eux7ec3ux4e60-8}{%
\subsection{课后练习}\label{ux8bfeux540eux7ec3ux4e60-8}}

\textbf{题目}：某湿地生物多样性调查数据：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{wetland\_survey }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{site\_id =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"W1"}\NormalTok{, }\StringTok{"W2"}\NormalTok{, }\StringTok{"W3"}\NormalTok{), }\AttributeTok{each =} \DecValTok{8}\NormalTok{),}
  \AttributeTok{date =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"2022{-}05"}\NormalTok{, }\StringTok{"2022{-}08"}\NormalTok{, }\StringTok{"2022{-}05"}\NormalTok{, }\StringTok{"2022{-}08"}\NormalTok{), }\AttributeTok{times =} \DecValTok{6}\NormalTok{),}
  \AttributeTok{plant\_species =} \FunctionTok{c}\NormalTok{(}\DecValTok{15}\NormalTok{, }\DecValTok{18}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{16}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{18}\NormalTok{, }\DecValTok{22}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{10}\NormalTok{),}
  \AttributeTok{bird\_species =} \FunctionTok{c}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{9}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{18}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{14}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{),}
  \AttributeTok{water\_level =} \FunctionTok{c}\NormalTok{(}\DecValTok{45}\NormalTok{, }\DecValTok{38}\NormalTok{, }\DecValTok{50}\NormalTok{, }\DecValTok{42}\NormalTok{, }\DecValTok{35}\NormalTok{, }\DecValTok{28}\NormalTok{, }\DecValTok{40}\NormalTok{, }\DecValTok{33}\NormalTok{, }\DecValTok{55}\NormalTok{, }\DecValTok{48}\NormalTok{, }\DecValTok{60}\NormalTok{, }\DecValTok{53}\NormalTok{)}
\NormalTok{)}

\NormalTok{site\_characteristics }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{site\_id =} \FunctionTok{c}\NormalTok{(}\StringTok{"W1"}\NormalTok{, }\StringTok{"W2"}\NormalTok{, }\StringTok{"W3"}\NormalTok{),}
  \AttributeTok{area\_ha =} \FunctionTok{c}\NormalTok{(}\DecValTok{12}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{15}\NormalTok{),}
  \AttributeTok{protection\_status =} \FunctionTok{c}\NormalTok{(}\StringTok{"保护区"}\NormalTok{, }\StringTok{"缓冲区"}\NormalTok{, }\StringTok{"实验区"}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

请完成（使用tidyverse工具链，结合之前学过的统计和可视化方法）：

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  筛选出5月份的调查数据，并计算植物和鸟类物种总数（使用filter()和mutate()）
\item
  按站点分组，计算各站点的平均物种数和水位变化范围（使用group\_by()和summarise()）
\item
  连接站点特征数据，创建物种密度指标（物种数/面积）（使用left\_join()和mutate()）
\item
  将数据从宽格式转换为长格式，便于后续统计分析（使用pivot\_longer()）
\item
  根据保护状态和季节，分析不同组合下的生物多样性特征（使用group\_by()和统计函数）
\item
  使用ggplot2创建专业的可视化图表展示分析结果
\item
  与第9课的传统方法对比，体会tidyverse的优势
\end{enumerate}

\hypertarget{ux56feux5f62ux8bedux6cd5ux4e0eux79d1ux5b66ux7ed8ux56fe}{%
\section{图形语法与科学绘图}\label{ux56feux5f62ux8bedux6cd5ux4e0eux79d1ux5b66ux7ed8ux56fe}}

\hypertarget{ux751fux6001ux5b66ux80ccux666f-9}{%
\subsection{生态学背景}\label{ux751fux6001ux5b66ux80ccux666f-9}}

数据可视化是生态学研究中传达发现和支持论证的关键工具。与基础R绘图相比，ggplot2采用图形语法，能够创建更加专业、美观的科学图表，满足期刊发表和学术报告的高标准要求。

\hypertarget{ux6f14ux793aux6570ux636e-8}{%
\subsection{演示数据}\label{ux6f14ux793aux6570ux636e-8}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 某保护区多年生物多样性监测数据}
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(dplyr)}

\NormalTok{biodiversity\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{year =} \FunctionTok{rep}\NormalTok{(}\DecValTok{2018}\SpecialCharTok{:}\DecValTok{2022}\NormalTok{, }\AttributeTok{each =} \DecValTok{12}\NormalTok{),}
  \AttributeTok{month =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{12}\NormalTok{, }\AttributeTok{times =} \DecValTok{5}\NormalTok{),}
  \AttributeTok{temperature =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{60}\NormalTok{, }\AttributeTok{mean =} \DecValTok{15} \SpecialCharTok{+} \DecValTok{5}\SpecialCharTok{*}\FunctionTok{sin}\NormalTok{(}\DecValTok{2}\SpecialCharTok{*}\NormalTok{pi}\SpecialCharTok{*}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{12}\NormalTok{, }\AttributeTok{times=}\DecValTok{5}\NormalTok{)}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{12}\NormalTok{), }\AttributeTok{sd =} \DecValTok{2}\NormalTok{),}
  \AttributeTok{species\_richness =} \FunctionTok{rpois}\NormalTok{(}\DecValTok{60}\NormalTok{, }\AttributeTok{lambda =} \DecValTok{25} \SpecialCharTok{+} \DecValTok{10}\SpecialCharTok{*}\FunctionTok{sin}\NormalTok{(}\DecValTok{2}\SpecialCharTok{*}\NormalTok{pi}\SpecialCharTok{*}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{12}\NormalTok{, }\AttributeTok{times=}\DecValTok{5}\NormalTok{)}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{12}\NormalTok{)),}
  \AttributeTok{habitat =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"森林"}\NormalTok{, }\StringTok{"草地"}\NormalTok{, }\StringTok{"湿地"}\NormalTok{), }\AttributeTok{length.out =} \DecValTok{60}\NormalTok{),}
  \AttributeTok{elevation =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1200}\NormalTok{, }\DecValTok{1000}\NormalTok{, }\DecValTok{800}\NormalTok{), }\AttributeTok{length.out =} \DecValTok{60}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-9}{%
\subsection{课堂演示过程}\label{ux8bfeux5802ux6f14ux793aux8fc7ux7a0b-9}}

\hypertarget{ggplot2ux57faux7840ux8bedux6cd5}{%
\subsubsection{ggplot2基础语法}\label{ggplot2ux57faux7840ux8bedux6cd5}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(dplyr)}

\CommentTok{\# 创建示例数据}
\NormalTok{bird\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{species =} \FunctionTok{c}\NormalTok{(}\StringTok{"白头鹎"}\NormalTok{, }\StringTok{"麻雀"}\NormalTok{, }\StringTok{"喜鹊"}\NormalTok{, }\StringTok{"乌鸦"}\NormalTok{, }\StringTok{"燕子"}\NormalTok{, }\StringTok{"画眉"}\NormalTok{),}
  \AttributeTok{abundance =} \FunctionTok{c}\NormalTok{(}\DecValTok{45}\NormalTok{, }\DecValTok{78}\NormalTok{, }\DecValTok{32}\NormalTok{, }\DecValTok{28}\NormalTok{, }\DecValTok{56}\NormalTok{, }\DecValTok{41}\NormalTok{),}
  \AttributeTok{habitat =} \FunctionTok{c}\NormalTok{(}\StringTok{"森林"}\NormalTok{, }\StringTok{"城市"}\NormalTok{, }\StringTok{"农田"}\NormalTok{, }\StringTok{"城市"}\NormalTok{, }\StringTok{"农田"}\NormalTok{, }\StringTok{"森林"}\NormalTok{),}
  \AttributeTok{body\_mass =} \FunctionTok{c}\NormalTok{(}\DecValTok{25}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{180}\NormalTok{, }\DecValTok{350}\NormalTok{, }\DecValTok{18}\NormalTok{, }\DecValTok{35}\NormalTok{)}
\NormalTok{)}

\CommentTok{\# 基础散点图}
\FunctionTok{ggplot}\NormalTok{(bird\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ body\_mass, }\AttributeTok{y =}\NormalTok{ abundance)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}

\CommentTok{\# 添加颜色映射}
\FunctionTok{ggplot}\NormalTok{(bird\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ body\_mass, }\AttributeTok{y =}\NormalTok{ abundance, }\AttributeTok{color =}\NormalTok{ habitat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \DecValTok{3}\NormalTok{)}

\CommentTok{\# 添加标题和标签}
\FunctionTok{ggplot}\NormalTok{(bird\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ body\_mass, }\AttributeTok{y =}\NormalTok{ abundance, }\AttributeTok{color =}\NormalTok{ habitat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \DecValTok{3}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"鸟类体重与丰度关系"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"不同栖息地类型的比较"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"体重 (g)"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"丰度 (个体数)"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"栖息地类型"}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux4e0dux540cux7c7bux578bux7684ux56feux8868}{%
\subsubsection{不同类型的图表}\label{ux4e0dux540cux7c7bux578bux7684ux56feux8868}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 创建时间序列数据}
\NormalTok{time\_series\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{month =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{12}\NormalTok{, }\DecValTok{3}\NormalTok{),}
  \AttributeTok{species\_count =} \FunctionTok{c}\NormalTok{(}
    \DecValTok{20}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{35}\NormalTok{, }\DecValTok{45}\NormalTok{, }\DecValTok{55}\NormalTok{, }\DecValTok{60}\NormalTok{, }\DecValTok{58}\NormalTok{, }\DecValTok{52}\NormalTok{, }\DecValTok{42}\NormalTok{, }\DecValTok{32}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{22}\NormalTok{,  }\CommentTok{\# 2020年}
    \DecValTok{22}\NormalTok{, }\DecValTok{28}\NormalTok{, }\DecValTok{38}\NormalTok{, }\DecValTok{48}\NormalTok{, }\DecValTok{58}\NormalTok{, }\DecValTok{65}\NormalTok{, }\DecValTok{62}\NormalTok{, }\DecValTok{55}\NormalTok{, }\DecValTok{45}\NormalTok{, }\DecValTok{35}\NormalTok{, }\DecValTok{28}\NormalTok{, }\DecValTok{25}\NormalTok{,  }\CommentTok{\# 2021年}
    \DecValTok{25}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{40}\NormalTok{, }\DecValTok{50}\NormalTok{, }\DecValTok{60}\NormalTok{, }\DecValTok{68}\NormalTok{, }\DecValTok{65}\NormalTok{, }\DecValTok{58}\NormalTok{, }\DecValTok{48}\NormalTok{, }\DecValTok{38}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{28}   \CommentTok{\# 2022年}
\NormalTok{  ),}
  \AttributeTok{year =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"2020"}\NormalTok{, }\StringTok{"2021"}\NormalTok{, }\StringTok{"2022"}\NormalTok{), }\AttributeTok{each =} \DecValTok{12}\NormalTok{)}
\NormalTok{)}

\CommentTok{\# 线图}
\FunctionTok{ggplot}\NormalTok{(time\_series\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ month, }\AttributeTok{y =}\NormalTok{ species\_count, }\AttributeTok{color =}\NormalTok{ year)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size =} \DecValTok{2}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{12}\NormalTok{, }\AttributeTok{labels =}\NormalTok{ month.abb) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"月度物种数量变化"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"月份"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"物种数量"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"年份"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}

\CommentTok{\# 柱状图}
\NormalTok{habitat\_summary }\OtherTok{\textless{}{-}}\NormalTok{ bird\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(habitat) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{mean\_abundance =} \FunctionTok{mean}\NormalTok{(abundance),}
    \AttributeTok{se\_abundance =} \FunctionTok{sd}\NormalTok{(abundance) }\SpecialCharTok{/} \FunctionTok{sqrt}\NormalTok{(}\FunctionTok{n}\NormalTok{()),}
    \AttributeTok{.groups =} \StringTok{\textquotesingle{}drop\textquotesingle{}}
\NormalTok{  )}

\FunctionTok{ggplot}\NormalTok{(habitat\_summary, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ habitat, }\AttributeTok{y =}\NormalTok{ mean\_abundance, }\AttributeTok{fill =}\NormalTok{ habitat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_errorbar}\NormalTok{(}
    \FunctionTok{aes}\NormalTok{(}\AttributeTok{ymin =}\NormalTok{ mean\_abundance }\SpecialCharTok{{-}}\NormalTok{ se\_abundance, }
        \AttributeTok{ymax =}\NormalTok{ mean\_abundance }\SpecialCharTok{+}\NormalTok{ se\_abundance),}
    \AttributeTok{width =} \FloatTok{0.2}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"不同栖息地的鸟类平均丰度"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"栖息地类型"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"平均丰度"}\NormalTok{,}
    \AttributeTok{fill =} \StringTok{"栖息地"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{()}

\CommentTok{\# 箱线图}
\FunctionTok{ggplot}\NormalTok{(bird\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ habitat, }\AttributeTok{y =}\NormalTok{ abundance, }\AttributeTok{fill =}\NormalTok{ habitat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_jitter}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.2}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.6}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"不同栖息地鸟类丰度分布"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"栖息地类型"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"丰度"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux591aux9762ux677fux56feux5f62}{%
\subsubsection{多面板图形}\label{ux591aux9762ux677fux56feux5f62}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 创建多组数据}
\NormalTok{multi\_species\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{species =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"鸟类"}\NormalTok{, }\StringTok{"哺乳动物"}\NormalTok{, }\StringTok{"昆虫"}\NormalTok{), }\AttributeTok{each =} \DecValTok{24}\NormalTok{),}
  \AttributeTok{month =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{12}\NormalTok{, }\DecValTok{6}\NormalTok{),}
  \AttributeTok{year =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"2021"}\NormalTok{, }\StringTok{"2022"}\NormalTok{), }\AttributeTok{each =} \DecValTok{12}\NormalTok{, }\AttributeTok{times =} \DecValTok{3}\NormalTok{),}
  \AttributeTok{abundance =} \FunctionTok{c}\NormalTok{(}
    \CommentTok{\# 鸟类数据}
    \FunctionTok{rnorm}\NormalTok{(}\DecValTok{24}\NormalTok{, }\AttributeTok{mean =} \DecValTok{30} \SpecialCharTok{+} \DecValTok{15}\SpecialCharTok{*}\FunctionTok{sin}\NormalTok{(}\DecValTok{2}\SpecialCharTok{*}\NormalTok{pi}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{24{-}1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{12}\NormalTok{), }\AttributeTok{sd =} \DecValTok{5}\NormalTok{),}
    \CommentTok{\# 哺乳动物数据}
    \FunctionTok{rnorm}\NormalTok{(}\DecValTok{24}\NormalTok{, }\AttributeTok{mean =} \DecValTok{15} \SpecialCharTok{+} \DecValTok{8}\SpecialCharTok{*}\FunctionTok{sin}\NormalTok{(}\DecValTok{2}\SpecialCharTok{*}\NormalTok{pi}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{24{-}1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{12}\NormalTok{), }\AttributeTok{sd =} \DecValTok{3}\NormalTok{),}
    \CommentTok{\# 昆虫数据}
    \FunctionTok{rnorm}\NormalTok{(}\DecValTok{24}\NormalTok{, }\AttributeTok{mean =} \DecValTok{80} \SpecialCharTok{+} \DecValTok{40}\SpecialCharTok{*}\FunctionTok{sin}\NormalTok{(}\DecValTok{2}\SpecialCharTok{*}\NormalTok{pi}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{24{-}1}\NormalTok{)}\SpecialCharTok{/}\DecValTok{12}\NormalTok{), }\AttributeTok{sd =} \DecValTok{15}\NormalTok{)}
\NormalTok{  )}
\NormalTok{)}

\CommentTok{\# 分面图}
\FunctionTok{ggplot}\NormalTok{(multi\_species\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ month, }\AttributeTok{y =}\NormalTok{ abundance, }\AttributeTok{color =}\NormalTok{ year)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{size =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ species, }\AttributeTok{scales =} \StringTok{"free\_y"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{9}\NormalTok{, }\DecValTok{12}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"不同类群动物的季节性变化模式"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"月份"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"丰度"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"年份"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux4e13ux4e1aux4e3bux9898ux548cux81eaux5b9aux4e49}{%
\subsubsection{专业主题和自定义}\label{ux4e13ux4e1aux4e3bux9898ux548cux81eaux5b9aux4e49}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 创建专业期刊风格的图表}
\NormalTok{publication\_plot }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(bird\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ body\_mass, }\AttributeTok{y =}\NormalTok{ abundance)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ habitat), }\AttributeTok{size =} \DecValTok{3}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"lm"}\NormalTok{, }\AttributeTok{se =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"森林"} \OtherTok{=} \StringTok{"\#2E8B57"}\NormalTok{, }\StringTok{"城市"} \OtherTok{=} \StringTok{"\#DC143C"}\NormalTok{, }\StringTok{"农田"} \OtherTok{=} \StringTok{"\#DAA520"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"鸟类体重与种群丰度的关系"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"体重 (g)"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"种群丰度 (个体数)"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"栖息地类型"}\NormalTok{,}
    \AttributeTok{caption =} \StringTok{"数据来源：某自然保护区鸟类调查 (2022)"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{14}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{),}
    \AttributeTok{axis.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
    \AttributeTok{axis.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{),}
    \AttributeTok{legend.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{11}\NormalTok{),}
    \AttributeTok{legend.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{),}
    \AttributeTok{panel.grid.minor =} \FunctionTok{element\_blank}\NormalTok{(),}
    \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{size =} \DecValTok{8}\NormalTok{, }\AttributeTok{color =} \StringTok{"gray50"}\NormalTok{)}
\NormalTok{  )}

\FunctionTok{print}\NormalTok{(publication\_plot)}

\CommentTok{\# 保存图片}
\FunctionTok{ggsave}\NormalTok{(}\StringTok{"bird\_analysis.png"}\NormalTok{, publication\_plot, }
       \AttributeTok{width =} \DecValTok{8}\NormalTok{, }\AttributeTok{height =} \DecValTok{6}\NormalTok{, }\AttributeTok{dpi =} \DecValTok{300}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux590dux6742ux7684ux751fux6001ux5b66ux53efux89c6ux5316}{%
\subsubsection{复杂的生态学可视化}\label{ux590dux6742ux7684ux751fux6001ux5b66ux53efux89c6ux5316}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 群落组成气泡图}
\NormalTok{community\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{site =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"样地A"}\NormalTok{, }\StringTok{"样地B"}\NormalTok{, }\StringTok{"样地C"}\NormalTok{), }\AttributeTok{each =} \DecValTok{6}\NormalTok{),}
  \AttributeTok{species =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"物种1"}\NormalTok{, }\StringTok{"物种2"}\NormalTok{, }\StringTok{"物种3"}\NormalTok{, }\StringTok{"物种4"}\NormalTok{, }\StringTok{"物种5"}\NormalTok{, }\StringTok{"物种6"}\NormalTok{), }\DecValTok{3}\NormalTok{),}
  \AttributeTok{abundance =} \FunctionTok{c}\NormalTok{(}\DecValTok{25}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{32}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{6}\NormalTok{,   }\CommentTok{\# 样地A}
                \DecValTok{18}\NormalTok{, }\DecValTok{22}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{15}\NormalTok{,  }\CommentTok{\# 样地B}
                \DecValTok{12}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{18}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{17}\NormalTok{), }\CommentTok{\# 样地C}
  \AttributeTok{biomass =} \FunctionTok{c}\NormalTok{(}\FloatTok{2.5}\NormalTok{, }\FloatTok{3.2}\NormalTok{, }\FloatTok{1.8}\NormalTok{, }\FloatTok{4.1}\NormalTok{, }\FloatTok{2.0}\NormalTok{, }\FloatTok{1.2}\NormalTok{,}
              \FloatTok{3.0}\NormalTok{, }\FloatTok{2.8}\NormalTok{, }\FloatTok{2.2}\NormalTok{, }\FloatTok{3.5}\NormalTok{, }\FloatTok{1.5}\NormalTok{, }\FloatTok{2.5}\NormalTok{,}
              \FloatTok{2.2}\NormalTok{, }\FloatTok{1.8}\NormalTok{, }\FloatTok{4.0}\NormalTok{, }\FloatTok{2.9}\NormalTok{, }\FloatTok{3.8}\NormalTok{, }\FloatTok{3.2}\NormalTok{)}
\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(community\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ species, }\AttributeTok{y =}\NormalTok{ site)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{size =}\NormalTok{ abundance, }\AttributeTok{color =}\NormalTok{ biomass), }\AttributeTok{alpha =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_size\_continuous}\NormalTok{(}\AttributeTok{range =} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{12}\NormalTok{), }\AttributeTok{name =} \StringTok{"丰度"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_gradient}\NormalTok{(}\AttributeTok{low =} \StringTok{"lightblue"}\NormalTok{, }\AttributeTok{high =} \StringTok{"darkred"}\NormalTok{, }\AttributeTok{name =} \StringTok{"生物量(kg)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"群落物种组成与生物量分布"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"物种"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"样地"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{45}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{),}
    \AttributeTok{panel.grid =} \FunctionTok{element\_line}\NormalTok{(}\AttributeTok{color =} \StringTok{"gray90"}\NormalTok{, }\AttributeTok{size =} \FloatTok{0.3}\NormalTok{)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\hypertarget{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-9}{%
\subsection{R语言知识点详解}\label{rux8bedux8a00ux77e5ux8bc6ux70b9ux8be6ux89e3-9}}

\hypertarget{ggplot2ux7684ux56feux5f62ux8bedux6cd5}{%
\subsubsection{ggplot2的图形语法}\label{ggplot2ux7684ux56feux5f62ux8bedux6cd5}}

\hypertarget{ux57faux672cux6982ux5ff5}{%
\paragraph{基本概念}\label{ux57faux672cux6982ux5ff5}}

\begin{itemize}
\tightlist
\item
  \textbf{数据(Data)}：要可视化的数据集
\item
  \textbf{美学映射(Aesthetics)}：数据变量到图形属性的映射
\item
  \textbf{几何对象(Geometries)}：用来表示数据的图形元素
\item
  \textbf{统计变换(Statistics)}：对原始数据的统计总结
\item
  \textbf{坐标系统(Coordinates)}：数据如何映射到平面
\item
  \textbf{分面(Facets)}：将数据分割成子集的方法
\item
  \textbf{主题(Themes)}：控制图形整体外观
\end{itemize}

\hypertarget{ux57faux672cux8bedux6cd5ux7ed3ux6784}{%
\paragraph{基本语法结构}\label{ux57faux672cux8bedux6cd5ux7ed3ux6784}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ var1, }\AttributeTok{y =}\NormalTok{ var2)) }\SpecialCharTok{+}
\NormalTok{  geom\_}\SpecialCharTok{*}\NormalTok{() }\SpecialCharTok{+}
\NormalTok{  scale\_}\SpecialCharTok{*}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{() }\SpecialCharTok{+}
\NormalTok{  theme\_}\SpecialCharTok{*}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\hypertarget{ux7f8eux5b66ux6620ux5c04ux7cfbux7edf}{%
\subsubsection{美学映射系统}\label{ux7f8eux5b66ux6620ux5c04ux7cfbux7edf}}

\hypertarget{aes-ux51fdux6570}{%
\paragraph{\texorpdfstring{\texttt{aes()} 函数}{aes() 函数}}\label{aes-ux51fdux6570}}

\begin{itemize}
\tightlist
\item
  \textbf{位置映射}：\texttt{x}、\texttt{y}
\item
  \textbf{颜色映射}：\texttt{color}（边框）、\texttt{fill}（填充）
\item
  \textbf{大小映射}：\texttt{size}
\item
  \textbf{形状映射}：\texttt{shape}
\item
  \textbf{透明度映射}：\texttt{alpha}
\item
  \textbf{线型映射}：\texttt{linetype}
\end{itemize}

\hypertarget{ux6620ux5c04-vs-ux8bbeux5b9a}{%
\paragraph{映射 vs 设定}\label{ux6620ux5c04-vs-ux8bbeux5b9a}}

\begin{itemize}
\tightlist
\item
  \textbf{映射}：\texttt{aes(color\ =\ variable)}，颜色根据变量值变化
\item
  \textbf{设定}：\texttt{geom\_point(color\ =\ "red")}，所有点都是红色
\end{itemize}

\hypertarget{ux51e0ux4f55ux5bf9ux8c61ux8be6ux89e3}{%
\subsubsection{几何对象详解}\label{ux51e0ux4f55ux5bf9ux8c61ux8be6ux89e3}}

\hypertarget{ux70b9ux56feux76f8ux5173}{%
\paragraph{点图相关}\label{ux70b9ux56feux76f8ux5173}}

\begin{itemize}
\tightlist
\item
  \textbf{\texttt{geom\_point()}}：散点图
\item
  \textbf{\texttt{geom\_jitter()}}：抖动散点图
\item
  \textbf{参数}：\texttt{size}、\texttt{shape}、\texttt{alpha}、\texttt{stroke}
\end{itemize}

\hypertarget{ux7ebfux56feux76f8ux5173}{%
\paragraph{线图相关}\label{ux7ebfux56feux76f8ux5173}}

\begin{itemize}
\tightlist
\item
  \textbf{\texttt{geom\_line()}}：线图
\item
  \textbf{\texttt{geom\_path()}}：路径图
\item
  \textbf{\texttt{geom\_smooth()}}：拟合线
\item
  \textbf{参数}：\texttt{size}、\texttt{linetype}、\texttt{method}
\end{itemize}

\hypertarget{ux67f1ux72b6ux56feux76f8ux5173}{%
\paragraph{柱状图相关}\label{ux67f1ux72b6ux56feux76f8ux5173}}

\begin{itemize}
\tightlist
\item
  \textbf{\texttt{geom\_col()}}：柱状图（使用实际值）
\item
  \textbf{\texttt{geom\_bar()}}：柱状图（统计计数）
\item
  \textbf{\texttt{geom\_histogram()}}：直方图
\item
  \textbf{参数}：\texttt{width}、\texttt{position}
\end{itemize}

\hypertarget{ux5206ux5e03ux56feux76f8ux5173}{%
\paragraph{分布图相关}\label{ux5206ux5e03ux56feux76f8ux5173}}

\begin{itemize}
\tightlist
\item
  \textbf{\texttt{geom\_boxplot()}}：箱线图
\item
  \textbf{\texttt{geom\_violin()}}：小提琴图
\item
  \textbf{\texttt{geom\_density()}}：密度图
\end{itemize}

\hypertarget{ux6807ux5ea6ux7cfbux7edf}{%
\subsubsection{标度系统}\label{ux6807ux5ea6ux7cfbux7edf}}

\hypertarget{ux989cux8272ux6807ux5ea6}{%
\paragraph{颜色标度}\label{ux989cux8272ux6807ux5ea6}}

\begin{itemize}
\tightlist
\item
  \textbf{连续型}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{scale\_color\_gradient()}：双色渐变
  \item
    \texttt{scale\_color\_gradient2()}：三色渐变
  \item
    \texttt{scale\_color\_viridis\_c()}：viridis调色板
  \end{itemize}
\item
  \textbf{离散型}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{scale\_color\_manual()}：手动设置颜色
  \item
    \texttt{scale\_color\_brewer()}：ColorBrewer调色板
  \end{itemize}
\end{itemize}

\hypertarget{ux5750ux6807ux8f74ux6807ux5ea6}{%
\paragraph{坐标轴标度}\label{ux5750ux6807ux8f74ux6807ux5ea6}}

\begin{itemize}
\tightlist
\item
  \textbf{连续型}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{scale\_x\_continuous()}：连续x轴
  \item
    \texttt{scale\_y\_log10()}：对数y轴
  \end{itemize}
\item
  \textbf{离散型}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{scale\_x\_discrete()}：离散x轴
  \end{itemize}
\item
  \textbf{日期型}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{scale\_x\_date()}：日期x轴
  \end{itemize}
\end{itemize}

\hypertarget{ux5206ux9762ux7cfbux7edf}{%
\subsubsection{分面系统}\label{ux5206ux9762ux7cfbux7edf}}

\hypertarget{facet_wrap}{%
\paragraph{\texorpdfstring{\texttt{facet\_wrap()}}{facet\_wrap()}}\label{facet_wrap}}

\begin{itemize}
\tightlist
\item
  \textbf{用途}：按一个变量分面，排列成网格
\item
  \textbf{语法}：\texttt{facet\_wrap(\textasciitilde{}\ variable,\ ncol\ =\ 2)}
\item
  \textbf{参数}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{ncol}、\texttt{nrow}：列数和行数
  \item
    \texttt{scales}：坐标轴缩放方式
  \end{itemize}
\end{itemize}

\hypertarget{facet_grid}{%
\paragraph{\texorpdfstring{\texttt{facet\_grid()}}{facet\_grid()}}\label{facet_grid}}

\begin{itemize}
\tightlist
\item
  \textbf{用途}：按两个变量分面，形成矩阵
\item
  \textbf{语法}：\texttt{facet\_grid(rows\ \textasciitilde{}\ cols)}
\item
  \textbf{特殊语法}：

  \begin{itemize}
  \tightlist
  \item
    \texttt{facet\_grid(.\ \textasciitilde{}\ variable)}：仅按列分面
  \item
    \texttt{facet\_grid(variable\ \textasciitilde{}\ .)}：仅按行分面
  \end{itemize}
\end{itemize}

\hypertarget{ux4e3bux9898ux7cfbux7edf}{%
\subsubsection{主题系统}\label{ux4e3bux9898ux7cfbux7edf}}

\hypertarget{ux9884ux8bbeux4e3bux9898}{%
\paragraph{预设主题}\label{ux9884ux8bbeux4e3bux9898}}

\begin{itemize}
\tightlist
\item
  \textbf{\texttt{theme\_minimal()}}：简洁主题
\item
  \textbf{\texttt{theme\_classic()}}：经典主题
\item
  \textbf{\texttt{theme\_bw()}}：黑白主题
\item
  \textbf{\texttt{theme\_void()}}：空白主题
\end{itemize}

\hypertarget{ux81eaux5b9aux4e49ux4e3bux9898ux5143ux7d20}{%
\paragraph{自定义主题元素}\label{ux81eaux5b9aux4e49ux4e3bux9898ux5143ux7d20}}

\begin{itemize}
\tightlist
\item
  \textbf{文本元素}：\texttt{element\_text()}

  \begin{itemize}
  \tightlist
  \item
    \texttt{size}：字体大小
  \item
    \texttt{color}：字体颜色
  \item
    \texttt{face}：字体样式（``bold''、``italic''）
  \item
    \texttt{hjust}、\texttt{vjust}：水平和垂直对齐
  \end{itemize}
\item
  \textbf{线条元素}：\texttt{element\_line()}

  \begin{itemize}
  \tightlist
  \item
    \texttt{color}：线条颜色
  \item
    \texttt{size}：线条粗细
  \item
    \texttt{linetype}：线条类型
  \end{itemize}
\item
  \textbf{矩形元素}：\texttt{element\_rect()}

  \begin{itemize}
  \tightlist
  \item
    \texttt{fill}：填充颜色
  \item
    \texttt{color}：边框颜色
  \end{itemize}
\item
  \textbf{移除元素}：\texttt{element\_blank()}
\end{itemize}

\hypertarget{ux56feux7247ux4fddux5b58}{%
\subsubsection{图片保存}\label{ux56feux7247ux4fddux5b58}}

\hypertarget{ggsave-ux51fdux6570}{%
\paragraph{\texorpdfstring{\texttt{ggsave()} 函数}{ggsave() 函数}}\label{ggsave-ux51fdux6570}}

\begin{itemize}
\tightlist
\item
  \textbf{语法}：\texttt{ggsave(filename,\ plot,\ width,\ height,\ dpi,\ units)}
\item
  \textbf{支持格式}：

  \begin{itemize}
  \tightlist
  \item
    矢量格式：PDF、SVG、EPS
  \item
    位图格式：PNG、JPEG、TIFF
  \end{itemize}
\item
  \textbf{推荐设置}：

  \begin{itemize}
  \tightlist
  \item
    期刊投稿：300-600 DPI
  \item
    演示文稿：150-300 DPI
  \item
    网页使用：72-150 DPI
  \end{itemize}
\end{itemize}

\hypertarget{ux8272ux5f69ux8bbeux8ba1ux539fux5219}{%
\subsubsection{色彩设计原则}\label{ux8272ux5f69ux8bbeux8ba1ux539fux5219}}

\hypertarget{ux79d1ux5b66ux53efux89c6ux5316ux8272ux5f69ux6307ux5357}{%
\paragraph{科学可视化色彩指南}\label{ux79d1ux5b66ux53efux89c6ux5316ux8272ux5f69ux6307ux5357}}

\begin{itemize}
\tightlist
\item
  \textbf{连续数据}：使用渐变色，避免彩虹色
\item
  \textbf{分类数据}：使用对比鲜明的颜色
\item
  \textbf{色盲友好}：避免红绿组合，推荐viridis调色板
\item
  \textbf{发表要求}：考虑黑白印刷效果
\end{itemize}

\hypertarget{ux63a8ux8350ux8c03ux8272ux677f}{%
\paragraph{推荐调色板}\label{ux63a8ux8350ux8c03ux8272ux677f}}

\begin{itemize}
\tightlist
\item
  \textbf{Viridis系列}：色盲友好，打印友好
\item
  \textbf{ColorBrewer}：专业的制图调色板
\item
  \textbf{自然色彩}：模仿自然界的颜色组合
\end{itemize}

\hypertarget{ux8bfeux540eux7ec3ux4e60-9}{%
\subsection{课后练习}\label{ux8bfeux540eux7ec3ux4e60-9}}

\textbf{题目}：某国家公园植被多样性调查数据：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vegetation\_survey }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{transect =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"山顶"}\NormalTok{, }\StringTok{"山腰"}\NormalTok{, }\StringTok{"山底"}\NormalTok{), }\AttributeTok{each =} \DecValTok{20}\NormalTok{),}
  \AttributeTok{species\_richness =} \FunctionTok{c}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{3}\NormalTok{), }\FunctionTok{rnorm}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{4}\NormalTok{), }\FunctionTok{rnorm}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{35}\NormalTok{, }\DecValTok{5}\NormalTok{)),}
  \AttributeTok{coverage\_percent =} \FunctionTok{c}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{60}\NormalTok{, }\DecValTok{10}\NormalTok{), }\FunctionTok{rnorm}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{75}\NormalTok{, }\DecValTok{8}\NormalTok{), }\FunctionTok{rnorm}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{85}\NormalTok{, }\DecValTok{6}\NormalTok{)),}
  \AttributeTok{slope\_degree =} \FunctionTok{c}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{5}\NormalTok{), }\FunctionTok{rnorm}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{3}\NormalTok{), }\FunctionTok{rnorm}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{2}\NormalTok{)),}
  \AttributeTok{soil\_depth =} \FunctionTok{c}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{3}\NormalTok{), }\FunctionTok{rnorm}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{4}\NormalTok{), }\FunctionTok{rnorm}\NormalTok{(}\DecValTok{20}\NormalTok{, }\DecValTok{40}\NormalTok{, }\DecValTok{6}\NormalTok{))}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

请完成（使用ggplot2高级功能，结合之前学过的所有内容）：

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  创建物种丰富度与植被覆盖度的散点图，用颜色区分不同海拔带（使用geom\_point()和aes()）
\item
  绘制三个海拔带物种丰富度的箱线图，添加个体数据点（使用geom\_boxplot()和geom\_jitter()）
\item
  创建多面板图，展示不同海拔带的各项指标分布（使用facet\_wrap()）
\item
  设计一个期刊级别的综合图表，展示海拔梯度上的植被特征变化（使用多个geom层）
\item
  自定义主题，确保图表符合学术发表标准（使用theme()函数）
\item
  保存高质量图片用于论文发表（使用ggsave()函数）
\item
  与第7课的基础绘图方法对比，总结ggplot2的优势
\item
  尝试创建动态或交互式可视化（选做，可查阅相关资料）
\end{enumerate}

  \bibliography{book.bib,packages.bib}

\end{document}
