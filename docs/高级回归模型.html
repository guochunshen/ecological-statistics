<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 高级回归模型 | 生态统计学</title>
  <meta name="description" content="10 高级回归模型 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="10 高级回归模型 | 生态统计学" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="10 高级回归模型 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 高级回归模型 | 生态统计学" />
  
  <meta name="twitter:description" content="10 高级回归模型 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  

<meta name="author" content="沈国春、李勤" />


<meta name="date" content="2025-10-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="模型选择与评估.html"/>
<link rel="next" href="机器学习.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.11/grViz.js"></script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7cbaf067c715044120ee231397e9ace3";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">生态统计学</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#为什么要学生态统计"><i class="fa fa-check"></i><b>0.1</b> 为什么要学生态统计</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#在不确定的世界中寻找规律"><i class="fa fa-check"></i><b>0.1.1</b> 在不确定的世界中寻找规律</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#ai时代的机遇与陷阱"><i class="fa fa-check"></i><b>0.1.2</b> AI时代的机遇与陷阱</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#本书介绍"><i class="fa fa-check"></i><b>0.2</b> 本书介绍</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#课程在线资源"><i class="fa fa-check"></i><b>0.3</b> 课程在线资源</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#学习方式"><i class="fa fa-check"></i><b>0.4</b> 学习方式</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="统计编程基础.html"><a href="统计编程基础.html"><i class="fa fa-check"></i><b>1</b> 统计编程基础</a>
<ul>
<li class="chapter" data-level="1.1" data-path="统计编程基础.html"><a href="统计编程基础.html#引言"><i class="fa fa-check"></i><b>1.1</b> 引言</a></li>
<li class="chapter" data-level="1.2" data-path="统计编程基础.html"><a href="统计编程基础.html#核心能力培养框架"><i class="fa fa-check"></i><b>1.2</b> 核心能力培养框架</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="统计编程基础.html"><a href="统计编程基础.html#高阶思维与问题解决能力"><i class="fa fa-check"></i><b>1.2.1</b> 高阶思维与问题解决能力</a></li>
<li class="chapter" data-level="1.2.2" data-path="统计编程基础.html"><a href="统计编程基础.html#与llm协同工作的能力"><i class="fa fa-check"></i><b>1.2.2</b> 与LLM协同工作的能力</a></li>
<li class="chapter" data-level="1.2.3" data-path="统计编程基础.html"><a href="统计编程基础.html#传统但愈发重要的软技能"><i class="fa fa-check"></i><b>1.2.3</b> 传统但愈发重要的软技能</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="统计编程基础.html"><a href="统计编程基础.html#通用编程思维基础"><i class="fa fa-check"></i><b>1.3</b> 通用编程思维基础</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="统计编程基础.html"><a href="统计编程基础.html#编程核心概念"><i class="fa fa-check"></i><b>1.3.1</b> 编程核心概念</a></li>
<li class="chapter" data-level="1.3.2" data-path="统计编程基础.html"><a href="统计编程基础.html#算法复杂度"><i class="fa fa-check"></i><b>1.3.2</b> 算法复杂度</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="统计编程基础.html"><a href="统计编程基础.html#ai协同编程技能"><i class="fa fa-check"></i><b>1.4</b> AI协同编程技能</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="统计编程基础.html"><a href="统计编程基础.html#ai编程模块安装"><i class="fa fa-check"></i><b>1.4.1</b> AI编程模块安装</a></li>
<li class="chapter" data-level="1.4.2" data-path="统计编程基础.html"><a href="统计编程基础.html#精准提问技巧"><i class="fa fa-check"></i><b>1.4.2</b> 精准提问技巧</a></li>
<li class="chapter" data-level="1.4.3" data-path="统计编程基础.html"><a href="统计编程基础.html#代码审查能力"><i class="fa fa-check"></i><b>1.4.3</b> 代码审查能力</a></li>
<li class="chapter" data-level="1.4.4" data-path="统计编程基础.html"><a href="统计编程基础.html#调试与错误处理"><i class="fa fa-check"></i><b>1.4.4</b> 调试与错误处理</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="统计编程基础.html"><a href="统计编程基础.html#总结"><i class="fa fa-check"></i><b>1.5</b> 总结</a></li>
<li class="chapter" data-level="1.6" data-path="统计编程基础.html"><a href="统计编程基础.html#综合练习"><i class="fa fa-check"></i><b>1.6</b> 综合练习</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="统计编程基础.html"><a href="统计编程基础.html#练习1"><i class="fa fa-check"></i><b>1.6.1</b> 练习1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="概率与分布.html"><a href="概率与分布.html"><i class="fa fa-check"></i><b>2</b> 概率与分布</a>
<ul>
<li class="chapter" data-level="2.1" data-path="概率与分布.html"><a href="概率与分布.html#引言-1"><i class="fa fa-check"></i><b>2.1</b> 引言</a></li>
<li class="chapter" data-level="2.2" data-path="概率与分布.html"><a href="概率与分布.html#蚂蚱午餐与概率"><i class="fa fa-check"></i><b>2.2</b> 蚂蚱午餐与概率</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="概率与分布.html"><a href="概率与分布.html#一只蚱蜢的午餐"><i class="fa fa-check"></i><b>2.2.1</b> 一只蚱蜢的午餐</a></li>
<li class="chapter" data-level="2.2.2" data-path="概率与分布.html"><a href="概率与分布.html#理想的猜测古典概率"><i class="fa fa-check"></i><b>2.2.2</b> 理想的猜测——古典概率</a></li>
<li class="chapter" data-level="2.2.3" data-path="概率与分布.html"><a href="概率与分布.html#数据的语言频率概率"><i class="fa fa-check"></i><b>2.2.3</b> 数据的语言——频率概率</a></li>
<li class="chapter" data-level="2.2.4" data-path="概率与分布.html"><a href="概率与分布.html#动态的更新贝叶斯概率"><i class="fa fa-check"></i><b>2.2.4</b> 动态的更新——贝叶斯概率</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="概率与分布.html"><a href="概率与分布.html#随机变量与分布"><i class="fa fa-check"></i><b>2.3</b> 随机变量与分布</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="概率与分布.html"><a href="概率与分布.html#概率分布"><i class="fa fa-check"></i><b>2.3.1</b> 概率分布</a></li>
<li class="chapter" data-level="2.3.2" data-path="概率与分布.html"><a href="概率与分布.html#累积概率分布从可能性到确定性"><i class="fa fa-check"></i><b>2.3.2</b> 累积概率分布：从可能性到确定性</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="概率与分布.html"><a href="概率与分布.html#午餐菜单离散随机变量的分布家族"><i class="fa fa-check"></i><b>2.4</b> 午餐菜单：离散随机变量的分布家族</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="概率与分布.html"><a href="概率与分布.html#伯努利分布一个是或否的终极问题"><i class="fa fa-check"></i><b>2.4.1</b> 伯努利分布：一个”是”或”否”的终极问题</a></li>
<li class="chapter" data-level="2.4.2" data-path="概率与分布.html"><a href="概率与分布.html#二项分布重复是非题的计数法则"><i class="fa fa-check"></i><b>2.4.2</b> 二项分布：重复”是非题”的计数法则</a></li>
<li class="chapter" data-level="2.4.3" data-path="概率与分布.html"><a href="概率与分布.html#多项式分布多元选择的全景图"><i class="fa fa-check"></i><b>2.4.3</b> 多项式分布：多元选择的”全景图”</a></li>
<li class="chapter" data-level="2.4.4" data-path="概率与分布.html"><a href="概率与分布.html#泊松分布罕见事件的低语者"><i class="fa fa-check"></i><b>2.4.4</b> 泊松分布：罕见事件的”低语者”</a></li>
<li class="chapter" data-level="2.4.5" data-path="概率与分布.html"><a href="概率与分布.html#几何分布等待第一次成功的耐心"><i class="fa fa-check"></i><b>2.4.5</b> 几何分布：等待”第一次成功”的耐心</a></li>
<li class="chapter" data-level="2.4.6" data-path="概率与分布.html"><a href="概率与分布.html#负二项分布等待最后一次成功的耐心"><i class="fa fa-check"></i><b>2.4.6</b> 负二项分布：等待”最后一次成功”的耐心</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="概率与分布.html"><a href="概率与分布.html#午餐法则连续随机变量的分布家族"><i class="fa fa-check"></i><b>2.5</b> 午餐法则：连续随机变量的分布家族</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="概率与分布.html"><a href="概率与分布.html#均匀分布纯粹的平等"><i class="fa fa-check"></i><b>2.5.1</b> 均匀分布：纯粹的平等</a></li>
<li class="chapter" data-level="2.5.2" data-path="概率与分布.html"><a href="概率与分布.html#指数分布等待的艺术"><i class="fa fa-check"></i><b>2.5.2</b> 指数分布：等待的艺术</a></li>
<li class="chapter" data-level="2.5.3" data-path="概率与分布.html"><a href="概率与分布.html#正态分布高斯分布自然界的钟形法则"><i class="fa fa-check"></i><b>2.5.3</b> 正态分布（高斯分布）：自然界的”钟形”法则</a></li>
<li class="chapter" data-level="2.5.4" data-path="概率与分布.html"><a href="概率与分布.html#威布尔分布生存分析的时间法则"><i class="fa fa-check"></i><b>2.5.4</b> 威布尔分布：生存分析的”时间法则”</a></li>
<li class="chapter" data-level="2.5.5" data-path="概率与分布.html"><a href="概率与分布.html#伽马分布更一般的等待时间模型"><i class="fa fa-check"></i><b>2.5.5</b> 伽马分布：更一般的等待时间模型</a></li>
<li class="chapter" data-level="2.5.6" data-path="概率与分布.html"><a href="概率与分布.html#贝塔分布比例变量的天然选择"><i class="fa fa-check"></i><b>2.5.6</b> 贝塔分布：比例变量的天然选择</a></li>
<li class="chapter" data-level="2.5.7" data-path="概率与分布.html"><a href="概率与分布.html#正态的魔力中心极限定理"><i class="fa fa-check"></i><b>2.5.7</b> 正态的魔力：中心极限定理</a></li>
<li class="chapter" data-level="2.5.8" data-path="概率与分布.html"><a href="概率与分布.html#生态学应用实例"><i class="fa fa-check"></i><b>2.5.8</b> 生态学应用实例</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="概率与分布.html"><a href="概率与分布.html#混合分布处理异质性数据"><i class="fa fa-check"></i><b>2.6</b> 混合分布：处理异质性数据</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="概率与分布.html"><a href="概率与分布.html#零膨胀分布处理零值过多的数据"><i class="fa fa-check"></i><b>2.6.1</b> 零膨胀分布：处理零值过多的数据</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="概率与分布.html"><a href="概率与分布.html#总结-2"><i class="fa fa-check"></i><b>2.7</b> 总结</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="描述统计.html"><a href="描述统计.html"><i class="fa fa-check"></i><b>3</b> 描述统计</a>
<ul>
<li class="chapter" data-level="3.1" data-path="描述统计.html"><a href="描述统计.html#引言-2"><i class="fa fa-check"></i><b>3.1</b> 引言</a></li>
<li class="chapter" data-level="3.2" data-path="描述统计.html"><a href="描述统计.html#描述统计基础"><i class="fa fa-check"></i><b>3.2</b> 描述统计基础</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="描述统计.html"><a href="描述统计.html#中心趋势测量"><i class="fa fa-check"></i><b>3.2.1</b> 中心趋势测量</a></li>
<li class="chapter" data-level="3.2.2" data-path="描述统计.html"><a href="描述统计.html#离散性测量"><i class="fa fa-check"></i><b>3.2.2</b> 离散性测量</a></li>
<li class="chapter" data-level="3.2.3" data-path="描述统计.html"><a href="描述统计.html#分布形状与矩测量"><i class="fa fa-check"></i><b>3.2.3</b> 分布形状与矩测量</a></li>
<li class="chapter" data-level="3.2.4" data-path="描述统计.html"><a href="描述统计.html#统计概念在概率分布图上的可视化"><i class="fa fa-check"></i><b>3.2.4</b> 统计概念在概率分布图上的可视化</a></li>
<li class="chapter" data-level="3.2.5" data-path="描述统计.html"><a href="描述统计.html#标准误的可视化理解"><i class="fa fa-check"></i><b>3.2.5</b> 标准误的可视化理解</a></li>
<li class="chapter" data-level="3.2.6" data-path="描述统计.html"><a href="描述统计.html#不同参数值的分布形状比较"><i class="fa fa-check"></i><b>3.2.6</b> 不同参数值的分布形状比较</a></li>
<li class="chapter" data-level="3.2.7" data-path="描述统计.html"><a href="描述统计.html#生态学意义总结"><i class="fa fa-check"></i><b>3.2.7</b> 生态学意义总结</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="描述统计.html"><a href="描述统计.html#环境异质性描述"><i class="fa fa-check"></i><b>3.3</b> 环境异质性描述</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="描述统计.html"><a href="描述统计.html#环境异质性的概念"><i class="fa fa-check"></i><b>3.3.1</b> 环境异质性的概念</a></li>
<li class="chapter" data-level="3.3.2" data-path="描述统计.html"><a href="描述统计.html#环境异质性的可视化理解"><i class="fa fa-check"></i><b>3.3.2</b> 环境异质性的可视化理解</a></li>
<li class="chapter" data-level="3.3.3" data-path="描述统计.html"><a href="描述统计.html#环境异质性的量化方法"><i class="fa fa-check"></i><b>3.3.3</b> 环境异质性的量化方法</a></li>
<li class="chapter" data-level="3.3.4" data-path="描述统计.html"><a href="描述统计.html#环境异质性的生态学意义"><i class="fa fa-check"></i><b>3.3.4</b> 环境异质性的生态学意义</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="描述统计.html"><a href="描述统计.html#个体特征描述"><i class="fa fa-check"></i><b>3.4</b> 个体特征描述</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="描述统计.html"><a href="描述统计.html#生存函数survival-function"><i class="fa fa-check"></i><b>3.4.1</b> 生存函数（Survival Function）</a></li>
<li class="chapter" data-level="3.4.2" data-path="描述统计.html"><a href="描述统计.html#瞬时死亡风险函数hazard-function"><i class="fa fa-check"></i><b>3.4.2</b> 瞬时死亡风险函数（Hazard Function）</a></li>
<li class="chapter" data-level="3.4.3" data-path="描述统计.html"><a href="描述统计.html#累积风险函数cumulative-hazard-function"><i class="fa fa-check"></i><b>3.4.3</b> 累积风险函数（Cumulative Hazard Function）</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="描述统计.html"><a href="描述统计.html#种群特征描述"><i class="fa fa-check"></i><b>3.5</b> 种群特征描述</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="描述统计.html"><a href="描述统计.html#gini系数"><i class="fa fa-check"></i><b>3.5.1</b> Gini系数</a></li>
<li class="chapter" data-level="3.5.2" data-path="描述统计.html"><a href="描述统计.html#lorenz曲线"><i class="fa fa-check"></i><b>3.5.2</b> Lorenz曲线</a></li>
<li class="chapter" data-level="3.5.3" data-path="描述统计.html"><a href="描述统计.html#基尼系数的生态学应用"><i class="fa fa-check"></i><b>3.5.3</b> 基尼系数的生态学应用</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="描述统计.html"><a href="描述统计.html#群落特征描述"><i class="fa fa-check"></i><b>3.6</b> 群落特征描述</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="描述统计.html"><a href="描述统计.html#物种多样性描述"><i class="fa fa-check"></i><b>3.6.1</b> 物种多样性描述</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="描述统计.html"><a href="描述统计.html#生态网络特征描述"><i class="fa fa-check"></i><b>3.7</b> 生态网络特征描述</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="描述统计.html"><a href="描述统计.html#网络拓扑指标"><i class="fa fa-check"></i><b>3.7.1</b> 网络拓扑指标</a></li>
<li class="chapter" data-level="3.7.2" data-path="描述统计.html"><a href="描述统计.html#食物网特征"><i class="fa fa-check"></i><b>3.7.2</b> 食物网特征</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="描述统计.html"><a href="描述统计.html#稳定性描述"><i class="fa fa-check"></i><b>3.8</b> 稳定性描述</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="描述统计.html"><a href="描述统计.html#抵抗力resistance"><i class="fa fa-check"></i><b>3.8.1</b> 抵抗力（Resistance）</a></li>
<li class="chapter" data-level="3.8.2" data-path="描述统计.html"><a href="描述统计.html#恢复力resilience"><i class="fa fa-check"></i><b>3.8.2</b> 恢复力（Resilience）</a></li>
<li class="chapter" data-level="3.8.3" data-path="描述统计.html"><a href="描述统计.html#持久性persistence"><i class="fa fa-check"></i><b>3.8.3</b> 持久性（Persistence）</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="描述统计.html"><a href="描述统计.html#总结-3"><i class="fa fa-check"></i><b>3.9</b> 总结</a></li>
<li class="chapter" data-level="3.10" data-path="描述统计.html"><a href="描述统计.html#综合练习-1"><i class="fa fa-check"></i><b>3.10</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="参数估计.html"><a href="参数估计.html"><i class="fa fa-check"></i><b>4</b> 参数估计</a>
<ul>
<li class="chapter" data-level="4.1" data-path="参数估计.html"><a href="参数估计.html#引言-3"><i class="fa fa-check"></i><b>4.1</b> 引言</a></li>
<li class="chapter" data-level="4.2" data-path="参数估计.html"><a href="参数估计.html#样本与总体"><i class="fa fa-check"></i><b>4.2</b> 样本与总体</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="参数估计.html"><a href="参数估计.html#抽样方法及其生态学应用"><i class="fa fa-check"></i><b>4.2.1</b> 抽样方法及其生态学应用</a></li>
<li class="chapter" data-level="4.2.2" data-path="参数估计.html"><a href="参数估计.html#r语言中的抽样实现"><i class="fa fa-check"></i><b>4.2.2</b> R语言中的抽样实现</a></li>
<li class="chapter" data-level="4.2.3" data-path="参数估计.html"><a href="参数估计.html#抽样误差与样本量确定"><i class="fa fa-check"></i><b>4.2.3</b> 抽样误差与样本量确定</a></li>
<li class="chapter" data-level="4.2.4" data-path="参数估计.html"><a href="参数估计.html#生态学抽样设计的实践考虑"><i class="fa fa-check"></i><b>4.2.4</b> 生态学抽样设计的实践考虑</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="参数估计.html"><a href="参数估计.html#参数估计基础"><i class="fa fa-check"></i><b>4.3</b> 参数估计基础</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="参数估计.html"><a href="参数估计.html#点估计"><i class="fa fa-check"></i><b>4.3.1</b> 点估计</a></li>
<li class="chapter" data-level="4.3.2" data-path="参数估计.html"><a href="参数估计.html#区间估计"><i class="fa fa-check"></i><b>4.3.2</b> 区间估计</a></li>
<li class="chapter" data-level="4.3.3" data-path="参数估计.html"><a href="参数估计.html#估计方法"><i class="fa fa-check"></i><b>4.3.3</b> 估计方法</a></li>
<li class="chapter" data-level="4.3.4" data-path="参数估计.html"><a href="参数估计.html#估计量性质如何评价一个估计方法的好坏"><i class="fa fa-check"></i><b>4.3.4</b> 估计量性质：如何评价一个估计方法的好坏？</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="参数估计.html"><a href="参数估计.html#种群大小估计"><i class="fa fa-check"></i><b>4.4</b> 种群大小估计</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="参数估计.html"><a href="参数估计.html#标记重捕法"><i class="fa fa-check"></i><b>4.4.1</b> 标记重捕法</a></li>
<li class="chapter" data-level="4.4.2" data-path="参数估计.html"><a href="参数估计.html#面积取样法"><i class="fa fa-check"></i><b>4.4.2</b> 面积取样法</a></li>
<li class="chapter" data-level="4.4.3" data-path="参数估计.html"><a href="参数估计.html#距离抽样法"><i class="fa fa-check"></i><b>4.4.3</b> 距离抽样法</a></li>
<li class="chapter" data-level="4.4.4" data-path="参数估计.html"><a href="参数估计.html#去除法"><i class="fa fa-check"></i><b>4.4.4</b> 去除法</a></li>
<li class="chapter" data-level="4.4.5" data-path="参数估计.html"><a href="参数估计.html#种群大小估计方法的选择与比较"><i class="fa fa-check"></i><b>4.4.5</b> 种群大小估计方法的选择与比较</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="参数估计.html"><a href="参数估计.html#稀有种估计"><i class="fa fa-check"></i><b>4.5</b> 稀有种估计</a></li>
<li class="chapter" data-level="4.6" data-path="参数估计.html"><a href="参数估计.html#物种多样性估计"><i class="fa fa-check"></i><b>4.6</b> 物种多样性估计</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="参数估计.html"><a href="参数估计.html#外推和内插方法"><i class="fa fa-check"></i><b>4.6.1</b> 外推和内插方法</a></li>
<li class="chapter" data-level="4.6.2" data-path="参数估计.html"><a href="参数估计.html#多样性估计的抽样偏差"><i class="fa fa-check"></i><b>4.6.2</b> 多样性估计的抽样偏差</a></li>
<li class="chapter" data-level="4.6.3" data-path="参数估计.html"><a href="参数估计.html#多样性估计方法的选择与比较"><i class="fa fa-check"></i><b>4.6.3</b> 多样性估计方法的选择与比较</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="参数估计.html"><a href="参数估计.html#总结-4"><i class="fa fa-check"></i><b>4.7</b> 总结</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="参数估计.html"><a href="参数估计.html#参数估计的生态学意义与理论基础"><i class="fa fa-check"></i><b>4.7.1</b> 参数估计的生态学意义与理论基础</a></li>
<li class="chapter" data-level="4.7.2" data-path="参数估计.html"><a href="参数估计.html#点估计与区间估计从单一数值到可信范围"><i class="fa fa-check"></i><b>4.7.2</b> 点估计与区间估计：从单一数值到可信范围</a></li>
<li class="chapter" data-level="4.7.3" data-path="参数估计.html"><a href="参数估计.html#主要估计方法及其生态学应用"><i class="fa fa-check"></i><b>4.7.3</b> 主要估计方法及其生态学应用</a></li>
<li class="chapter" data-level="4.7.4" data-path="参数估计.html"><a href="参数估计.html#种群大小估计生态学实践的核心任务"><i class="fa fa-check"></i><b>4.7.4</b> 种群大小估计：生态学实践的核心任务</a></li>
<li class="chapter" data-level="4.7.5" data-path="参数估计.html"><a href="参数估计.html#物种多样性估计群落生态学的量化基础"><i class="fa fa-check"></i><b>4.7.5</b> 物种多样性估计：群落生态学的量化基础</a></li>
<li class="chapter" data-level="4.7.6" data-path="参数估计.html"><a href="参数估计.html#参数估计在生态学决策中的重要性"><i class="fa fa-check"></i><b>4.7.6</b> 参数估计在生态学决策中的重要性</a></li>
<li class="chapter" data-level="4.7.7" data-path="参数估计.html"><a href="参数估计.html#未来发展方向与挑战"><i class="fa fa-check"></i><b>4.7.7</b> 未来发展方向与挑战</a></li>
<li class="chapter" data-level="4.7.8" data-path="参数估计.html"><a href="参数估计.html#结语"><i class="fa fa-check"></i><b>4.7.8</b> 结语</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="参数估计.html"><a href="参数估计.html#综合练习-2"><i class="fa fa-check"></i><b>4.8</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="相关性与相似性.html"><a href="相关性与相似性.html"><i class="fa fa-check"></i><b>5</b> 相关性与相似性</a>
<ul>
<li class="chapter" data-level="5.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#引言-4"><i class="fa fa-check"></i><b>5.1</b> 引言</a></li>
<li class="chapter" data-level="5.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#相关性统计基础"><i class="fa fa-check"></i><b>5.2</b> 相关性统计基础</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#相关分析"><i class="fa fa-check"></i><b>5.2.1</b> 相关分析</a></li>
<li class="chapter" data-level="5.2.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#偏相关分析"><i class="fa fa-check"></i><b>5.2.2</b> 偏相关分析</a></li>
<li class="chapter" data-level="5.2.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#距离相关"><i class="fa fa-check"></i><b>5.2.3</b> 距离相关</a></li>
<li class="chapter" data-level="5.2.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#互信息"><i class="fa fa-check"></i><b>5.2.4</b> 互信息</a></li>
<li class="chapter" data-level="5.2.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#非线性关系度量"><i class="fa fa-check"></i><b>5.2.5</b> 非线性关系度量</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#自相关"><i class="fa fa-check"></i><b>5.3</b> 自相关</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#时间自相关"><i class="fa fa-check"></i><b>5.3.1</b> 时间自相关</a></li>
<li class="chapter" data-level="5.3.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#空间自相关"><i class="fa fa-check"></i><b>5.3.2</b> 空间自相关</a></li>
<li class="chapter" data-level="5.3.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育相关性"><i class="fa fa-check"></i><b>5.3.3</b> 系统发育相关性</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#相似性与距离"><i class="fa fa-check"></i><b>5.4</b> 相似性与距离</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#常用相似性系数"><i class="fa fa-check"></i><b>5.4.1</b> 常用相似性系数</a></li>
<li class="chapter" data-level="5.4.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#功能性状间相关性"><i class="fa fa-check"></i><b>5.4.2</b> 功能性状间相关性</a></li>
<li class="chapter" data-level="5.4.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#种内相关性"><i class="fa fa-check"></i><b>5.4.3</b> 种内相关性</a></li>
<li class="chapter" data-level="5.4.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#种间相关性"><i class="fa fa-check"></i><b>5.4.4</b> 种间相关性</a></li>
<li class="chapter" data-level="5.4.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#群落相似性"><i class="fa fa-check"></i><b>5.4.5</b> 群落相似性</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#总结-5"><i class="fa fa-check"></i><b>5.5</b> 总结</a></li>
<li class="chapter" data-level="5.6" data-path="相关性与相似性.html"><a href="相关性与相似性.html#综合练习-3"><i class="fa fa-check"></i><b>5.6</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html"><i class="fa fa-check"></i><b>6</b> 基于经典分布的假设检验</a>
<ul>
<li class="chapter" data-level="6.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#引言-5"><i class="fa fa-check"></i><b>6.1</b> 引言</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#假设检验基础"><i class="fa fa-check"></i><b>6.1.1</b> 假设检验基础</a></li>
<li class="chapter" data-level="6.1.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#假设检验的基本步骤"><i class="fa fa-check"></i><b>6.1.2</b> 假设检验的基本步骤</a></li>
<li class="chapter" data-level="6.1.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#零假设与备择假设"><i class="fa fa-check"></i><b>6.1.3</b> 零假设与备择假设</a></li>
<li class="chapter" data-level="6.1.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#检验统计量与p值"><i class="fa fa-check"></i><b>6.1.4</b> 检验统计量与p值</a></li>
<li class="chapter" data-level="6.1.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#显著性水平"><i class="fa fa-check"></i><b>6.1.5</b> 显著性水平</a></li>
<li class="chapter" data-level="6.1.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#效应大小与置信区间"><i class="fa fa-check"></i><b>6.1.6</b> 效应大小与置信区间</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本检验"><i class="fa fa-check"></i><b>6.2</b> 单样本检验</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本t检验"><i class="fa fa-check"></i><b>6.2.1</b> 单样本t检验</a></li>
<li class="chapter" data-level="6.2.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本符号检验"><i class="fa fa-check"></i><b>6.2.2</b> 单样本符号检验</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#双样本检验"><i class="fa fa-check"></i><b>6.3</b> 双样本检验</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#独立样本t检验"><i class="fa fa-check"></i><b>6.3.1</b> 独立样本t检验</a></li>
<li class="chapter" data-level="6.3.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#配对样本t检验"><i class="fa fa-check"></i><b>6.3.2</b> 配对样本t检验</a></li>
<li class="chapter" data-level="6.3.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#mann-whitney-u检验"><i class="fa fa-check"></i><b>6.3.3</b> Mann-Whitney U检验</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多样本检验"><i class="fa fa-check"></i><b>6.4</b> 多样本检验</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#方差分析anova"><i class="fa fa-check"></i><b>6.4.1</b> 方差分析（ANOVA）</a></li>
<li class="chapter" data-level="6.4.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#kruskal-wallis检验"><i class="fa fa-check"></i><b>6.4.2</b> Kruskal-Wallis检验</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#非参数检验方法"><i class="fa fa-check"></i><b>6.5</b> 非参数检验方法</a></li>
<li class="chapter" data-level="6.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较校正"><i class="fa fa-check"></i><b>6.6</b> 多重比较校正</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较问题的本质"><i class="fa fa-check"></i><b>6.6.1</b> 多重比较问题的本质</a></li>
<li class="chapter" data-level="6.6.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#bonferroni校正"><i class="fa fa-check"></i><b>6.6.2</b> Bonferroni校正</a></li>
<li class="chapter" data-level="6.6.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#tukey-hsd检验"><i class="fa fa-check"></i><b>6.6.3</b> Tukey HSD检验</a></li>
<li class="chapter" data-level="6.6.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#fdr错误发现率控制"><i class="fa fa-check"></i><b>6.6.4</b> FDR（错误发现率）控制</a></li>
<li class="chapter" data-level="6.6.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#生态学实例森林类型对鸟类多样性的影响"><i class="fa fa-check"></i><b>6.6.5</b> 生态学实例：森林类型对鸟类多样性的影响</a></li>
<li class="chapter" data-level="6.6.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较校正效果的可视化"><i class="fa fa-check"></i><b>6.6.6</b> 多重比较校正效果的可视化</a></li>
<li class="chapter" data-level="6.6.7" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#实用建议与最佳实践"><i class="fa fa-check"></i><b>6.6.7</b> 实用建议与最佳实践</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#功效分析"><i class="fa fa-check"></i><b>6.7</b> 功效分析</a></li>
<li class="chapter" data-level="6.8" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#总结-6"><i class="fa fa-check"></i><b>6.8</b> 总结</a></li>
<li class="chapter" data-level="6.9" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#综合练习-4"><i class="fa fa-check"></i><b>6.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html"><i class="fa fa-check"></i><b>7</b> 基于模拟的假设检验</a>
<ul>
<li class="chapter" data-level="7.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#引言-6"><i class="fa fa-check"></i><b>7.1</b> 引言</a></li>
<li class="chapter" data-level="7.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学层次与演进脉络"><i class="fa fa-check"></i><b>7.2</b> 方法学层次与演进脉络</a></li>
<li class="chapter" data-level="7.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验"><i class="fa fa-check"></i><b>7.3</b> 置换检验</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验的基本原理"><i class="fa fa-check"></i><b>7.3.1</b> 置换检验的基本原理</a></li>
<li class="chapter" data-level="7.3.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验的技术实现过程"><i class="fa fa-check"></i><b>7.3.2</b> 置换检验的技术实现过程</a></li>
<li class="chapter" data-level="7.3.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例"><i class="fa fa-check"></i><b>7.3.3</b> R语言实现示例</a></li>
<li class="chapter" data-level="7.3.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验在生态学中的应用价值与局限"><i class="fa fa-check"></i><b>7.3.4</b> 置换检验在生态学中的应用价值与局限</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验"><i class="fa fa-check"></i><b>7.4</b> 蒙特卡洛检验</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛方法的概念体系"><i class="fa fa-check"></i><b>7.4.1</b> 蒙特卡洛方法的概念体系</a></li>
<li class="chapter" data-level="7.4.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验的基本原理"><i class="fa fa-check"></i><b>7.4.2</b> 蒙特卡洛检验的基本原理</a></li>
<li class="chapter" data-level="7.4.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验的主要类型"><i class="fa fa-check"></i><b>7.4.3</b> 蒙特卡洛检验的主要类型</a></li>
<li class="chapter" data-level="7.4.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例空间分布随机性检验"><i class="fa fa-check"></i><b>7.4.4</b> R语言实现示例：空间分布随机性检验</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法检验"><i class="fa fa-check"></i><b>7.5</b> 自助法检验</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的基本原理"><i class="fa fa-check"></i><b>7.5.1</b> 自助法的基本原理</a></li>
<li class="chapter" data-level="7.5.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的实施步骤"><i class="fa fa-check"></i><b>7.5.2</b> 自助法的实施步骤</a></li>
<li class="chapter" data-level="7.5.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法在生态学中的应用"><i class="fa fa-check"></i><b>7.5.3</b> 自助法在生态学中的应用</a></li>
<li class="chapter" data-level="7.5.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例-1"><i class="fa fa-check"></i><b>7.5.4</b> R语言实现示例</a></li>
<li class="chapter" data-level="7.5.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的优势与局限"><i class="fa fa-check"></i><b>7.5.5</b> 自助法的优势与局限</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#基因型频率检验"><i class="fa fa-check"></i><b>7.6</b> 基因型频率检验</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#hardy-weinberg平衡检验"><i class="fa fa-check"></i><b>7.6.1</b> Hardy-Weinberg平衡检验</a></li>
<li class="chapter" data-level="7.6.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#连锁不平衡检验"><i class="fa fa-check"></i><b>7.6.2</b> 连锁不平衡检验</a></li>
<li class="chapter" data-level="7.6.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与选择建议"><i class="fa fa-check"></i><b>7.6.3</b> 方法学比较与选择建议</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#多样性差异检验"><i class="fa fa-check"></i><b>7.7</b> 多样性差异检验</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#群落多样性比较"><i class="fa fa-check"></i><b>7.7.1</b> 群落多样性比较</a></li>
<li class="chapter" data-level="7.7.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#相似性分析anosim"><i class="fa fa-check"></i><b>7.7.2</b> 相似性分析（ANOSIM）</a></li>
<li class="chapter" data-level="7.7.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与生态学应用建议"><i class="fa fa-check"></i><b>7.7.3</b> 方法学比较与生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#物种空间分布检验"><i class="fa fa-check"></i><b>7.8</b> 物种空间分布检验</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#空间分布模式检验"><i class="fa fa-check"></i><b>7.8.1</b> 空间分布模式检验</a></li>
<li class="chapter" data-level="7.8.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#点过程模型检验"><i class="fa fa-check"></i><b>7.8.2</b> 点过程模型检验</a></li>
<li class="chapter" data-level="7.8.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#空间生态学的统计挑战与解决方案"><i class="fa fa-check"></i><b>7.8.3</b> 空间生态学的统计挑战与解决方案</a></li>
<li class="chapter" data-level="7.8.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学应用与保护意义"><i class="fa fa-check"></i><b>7.8.4</b> 生态学应用与保护意义</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育信号检验"><i class="fa fa-check"></i><b>7.9</b> 系统发育信号检验</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育保守性检验"><i class="fa fa-check"></i><b>7.9.1</b> 系统发育保守性检验</a></li>
<li class="chapter" data-level="7.9.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育独立对比"><i class="fa fa-check"></i><b>7.9.2</b> 系统发育独立对比</a></li>
<li class="chapter" data-level="7.9.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与生态学应用建议-1"><i class="fa fa-check"></i><b>7.9.3</b> 方法学比较与生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学零模型检验"><i class="fa fa-check"></i><b>7.10</b> 生态学零模型检验</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#零模型的基本概念与生态学意义"><i class="fa fa-check"></i><b>7.10.1</b> 零模型的基本概念与生态学意义</a></li>
<li class="chapter" data-level="7.10.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#群落组装零模型检验"><i class="fa fa-check"></i><b>7.10.2</b> 群落组装零模型检验</a></li>
<li class="chapter" data-level="7.10.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态网络零模型检验"><i class="fa fa-check"></i><b>7.10.3</b> 生态网络零模型检验</a></li>
<li class="chapter" data-level="7.10.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#零模型检验的方法学比较与选择"><i class="fa fa-check"></i><b>7.10.4</b> 零模型检验的方法学比较与选择</a></li>
<li class="chapter" data-level="7.10.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学应用与保护意义-1"><i class="fa fa-check"></i><b>7.10.5</b> 生态学应用与保护意义</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#总结-7"><i class="fa fa-check"></i><b>7.11</b> 总结</a></li>
<li class="chapter" data-level="7.12" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#综合练习-5"><i class="fa fa-check"></i><b>7.12</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html"><i class="fa fa-check"></i><b>8</b> 简单线性回归模型</a>
<ul>
<li class="chapter" data-level="8.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#引言-7"><i class="fa fa-check"></i><b>8.1</b> 引言</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#为什么生态学本科生需要学习统计建模与预测"><i class="fa fa-check"></i><b>8.1.1</b> 为什么生态学本科生需要学习统计建模与预测？</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#线性回归模型"><i class="fa fa-check"></i><b>8.2</b> 线性回归模型</a></li>
<li class="chapter" data-level="8.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#最小二乘估计"><i class="fa fa-check"></i><b>8.3</b> 最小二乘估计</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的lm函数详解"><i class="fa fa-check"></i><b>8.3.1</b> R语言中的lm()函数详解</a></li>
<li class="chapter" data-level="8.3.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#lm函数的基本语法"><i class="fa fa-check"></i><b>8.3.2</b> lm()函数的基本语法</a></li>
<li class="chapter" data-level="8.3.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型公式的详细说明"><i class="fa fa-check"></i><b>8.3.3</b> 模型公式的详细说明</a></li>
<li class="chapter" data-level="8.3.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#lm函数的返回对象"><i class="fa fa-check"></i><b>8.3.4</b> lm()函数的返回对象</a></li>
<li class="chapter" data-level="8.3.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#提取回归结果的常用函数"><i class="fa fa-check"></i><b>8.3.5</b> 提取回归结果的常用函数</a></li>
<li class="chapter" data-level="8.3.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#理解summary函数的输出"><i class="fa fa-check"></i><b>8.3.6</b> 理解summary()函数的输出</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#回归诊断"><i class="fa fa-check"></i><b>8.4</b> 回归诊断</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#回归诊断图的系统解读"><i class="fa fa-check"></i><b>8.4.1</b> 回归诊断图的系统解读</a></li>
<li class="chapter" data-level="8.4.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型质量的综合评估"><i class="fa fa-check"></i><b>8.4.2</b> 模型质量的综合评估</a></li>
<li class="chapter" data-level="8.4.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学诊断问题的应对策略"><i class="fa fa-check"></i><b>8.4.3</b> 生态学诊断问题的应对策略</a></li>
<li class="chapter" data-level="8.4.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用实例-1"><i class="fa fa-check"></i><b>8.4.4</b> 生态学应用实例</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归"><i class="fa fa-check"></i><b>8.5</b> 多元线性回归</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归的模型公式"><i class="fa fa-check"></i><b>8.5.1</b> 多元线性回归的模型公式</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归中的变量选择"><i class="fa fa-check"></i><b>8.6</b> 多元线性回归中的变量选择</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择的重要性"><i class="fa fa-check"></i><b>8.6.1</b> 变量选择的重要性</a></li>
<li class="chapter" data-level="8.6.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择的基本原则"><i class="fa fa-check"></i><b>8.6.2</b> 变量选择的基本原则</a></li>
<li class="chapter" data-level="8.6.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#常用的变量选择方法"><i class="fa fa-check"></i><b>8.6.3</b> 常用的变量选择方法</a></li>
<li class="chapter" data-level="8.6.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的模型选择实现"><i class="fa fa-check"></i><b>8.6.4</b> R语言中的模型选择实现</a></li>
<li class="chapter" data-level="8.6.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学变量选择的实践建议"><i class="fa fa-check"></i><b>8.6.5</b> 生态学变量选择的实践建议</a></li>
<li class="chapter" data-level="8.6.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型选择的注意事项"><i class="fa fa-check"></i><b>8.6.6</b> 模型选择的注意事项</a></li>
<li class="chapter" data-level="8.6.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#完整生态学案例分析鸟类丰富度与环境因子的关系"><i class="fa fa-check"></i><b>8.6.7</b> 完整生态学案例分析：鸟类丰富度与环境因子的关系</a></li>
<li class="chapter" data-level="8.6.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#完整模型拟合"><i class="fa fa-check"></i><b>8.6.8</b> 完整模型拟合</a></li>
<li class="chapter" data-level="8.6.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择过程"><i class="fa fa-check"></i><b>8.6.9</b> 变量选择过程</a></li>
<li class="chapter" data-level="8.6.10" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#最优模型选择与结果解释"><i class="fa fa-check"></i><b>8.6.10</b> 最优模型选择与结果解释</a></li>
<li class="chapter" data-level="8.6.11" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型诊断与假设检验"><i class="fa fa-check"></i><b>8.6.11</b> 模型诊断与假设检验</a></li>
<li class="chapter" data-level="8.6.12" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型预测与应用"><i class="fa fa-check"></i><b>8.6.12</b> 模型预测与应用</a></li>
<li class="chapter" data-level="8.6.13" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型比较与评估"><i class="fa fa-check"></i><b>8.6.13</b> 模型比较与评估</a></li>
<li class="chapter" data-level="8.6.14" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学解释与模型选择价值"><i class="fa fa-check"></i><b>8.6.14</b> 生态学解释与模型选择价值</a></li>
<li class="chapter" data-level="8.6.15" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#案例分析总结"><i class="fa fa-check"></i><b>8.6.15</b> 案例分析总结</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归"><i class="fa fa-check"></i><b>8.7</b> 多项式回归</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归模型"><i class="fa fa-check"></i><b>8.7.1</b> 多项式回归模型</a></li>
<li class="chapter" data-level="8.7.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的多项式回归实现"><i class="fa fa-check"></i><b>8.7.2</b> R语言中的多项式回归实现</a></li>
<li class="chapter" data-level="8.7.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用实例-2"><i class="fa fa-check"></i><b>8.7.3</b> 生态学应用实例</a></li>
<li class="chapter" data-level="8.7.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归的生态学意义"><i class="fa fa-check"></i><b>8.7.4</b> 多项式回归的生态学意义</a></li>
<li class="chapter" data-level="8.7.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式阶数的选择"><i class="fa fa-check"></i><b>8.7.5</b> 多项式阶数的选择</a></li>
<li class="chapter" data-level="8.7.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归的注意事项"><i class="fa fa-check"></i><b>8.7.6</b> 多项式回归的注意事项</a></li>
<li class="chapter" data-level="8.7.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#过度拟合问题演示"><i class="fa fa-check"></i><b>8.7.7</b> 过度拟合问题演示</a></li>
<li class="chapter" data-level="8.7.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型可视化与比较"><i class="fa fa-check"></i><b>8.7.8</b> 模型可视化与比较</a></li>
<li class="chapter" data-level="8.7.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#统计指标与交叉验证"><i class="fa fa-check"></i><b>8.7.9</b> 统计指标与交叉验证</a></li>
<li class="chapter" data-level="8.7.10" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用建议"><i class="fa fa-check"></i><b>8.7.10</b> 生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#总结-8"><i class="fa fa-check"></i><b>8.8</b> 总结</a></li>
<li class="chapter" data-level="8.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#综合练习-6"><i class="fa fa-check"></i><b>8.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="模型选择与评估.html"><a href="模型选择与评估.html"><i class="fa fa-check"></i><b>9</b> 模型选择与评估</a>
<ul>
<li class="chapter" data-level="9.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#引言-8"><i class="fa fa-check"></i><b>9.1</b> 引言</a></li>
<li class="chapter" data-level="9.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型选择"><i class="fa fa-check"></i><b>9.2</b> 模型选择</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型选择原则"><i class="fa fa-check"></i><b>9.2.1</b> 模型选择原则</a></li>
<li class="chapter" data-level="9.2.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#信息准则"><i class="fa fa-check"></i><b>9.2.2</b> 信息准则</a></li>
<li class="chapter" data-level="9.2.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#似然比检验"><i class="fa fa-check"></i><b>9.2.3</b> 似然比检验</a></li>
<li class="chapter" data-level="9.2.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型平均"><i class="fa fa-check"></i><b>9.2.4</b> 模型平均</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型评估"><i class="fa fa-check"></i><b>9.3</b> 模型评估</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#交叉验证"><i class="fa fa-check"></i><b>9.3.1</b> 交叉验证</a></li>
<li class="chapter" data-level="9.3.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#外部验证"><i class="fa fa-check"></i><b>9.3.2</b> 外部验证</a></li>
<li class="chapter" data-level="9.3.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型诊断"><i class="fa fa-check"></i><b>9.3.3</b> 模型诊断</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型选择与评估"><i class="fa fa-check"></i><b>9.4</b> 贝叶斯模型选择与评估</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯与频率学派的根本差异"><i class="fa fa-check"></i><b>9.4.1</b> 贝叶斯与频率学派的根本差异</a></li>
<li class="chapter" data-level="9.4.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型选择基本原理"><i class="fa fa-check"></i><b>9.4.2</b> 贝叶斯模型选择基本原理</a></li>
<li class="chapter" data-level="9.4.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯假设检验流程"><i class="fa fa-check"></i><b>9.4.3</b> 贝叶斯假设检验流程</a></li>
<li class="chapter" data-level="9.4.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型比较与选择"><i class="fa fa-check"></i><b>9.4.4</b> 贝叶斯模型比较与选择</a></li>
<li class="chapter" data-level="9.4.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯可信区间"><i class="fa fa-check"></i><b>9.4.5</b> 贝叶斯可信区间</a></li>
<li class="chapter" data-level="9.4.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯因子计算与解释"><i class="fa fa-check"></i><b>9.4.6</b> 贝叶斯因子计算与解释</a></li>
<li class="chapter" data-level="9.4.7" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型平均"><i class="fa fa-check"></i><b>9.4.7</b> 贝叶斯模型平均</a></li>
<li class="chapter" data-level="9.4.8" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯预测评估"><i class="fa fa-check"></i><b>9.4.8</b> 贝叶斯预测评估</a></li>
<li class="chapter" data-level="9.4.9" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯变量选择"><i class="fa fa-check"></i><b>9.4.9</b> 贝叶斯变量选择</a></li>
<li class="chapter" data-level="9.4.10" data-path="模型选择与评估.html"><a href="模型选择与评估.html#生态学应用价值"><i class="fa fa-check"></i><b>9.4.10</b> 生态学应用价值</a></li>
<li class="chapter" data-level="9.4.11" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯检验的生态学应用案例"><i class="fa fa-check"></i><b>9.4.11</b> 贝叶斯检验的生态学应用案例</a></li>
<li class="chapter" data-level="9.4.12" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯方法的局限性"><i class="fa fa-check"></i><b>9.4.12</b> 贝叶斯方法的局限性</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#总结-9"><i class="fa fa-check"></i><b>9.5</b> 总结</a></li>
<li class="chapter" data-level="9.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#综合练习-7"><i class="fa fa-check"></i><b>9.6</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="高级回归模型.html"><a href="高级回归模型.html"><i class="fa fa-check"></i><b>10</b> 高级回归模型</a>
<ul>
<li class="chapter" data-level="10.1" data-path="高级回归模型.html"><a href="高级回归模型.html#引言-9"><i class="fa fa-check"></i><b>10.1</b> 引言</a></li>
<li class="chapter" data-level="10.2" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型"><i class="fa fa-check"></i><b>10.2</b> 可加性模型</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型的基本原理"><i class="fa fa-check"></i><b>10.2.1</b> 可加性模型的基本原理</a></li>
<li class="chapter" data-level="10.2.2" data-path="高级回归模型.html"><a href="高级回归模型.html#与线性模型的比较"><i class="fa fa-check"></i><b>10.2.2</b> 与线性模型的比较</a></li>
<li class="chapter" data-level="10.2.3" data-path="高级回归模型.html"><a href="高级回归模型.html#常见的平滑函数"><i class="fa fa-check"></i><b>10.2.3</b> 常见的平滑函数</a></li>
<li class="chapter" data-level="10.2.4" data-path="高级回归模型.html"><a href="高级回归模型.html#平滑函数选择的生态学考量"><i class="fa fa-check"></i><b>10.2.4</b> 平滑函数选择的生态学考量</a></li>
<li class="chapter" data-level="10.2.5" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型中的系数概念"><i class="fa fa-check"></i><b>10.2.5</b> 可加性模型中的”系数”概念</a></li>
<li class="chapter" data-level="10.2.6" data-path="高级回归模型.html"><a href="高级回归模型.html#在r中的实现"><i class="fa fa-check"></i><b>10.2.6</b> 在R中的实现</a></li>
<li class="chapter" data-level="10.2.7" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学应用示例"><i class="fa fa-check"></i><b>10.2.7</b> 生态学应用示例</a></li>
<li class="chapter" data-level="10.2.8" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型诊断"><i class="fa fa-check"></i><b>10.2.8</b> 可加性模型诊断</a></li>
<li class="chapter" data-level="10.2.9" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型的优势与局限"><i class="fa fa-check"></i><b>10.2.9</b> 可加性模型的优势与局限</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="高级回归模型.html"><a href="高级回归模型.html#广义线性回归"><i class="fa fa-check"></i><b>10.3</b> 广义线性回归</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="高级回归模型.html"><a href="高级回归模型.html#广义线性模型的基本框架"><i class="fa fa-check"></i><b>10.3.1</b> 广义线性模型的基本框架</a></li>
<li class="chapter" data-level="10.3.2" data-path="高级回归模型.html"><a href="高级回归模型.html#与普通线性回归的根本区别"><i class="fa fa-check"></i><b>10.3.2</b> 与普通线性回归的根本区别</a></li>
<li class="chapter" data-level="10.3.3" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的glm实现"><i class="fa fa-check"></i><b>10.3.3</b> R语言中的GLM实现</a></li>
<li class="chapter" data-level="10.3.4" data-path="高级回归模型.html"><a href="高级回归模型.html#常见glm类型及其生态学应用"><i class="fa fa-check"></i><b>10.3.4</b> 常见GLM类型及其生态学应用</a></li>
<li class="chapter" data-level="10.3.5" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与解释"><i class="fa fa-check"></i><b>10.3.5</b> 模型诊断与解释</a></li>
<li class="chapter" data-level="10.3.6" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学意义与注意事项"><i class="fa fa-check"></i><b>10.3.6</b> 生态学意义与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="高级回归模型.html"><a href="高级回归模型.html#广义可加模型"><i class="fa fa-check"></i><b>10.4</b> 广义可加模型</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="高级回归模型.html"><a href="高级回归模型.html#gam的基本原理"><i class="fa fa-check"></i><b>10.4.1</b> GAM的基本原理</a></li>
<li class="chapter" data-level="10.4.2" data-path="高级回归模型.html"><a href="高级回归模型.html#在r中的实现-1"><i class="fa fa-check"></i><b>10.4.2</b> 在R中的实现</a></li>
<li class="chapter" data-level="10.4.3" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学应用示例-1"><i class="fa fa-check"></i><b>10.4.3</b> 生态学应用示例</a></li>
<li class="chapter" data-level="10.4.4" data-path="高级回归模型.html"><a href="高级回归模型.html#gam在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.4.4</b> GAM在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.4.5" data-path="高级回归模型.html"><a href="高级回归模型.html#高级功能"><i class="fa fa-check"></i><b>10.4.5</b> 高级功能</a></li>
<li class="chapter" data-level="10.4.6" data-path="高级回归模型.html"><a href="高级回归模型.html#模型选择与诊断"><i class="fa fa-check"></i><b>10.4.6</b> 模型选择与诊断</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型"><i class="fa fa-check"></i><b>10.5</b> 混合效应模型</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="高级回归模型.html"><a href="高级回归模型.html#固定效应与随机效应的生态学概念"><i class="fa fa-check"></i><b>10.5.1</b> 固定效应与随机效应的生态学概念</a></li>
<li class="chapter" data-level="10.5.2" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型的数学框架"><i class="fa fa-check"></i><b>10.5.2</b> 混合效应模型的数学框架</a></li>
<li class="chapter" data-level="10.5.3" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的混合效应模型实现"><i class="fa fa-check"></i><b>10.5.3</b> R语言中的混合效应模型实现</a></li>
<li class="chapter" data-level="10.5.4" data-path="高级回归模型.html"><a href="高级回归模型.html#固定效应和随机效应的筛选"><i class="fa fa-check"></i><b>10.5.4</b> 固定效应和随机效应的筛选</a></li>
<li class="chapter" data-level="10.5.5" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.5.5</b> 混合效应模型在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.5.6" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项"><i class="fa fa-check"></i><b>10.5.6</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型"><i class="fa fa-check"></i><b>10.6</b> 时空自相关模型</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型与混合效应模型的联系与区别"><i class="fa fa-check"></i><b>10.6.1</b> 时空自相关模型与混合效应模型的联系与区别</a></li>
<li class="chapter" data-level="10.6.2" data-path="高级回归模型.html"><a href="高级回归模型.html#空间自相关与时间自相关的生态学概念"><i class="fa fa-check"></i><b>10.6.2</b> 空间自相关与时间自相关的生态学概念</a></li>
<li class="chapter" data-level="10.6.3" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型的数学框架"><i class="fa fa-check"></i><b>10.6.3</b> 时空自相关模型的数学框架</a></li>
<li class="chapter" data-level="10.6.4" data-path="高级回归模型.html"><a href="高级回归模型.html#时空模型框架的联系与区别"><i class="fa fa-check"></i><b>10.6.4</b> 时空模型框架的联系与区别</a></li>
<li class="chapter" data-level="10.6.5" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的时空自相关模型实现"><i class="fa fa-check"></i><b>10.6.5</b> R语言中的时空自相关模型实现</a></li>
<li class="chapter" data-level="10.6.6" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型的生态学应用"><i class="fa fa-check"></i><b>10.6.6</b> 时空自相关模型的生态学应用</a></li>
<li class="chapter" data-level="10.6.7" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项-1"><i class="fa fa-check"></i><b>10.6.7</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型"><i class="fa fa-check"></i><b>10.7</b> 结构方程模型</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型的基本框架"><i class="fa fa-check"></i><b>10.7.1</b> 结构方程模型的基本框架</a></li>
<li class="chapter" data-level="10.7.2" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的结构方程模型实现"><i class="fa fa-check"></i><b>10.7.2</b> R语言中的结构方程模型实现</a></li>
<li class="chapter" data-level="10.7.3" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.7.3</b> 结构方程模型在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.7.4" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项-2"><i class="fa fa-check"></i><b>10.7.4</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="高级回归模型.html"><a href="高级回归模型.html#总结-10"><i class="fa fa-check"></i><b>10.8</b> 总结</a></li>
<li class="chapter" data-level="10.9" data-path="高级回归模型.html"><a href="高级回归模型.html#综合练习-8"><i class="fa fa-check"></i><b>10.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="机器学习.html"><a href="机器学习.html"><i class="fa fa-check"></i><b>11</b> 机器学习</a>
<ul>
<li class="chapter" data-level="11.1" data-path="机器学习.html"><a href="机器学习.html#引言-10"><i class="fa fa-check"></i><b>11.1</b> 引言</a></li>
<li class="chapter" data-level="11.2" data-path="机器学习.html"><a href="机器学习.html#决策树"><i class="fa fa-check"></i><b>11.2</b> 决策树</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与原理"><i class="fa fa-check"></i><b>11.2.1</b> 基本概念与原理</a></li>
<li class="chapter" data-level="11.2.2" data-path="机器学习.html"><a href="机器学习.html#决策树构建原理"><i class="fa fa-check"></i><b>11.2.2</b> 决策树构建原理</a></li>
<li class="chapter" data-level="11.2.3" data-path="机器学习.html"><a href="机器学习.html#分类树classification-trees"><i class="fa fa-check"></i><b>11.2.3</b> 分类树（Classification Trees）</a></li>
<li class="chapter" data-level="11.2.4" data-path="机器学习.html"><a href="机器学习.html#回归树regression-trees"><i class="fa fa-check"></i><b>11.2.4</b> 回归树（Regression Trees）</a></li>
<li class="chapter" data-level="11.2.5" data-path="机器学习.html"><a href="机器学习.html#分类树与回归树的比较"><i class="fa fa-check"></i><b>11.2.5</b> 分类树与回归树的比较</a></li>
<li class="chapter" data-level="11.2.6" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-3"><i class="fa fa-check"></i><b>11.2.6</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.2.7" data-path="机器学习.html"><a href="机器学习.html#优势与局限"><i class="fa fa-check"></i><b>11.2.7</b> 优势与局限</a></li>
<li class="chapter" data-level="11.2.8" data-path="机器学习.html"><a href="机器学习.html#r代码实现示例"><i class="fa fa-check"></i><b>11.2.8</b> R代码实现示例</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="机器学习.html"><a href="机器学习.html#随机森林"><i class="fa fa-check"></i><b>11.3</b> 随机森林</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="机器学习.html"><a href="机器学习.html#决策树与随机森林的关系"><i class="fa fa-check"></i><b>11.3.1</b> 决策树与随机森林的关系</a></li>
<li class="chapter" data-level="11.3.2" data-path="机器学习.html"><a href="机器学习.html#随机森林的三个随机"><i class="fa fa-check"></i><b>11.3.2</b> 随机森林的三个随机</a></li>
<li class="chapter" data-level="11.3.3" data-path="机器学习.html"><a href="机器学习.html#数学定义与原理"><i class="fa fa-check"></i><b>11.3.3</b> 数学定义与原理</a></li>
<li class="chapter" data-level="11.3.4" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理"><i class="fa fa-check"></i><b>11.3.4</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.3.5" data-path="机器学习.html"><a href="机器学习.html#r代码实现"><i class="fa fa-check"></i><b>11.3.5</b> R代码实现</a></li>
<li class="chapter" data-level="11.3.6" data-path="机器学习.html"><a href="机器学习.html#代码详细说明"><i class="fa fa-check"></i><b>11.3.6</b> 代码详细说明</a></li>
<li class="chapter" data-level="11.3.7" data-path="机器学习.html"><a href="机器学习.html#模型评估与验证"><i class="fa fa-check"></i><b>11.3.7</b> 模型评估与验证</a></li>
<li class="chapter" data-level="11.3.8" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-4"><i class="fa fa-check"></i><b>11.3.8</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.3.9" data-path="机器学习.html"><a href="机器学习.html#生态学应用价值-1"><i class="fa fa-check"></i><b>11.3.9</b> 生态学应用价值</a></li>
<li class="chapter" data-level="11.3.10" data-path="机器学习.html"><a href="机器学习.html#优势与局限的深入分析"><i class="fa fa-check"></i><b>11.3.10</b> 优势与局限的深入分析</a></li>
<li class="chapter" data-level="11.3.11" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望"><i class="fa fa-check"></i><b>11.3.11</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="机器学习.html"><a href="机器学习.html#支持向量机"><i class="fa fa-check"></i><b>11.4</b> 支持向量机</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与几何直觉"><i class="fa fa-check"></i><b>11.4.1</b> 基本概念与几何直觉</a></li>
<li class="chapter" data-level="11.4.2" data-path="机器学习.html"><a href="机器学习.html#数学原理与核心概念"><i class="fa fa-check"></i><b>11.4.2</b> 数学原理与核心概念</a></li>
<li class="chapter" data-level="11.4.3" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理-1"><i class="fa fa-check"></i><b>11.4.3</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.4.4" data-path="机器学习.html"><a href="机器学习.html#r代码实现-1"><i class="fa fa-check"></i><b>11.4.4</b> R代码实现</a></li>
<li class="chapter" data-level="11.4.5" data-path="机器学习.html"><a href="机器学习.html#代码详细说明-1"><i class="fa fa-check"></i><b>11.4.5</b> 代码详细说明</a></li>
<li class="chapter" data-level="11.4.6" data-path="机器学习.html"><a href="机器学习.html#模型评估与验证-1"><i class="fa fa-check"></i><b>11.4.6</b> 模型评估与验证</a></li>
<li class="chapter" data-level="11.4.7" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-5"><i class="fa fa-check"></i><b>11.4.7</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.4.8" data-path="机器学习.html"><a href="机器学习.html#优势与局限-1"><i class="fa fa-check"></i><b>11.4.8</b> 优势与局限</a></li>
<li class="chapter" data-level="11.4.9" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望-1"><i class="fa fa-check"></i><b>11.4.9</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="机器学习.html"><a href="机器学习.html#深度神经网络"><i class="fa fa-check"></i><b>11.5</b> 深度神经网络</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与生物学启发"><i class="fa fa-check"></i><b>11.5.1</b> 基本概念与生物学启发</a></li>
<li class="chapter" data-level="11.5.2" data-path="机器学习.html"><a href="机器学习.html#主要神经网络架构"><i class="fa fa-check"></i><b>11.5.2</b> 主要神经网络架构</a></li>
<li class="chapter" data-level="11.5.3" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理-2"><i class="fa fa-check"></i><b>11.5.3</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.5.4" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-6"><i class="fa fa-check"></i><b>11.5.4</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.5.5" data-path="机器学习.html"><a href="机器学习.html#优势与局限-2"><i class="fa fa-check"></i><b>11.5.5</b> 优势与局限</a></li>
<li class="chapter" data-level="11.5.6" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望-2"><i class="fa fa-check"></i><b>11.5.6</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="机器学习.html"><a href="机器学习.html#总结-11"><i class="fa fa-check"></i><b>11.6</b> 总结</a></li>
<li class="chapter" data-level="11.7" data-path="机器学习.html"><a href="机器学习.html#综合练习-9"><i class="fa fa-check"></i><b>11.7</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html"><i class="fa fa-check"></i><b>12</b> 附录1 R语言编程基础</a>
<ul>
<li class="chapter" data-level="12.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言介绍"><i class="fa fa-check"></i><b>12.1</b> R语言介绍</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#为什么生态学专业需要学习r"><i class="fa fa-check"></i><b>12.1.1</b> 为什么生态学专业需要学习R？</a></li>
<li class="chapter" data-level="12.1.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言简介与趣味应用"><i class="fa fa-check"></i><b>12.1.2</b> R语言简介与趣味应用</a></li>
<li class="chapter" data-level="12.1.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#环境设置和配置"><i class="fa fa-check"></i><b>12.1.3</b> 环境设置和配置</a></li>
<li class="chapter" data-level="12.1.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#项目文件夹结构设置"><i class="fa fa-check"></i><b>12.1.4</b> 项目文件夹结构设置</a></li>
<li class="chapter" data-level="12.1.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#基本包管理"><i class="fa fa-check"></i><b>12.1.5</b> 基本包管理</a></li>
<li class="chapter" data-level="12.1.6" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#工作目录设置"><i class="fa fa-check"></i><b>12.1.6</b> 工作目录设置</a></li>
<li class="chapter" data-level="12.1.7" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课前准备检查清单"><i class="fa fa-check"></i><b>12.1.7</b> 课前准备检查清单</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#数值向量创建与基本统计计算"><i class="fa fa-check"></i><b>12.2</b> 数值向量创建与基本统计计算</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景"><i class="fa fa-check"></i><b>12.2.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.2.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据"><i class="fa fa-check"></i><b>12.2.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.2.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程"><i class="fa fa-check"></i><b>12.2.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.2.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解"><i class="fa fa-check"></i><b>12.2.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.2.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习"><i class="fa fa-check"></i><b>12.2.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#字符型数据处理与向量索引操作"><i class="fa fa-check"></i><b>12.3</b> 字符型数据处理与向量索引操作</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-1"><i class="fa fa-check"></i><b>12.3.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.3.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-1"><i class="fa fa-check"></i><b>12.3.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.3.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-1"><i class="fa fa-check"></i><b>12.3.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.3.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-1"><i class="fa fa-check"></i><b>12.3.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.3.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-1"><i class="fa fa-check"></i><b>12.3.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#数据框结构理解与多类型数据管理"><i class="fa fa-check"></i><b>12.4</b> 数据框结构理解与多类型数据管理</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-2"><i class="fa fa-check"></i><b>12.4.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.4.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-2"><i class="fa fa-check"></i><b>12.4.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.4.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-2"><i class="fa fa-check"></i><b>12.4.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.4.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-2"><i class="fa fa-check"></i><b>12.4.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.4.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-2"><i class="fa fa-check"></i><b>12.4.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#列表数据结构与数据分组管理"><i class="fa fa-check"></i><b>12.5</b> 列表数据结构与数据分组管理</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-3"><i class="fa fa-check"></i><b>12.5.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.5.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-3"><i class="fa fa-check"></i><b>12.5.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.5.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-3"><i class="fa fa-check"></i><b>12.5.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.5.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-3"><i class="fa fa-check"></i><b>12.5.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.5.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-3"><i class="fa fa-check"></i><b>12.5.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#外部数据导入与条件筛选分析"><i class="fa fa-check"></i><b>12.6</b> 外部数据导入与条件筛选分析</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-4"><i class="fa fa-check"></i><b>12.6.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.6.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据文件bird_monitoring.csv"><i class="fa fa-check"></i><b>12.6.2</b> 演示数据文件（bird_monitoring.csv）</a></li>
<li class="chapter" data-level="12.6.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-4"><i class="fa fa-check"></i><b>12.6.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.6.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-4"><i class="fa fa-check"></i><b>12.6.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.6.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-4"><i class="fa fa-check"></i><b>12.6.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#缺失值和异常值的识别处理"><i class="fa fa-check"></i><b>12.7</b> 缺失值和异常值的识别处理</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-5"><i class="fa fa-check"></i><b>12.7.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.7.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-4"><i class="fa fa-check"></i><b>12.7.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.7.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-5"><i class="fa fa-check"></i><b>12.7.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.7.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-5"><i class="fa fa-check"></i><b>12.7.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.7.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-5"><i class="fa fa-check"></i><b>12.7.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#描述性统计分析与基础数据可视化"><i class="fa fa-check"></i><b>12.8</b> 描述性统计分析与基础数据可视化</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-6"><i class="fa fa-check"></i><b>12.8.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.8.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-5"><i class="fa fa-check"></i><b>12.8.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.8.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-6"><i class="fa fa-check"></i><b>12.8.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.8.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-6"><i class="fa fa-check"></i><b>12.8.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.8.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-6"><i class="fa fa-check"></i><b>12.8.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#条件判断循环结构与函数编程"><i class="fa fa-check"></i><b>12.9</b> 条件判断、循环结构与函数编程</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-7"><i class="fa fa-check"></i><b>12.9.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.9.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-6"><i class="fa fa-check"></i><b>12.9.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.9.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-7"><i class="fa fa-check"></i><b>12.9.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.9.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-7"><i class="fa fa-check"></i><b>12.9.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.9.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-7"><i class="fa fa-check"></i><b>12.9.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#现代数据科学工具包应用"><i class="fa fa-check"></i><b>12.10</b> 现代数据科学工具包应用</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-8"><i class="fa fa-check"></i><b>12.10.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.10.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-7"><i class="fa fa-check"></i><b>12.10.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.10.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-8"><i class="fa fa-check"></i><b>12.10.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.10.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-8"><i class="fa fa-check"></i><b>12.10.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.10.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-8"><i class="fa fa-check"></i><b>12.10.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#图形语法与科学绘图"><i class="fa fa-check"></i><b>12.11</b> 图形语法与科学绘图</a>
<ul>
<li class="chapter" data-level="12.11.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-9"><i class="fa fa-check"></i><b>12.11.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.11.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-8"><i class="fa fa-check"></i><b>12.11.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.11.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-9"><i class="fa fa-check"></i><b>12.11.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.11.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-9"><i class="fa fa-check"></i><b>12.11.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.11.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-9"><i class="fa fa-check"></i><b>12.11.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.12" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#综合练习-10"><i class="fa fa-check"></i><b>12.12</b> 综合练习</a>
<ul>
<li class="chapter" data-level="12.12.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习1-1"><i class="fa fa-check"></i><b>12.12.1</b> 练习1</a></li>
<li class="chapter" data-level="12.12.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习2"><i class="fa fa-check"></i><b>12.12.2</b> 练习2</a></li>
<li class="chapter" data-level="12.12.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习3"><i class="fa fa-check"></i><b>12.12.3</b> 练习3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://gitee.com/gcshen/ecological-statistics" target="blank">Gitee</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">生态统计学</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="高级回归模型" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">10</span> 高级回归模型<a href="高级回归模型.html#高级回归模型" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="引言-9" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> 引言<a href="高级回归模型.html#引言-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在生态学研究的实践中，我们经常面临一个根本性的矛盾：生态系统的复杂性与我们统计工具的简化假设之间的不匹配。传统的线性回归模型建立在一系列严格的假设之上——线性关系、正态分布、方差齐性、观测独立性——这些假设在真实的生态系统中往往难以满足。当我们试图用这些简化模型来描述复杂的生态现象时，就如同用直尺去测量蜿蜒的河流，虽然能够得到一些近似的结果，却无法捕捉到生态过程的真实本质。</p>
<p>考虑一个典型的生态学问题：研究温度对植物物候的影响。简单的线性回归可能会假设温度每升高1℃，植物开花时间就提前固定天数。然而，生态生理学告诉我们，温度对植物发育的影响通常遵循S形曲线：在低温阈值以下，温度变化几乎没有影响；在适宜温度范围内，影响最为显著；而在高温胁迫下，影响可能再次减弱甚至逆转。这种非线性关系在生态学中无处不在，从物种-面积关系通常遵循的幂函数形式，到捕食者-猎物动态表现出的Holling类型功能响应曲线，再到资源利用效率呈现的饱和曲线模式，以及物种丰度沿环境梯度通常呈现的单峰分布。广义可加模型（GAM）正是为了解决这类问题而发展起来的，它通过使用平滑函数而非固定的参数形式，能够灵活地捕捉数据中潜在的非线性模式，而无需预先指定具体的函数形式。这在生态学中具有特殊价值，因为我们往往对生态过程的数学形式缺乏先验知识。</p>
<p>生态学数据常常违背正态分布的假设，这是另一个重要的挑战。计数数据如物种个体数、捕获次数通常服从泊松分布或负二项分布；比例数据如存活率、出现频率通常服从二项分布；而连续但偏态的数据如生物量、浓度可能服从伽马分布。强行对这些数据进行线性回归分析会导致预测值超出合理范围，比如线性模型可能预测负数的个体数或大于1的比例；还会导致方差结构错误，因为计数数据的方差通常与均值相关，而非恒定；更重要的是，统计推断会变得不可靠，p值和置信区间可能严重偏差。广义线性模型（GLM）通过引入连接函数和特定的方差函数，为处理这些非正态分布数据提供了系统的框架。连接函数将响应变量的期望值映射到线性预测器上，确保预测值落在合理的范围内；而方差函数则正确地描述了数据的变异性结构。</p>
<p>生态数据往往具有复杂的层次结构，这是生态学研究中的另一个显著特征。例如，在研究森林动态时，我们可能在多个样地中设置多个样方，在多个年份重复观测。这种数据结构产生了多重相关性：空间自相关使得相邻样方的观测值往往相似；时间自相关使得同一地点的连续观测值相互依赖；组内相关使得同一群组内的个体共享某些未观测特征。忽视这些相关性会导致”伪重复”问题，严重低估标准误，从而产生过于乐观的统计显著性。混合效应模型通过区分固定效应和随机效应，能够正确处理这种层次结构数据。固定效应描述总体水平的模式，而随机效应则捕捉组间变异和组内相关性。</p>
<p>生态系统中变量之间的关系往往构成复杂的因果网络，这是传统统计方法难以处理的另一个层面。例如，气候变暖可能直接影响物种分布，同时也通过改变竞争关系、捕食压力、资源可用性等多个途径产生间接影响。传统的回归分析只能检验变量间的直接关系，而无法揭示这种复杂的因果机制。结构方程模型（SEM）提供了一个整合测量模型和结构模型的框架，使我们能够检验复杂的因果假设。测量模型描述潜变量与观测指标之间的关系，而结构模型则描述潜变量之间的因果关系。这在生态学中特别有用，因为许多重要的生态概念如生态系统健康、生物多样性都是无法直接观测的潜变量。</p>
<p>生态过程本质上是时空过程，物种分布、种群动态、生态系统功能都在空间和时间维度上展现出复杂的模式。传统的统计方法往往忽视这种时空依赖性，导致空间伪相关，即错误地将空间格局当作因果关系；预测精度降低，因为忽视空间自相关的预测模型通常表现较差；以及对生态过程的误解，无法捕捉生态过程的扩散、迁移等空间动态。时空自相关模型通过引入空间权重矩阵和时间自回归项，能够正确地建模生态数据的时空依赖性，这对于物种分布模型、环境预测、保护规划等应用至关重要。</p>
<p>这些高级回归模型不仅仅是对传统方法的简单扩展，它们代表了生态统计学思维方式的根本转变：从确定性到概率性，承认生态过程的内在随机性和不确定性；从简化到复杂，接受生态系统的多层次、非线性本质；从相关到因果，致力于理解生态机制而非仅仅描述模式；从静态到动态，考虑生态过程的时空维度。在具体的生态学研究中，这些模型的应用价值体现在多个方面：在保护生物学中，混合效应模型可以帮助我们区分保护措施的真实效果与地点特异性变异，为保护决策提供更可靠的依据；在气候变化研究中，广义可加模型能够捕捉物种对气候因子的非线性响应，提高物种分布预测的准确性；在生态系统管理中，结构方程模型可以帮助理解管理措施通过哪些途径影响生态系统功能，为管理策略优化提供洞见；在生物多样性监测中，时空模型能够正确估计监测数据的时空自相关，提高趋势检测的统计功效。</p>
<p>在本章中，我们将系统地学习这些高级回归模型的理论基础、实现方法和生态学应用。通过学习，你将能够理解每种模型的基本原理和适用条件，掌握在R等统计软件中实现这些模型的技术，学会如何解释和验证复杂模型的输出结果，具备将高级统计方法应用于实际生态学问题的能力，并培养批判性思维，能够评估不同模型的优缺点和适用性。这些技能将使你能够在日益复杂和数据集越来越大的生态学研究中保持竞争力，为理解和管理我们复杂的生态系统提供更强大的分析工具。正如生态学家Robert MacArthur所言：“为了发现，你必须寻找模式，但为了理解，你必须理解机制。”这些高级回归模型正是我们理解生态机制、而不仅仅是描述生态模式的重要工具。</p>
</div>
<div id="可加性模型" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> 可加性模型<a href="高级回归模型.html#可加性模型" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在生态学研究中，我们经常面临一个基本问题：如何用统计模型来描述复杂的生态关系？传统的线性回归模型假设变量间存在直线关系，这在很多生态学场景中显得过于简化。例如，在研究温度对植物物候的影响时，植物对温度的反应通常呈现S形曲线：在低温阈值以下影响微弱，在适宜温度范围内影响显著，而在高温胁迫下影响可能减弱。类似地，物种丰富度随环境梯度的变化通常呈现单峰分布，资源利用效率随资源可用性增加而呈现饱和曲线。这些复杂的非线性模式在生态系统中普遍存在，而可加性模型正是为捕捉这些复杂关系而设计的强大工具。</p>
<div id="可加性模型的基本原理" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> 可加性模型的基本原理<a href="高级回归模型.html#可加性模型的基本原理" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>可加性模型的基本数学形式为：</p>
<p><span class="math display">\[y = \beta_0 + f_1(x_1) + f_2(x_2) + \cdots + f_p(x_p) + \varepsilon\]</span></p>
<p>其中<span class="math inline">\(\beta_0\)</span>是截距项，<span class="math inline">\(f_j(x_j)\)</span>是每个预测变量的平滑函数，<span class="math inline">\(\varepsilon\)</span>是误差项。与传统的线性模型不同，可加性模型不预设具体的函数形式，而是通过非参数平滑函数让数据本身决定变量间的关系形态。</p>
</div>
<div id="与线性模型的比较" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> 与线性模型的比较<a href="高级回归模型.html#与线性模型的比较" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>可加性模型与线性模型在多个方面存在根本性的区别，这些区别决定了它们在不同生态学场景下的适用性：</p>
<ol style="list-style-type: decimal">
<li><p><strong>函数形式</strong>：线性模型假设变量间的关系是严格的直线关系，即<span class="math inline">\(f_j(x_j) = \beta_j x_j\)</span>，其中<span class="math inline">\(\beta_j\)</span>是固定的斜率参数。这种假设在很多生态学场景中显得过于简化。例如，在研究温度对植物生长速率的影响时，线性模型会假设温度每升高1℃，生长速率就增加固定数值。然而，生态生理学告诉我们，植物生长对温度的反应通常呈现S形曲线：在低温阈值以下影响微弱，在适宜温度范围内影响显著，而在高温胁迫下影响可能减弱甚至逆转。可加性模型通过使用平滑函数<span class="math inline">\(f_j(x_j)\)</span>，能够自动捕捉这种复杂的非线性模式，而无需预先指定具体的函数形式。</p></li>
<li><p><strong>灵活性</strong>：线性模型要求研究者预先知道或假设变量间的函数关系，这在生态学研究中往往难以实现。例如，当我们研究海拔对物种丰富度的影响时，我们可能不知道这种关系是线性的、二次的、还是更复杂的单峰曲线。可加性模型通过数据驱动的方式，让数据本身决定变量间的关系形态。这种灵活性特别适合探索性研究，当我们对生态过程的数学形式缺乏先验知识时，可加性模型能够帮助我们”发现”数据中隐藏的模式。</p></li>
<li><p><strong>参数数量</strong>：线性模型有固定的参数数量，等于预测变量的个数加1（截距项）。这种固定结构在某些情况下可能导致模型过于简化。可加性模型的复杂度由数据决定，通过广义交叉验证（GCV）或限制极大似然（REML）等方法自动选择最优的平滑复杂度。这种自适应特性使得可加性模型能够在简单模式和复杂模式之间找到平衡，避免过度拟合或欠拟合。</p></li>
<li><p><strong>解释性</strong>：线性模型具有明确的参数解释，每个<span class="math inline">\(\beta_j\)</span>代表在其他变量保持不变时，<span class="math inline">\(x_j\)</span>每增加一个单位，响应变量<span class="math inline">\(y\)</span>的平均变化量。这种解释在生态学中非常直观。可加性模型的解释则更加复杂，需要通过可视化来理解每个变量的效应。虽然可加性模型失去了参数的直接解释性，但它获得了描述复杂生态关系的能力，这在很多生态学应用中更为重要。</p></li>
</ol>
</div>
<div id="常见的平滑函数" class="section level3 hasAnchor" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> 常见的平滑函数<a href="高级回归模型.html#常见的平滑函数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在R的<code>mgcv</code>包中，可加性模型支持多种平滑基函数，每种都有其特点和适用场景：</p>
<ol style="list-style-type: decimal">
<li><strong>薄板样条（Thin Plate Splines）</strong>：
<ul>
<li>默认平滑基函数，通过<code>bs = "tp"</code>指定</li>
<li>优点：数学性质优良，对节点位置不敏感</li>
<li>适用场景：一般性的平滑问题，特别是当预测变量间没有明显的尺度差异时</li>
</ul>
<div class="sourceCode" id="cb2168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2168-1"><a href="高级回归模型.html#cb2168-1" tabindex="-1"></a><span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">s</span>(x1, <span class="at">bs =</span> <span class="st">&quot;tp&quot;</span>) <span class="sc">+</span> <span class="fu">s</span>(x2, <span class="at">bs =</span> <span class="st">&quot;tp&quot;</span>), <span class="at">data =</span> dataset)</span></code></pre></div></li>
<li><strong>立方样条（Cubic Regression Splines）</strong>：
<ul>
<li>通过<code>bs = "cr"</code>指定</li>
<li>优点：计算效率高，对节点位置敏感</li>
<li>适用场景：一维平滑问题，特别是当数据点分布不均匀时</li>
</ul>
<div class="sourceCode" id="cb2169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2169-1"><a href="高级回归模型.html#cb2169-1" tabindex="-1"></a><span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">s</span>(x1, <span class="at">bs =</span> <span class="st">&quot;cr&quot;</span>) <span class="sc">+</span> <span class="fu">s</span>(x2, <span class="at">bs =</span> <span class="st">&quot;cr&quot;</span>), <span class="at">data =</span> dataset)</span></code></pre></div></li>
<li><strong>P样条（P-splines）</strong>：
<ul>
<li>通过<code>bs = "ps"</code>指定</li>
<li>优点：基于B样条基，对过度拟合有较好的控制</li>
<li>适用场景：需要较强平滑约束的情况</li>
</ul>
<div class="sourceCode" id="cb2170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2170-1"><a href="高级回归模型.html#cb2170-1" tabindex="-1"></a><span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">s</span>(x1, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>) <span class="sc">+</span> <span class="fu">s</span>(x2, <span class="at">bs =</span> <span class="st">&quot;ps&quot;</span>), <span class="at">data =</span> dataset)</span></code></pre></div></li>
<li><strong>循环样条（Cyclic Cubic Splines）</strong>：
<ul>
<li>通过<code>bs = "cc"</code>指定</li>
<li>优点：处理周期性数据，确保平滑函数在边界处连续</li>
<li>适用场景：时间序列数据（日、季节周期）、角度数据等</li>
</ul>
<div class="sourceCode" id="cb2171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2171-1"><a href="高级回归模型.html#cb2171-1" tabindex="-1"></a><span class="co"># 处理具有年周期的生态数据</span></span>
<span id="cb2171-2"><a href="高级回归模型.html#cb2171-2" tabindex="-1"></a><span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">s</span>(day_of_year, <span class="at">bs =</span> <span class="st">&quot;cc&quot;</span>), <span class="at">data =</span> dataset)</span></code></pre></div></li>
<li><strong>自适应平滑（Adaptive Smoothing）</strong>：
<ul>
<li>通过<code>bs = "ad"</code>指定</li>
<li>优点：能够适应数据中不同区域的平滑度变化</li>
<li>适用场景：数据在不同区域具有不同变异性的情况</li>
</ul>
<div class="sourceCode" id="cb2172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2172-1"><a href="高级回归模型.html#cb2172-1" tabindex="-1"></a><span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">s</span>(x1, <span class="at">bs =</span> <span class="st">&quot;ad&quot;</span>), <span class="at">data =</span> dataset)</span></code></pre></div></li>
<li><strong>张量积平滑（Tensor Product Smooths）</strong>：
<ul>
<li>通过<code>te()</code>函数实现</li>
<li>优点：处理多个变量间的交互作用</li>
<li>适用场景：当变量间存在复杂的交互效应时</li>
</ul>
<div class="sourceCode" id="cb2173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2173-1"><a href="高级回归模型.html#cb2173-1" tabindex="-1"></a><span class="co"># 建模温度和降水对物种丰富度的交互影响</span></span>
<span id="cb2173-2"><a href="高级回归模型.html#cb2173-2" tabindex="-1"></a><span class="fu">gam</span>(species_richness <span class="sc">~</span> <span class="fu">te</span>(temperature, precipitation),</span>
<span id="cb2173-3"><a href="高级回归模型.html#cb2173-3" tabindex="-1"></a>    <span class="at">family =</span> poisson, <span class="at">data =</span> dataset)</span></code></pre></div></li>
<li><strong>交互平滑（Interaction Smooths）</strong>：
<ul>
<li>通过<code>ti()</code>函数实现</li>
<li>优点：分离主效应和交互效应</li>
<li>适用场景：需要分别解释主效应和交互效应时</li>
</ul>
<div class="sourceCode" id="cb2174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2174-1"><a href="高级回归模型.html#cb2174-1" tabindex="-1"></a><span class="fu">gam</span>(species_richness <span class="sc">~</span> <span class="fu">s</span>(temperature) <span class="sc">+</span> <span class="fu">s</span>(precipitation) <span class="sc">+</span></span>
<span id="cb2174-2"><a href="高级回归模型.html#cb2174-2" tabindex="-1"></a>    <span class="fu">ti</span>(temperature, precipitation), <span class="at">family =</span> poisson, <span class="at">data =</span> dataset)</span></code></pre></div></li>
</ol>
</div>
<div id="平滑函数选择的生态学考量" class="section level3 hasAnchor" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> 平滑函数选择的生态学考量<a href="高级回归模型.html#平滑函数选择的生态学考量" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在选择平滑函数时，需要考虑生态学问题的具体特点：</p>
<ul>
<li><strong>数据特性</strong>：如果数据具有明显的周期性（如季节变化），应选择循环样条</li>
<li><strong>变量尺度</strong>：如果预测变量尺度差异很大，张量积平滑可能更合适</li>
<li><strong>计算效率</strong>：对于大数据集，立方样条通常计算效率更高</li>
<li><strong>生态机制</strong>：如果对生态过程有一定了解，可以选择更符合生态机制的平滑函数</li>
</ul>
<p>通过合理选择平滑函数，可加性模型能够更好地捕捉生态数据中的复杂模式，为生态学研究和保护决策提供更可靠的统计支持。</p>
</div>
<div id="可加性模型中的系数概念" class="section level3 hasAnchor" number="10.2.5">
<h3><span class="header-section-number">10.2.5</span> 可加性模型中的”系数”概念<a href="高级回归模型.html#可加性模型中的系数概念" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>这是一个非常重要的问题：可加性模型有回归系数吗？能否像线性回归那样解释”正相关”或”负相关”？</p>
<p><strong>简短回答：</strong> 可加性模型没有传统意义上的回归系数，不能像线性回归那样直接解释”正相关”或”负相关”。</p>
<div id="为什么可加性模型没有传统系数" class="section level4 hasAnchor" number="10.2.5.1">
<h4><span class="header-section-number">10.2.5.1</span> 为什么可加性模型没有传统系数<a href="高级回归模型.html#为什么可加性模型没有传统系数" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>线性回归的系数解释：</strong> - 模型：<span class="math inline">\(y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \varepsilon\)</span> - <span class="math inline">\(\beta_1\)</span>：当<span class="math inline">\(x_2\)</span>保持不变时，<span class="math inline">\(x_1\)</span>每增加1单位，<span class="math inline">\(y\)</span>平均变化<span class="math inline">\(\beta_1\)</span>单位 - 如果<span class="math inline">\(\beta_1 &gt; 0\)</span>：正相关；<span class="math inline">\(\beta_1 &lt; 0\)</span>：负相关</p>
<p><strong>可加性模型的”系数”本质：</strong> - 模型：<span class="math inline">\(y = \beta_0 + f_1(x_1) + f_2(x_2) + \varepsilon\)</span> - 这里没有固定的<span class="math inline">\(\beta_1, \beta_2\)</span>，而是平滑函数<span class="math inline">\(f_1(x_1), f_2(x_2)\)</span> - 每个平滑函数本身是一个复杂的数学表达式，包含多个基函数系数</p>
</div>
<div id="为什么不能直接解释正负相关" class="section level4 hasAnchor" number="10.2.5.2">
<h4><span class="header-section-number">10.2.5.2</span> 为什么不能直接解释”正负相关”<a href="高级回归模型.html#为什么不能直接解释正负相关" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>原因1：非线性关系</strong> 可加性模型允许变量间的关系在整个取值范围内变化。例如，温度对植物生长的影响可能在低温时为正相关，在高温时为负相关。无法用单一系数描述这种复杂关系。</p>
<p><strong>原因2：局部效应</strong> 可加性模型描述的是局部效应，而不是全局效应。在<span class="math inline">\(x_1\)</span>的不同取值区间，<span class="math inline">\(f_1(x_1)\)</span>的斜率（导数）可能不同。</p>
</div>
<div id="如何正确解释可加性模型的结果" class="section level4 hasAnchor" number="10.2.5.3">
<h4><span class="header-section-number">10.2.5.3</span> 如何正确解释可加性模型的结果<a href="高级回归模型.html#如何正确解释可加性模型的结果" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>方法1：可视化解释</strong></p>
<div class="sourceCode" id="cb2175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2175-1"><a href="高级回归模型.html#cb2175-1" tabindex="-1"></a><span class="co"># 绘制平滑函数图</span></span>
<span id="cb2175-2"><a href="高级回归模型.html#cb2175-2" tabindex="-1"></a><span class="fu">plot</span>(gam_model, <span class="at">pages =</span> <span class="dv">1</span>)</span></code></pre></div>
<ul>
<li>曲线上升：正相关趋势</li>
<li>曲线下降：负相关趋势</li>
<li>曲线平坦：影响微弱</li>
</ul>
<p><strong>方法2：导数分析</strong></p>
<div class="sourceCode" id="cb2176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2176-1"><a href="高级回归模型.html#cb2176-1" tabindex="-1"></a><span class="co"># 计算特定点的导数（斜率）</span></span>
<span id="cb2176-2"><a href="高级回归模型.html#cb2176-2" tabindex="-1"></a><span class="fu">library</span>(gratia)</span>
<span id="cb2176-3"><a href="高级回归模型.html#cb2176-3" tabindex="-1"></a><span class="fu">derivatives</span>(gam_model, <span class="at">term =</span> <span class="st">&quot;s(temperature)&quot;</span>)</span></code></pre></div>
<p><strong>方法3：区间分析</strong> 将变量取值范围分成多个区间，分析每个区间内的平均效应方向。</p>
</div>
<div id="实际生态学例子对比" class="section level4 hasAnchor" number="10.2.5.4">
<h4><span class="header-section-number">10.2.5.4</span> 实际生态学例子对比<a href="高级回归模型.html#实际生态学例子对比" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>假设研究温度对物种丰富度的影响：</p>
<p><strong>线性模型结果：</strong></p>
<div class="sourceCode" id="cb2177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2177-1"><a href="高级回归模型.html#cb2177-1" tabindex="-1"></a><span class="co"># 假设线性模型系数</span></span>
<span id="cb2177-2"><a href="高级回归模型.html#cb2177-2" tabindex="-1"></a><span class="fu">coef</span>(lm_model)</span>
<span id="cb2177-3"><a href="高级回归模型.html#cb2177-3" tabindex="-1"></a><span class="co"># (Intercept) temperature</span></span>
<span id="cb2177-4"><a href="高级回归模型.html#cb2177-4" tabindex="-1"></a><span class="co">#   15.2        -0.5</span></span></code></pre></div>
<p>解释：温度每升高1°C，物种数减少0.5种（全局负相关）</p>
<p><strong>可加性模型结果：</strong></p>
<div class="sourceCode" id="cb2178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2178-1"><a href="高级回归模型.html#cb2178-1" tabindex="-1"></a><span class="co"># 绘制温度效应曲线</span></span>
<span id="cb2178-2"><a href="高级回归模型.html#cb2178-2" tabindex="-1"></a><span class="fu">plot</span>(gam_model, <span class="at">select =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>解释：<span class="math inline">\(f(温度)\)</span>曲线显示： - 5-15°C：曲线上升（正相关） - 15-25°C：曲线平坦（影响微弱） - 25-35°C：曲线下降（负相关）</p>
</div>
<div id="统计显著性检验" class="section level4 hasAnchor" number="10.2.5.5">
<h4><span class="header-section-number">10.2.5.5</span> 统计显著性检验<a href="高级回归模型.html#统计显著性检验" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>在可加性模型中，我们检验的是： - 平滑函数<span class="math inline">\(f_j(x_j)\)</span>是否显著不同于零函数（即是否有任何效应） - 而不是检验某个系数是否显著不同于零</p>
<div class="sourceCode" id="cb2179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2179-1"><a href="高级回归模型.html#cb2179-1" tabindex="-1"></a><span class="fu">summary</span>(gam_model)</span>
<span id="cb2179-2"><a href="高级回归模型.html#cb2179-2" tabindex="-1"></a><span class="co"># 关注&quot;Approximate significance of smooth terms&quot;部分</span></span></code></pre></div>
</div>
<div id="什么时候可以近似看作系数" class="section level4 hasAnchor" number="10.2.5.6">
<h4><span class="header-section-number">10.2.5.6</span> 什么时候可以近似看作”系数”<a href="高级回归模型.html#什么时候可以近似看作系数" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>在某些特殊情况下： - 当平滑函数在整个取值范围内近似线性时 - 当只关心特定区间内的效应时 - 可以通过计算平均斜率来获得近似的”系数”</p>
<div class="sourceCode" id="cb2180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2180-1"><a href="高级回归模型.html#cb2180-1" tabindex="-1"></a><span class="co"># 计算整个温度范围内的平均效应</span></span>
<span id="cb2180-2"><a href="高级回归模型.html#cb2180-2" tabindex="-1"></a>mean_effect <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">predict</span>(gam_model, <span class="at">type =</span> <span class="st">&quot;terms&quot;</span>)[, <span class="st">&quot;s(temperature)&quot;</span>])</span></code></pre></div>
</div>
<div id="生态学意义" class="section level4 hasAnchor" number="10.2.5.7">
<h4><span class="header-section-number">10.2.5.7</span> 生态学意义<a href="高级回归模型.html#生态学意义" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>这种复杂性正是可加性模型在生态学中如此有价值的原因。生态过程很少是简单的直线关系： - 物种对环境因子的响应通常存在最优区间 - 资源利用效率通常呈现饱和曲线 - 竞争关系可能在不同密度下呈现不同模式</p>
<p>通过放弃简单的系数解释，可加性模型获得了描述真实生态复杂性的能力。这种权衡在生态学研究中通常是值得的，因为它让我们能够更准确地理解生态系统的运作机制。</p>
</div>
</div>
<div id="在r中的实现" class="section level3 hasAnchor" number="10.2.6">
<h3><span class="header-section-number">10.2.6</span> 在R中的实现<a href="高级回归模型.html#在r中的实现" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在R中，我们可以使用<code>mgcv</code>包来实现可加性模型。该包提供了<code>gam()</code>函数，这是构建可加性模型的核心函数。<code>gam()</code>函数的基本语法为：</p>
<div class="sourceCode" id="cb2181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2181-1"><a href="高级回归模型.html#cb2181-1" tabindex="-1"></a><span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">s</span>(x1) <span class="sc">+</span> <span class="fu">s</span>(x2) <span class="sc">+</span> ... <span class="sc">+</span> <span class="fu">s</span>(xp), <span class="at">data =</span> dataset)</span></code></pre></div>
<p>其中<code>s()</code>函数用于指定平滑项，它可以自动选择平滑函数的复杂度。<code>gam()</code>函数支持多种平滑基函数，包括薄板样条、立方样条、P样条等，用户可以通过<code>bs</code>参数进行选择。</p>
</div>
<div id="生态学应用示例" class="section level3 hasAnchor" number="10.2.7">
<h3><span class="header-section-number">10.2.7</span> 生态学应用示例<a href="高级回归模型.html#生态学应用示例" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>让我们通过一个具体的生态学例子来演示可加性模型的应用。假设我们研究湖泊中浮游植物生物量（叶绿素a浓度）与环境因子的关系：</p>
<div class="sourceCode" id="cb2182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2182-1"><a href="高级回归模型.html#cb2182-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb2182-2"><a href="高级回归模型.html#cb2182-2" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span></code></pre></div>
<pre><code>## Loading required package: nlme</code></pre>
<pre><code>## This is mgcv 1.9-1. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.</code></pre>
<div class="sourceCode" id="cb2185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2185-1"><a href="高级回归模型.html#cb2185-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2185-2"><a href="高级回归模型.html#cb2185-2" tabindex="-1"></a></span>
<span id="cb2185-3"><a href="高级回归模型.html#cb2185-3" tabindex="-1"></a><span class="co"># 模拟生态学数据</span></span>
<span id="cb2185-4"><a href="高级回归模型.html#cb2185-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2185-5"><a href="高级回归模型.html#cb2185-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb2185-6"><a href="高级回归模型.html#cb2185-6" tabindex="-1"></a>lake_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2185-7"><a href="高级回归模型.html#cb2185-7" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">runif</span>(n, <span class="dv">5</span>, <span class="dv">30</span>), <span class="co"># 水温(°C)</span></span>
<span id="cb2185-8"><a href="高级回归模型.html#cb2185-8" tabindex="-1"></a>  <span class="at">nutrients =</span> <span class="fu">runif</span>(n, <span class="fl">0.1</span>, <span class="dv">5</span>), <span class="co"># 营养盐浓度(mg/L)</span></span>
<span id="cb2185-9"><a href="高级回归模型.html#cb2185-9" tabindex="-1"></a>  <span class="at">light =</span> <span class="fu">runif</span>(n, <span class="dv">100</span>, <span class="dv">2000</span>) <span class="co"># 光照强度(μmol/m²/s)</span></span>
<span id="cb2185-10"><a href="高级回归模型.html#cb2185-10" tabindex="-1"></a>)</span>
<span id="cb2185-11"><a href="高级回归模型.html#cb2185-11" tabindex="-1"></a></span>
<span id="cb2185-12"><a href="高级回归模型.html#cb2185-12" tabindex="-1"></a><span class="co"># 模拟非线性关系：温度呈现单峰效应，营养盐呈现饱和效应</span></span>
<span id="cb2185-13"><a href="高级回归模型.html#cb2185-13" tabindex="-1"></a>lake_data<span class="sc">$</span>chlorophyll <span class="ot">&lt;-</span> (</span>
<span id="cb2185-14"><a href="高级回归模型.html#cb2185-14" tabindex="-1"></a>  <span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb2185-15"><a href="高级回归模型.html#cb2185-15" tabindex="-1"></a>    <span class="fl">0.1</span> <span class="sc">*</span> (lake_data<span class="sc">$</span>temperature <span class="sc">-</span> <span class="dv">15</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="fl">0.02</span> <span class="sc">*</span> (lake_data<span class="sc">$</span>temperature <span class="sc">-</span> <span class="dv">15</span>)<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span></span>
<span id="cb2185-16"><a href="高级回归模型.html#cb2185-16" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.8</span> <span class="sc">*</span> lake_data<span class="sc">$</span>nutrients)) <span class="sc">+</span></span>
<span id="cb2185-17"><a href="高级回归模型.html#cb2185-17" tabindex="-1"></a>    <span class="fl">0.001</span> <span class="sc">*</span> lake_data<span class="sc">$</span>light <span class="sc">+</span></span>
<span id="cb2185-18"><a href="高级回归模型.html#cb2185-18" tabindex="-1"></a>    <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb2185-19"><a href="高级回归模型.html#cb2185-19" tabindex="-1"></a>)</span>
<span id="cb2185-20"><a href="高级回归模型.html#cb2185-20" tabindex="-1"></a></span>
<span id="cb2185-21"><a href="高级回归模型.html#cb2185-21" tabindex="-1"></a><span class="co"># 构建可加性模型</span></span>
<span id="cb2185-22"><a href="高级回归模型.html#cb2185-22" tabindex="-1"></a>phyto_am <span class="ot">&lt;-</span> <span class="fu">gam</span>(chlorophyll <span class="sc">~</span> <span class="fu">s</span>(temperature) <span class="sc">+</span> <span class="fu">s</span>(nutrients) <span class="sc">+</span> <span class="fu">s</span>(light),</span>
<span id="cb2185-23"><a href="高级回归模型.html#cb2185-23" tabindex="-1"></a>  <span class="at">data =</span> lake_data</span>
<span id="cb2185-24"><a href="高级回归模型.html#cb2185-24" tabindex="-1"></a>)</span>
<span id="cb2185-25"><a href="高级回归模型.html#cb2185-25" tabindex="-1"></a></span>
<span id="cb2185-26"><a href="高级回归模型.html#cb2185-26" tabindex="-1"></a><span class="co"># 模型摘要</span></span>
<span id="cb2185-27"><a href="高级回归模型.html#cb2185-27" tabindex="-1"></a><span class="fu">summary</span>(phyto_am)</span></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## chlorophyll ~ s(temperature) + s(nutrients) + s(light)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.67023    0.03769   44.32   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                  edf Ref.df        F p-value    
## s(temperature) 8.852  8.993 12955.89  &lt;2e-16 ***
## s(nutrients)   2.967  3.684    39.95  &lt;2e-16 ***
## s(light)       2.754  3.421    62.61  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.998   Deviance explained = 99.8%
## GCV = 0.30807  Scale est. = 0.28408   n = 200</code></pre>
<div class="sourceCode" id="cb2187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2187-1"><a href="高级回归模型.html#cb2187-1" tabindex="-1"></a><span class="co"># 可视化各变量的平滑效应</span></span>
<span id="cb2187-2"><a href="高级回归模型.html#cb2187-2" tabindex="-1"></a><span class="fu">plot</span>(phyto_am, <span class="at">pages =</span> <span class="dv">1</span>, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-1-1"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-1-1.png" alt="浮游植物生物量与环境因子关系的可加性模型平滑效应图" width="672" />
<p class="caption">
图10.1: 浮游植物生物量与环境因子关系的可加性模型平滑效应图
</p>
</div>
<div class="sourceCode" id="cb2188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2188-1"><a href="高级回归模型.html#cb2188-1" tabindex="-1"></a><span class="co"># 模型诊断</span></span>
<span id="cb2188-2"><a href="高级回归模型.html#cb2188-2" tabindex="-1"></a><span class="fu">gam.check</span>(phyto_am)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-1-2"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-1-2.png" alt="浮游植物生物量与环境因子关系的可加性模型平滑效应图" width="672" />
<p class="caption">
图10.2: 浮游植物生物量与环境因子关系的可加性模型平滑效应图
</p>
</div>
<pre><code>## 
## Method: GCV   Optimizer: magic
## Smoothing parameter selection converged after 13 iterations.
## The RMS GCV score gradient at convergence was 3.147714e-06 .
## The Hessian was positive definite.
## Model rank =  28 / 28 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                  k&#39;  edf k-index p-value  
## s(temperature) 9.00 8.85    1.03    0.64  
## s(nutrients)   9.00 2.97    0.90    0.04 *
## s(light)       9.00 2.75    1.04    0.70  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb2190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2190-1"><a href="高级回归模型.html#cb2190-1" tabindex="-1"></a><span class="co"># 与线性模型比较</span></span>
<span id="cb2190-2"><a href="高级回归模型.html#cb2190-2" tabindex="-1"></a>phyto_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(chlorophyll <span class="sc">~</span> temperature <span class="sc">+</span> nutrients <span class="sc">+</span> light, <span class="at">data =</span> lake_data)</span>
<span id="cb2190-3"><a href="高级回归模型.html#cb2190-3" tabindex="-1"></a></span>
<span id="cb2190-4"><a href="高级回归模型.html#cb2190-4" tabindex="-1"></a><span class="co"># 比较模型拟合优度</span></span>
<span id="cb2190-5"><a href="高级回归模型.html#cb2190-5" tabindex="-1"></a><span class="fu">AIC</span>(phyto_am, phyto_lm)</span></code></pre></div>
<pre><code>##                df       AIC
## phyto_am 16.57349  332.8098
## phyto_lm  5.00000 1304.4097</code></pre>
<p>在这个例子中，我们使用了几个关键函数：</p>
<ul>
<li><code>gam()</code>：构建可加性模型的核心函数</li>
<li><code>s()</code>：指定平滑项，自动选择平滑复杂度</li>
<li><code>summary()</code>：输出模型摘要，包括平滑项的显著性检验</li>
<li><code>plot()</code>：可视化各变量的平滑效应</li>
<li><code>gam.check()</code>：进行模型诊断，检查残差和光滑度选择</li>
</ul>
</div>
<div id="可加性模型诊断" class="section level3 hasAnchor" number="10.2.8">
<h3><span class="header-section-number">10.2.8</span> 可加性模型诊断<a href="高级回归模型.html#可加性模型诊断" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>可加性模型的诊断比传统线性模型更为复杂，需要特别关注平滑复杂度的选择、残差模式和过度拟合问题。系统性的模型诊断是确保结果可靠性的关键步骤。</p>
<div id="平滑复杂度诊断" class="section level4 hasAnchor" number="10.2.8.1">
<h4><span class="header-section-number">10.2.8.1</span> 平滑复杂度诊断<a href="高级回归模型.html#平滑复杂度诊断" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>平滑复杂度通过基函数维度(k)来控制，k值决定了平滑函数能够捕捉的”摆动”程度。如果k值太小，模型可能无法充分捕捉数据的非线性模式；如果k值太大，则可能导致过度拟合。</p>
<div class="sourceCode" id="cb2192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2192-1"><a href="高级回归模型.html#cb2192-1" tabindex="-1"></a><span class="co"># 检查平滑复杂度是否足够</span></span>
<span id="cb2192-2"><a href="高级回归模型.html#cb2192-2" tabindex="-1"></a><span class="fu">gam.check</span>(phyto_am)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-2-1"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-2-1.png" alt="可加性模型平滑复杂度诊断图" width="672" />
<p class="caption">
图10.3: 可加性模型平滑复杂度诊断图
</p>
</div>
<pre><code>## 
## Method: GCV   Optimizer: magic
## Smoothing parameter selection converged after 13 iterations.
## The RMS GCV score gradient at convergence was 3.147714e-06 .
## The Hessian was positive definite.
## Model rank =  28 / 28 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                  k&#39;  edf k-index p-value  
## s(temperature) 9.00 8.85    1.03   0.630  
## s(nutrients)   9.00 2.97    0.90   0.085 .
## s(light)       9.00 2.75    1.04   0.670  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb2194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2194-1"><a href="高级回归模型.html#cb2194-1" tabindex="-1"></a><span class="co"># 输出解释：</span></span>
<span id="cb2194-2"><a href="高级回归模型.html#cb2194-2" tabindex="-1"></a><span class="co"># k&#39;: 实际使用的基函数维度</span></span>
<span id="cb2194-3"><a href="高级回归模型.html#cb2194-3" tabindex="-1"></a><span class="co"># edf: 有效自由度，反映实际使用的平滑复杂度</span></span>
<span id="cb2194-4"><a href="高级回归模型.html#cb2194-4" tabindex="-1"></a><span class="co"># 如果edf接近k&#39;-1，说明k值可能不足</span></span>
<span id="cb2194-5"><a href="高级回归模型.html#cb2194-5" tabindex="-1"></a><span class="co"># 如果k-index &lt; 1 且 p-value &lt; 0.05，说明需要增加k值</span></span>
<span id="cb2194-6"><a href="高级回归模型.html#cb2194-6" tabindex="-1"></a></span>
<span id="cb2194-7"><a href="高级回归模型.html#cb2194-7" tabindex="-1"></a><span class="co"># 调整k值处理wiggliness不足</span></span>
<span id="cb2194-8"><a href="高级回归模型.html#cb2194-8" tabindex="-1"></a>phyto_am_adj <span class="ot">&lt;-</span> <span class="fu">gam</span>(</span>
<span id="cb2194-9"><a href="高级回归模型.html#cb2194-9" tabindex="-1"></a>  chlorophyll <span class="sc">~</span> <span class="fu">s</span>(temperature, <span class="at">k =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb2194-10"><a href="高级回归模型.html#cb2194-10" tabindex="-1"></a>    <span class="fu">s</span>(nutrients, <span class="at">k =</span> <span class="dv">10</span>) <span class="sc">+</span> <span class="fu">s</span>(light, <span class="at">k =</span> <span class="dv">10</span>),</span>
<span id="cb2194-11"><a href="高级回归模型.html#cb2194-11" tabindex="-1"></a>  <span class="at">data =</span> lake_data</span>
<span id="cb2194-12"><a href="高级回归模型.html#cb2194-12" tabindex="-1"></a>)</span>
<span id="cb2194-13"><a href="高级回归模型.html#cb2194-13" tabindex="-1"></a><span class="fu">gam.check</span>(phyto_am_adj)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-2-2"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-2-2.png" alt="可加性模型平滑复杂度诊断图" width="672" />
<p class="caption">
图10.4: 可加性模型平滑复杂度诊断图
</p>
</div>
<pre><code>## 
## Method: GCV   Optimizer: magic
## Smoothing parameter selection converged after 11 iterations.
## The RMS GCV score gradient at convergence was 1.082531e-05 .
## The Hessian was positive definite.
## Model rank =  33 / 33 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                   k&#39;   edf k-index p-value  
## s(temperature) 14.00 12.29    1.10    0.86  
## s(nutrients)    9.00  2.71    0.89    0.07 .
## s(light)        9.00  2.42    1.06    0.82  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="残差诊断" class="section level4 hasAnchor" number="10.2.8.2">
<h4><span class="header-section-number">10.2.8.2</span> 残差诊断<a href="高级回归模型.html#残差诊断" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>可加性模型的残差诊断需要检查残差的独立性、同方差性和分布假设。</p>
<div class="sourceCode" id="cb2196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2196-1"><a href="高级回归模型.html#cb2196-1" tabindex="-1"></a><span class="co"># 残差诊断图</span></span>
<span id="cb2196-2"><a href="高级回归模型.html#cb2196-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb2196-3"><a href="高级回归模型.html#cb2196-3" tabindex="-1"></a></span>
<span id="cb2196-4"><a href="高级回归模型.html#cb2196-4" tabindex="-1"></a><span class="co"># 残差与拟合值图</span></span>
<span id="cb2196-5"><a href="高级回归模型.html#cb2196-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(phyto_am), <span class="fu">residuals</span>(phyto_am),</span>
<span id="cb2196-6"><a href="高级回归模型.html#cb2196-6" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;拟合值&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;残差&quot;</span>,</span>
<span id="cb2196-7"><a href="高级回归模型.html#cb2196-7" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;残差 vs 拟合值&quot;</span></span>
<span id="cb2196-8"><a href="高级回归模型.html#cb2196-8" tabindex="-1"></a>)</span>
<span id="cb2196-9"><a href="高级回归模型.html#cb2196-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb2196-10"><a href="高级回归模型.html#cb2196-10" tabindex="-1"></a></span>
<span id="cb2196-11"><a href="高级回归模型.html#cb2196-11" tabindex="-1"></a><span class="co"># Q-Q图检查正态性</span></span>
<span id="cb2196-12"><a href="高级回归模型.html#cb2196-12" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(phyto_am))</span>
<span id="cb2196-13"><a href="高级回归模型.html#cb2196-13" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(phyto_am), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb2196-14"><a href="高级回归模型.html#cb2196-14" tabindex="-1"></a></span>
<span id="cb2196-15"><a href="高级回归模型.html#cb2196-15" tabindex="-1"></a><span class="co"># 残差与预测变量关系图</span></span>
<span id="cb2196-16"><a href="高级回归模型.html#cb2196-16" tabindex="-1"></a><span class="fu">plot</span>(lake_data<span class="sc">$</span>temperature, <span class="fu">residuals</span>(phyto_am),</span>
<span id="cb2196-17"><a href="高级回归模型.html#cb2196-17" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;温度&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;残差&quot;</span>,</span>
<span id="cb2196-18"><a href="高级回归模型.html#cb2196-18" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;残差 vs 温度&quot;</span></span>
<span id="cb2196-19"><a href="高级回归模型.html#cb2196-19" tabindex="-1"></a>)</span>
<span id="cb2196-20"><a href="高级回归模型.html#cb2196-20" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb2196-21"><a href="高级回归模型.html#cb2196-21" tabindex="-1"></a></span>
<span id="cb2196-22"><a href="高级回归模型.html#cb2196-22" tabindex="-1"></a><span class="co"># 自相关函数图（检查时间序列自相关）</span></span>
<span id="cb2196-23"><a href="高级回归模型.html#cb2196-23" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">residuals</span>(phyto_am), <span class="at">main =</span> <span class="st">&quot;残差自相关&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-3-1.png" alt="可加性模型残差诊断图" width="672" />
<p class="caption">
图2.2: 可加性模型残差诊断图
</p>
</div>
</div>
<div id="模型比较与选择" class="section level4 hasAnchor" number="10.2.8.3">
<h4><span class="header-section-number">10.2.8.3</span> 模型比较与选择<a href="高级回归模型.html#模型比较与选择" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>比较不同平滑复杂度和基函数的模型，选择最优模型。</p>
<div class="sourceCode" id="cb2197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2197-1"><a href="高级回归模型.html#cb2197-1" tabindex="-1"></a><span class="co"># 比较不同平滑复杂度的模型</span></span>
<span id="cb2197-2"><a href="高级回归模型.html#cb2197-2" tabindex="-1"></a>model_simple <span class="ot">&lt;-</span> <span class="fu">gam</span>(</span>
<span id="cb2197-3"><a href="高级回归模型.html#cb2197-3" tabindex="-1"></a>  chlorophyll <span class="sc">~</span> <span class="fu">s</span>(temperature, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb2197-4"><a href="高级回归模型.html#cb2197-4" tabindex="-1"></a>    <span class="fu">s</span>(nutrients, <span class="at">k =</span> <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">s</span>(light, <span class="at">k =</span> <span class="dv">5</span>),</span>
<span id="cb2197-5"><a href="高级回归模型.html#cb2197-5" tabindex="-1"></a>  <span class="at">data =</span> lake_data</span>
<span id="cb2197-6"><a href="高级回归模型.html#cb2197-6" tabindex="-1"></a>)</span>
<span id="cb2197-7"><a href="高级回归模型.html#cb2197-7" tabindex="-1"></a></span>
<span id="cb2197-8"><a href="高级回归模型.html#cb2197-8" tabindex="-1"></a>model_complex <span class="ot">&lt;-</span> <span class="fu">gam</span>(</span>
<span id="cb2197-9"><a href="高级回归模型.html#cb2197-9" tabindex="-1"></a>  chlorophyll <span class="sc">~</span> <span class="fu">s</span>(temperature, <span class="at">k =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb2197-10"><a href="高级回归模型.html#cb2197-10" tabindex="-1"></a>    <span class="fu">s</span>(nutrients, <span class="at">k =</span> <span class="dv">15</span>) <span class="sc">+</span> <span class="fu">s</span>(light, <span class="at">k =</span> <span class="dv">15</span>),</span>
<span id="cb2197-11"><a href="高级回归模型.html#cb2197-11" tabindex="-1"></a>  <span class="at">data =</span> lake_data</span>
<span id="cb2197-12"><a href="高级回归模型.html#cb2197-12" tabindex="-1"></a>)</span>
<span id="cb2197-13"><a href="高级回归模型.html#cb2197-13" tabindex="-1"></a></span>
<span id="cb2197-14"><a href="高级回归模型.html#cb2197-14" tabindex="-1"></a><span class="co"># 使用AIC比较模型</span></span>
<span id="cb2197-15"><a href="高级回归模型.html#cb2197-15" tabindex="-1"></a><span class="fu">AIC</span>(model_simple, model_complex, phyto_am)</span></code></pre></div>
<pre><code>##                     df      AIC
## model_simple  10.85802 692.1595
## model_complex 20.85028 326.0325
## phyto_am      16.57349 332.8098</code></pre>
<div class="sourceCode" id="cb2199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2199-1"><a href="高级回归模型.html#cb2199-1" tabindex="-1"></a><span class="co"># 检查GCV分数（广义交叉验证）</span></span>
<span id="cb2199-2"><a href="高级回归模型.html#cb2199-2" tabindex="-1"></a>phyto_am<span class="sc">$</span>gcv.ubre</span></code></pre></div>
<pre><code>##    GCV.Cp 
## 0.3080694</code></pre>
<div class="sourceCode" id="cb2201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2201-1"><a href="高级回归模型.html#cb2201-1" tabindex="-1"></a><span class="co"># 不同平滑基函数比较</span></span>
<span id="cb2201-2"><a href="高级回归模型.html#cb2201-2" tabindex="-1"></a>model_tp <span class="ot">&lt;-</span> <span class="fu">gam</span>(</span>
<span id="cb2201-3"><a href="高级回归模型.html#cb2201-3" tabindex="-1"></a>  chlorophyll <span class="sc">~</span> <span class="fu">s</span>(temperature, <span class="at">bs =</span> <span class="st">&quot;tp&quot;</span>) <span class="sc">+</span></span>
<span id="cb2201-4"><a href="高级回归模型.html#cb2201-4" tabindex="-1"></a>    <span class="fu">s</span>(nutrients, <span class="at">bs =</span> <span class="st">&quot;tp&quot;</span>) <span class="sc">+</span> <span class="fu">s</span>(light, <span class="at">bs =</span> <span class="st">&quot;tp&quot;</span>),</span>
<span id="cb2201-5"><a href="高级回归模型.html#cb2201-5" tabindex="-1"></a>  <span class="at">data =</span> lake_data</span>
<span id="cb2201-6"><a href="高级回归模型.html#cb2201-6" tabindex="-1"></a>)</span>
<span id="cb2201-7"><a href="高级回归模型.html#cb2201-7" tabindex="-1"></a></span>
<span id="cb2201-8"><a href="高级回归模型.html#cb2201-8" tabindex="-1"></a>model_cr <span class="ot">&lt;-</span> <span class="fu">gam</span>(</span>
<span id="cb2201-9"><a href="高级回归模型.html#cb2201-9" tabindex="-1"></a>  chlorophyll <span class="sc">~</span> <span class="fu">s</span>(temperature, <span class="at">bs =</span> <span class="st">&quot;cr&quot;</span>) <span class="sc">+</span></span>
<span id="cb2201-10"><a href="高级回归模型.html#cb2201-10" tabindex="-1"></a>    <span class="fu">s</span>(nutrients, <span class="at">bs =</span> <span class="st">&quot;cr&quot;</span>) <span class="sc">+</span> <span class="fu">s</span>(light, <span class="at">bs =</span> <span class="st">&quot;cr&quot;</span>),</span>
<span id="cb2201-11"><a href="高级回归模型.html#cb2201-11" tabindex="-1"></a>  <span class="at">data =</span> lake_data</span>
<span id="cb2201-12"><a href="高级回归模型.html#cb2201-12" tabindex="-1"></a>)</span>
<span id="cb2201-13"><a href="高级回归模型.html#cb2201-13" tabindex="-1"></a></span>
<span id="cb2201-14"><a href="高级回归模型.html#cb2201-14" tabindex="-1"></a><span class="fu">AIC</span>(model_tp, model_cr)</span></code></pre></div>
<pre><code>##                df      AIC
## model_tp 16.57349 332.8098
## model_cr 16.37752 331.7293</code></pre>
</div>
<div id="预测性能评估" class="section level4 hasAnchor" number="10.2.8.4">
<h4><span class="header-section-number">10.2.8.4</span> 预测性能评估<a href="高级回归模型.html#预测性能评估" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>评估模型在新数据上的预测性能。</p>
<div class="sourceCode" id="cb2203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2203-1"><a href="高级回归模型.html#cb2203-1" tabindex="-1"></a><span class="co"># 交叉验证评估</span></span>
<span id="cb2203-2"><a href="高级回归模型.html#cb2203-2" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb2203-3"><a href="高级回归模型.html#cb2203-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2203-4"><a href="高级回归模型.html#cb2203-4" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(lake_data), <span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(lake_data))</span>
<span id="cb2203-5"><a href="高级回归模型.html#cb2203-5" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> lake_data[train_indices, ]</span>
<span id="cb2203-6"><a href="高级回归模型.html#cb2203-6" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> lake_data[<span class="sc">-</span>train_indices, ]</span>
<span id="cb2203-7"><a href="高级回归模型.html#cb2203-7" tabindex="-1"></a></span>
<span id="cb2203-8"><a href="高级回归模型.html#cb2203-8" tabindex="-1"></a><span class="co"># 在训练集上构建模型</span></span>
<span id="cb2203-9"><a href="高级回归模型.html#cb2203-9" tabindex="-1"></a>cv_model <span class="ot">&lt;-</span> <span class="fu">gam</span>(chlorophyll <span class="sc">~</span> <span class="fu">s</span>(temperature) <span class="sc">+</span> <span class="fu">s</span>(nutrients) <span class="sc">+</span> <span class="fu">s</span>(light),</span>
<span id="cb2203-10"><a href="高级回归模型.html#cb2203-10" tabindex="-1"></a>  <span class="at">data =</span> train_data</span>
<span id="cb2203-11"><a href="高级回归模型.html#cb2203-11" tabindex="-1"></a>)</span>
<span id="cb2203-12"><a href="高级回归模型.html#cb2203-12" tabindex="-1"></a></span>
<span id="cb2203-13"><a href="高级回归模型.html#cb2203-13" tabindex="-1"></a><span class="co"># 在测试集上预测</span></span>
<span id="cb2203-14"><a href="高级回归模型.html#cb2203-14" tabindex="-1"></a>test_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(cv_model, <span class="at">newdata =</span> test_data)</span>
<span id="cb2203-15"><a href="高级回归模型.html#cb2203-15" tabindex="-1"></a></span>
<span id="cb2203-16"><a href="高级回归模型.html#cb2203-16" tabindex="-1"></a><span class="co"># 计算预测性能</span></span>
<span id="cb2203-17"><a href="高级回归模型.html#cb2203-17" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test_data<span class="sc">$</span>chlorophyll <span class="sc">-</span> test_predictions)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb2203-18"><a href="高级回归模型.html#cb2203-18" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(test_data<span class="sc">$</span>chlorophyll <span class="sc">-</span> test_predictions))</span>
<span id="cb2203-19"><a href="高级回归模型.html#cb2203-19" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(test_data<span class="sc">$</span>chlorophyll, test_predictions)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb2203-20"><a href="高级回归模型.html#cb2203-20" tabindex="-1"></a></span>
<span id="cb2203-21"><a href="高级回归模型.html#cb2203-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;RMSE:&quot;</span>, rmse, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## RMSE: 0.579658</code></pre>
<div class="sourceCode" id="cb2205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2205-1"><a href="高级回归模型.html#cb2205-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MAE:&quot;</span>, mae, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MAE: 0.4649405</code></pre>
<div class="sourceCode" id="cb2207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2207-1"><a href="高级回归模型.html#cb2207-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;R²:&quot;</span>, r2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## R²: 0.9982059</code></pre>
<div class="sourceCode" id="cb2209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2209-1"><a href="高级回归模型.html#cb2209-1" tabindex="-1"></a><span class="co"># 预测区间</span></span>
<span id="cb2209-2"><a href="高级回归模型.html#cb2209-2" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2209-3"><a href="高级回归模型.html#cb2209-3" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">30</span>, <span class="at">length =</span> <span class="dv">50</span>),</span>
<span id="cb2209-4"><a href="高级回归模型.html#cb2209-4" tabindex="-1"></a>  <span class="at">nutrients =</span> <span class="fu">mean</span>(lake_data<span class="sc">$</span>nutrients),</span>
<span id="cb2209-5"><a href="高级回归模型.html#cb2209-5" tabindex="-1"></a>  <span class="at">light =</span> <span class="fu">mean</span>(lake_data<span class="sc">$</span>light)</span>
<span id="cb2209-6"><a href="高级回归模型.html#cb2209-6" tabindex="-1"></a>)</span>
<span id="cb2209-7"><a href="高级回归模型.html#cb2209-7" tabindex="-1"></a></span>
<span id="cb2209-8"><a href="高级回归模型.html#cb2209-8" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(phyto_am,</span>
<span id="cb2209-9"><a href="高级回归模型.html#cb2209-9" tabindex="-1"></a>  <span class="at">newdata =</span> new_data,</span>
<span id="cb2209-10"><a href="高级回归模型.html#cb2209-10" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span></span>
<span id="cb2209-11"><a href="高级回归模型.html#cb2209-11" tabindex="-1"></a>)</span>
<span id="cb2209-12"><a href="高级回归模型.html#cb2209-12" tabindex="-1"></a>new_data<span class="sc">$</span>pred <span class="ot">&lt;-</span> predictions<span class="sc">$</span>fit</span>
<span id="cb2209-13"><a href="高级回归模型.html#cb2209-13" tabindex="-1"></a>new_data<span class="sc">$</span>lower <span class="ot">&lt;-</span> new_data<span class="sc">$</span>pred <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> predictions<span class="sc">$</span>se.fit</span>
<span id="cb2209-14"><a href="高级回归模型.html#cb2209-14" tabindex="-1"></a>new_data<span class="sc">$</span>upper <span class="ot">&lt;-</span> new_data<span class="sc">$</span>pred <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> predictions<span class="sc">$</span>se.fit</span>
<span id="cb2209-15"><a href="高级回归模型.html#cb2209-15" tabindex="-1"></a></span>
<span id="cb2209-16"><a href="高级回归模型.html#cb2209-16" tabindex="-1"></a><span class="co"># 可视化预测区间</span></span>
<span id="cb2209-17"><a href="高级回归模型.html#cb2209-17" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2209-18"><a href="高级回归模型.html#cb2209-18" tabindex="-1"></a><span class="fu">ggplot</span>(new_data, <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> pred)) <span class="sc">+</span></span>
<span id="cb2209-19"><a href="高级回归模型.html#cb2209-19" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb2209-20"><a href="高级回归模型.html#cb2209-20" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2209-21"><a href="高级回归模型.html#cb2209-21" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2209-22"><a href="高级回归模型.html#cb2209-22" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;温度 (°C)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;预测叶绿素浓度&quot;</span>,</span>
<span id="cb2209-23"><a href="高级回归模型.html#cb2209-23" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;温度对浮游植物生物量的影响（含95%置信区间）&quot;</span></span>
<span id="cb2209-24"><a href="高级回归模型.html#cb2209-24" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2209-25"><a href="高级回归模型.html#cb2209-25" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2
## 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this
## warning was generated.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-5-1.png" alt="温度对浮游植物生物量影响的预测曲线（含95%置信区间）" width="672" />
<p class="caption">
图5.2: 温度对浮游植物生物量影响的预测曲线（含95%置信区间）
</p>
</div>
</div>
<div id="生态学意义验证" class="section level4 hasAnchor" number="10.2.8.5">
<h4><span class="header-section-number">10.2.8.5</span> 生态学意义验证<a href="高级回归模型.html#生态学意义验证" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>最后，模型结果需要在生态学背景下进行验证：</p>
<ol style="list-style-type: decimal">
<li><p><strong>生物学合理性</strong>：平滑函数的形状是否符合已知的生态学知识？例如，温度对浮游植物生长的影响是否呈现单峰曲线？</p></li>
<li><p><strong>效应大小</strong>：预测的环境因子变化是否对应有意义的生态效应？例如，温度变化5°C是否导致叶绿素浓度的显著变化？</p></li>
<li><p><strong>模型稳定性</strong>：移除异常值或使用不同数据子集时，主要结论是否保持不变？</p></li>
<li><p><strong>预测能力</strong>：模型在新地点或新时间点的预测表现如何？</p></li>
</ol>
<p>通过系统的模型诊断和谨慎的结果解释，我们可以确保可加性模型分析为生态学研究提供可靠的科学依据。</p>
</div>
</div>
<div id="可加性模型的优势与局限" class="section level3 hasAnchor" number="10.2.9">
<h3><span class="header-section-number">10.2.9</span> 可加性模型的优势与局限<a href="高级回归模型.html#可加性模型的优势与局限" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>可加性模型在生态学中的主要优势在于其灵活性：它能够自动捕捉数据中的非线性模式，而无需研究者预先指定函数形式。同时，通过<code>mgcv</code>包中的广义交叉验证（GCV）或限制极大似然（REML）方法，模型能够自动选择最优的平滑复杂度，避免过度拟合。</p>
<p>然而，可加性模型也有其局限性：</p>
<ol style="list-style-type: decimal">
<li><strong>可加性假设</strong>：模型假设各变量的效应是可加的，当变量间存在强交互作用时，这一假设可能不成立</li>
<li><strong>解释复杂性</strong>：与线性模型相比，可加性模型的解释更加复杂，需要依赖可视化</li>
<li><strong>计算成本</strong>：对于大数据集，可加性模型的计算成本较高</li>
<li><strong>参数不确定性</strong>：平滑函数的参数不像线性模型那样有明确的统计推断</li>
</ol>
<p>在生态学研究中，可加性模型已广泛应用于环境梯度分析、物种-环境关系建模、时间序列分析等多个领域。它为我们理解复杂的生态关系提供了强大的统计工具，特别是在我们缺乏关于生态过程数学形式的先验知识时，可加性模型的灵活性显得尤为宝贵。</p>
</div>
</div>
<div id="广义线性回归" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> 广义线性回归<a href="高级回归模型.html#广义线性回归" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在生态学研究中，我们经常遇到各种类型的响应数据：物种存在与否（二元数据）、个体数量（计数数据）、生物量比例（比例数据）等。这些数据往往不符合传统线性回归的正态分布假设。广义线性模型（GLM）为解决这一问题提供了系统性的框架，它通过三个核心组件——线性预测项、连接函数和方差函数——将线性模型的思想扩展到非正态分布数据。</p>
<div id="广义线性模型的基本框架" class="section level3 hasAnchor" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> 广义线性模型的基本框架<a href="高级回归模型.html#广义线性模型的基本框架" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>广义线性模型由三个基本部分组成：</p>
<p><strong>线性预测项（Linear Predictor）</strong>：这是模型的核心部分，形式上与普通线性回归相似：</p>
<p><span class="math display">\[\eta = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p\]</span></p>
<p>其中<span class="math inline">\(\eta\)</span>称为线性预测项，<span class="math inline">\(\beta_j\)</span>是回归系数，<span class="math inline">\(x_j\)</span>是预测变量。线性预测项捕捉了预测变量对响应变量的系统性影响。</p>
<p><strong>连接函数（Link Function）</strong>：连接函数<span class="math inline">\(g(\cdot)\)</span>将响应变量的期望值<span class="math inline">\(\mu = E(y)\)</span>与线性预测项连接起来：</p>
<p><span class="math display">\[g(\mu) = \eta\]</span></p>
<p>连接函数的作用是确保预测值落在合理的范围内。例如，对于计数数据，我们使用对数连接函数确保预测值为正数；对于比例数据，我们使用logit连接函数确保预测值在0到1之间。</p>
<p><strong>方差函数（Variance Function）</strong>：方差函数描述了响应变量的方差如何依赖于其均值：</p>
<p><span class="math display">\[Var(y) = \phi V(\mu)\]</span></p>
<p>其中<span class="math inline">\(\phi\)</span>是离散参数，<span class="math inline">\(V(\mu)\)</span>是方差函数。不同的分布类型对应不同的方差函数，这反映了不同类型数据的变异性特征。</p>
</div>
<div id="与普通线性回归的根本区别" class="section level3 hasAnchor" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> 与普通线性回归的根本区别<a href="高级回归模型.html#与普通线性回归的根本区别" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>广义线性模型与普通线性回归在多个方面存在根本性的区别：</p>
<p><strong>分布假设</strong>：普通线性回归假设响应变量服从正态分布，而广义线性模型可以处理多种分布类型，包括二项分布、泊松分布、负二项分布、伽马分布等。</p>
<p><strong>连接函数</strong>：普通线性回归使用恒等连接函数<span class="math inline">\(g(\mu) = \mu\)</span>，而广义线性模型根据数据特性选择适当的连接函数。</p>
<p><strong>方差结构</strong>：普通线性回归假设方差恒定，而广义线性模型允许方差依赖于均值，这更符合生态数据的实际情况。</p>
<p><strong>参数估计</strong>：普通线性回归使用最小二乘法估计参数，而广义线性模型使用迭代加权最小二乘法进行最大似然估计。</p>
</div>
<div id="r语言中的glm实现" class="section level3 hasAnchor" number="10.3.3">
<h3><span class="header-section-number">10.3.3</span> R语言中的GLM实现<a href="高级回归模型.html#r语言中的glm实现" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在R语言中，广义线性模型主要通过<code>glm()</code>函数实现，其基本语法为：</p>
<div class="sourceCode" id="cb2211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2211-1"><a href="高级回归模型.html#cb2211-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(formula, <span class="at">family =</span> <span class="fu">family</span>(<span class="at">link =</span> <span class="st">&quot;link_function&quot;</span>), <span class="at">data =</span> dataset)</span></code></pre></div>
<p><strong>主要参数说明：</strong></p>
<ul>
<li><code>formula</code>：模型公式，格式为<code>y ~ x1 + x2 + x3</code>，其中<code>y</code>是响应变量，<code>x1, x2, x3</code>是预测变量</li>
<li><code>family</code>：指定响应变量的分布类型和连接函数，这是GLM的核心参数</li>
<li><code>data</code>：包含变量的数据框</li>
</ul>
<p><strong>常用的family选项：</strong></p>
<ul>
<li><code>binomial(link = "logit")</code>：二项分布，logit连接函数（逻辑回归）</li>
<li><code>poisson(link = "log")</code>：泊松分布，对数连接函数（泊松回归）</li>
<li><code>gaussian(link = "identity")</code>：正态分布，恒等连接函数（普通线性回归）</li>
<li><code>Gamma(link = "inverse")</code>：伽马分布，逆连接函数</li>
<li><code>quasipoisson(link = "log")</code>：拟泊松分布，处理过离散计数数据</li>
</ul>
<p><strong>模型结果解读：</strong></p>
<p>使用<code>summary()</code>函数查看模型摘要，重点关注： - 系数估计值（Estimate）及其显著性（Pr(&gt;|z|)） - 零偏差（Null deviance）和残差偏差（Residual deviance） - AIC值（用于模型比较）</p>
<p><strong>模型诊断：</strong></p>
<ul>
<li><code>plot(model)</code>：生成模型诊断图</li>
<li><code>residuals(model)</code>：获取残差</li>
<li><code>predict(model, type = "response")</code>：获取预测值</li>
</ul>
</div>
<div id="常见glm类型及其生态学应用" class="section level3 hasAnchor" number="10.3.4">
<h3><span class="header-section-number">10.3.4</span> 常见GLM类型及其生态学应用<a href="高级回归模型.html#常见glm类型及其生态学应用" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="逻辑回归logistic-regression" class="section level4 hasAnchor" number="10.3.4.1">
<h4><span class="header-section-number">10.3.4.1</span> 逻辑回归（Logistic Regression）<a href="高级回归模型.html#逻辑回归logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>逻辑回归适用于二元响应变量，如物种存在与否、个体存活死亡等。使用logit连接函数将概率映射到线性预测项：</p>
<p><span class="math display">\[g(\mu) = \log\left(\frac{\mu}{1-\mu}\right) = \eta\]</span></p>
<p><strong>为什么选择logit连接函数？</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>概率范围约束</strong>：二元数据的概率必须在0到1之间。logit函数将(0,1)区间映射到整个实数轴(-∞,+∞)，确保线性预测项<span class="math inline">\(\eta\)</span>可以取任意值，而预测的概率始终在合理范围内。</p></li>
<li><p><strong>生物学合理性</strong>：logit函数具有S形曲线的特性，这符合许多生态过程的响应模式。例如，物种对环境因子的响应通常存在阈值效应：在某个阈值以下影响微弱，在适宜范围内影响显著，在极端条件下影响又减弱。</p></li>
<li><p><strong>可解释性</strong>：logit函数的系数可以解释为优势比的对数，这在生态学中具有直观意义。例如，温度系数为0.1意味着温度每升高1°C，物种出现的优势（出现概率/不出现概率）增加exp(0.1)≈1.105倍。</p></li>
<li><p><strong>数学性质</strong>：logit函数是对称的，即<span class="math inline">\(g(p) = -g(1-p)\)</span>，这符合许多生态过程的对称性假设。</p></li>
</ol>
<p>方差函数为<span class="math inline">\(V(\mu) = \mu(1-\mu)\)</span>，反映了二元数据的变异性特征：当概率接近0或1时，方差很小；当概率接近0.5时，方差最大。在生态学中，逻辑回归常用于物种分布模型、栖息地适宜性分析等。</p>
<div class="sourceCode" id="cb2212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2212-1"><a href="高级回归模型.html#cb2212-1" tabindex="-1"></a><span class="co"># 逻辑回归示例：研究环境因子对物种出现概率的影响</span></span>
<span id="cb2212-2"><a href="高级回归模型.html#cb2212-2" tabindex="-1"></a><span class="co"># 模拟生态学数据：物种出现与环境因子的关系</span></span>
<span id="cb2212-3"><a href="高级回归模型.html#cb2212-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2212-4"><a href="高级回归模型.html#cb2212-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb2212-5"><a href="高级回归模型.html#cb2212-5" tabindex="-1"></a>species_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2212-6"><a href="高级回归模型.html#cb2212-6" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">runif</span>(n, <span class="dv">5</span>, <span class="dv">30</span>), <span class="co"># 温度(°C)</span></span>
<span id="cb2212-7"><a href="高级回归模型.html#cb2212-7" tabindex="-1"></a>  <span class="at">precipitation =</span> <span class="fu">runif</span>(n, <span class="dv">500</span>, <span class="dv">2000</span>), <span class="co"># 降水量(mm)</span></span>
<span id="cb2212-8"><a href="高级回归模型.html#cb2212-8" tabindex="-1"></a>  <span class="at">habitat_quality =</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># 栖息地质量指数</span></span>
<span id="cb2212-9"><a href="高级回归模型.html#cb2212-9" tabindex="-1"></a>)</span>
<span id="cb2212-10"><a href="高级回归模型.html#cb2212-10" tabindex="-1"></a></span>
<span id="cb2212-11"><a href="高级回归模型.html#cb2212-11" tabindex="-1"></a><span class="co"># 模拟物种出现概率（使用logit连接函数）</span></span>
<span id="cb2212-12"><a href="高级回归模型.html#cb2212-12" tabindex="-1"></a>linear_predictor <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> species_data<span class="sc">$</span>temperature <span class="sc">+</span></span>
<span id="cb2212-13"><a href="高级回归模型.html#cb2212-13" tabindex="-1"></a>  <span class="fl">0.002</span> <span class="sc">*</span> species_data<span class="sc">$</span>precipitation <span class="sc">+</span></span>
<span id="cb2212-14"><a href="高级回归模型.html#cb2212-14" tabindex="-1"></a>  <span class="dv">3</span> <span class="sc">*</span> species_data<span class="sc">$</span>habitat_quality</span>
<span id="cb2212-15"><a href="高级回归模型.html#cb2212-15" tabindex="-1"></a>probability <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>linear_predictor))</span>
<span id="cb2212-16"><a href="高级回归模型.html#cb2212-16" tabindex="-1"></a>species_data<span class="sc">$</span>presence <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, probability)</span>
<span id="cb2212-17"><a href="高级回归模型.html#cb2212-17" tabindex="-1"></a></span>
<span id="cb2212-18"><a href="高级回归模型.html#cb2212-18" tabindex="-1"></a><span class="co"># 构建逻辑回归模型</span></span>
<span id="cb2212-19"><a href="高级回归模型.html#cb2212-19" tabindex="-1"></a>logistic_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(presence <span class="sc">~</span> temperature <span class="sc">+</span> precipitation <span class="sc">+</span> habitat_quality,</span>
<span id="cb2212-20"><a href="高级回归模型.html#cb2212-20" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>),</span>
<span id="cb2212-21"><a href="高级回归模型.html#cb2212-21" tabindex="-1"></a>  <span class="at">data =</span> species_data</span>
<span id="cb2212-22"><a href="高级回归模型.html#cb2212-22" tabindex="-1"></a>)</span>
<span id="cb2212-23"><a href="高级回归模型.html#cb2212-23" tabindex="-1"></a></span>
<span id="cb2212-24"><a href="高级回归模型.html#cb2212-24" tabindex="-1"></a><span class="co"># 模型摘要和系数解释</span></span>
<span id="cb2212-25"><a href="高级回归模型.html#cb2212-25" tabindex="-1"></a><span class="fu">summary</span>(logistic_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = presence ~ temperature + precipitation + habitat_quality, 
##     family = binomial(link = &quot;logit&quot;), data = species_data)
## 
## Coefficients:
##                 Estimate Std. Error z value Pr(&gt;|z|)  
## (Intercept)     0.060100   1.534361   0.039   0.9688  
## temperature     0.041681   0.056759   0.734   0.4627  
## precipitation   0.001811   0.001056   1.715   0.0863 .
## habitat_quality 1.266257   1.331488   0.951   0.3416  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 60.686  on 199  degrees of freedom
## Residual deviance: 55.846  on 196  degrees of freedom
## AIC: 63.846
## 
## Number of Fisher Scoring iterations: 7</code></pre>
<div class="sourceCode" id="cb2214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2214-1"><a href="高级回归模型.html#cb2214-1" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(logistic_model)) <span class="co"># 获得优势比</span></span></code></pre></div>
<pre><code>##     (Intercept)     temperature   precipitation habitat_quality 
##        1.061943        1.042562        1.001813        3.547548</code></pre>
</div>
<div id="泊松回归poisson-regression" class="section level4 hasAnchor" number="10.3.4.2">
<h4><span class="header-section-number">10.3.4.2</span> 泊松回归（Poisson Regression）<a href="高级回归模型.html#泊松回归poisson-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>泊松回归适用于计数数据，如物种个体数、捕获次数等。使用对数连接函数确保预测值为正数：</p>
<p><span class="math display">\[g(\mu) = \log(\mu) = \eta\]</span></p>
<p><strong>为什么选择对数连接函数？</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>正值约束</strong>：计数数据必须是非负整数（0,1,2,…）。对数函数将(0,+∞)区间映射到整个实数轴(-∞,+∞)，确保线性预测项<span class="math inline">\(\eta\)</span>可以取任意值，而预测的计数值始终为正数。</p></li>
<li><p><strong>乘法效应</strong>：对数连接函数对应于乘法效应而非加法效应。这在生态学中通常更合理，因为环境因子的变化往往导致物种数量的比例变化而非绝对变化。例如，温度升高1°C可能使物种数量增加10%，而不是固定增加2个个体。</p></li>
<li><p><strong>生物学机制</strong>：许多生态过程本质上是乘性的。例如，种群增长通常是指数增长，资源利用效率通常与资源可用性成比例关系。对数连接函数能够自然地描述这些过程。</p></li>
<li><p><strong>方差结构</strong>：泊松分布的方差等于均值，这反映了计数数据的典型特征：当均值较大时，变异性也较大。对数连接函数与这种方差结构相协调。</p></li>
</ol>
<p>方差函数为<span class="math inline">\(V(\mu) = \mu\)</span>，假设均值和方差相等。这在生态计数数据中往往不成立，导致过度离散问题。</p>
<div class="sourceCode" id="cb2216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2216-1"><a href="高级回归模型.html#cb2216-1" tabindex="-1"></a><span class="co"># 泊松回归示例：研究环境因子对物种丰富度的影响</span></span>
<span id="cb2216-2"><a href="高级回归模型.html#cb2216-2" tabindex="-1"></a><span class="co"># 模拟生态学数据：物种丰富度与环境因子的关系</span></span>
<span id="cb2216-3"><a href="高级回归模型.html#cb2216-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2216-4"><a href="高级回归模型.html#cb2216-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb2216-5"><a href="高级回归模型.html#cb2216-5" tabindex="-1"></a>richness_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2216-6"><a href="高级回归模型.html#cb2216-6" tabindex="-1"></a>  <span class="at">elevation =</span> <span class="fu">runif</span>(n, <span class="dv">100</span>, <span class="dv">3000</span>), <span class="co"># 海拔(m)</span></span>
<span id="cb2216-7"><a href="高级回归模型.html#cb2216-7" tabindex="-1"></a>  <span class="at">vegetation_diversity =</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">10</span>) <span class="co"># 植被多样性指数</span></span>
<span id="cb2216-8"><a href="高级回归模型.html#cb2216-8" tabindex="-1"></a>)</span>
<span id="cb2216-9"><a href="高级回归模型.html#cb2216-9" tabindex="-1"></a></span>
<span id="cb2216-10"><a href="高级回归模型.html#cb2216-10" tabindex="-1"></a><span class="co"># 模拟物种丰富度（使用对数连接函数）</span></span>
<span id="cb2216-11"><a href="高级回归模型.html#cb2216-11" tabindex="-1"></a>linear_predictor <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.001</span> <span class="sc">*</span> richness_data<span class="sc">$</span>elevation <span class="sc">-</span></span>
<span id="cb2216-12"><a href="高级回归模型.html#cb2216-12" tabindex="-1"></a>  <span class="fl">0.0000001</span> <span class="sc">*</span> richness_data<span class="sc">$</span>elevation<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb2216-13"><a href="高级回归模型.html#cb2216-13" tabindex="-1"></a>  <span class="fl">0.3</span> <span class="sc">*</span> richness_data<span class="sc">$</span>vegetation_diversity</span>
<span id="cb2216-14"><a href="高级回归模型.html#cb2216-14" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">exp</span>(linear_predictor)</span>
<span id="cb2216-15"><a href="高级回归模型.html#cb2216-15" tabindex="-1"></a>richness_data<span class="sc">$</span>species_count <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda)</span>
<span id="cb2216-16"><a href="高级回归模型.html#cb2216-16" tabindex="-1"></a></span>
<span id="cb2216-17"><a href="高级回归模型.html#cb2216-17" tabindex="-1"></a><span class="co"># 构建泊松回归模型</span></span>
<span id="cb2216-18"><a href="高级回归模型.html#cb2216-18" tabindex="-1"></a>poisson_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(species_count <span class="sc">~</span> elevation <span class="sc">+</span> <span class="fu">I</span>(elevation<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> vegetation_diversity,</span>
<span id="cb2216-19"><a href="高级回归模型.html#cb2216-19" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb2216-20"><a href="高级回归模型.html#cb2216-20" tabindex="-1"></a>  <span class="at">data =</span> richness_data</span>
<span id="cb2216-21"><a href="高级回归模型.html#cb2216-21" tabindex="-1"></a>)</span>
<span id="cb2216-22"><a href="高级回归模型.html#cb2216-22" tabindex="-1"></a></span>
<span id="cb2216-23"><a href="高级回归模型.html#cb2216-23" tabindex="-1"></a><span class="co"># 模型摘要和过度离散检查</span></span>
<span id="cb2216-24"><a href="高级回归模型.html#cb2216-24" tabindex="-1"></a><span class="fu">summary</span>(poisson_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = species_count ~ elevation + I(elevation^2) + vegetation_diversity, 
##     family = poisson(link = &quot;log&quot;), data = richness_data)
## 
## Coefficients:
##                        Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)           1.992e+00  3.835e-02  51.953  &lt; 2e-16 ***
## elevation             9.720e-04  3.841e-05  25.305  &lt; 2e-16 ***
## I(elevation^2)       -8.723e-08  1.065e-08  -8.192 2.58e-16 ***
## vegetation_diversity  3.003e-01  2.702e-03 111.108  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 19850.6  on 149  degrees of freedom
## Residual deviance:   147.9  on 146  degrees of freedom
## AIC: 1162.6
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb2218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2218-1"><a href="高级回归模型.html#cb2218-1" tabindex="-1"></a><span class="fu">library</span>(AER)</span></code></pre></div>
<pre><code>## Loading required package: car</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## Loading required package: lmtest</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<div class="sourceCode" id="cb2227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2227-1"><a href="高级回归模型.html#cb2227-1" tabindex="-1"></a><span class="fu">dispersiontest</span>(poisson_model)</span></code></pre></div>
<pre><code>## 
##  Overdispersion test
## 
## data:  poisson_model
## z = -0.099863, p-value = 0.5398
## alternative hypothesis: true dispersion is greater than 1
## sample estimates:
## dispersion 
##  0.9896964</code></pre>
</div>
<div id="负二项回归negative-binomial-regression" class="section level4 hasAnchor" number="10.3.4.3">
<h4><span class="header-section-number">10.3.4.3</span> 负二项回归（Negative Binomial Regression）<a href="高级回归模型.html#负二项回归negative-binomial-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>负二项回归适用于过度离散的计数数据，即方差大于均值的情况。同样使用对数连接函数，但方差函数为<span class="math inline">\(V(\mu) = \mu + \alpha\mu^2\)</span>，其中<span class="math inline">\(\alpha\)</span>是过度离散参数。</p>
<p><strong>为什么同样选择对数连接函数？</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>保持一致性</strong>：负二项回归是泊松回归的扩展，使用相同的对数连接函数保持了模型解释的一致性。系数仍然可以解释为发生率比的对数。</p></li>
<li><p><strong>正值约束</strong>：与泊松回归相同，对数连接函数确保预测的计数值始终为正数，这符合计数数据的本质特征。</p></li>
<li><p><strong>生态学合理性</strong>：生态计数数据中的过度离散往往源于未观测的异质性（如个体差异、空间变异等），而非连接函数选择的问题。对数连接函数仍然能够描述环境因子对物种数量的乘法效应。</p></li>
<li><p><strong>模型比较</strong>：使用相同的连接函数便于与泊松回归模型进行比较，从而判断过度离散的程度和是否需要使用负二项回归。</p></li>
</ol>
<p>负二项回归能够更好地处理生态计数数据中常见的过度离散现象，其方差函数<span class="math inline">\(V(\mu) = \mu + \alpha\mu^2\)</span>允许方差随均值二次增长，这更符合生态数据的实际变异性特征。</p>
<div class="sourceCode" id="cb2229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2229-1"><a href="高级回归模型.html#cb2229-1" tabindex="-1"></a><span class="co"># 负二项回归示例：处理过度离散的物种丰富度数据</span></span>
<span id="cb2229-2"><a href="高级回归模型.html#cb2229-2" tabindex="-1"></a><span class="co"># 如果泊松回归显示过度离散，使用负二项回归</span></span>
<span id="cb2229-3"><a href="高级回归模型.html#cb2229-3" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb2229-4"><a href="高级回归模型.html#cb2229-4" tabindex="-1"></a>nb_model <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(species_count <span class="sc">~</span> elevation <span class="sc">+</span> <span class="fu">I</span>(elevation<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> vegetation_diversity,</span>
<span id="cb2229-5"><a href="高级回归模型.html#cb2229-5" tabindex="-1"></a>  <span class="at">data =</span> richness_data</span>
<span id="cb2229-6"><a href="高级回归模型.html#cb2229-6" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
## control$trace &gt; : iteration limit reached
## Warning in theta.ml(Y, mu, sum(w), w, limit = control$maxit, trace =
## control$trace &gt; : iteration limit reached</code></pre>
<div class="sourceCode" id="cb2231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2231-1"><a href="高级回归模型.html#cb2231-1" tabindex="-1"></a><span class="co"># 模型摘要和比较</span></span>
<span id="cb2231-2"><a href="高级回归模型.html#cb2231-2" tabindex="-1"></a><span class="fu">summary</span>(nb_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = species_count ~ elevation + I(elevation^2) + 
##     vegetation_diversity, data = richness_data, init.theta = 1221501.982, 
##     link = log)
## 
## Coefficients:
##                        Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)           1.992e+00  3.835e-02   51.95  &lt; 2e-16 ***
## elevation             9.720e-04  3.842e-05   25.30  &lt; 2e-16 ***
## I(elevation^2)       -8.723e-08  1.065e-08   -8.19  2.6e-16 ***
## vegetation_diversity  3.003e-01  2.703e-03  111.09  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(1221502) family taken to be 1)
## 
##     Null deviance: 19846.73  on 149  degrees of freedom
## Residual deviance:   147.88  on 146  degrees of freedom
## AIC: 1164.6
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  1221502 
##           Std. Err.:  13919710 
## Warning while fitting theta: iteration limit reached 
## 
##  2 x log-likelihood:  -1154.63</code></pre>
<div class="sourceCode" id="cb2233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2233-1"><a href="高级回归模型.html#cb2233-1" tabindex="-1"></a><span class="fu">AIC</span>(poisson_model, nb_model)</span></code></pre></div>
<pre><code>##               df      AIC
## poisson_model  4 1162.628
## nb_model       5 1164.630</code></pre>
</div>
<div id="比例数据回归proportional-data-regression" class="section level4 hasAnchor" number="10.3.4.4">
<h4><span class="header-section-number">10.3.4.4</span> 比例数据回归（Proportional Data Regression）<a href="高级回归模型.html#比例数据回归proportional-data-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>比例数据回归适用于比例或百分比数据，如物种存活率、种子萌发率、植被覆盖率等。使用二项分布和logit连接函数，但需要指定试验次数（分母）：</p>
<p><span class="math display">\[g(\mu) = \log\left(\frac{\mu}{1-\mu}\right) = \eta\]</span></p>
<p><strong>为什么选择二项分布和logit连接函数？</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>比例范围约束</strong>：比例数据必须在0到1之间。logit函数将(0,1)区间映射到整个实数轴，确保线性预测项<span class="math inline">\(\eta\)</span>可以取任意值，而预测的比例始终在合理范围内。</p></li>
<li><p><strong>数据生成过程</strong>：比例数据通常来自二项过程，如n次试验中成功的次数。二项分布自然地描述了这种数据生成机制。</p></li>
<li><p><strong>方差结构</strong>：二项分布的方差为<span class="math inline">\(V(\mu) = \mu(1-\mu)/n\)</span>，反映了比例数据的典型特征：当比例接近0.5时方差最大，当接近0或1时方差最小。</p></li>
<li><p><strong>生态学应用</strong>：在生态学中，比例数据常见于存活率研究、资源利用效率、栖息地选择等场景。</p></li>
</ol>
<div class="sourceCode" id="cb2235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2235-1"><a href="高级回归模型.html#cb2235-1" tabindex="-1"></a><span class="co"># 比例数据回归示例：研究环境因子对植物存活率的影响</span></span>
<span id="cb2235-2"><a href="高级回归模型.html#cb2235-2" tabindex="-1"></a><span class="co"># 模拟生态学数据：植物存活率与环境因子的关系</span></span>
<span id="cb2235-3"><a href="高级回归模型.html#cb2235-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2235-4"><a href="高级回归模型.html#cb2235-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb2235-5"><a href="高级回归模型.html#cb2235-5" tabindex="-1"></a>plant_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2235-6"><a href="高级回归模型.html#cb2235-6" tabindex="-1"></a>  <span class="at">soil_moisture =</span> <span class="fu">runif</span>(n, <span class="fl">0.1</span>, <span class="fl">0.8</span>), <span class="co"># 土壤湿度(比例)</span></span>
<span id="cb2235-7"><a href="高级回归模型.html#cb2235-7" tabindex="-1"></a>  <span class="at">light_intensity =</span> <span class="fu">runif</span>(n, <span class="dv">100</span>, <span class="dv">2000</span>), <span class="co"># 光照强度(μmol/m²/s)</span></span>
<span id="cb2235-8"><a href="高级回归模型.html#cb2235-8" tabindex="-1"></a>  <span class="at">competition =</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># 竞争强度指数</span></span>
<span id="cb2235-9"><a href="高级回归模型.html#cb2235-9" tabindex="-1"></a>)</span>
<span id="cb2235-10"><a href="高级回归模型.html#cb2235-10" tabindex="-1"></a></span>
<span id="cb2235-11"><a href="高级回归模型.html#cb2235-11" tabindex="-1"></a><span class="co"># 模拟植物存活率（使用logit连接函数）</span></span>
<span id="cb2235-12"><a href="高级回归模型.html#cb2235-12" tabindex="-1"></a>linear_predictor <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> plant_data<span class="sc">$</span>soil_moisture <span class="sc">+</span></span>
<span id="cb2235-13"><a href="高级回归模型.html#cb2235-13" tabindex="-1"></a>  <span class="fl">0.001</span> <span class="sc">*</span> plant_data<span class="sc">$</span>light_intensity <span class="sc">-</span></span>
<span id="cb2235-14"><a href="高级回归模型.html#cb2235-14" tabindex="-1"></a>  <span class="fl">1.5</span> <span class="sc">*</span> plant_data<span class="sc">$</span>competition</span>
<span id="cb2235-15"><a href="高级回归模型.html#cb2235-15" tabindex="-1"></a>probability <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>linear_predictor))</span>
<span id="cb2235-16"><a href="高级回归模型.html#cb2235-16" tabindex="-1"></a></span>
<span id="cb2235-17"><a href="高级回归模型.html#cb2235-17" tabindex="-1"></a><span class="co"># 模拟二项数据：假设每个样方有50株植物</span></span>
<span id="cb2235-18"><a href="高级回归模型.html#cb2235-18" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb2235-19"><a href="高级回归模型.html#cb2235-19" tabindex="-1"></a>plant_data<span class="sc">$</span>survived <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, n_trials, probability)</span>
<span id="cb2235-20"><a href="高级回归模型.html#cb2235-20" tabindex="-1"></a>plant_data<span class="sc">$</span>total <span class="ot">&lt;-</span> n_trials</span>
<span id="cb2235-21"><a href="高级回归模型.html#cb2235-21" tabindex="-1"></a></span>
<span id="cb2235-22"><a href="高级回归模型.html#cb2235-22" tabindex="-1"></a><span class="co"># 构建比例数据回归模型</span></span>
<span id="cb2235-23"><a href="高级回归模型.html#cb2235-23" tabindex="-1"></a><span class="co"># 使用cbind(成功数, 失败数)作为响应变量</span></span>
<span id="cb2235-24"><a href="高级回归模型.html#cb2235-24" tabindex="-1"></a>proportion_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb2235-25"><a href="高级回归模型.html#cb2235-25" tabindex="-1"></a>  <span class="fu">cbind</span>(survived, total <span class="sc">-</span> survived) <span class="sc">~</span></span>
<span id="cb2235-26"><a href="高级回归模型.html#cb2235-26" tabindex="-1"></a>    soil_moisture <span class="sc">+</span> light_intensity <span class="sc">+</span> competition,</span>
<span id="cb2235-27"><a href="高级回归模型.html#cb2235-27" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>),</span>
<span id="cb2235-28"><a href="高级回归模型.html#cb2235-28" tabindex="-1"></a>  <span class="at">data =</span> plant_data</span>
<span id="cb2235-29"><a href="高级回归模型.html#cb2235-29" tabindex="-1"></a>)</span>
<span id="cb2235-30"><a href="高级回归模型.html#cb2235-30" tabindex="-1"></a></span>
<span id="cb2235-31"><a href="高级回归模型.html#cb2235-31" tabindex="-1"></a><span class="co"># 模型摘要和系数解释</span></span>
<span id="cb2235-32"><a href="高级回归模型.html#cb2235-32" tabindex="-1"></a><span class="fu">summary</span>(proportion_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cbind(survived, total - survived) ~ soil_moisture + 
##     light_intensity + competition, family = binomial(link = &quot;logit&quot;), 
##     data = plant_data)
## 
## Coefficients:
##                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     -8.957e-01  1.223e-01  -7.321 2.46e-13 ***
## soil_moisture    1.860e+00  1.588e-01  11.710  &lt; 2e-16 ***
## light_intensity  1.054e-03  6.474e-05  16.285  &lt; 2e-16 ***
## competition     -1.610e+00  1.060e-01 -15.187  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 800.86  on 99  degrees of freedom
## Residual deviance: 111.10  on 96  degrees of freedom
## AIC: 535.72
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode" id="cb2237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2237-1"><a href="高级回归模型.html#cb2237-1" tabindex="-1"></a><span class="co"># 预测新数据</span></span>
<span id="cb2237-2"><a href="高级回归模型.html#cb2237-2" tabindex="-1"></a>new_moisture <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2237-3"><a href="高级回归模型.html#cb2237-3" tabindex="-1"></a>  <span class="at">soil_moisture =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>, <span class="at">length =</span> <span class="dv">50</span>),</span>
<span id="cb2237-4"><a href="高级回归模型.html#cb2237-4" tabindex="-1"></a>  <span class="at">light_intensity =</span> <span class="fu">mean</span>(plant_data<span class="sc">$</span>light_intensity),</span>
<span id="cb2237-5"><a href="高级回归模型.html#cb2237-5" tabindex="-1"></a>  <span class="at">competition =</span> <span class="fu">mean</span>(plant_data<span class="sc">$</span>competition)</span>
<span id="cb2237-6"><a href="高级回归模型.html#cb2237-6" tabindex="-1"></a>)</span>
<span id="cb2237-7"><a href="高级回归模型.html#cb2237-7" tabindex="-1"></a></span>
<span id="cb2237-8"><a href="高级回归模型.html#cb2237-8" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(proportion_model,</span>
<span id="cb2237-9"><a href="高级回归模型.html#cb2237-9" tabindex="-1"></a>  <span class="at">newdata =</span> new_moisture,</span>
<span id="cb2237-10"><a href="高级回归模型.html#cb2237-10" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span></span>
<span id="cb2237-11"><a href="高级回归模型.html#cb2237-11" tabindex="-1"></a>)</span>
<span id="cb2237-12"><a href="高级回归模型.html#cb2237-12" tabindex="-1"></a>new_moisture<span class="sc">$</span>pred <span class="ot">&lt;-</span> predictions<span class="sc">$</span>fit</span>
<span id="cb2237-13"><a href="高级回归模型.html#cb2237-13" tabindex="-1"></a>new_moisture<span class="sc">$</span>se <span class="ot">&lt;-</span> predictions<span class="sc">$</span>se.fit</span>
<span id="cb2237-14"><a href="高级回归模型.html#cb2237-14" tabindex="-1"></a></span>
<span id="cb2237-15"><a href="高级回归模型.html#cb2237-15" tabindex="-1"></a><span class="co"># 可视化预测结果</span></span>
<span id="cb2237-16"><a href="高级回归模型.html#cb2237-16" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2237-17"><a href="高级回归模型.html#cb2237-17" tabindex="-1"></a><span class="fu">ggplot</span>(new_moisture, <span class="fu">aes</span>(<span class="at">x =</span> soil_moisture, <span class="at">y =</span> pred)) <span class="sc">+</span></span>
<span id="cb2237-18"><a href="高级回归模型.html#cb2237-18" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> pred <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> se, <span class="at">ymax =</span> pred <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> se), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb2237-19"><a href="高级回归模型.html#cb2237-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2237-20"><a href="高级回归模型.html#cb2237-20" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2237-21"><a href="高级回归模型.html#cb2237-21" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;土壤湿度&quot;</span>, <span class="at">y =</span> <span class="st">&quot;预测存活率&quot;</span>,</span>
<span id="cb2237-22"><a href="高级回归模型.html#cb2237-22" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;土壤湿度对植物存活率的影响（含95%置信区间）&quot;</span></span>
<span id="cb2237-23"><a href="高级回归模型.html#cb2237-23" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2237-24"><a href="高级回归模型.html#cb2237-24" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2237-25"><a href="高级回归模型.html#cb2237-25" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-9"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-9-1.png" alt="土壤湿度对植物存活率影响的预测曲线（含95%置信区间）" width="672" />
<p class="caption">
图2.6: 土壤湿度对植物存活率影响的预测曲线（含95%置信区间）
</p>
</div>
<div class="sourceCode" id="cb2238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2238-1"><a href="高级回归模型.html#cb2238-1" tabindex="-1"></a><span class="co"># 系数解释：优势比</span></span>
<span id="cb2238-2"><a href="高级回归模型.html#cb2238-2" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(proportion_model))</span></code></pre></div>
<pre><code>##     (Intercept)   soil_moisture light_intensity     competition 
##       0.4083398       6.4219952       1.0010549       0.1999092</code></pre>
<div class="sourceCode" id="cb2240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2240-1"><a href="高级回归模型.html#cb2240-1" tabindex="-1"></a><span class="co"># 解释示例：土壤湿度系数为2</span></span>
<span id="cb2240-2"><a href="高级回归模型.html#cb2240-2" tabindex="-1"></a><span class="co"># 优势比 = exp(2) ≈ 7.39</span></span>
<span id="cb2240-3"><a href="高级回归模型.html#cb2240-3" tabindex="-1"></a><span class="co"># 解释：土壤湿度每增加0.1单位，植物存活的优势增加约7.39倍</span></span></code></pre></div>
</div>
</div>
<div id="模型诊断与解释" class="section level3 hasAnchor" number="10.3.5">
<h3><span class="header-section-number">10.3.5</span> 模型诊断与解释<a href="高级回归模型.html#模型诊断与解释" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>广义线性模型的诊断与解释是确保模型可靠性和结果有效性的关键步骤。与普通线性回归不同，GLM的诊断需要考虑分布假设、连接函数选择以及过度离散等特殊问题。</p>
<div id="残差诊断-1" class="section level4 hasAnchor" number="10.3.5.1">
<h4><span class="header-section-number">10.3.5.1</span> 残差诊断<a href="高级回归模型.html#残差诊断-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>广义线性模型的残差诊断需要根据具体的分布类型选择适当的残差类型。常用的残差类型包括：</p>
<p><strong>皮尔逊残差（Pearson Residuals）</strong>：标准化残差，定义为观测值与拟合值之差除以标准差估计值。皮尔逊残差应该近似服从标准正态分布，其平方和等于皮尔逊卡方统计量。</p>
<p><strong>偏差残差（Deviance Residuals）</strong>：基于模型偏差的残差，反映了每个观测值对总偏差的贡献。偏差残差在模型正确时应该近似服从标准正态分布。</p>
<p><strong>工作残差（Working Residuals）</strong>：在迭代加权最小二乘算法中使用的残差，通常用于诊断连接函数是否合适。</p>
<div class="sourceCode" id="cb2241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2241-1"><a href="高级回归模型.html#cb2241-1" tabindex="-1"></a><span class="co"># 残差诊断示例</span></span>
<span id="cb2241-2"><a href="高级回归模型.html#cb2241-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb2241-3"><a href="高级回归模型.html#cb2241-3" tabindex="-1"></a></span>
<span id="cb2241-4"><a href="高级回归模型.html#cb2241-4" tabindex="-1"></a><span class="co"># 残差与拟合值图</span></span>
<span id="cb2241-5"><a href="高级回归模型.html#cb2241-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(logistic_model), <span class="fu">residuals</span>(logistic_model, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>),</span>
<span id="cb2241-6"><a href="高级回归模型.html#cb2241-6" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;拟合值&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;皮尔逊残差&quot;</span>,</span>
<span id="cb2241-7"><a href="高级回归模型.html#cb2241-7" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;残差 vs 拟合值&quot;</span></span>
<span id="cb2241-8"><a href="高级回归模型.html#cb2241-8" tabindex="-1"></a>)</span>
<span id="cb2241-9"><a href="高级回归模型.html#cb2241-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb2241-10"><a href="高级回归模型.html#cb2241-10" tabindex="-1"></a></span>
<span id="cb2241-11"><a href="高级回归模型.html#cb2241-11" tabindex="-1"></a><span class="co"># Q-Q图检查正态性</span></span>
<span id="cb2241-12"><a href="高级回归模型.html#cb2241-12" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(logistic_model, <span class="at">type =</span> <span class="st">&quot;deviance&quot;</span>))</span>
<span id="cb2241-13"><a href="高级回归模型.html#cb2241-13" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(logistic_model, <span class="at">type =</span> <span class="st">&quot;deviance&quot;</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb2241-14"><a href="高级回归模型.html#cb2241-14" tabindex="-1"></a></span>
<span id="cb2241-15"><a href="高级回归模型.html#cb2241-15" tabindex="-1"></a><span class="co"># 尺度-位置图</span></span>
<span id="cb2241-16"><a href="高级回归模型.html#cb2241-16" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(logistic_model), <span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">residuals</span>(logistic_model, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>))),</span>
<span id="cb2241-17"><a href="高级回归模型.html#cb2241-17" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;拟合值&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;标准化残差的平方根&quot;</span>,</span>
<span id="cb2241-18"><a href="高级回归模型.html#cb2241-18" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;尺度-位置图&quot;</span></span>
<span id="cb2241-19"><a href="高级回归模型.html#cb2241-19" tabindex="-1"></a>)</span>
<span id="cb2241-20"><a href="高级回归模型.html#cb2241-20" tabindex="-1"></a></span>
<span id="cb2241-21"><a href="高级回归模型.html#cb2241-21" tabindex="-1"></a><span class="co"># 残差与杠杆值图</span></span>
<span id="cb2241-22"><a href="高级回归模型.html#cb2241-22" tabindex="-1"></a><span class="fu">plot</span>(logistic_model, <span class="at">which =</span> <span class="dv">5</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-10-1.png" alt="逻辑回归模型残差诊断图" width="672" />
<p class="caption">
图10.5: 逻辑回归模型残差诊断图
</p>
</div>
</div>
<div id="过度离散诊断" class="section level4 hasAnchor" number="10.3.5.2">
<h4><span class="header-section-number">10.3.5.2</span> 过度离散诊断<a href="高级回归模型.html#过度离散诊断" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>过度离散是生态计数数据中常见的问题，表现为实际方差大于理论方差。对于泊松回归，过度离散会导致标准误被低估，从而产生过于乐观的统计显著性。</p>
<p><strong>过度离散检验</strong>：</p>
<div class="sourceCode" id="cb2242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2242-1"><a href="高级回归模型.html#cb2242-1" tabindex="-1"></a><span class="co"># 泊松回归的过度离散检验</span></span>
<span id="cb2242-2"><a href="高级回归模型.html#cb2242-2" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb2242-3"><a href="高级回归模型.html#cb2242-3" tabindex="-1"></a><span class="co"># 离散参数检验：如果p值显著，说明存在过度离散</span></span>
<span id="cb2242-4"><a href="高级回归模型.html#cb2242-4" tabindex="-1"></a><span class="fu">dispersiontest</span>(poisson_model)</span></code></pre></div>
<pre><code>## 
##  Overdispersion test
## 
## data:  poisson_model
## z = -0.099863, p-value = 0.5398
## alternative hypothesis: true dispersion is greater than 1
## sample estimates:
## dispersion 
##  0.9896964</code></pre>
<div class="sourceCode" id="cb2244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2244-1"><a href="高级回归模型.html#cb2244-1" tabindex="-1"></a><span class="co"># 手动计算离散参数</span></span>
<span id="cb2244-2"><a href="高级回归模型.html#cb2244-2" tabindex="-1"></a>pearson_chisq <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(poisson_model, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2244-3"><a href="高级回归模型.html#cb2244-3" tabindex="-1"></a>dispersion_param <span class="ot">&lt;-</span> pearson_chisq <span class="sc">/</span> <span class="fu">df.residual</span>(poisson_model)</span>
<span id="cb2244-4"><a href="高级回归模型.html#cb2244-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;离散参数:&quot;</span>, dispersion_param, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 离散参数: 1.018575</code></pre>
<div class="sourceCode" id="cb2246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2246-1"><a href="高级回归模型.html#cb2246-1" tabindex="-1"></a><span class="co"># 经验法则：离散参数 &gt; 1.5 表明可能存在过度离散</span></span>
<span id="cb2246-2"><a href="高级回归模型.html#cb2246-2" tabindex="-1"></a><span class="cf">if</span> (dispersion_param <span class="sc">&gt;</span> <span class="fl">1.5</span>) {</span>
<span id="cb2246-3"><a href="高级回归模型.html#cb2246-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;警告：数据可能存在过度离散，考虑使用负二项回归</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2246-4"><a href="高级回归模型.html#cb2246-4" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>过度离散的处理方法</strong>： - 使用准泊松回归（quasi-Poisson） - 使用负二项回归 - 使用零膨胀模型（如果存在过多的零值）</p>
</div>
<div id="模型拟合优度评估" class="section level4 hasAnchor" number="10.3.5.3">
<h4><span class="header-section-number">10.3.5.3</span> 模型拟合优度评估<a href="高级回归模型.html#模型拟合优度评估" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>评估GLM的拟合优度需要使用适合特定分布的指标：</p>
<div class="sourceCode" id="cb2247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2247-1"><a href="高级回归模型.html#cb2247-1" tabindex="-1"></a><span class="co"># 模型拟合优度评估</span></span>
<span id="cb2247-2"><a href="高级回归模型.html#cb2247-2" tabindex="-1"></a><span class="co"># 空模型和完整模型的偏差比较</span></span>
<span id="cb2247-3"><a href="高级回归模型.html#cb2247-3" tabindex="-1"></a>null_deviance <span class="ot">&lt;-</span> logistic_model<span class="sc">$</span>null.deviance</span>
<span id="cb2247-4"><a href="高级回归模型.html#cb2247-4" tabindex="-1"></a>residual_deviance <span class="ot">&lt;-</span> logistic_model<span class="sc">$</span>deviance</span>
<span id="cb2247-5"><a href="高级回归模型.html#cb2247-5" tabindex="-1"></a>pseudo_r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (residual_deviance <span class="sc">/</span> null_deviance)</span>
<span id="cb2247-6"><a href="高级回归模型.html#cb2247-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;伪R²:&quot;</span>, pseudo_r2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 伪R²: 0.07975001</code></pre>
<div class="sourceCode" id="cb2249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2249-1"><a href="高级回归模型.html#cb2249-1" tabindex="-1"></a><span class="co"># AIC和BIC比较</span></span>
<span id="cb2249-2"><a href="高级回归模型.html#cb2249-2" tabindex="-1"></a><span class="fu">AIC</span>(logistic_model)</span></code></pre></div>
<pre><code>## [1] 63.8461</code></pre>
<div class="sourceCode" id="cb2251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2251-1"><a href="高级回归模型.html#cb2251-1" tabindex="-1"></a><span class="fu">BIC</span>(logistic_model)</span></code></pre></div>
<pre><code>## [1] 77.03937</code></pre>
<div class="sourceCode" id="cb2253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2253-1"><a href="高级回归模型.html#cb2253-1" tabindex="-1"></a><span class="co"># 对于逻辑回归，使用ROC曲线评估分类性能</span></span>
<span id="cb2253-2"><a href="高级回归模型.html#cb2253-2" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code></pre></div>
<pre><code>## Type &#39;citation(&quot;pROC&quot;)&#39; for a citation.</code></pre>
<pre><code>## 
## Attaching package: &#39;pROC&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     cov, smooth, var</code></pre>
<div class="sourceCode" id="cb2257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2257-1"><a href="高级回归模型.html#cb2257-1" tabindex="-1"></a>roc_curve <span class="ot">&lt;-</span> <span class="fu">roc</span>(species_data<span class="sc">$</span>presence, <span class="fu">fitted</span>(logistic_model))</span></code></pre></div>
<pre><code>## Setting levels: control = 0, case = 1</code></pre>
<pre><code>## Setting direction: controls &lt; cases</code></pre>
<div class="sourceCode" id="cb2260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2260-1"><a href="高级回归模型.html#cb2260-1" tabindex="-1"></a><span class="fu">plot</span>(roc_curve, <span class="at">main =</span> <span class="st">&quot;ROC曲线&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-12"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-12-1.png" alt="逻辑回归模型ROC曲线" width="672" />
<p class="caption">
图9.1: 逻辑回归模型ROC曲线
</p>
</div>
<div class="sourceCode" id="cb2261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2261-1"><a href="高级回归模型.html#cb2261-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;AUC:&quot;</span>, <span class="fu">auc</span>(roc_curve), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## AUC: 0.742413</code></pre>
<div class="sourceCode" id="cb2263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2263-1"><a href="高级回归模型.html#cb2263-1" tabindex="-1"></a><span class="co"># 分类准确率</span></span>
<span id="cb2263-2"><a href="高级回归模型.html#cb2263-2" tabindex="-1"></a>predicted_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">fitted</span>(logistic_model) <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2263-3"><a href="高级回归模型.html#cb2263-3" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">mean</span>(predicted_class <span class="sc">==</span> species_data<span class="sc">$</span>presence)</span>
<span id="cb2263-4"><a href="高级回归模型.html#cb2263-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;分类准确率:&quot;</span>, accuracy, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 分类准确率: 0.965</code></pre>
</div>
<div id="系数解释" class="section level4 hasAnchor" number="10.3.5.4">
<h4><span class="header-section-number">10.3.5.4</span> 系数解释<a href="高级回归模型.html#系数解释" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>GLM系数的解释需要特别注意连接函数的影响：</p>
<p><strong>逻辑回归系数解释</strong>：</p>
<div class="sourceCode" id="cb2265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2265-1"><a href="高级回归模型.html#cb2265-1" tabindex="-1"></a><span class="co"># 逻辑回归系数解释</span></span>
<span id="cb2265-2"><a href="高级回归模型.html#cb2265-2" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">coef</span>(logistic_model)</span>
<span id="cb2265-3"><a href="高级回归模型.html#cb2265-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;原始系数:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 原始系数:</code></pre>
<div class="sourceCode" id="cb2267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2267-1"><a href="高级回归模型.html#cb2267-1" tabindex="-1"></a><span class="fu">print</span>(coefficients)</span></code></pre></div>
<pre><code>##     (Intercept)     temperature   precipitation habitat_quality 
##      0.06010029      0.04168070      0.00181148      1.26625658</code></pre>
<div class="sourceCode" id="cb2269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2269-1"><a href="高级回归模型.html#cb2269-1" tabindex="-1"></a><span class="co"># 优势比解释</span></span>
<span id="cb2269-2"><a href="高级回归模型.html#cb2269-2" tabindex="-1"></a>odds_ratios <span class="ot">&lt;-</span> <span class="fu">exp</span>(coefficients)</span>
<span id="cb2269-3"><a href="高级回归模型.html#cb2269-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;优势比:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 优势比:</code></pre>
<div class="sourceCode" id="cb2271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2271-1"><a href="高级回归模型.html#cb2271-1" tabindex="-1"></a><span class="fu">print</span>(odds_ratios)</span></code></pre></div>
<pre><code>##     (Intercept)     temperature   precipitation habitat_quality 
##        1.061943        1.042562        1.001813        3.547548</code></pre>
<div class="sourceCode" id="cb2273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2273-1"><a href="高级回归模型.html#cb2273-1" tabindex="-1"></a><span class="co"># 解释示例：温度系数为0.1</span></span>
<span id="cb2273-2"><a href="高级回归模型.html#cb2273-2" tabindex="-1"></a><span class="co"># 优势比 = exp(0.1) ≈ 1.105</span></span>
<span id="cb2273-3"><a href="高级回归模型.html#cb2273-3" tabindex="-1"></a><span class="co"># 解释：温度每升高1°C，物种出现的优势增加10.5%</span></span></code></pre></div>
<p><strong>泊松回归系数解释</strong>：</p>
<div class="sourceCode" id="cb2274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2274-1"><a href="高级回归模型.html#cb2274-1" tabindex="-1"></a><span class="co"># 泊松回归系数解释</span></span>
<span id="cb2274-2"><a href="高级回归模型.html#cb2274-2" tabindex="-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">coef</span>(poisson_model)</span>
<span id="cb2274-3"><a href="高级回归模型.html#cb2274-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;原始系数:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 原始系数:</code></pre>
<div class="sourceCode" id="cb2276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2276-1"><a href="高级回归模型.html#cb2276-1" tabindex="-1"></a><span class="fu">print</span>(coefficients)</span></code></pre></div>
<pre><code>##          (Intercept)            elevation       I(elevation^2) 
##         1.992187e+00         9.719974e-04        -8.723422e-08 
## vegetation_diversity 
##         3.002533e-01</code></pre>
<div class="sourceCode" id="cb2278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2278-1"><a href="高级回归模型.html#cb2278-1" tabindex="-1"></a><span class="co"># 发生率比解释</span></span>
<span id="cb2278-2"><a href="高级回归模型.html#cb2278-2" tabindex="-1"></a>rate_ratios <span class="ot">&lt;-</span> <span class="fu">exp</span>(coefficients)</span>
<span id="cb2278-3"><a href="高级回归模型.html#cb2278-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;发生率比:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 发生率比:</code></pre>
<div class="sourceCode" id="cb2280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2280-1"><a href="高级回归模型.html#cb2280-1" tabindex="-1"></a><span class="fu">print</span>(rate_ratios)</span></code></pre></div>
<pre><code>##          (Intercept)            elevation       I(elevation^2) 
##            7.3315502            1.0009725            0.9999999 
## vegetation_diversity 
##            1.3502007</code></pre>
<div class="sourceCode" id="cb2282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2282-1"><a href="高级回归模型.html#cb2282-1" tabindex="-1"></a><span class="co"># 解释示例：植被多样性系数为0.3</span></span>
<span id="cb2282-2"><a href="高级回归模型.html#cb2282-2" tabindex="-1"></a><span class="co"># 发生率比 = exp(0.3) ≈ 1.35</span></span>
<span id="cb2282-3"><a href="高级回归模型.html#cb2282-3" tabindex="-1"></a><span class="co"># 解释：植被多样性指数每增加1单位，物种丰富度增加35%</span></span></code></pre></div>
</div>
<div id="影响点检测" class="section level4 hasAnchor" number="10.3.5.5">
<h4><span class="header-section-number">10.3.5.5</span> 影响点检测<a href="高级回归模型.html#影响点检测" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>识别对模型有过度影响的观测值：</p>
<div class="sourceCode" id="cb2283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2283-1"><a href="高级回归模型.html#cb2283-1" tabindex="-1"></a><span class="co"># 影响点检测</span></span>
<span id="cb2283-2"><a href="高级回归模型.html#cb2283-2" tabindex="-1"></a><span class="co"># Cook距离</span></span>
<span id="cb2283-3"><a href="高级回归模型.html#cb2283-3" tabindex="-1"></a>cooks_d <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(logistic_model)</span>
<span id="cb2283-4"><a href="高级回归模型.html#cb2283-4" tabindex="-1"></a><span class="fu">plot</span>(cooks_d,</span>
<span id="cb2283-5"><a href="高级回归模型.html#cb2283-5" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;h&quot;</span>,</span>
<span id="cb2283-6"><a href="高级回归模型.html#cb2283-6" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Cook距离&quot;</span>,</span>
<span id="cb2283-7"><a href="高级回归模型.html#cb2283-7" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Cook距离&quot;</span></span>
<span id="cb2283-8"><a href="高级回归模型.html#cb2283-8" tabindex="-1"></a>)</span>
<span id="cb2283-9"><a href="高级回归模型.html#cb2283-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">length</span>(cooks_d), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="co"># 常用阈值</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-15-1"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-15-1.png" alt="逻辑回归模型影响点诊断图" width="672" />
<p class="caption">
图5.20: 逻辑回归模型影响点诊断图
</p>
</div>
<div class="sourceCode" id="cb2284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2284-1"><a href="高级回归模型.html#cb2284-1" tabindex="-1"></a><span class="co"># 杠杆值</span></span>
<span id="cb2284-2"><a href="高级回归模型.html#cb2284-2" tabindex="-1"></a>leverage <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(logistic_model)</span>
<span id="cb2284-3"><a href="高级回归模型.html#cb2284-3" tabindex="-1"></a><span class="fu">plot</span>(leverage,</span>
<span id="cb2284-4"><a href="高级回归模型.html#cb2284-4" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;h&quot;</span>,</span>
<span id="cb2284-5"><a href="高级回归模型.html#cb2284-5" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;杠杆值&quot;</span>,</span>
<span id="cb2284-6"><a href="高级回归模型.html#cb2284-6" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;杠杆值&quot;</span></span>
<span id="cb2284-7"><a href="高级回归模型.html#cb2284-7" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-15-2"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-15-2.png" alt="逻辑回归模型影响点诊断图" width="672" />
<p class="caption">
图5.21: 逻辑回归模型影响点诊断图
</p>
</div>
<div class="sourceCode" id="cb2285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2285-1"><a href="高级回归模型.html#cb2285-1" tabindex="-1"></a><span class="co"># DFBETA统计量（系数变化）</span></span>
<span id="cb2285-2"><a href="高级回归模型.html#cb2285-2" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb2285-3"><a href="高级回归模型.html#cb2285-3" tabindex="-1"></a><span class="fu">influencePlot</span>(logistic_model)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-15-3"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-15-3.png" alt="逻辑回归模型影响点诊断图" width="672" />
<p class="caption">
图10.6: 逻辑回归模型影响点诊断图
</p>
</div>
<pre><code>##        StudRes         Hat       CookD
## 14  -3.0047566 0.007652482 0.134021163
## 85  -2.5144799 0.064195171 0.251705731
## 98   0.6209246 0.104097657 0.006442263
## 128  0.6943325 0.138384104 0.011535521
## 141 -2.7910499 0.011873247 0.115822420</code></pre>
</div>
<div id="预测与置信区间" class="section level4 hasAnchor" number="10.3.5.6">
<h4><span class="header-section-number">10.3.5.6</span> 预测与置信区间<a href="高级回归模型.html#预测与置信区间" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb2287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2287-1"><a href="高级回归模型.html#cb2287-1" tabindex="-1"></a><span class="co"># 预测新数据</span></span>
<span id="cb2287-2"><a href="高级回归模型.html#cb2287-2" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2287-3"><a href="高级回归模型.html#cb2287-3" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">30</span>, <span class="at">length =</span> <span class="dv">50</span>),</span>
<span id="cb2287-4"><a href="高级回归模型.html#cb2287-4" tabindex="-1"></a>  <span class="at">precipitation =</span> <span class="fu">mean</span>(species_data<span class="sc">$</span>precipitation),</span>
<span id="cb2287-5"><a href="高级回归模型.html#cb2287-5" tabindex="-1"></a>  <span class="at">habitat_quality =</span> <span class="fu">mean</span>(species_data<span class="sc">$</span>habitat_quality)</span>
<span id="cb2287-6"><a href="高级回归模型.html#cb2287-6" tabindex="-1"></a>)</span>
<span id="cb2287-7"><a href="高级回归模型.html#cb2287-7" tabindex="-1"></a></span>
<span id="cb2287-8"><a href="高级回归模型.html#cb2287-8" tabindex="-1"></a><span class="co"># 点预测和区间预测</span></span>
<span id="cb2287-9"><a href="高级回归模型.html#cb2287-9" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(logistic_model,</span>
<span id="cb2287-10"><a href="高级回归模型.html#cb2287-10" tabindex="-1"></a>  <span class="at">newdata =</span> new_data,</span>
<span id="cb2287-11"><a href="高级回归模型.html#cb2287-11" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span></span>
<span id="cb2287-12"><a href="高级回归模型.html#cb2287-12" tabindex="-1"></a>)</span>
<span id="cb2287-13"><a href="高级回归模型.html#cb2287-13" tabindex="-1"></a>new_data<span class="sc">$</span>pred <span class="ot">&lt;-</span> predictions<span class="sc">$</span>fit</span>
<span id="cb2287-14"><a href="高级回归模型.html#cb2287-14" tabindex="-1"></a>new_data<span class="sc">$</span>se <span class="ot">&lt;-</span> predictions<span class="sc">$</span>se.fit</span>
<span id="cb2287-15"><a href="高级回归模型.html#cb2287-15" tabindex="-1"></a>new_data<span class="sc">$</span>lower <span class="ot">&lt;-</span> new_data<span class="sc">$</span>pred <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> new_data<span class="sc">$</span>se</span>
<span id="cb2287-16"><a href="高级回归模型.html#cb2287-16" tabindex="-1"></a>new_data<span class="sc">$</span>upper <span class="ot">&lt;-</span> new_data<span class="sc">$</span>pred <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> new_data<span class="sc">$</span>se</span>
<span id="cb2287-17"><a href="高级回归模型.html#cb2287-17" tabindex="-1"></a></span>
<span id="cb2287-18"><a href="高级回归模型.html#cb2287-18" tabindex="-1"></a><span class="co"># 可视化预测结果</span></span>
<span id="cb2287-19"><a href="高级回归模型.html#cb2287-19" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2287-20"><a href="高级回归模型.html#cb2287-20" tabindex="-1"></a><span class="fu">ggplot</span>(new_data, <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> pred)) <span class="sc">+</span></span>
<span id="cb2287-21"><a href="高级回归模型.html#cb2287-21" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb2287-22"><a href="高级回归模型.html#cb2287-22" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2287-23"><a href="高级回归模型.html#cb2287-23" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2287-24"><a href="高级回归模型.html#cb2287-24" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;温度 (°C)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;预测出现概率&quot;</span>,</span>
<span id="cb2287-25"><a href="高级回归模型.html#cb2287-25" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;温度对物种出现概率的影响（含95%置信区间）&quot;</span></span>
<span id="cb2287-26"><a href="高级回归模型.html#cb2287-26" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2287-27"><a href="高级回归模型.html#cb2287-27" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-16-1.png" alt="温度对物种出现概率影响的预测曲线（含95%置信区间）" width="672" />
<p class="caption">
图3.1: 温度对物种出现概率影响的预测曲线（含95%置信区间）
</p>
</div>
</div>
<div id="生态学意义验证-1" class="section level4 hasAnchor" number="10.3.5.7">
<h4><span class="header-section-number">10.3.5.7</span> 生态学意义验证<a href="高级回归模型.html#生态学意义验证-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>最后，模型结果需要在生态学背景下进行验证：</p>
<ol style="list-style-type: decimal">
<li><strong>生物学合理性</strong>：模型预测是否符合已知的生态学知识？</li>
<li><strong>效应大小</strong>：统计显著性是否对应有意义的生态效应？</li>
<li><strong>模型稳定性</strong>：移除异常值后，主要结论是否保持不变？</li>
<li><strong>预测能力</strong>：模型在新数据上的表现如何？</li>
</ol>
<p>通过系统的模型诊断和谨慎的结果解释，我们可以确保GLM分析为生态学研究提供可靠的科学依据。</p>
</div>
</div>
<div id="生态学意义与注意事项" class="section level3 hasAnchor" number="10.3.6">
<h3><span class="header-section-number">10.3.6</span> 生态学意义与注意事项<a href="高级回归模型.html#生态学意义与注意事项" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>广义线性模型在生态学中具有重要的应用价值，它使我们能够正确地分析各种类型的生态数据。然而，在应用GLM时需要注意几个关键问题：</p>
<p><strong>分布选择</strong>：选择正确的分布类型至关重要。错误的选择会导致有偏的估计和错误的推断。</p>
<p><strong>过度离散</strong>：生态计数数据常常表现出过度离散，即方差大于均值。在这种情况下，泊松回归可能不适用，需要考虑负二项回归或其他过度离散模型。</p>
<p><strong>零膨胀</strong>：某些生态数据（如稀有物种的分布）可能包含过多的零值，需要考虑零膨胀模型。</p>
<p><strong>连接函数选择</strong>：虽然每个分布通常有默认的连接函数，但在某些情况下可能需要选择其他连接函数来更好地描述生态过程。</p>
<p>广义线性模型为生态学家提供了一个强大的工具，使我们能够更准确地描述和理解生态系统中变量间的关系，为生态保护和管理决策提供更可靠的科学依据。</p>
</div>
</div>
<div id="广义可加模型" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> 广义可加模型<a href="高级回归模型.html#广义可加模型" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>广义可加模型（GAM）是可加性模型与广义线性模型的结合，它继承了可加性模型捕捉非线性关系的能力，同时具备了广义线性模型处理非正态分布数据的能力。在生态学研究中，我们经常遇到既需要处理非线性关系，又需要处理非正态分布数据的情况，GAM为此提供了完美的解决方案。</p>
<div id="gam的基本原理" class="section level3 hasAnchor" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> GAM的基本原理<a href="高级回归模型.html#gam的基本原理" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>广义可加模型的数学形式为：</p>
<p><span class="math display">\[g(\mu) = \beta_0 + f_1(x_1) + f_2(x_2) + \cdots + f_p(x_p)\]</span></p>
<p>其中<span class="math inline">\(g(\cdot)\)</span>是连接函数，<span class="math inline">\(\mu\)</span>是响应变量的期望值，<span class="math inline">\(f_j(x_j)\)</span>是每个预测变量的平滑函数。GAM通过连接函数将响应变量的期望值映射到线性预测器上，确保预测值落在合理的范围内。</p>
</div>
<div id="在r中的实现-1" class="section level3 hasAnchor" number="10.4.2">
<h3><span class="header-section-number">10.4.2</span> 在R中的实现<a href="高级回归模型.html#在r中的实现-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在R中，我们同样使用<code>mgcv</code>包来实现GAM。通过指定不同的<code>family</code>参数，我们可以构建适用于各种分布类型的GAM模型：</p>
<div class="sourceCode" id="cb2288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2288-1"><a href="高级回归模型.html#cb2288-1" tabindex="-1"></a><span class="co"># GAM语法示例（这些是示例代码，实际使用时需要替换为真实数据）</span></span>
<span id="cb2288-2"><a href="高级回归模型.html#cb2288-2" tabindex="-1"></a><span class="co"># 泊松分布的GAM（适用于计数数据）</span></span>
<span id="cb2288-3"><a href="高级回归模型.html#cb2288-3" tabindex="-1"></a><span class="co"># gam(y ~ s(x1) + s(x2), family = poisson, data = dataset)</span></span>
<span id="cb2288-4"><a href="高级回归模型.html#cb2288-4" tabindex="-1"></a></span>
<span id="cb2288-5"><a href="高级回归模型.html#cb2288-5" tabindex="-1"></a><span class="co"># 二项分布的GAM（适用于比例数据）</span></span>
<span id="cb2288-6"><a href="高级回归模型.html#cb2288-6" tabindex="-1"></a><span class="co"># gam(y ~ s(x1) + s(x2), family = binomial, data = dataset)</span></span>
<span id="cb2288-7"><a href="高级回归模型.html#cb2288-7" tabindex="-1"></a></span>
<span id="cb2288-8"><a href="高级回归模型.html#cb2288-8" tabindex="-1"></a><span class="co"># 伽马分布的GAM（适用于连续正数数据）</span></span>
<span id="cb2288-9"><a href="高级回归模型.html#cb2288-9" tabindex="-1"></a><span class="co"># gam(y ~ s(x1) + s(x2), family = Gamma, data = dataset)</span></span>
<span id="cb2288-10"><a href="高级回归模型.html#cb2288-10" tabindex="-1"></a></span>
<span id="cb2288-11"><a href="高级回归模型.html#cb2288-11" tabindex="-1"></a><span class="co"># 负二项分布的GAM（适用于过度离散计数数据）</span></span>
<span id="cb2288-12"><a href="高级回归模型.html#cb2288-12" tabindex="-1"></a><span class="co"># gam(y ~ s(x1) + s(x2), family = nb, data = dataset)</span></span></code></pre></div>
</div>
<div id="生态学应用示例-1" class="section level3 hasAnchor" number="10.4.3">
<h3><span class="header-section-number">10.4.3</span> 生态学应用示例<a href="高级回归模型.html#生态学应用示例-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>让我们通过一个具体的生态学例子来演示GAM的应用。假设我们研究鸟类物种丰富度与环境因子的关系：</p>
<div class="sourceCode" id="cb2289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2289-1"><a href="高级回归模型.html#cb2289-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb2289-2"><a href="高级回归模型.html#cb2289-2" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb2289-3"><a href="高级回归模型.html#cb2289-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2289-4"><a href="高级回归模型.html#cb2289-4" tabindex="-1"></a></span>
<span id="cb2289-5"><a href="高级回归模型.html#cb2289-5" tabindex="-1"></a><span class="co"># 模拟生态学数据</span></span>
<span id="cb2289-6"><a href="高级回归模型.html#cb2289-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2289-7"><a href="高级回归模型.html#cb2289-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb2289-8"><a href="高级回归模型.html#cb2289-8" tabindex="-1"></a>bird_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2289-9"><a href="高级回归模型.html#cb2289-9" tabindex="-1"></a>  <span class="at">elevation =</span> <span class="fu">runif</span>(n, <span class="dv">100</span>, <span class="dv">3000</span>), <span class="co"># 海拔(m)</span></span>
<span id="cb2289-10"><a href="高级回归模型.html#cb2289-10" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">runif</span>(n, <span class="dv">5</span>, <span class="dv">25</span>), <span class="co"># 年均温(°C)</span></span>
<span id="cb2289-11"><a href="高级回归模型.html#cb2289-11" tabindex="-1"></a>  <span class="at">precipitation =</span> <span class="fu">runif</span>(n, <span class="dv">500</span>, <span class="dv">2000</span>) <span class="co"># 年降水量(mm)</span></span>
<span id="cb2289-12"><a href="高级回归模型.html#cb2289-12" tabindex="-1"></a>)</span>
<span id="cb2289-13"><a href="高级回归模型.html#cb2289-13" tabindex="-1"></a></span>
<span id="cb2289-14"><a href="高级回归模型.html#cb2289-14" tabindex="-1"></a><span class="co"># 模拟非线性关系：海拔呈现单峰效应</span></span>
<span id="cb2289-15"><a href="高级回归模型.html#cb2289-15" tabindex="-1"></a><span class="co"># 使用泊松分布模拟物种丰富度数据</span></span>
<span id="cb2289-16"><a href="高级回归模型.html#cb2289-16" tabindex="-1"></a>linear_predictor <span class="ot">&lt;-</span> (</span>
<span id="cb2289-17"><a href="高级回归模型.html#cb2289-17" tabindex="-1"></a>  <span class="fl">2.5</span> <span class="sc">+</span></span>
<span id="cb2289-18"><a href="高级回归模型.html#cb2289-18" tabindex="-1"></a>    <span class="fl">0.0001</span> <span class="sc">*</span> (bird_data<span class="sc">$</span>elevation <span class="sc">-</span> <span class="dv">1500</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="fl">0.0000001</span> <span class="sc">*</span> (bird_data<span class="sc">$</span>elevation <span class="sc">-</span> <span class="dv">1500</span>)<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span></span>
<span id="cb2289-19"><a href="高级回归模型.html#cb2289-19" tabindex="-1"></a>    <span class="fl">0.05</span> <span class="sc">*</span> bird_data<span class="sc">$</span>temperature <span class="sc">+</span></span>
<span id="cb2289-20"><a href="高级回归模型.html#cb2289-20" tabindex="-1"></a>    <span class="fl">0.0005</span> <span class="sc">*</span> bird_data<span class="sc">$</span>precipitation <span class="sc">+</span></span>
<span id="cb2289-21"><a href="高级回归模型.html#cb2289-21" tabindex="-1"></a>    <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.1</span>)</span>
<span id="cb2289-22"><a href="高级回归模型.html#cb2289-22" tabindex="-1"></a>)</span>
<span id="cb2289-23"><a href="高级回归模型.html#cb2289-23" tabindex="-1"></a><span class="co"># 确保lambda值为正数且不过大</span></span>
<span id="cb2289-24"><a href="高级回归模型.html#cb2289-24" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">exp</span>(linear_predictor)</span>
<span id="cb2289-25"><a href="高级回归模型.html#cb2289-25" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">pmin</span>(lambda, <span class="dv">100</span>)  <span class="co"># 限制最大值避免数值问题</span></span>
<span id="cb2289-26"><a href="高级回归模型.html#cb2289-26" tabindex="-1"></a>bird_data<span class="sc">$</span>species_richness <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda)</span>
<span id="cb2289-27"><a href="高级回归模型.html#cb2289-27" tabindex="-1"></a></span>
<span id="cb2289-28"><a href="高级回归模型.html#cb2289-28" tabindex="-1"></a><span class="co"># 构建GAM模型（泊松分布适用于计数数据）</span></span>
<span id="cb2289-29"><a href="高级回归模型.html#cb2289-29" tabindex="-1"></a>bird_gam <span class="ot">&lt;-</span> <span class="fu">gam</span>(species_richness <span class="sc">~</span> <span class="fu">s</span>(elevation) <span class="sc">+</span> <span class="fu">s</span>(temperature) <span class="sc">+</span> <span class="fu">s</span>(precipitation),</span>
<span id="cb2289-30"><a href="高级回归模型.html#cb2289-30" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb2289-31"><a href="高级回归模型.html#cb2289-31" tabindex="-1"></a>  <span class="at">data =</span> bird_data</span>
<span id="cb2289-32"><a href="高级回归模型.html#cb2289-32" tabindex="-1"></a>)</span>
<span id="cb2289-33"><a href="高级回归模型.html#cb2289-33" tabindex="-1"></a></span>
<span id="cb2289-34"><a href="高级回归模型.html#cb2289-34" tabindex="-1"></a><span class="co"># 模型摘要</span></span>
<span id="cb2289-35"><a href="高级回归模型.html#cb2289-35" tabindex="-1"></a><span class="fu">summary</span>(bird_gam)</span></code></pre></div>
<pre><code>## 
## Family: poisson 
## Link function: log 
## 
## Formula:
## species_richness ~ s(elevation) + s(temperature) + s(precipitation)
## 
## Parametric coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   1.6604     0.2283   7.273 3.53e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##                    edf Ref.df  Chi.sq p-value    
## s(elevation)     8.997  9.000 224.869 &lt; 2e-16 ***
## s(temperature)   1.732  2.153   2.342 0.31824    
## s(precipitation) 4.139  5.089  16.166 0.00687 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =    0.9   Deviance explained = 94.4%
## UBRE = 0.97381  Scale est. = 1         n = 150</code></pre>
<div class="sourceCode" id="cb2291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2291-1"><a href="高级回归模型.html#cb2291-1" tabindex="-1"></a><span class="co"># 可视化各变量的平滑效应</span></span>
<span id="cb2291-2"><a href="高级回归模型.html#cb2291-2" tabindex="-1"></a><span class="fu">plot</span>(bird_gam, <span class="at">pages =</span> <span class="dv">1</span>, <span class="at">residuals =</span> <span class="cn">TRUE</span>, <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-18-1"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-18-1.png" alt="鸟类物种丰富度与环境因子关系的广义可加模型分析" width="672" />
<p class="caption">
图7.6: 鸟类物种丰富度与环境因子关系的广义可加模型分析
</p>
</div>
<div class="sourceCode" id="cb2292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2292-1"><a href="高级回归模型.html#cb2292-1" tabindex="-1"></a><span class="co"># 模型诊断</span></span>
<span id="cb2292-2"><a href="高级回归模型.html#cb2292-2" tabindex="-1"></a><span class="fu">gam.check</span>(bird_gam)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-18-2"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-18-2.png" alt="鸟类物种丰富度与环境因子关系的广义可加模型分析" width="672" />
<p class="caption">
图7.7: 鸟类物种丰富度与环境因子关系的广义可加模型分析
</p>
</div>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 13 iterations.
## Gradient range [-9.091641e-08,2.341445e-06]
## (score 0.9738072 &amp; scale 1).
## Hessian positive definite, eigenvalue range [1.575987e-05,0.008520077].
## Model rank =  28 / 28 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                    k&#39;  edf k-index p-value    
## s(elevation)     9.00 9.00    0.61  &lt;2e-16 ***
## s(temperature)   9.00 1.73    1.10    0.91    
## s(precipitation) 9.00 4.14    1.18    0.99    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb2294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2294-1"><a href="高级回归模型.html#cb2294-1" tabindex="-1"></a><span class="co"># 预测新数据</span></span>
<span id="cb2294-2"><a href="高级回归模型.html#cb2294-2" tabindex="-1"></a>new_elevation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2294-3"><a href="高级回归模型.html#cb2294-3" tabindex="-1"></a>  <span class="at">elevation =</span> <span class="fu">seq</span>(<span class="dv">100</span>, <span class="dv">3000</span>, <span class="at">length =</span> <span class="dv">100</span>),</span>
<span id="cb2294-4"><a href="高级回归模型.html#cb2294-4" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">mean</span>(bird_data<span class="sc">$</span>temperature),</span>
<span id="cb2294-5"><a href="高级回归模型.html#cb2294-5" tabindex="-1"></a>  <span class="at">precipitation =</span> <span class="fu">mean</span>(bird_data<span class="sc">$</span>precipitation)</span>
<span id="cb2294-6"><a href="高级回归模型.html#cb2294-6" tabindex="-1"></a>)</span>
<span id="cb2294-7"><a href="高级回归模型.html#cb2294-7" tabindex="-1"></a></span>
<span id="cb2294-8"><a href="高级回归模型.html#cb2294-8" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(bird_gam, <span class="at">newdata =</span> new_elevation, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2294-9"><a href="高级回归模型.html#cb2294-9" tabindex="-1"></a>new_elevation<span class="sc">$</span>pred <span class="ot">&lt;-</span> predictions<span class="sc">$</span>fit</span>
<span id="cb2294-10"><a href="高级回归模型.html#cb2294-10" tabindex="-1"></a>new_elevation<span class="sc">$</span>se <span class="ot">&lt;-</span> predictions<span class="sc">$</span>se.fit</span>
<span id="cb2294-11"><a href="高级回归模型.html#cb2294-11" tabindex="-1"></a></span>
<span id="cb2294-12"><a href="高级回归模型.html#cb2294-12" tabindex="-1"></a><span class="co"># 绘制预测曲线</span></span>
<span id="cb2294-13"><a href="高级回归模型.html#cb2294-13" tabindex="-1"></a><span class="fu">ggplot</span>(new_elevation, <span class="fu">aes</span>(<span class="at">x =</span> elevation, <span class="at">y =</span> pred)) <span class="sc">+</span></span>
<span id="cb2294-14"><a href="高级回归模型.html#cb2294-14" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> pred <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> se, <span class="at">ymax =</span> pred <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> se), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb2294-15"><a href="高级回归模型.html#cb2294-15" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2294-16"><a href="高级回归模型.html#cb2294-16" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2294-17"><a href="高级回归模型.html#cb2294-17" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;海拔 (m)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;预测物种丰富度&quot;</span>,</span>
<span id="cb2294-18"><a href="高级回归模型.html#cb2294-18" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;海拔对鸟类物种丰富度的非线性影响&quot;</span></span>
<span id="cb2294-19"><a href="高级回归模型.html#cb2294-19" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2294-20"><a href="高级回归模型.html#cb2294-20" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-18-3"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-18-3.png" alt="鸟类物种丰富度与环境因子关系的广义可加模型分析" width="672" />
<p class="caption">
图10.7: 鸟类物种丰富度与环境因子关系的广义可加模型分析
</p>
</div>
<div class="sourceCode" id="cb2295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2295-1"><a href="高级回归模型.html#cb2295-1" tabindex="-1"></a><span class="co"># 与GLM比较</span></span>
<span id="cb2295-2"><a href="高级回归模型.html#cb2295-2" tabindex="-1"></a>bird_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(species_richness <span class="sc">~</span> elevation <span class="sc">+</span> temperature <span class="sc">+</span> precipitation,</span>
<span id="cb2295-3"><a href="高级回归模型.html#cb2295-3" tabindex="-1"></a>  <span class="at">family =</span> poisson, <span class="at">data =</span> bird_data</span>
<span id="cb2295-4"><a href="高级回归模型.html#cb2295-4" tabindex="-1"></a>)</span>
<span id="cb2295-5"><a href="高级回归模型.html#cb2295-5" tabindex="-1"></a></span>
<span id="cb2295-6"><a href="高级回归模型.html#cb2295-6" tabindex="-1"></a><span class="co"># 比较模型拟合优度</span></span>
<span id="cb2295-7"><a href="高级回归模型.html#cb2295-7" tabindex="-1"></a><span class="fu">AIC</span>(bird_gam, bird_glm)</span></code></pre></div>
<pre><code>##                df      AIC
## bird_gam 15.86803 1099.017
## bird_glm  4.00000 4351.072</code></pre>
</div>
<div id="gam在生态学中的特殊价值" class="section level3 hasAnchor" number="10.4.4">
<h3><span class="header-section-number">10.4.4</span> GAM在生态学中的特殊价值<a href="高级回归模型.html#gam在生态学中的特殊价值" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>GAM在生态学研究中具有特殊的价值，主要体现在以下几个方面：</p>
<ol style="list-style-type: decimal">
<li><p><strong>处理生态数据的复杂性</strong>：生态数据往往同时具有非线性关系和非正态分布的特点，GAM能够同时处理这两个问题</p></li>
<li><p><strong>捕捉生态阈值</strong>：许多生态过程存在阈值效应，GAM能够自动识别和建模这些阈值</p></li>
<li><p><strong>处理过度离散</strong>：通过负二项分布等选项，GAM能够处理生态计数数据中常见的过度离散问题</p></li>
<li><p><strong>时空建模</strong>：GAM可以扩展到时空建模，通过引入空间或时间平滑项来捕捉生态过程的时空动态</p></li>
</ol>
</div>
<div id="高级功能" class="section level3 hasAnchor" number="10.4.5">
<h3><span class="header-section-number">10.4.5</span> 高级功能<a href="高级回归模型.html#高级功能" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>GAM还提供了一些高级功能，特别适合复杂的生态学应用：</p>
<div class="sourceCode" id="cb2297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2297-1"><a href="高级回归模型.html#cb2297-1" tabindex="-1"></a><span class="co"># 张量积平滑（处理变量间交互作用）</span></span>
<span id="cb2297-2"><a href="高级回归模型.html#cb2297-2" tabindex="-1"></a><span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">te</span>(x1, x2), <span class="at">family =</span> poisson, <span class="at">data =</span> dataset)</span>
<span id="cb2297-3"><a href="高级回归模型.html#cb2297-3" tabindex="-1"></a></span>
<span id="cb2297-4"><a href="高级回归模型.html#cb2297-4" tabindex="-1"></a><span class="co"># 交互平滑（分离主效应和交互效应）</span></span>
<span id="cb2297-5"><a href="高级回归模型.html#cb2297-5" tabindex="-1"></a><span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">s</span>(x1) <span class="sc">+</span> <span class="fu">s</span>(x2) <span class="sc">+</span> <span class="fu">ti</span>(x1, x2), <span class="at">family =</span> poisson, <span class="at">data =</span> dataset)</span>
<span id="cb2297-6"><a href="高级回归模型.html#cb2297-6" tabindex="-1"></a></span>
<span id="cb2297-7"><a href="高级回归模型.html#cb2297-7" tabindex="-1"></a><span class="co"># 空间平滑（处理空间自相关）</span></span>
<span id="cb2297-8"><a href="高级回归模型.html#cb2297-8" tabindex="-1"></a><span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">s</span>(longitude, latitude, <span class="at">bs =</span> <span class="st">&quot;tp&quot;</span>), <span class="at">family =</span> poisson, <span class="at">data =</span> dataset)</span>
<span id="cb2297-9"><a href="高级回归模型.html#cb2297-9" tabindex="-1"></a></span>
<span id="cb2297-10"><a href="高级回归模型.html#cb2297-10" tabindex="-1"></a><span class="co"># 时间序列平滑</span></span>
<span id="cb2297-11"><a href="高级回归模型.html#cb2297-11" tabindex="-1"></a><span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">s</span>(time, <span class="at">bs =</span> <span class="st">&quot;cr&quot;</span>), <span class="at">family =</span> poisson, <span class="at">data =</span> dataset)</span></code></pre></div>
</div>
<div id="模型选择与诊断" class="section level3 hasAnchor" number="10.4.6">
<h3><span class="header-section-number">10.4.6</span> 模型选择与诊断<a href="高级回归模型.html#模型选择与诊断" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在应用GAM时，模型选择和诊断比普通GLM更为复杂，需要同时考虑分布假设和平滑复杂度选择。系统性的诊断是确保GAM结果可靠性的关键。</p>
<div id="分布假设诊断" class="section level4 hasAnchor" number="10.4.6.1">
<h4><span class="header-section-number">10.4.6.1</span> 分布假设诊断<a href="高级回归模型.html#分布假设诊断" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>GAM继承了GLM的分布假设，需要检查所选分布是否适合数据特性。</p>
<div class="sourceCode" id="cb2298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2298-1"><a href="高级回归模型.html#cb2298-1" tabindex="-1"></a><span class="co"># 检查泊松分布的过度离散</span></span>
<span id="cb2298-2"><a href="高级回归模型.html#cb2298-2" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb2298-3"><a href="高级回归模型.html#cb2298-3" tabindex="-1"></a><span class="fu">dispersiontest</span>(bird_gam)</span></code></pre></div>
<pre><code>## 
##  Overdispersion test
## 
## data:  bird_gam
## z = 2.9955, p-value = 0.00137
## alternative hypothesis: true dispersion is greater than 1
## sample estimates:
## dispersion 
##    1.76235</code></pre>
<div class="sourceCode" id="cb2300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2300-1"><a href="高级回归模型.html#cb2300-1" tabindex="-1"></a><span class="co"># 手动计算离散参数</span></span>
<span id="cb2300-2"><a href="高级回归模型.html#cb2300-2" tabindex="-1"></a>pearson_resid <span class="ot">&lt;-</span> <span class="fu">residuals</span>(bird_gam, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb2300-3"><a href="高级回归模型.html#cb2300-3" tabindex="-1"></a>dispersion_param <span class="ot">&lt;-</span> <span class="fu">sum</span>(pearson_resid<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">df.residual</span>(bird_gam)</span>
<span id="cb2300-4"><a href="高级回归模型.html#cb2300-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;离散参数:&quot;</span>, dispersion_param, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 离散参数: 1.79029</code></pre>
<div class="sourceCode" id="cb2302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2302-1"><a href="高级回归模型.html#cb2302-1" tabindex="-1"></a><span class="co"># 如果存在过度离散，考虑负二项分布</span></span>
<span id="cb2302-2"><a href="高级回归模型.html#cb2302-2" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb2302-3"><a href="高级回归模型.html#cb2302-3" tabindex="-1"></a>bird_gam_nb <span class="ot">&lt;-</span> <span class="fu">gam</span>(species_richness <span class="sc">~</span> <span class="fu">s</span>(elevation) <span class="sc">+</span> <span class="fu">s</span>(temperature) <span class="sc">+</span> <span class="fu">s</span>(precipitation),</span>
<span id="cb2302-4"><a href="高级回归模型.html#cb2302-4" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nb</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb2302-5"><a href="高级回归模型.html#cb2302-5" tabindex="-1"></a>  <span class="at">data =</span> bird_data</span>
<span id="cb2302-6"><a href="高级回归模型.html#cb2302-6" tabindex="-1"></a>)</span>
<span id="cb2302-7"><a href="高级回归模型.html#cb2302-7" tabindex="-1"></a></span>
<span id="cb2302-8"><a href="高级回归模型.html#cb2302-8" tabindex="-1"></a><span class="co"># 比较模型</span></span>
<span id="cb2302-9"><a href="高级回归模型.html#cb2302-9" tabindex="-1"></a><span class="fu">AIC</span>(bird_gam, bird_gam_nb)</span></code></pre></div>
<pre><code>##                   df      AIC
## bird_gam    15.86803 1099.017
## bird_gam_nb 15.77724 1080.255</code></pre>
</div>
<div id="平滑复杂度诊断-1" class="section level4 hasAnchor" number="10.4.6.2">
<h4><span class="header-section-number">10.4.6.2</span> 平滑复杂度诊断<a href="高级回归模型.html#平滑复杂度诊断-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>GAM的平滑复杂度诊断与可加性模型类似，但需要考虑分布特性的影响。</p>
<div class="sourceCode" id="cb2304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2304-1"><a href="高级回归模型.html#cb2304-1" tabindex="-1"></a><span class="co"># 检查平滑复杂度是否足够</span></span>
<span id="cb2304-2"><a href="高级回归模型.html#cb2304-2" tabindex="-1"></a><span class="fu">gam.check</span>(bird_gam)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-20-1"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-20-1.png" alt="广义可加模型平滑复杂度诊断图" width="672" />
<p class="caption">
图10.8: 广义可加模型平滑复杂度诊断图
</p>
</div>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 13 iterations.
## Gradient range [-9.091641e-08,2.341445e-06]
## (score 0.9738072 &amp; scale 1).
## Hessian positive definite, eigenvalue range [1.575987e-05,0.008520077].
## Model rank =  28 / 28 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                    k&#39;  edf k-index p-value    
## s(elevation)     9.00 9.00    0.61  &lt;2e-16 ***
## s(temperature)   9.00 1.73    1.10     0.9    
## s(precipitation) 9.00 4.14    1.18     1.0    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb2306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2306-1"><a href="高级回归模型.html#cb2306-1" tabindex="-1"></a><span class="co"># 输出解释：</span></span>
<span id="cb2306-2"><a href="高级回归模型.html#cb2306-2" tabindex="-1"></a><span class="co"># 对于GAM，还需要检查离散参数和残差模式</span></span>
<span id="cb2306-3"><a href="高级回归模型.html#cb2306-3" tabindex="-1"></a><span class="co"># 如果存在过度离散，可能需要调整分布类型</span></span>
<span id="cb2306-4"><a href="高级回归模型.html#cb2306-4" tabindex="-1"></a></span>
<span id="cb2306-5"><a href="高级回归模型.html#cb2306-5" tabindex="-1"></a><span class="co"># 调整k值处理wiggliness不足</span></span>
<span id="cb2306-6"><a href="高级回归模型.html#cb2306-6" tabindex="-1"></a>bird_gam_adj <span class="ot">&lt;-</span> <span class="fu">gam</span>(</span>
<span id="cb2306-7"><a href="高级回归模型.html#cb2306-7" tabindex="-1"></a>  species_richness <span class="sc">~</span> <span class="fu">s</span>(elevation, <span class="at">k =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb2306-8"><a href="高级回归模型.html#cb2306-8" tabindex="-1"></a>    <span class="fu">s</span>(temperature, <span class="at">k =</span> <span class="dv">10</span>) <span class="sc">+</span> <span class="fu">s</span>(precipitation, <span class="at">k =</span> <span class="dv">10</span>),</span>
<span id="cb2306-9"><a href="高级回归模型.html#cb2306-9" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb2306-10"><a href="高级回归模型.html#cb2306-10" tabindex="-1"></a>  <span class="at">data =</span> bird_data</span>
<span id="cb2306-11"><a href="高级回归模型.html#cb2306-11" tabindex="-1"></a>)</span>
<span id="cb2306-12"><a href="高级回归模型.html#cb2306-12" tabindex="-1"></a><span class="fu">gam.check</span>(bird_gam_adj)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-20-2"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-20-2.png" alt="广义可加模型平滑复杂度诊断图" width="672" />
<p class="caption">
图10.9: 广义可加模型平滑复杂度诊断图
</p>
</div>
<pre><code>## 
## Method: UBRE   Optimizer: outer newton
## full convergence after 7 iterations.
## Gradient range [-6.852114e-10,1.725394e-07]
## (score 0.3617171 &amp; scale 1).
## Hessian positive definite, eigenvalue range [0.0005649018,0.004225529].
## Model rank =  33 / 33 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k&#39;.
## 
##                     k&#39;   edf k-index p-value   
## s(elevation)     14.00 13.96    0.78    0.01 **
## s(temperature)    9.00  4.15    1.13    0.96   
## s(precipitation)  9.00  5.07    1.00    0.47   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="残差诊断-2" class="section level4 hasAnchor" number="10.4.6.3">
<h4><span class="header-section-number">10.4.6.3</span> 残差诊断<a href="高级回归模型.html#残差诊断-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>GAM的残差诊断需要考虑分布特性和连接函数的影响。</p>
<div class="sourceCode" id="cb2308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2308-1"><a href="高级回归模型.html#cb2308-1" tabindex="-1"></a><span class="co"># 残差诊断图</span></span>
<span id="cb2308-2"><a href="高级回归模型.html#cb2308-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb2308-3"><a href="高级回归模型.html#cb2308-3" tabindex="-1"></a></span>
<span id="cb2308-4"><a href="高级回归模型.html#cb2308-4" tabindex="-1"></a><span class="co"># 残差与拟合值图（使用皮尔逊残差）</span></span>
<span id="cb2308-5"><a href="高级回归模型.html#cb2308-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(bird_gam), <span class="fu">residuals</span>(bird_gam, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>),</span>
<span id="cb2308-6"><a href="高级回归模型.html#cb2308-6" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;拟合值&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;皮尔逊残差&quot;</span>,</span>
<span id="cb2308-7"><a href="高级回归模型.html#cb2308-7" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;残差 vs 拟合值&quot;</span></span>
<span id="cb2308-8"><a href="高级回归模型.html#cb2308-8" tabindex="-1"></a>)</span>
<span id="cb2308-9"><a href="高级回归模型.html#cb2308-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb2308-10"><a href="高级回归模型.html#cb2308-10" tabindex="-1"></a></span>
<span id="cb2308-11"><a href="高级回归模型.html#cb2308-11" tabindex="-1"></a><span class="co"># Q-Q图检查残差分布</span></span>
<span id="cb2308-12"><a href="高级回归模型.html#cb2308-12" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">residuals</span>(bird_gam, <span class="at">type =</span> <span class="st">&quot;deviance&quot;</span>))</span>
<span id="cb2308-13"><a href="高级回归模型.html#cb2308-13" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">residuals</span>(bird_gam, <span class="at">type =</span> <span class="st">&quot;deviance&quot;</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb2308-14"><a href="高级回归模型.html#cb2308-14" tabindex="-1"></a></span>
<span id="cb2308-15"><a href="高级回归模型.html#cb2308-15" tabindex="-1"></a><span class="co"># 残差与预测变量关系图</span></span>
<span id="cb2308-16"><a href="高级回归模型.html#cb2308-16" tabindex="-1"></a><span class="fu">plot</span>(bird_data<span class="sc">$</span>elevation, <span class="fu">residuals</span>(bird_gam, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>),</span>
<span id="cb2308-17"><a href="高级回归模型.html#cb2308-17" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;海拔&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;皮尔逊残差&quot;</span>,</span>
<span id="cb2308-18"><a href="高级回归模型.html#cb2308-18" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;残差 vs 海拔&quot;</span></span>
<span id="cb2308-19"><a href="高级回归模型.html#cb2308-19" tabindex="-1"></a>)</span>
<span id="cb2308-20"><a href="高级回归模型.html#cb2308-20" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb2308-21"><a href="高级回归模型.html#cb2308-21" tabindex="-1"></a></span>
<span id="cb2308-22"><a href="高级回归模型.html#cb2308-22" tabindex="-1"></a><span class="co"># 尺度-位置图</span></span>
<span id="cb2308-23"><a href="高级回归模型.html#cb2308-23" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(bird_gam), <span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">residuals</span>(bird_gam, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>))),</span>
<span id="cb2308-24"><a href="高级回归模型.html#cb2308-24" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;拟合值&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;标准化残差的平方根&quot;</span>,</span>
<span id="cb2308-25"><a href="高级回归模型.html#cb2308-25" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;尺度-位置图&quot;</span></span>
<span id="cb2308-26"><a href="高级回归模型.html#cb2308-26" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-21"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-21-1.png" alt="广义可加模型残差诊断图" width="672" />
<p class="caption">
图2.14: 广义可加模型残差诊断图
</p>
</div>
</div>
<div id="模型比较与选择-1" class="section level4 hasAnchor" number="10.4.6.4">
<h4><span class="header-section-number">10.4.6.4</span> 模型比较与选择<a href="高级回归模型.html#模型比较与选择-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>比较不同分布、连接函数和平滑复杂度的GAM模型。</p>
<div class="sourceCode" id="cb2309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2309-1"><a href="高级回归模型.html#cb2309-1" tabindex="-1"></a><span class="co"># 比较不同分布的GAM</span></span>
<span id="cb2309-2"><a href="高级回归模型.html#cb2309-2" tabindex="-1"></a>model_poisson <span class="ot">&lt;-</span> <span class="fu">gam</span>(species_richness <span class="sc">~</span> <span class="fu">s</span>(elevation) <span class="sc">+</span> <span class="fu">s</span>(temperature) <span class="sc">+</span> <span class="fu">s</span>(precipitation),</span>
<span id="cb2309-3"><a href="高级回归模型.html#cb2309-3" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb2309-4"><a href="高级回归模型.html#cb2309-4" tabindex="-1"></a>  <span class="at">data =</span> bird_data</span>
<span id="cb2309-5"><a href="高级回归模型.html#cb2309-5" tabindex="-1"></a>)</span>
<span id="cb2309-6"><a href="高级回归模型.html#cb2309-6" tabindex="-1"></a></span>
<span id="cb2309-7"><a href="高级回归模型.html#cb2309-7" tabindex="-1"></a>model_nb <span class="ot">&lt;-</span> <span class="fu">gam</span>(species_richness <span class="sc">~</span> <span class="fu">s</span>(elevation) <span class="sc">+</span> <span class="fu">s</span>(temperature) <span class="sc">+</span> <span class="fu">s</span>(precipitation),</span>
<span id="cb2309-8"><a href="高级回归模型.html#cb2309-8" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nb</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb2309-9"><a href="高级回归模型.html#cb2309-9" tabindex="-1"></a>  <span class="at">data =</span> bird_data</span>
<span id="cb2309-10"><a href="高级回归模型.html#cb2309-10" tabindex="-1"></a>)</span>
<span id="cb2309-11"><a href="高级回归模型.html#cb2309-11" tabindex="-1"></a></span>
<span id="cb2309-12"><a href="高级回归模型.html#cb2309-12" tabindex="-1"></a>model_quasipoisson <span class="ot">&lt;-</span> <span class="fu">gam</span>(species_richness <span class="sc">~</span> <span class="fu">s</span>(elevation) <span class="sc">+</span> <span class="fu">s</span>(temperature) <span class="sc">+</span> <span class="fu">s</span>(precipitation),</span>
<span id="cb2309-13"><a href="高级回归模型.html#cb2309-13" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb2309-14"><a href="高级回归模型.html#cb2309-14" tabindex="-1"></a>  <span class="at">data =</span> bird_data</span>
<span id="cb2309-15"><a href="高级回归模型.html#cb2309-15" tabindex="-1"></a>)</span>
<span id="cb2309-16"><a href="高级回归模型.html#cb2309-16" tabindex="-1"></a></span>
<span id="cb2309-17"><a href="高级回归模型.html#cb2309-17" tabindex="-1"></a><span class="co"># 使用AIC比较模型（注意：准泊松分布没有AIC）</span></span>
<span id="cb2309-18"><a href="高级回归模型.html#cb2309-18" tabindex="-1"></a><span class="fu">AIC</span>(model_poisson, model_nb)</span></code></pre></div>
<pre><code>##                     df      AIC
## model_poisson 15.86803 1099.017
## model_nb      15.77724 1080.255</code></pre>
<div class="sourceCode" id="cb2311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2311-1"><a href="高级回归模型.html#cb2311-1" tabindex="-1"></a><span class="co"># 比较不同连接函数</span></span>
<span id="cb2311-2"><a href="高级回归模型.html#cb2311-2" tabindex="-1"></a>model_log <span class="ot">&lt;-</span> <span class="fu">gam</span>(species_richness <span class="sc">~</span> <span class="fu">s</span>(elevation) <span class="sc">+</span> <span class="fu">s</span>(temperature) <span class="sc">+</span> <span class="fu">s</span>(precipitation),</span>
<span id="cb2311-3"><a href="高级回归模型.html#cb2311-3" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb2311-4"><a href="高级回归模型.html#cb2311-4" tabindex="-1"></a>  <span class="at">data =</span> bird_data</span>
<span id="cb2311-5"><a href="高级回归模型.html#cb2311-5" tabindex="-1"></a>)</span>
<span id="cb2311-6"><a href="高级回归模型.html#cb2311-6" tabindex="-1"></a></span>
<span id="cb2311-7"><a href="高级回归模型.html#cb2311-7" tabindex="-1"></a>model_identity <span class="ot">&lt;-</span> <span class="fu">gam</span>(species_richness <span class="sc">~</span> <span class="fu">s</span>(elevation) <span class="sc">+</span> <span class="fu">s</span>(temperature) <span class="sc">+</span> <span class="fu">s</span>(precipitation),</span>
<span id="cb2311-8"><a href="高级回归模型.html#cb2311-8" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;identity&quot;</span>),</span>
<span id="cb2311-9"><a href="高级回归模型.html#cb2311-9" tabindex="-1"></a>  <span class="at">data =</span> bird_data</span>
<span id="cb2311-10"><a href="高级回归模型.html#cb2311-10" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced
## Warning in log(y/mu): NaNs produced</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : Fitting terminated with step failure - check results carefully</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated due to divergence</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds
## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 step size truncated: out of bounds</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 algorithm did not converge</code></pre>
<pre><code>## Warning in newton(lsp = lsp, X = G$X, y = G$y, Eb = G$Eb, UrS = G$UrS, L = G$L,
## : gam.fit3 algorithm stopped at boundary value</code></pre>
<div class="sourceCode" id="cb2364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2364-1"><a href="高级回归模型.html#cb2364-1" tabindex="-1"></a><span class="fu">AIC</span>(model_log, model_identity)</span></code></pre></div>
<pre><code>##                       df      AIC
## model_log      15.868031 1099.017
## model_identity  8.127726 2518.953</code></pre>
</div>
<div id="预测性能评估-1" class="section level4 hasAnchor" number="10.4.6.5">
<h4><span class="header-section-number">10.4.6.5</span> 预测性能评估<a href="高级回归模型.html#预测性能评估-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>评估GAM在新数据上的预测性能，特别关注分布特性的影响。</p>
<div class="sourceCode" id="cb2366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2366-1"><a href="高级回归模型.html#cb2366-1" tabindex="-1"></a><span class="co"># 交叉验证评估</span></span>
<span id="cb2366-2"><a href="高级回归模型.html#cb2366-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2366-3"><a href="高级回归模型.html#cb2366-3" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(bird_data), <span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(bird_data))</span>
<span id="cb2366-4"><a href="高级回归模型.html#cb2366-4" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> bird_data[train_indices, ]</span>
<span id="cb2366-5"><a href="高级回归模型.html#cb2366-5" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> bird_data[<span class="sc">-</span>train_indices, ]</span>
<span id="cb2366-6"><a href="高级回归模型.html#cb2366-6" tabindex="-1"></a></span>
<span id="cb2366-7"><a href="高级回归模型.html#cb2366-7" tabindex="-1"></a><span class="co"># 在训练集上构建模型</span></span>
<span id="cb2366-8"><a href="高级回归模型.html#cb2366-8" tabindex="-1"></a>cv_model <span class="ot">&lt;-</span> <span class="fu">gam</span>(species_richness <span class="sc">~</span> <span class="fu">s</span>(elevation) <span class="sc">+</span> <span class="fu">s</span>(temperature) <span class="sc">+</span> <span class="fu">s</span>(precipitation),</span>
<span id="cb2366-9"><a href="高级回归模型.html#cb2366-9" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">&quot;log&quot;</span>),</span>
<span id="cb2366-10"><a href="高级回归模型.html#cb2366-10" tabindex="-1"></a>  <span class="at">data =</span> train_data</span>
<span id="cb2366-11"><a href="高级回归模型.html#cb2366-11" tabindex="-1"></a>)</span>
<span id="cb2366-12"><a href="高级回归模型.html#cb2366-12" tabindex="-1"></a></span>
<span id="cb2366-13"><a href="高级回归模型.html#cb2366-13" tabindex="-1"></a><span class="co"># 在测试集上预测</span></span>
<span id="cb2366-14"><a href="高级回归模型.html#cb2366-14" tabindex="-1"></a>test_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(cv_model, <span class="at">newdata =</span> test_data, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb2366-15"><a href="高级回归模型.html#cb2366-15" tabindex="-1"></a></span>
<span id="cb2366-16"><a href="高级回归模型.html#cb2366-16" tabindex="-1"></a><span class="co"># 计算预测性能（注意计数数据的评估指标）</span></span>
<span id="cb2366-17"><a href="高级回归模型.html#cb2366-17" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test_data<span class="sc">$</span>species_richness <span class="sc">-</span> test_predictions)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb2366-18"><a href="高级回归模型.html#cb2366-18" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(test_data<span class="sc">$</span>species_richness <span class="sc">-</span> test_predictions))</span>
<span id="cb2366-19"><a href="高级回归模型.html#cb2366-19" tabindex="-1"></a></span>
<span id="cb2366-20"><a href="高级回归模型.html#cb2366-20" tabindex="-1"></a><span class="co"># 对于计数数据，还可以计算预测准确率</span></span>
<span id="cb2366-21"><a href="高级回归模型.html#cb2366-21" tabindex="-1"></a>predicted_counts <span class="ot">&lt;-</span> <span class="fu">round</span>(test_predictions)</span>
<span id="cb2366-22"><a href="高级回归模型.html#cb2366-22" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">mean</span>(predicted_counts <span class="sc">==</span> test_data<span class="sc">$</span>species_richness)</span>
<span id="cb2366-23"><a href="高级回归模型.html#cb2366-23" tabindex="-1"></a></span>
<span id="cb2366-24"><a href="高级回归模型.html#cb2366-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;RMSE:&quot;</span>, rmse, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## RMSE: 14.34104</code></pre>
<div class="sourceCode" id="cb2368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2368-1"><a href="高级回归模型.html#cb2368-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MAE:&quot;</span>, mae, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MAE: 10.42365</code></pre>
<div class="sourceCode" id="cb2370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2370-1"><a href="高级回归模型.html#cb2370-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;分类准确率:&quot;</span>, accuracy, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 分类准确率: 0.1333333</code></pre>
<div class="sourceCode" id="cb2372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2372-1"><a href="高级回归模型.html#cb2372-1" tabindex="-1"></a><span class="co"># 预测区间（考虑分布特性）</span></span>
<span id="cb2372-2"><a href="高级回归模型.html#cb2372-2" tabindex="-1"></a>new_elevation <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2372-3"><a href="高级回归模型.html#cb2372-3" tabindex="-1"></a>  <span class="at">elevation =</span> <span class="fu">seq</span>(<span class="dv">100</span>, <span class="dv">3000</span>, <span class="at">length =</span> <span class="dv">50</span>),</span>
<span id="cb2372-4"><a href="高级回归模型.html#cb2372-4" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">mean</span>(bird_data<span class="sc">$</span>temperature),</span>
<span id="cb2372-5"><a href="高级回归模型.html#cb2372-5" tabindex="-1"></a>  <span class="at">precipitation =</span> <span class="fu">mean</span>(bird_data<span class="sc">$</span>precipitation)</span>
<span id="cb2372-6"><a href="高级回归模型.html#cb2372-6" tabindex="-1"></a>)</span>
<span id="cb2372-7"><a href="高级回归模型.html#cb2372-7" tabindex="-1"></a></span>
<span id="cb2372-8"><a href="高级回归模型.html#cb2372-8" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(bird_gam,</span>
<span id="cb2372-9"><a href="高级回归模型.html#cb2372-9" tabindex="-1"></a>  <span class="at">newdata =</span> new_elevation,</span>
<span id="cb2372-10"><a href="高级回归模型.html#cb2372-10" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span></span>
<span id="cb2372-11"><a href="高级回归模型.html#cb2372-11" tabindex="-1"></a>)</span>
<span id="cb2372-12"><a href="高级回归模型.html#cb2372-12" tabindex="-1"></a>new_elevation<span class="sc">$</span>pred <span class="ot">&lt;-</span> predictions<span class="sc">$</span>fit</span>
<span id="cb2372-13"><a href="高级回归模型.html#cb2372-13" tabindex="-1"></a>new_elevation<span class="sc">$</span>lower <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(new_elevation<span class="sc">$</span>pred) <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> predictions<span class="sc">$</span>se.fit)</span>
<span id="cb2372-14"><a href="高级回归模型.html#cb2372-14" tabindex="-1"></a>new_elevation<span class="sc">$</span>upper <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(new_elevation<span class="sc">$</span>pred) <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> predictions<span class="sc">$</span>se.fit)</span>
<span id="cb2372-15"><a href="高级回归模型.html#cb2372-15" tabindex="-1"></a></span>
<span id="cb2372-16"><a href="高级回归模型.html#cb2372-16" tabindex="-1"></a><span class="co"># 可视化预测区间</span></span>
<span id="cb2372-17"><a href="高级回归模型.html#cb2372-17" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2372-18"><a href="高级回归模型.html#cb2372-18" tabindex="-1"></a><span class="fu">ggplot</span>(new_elevation, <span class="fu">aes</span>(<span class="at">x =</span> elevation, <span class="at">y =</span> pred)) <span class="sc">+</span></span>
<span id="cb2372-19"><a href="高级回归模型.html#cb2372-19" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb2372-20"><a href="高级回归模型.html#cb2372-20" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2372-21"><a href="高级回归模型.html#cb2372-21" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2372-22"><a href="高级回归模型.html#cb2372-22" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;海拔 (m)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;预测物种丰富度&quot;</span>,</span>
<span id="cb2372-23"><a href="高级回归模型.html#cb2372-23" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;海拔对鸟类物种丰富度的影响（含95%置信区间）&quot;</span></span>
<span id="cb2372-24"><a href="高级回归模型.html#cb2372-24" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2372-25"><a href="高级回归模型.html#cb2372-25" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="生态学意义验证-2" class="section level4 hasAnchor" number="10.4.6.6">
<h4><span class="header-section-number">10.4.6.6</span> 生态学意义验证<a href="高级回归模型.html#生态学意义验证-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>GAM结果的生态学验证需要同时考虑非线性关系和分布特性：</p>
<ol style="list-style-type: decimal">
<li><p><strong>生物学合理性</strong>：平滑函数的形状是否符合生态学机制？例如，物种丰富度随海拔的变化是否呈现单峰模式？</p></li>
<li><p><strong>分布假设验证</strong>：所选分布是否真实反映了数据的变异性特征？例如，计数数据是否确实服从泊松分布？</p></li>
<li><p><strong>效应大小</strong>：环境因子的变化是否对应有意义的生态效应？例如，海拔变化500米是否导致物种丰富度的显著变化？</p></li>
<li><p><strong>预测能力</strong>：模型在新生态系统或不同时间点的预测表现如何？</p></li>
</ol>
<p>通过系统的模型诊断和谨慎的结果解释，我们可以确保GAM分析为生态学研究提供可靠的科学依据。</p>
<p>GAM为生态学家提供了一个极其灵活和强大的建模工具，特别适合处理生态系统中常见的复杂非线性关系和异质性数据。通过合理使用GAM，我们能够更准确地描述和理解生态过程，为生态保护和管理提供更可靠的科学依据。</p>
</div>
</div>
</div>
<div id="混合效应模型" class="section level2 hasAnchor" number="10.5">
<h2><span class="header-section-number">10.5</span> 混合效应模型<a href="高级回归模型.html#混合效应模型" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在生态学研究中，我们经常面临一个根本性的挑战：生态系统的层次结构与统计模型的简化假设之间的不匹配。传统的回归模型假设所有观测值都是独立的，但在真实的生态系统中，观测值往往以嵌套或分层的结构存在。例如，当我们研究森林动态时，我们可能在多个样地中设置多个样方，在多个年份重复观测同一地点；当我们研究鸟类繁殖成功时，我们可能观测同一对亲鸟在不同年份的繁殖表现；当我们研究植物生长时，我们可能测量同一植株在不同时间的生长量。这种层次结构数据产生了复杂的相关性：空间自相关使得相邻样方的观测值往往相似；时间自相关使得同一地点的连续观测值相互依赖；组内相关使得同一群组内的个体共享某些未观测特征。混合效应模型正是为解决这类问题而发展起来的，它通过区分固定效应和随机效应，能够正确处理这种层次结构数据，为生态学研究提供了更强大的分析工具。</p>
<div id="固定效应与随机效应的生态学概念" class="section level3 hasAnchor" number="10.5.1">
<h3><span class="header-section-number">10.5.1</span> 固定效应与随机效应的生态学概念<a href="高级回归模型.html#固定效应与随机效应的生态学概念" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>要理解混合效应模型，我们首先需要明确固定效应和随机效应的概念。固定效应描述的是总体水平的系统性模式，是我们研究的主要兴趣所在。例如，在研究温度对植物生长的影响时，温度效应通常被视为固定效应，因为我们关心的是温度变化如何系统地影响植物生长，这种效应在所有研究地点和所有年份都应该存在。固定效应代表了可重复的、系统性的影响，其参数估计具有明确的生态学解释：在其他条件不变的情况下，温度每升高1°C，植物生长速率平均增加多少。</p>
<p>随机效应则描述了组间变异和组内相关性，捕捉的是数据层次结构中不可重复的随机变异。例如，在研究不同森林样地中树木生长对气候的响应时，每个样地的地理位置、土壤特性、微气候条件等因素都会导致样地间的差异。这些样地特异性效应通常被视为随机效应，因为我们并不关心每个具体样地的效应大小，而是关心样地间变异的整体模式。随机效应代表了抽样变异、未观测异质性或自然变异，其参数估计描述了组间变异的程度。</p>
<p>让我们通过一个具体的生态学例子来理解这两个概念的区别。假设我们研究不同湖泊中浮游植物生物量对营养盐浓度的响应。我们选择了10个湖泊，在每个湖泊中设置了5个采样点，每月采样一次，持续一年。在这个研究中，营养盐浓度对浮游植物生物量的影响是固定效应，因为我们关心的是营养盐浓度变化如何系统地影响浮游植物生长，这种关系在所有湖泊中都应该存在。而湖泊效应（不同湖泊间的差异）和采样点效应（同一湖泊内不同位置的差异）则是随机效应，因为这些效应代表了抽样变异和未观测的湖泊特性差异。</p>
</div>
<div id="混合效应模型的数学框架" class="section level3 hasAnchor" number="10.5.2">
<h3><span class="header-section-number">10.5.2</span> 混合效应模型的数学框架<a href="高级回归模型.html#混合效应模型的数学框架" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>混合效应模型的基本数学形式为：</p>
<p><span class="math display">\[y_{ij} = \beta_0 + \beta_1 x_{ij} + u_j + \varepsilon_{ij}\]</span></p>
<p>其中<span class="math inline">\(y_{ij}\)</span>是第<span class="math inline">\(j\)</span>组中第<span class="math inline">\(i\)</span>个观测的响应变量，<span class="math inline">\(x_{ij}\)</span>是相应的预测变量，<span class="math inline">\(\beta_0\)</span>和<span class="math inline">\(\beta_1\)</span>是固定效应参数，<span class="math inline">\(u_j\)</span>是第<span class="math inline">\(j\)</span>组的随机效应，<span class="math inline">\(\varepsilon_{ij}\)</span>是残差项。随机效应<span class="math inline">\(u_j\)</span>通常假设服从正态分布<span class="math inline">\(u_j \sim N(0, \sigma^2_u)\)</span>，残差<span class="math inline">\(\varepsilon_{ij}\)</span>也假设服从正态分布<span class="math inline">\(\varepsilon_{ij} \sim N(0, \sigma^2_\varepsilon)\)</span>。</p>
<p>这个模型的关键在于它同时包含了固定效应和随机效应：固定效应<span class="math inline">\(\beta_0 + \beta_1 x_{ij}\)</span>描述了总体水平的系统性模式，而随机效应<span class="math inline">\(u_j\)</span>捕捉了组间变异。模型的方差由两部分组成：组间方差<span class="math inline">\(\sigma^2_u\)</span>和组内方差<span class="math inline">\(\sigma^2_\varepsilon\)</span>。组内相关系数（ICC）定义为<span class="math inline">\(\rho = \sigma^2_u / (\sigma^2_u + \sigma^2_\varepsilon)\)</span>，反映了组内观测值的相似程度。</p>
</div>
<div id="r语言中的混合效应模型实现" class="section level3 hasAnchor" number="10.5.3">
<h3><span class="header-section-number">10.5.3</span> R语言中的混合效应模型实现<a href="高级回归模型.html#r语言中的混合效应模型实现" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在R语言中，混合效应模型主要通过<code>lme4</code>包实现，该包提供了<code>lmer()</code>函数用于线性混合模型和<code>glmer()</code>函数用于广义线性混合模型。这些函数的基本语法为：</p>
<div class="sourceCode" id="cb2373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2373-1"><a href="高级回归模型.html#cb2373-1" tabindex="-1"></a><span class="co"># 线性混合模型</span></span>
<span id="cb2373-2"><a href="高级回归模型.html#cb2373-2" tabindex="-1"></a><span class="fu">lmer</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> group), <span class="at">data =</span> dataset)</span>
<span id="cb2373-3"><a href="高级回归模型.html#cb2373-3" tabindex="-1"></a></span>
<span id="cb2373-4"><a href="高级回归模型.html#cb2373-4" tabindex="-1"></a><span class="co"># 广义线性混合模型（如逻辑混合模型）</span></span>
<span id="cb2373-5"><a href="高级回归模型.html#cb2373-5" tabindex="-1"></a><span class="fu">glmer</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> group), <span class="at">family =</span> binomial, <span class="at">data =</span> dataset)</span></code></pre></div>
<p>其中<code>(1 | group)</code>表示在<code>group</code>变量上拟合随机截距。我们还可以拟合更复杂的随机效应结构，如随机斜率模型：</p>
<div class="sourceCode" id="cb2374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2374-1"><a href="高级回归模型.html#cb2374-1" tabindex="-1"></a><span class="co"># 随机截距和随机斜率模型</span></span>
<span id="cb2374-2"><a href="高级回归模型.html#cb2374-2" tabindex="-1"></a><span class="fu">lmer</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> x1 <span class="sc">|</span> group), <span class="at">data =</span> dataset)</span></code></pre></div>
<p>让我们通过一个具体的生态学例子来演示混合效应模型的应用。假设我们研究不同森林样地中树木直径生长对环境因子的响应：</p>
<div class="sourceCode" id="cb2375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2375-1"><a href="高级回归模型.html#cb2375-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb2375-2"><a href="高级回归模型.html#cb2375-2" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code></pre></div>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;lme4&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:nlme&#39;:
## 
##     lmList</code></pre>
<div class="sourceCode" id="cb2379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2379-1"><a href="高级回归模型.html#cb2379-1" tabindex="-1"></a><span class="fu">library</span>(lmerTest)  <span class="co"># 提供p值</span></span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;lmerTest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     lmer</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     step</code></pre>
<div class="sourceCode" id="cb2383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2383-1"><a href="高级回归模型.html#cb2383-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2383-2"><a href="高级回归模型.html#cb2383-2" tabindex="-1"></a></span>
<span id="cb2383-3"><a href="高级回归模型.html#cb2383-3" tabindex="-1"></a><span class="co"># 模拟生态学数据：不同样地中树木生长与环境因子的关系</span></span>
<span id="cb2383-4"><a href="高级回归模型.html#cb2383-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2383-5"><a href="高级回归模型.html#cb2383-5" tabindex="-1"></a>n_plots <span class="ot">&lt;-</span> <span class="dv">20</span>  <span class="co"># 20个样地</span></span>
<span id="cb2383-6"><a href="高级回归模型.html#cb2383-6" tabindex="-1"></a>n_trees_per_plot <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># 每个样地10棵树</span></span>
<span id="cb2383-7"><a href="高级回归模型.html#cb2383-7" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> n_plots <span class="sc">*</span> n_trees_per_plot</span>
<span id="cb2383-8"><a href="高级回归模型.html#cb2383-8" tabindex="-1"></a></span>
<span id="cb2383-9"><a href="高级回归模型.html#cb2383-9" tabindex="-1"></a><span class="co"># 创建数据集</span></span>
<span id="cb2383-10"><a href="高级回归模型.html#cb2383-10" tabindex="-1"></a>tree_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2383-11"><a href="高级回归模型.html#cb2383-11" tabindex="-1"></a>  <span class="at">plot_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_plots, <span class="at">each =</span> n_trees_per_plot),</span>
<span id="cb2383-12"><a href="高级回归模型.html#cb2383-12" tabindex="-1"></a>  <span class="at">tree_id =</span> <span class="dv">1</span><span class="sc">:</span>n_total,</span>
<span id="cb2383-13"><a href="高级回归模型.html#cb2383-13" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">runif</span>(n_total, <span class="dv">15</span>, <span class="dv">25</span>),  <span class="co"># 温度(°C)</span></span>
<span id="cb2383-14"><a href="高级回归模型.html#cb2383-14" tabindex="-1"></a>  <span class="at">soil_moisture =</span> <span class="fu">runif</span>(n_total, <span class="fl">0.3</span>, <span class="fl">0.8</span>)  <span class="co"># 土壤湿度</span></span>
<span id="cb2383-15"><a href="高级回归模型.html#cb2383-15" tabindex="-1"></a>)</span>
<span id="cb2383-16"><a href="高级回归模型.html#cb2383-16" tabindex="-1"></a></span>
<span id="cb2383-17"><a href="高级回归模型.html#cb2383-17" tabindex="-1"></a><span class="co"># 模拟随机效应（样地特异性效应）</span></span>
<span id="cb2383-18"><a href="高级回归模型.html#cb2383-18" tabindex="-1"></a>plot_effects <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_plots, <span class="dv">0</span>, <span class="dv">2</span>)  <span class="co"># 样地随机效应，标准差为2</span></span>
<span id="cb2383-19"><a href="高级回归模型.html#cb2383-19" tabindex="-1"></a></span>
<span id="cb2383-20"><a href="高级回归模型.html#cb2383-20" tabindex="-1"></a><span class="co"># 模拟树木直径生长（mm/年）</span></span>
<span id="cb2383-21"><a href="高级回归模型.html#cb2383-21" tabindex="-1"></a>tree_data<span class="sc">$</span>growth_rate <span class="ot">&lt;-</span> (</span>
<span id="cb2383-22"><a href="高级回归模型.html#cb2383-22" tabindex="-1"></a>  <span class="dv">5</span> <span class="sc">+</span>  <span class="co"># 总体平均生长速率</span></span>
<span id="cb2383-23"><a href="高级回归模型.html#cb2383-23" tabindex="-1"></a>  <span class="fl">0.3</span> <span class="sc">*</span> tree_data<span class="sc">$</span>temperature <span class="sc">+</span>  <span class="co"># 温度固定效应</span></span>
<span id="cb2383-24"><a href="高级回归模型.html#cb2383-24" tabindex="-1"></a>  <span class="dv">2</span> <span class="sc">*</span> tree_data<span class="sc">$</span>soil_moisture <span class="sc">+</span>  <span class="co"># 土壤湿度固定效应</span></span>
<span id="cb2383-25"><a href="高级回归模型.html#cb2383-25" tabindex="-1"></a>  plot_effects[tree_data<span class="sc">$</span>plot_id] <span class="sc">+</span>  <span class="co"># 样地随机效应</span></span>
<span id="cb2383-26"><a href="高级回归模型.html#cb2383-26" tabindex="-1"></a>  <span class="fu">rnorm</span>(n_total, <span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># 残差</span></span>
<span id="cb2383-27"><a href="高级回归模型.html#cb2383-27" tabindex="-1"></a>)</span>
<span id="cb2383-28"><a href="高级回归模型.html#cb2383-28" tabindex="-1"></a></span>
<span id="cb2383-29"><a href="高级回归模型.html#cb2383-29" tabindex="-1"></a><span class="co"># 构建混合效应模型</span></span>
<span id="cb2383-30"><a href="高级回归模型.html#cb2383-30" tabindex="-1"></a>mixed_model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(growth_rate <span class="sc">~</span> temperature <span class="sc">+</span> soil_moisture <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> plot_id),</span>
<span id="cb2383-31"><a href="高级回归模型.html#cb2383-31" tabindex="-1"></a>                    <span class="at">data =</span> tree_data)</span>
<span id="cb2383-32"><a href="高级回归模型.html#cb2383-32" tabindex="-1"></a></span>
<span id="cb2383-33"><a href="高级回归模型.html#cb2383-33" tabindex="-1"></a><span class="co"># 模型摘要</span></span>
<span id="cb2383-34"><a href="高级回归模型.html#cb2383-34" tabindex="-1"></a><span class="fu">summary</span>(mixed_model)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: growth_rate ~ temperature + soil_moisture + (1 | plot_id)
##    Data: tree_data
## 
## REML criterion at convergence: 646.8
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -2.57138 -0.54515 -0.02449  0.60327  2.73258 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  plot_id  (Intercept) 4.093    2.023   
##  Residual             1.017    1.008   
## Number of obs: 200, groups:  plot_id, 20
## 
## Fixed effects:
##                Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)     5.09420    0.79212 118.40300   6.431 2.79e-09 ***
## temperature     0.30993    0.02807 179.35891  11.043  &lt; 2e-16 ***
## soil_moisture   1.70695    0.50704 178.71330   3.366 0.000932 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) tmprtr
## temperature -0.738       
## soil_moistr -0.404  0.078</code></pre>
<div class="sourceCode" id="cb2385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2385-1"><a href="高级回归模型.html#cb2385-1" tabindex="-1"></a><span class="co"># 提取固定效应</span></span>
<span id="cb2385-2"><a href="高级回归模型.html#cb2385-2" tabindex="-1"></a><span class="fu">fixef</span>(mixed_model)</span></code></pre></div>
<pre><code>##   (Intercept)   temperature soil_moisture 
##     5.0942042     0.3099343     1.7069529</code></pre>
<div class="sourceCode" id="cb2387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2387-1"><a href="高级回归模型.html#cb2387-1" tabindex="-1"></a><span class="co"># 提取随机效应</span></span>
<span id="cb2387-2"><a href="高级回归模型.html#cb2387-2" tabindex="-1"></a><span class="fu">ranef</span>(mixed_model)</span></code></pre></div>
<pre><code>## $plot_id
##    (Intercept)
## 1   4.14960293
## 2   2.35333672
## 3  -0.72914717
## 4   0.95520659
## 5  -0.71226004
## 6  -0.84272711
## 7  -1.54004417
## 8  -0.63622232
## 9   2.85449107
## 10 -0.09894931
## 11  0.36774383
## 12  0.16171793
## 13  2.26704026
## 14 -1.27157388
## 15 -1.84504203
## 16  3.00407534
## 17 -0.95905811
## 18 -1.86601400
## 19 -2.82573516
## 20 -2.78644137
## 
## with conditional variances for &quot;plot_id&quot;</code></pre>
<div class="sourceCode" id="cb2389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2389-1"><a href="高级回归模型.html#cb2389-1" tabindex="-1"></a><span class="co"># 计算组内相关系数（ICC）</span></span>
<span id="cb2389-2"><a href="高级回归模型.html#cb2389-2" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb2389-3"><a href="高级回归模型.html#cb2389-3" tabindex="-1"></a><span class="fu">icc</span>(mixed_model)</span></code></pre></div>
<pre><code>## # Intraclass Correlation Coefficient
## 
##     Adjusted ICC: 0.801
##   Unadjusted ICC: 0.697</code></pre>
<div class="sourceCode" id="cb2391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2391-1"><a href="高级回归模型.html#cb2391-1" tabindex="-1"></a><span class="co"># 模型诊断</span></span>
<span id="cb2391-2"><a href="高级回归模型.html#cb2391-2" tabindex="-1"></a><span class="fu">plot</span>(mixed_model)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-24-1"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-24-1.png" alt="混合效应模型诊断图" width="672" />
<p class="caption">
图3.2: 混合效应模型诊断图
</p>
</div>
<div class="sourceCode" id="cb2392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2392-1"><a href="高级回归模型.html#cb2392-1" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(mixed_model))</span>
<span id="cb2392-2"><a href="高级回归模型.html#cb2392-2" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(mixed_model))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-24-2"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-24-2.png" alt="混合效应模型诊断图" width="672" />
<p class="caption">
图3.3: 混合效应模型诊断图
</p>
</div>
<div class="sourceCode" id="cb2393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2393-1"><a href="高级回归模型.html#cb2393-1" tabindex="-1"></a><span class="co"># 与普通线性模型比较</span></span>
<span id="cb2393-2"><a href="高级回归模型.html#cb2393-2" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth_rate <span class="sc">~</span> temperature <span class="sc">+</span> soil_moisture, <span class="at">data =</span> tree_data)</span>
<span id="cb2393-3"><a href="高级回归模型.html#cb2393-3" tabindex="-1"></a><span class="fu">AIC</span>(mixed_model, lm_model)</span></code></pre></div>
<pre><code>##             df      AIC
## mixed_model  5 656.8314
## lm_model     4 891.8102</code></pre>
<p>在这个例子中，我们使用了几个关键函数：<code>lmer()</code>用于构建线性混合模型，<code>summary()</code>输出模型摘要（包括固定效应和随机效应的方差分量），<code>fixef()</code>提取固定效应参数，<code>ranef()</code>提取随机效应预测值，<code>icc()</code>计算组内相关系数。</p>
</div>
<div id="固定效应和随机效应的筛选" class="section level3 hasAnchor" number="10.5.4">
<h3><span class="header-section-number">10.5.4</span> 固定效应和随机效应的筛选<a href="高级回归模型.html#固定效应和随机效应的筛选" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在构建混合效应模型时，一个重要的问题是确定哪些效应应该作为固定效应，哪些应该作为随机效应。这个决策通常基于生态学理论和数据结构的考虑，同时也需要通过统计检验来验证模型的合理性。</p>
<p><strong>固定效应的筛选原则</strong>： - 研究的主要兴趣变量通常作为固定效应 - 具有明确生态学解释的系统性因素 - 在研究中可以重复观测的因素 - 通常数量较少，且每个水平都有足够的观测值</p>
<p><strong>随机效应的筛选原则</strong>： - 代表抽样变异或未观测异质性的因素 - 水平数量较多，且每个水平的观测值有限 - 我们关心的是其变异模式而非具体水平效应 - 通常包括地点、时间、个体等层次结构变量</p>
<p><strong>统计筛选方法</strong>： 除了基于生态学理论的筛选原则外，我们还需要通过统计检验来判断模型中各项的显著性。常用的统计筛选方法包括：</p>
<ol style="list-style-type: decimal">
<li><strong>固定效应的统计检验</strong>：
<ul>
<li>使用似然比检验比较包含和不包含某个固定效应的模型</li>
<li>使用Wald检验检验单个固定效应系数的显著性</li>
<li>使用AIC或BIC进行模型比较</li>
</ul></li>
<li><strong>随机效应的统计检验</strong>：
<ul>
<li>使用似然比检验比较包含和不包含某个随机效应的模型</li>
<li>检查随机效应方差分量的置信区间是否包含零</li>
<li>使用参数自举法检验随机效应的显著性</li>
</ul></li>
<li><strong>模型简化策略</strong>：
<ul>
<li>从最复杂的模型开始，逐步移除不显著的项</li>
<li>使用向后选择法，从完整模型开始逐步简化</li>
<li>考虑模型的简约性和生态学解释的平衡</li>
</ul></li>
</ol>
<p>让我们通过另一个生态学例子来演示模型筛选过程。假设我们研究鸟类繁殖成功与环境因子的关系，数据来自多个年份的多个巢箱：</p>
<div class="sourceCode" id="cb2395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2395-1"><a href="高级回归模型.html#cb2395-1" tabindex="-1"></a><span class="co"># 模拟鸟类繁殖数据</span></span>
<span id="cb2395-2"><a href="高级回归模型.html#cb2395-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2395-3"><a href="高级回归模型.html#cb2395-3" tabindex="-1"></a>n_years <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb2395-4"><a href="高级回归模型.html#cb2395-4" tabindex="-1"></a>n_boxes_per_year <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb2395-5"><a href="高级回归模型.html#cb2395-5" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> n_years <span class="sc">*</span> n_boxes_per_year</span>
<span id="cb2395-6"><a href="高级回归模型.html#cb2395-6" tabindex="-1"></a></span>
<span id="cb2395-7"><a href="高级回归模型.html#cb2395-7" tabindex="-1"></a>bird_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2395-8"><a href="高级回归模型.html#cb2395-8" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">rep</span>(<span class="dv">2018</span><span class="sc">:</span><span class="dv">2022</span>, <span class="at">each =</span> n_boxes_per_year),</span>
<span id="cb2395-9"><a href="高级回归模型.html#cb2395-9" tabindex="-1"></a>  <span class="at">box_id =</span> <span class="dv">1</span><span class="sc">:</span>n_total,</span>
<span id="cb2395-10"><a href="高级回归模型.html#cb2395-10" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">runif</span>(n_total, <span class="dv">15</span>, <span class="dv">25</span>),</span>
<span id="cb2395-11"><a href="高级回归模型.html#cb2395-11" tabindex="-1"></a>  <span class="at">rainfall =</span> <span class="fu">runif</span>(n_total, <span class="dv">200</span>, <span class="dv">800</span>),</span>
<span id="cb2395-12"><a href="高级回归模型.html#cb2395-12" tabindex="-1"></a>  <span class="at">predator_pressure =</span> <span class="fu">runif</span>(n_total, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb2395-13"><a href="高级回归模型.html#cb2395-13" tabindex="-1"></a>)</span>
<span id="cb2395-14"><a href="高级回归模型.html#cb2395-14" tabindex="-1"></a></span>
<span id="cb2395-15"><a href="高级回归模型.html#cb2395-15" tabindex="-1"></a><span class="co"># 模拟年份和巢箱的随机效应</span></span>
<span id="cb2395-16"><a href="高级回归模型.html#cb2395-16" tabindex="-1"></a>year_effects <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_years, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb2395-17"><a href="高级回归模型.html#cb2395-17" tabindex="-1"></a>box_effects <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_total, <span class="dv">0</span>, <span class="fl">0.3</span>)</span>
<span id="cb2395-18"><a href="高级回归模型.html#cb2395-18" tabindex="-1"></a></span>
<span id="cb2395-19"><a href="高级回归模型.html#cb2395-19" tabindex="-1"></a><span class="co"># 模拟繁殖成功（成功产下至少一只雏鸟的概率）</span></span>
<span id="cb2395-20"><a href="高级回归模型.html#cb2395-20" tabindex="-1"></a>linear_predictor <span class="ot">&lt;-</span> (</span>
<span id="cb2395-21"><a href="高级回归模型.html#cb2395-21" tabindex="-1"></a>  <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> <span class="co"># 截距</span></span>
<span id="cb2395-22"><a href="高级回归模型.html#cb2395-22" tabindex="-1"></a>    <span class="fl">0.1</span> <span class="sc">*</span> bird_data<span class="sc">$</span>temperature <span class="sc">+</span></span>
<span id="cb2395-23"><a href="高级回归模型.html#cb2395-23" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.002</span> <span class="sc">*</span> bird_data<span class="sc">$</span>rainfall <span class="sc">+</span></span>
<span id="cb2395-24"><a href="高级回归模型.html#cb2395-24" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> bird_data<span class="sc">$</span>predator_pressure <span class="sc">+</span></span>
<span id="cb2395-25"><a href="高级回归模型.html#cb2395-25" tabindex="-1"></a>    year_effects[<span class="fu">as.factor</span>(bird_data<span class="sc">$</span>year)] <span class="sc">+</span></span>
<span id="cb2395-26"><a href="高级回归模型.html#cb2395-26" tabindex="-1"></a>    box_effects</span>
<span id="cb2395-27"><a href="高级回归模型.html#cb2395-27" tabindex="-1"></a>)</span>
<span id="cb2395-28"><a href="高级回归模型.html#cb2395-28" tabindex="-1"></a>bird_data<span class="sc">$</span>success_prob <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>linear_predictor))</span>
<span id="cb2395-29"><a href="高级回归模型.html#cb2395-29" tabindex="-1"></a>bird_data<span class="sc">$</span>success <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_total, <span class="dv">1</span>, bird_data<span class="sc">$</span>success_prob)</span>
<span id="cb2395-30"><a href="高级回归模型.html#cb2395-30" tabindex="-1"></a></span>
<span id="cb2395-31"><a href="高级回归模型.html#cb2395-31" tabindex="-1"></a><span class="co"># 构建不同的混合模型进行比较</span></span>
<span id="cb2395-32"><a href="高级回归模型.html#cb2395-32" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb2395-33"><a href="高级回归模型.html#cb2395-33" tabindex="-1"></a></span>
<span id="cb2395-34"><a href="高级回归模型.html#cb2395-34" tabindex="-1"></a><span class="co"># 模型1：只有固定效应</span></span>
<span id="cb2395-35"><a href="高级回归模型.html#cb2395-35" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(success <span class="sc">~</span> temperature <span class="sc">+</span> rainfall <span class="sc">+</span> predator_pressure,</span>
<span id="cb2395-36"><a href="高级回归模型.html#cb2395-36" tabindex="-1"></a>  <span class="at">family =</span> binomial, <span class="at">data =</span> bird_data</span>
<span id="cb2395-37"><a href="高级回归模型.html#cb2395-37" tabindex="-1"></a>)</span>
<span id="cb2395-38"><a href="高级回归模型.html#cb2395-38" tabindex="-1"></a></span>
<span id="cb2395-39"><a href="高级回归模型.html#cb2395-39" tabindex="-1"></a><span class="co"># 模型2：加入年份随机效应</span></span>
<span id="cb2395-40"><a href="高级回归模型.html#cb2395-40" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(success <span class="sc">~</span> temperature <span class="sc">+</span> rainfall <span class="sc">+</span> predator_pressure <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb2395-41"><a href="高级回归模型.html#cb2395-41" tabindex="-1"></a>  <span class="at">family =</span> binomial, <span class="at">data =</span> bird_data</span>
<span id="cb2395-42"><a href="高级回归模型.html#cb2395-42" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb2397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2397-1"><a href="高级回归模型.html#cb2397-1" tabindex="-1"></a><span class="co"># 模型3：加入年份和巢箱随机效应</span></span>
<span id="cb2397-2"><a href="高级回归模型.html#cb2397-2" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(success <span class="sc">~</span> temperature <span class="sc">+</span> rainfall <span class="sc">+</span> predator_pressure <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> box_id),</span>
<span id="cb2397-3"><a href="高级回归模型.html#cb2397-3" tabindex="-1"></a>  <span class="at">family =</span> binomial, <span class="at">data =</span> bird_data</span>
<span id="cb2397-4"><a href="高级回归模型.html#cb2397-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb2399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2399-1"><a href="高级回归模型.html#cb2399-1" tabindex="-1"></a><span class="co"># 模型比较</span></span>
<span id="cb2399-2"><a href="高级回归模型.html#cb2399-2" tabindex="-1"></a><span class="fu">AIC</span>(model1, model2, model3)</span></code></pre></div>
<pre><code>##        df      AIC
## model1  4 151.9421
## model2  5 153.9421
## model3  6 155.9421</code></pre>
<div class="sourceCode" id="cb2401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2401-1"><a href="高级回归模型.html#cb2401-1" tabindex="-1"></a><span class="co"># 似然比检验</span></span>
<span id="cb2401-2"><a href="高级回归模型.html#cb2401-2" tabindex="-1"></a><span class="fu">anova</span>(model2, model3)</span></code></pre></div>
<pre><code>## Data: bird_data
## Models:
## model2: success ~ temperature + rainfall + predator_pressure + (1 | year)
## model3: success ~ temperature + rainfall + predator_pressure + (1 | year) + (1 | box_id)
##        npar    AIC    BIC  logLik -2*log(L) Chisq Df Pr(&gt;Chisq)
## model2    5 153.94 169.00 -71.971    143.94                    
## model3    6 155.94 174.01 -71.971    143.94     0  1          1</code></pre>
<div class="sourceCode" id="cb2403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2403-1"><a href="高级回归模型.html#cb2403-1" tabindex="-1"></a><span class="co"># 检查模型收敛和奇异拟合</span></span>
<span id="cb2403-2"><a href="高级回归模型.html#cb2403-2" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: success ~ temperature + rainfall + predator_pressure + (1 | year) +  
##     (1 | box_id)
##    Data: bird_data
## 
##       AIC       BIC    logLik -2*log(L)  df.resid 
##     155.9     174.0     -72.0     143.9       144 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.4622 -0.5792 -0.3294  0.5612  5.5904 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  box_id (Intercept) 0        0       
##  year   (Intercept) 0        0       
## Number of obs: 150, groups:  box_id, 150; year, 5
## 
## Fixed effects:
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        0.120726   1.610883   0.075   0.9403    
## temperature        0.093645   0.071469   1.310   0.1901    
## rainfall          -0.003353   0.001332  -2.517   0.0119 *  
## predator_pressure -3.343203   0.849731  -3.934 8.34e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) tmprtr ranfll
## temperature -0.891              
## rainfall    -0.417  0.034       
## prdtr_prssr -0.124 -0.106  0.051
## optimizer (Nelder_Mead) convergence code: 0 (OK)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb2405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2405-1"><a href="高级回归模型.html#cb2405-1" tabindex="-1"></a><span class="fu">isSingular</span>(model3)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb2407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2407-1"><a href="高级回归模型.html#cb2407-1" tabindex="-1"></a><span class="co"># 如果模型过于复杂，考虑简化随机效应结构</span></span>
<span id="cb2407-2"><a href="高级回归模型.html#cb2407-2" tabindex="-1"></a>model_simple <span class="ot">&lt;-</span> <span class="fu">glmer</span>(success <span class="sc">~</span> temperature <span class="sc">+</span> rainfall <span class="sc">+</span> predator_pressure <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb2407-3"><a href="高级回归模型.html#cb2407-3" tabindex="-1"></a>  <span class="at">family =</span> binomial, <span class="at">data =</span> bird_data</span>
<span id="cb2407-4"><a href="高级回归模型.html#cb2407-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<p>在这个例子中，我们通过AIC和似然比检验来比较不同复杂度的模型，选择最优的随机效应结构。需要注意的是，随机效应的选择不仅基于统计标准，还应考虑生态学合理性。</p>
<p>让我们进一步演示统计筛选的具体方法：</p>
<div class="sourceCode" id="cb2409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2409-1"><a href="高级回归模型.html#cb2409-1" tabindex="-1"></a><span class="co"># 统计筛选方法演示</span></span>
<span id="cb2409-2"><a href="高级回归模型.html#cb2409-2" tabindex="-1"></a></span>
<span id="cb2409-3"><a href="高级回归模型.html#cb2409-3" tabindex="-1"></a><span class="co"># 1. 固定效应筛选：检验温度效应是否显著</span></span>
<span id="cb2409-4"><a href="高级回归模型.html#cb2409-4" tabindex="-1"></a>model_without_temp <span class="ot">&lt;-</span> <span class="fu">glmer</span>(success <span class="sc">~</span> rainfall <span class="sc">+</span> predator_pressure <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb2409-5"><a href="高级回归模型.html#cb2409-5" tabindex="-1"></a>  <span class="at">family =</span> binomial, <span class="at">data =</span> bird_data</span>
<span id="cb2409-6"><a href="高级回归模型.html#cb2409-6" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb2411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2411-1"><a href="高级回归模型.html#cb2411-1" tabindex="-1"></a>model_with_temp <span class="ot">&lt;-</span> <span class="fu">glmer</span>(success <span class="sc">~</span> temperature <span class="sc">+</span> rainfall <span class="sc">+</span> predator_pressure <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb2411-2"><a href="高级回归模型.html#cb2411-2" tabindex="-1"></a>  <span class="at">family =</span> binomial, <span class="at">data =</span> bird_data</span>
<span id="cb2411-3"><a href="高级回归模型.html#cb2411-3" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb2413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2413-1"><a href="高级回归模型.html#cb2413-1" tabindex="-1"></a><span class="co"># 似然比检验</span></span>
<span id="cb2413-2"><a href="高级回归模型.html#cb2413-2" tabindex="-1"></a>lr_test_temp <span class="ot">&lt;-</span> <span class="fu">anova</span>(model_without_temp, model_with_temp)</span>
<span id="cb2413-3"><a href="高级回归模型.html#cb2413-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;温度效应的似然比检验:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 温度效应的似然比检验:</code></pre>
<div class="sourceCode" id="cb2415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2415-1"><a href="高级回归模型.html#cb2415-1" tabindex="-1"></a><span class="fu">print</span>(lr_test_temp)</span></code></pre></div>
<pre><code>## Data: bird_data
## Models:
## model_without_temp: success ~ rainfall + predator_pressure + (1 | year)
## model_with_temp: success ~ temperature + rainfall + predator_pressure + (1 | year)
##                    npar    AIC    BIC  logLik -2*log(L)  Chisq Df Pr(&gt;Chisq)
## model_without_temp    4 153.68 165.73 -72.842    145.68                     
## model_with_temp       5 153.94 169.00 -71.971    143.94 1.7421  1     0.1869</code></pre>
<div class="sourceCode" id="cb2417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2417-1"><a href="高级回归模型.html#cb2417-1" tabindex="-1"></a><span class="co"># 2. 随机效应筛选：检验年份随机效应是否显著</span></span>
<span id="cb2417-2"><a href="高级回归模型.html#cb2417-2" tabindex="-1"></a>model_without_year <span class="ot">&lt;-</span> <span class="fu">glm</span>(success <span class="sc">~</span> temperature <span class="sc">+</span> rainfall <span class="sc">+</span> predator_pressure,</span>
<span id="cb2417-3"><a href="高级回归模型.html#cb2417-3" tabindex="-1"></a>  <span class="at">family =</span> binomial, <span class="at">data =</span> bird_data</span>
<span id="cb2417-4"><a href="高级回归模型.html#cb2417-4" tabindex="-1"></a>)</span>
<span id="cb2417-5"><a href="高级回归模型.html#cb2417-5" tabindex="-1"></a>model_with_year <span class="ot">&lt;-</span> <span class="fu">glmer</span>(success <span class="sc">~</span> temperature <span class="sc">+</span> rainfall <span class="sc">+</span> predator_pressure <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb2417-6"><a href="高级回归模型.html#cb2417-6" tabindex="-1"></a>  <span class="at">family =</span> binomial, <span class="at">data =</span> bird_data</span>
<span id="cb2417-7"><a href="高级回归模型.html#cb2417-7" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb2419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2419-1"><a href="高级回归模型.html#cb2419-1" tabindex="-1"></a><span class="co"># 似然比检验（注意：混合模型与普通GLM的比较需要小心）</span></span>
<span id="cb2419-2"><a href="高级回归模型.html#cb2419-2" tabindex="-1"></a>lr_test_year <span class="ot">&lt;-</span> <span class="fu">anova</span>(model_with_year, model_without_year)</span>
<span id="cb2419-3"><a href="高级回归模型.html#cb2419-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;年份随机效应的似然比检验:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 年份随机效应的似然比检验:</code></pre>
<div class="sourceCode" id="cb2421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2421-1"><a href="高级回归模型.html#cb2421-1" tabindex="-1"></a><span class="fu">print</span>(lr_test_year)</span></code></pre></div>
<pre><code>## Data: bird_data
## Models:
## model_without_year: success ~ temperature + rainfall + predator_pressure
## model_with_year: success ~ temperature + rainfall + predator_pressure + (1 | year)
##                    npar    AIC    BIC  logLik -2*log(L) Chisq Df Pr(&gt;Chisq)
## model_without_year    4 151.94 163.99 -71.971    143.94                    
## model_with_year       5 153.94 169.00 -71.971    143.94     0  1          1</code></pre>
<div class="sourceCode" id="cb2423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2423-1"><a href="高级回归模型.html#cb2423-1" tabindex="-1"></a><span class="co"># 3. 使用AIC进行模型比较</span></span>
<span id="cb2423-2"><a href="高级回归模型.html#cb2423-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;AIC比较:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## AIC比较:</code></pre>
<div class="sourceCode" id="cb2425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2425-1"><a href="高级回归模型.html#cb2425-1" tabindex="-1"></a><span class="fu">AIC</span>(model_without_temp, model_with_temp, model_without_year, model_with_year)</span></code></pre></div>
<pre><code>##                    df      AIC
## model_without_temp  4 153.6841
## model_with_temp     5 153.9421
## model_without_year  4 151.9421
## model_with_year     5 153.9421</code></pre>
<div class="sourceCode" id="cb2427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2427-1"><a href="高级回归模型.html#cb2427-1" tabindex="-1"></a><span class="co"># 4. 检查随机效应方差分量的置信区间</span></span>
<span id="cb2427-2"><a href="高级回归模型.html#cb2427-2" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb2427-3"><a href="高级回归模型.html#cb2427-3" tabindex="-1"></a><span class="co"># 使用参数自举法计算置信区间</span></span>
<span id="cb2427-4"><a href="高级回归模型.html#cb2427-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2427-5"><a href="高级回归模型.html#cb2427-5" tabindex="-1"></a>boot_ci <span class="ot">&lt;-</span> <span class="fu">confint</span>(model_with_year, <span class="at">method =</span> <span class="st">&quot;boot&quot;</span>, <span class="at">nsim =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## Computing bootstrap confidence intervals ...</code></pre>
<pre><code>## 
## 67 message(s): boundary (singular) fit: see help(&#39;isSingular&#39;)
## 51 warning(s): Model failed to converge with max|grad| = 0.00231455 (tol = 0.002, component 1) (and others)</code></pre>
<div class="sourceCode" id="cb2430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2430-1"><a href="高级回归模型.html#cb2430-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;随机效应方差分量的置信区间:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 随机效应方差分量的置信区间:</code></pre>
<div class="sourceCode" id="cb2432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2432-1"><a href="高级回归模型.html#cb2432-1" tabindex="-1"></a><span class="fu">print</span>(boot_ci)</span></code></pre></div>
<pre><code>##                         2.5 %       97.5 %
## .sig01             0.00000000  0.608763931
## (Intercept)       -4.03147744  3.724792123
## temperature       -0.07915514  0.298645050
## rainfall          -0.00711201 -0.001048631
## predator_pressure -6.15068509 -2.186449238</code></pre>
<div class="sourceCode" id="cb2434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2434-1"><a href="高级回归模型.html#cb2434-1" tabindex="-1"></a><span class="co"># 5. 逐步模型简化</span></span>
<span id="cb2434-2"><a href="高级回归模型.html#cb2434-2" tabindex="-1"></a><span class="co"># 从完整模型开始</span></span>
<span id="cb2434-3"><a href="高级回归模型.html#cb2434-3" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">glmer</span>(</span>
<span id="cb2434-4"><a href="高级回归模型.html#cb2434-4" tabindex="-1"></a>  success <span class="sc">~</span> temperature <span class="sc">+</span> rainfall <span class="sc">+</span> predator_pressure <span class="sc">+</span></span>
<span id="cb2434-5"><a href="高级回归模型.html#cb2434-5" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> year) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> box_id),</span>
<span id="cb2434-6"><a href="高级回归模型.html#cb2434-6" tabindex="-1"></a>  <span class="at">family =</span> binomial, <span class="at">data =</span> bird_data</span>
<span id="cb2434-7"><a href="高级回归模型.html#cb2434-7" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb2436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2436-1"><a href="高级回归模型.html#cb2436-1" tabindex="-1"></a><span class="co"># 移除最不显著的固定效应</span></span>
<span id="cb2436-2"><a href="高级回归模型.html#cb2436-2" tabindex="-1"></a><span class="co"># 使用drop1函数进行逐步简化</span></span>
<span id="cb2436-3"><a href="高级回归模型.html#cb2436-3" tabindex="-1"></a>drop1_results <span class="ot">&lt;-</span> <span class="fu">drop1</span>(full_model, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb2439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2439-1"><a href="高级回归模型.html#cb2439-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;逐步简化结果:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 逐步简化结果:</code></pre>
<div class="sourceCode" id="cb2441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2441-1"><a href="高级回归模型.html#cb2441-1" tabindex="-1"></a><span class="fu">print</span>(drop1_results)</span></code></pre></div>
<pre><code>## Single term deletions
## 
## Model:
## success ~ temperature + rainfall + predator_pressure + (1 | year) + 
##     (1 | box_id)
##                   npar    AIC     LRT   Pr(Chi)    
## &lt;none&gt;                 155.94                      
## temperature          1 155.68  1.7421  0.186878    
## rainfall             1 160.77  6.8237  0.008996 ** 
## predator_pressure    1 173.15 19.2093 1.171e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb2443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2443-1"><a href="高级回归模型.html#cb2443-1" tabindex="-1"></a><span class="co"># 6. 使用模型平均方法（如果存在模型不确定性）</span></span>
<span id="cb2443-2"><a href="高级回归模型.html#cb2443-2" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb2443-3"><a href="高级回归模型.html#cb2443-3" tabindex="-1"></a><span class="co"># 构建候选模型集</span></span>
<span id="cb2443-4"><a href="高级回归模型.html#cb2443-4" tabindex="-1"></a>candidate_models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb2443-5"><a href="高级回归模型.html#cb2443-5" tabindex="-1"></a>  <span class="at">model1 =</span> <span class="fu">glmer</span>(success <span class="sc">~</span> temperature <span class="sc">+</span> rainfall <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb2443-6"><a href="高级回归模型.html#cb2443-6" tabindex="-1"></a>    <span class="at">family =</span> binomial, <span class="at">data =</span> bird_data</span>
<span id="cb2443-7"><a href="高级回归模型.html#cb2443-7" tabindex="-1"></a>  ),</span>
<span id="cb2443-8"><a href="高级回归模型.html#cb2443-8" tabindex="-1"></a>  <span class="at">model2 =</span> <span class="fu">glmer</span>(success <span class="sc">~</span> temperature <span class="sc">+</span> predator_pressure <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb2443-9"><a href="高级回归模型.html#cb2443-9" tabindex="-1"></a>    <span class="at">family =</span> binomial, <span class="at">data =</span> bird_data</span>
<span id="cb2443-10"><a href="高级回归模型.html#cb2443-10" tabindex="-1"></a>  ),</span>
<span id="cb2443-11"><a href="高级回归模型.html#cb2443-11" tabindex="-1"></a>  <span class="at">model3 =</span> <span class="fu">glmer</span>(success <span class="sc">~</span> rainfall <span class="sc">+</span> predator_pressure <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb2443-12"><a href="高级回归模型.html#cb2443-12" tabindex="-1"></a>    <span class="at">family =</span> binomial, <span class="at">data =</span> bird_data</span>
<span id="cb2443-13"><a href="高级回归模型.html#cb2443-13" tabindex="-1"></a>  ),</span>
<span id="cb2443-14"><a href="高级回归模型.html#cb2443-14" tabindex="-1"></a>  <span class="at">model4 =</span> <span class="fu">glmer</span>(success <span class="sc">~</span> temperature <span class="sc">+</span> rainfall <span class="sc">+</span> predator_pressure <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb2443-15"><a href="高级回归模型.html#cb2443-15" tabindex="-1"></a>    <span class="at">family =</span> binomial, <span class="at">data =</span> bird_data</span>
<span id="cb2443-16"><a href="高级回归模型.html#cb2443-16" tabindex="-1"></a>  )</span>
<span id="cb2443-17"><a href="高级回归模型.html#cb2443-17" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)
## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb2445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2445-1"><a href="高级回归模型.html#cb2445-1" tabindex="-1"></a><span class="co"># 计算模型权重</span></span>
<span id="cb2445-2"><a href="高级回归模型.html#cb2445-2" tabindex="-1"></a>model_weights <span class="ot">&lt;-</span> <span class="fu">model.sel</span>(candidate_models)</span>
<span id="cb2445-3"><a href="高级回归模型.html#cb2445-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模型权重:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 模型权重:</code></pre>
<div class="sourceCode" id="cb2447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2447-1"><a href="高级回归模型.html#cb2447-1" tabindex="-1"></a><span class="fu">print</span>(model_weights)</span></code></pre></div>
<pre><code>## Model selection table 
##          (Int)       rnf     tmp prd_prs df  logLik  AICc delta weight
## model3  2.0300 -0.003464          -3.267  4 -72.842 154.0  0.00  0.527
## model4  0.1207 -0.003353 0.09365  -3.343  5 -71.971 154.4  0.40  0.432
## model2 -1.6750           0.10500  -3.389  4 -75.383 159.0  5.08  0.042
## model1 -0.8757 -0.003541 0.07636          4 -81.576 171.4 17.47  0.000
## Models ranked by AICc(x) 
## Random terms (all models): 
##   1 | year</code></pre>
<div class="sourceCode" id="cb2449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2449-1"><a href="高级回归模型.html#cb2449-1" tabindex="-1"></a><span class="co"># 7. 交叉验证评估模型预测性能</span></span>
<span id="cb2449-2"><a href="高级回归模型.html#cb2449-2" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code></pre></div>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## 
## Attaching package: &#39;caret&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survival&#39;:
## 
##     cluster</code></pre>
<div class="sourceCode" id="cb2453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2453-1"><a href="高级回归模型.html#cb2453-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2453-2"><a href="高级回归模型.html#cb2453-2" tabindex="-1"></a>train_indices <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(bird_data<span class="sc">$</span>success, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2453-3"><a href="高级回归模型.html#cb2453-3" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> bird_data[train_indices, ]</span>
<span id="cb2453-4"><a href="高级回归模型.html#cb2453-4" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> bird_data[<span class="sc">-</span>train_indices, ]</span>
<span id="cb2453-5"><a href="高级回归模型.html#cb2453-5" tabindex="-1"></a></span>
<span id="cb2453-6"><a href="高级回归模型.html#cb2453-6" tabindex="-1"></a><span class="co"># 在训练集上构建简化模型</span></span>
<span id="cb2453-7"><a href="高级回归模型.html#cb2453-7" tabindex="-1"></a>final_model <span class="ot">&lt;-</span> <span class="fu">glmer</span>(success <span class="sc">~</span> temperature <span class="sc">+</span> predator_pressure <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> year),</span>
<span id="cb2453-8"><a href="高级回归模型.html#cb2453-8" tabindex="-1"></a>  <span class="at">family =</span> binomial, <span class="at">data =</span> train_data</span>
<span id="cb2453-9"><a href="高级回归模型.html#cb2453-9" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<div class="sourceCode" id="cb2455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2455-1"><a href="高级回归模型.html#cb2455-1" tabindex="-1"></a><span class="co"># 在测试集上预测</span></span>
<span id="cb2455-2"><a href="高级回归模型.html#cb2455-2" tabindex="-1"></a>test_predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(final_model, <span class="at">newdata =</span> test_data, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb2455-3"><a href="高级回归模型.html#cb2455-3" tabindex="-1"></a></span>
<span id="cb2455-4"><a href="高级回归模型.html#cb2455-4" tabindex="-1"></a><span class="co"># 计算预测准确率</span></span>
<span id="cb2455-5"><a href="高级回归模型.html#cb2455-5" tabindex="-1"></a>predicted_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(test_predictions <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2455-6"><a href="高级回归模型.html#cb2455-6" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">mean</span>(predicted_class <span class="sc">==</span> test_data<span class="sc">$</span>success)</span>
<span id="cb2455-7"><a href="高级回归模型.html#cb2455-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;测试集准确率:&quot;</span>, accuracy, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 测试集准确率: 0.7111111</code></pre>
<div class="sourceCode" id="cb2457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2457-1"><a href="高级回归模型.html#cb2457-1" tabindex="-1"></a><span class="co"># 8. 检查模型诊断</span></span>
<span id="cb2457-2"><a href="高级回归模型.html#cb2457-2" tabindex="-1"></a><span class="co"># 残差诊断</span></span>
<span id="cb2457-3"><a href="高级回归模型.html#cb2457-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(final_model), <span class="fu">residuals</span>(final_model, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>))</span>
<span id="cb2457-4"><a href="高级回归模型.html#cb2457-4" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-26-1"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-26-1.png" alt="混合效应模型统计筛选诊断图" width="672" />
<p class="caption">
图9.2: 混合效应模型统计筛选诊断图
</p>
</div>
<div class="sourceCode" id="cb2458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2458-1"><a href="高级回归模型.html#cb2458-1" tabindex="-1"></a><span class="co"># 随机效应诊断</span></span>
<span id="cb2458-2"><a href="高级回归模型.html#cb2458-2" tabindex="-1"></a>random_effects <span class="ot">&lt;-</span> <span class="fu">ranef</span>(final_model)<span class="sc">$</span>year[[<span class="dv">1</span>]]</span>
<span id="cb2458-3"><a href="高级回归模型.html#cb2458-3" tabindex="-1"></a><span class="fu">qqnorm</span>(random_effects)</span>
<span id="cb2458-4"><a href="高级回归模型.html#cb2458-4" tabindex="-1"></a><span class="fu">qqline</span>(random_effects)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-26-2"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-26-2.png" alt="混合效应模型统计筛选诊断图" width="672" />
<p class="caption">
图9.3: 混合效应模型统计筛选诊断图
</p>
</div>
<div class="sourceCode" id="cb2459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2459-1"><a href="高级回归模型.html#cb2459-1" tabindex="-1"></a><span class="co"># 9. 最终模型验证</span></span>
<span id="cb2459-2"><a href="高级回归模型.html#cb2459-2" tabindex="-1"></a><span class="co"># 检查模型是否收敛</span></span>
<span id="cb2459-3"><a href="高级回归模型.html#cb2459-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模型收敛检查:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 模型收敛检查:</code></pre>
<div class="sourceCode" id="cb2461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2461-1"><a href="高级回归模型.html#cb2461-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">isSingular</span>(final_model))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb2463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2463-1"><a href="高级回归模型.html#cb2463-1" tabindex="-1"></a><span class="co"># 检查过度离散</span></span>
<span id="cb2463-2"><a href="高级回归模型.html#cb2463-2" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb2463-3"><a href="高级回归模型.html#cb2463-3" tabindex="-1"></a><span class="fu">check_overdispersion</span>(final_model)</span></code></pre></div>
<pre><code>## # Overdispersion test
## 
##  dispersion ratio = 1.024
##           p-value = 0.856</code></pre>
<pre><code>## No overdispersion detected.</code></pre>
<p>通过这个完整的统计筛选流程，我们可以系统地判断模型中哪些固定效应和随机效应是必要的，哪些可以省略。统计筛选的关键原则包括：</p>
<ol style="list-style-type: decimal">
<li><p><strong>多重证据原则</strong>：不要仅依赖单一统计检验，要结合似然比检验、AIC比较、置信区间等多种证据</p></li>
<li><p><strong>生态学合理性</strong>：统计显著性必须与生态学知识一致，不能仅基于p值做出决策</p></li>
<li><p><strong>模型简约性</strong>：在解释力相当的情况下，优先选择更简单的模型</p></li>
<li><p><strong>预测性能</strong>：最终模型应该在独立数据上有良好的预测表现</p></li>
<li><p><strong>诊断检查</strong>：确保最终模型满足基本的统计假设</p></li>
</ol>
<p>这种系统的统计筛选方法能够帮助我们构建既统计合理又生态学有意义的混合效应模型。</p>
</div>
<div id="混合效应模型在生态学中的特殊价值" class="section level3 hasAnchor" number="10.5.5">
<h3><span class="header-section-number">10.5.5</span> 混合效应模型在生态学中的特殊价值<a href="高级回归模型.html#混合效应模型在生态学中的特殊价值" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>混合效应模型在生态学研究中具有特殊的价值，主要体现在以下几个方面：</p>
<p><strong>正确处理层次结构数据</strong>：生态数据往往具有复杂的层次结构，如空间嵌套、时间重复、个体跟踪等。混合效应模型能够正确估计这种数据结构中的相关性，避免”伪重复”问题。</p>
<p><strong>提高统计推断的准确性</strong>：通过考虑组间变异，混合效应模型能够提供更准确的标准误和置信区间，从而做出更可靠的统计推断。</p>
<p><strong>处理不平衡数据</strong>：生态学研究常常面临不平衡的数据结构，如不同样地的观测次数不同、不同年份的样本量不同等。混合效应模型能够自然地处理这种不平衡性。</p>
<p><strong>分离生态过程的不同尺度</strong>：混合效应模型能够帮助我们分离总体水平的系统性模式（固定效应）和局部尺度的随机变异（随机效应），从而更好地理解生态过程的多尺度特征。</p>
<p><strong>提高预测的准确性</strong>：通过考虑组间变异，混合效应模型能够提供更准确的预测，特别是在预测新组别的观测值时。</p>
<p>让我们通过一个空间生态学的例子来展示混合效应模型的应用价值：</p>
<div class="sourceCode" id="cb2466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2466-1"><a href="高级回归模型.html#cb2466-1" tabindex="-1"></a><span class="co"># 空间混合模型示例：研究不同流域中溪流鱼类丰富度与环境因子的关系</span></span>
<span id="cb2466-2"><a href="高级回归模型.html#cb2466-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2466-3"><a href="高级回归模型.html#cb2466-3" tabindex="-1"></a>n_watersheds <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb2466-4"><a href="高级回归模型.html#cb2466-4" tabindex="-1"></a>n_streams_per_watershed <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb2466-5"><a href="高级回归模型.html#cb2466-5" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> n_watersheds <span class="sc">*</span> n_streams_per_watershed</span>
<span id="cb2466-6"><a href="高级回归模型.html#cb2466-6" tabindex="-1"></a></span>
<span id="cb2466-7"><a href="高级回归模型.html#cb2466-7" tabindex="-1"></a>stream_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2466-8"><a href="高级回归模型.html#cb2466-8" tabindex="-1"></a>  <span class="at">watershed_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_watersheds, <span class="at">each =</span> n_streams_per_watershed),</span>
<span id="cb2466-9"><a href="高级回归模型.html#cb2466-9" tabindex="-1"></a>  <span class="at">stream_id =</span> <span class="dv">1</span><span class="sc">:</span>n_total,</span>
<span id="cb2466-10"><a href="高级回归模型.html#cb2466-10" tabindex="-1"></a>  <span class="at">elevation =</span> <span class="fu">runif</span>(n_total, <span class="dv">100</span>, <span class="dv">2000</span>),</span>
<span id="cb2466-11"><a href="高级回归模型.html#cb2466-11" tabindex="-1"></a>  <span class="at">water_temperature =</span> <span class="fu">runif</span>(n_total, <span class="dv">5</span>, <span class="dv">20</span>),</span>
<span id="cb2466-12"><a href="高级回归模型.html#cb2466-12" tabindex="-1"></a>  <span class="at">canopy_cover =</span> <span class="fu">runif</span>(n_total, <span class="fl">0.1</span>, <span class="fl">0.9</span>)</span>
<span id="cb2466-13"><a href="高级回归模型.html#cb2466-13" tabindex="-1"></a>)</span>
<span id="cb2466-14"><a href="高级回归模型.html#cb2466-14" tabindex="-1"></a></span>
<span id="cb2466-15"><a href="高级回归模型.html#cb2466-15" tabindex="-1"></a><span class="co"># 模拟流域随机效应</span></span>
<span id="cb2466-16"><a href="高级回归模型.html#cb2466-16" tabindex="-1"></a>watershed_effects <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_watersheds, <span class="dv">0</span>, <span class="fl">1.5</span>)</span>
<span id="cb2466-17"><a href="高级回归模型.html#cb2466-17" tabindex="-1"></a></span>
<span id="cb2466-18"><a href="高级回归模型.html#cb2466-18" tabindex="-1"></a><span class="co"># 模拟鱼类丰富度（泊松分布）</span></span>
<span id="cb2466-19"><a href="高级回归模型.html#cb2466-19" tabindex="-1"></a>linear_predictor <span class="ot">&lt;-</span> (</span>
<span id="cb2466-20"><a href="高级回归模型.html#cb2466-20" tabindex="-1"></a>  <span class="dv">2</span> <span class="sc">+</span> <span class="co"># 截距</span></span>
<span id="cb2466-21"><a href="高级回归模型.html#cb2466-21" tabindex="-1"></a>    <span class="sc">-</span><span class="fl">0.001</span> <span class="sc">*</span> stream_data<span class="sc">$</span>elevation <span class="sc">+</span></span>
<span id="cb2466-22"><a href="高级回归模型.html#cb2466-22" tabindex="-1"></a>    <span class="fl">0.1</span> <span class="sc">*</span> stream_data<span class="sc">$</span>water_temperature <span class="sc">+</span></span>
<span id="cb2466-23"><a href="高级回归模型.html#cb2466-23" tabindex="-1"></a>    <span class="fl">0.5</span> <span class="sc">*</span> stream_data<span class="sc">$</span>canopy_cover <span class="sc">+</span></span>
<span id="cb2466-24"><a href="高级回归模型.html#cb2466-24" tabindex="-1"></a>    watershed_effects[stream_data<span class="sc">$</span>watershed_id]</span>
<span id="cb2466-25"><a href="高级回归模型.html#cb2466-25" tabindex="-1"></a>)</span>
<span id="cb2466-26"><a href="高级回归模型.html#cb2466-26" tabindex="-1"></a>stream_data<span class="sc">$</span>fish_richness <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n_total, <span class="fu">exp</span>(linear_predictor))</span>
<span id="cb2466-27"><a href="高级回归模型.html#cb2466-27" tabindex="-1"></a></span>
<span id="cb2466-28"><a href="高级回归模型.html#cb2466-28" tabindex="-1"></a><span class="co"># 构建空间混合模型</span></span>
<span id="cb2466-29"><a href="高级回归模型.html#cb2466-29" tabindex="-1"></a>spatial_model <span class="ot">&lt;-</span> <span class="fu">glmer</span>(</span>
<span id="cb2466-30"><a href="高级回归模型.html#cb2466-30" tabindex="-1"></a>  fish_richness <span class="sc">~</span> elevation <span class="sc">+</span> water_temperature <span class="sc">+</span> canopy_cover <span class="sc">+</span></span>
<span id="cb2466-31"><a href="高级回归模型.html#cb2466-31" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> watershed_id),</span>
<span id="cb2466-32"><a href="高级回归模型.html#cb2466-32" tabindex="-1"></a>  <span class="at">family =</span> poisson, <span class="at">data =</span> stream_data</span>
<span id="cb2466-33"><a href="高级回归模型.html#cb2466-33" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning: Some predictor variables are on very different scales: consider
## rescaling</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, :
## Model failed to converge with max|grad| = 0.0157479 (tol = 0.002, component 1)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, : Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?;Model is nearly unidentifiable: large eigenvalue ratio
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb2470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2470-1"><a href="高级回归模型.html#cb2470-1" tabindex="-1"></a><span class="co"># 模型摘要</span></span>
<span id="cb2470-2"><a href="高级回归模型.html#cb2470-2" tabindex="-1"></a><span class="fu">summary</span>(spatial_model)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: poisson  ( log )
## Formula: fish_richness ~ elevation + water_temperature + canopy_cover +  
##     (1 | watershed_id)
##    Data: stream_data
## 
##       AIC       BIC    logLik -2*log(L)  df.resid 
##     696.8     710.7    -343.4     686.8       115 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.7170 -0.7484 -0.1116  0.7004  2.6592 
## 
## Random effects:
##  Groups       Name        Variance Std.Dev.
##  watershed_id (Intercept) 1.16     1.077   
## Number of obs: 120, groups:  watershed_id, 15
## 
## Fixed effects:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        1.920e+00  3.009e-01   6.381 1.76e-10 ***
## elevation         -1.035e-03  4.377e-05 -23.653  &lt; 2e-16 ***
## water_temperature  9.643e-02  6.504e-03  14.826  &lt; 2e-16 ***
## canopy_cover       3.973e-01  8.841e-02   4.494 6.99e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) elevtn wtr_tm
## elevation   -0.115              
## watr_tmprtr -0.308 -0.033       
## canopy_covr -0.181  0.058  0.075
## fit warnings:
## Some predictor variables are on very different scales: consider rescaling
## optimizer (Nelder_Mead) convergence code: 0 (OK)
## Model failed to converge with max|grad| = 0.0157479 (tol = 0.002, component 1)
## Model is nearly unidentifiable: very large eigenvalue
##  - Rescale variables?
## Model is nearly unidentifiable: large eigenvalue ratio
##  - Rescale variables?</code></pre>
<div class="sourceCode" id="cb2472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2472-1"><a href="高级回归模型.html#cb2472-1" tabindex="-1"></a><span class="co"># 计算流域间变异的重要性</span></span>
<span id="cb2472-2"><a href="高级回归模型.html#cb2472-2" tabindex="-1"></a>var_components <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(spatial_model)</span>
<span id="cb2472-3"><a href="高级回归模型.html#cb2472-3" tabindex="-1"></a>total_variance <span class="ot">&lt;-</span> <span class="fu">var</span>(stream_data<span class="sc">$</span>fish_richness)</span>
<span id="cb2472-4"><a href="高级回归模型.html#cb2472-4" tabindex="-1"></a>between_watershed_variance <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(var_components)<span class="sc">$</span>vcov[<span class="dv">1</span>]</span>
<span id="cb2472-5"><a href="高级回归模型.html#cb2472-5" tabindex="-1"></a>proportion_explained <span class="ot">&lt;-</span> between_watershed_variance <span class="sc">/</span> total_variance</span>
<span id="cb2472-6"><a href="高级回归模型.html#cb2472-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;流域间变异解释的方差比例:&quot;</span>, proportion_explained, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 流域间变异解释的方差比例: 0.0008256743</code></pre>
<div class="sourceCode" id="cb2474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2474-1"><a href="高级回归模型.html#cb2474-1" tabindex="-1"></a><span class="co"># 预测新流域的鱼类丰富度</span></span>
<span id="cb2474-2"><a href="高级回归模型.html#cb2474-2" tabindex="-1"></a>new_stream <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2474-3"><a href="高级回归模型.html#cb2474-3" tabindex="-1"></a>  <span class="at">elevation =</span> <span class="dv">1000</span>,</span>
<span id="cb2474-4"><a href="高级回归模型.html#cb2474-4" tabindex="-1"></a>  <span class="at">water_temperature =</span> <span class="dv">12</span>,</span>
<span id="cb2474-5"><a href="高级回归模型.html#cb2474-5" tabindex="-1"></a>  <span class="at">canopy_cover =</span> <span class="fl">0.6</span></span>
<span id="cb2474-6"><a href="高级回归模型.html#cb2474-6" tabindex="-1"></a>)</span>
<span id="cb2474-7"><a href="高级回归模型.html#cb2474-7" tabindex="-1"></a></span>
<span id="cb2474-8"><a href="高级回归模型.html#cb2474-8" tabindex="-1"></a><span class="co"># 总体平均预测（不考虑具体流域）</span></span>
<span id="cb2474-9"><a href="高级回归模型.html#cb2474-9" tabindex="-1"></a>avg_prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(spatial_model,</span>
<span id="cb2474-10"><a href="高级回归模型.html#cb2474-10" tabindex="-1"></a>  <span class="at">newdata =</span> new_stream,</span>
<span id="cb2474-11"><a href="高级回归模型.html#cb2474-11" tabindex="-1"></a>  <span class="at">re.form =</span> <span class="cn">NA</span>, <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb2474-12"><a href="高级回归模型.html#cb2474-12" tabindex="-1"></a>)</span>
<span id="cb2474-13"><a href="高级回归模型.html#cb2474-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;总体平均预测:&quot;</span>, avg_prediction, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 总体平均预测: 9.780407</code></pre>
<div class="sourceCode" id="cb2476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2476-1"><a href="高级回归模型.html#cb2476-1" tabindex="-1"></a><span class="co"># 可视化随机效应分布</span></span>
<span id="cb2476-2"><a href="高级回归模型.html#cb2476-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2476-3"><a href="高级回归模型.html#cb2476-3" tabindex="-1"></a>random_effects <span class="ot">&lt;-</span> <span class="fu">ranef</span>(spatial_model)<span class="sc">$</span>watershed_id</span>
<span id="cb2476-4"><a href="高级回归模型.html#cb2476-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">effect =</span> random_effects[[<span class="dv">1</span>]]), <span class="fu">aes</span>(<span class="at">x =</span> effect)) <span class="sc">+</span></span>
<span id="cb2476-5"><a href="高级回归模型.html#cb2476-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb2476-6"><a href="高级回归模型.html#cb2476-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2476-7"><a href="高级回归模型.html#cb2476-7" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;流域随机效应&quot;</span>, <span class="at">y =</span> <span class="st">&quot;频数&quot;</span>,</span>
<span id="cb2476-8"><a href="高级回归模型.html#cb2476-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;流域随机效应分布&quot;</span></span>
<span id="cb2476-9"><a href="高级回归模型.html#cb2476-9" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2476-10"><a href="高级回归模型.html#cb2476-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-27"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-27-1.png" alt="空间混合模型随机效应分布图" width="672" />
<p class="caption">
图3.4: 空间混合模型随机效应分布图
</p>
</div>
<p>通过这个例子，我们可以看到混合效应模型如何帮助我们理解生态过程的空间变异，并为保护管理提供更准确的预测。</p>
</div>
<div id="模型诊断与注意事项" class="section level3 hasAnchor" number="10.5.6">
<h3><span class="header-section-number">10.5.6</span> 模型诊断与注意事项<a href="高级回归模型.html#模型诊断与注意事项" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>混合效应模型的诊断比普通回归模型更为复杂，需要特别关注随机效应的分布假设、模型收敛性和奇异拟合问题。</p>
<p><strong>随机效应诊断</strong>：</p>
<div class="sourceCode" id="cb2477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2477-1"><a href="高级回归模型.html#cb2477-1" tabindex="-1"></a><span class="co"># 重新创建混合效应模型用于诊断示例</span></span>
<span id="cb2477-2"><a href="高级回归模型.html#cb2477-2" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb2477-3"><a href="高级回归模型.html#cb2477-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2477-4"><a href="高级回归模型.html#cb2477-4" tabindex="-1"></a>diagnostic_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2477-5"><a href="高级回归模型.html#cb2477-5" tabindex="-1"></a>  <span class="at">plot_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">each =</span> <span class="dv">5</span>),</span>
<span id="cb2477-6"><a href="高级回归模型.html#cb2477-6" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>),</span>
<span id="cb2477-7"><a href="高级回归模型.html#cb2477-7" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>) <span class="sc">+</span> <span class="fu">rep</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="dv">5</span>)</span>
<span id="cb2477-8"><a href="高级回归模型.html#cb2477-8" tabindex="-1"></a>)</span>
<span id="cb2477-9"><a href="高级回归模型.html#cb2477-9" tabindex="-1"></a></span>
<span id="cb2477-10"><a href="高级回归模型.html#cb2477-10" tabindex="-1"></a>diagnostic_model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(y <span class="sc">~</span> x <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> plot_id), <span class="at">data =</span> diagnostic_data)</span>
<span id="cb2477-11"><a href="高级回归模型.html#cb2477-11" tabindex="-1"></a></span>
<span id="cb2477-12"><a href="高级回归模型.html#cb2477-12" tabindex="-1"></a><span class="co"># 检查随机效应的正态性假设</span></span>
<span id="cb2477-13"><a href="高级回归模型.html#cb2477-13" tabindex="-1"></a>random_effects <span class="ot">&lt;-</span> <span class="fu">ranef</span>(diagnostic_model)<span class="sc">$</span>plot_id[[<span class="dv">1</span>]]</span>
<span id="cb2477-14"><a href="高级回归模型.html#cb2477-14" tabindex="-1"></a><span class="fu">qqnorm</span>(random_effects)</span>
<span id="cb2477-15"><a href="高级回归模型.html#cb2477-15" tabindex="-1"></a><span class="fu">qqline</span>(random_effects)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-28-1"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-28-1.png" alt="混合效应模型诊断示例图" width="672" />
<p class="caption">
图10.10: 混合效应模型诊断示例图
</p>
</div>
<div class="sourceCode" id="cb2478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2478-1"><a href="高级回归模型.html#cb2478-1" tabindex="-1"></a><span class="co"># 检查残差的同方差性</span></span>
<span id="cb2478-2"><a href="高级回归模型.html#cb2478-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(diagnostic_model), <span class="fu">residuals</span>(diagnostic_model))</span>
<span id="cb2478-3"><a href="高级回归模型.html#cb2478-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-28-2"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-28-2.png" alt="混合效应模型诊断示例图" width="672" />
<p class="caption">
图10.11: 混合效应模型诊断示例图
</p>
</div>
<div class="sourceCode" id="cb2479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2479-1"><a href="高级回归模型.html#cb2479-1" tabindex="-1"></a><span class="co"># 检查模型收敛</span></span>
<span id="cb2479-2"><a href="高级回归模型.html#cb2479-2" tabindex="-1"></a><span class="fu">summary</span>(diagnostic_model)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: y ~ x + (1 | plot_id)
##    Data: diagnostic_data
## 
## REML criterion at convergence: 145.9
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.1711 -0.4246 -0.1424  0.4600  2.4001 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  plot_id  (Intercept) 0.5725   0.7566  
##  Residual             0.7843   0.8856  
## Number of obs: 50, groups:  plot_id, 10
## 
## Fixed effects:
##             Estimate Std. Error      df t value Pr(&gt;|t|)
## (Intercept)  -0.2459     0.2701  8.9981  -0.910    0.386
## x            -0.1037     0.1444 41.4740  -0.718    0.477
## 
## Correlation of Fixed Effects:
##   (Intr)
## x -0.018</code></pre>
<div class="sourceCode" id="cb2481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2481-1"><a href="高级回归模型.html#cb2481-1" tabindex="-1"></a><span class="co"># 检查奇异拟合</span></span>
<span id="cb2481-2"><a href="高级回归模型.html#cb2481-2" tabindex="-1"></a><span class="fu">isSingular</span>(diagnostic_model)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p><strong>常见问题与解决方案</strong>： - <strong>奇异拟合</strong>：随机效应方差估计为零，通常表明随机效应结构过于复杂 - <strong>收敛问题</strong>：模型无法找到最优解，可能需要简化模型或调整优化算法 - <strong>过度离散</strong>：对于广义线性混合模型，可能需要考虑过度离散问题</p>
<p>混合效应模型为生态学家提供了一个强大的工具，使我们能够更准确地分析层次结构数据，理解生态过程的多尺度特征，为生态保护和管理决策提供更可靠的科学依据。通过合理使用混合效应模型，我们能够更好地捕捉生态系统的复杂性，揭示隐藏在数据背后的生态规律。</p>
</div>
</div>
<div id="时空自相关模型" class="section level2 hasAnchor" number="10.6">
<h2><span class="header-section-number">10.6</span> 时空自相关模型<a href="高级回归模型.html#时空自相关模型" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在生态学研究中，我们经常面临一个根本性的挑战：生态过程在空间和时间维度上的依赖性。传统的统计模型假设观测值之间相互独立，但在真实的生态系统中，这种假设往往不成立。空间自相关意味着地理上邻近的地点往往具有相似的生态特征；时间自相关意味着同一地点的连续观测值相互依赖。这种时空依赖性在生态系统中无处不在：物种分布受扩散限制影响，环境因子在空间上呈现梯度变化，种群动态具有时间连续性，生态系统过程在时空尺度上相互关联。忽视这种时空依赖性会导致”伪相关”问题，即错误地将空间或时间格局当作因果关系；降低预测精度，因为忽视自相关的预测模型通常表现较差；以及对生态过程的误解，无法捕捉生态过程的扩散、迁移等时空动态。时空自相关模型正是为解决这类问题而发展起来的，它通过引入空间权重矩阵和时间自回归项，能够正确地建模生态数据的时空依赖性，为生态学研究提供了更强大的分析工具。</p>
<div id="时空自相关模型与混合效应模型的联系与区别" class="section level3 hasAnchor" number="10.6.1">
<h3><span class="header-section-number">10.6.1</span> 时空自相关模型与混合效应模型的联系与区别<a href="高级回归模型.html#时空自相关模型与混合效应模型的联系与区别" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>虽然混合效应模型和时空自相关模型都旨在处理数据依赖性，但它们在理论基础、建模方法和适用场景上存在重要差异：</p>
<p><strong>理论基础差异</strong>： - <strong>混合效应模型</strong>：基于随机效应理论，通过引入随机截距或随机斜率来捕捉组间变异和组内相关性 - <strong>时空自相关模型</strong>：基于空间统计和时间序列理论，通过空间权重矩阵和时间自回归项来直接建模观测值之间的依赖性结构</p>
<p><strong>建模方法对比</strong>： - <strong>混合效应模型</strong>：使用层次结构建模，将依赖性视为随机变异，适合处理分组数据、重复测量等层次结构 - <strong>时空自相关模型</strong>：使用邻接关系建模，将依赖性视为系统性模式，适合处理空间邻接、时间序列等连续性依赖</p>
<p><strong>参数解释差异</strong>： - <strong>混合效应模型</strong>：随机效应方差描述组间变异的程度，组内相关系数（ICC）度量组内相似性 - <strong>时空自相关模型</strong>：空间自相关系数（ρ）描述空间依赖性的强度，时间自相关系数（φ）描述时间依赖性的强度</p>
<p><strong>生态学应用场景</strong>： - <strong>混合效应模型更适合</strong>： - 不同样地、不同年份的重复观测数据 - 个体跟踪研究中的重复测量 - 实验设计中不同处理组的比较 - 当依赖性主要源于未观测的组间异质性时</p>
<ul>
<li><strong>时空自相关模型更适合</strong>：
<ul>
<li>地理空间数据中的扩散和迁移过程</li>
<li>时间序列数据中的惯性效应</li>
<li>环境梯度分析中的空间连续性</li>
<li>当依赖性主要源于空间邻接或时间连续性时</li>
</ul></li>
</ul>
<p><strong>模型融合的可能性</strong>： 在实际生态学研究中，两种方法可以结合使用。例如： - 在空间混合效应模型中同时考虑空间自相关和随机效应 - 在时空混合模型中整合时间自回归和随机截距 - 使用贝叶斯层次模型同时处理多种依赖性结构</p>
<p><strong>选择指导原则</strong>： - 如果数据具有明显的层次结构（如样地-样方嵌套），优先考虑混合效应模型 - 如果数据具有强烈的空间或时间连续性，优先考虑时空自相关模型 - 如果两种依赖性都存在，考虑使用更复杂的集成模型 - 模型选择应基于生态学理论和数据特征，而非仅仅统计标准</p>
</div>
<div id="空间自相关与时间自相关的生态学概念" class="section level3 hasAnchor" number="10.6.2">
<h3><span class="header-section-number">10.6.2</span> 空间自相关与时间自相关的生态学概念<a href="高级回归模型.html#空间自相关与时间自相关的生态学概念" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>要理解时空自相关模型，我们首先需要明确空间自相关和时间自相关的概念。空间自相关描述了地理空间中邻近观测值的相似性，反映了生态过程的空间依赖性。例如，在研究植物物种丰富度时，相邻样地的物种组成往往比远距离样地更为相似，这是因为种子扩散、环境梯度、生物相互作用等过程在空间上具有连续性。空间自相关可以分为正空间自相关（邻近观测值相似）和负空间自相关（邻近观测值相异），在生态学中正空间自相关更为常见。</p>
<p>时间自相关则描述了时间序列中邻近观测值的相似性，反映了生态过程的时间依赖性。例如，在研究种群动态时，当前年份的种群数量往往与上一年份的种群数量相关，这是因为种群增长具有连续性，环境条件具有时间持续性。时间自相关在生态学中表现为种群动态的惯性、环境因子的持续性、生态系统过程的滞后效应等。</p>
<p>让我们通过一个具体的生态学例子来理解这两个概念的区别。假设我们研究湖泊水质的时间序列数据。在同一湖泊中，连续月份的水质测量值往往相似，这体现了时间自相关；同时，地理上邻近的湖泊往往具有相似的水质特征，这体现了空间自相关。这两种自相关可能源于不同的生态过程：时间自相关可能反映季节性变化、气候持续性等时间过程；空间自相关可能反映流域特征、土地利用格局等空间过程。</p>
</div>
<div id="时空自相关模型的数学框架" class="section level3 hasAnchor" number="10.6.3">
<h3><span class="header-section-number">10.6.3</span> 时空自相关模型的数学框架<a href="高级回归模型.html#时空自相关模型的数学框架" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>时空自相关模型的基本思想是在传统回归模型的基础上，引入空间和时间的依赖性结构。常见的时空模型框架包括：</p>
<p><strong>空间自回归模型（SAR）</strong>： <span class="math display">\[y = \rho W y + X\beta + \varepsilon\]</span></p>
<p>其中<span class="math inline">\(y\)</span>是响应变量向量，<span class="math inline">\(W\)</span>是空间权重矩阵，<span class="math inline">\(\rho\)</span>是空间自相关系数，<span class="math inline">\(X\)</span>是预测变量矩阵，<span class="math inline">\(\beta\)</span>是回归系数向量，<span class="math inline">\(\varepsilon\)</span>是误差项。空间权重矩阵<span class="math inline">\(W\)</span>定义了观测值之间的空间关系，通常基于距离或邻接关系构建。</p>
<p><strong>时空自回归模型（STAR）</strong>： <span class="math display">\[y_t = \rho W y_t + \phi y_{t-1} + X_t\beta + \varepsilon_t\]</span></p>
<p>其中<span class="math inline">\(y_t\)</span>是时间<span class="math inline">\(t\)</span>的响应变量向量，<span class="math inline">\(\rho\)</span>是空间自相关系数，<span class="math inline">\(\phi\)</span>是时间自相关系数，<span class="math inline">\(y_{t-1}\)</span>是前一时间的响应变量，<span class="math inline">\(X_t\)</span>是时间<span class="math inline">\(t\)</span>的预测变量矩阵。</p>
<p><strong>条件自回归模型（CAR）</strong>： <span class="math display">\[y_i | y_{-i} \sim N(\mu_i + \sum_{j\neq i} c_{ij}(y_j - \mu_j), \tau_i^2)\]</span></p>
<p>其中<span class="math inline">\(y_i\)</span>是第<span class="math inline">\(i\)</span>个位置的观测值，<span class="math inline">\(y_{-i}\)</span>是其他所有位置的观测值，<span class="math inline">\(c_{ij}\)</span>是空间依赖系数，<span class="math inline">\(\tau_i^2\)</span>是条件方差。</p>
<p>这些模型的关键在于它们同时考虑了变量的空间依赖性和时间依赖性，能够更准确地描述生态过程的时空动态。</p>
</div>
<div id="时空模型框架的联系与区别" class="section level3 hasAnchor" number="10.6.4">
<h3><span class="header-section-number">10.6.4</span> 时空模型框架的联系与区别<a href="高级回归模型.html#时空模型框架的联系与区别" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>虽然这些模型都旨在处理时空依赖性，但它们在数学结构、假设条件和适用场景上存在重要差异：</p>
<p><strong>空间自回归模型（SAR）与时空自回归模型（STAR）的关系</strong>： - <strong>SAR是STAR的特殊情况</strong>：当时间自相关系数<span class="math inline">\(\phi = 0\)</span>时，STAR模型退化为SAR模型，即只考虑空间依赖性而不考虑时间依赖性 - <strong>建模视角不同</strong>：SAR模型主要关注空间依赖性对响应变量的直接影响，而STAR模型同时考虑空间和时间两个维度的依赖性 - <strong>生态学意义</strong>：SAR适用于主要受空间过程驱动的生态现象（如物种扩散、环境梯度），而STAR适用于同时受空间和时间过程影响的生态现象（如种群动态、生态系统演替）</p>
<p><strong>空间自回归模型（SAR）与条件自回归模型（CAR）的对比</strong>： - <strong>模型结构差异</strong>：SAR是同时自回归模型，所有观测值同时相互影响；CAR是条件自回归模型，每个观测值在给定其他观测值的条件下服从正态分布 - <strong>数学性质</strong>：SAR模型通常更稳定，CAR模型在某些情况下可能产生不稳定的估计 - <strong>计算效率</strong>：CAR模型通常计算效率更高，特别适合大数据集 - <strong>生态学应用</strong>：SAR更适合建模全局空间依赖性，CAR更适合建模局部空间依赖性</p>
<p><strong>时空模型的层次结构</strong>： 从简单到复杂，时空模型形成一个层次结构： 1. <strong>普通最小二乘（OLS）</strong>：忽略所有时空依赖性 2. <strong>空间模型（SAR/SEM/CAR）</strong>：只考虑空间依赖性 3. <strong>时空模型（STAR）</strong>：同时考虑空间和时间依赖性 4. <strong>贝叶斯时空模型</strong>：引入先验分布，处理更复杂的时空结构</p>
<p><strong>模型选择的生态学考量</strong>： 选择适当的时空模型需要考虑生态过程的本质特征： - <strong>如果生态过程主要受空间扩散限制</strong>：优先考虑SAR或CAR模型 - <strong>如果生态过程具有明显的时间惯性</strong>：优先考虑STAR模型 - <strong>如果数据具有复杂的时空交互</strong>：考虑更高级的贝叶斯时空模型 - <strong>如果计算资源有限</strong>：CAR模型通常计算效率更高</p>
<p><strong>模型参数的解释差异</strong>： - <strong>SAR模型</strong>：<span class="math inline">\(\rho\)</span>解释为空间依赖性的强度，反映邻近观测值的平均影响 - <strong>STAR模型</strong>：<span class="math inline">\(\rho\)</span>解释空间依赖性，<span class="math inline">\(\phi\)</span>解释时间依赖性，两者共同描述时空动态 - <strong>CAR模型</strong>：<span class="math inline">\(c_{ij}\)</span>解释局部空间依赖性的模式，反映条件依赖关系</p>
<p>这些模型框架为生态学家提供了丰富的工具选择，能够根据具体研究问题和数据特征选择最合适的时空建模方法。</p>
</div>
<div id="r语言中的时空自相关模型实现" class="section level3 hasAnchor" number="10.6.5">
<h3><span class="header-section-number">10.6.5</span> R语言中的时空自相关模型实现<a href="高级回归模型.html#r语言中的时空自相关模型实现" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在R语言中，时空自相关模型主要通过多个包实现，包括<code>spdep</code>、<code>spatialreg</code>、<code>spTimer</code>、<code>INLA</code>等。这些包提供了不同的建模方法和计算算法。</p>
<div class="sourceCode" id="cb2483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2483-1"><a href="高级回归模型.html#cb2483-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb2483-2"><a href="高级回归模型.html#cb2483-2" tabindex="-1"></a><span class="fu">library</span>(spdep)</span></code></pre></div>
<pre><code>## Loading required package: spData</code></pre>
<pre><code>## To access larger datasets in this package, install the spDataLarge
## package with: `install.packages(&#39;spDataLarge&#39;,
## repos=&#39;https://nowosad.github.io/drat/&#39;, type=&#39;source&#39;)`</code></pre>
<pre><code>## Loading required package: sf</code></pre>
<pre><code>## Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.4.0; sf_use_s2() is TRUE</code></pre>
<div class="sourceCode" id="cb2488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2488-1"><a href="高级回归模型.html#cb2488-1" tabindex="-1"></a><span class="fu">library</span>(spatialreg)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;spatialreg&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:spdep&#39;:
## 
##     get.ClusterOption, get.coresOption, get.mcOption,
##     get.VerboseOption, get.ZeroPolicyOption, set.ClusterOption,
##     set.coresOption, set.mcOption, set.VerboseOption,
##     set.ZeroPolicyOption</code></pre>
<div class="sourceCode" id="cb2491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2491-1"><a href="高级回归模型.html#cb2491-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2491-2"><a href="高级回归模型.html#cb2491-2" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb2491-3"><a href="高级回归模型.html#cb2491-3" tabindex="-1"></a></span>
<span id="cb2491-4"><a href="高级回归模型.html#cb2491-4" tabindex="-1"></a><span class="co"># 模拟生态学数据：湖泊水质的时间序列空间数据</span></span>
<span id="cb2491-5"><a href="高级回归模型.html#cb2491-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2491-6"><a href="高级回归模型.html#cb2491-6" tabindex="-1"></a>n_lakes <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># 50个湖泊</span></span>
<span id="cb2491-7"><a href="高级回归模型.html#cb2491-7" tabindex="-1"></a>n_years <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># 10年观测</span></span>
<span id="cb2491-8"><a href="高级回归模型.html#cb2491-8" tabindex="-1"></a>n_total <span class="ot">&lt;-</span> n_lakes <span class="sc">*</span> n_years</span>
<span id="cb2491-9"><a href="高级回归模型.html#cb2491-9" tabindex="-1"></a></span>
<span id="cb2491-10"><a href="高级回归模型.html#cb2491-10" tabindex="-1"></a><span class="co"># 创建空间坐标（模拟湖泊位置）</span></span>
<span id="cb2491-11"><a href="高级回归模型.html#cb2491-11" tabindex="-1"></a>lake_coords <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2491-12"><a href="高级回归模型.html#cb2491-12" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">runif</span>(n_lakes, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb2491-13"><a href="高级回归模型.html#cb2491-13" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">runif</span>(n_lakes, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb2491-14"><a href="高级回归模型.html#cb2491-14" tabindex="-1"></a>)</span>
<span id="cb2491-15"><a href="高级回归模型.html#cb2491-15" tabindex="-1"></a></span>
<span id="cb2491-16"><a href="高级回归模型.html#cb2491-16" tabindex="-1"></a><span class="co"># 创建时空数据集</span></span>
<span id="cb2491-17"><a href="高级回归模型.html#cb2491-17" tabindex="-1"></a>lake_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2491-18"><a href="高级回归模型.html#cb2491-18" tabindex="-1"></a>  <span class="at">lake_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_lakes, <span class="at">each =</span> n_years),</span>
<span id="cb2491-19"><a href="高级回归模型.html#cb2491-19" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_years, <span class="at">times =</span> n_lakes),</span>
<span id="cb2491-20"><a href="高级回归模型.html#cb2491-20" tabindex="-1"></a>  <span class="at">x_coord =</span> <span class="fu">rep</span>(lake_coords<span class="sc">$</span>x, <span class="at">each =</span> n_years),</span>
<span id="cb2491-21"><a href="高级回归模型.html#cb2491-21" tabindex="-1"></a>  <span class="at">y_coord =</span> <span class="fu">rep</span>(lake_coords<span class="sc">$</span>y, <span class="at">each =</span> n_years),</span>
<span id="cb2491-22"><a href="高级回归模型.html#cb2491-22" tabindex="-1"></a>  <span class="at">nutrient_input =</span> <span class="fu">runif</span>(n_total, <span class="fl">0.1</span>, <span class="dv">5</span>), <span class="co"># 营养盐输入</span></span>
<span id="cb2491-23"><a href="高级回归模型.html#cb2491-23" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">runif</span>(n_total, <span class="dv">5</span>, <span class="dv">25</span>) <span class="co"># 水温</span></span>
<span id="cb2491-24"><a href="高级回归模型.html#cb2491-24" tabindex="-1"></a>)</span>
<span id="cb2491-25"><a href="高级回归模型.html#cb2491-25" tabindex="-1"></a></span>
<span id="cb2491-26"><a href="高级回归模型.html#cb2491-26" tabindex="-1"></a><span class="co"># 模拟空间自相关和时间自相关</span></span>
<span id="cb2491-27"><a href="高级回归模型.html#cb2491-27" tabindex="-1"></a><span class="co"># 创建空间权重矩阵</span></span>
<span id="cb2491-28"><a href="高级回归模型.html#cb2491-28" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">cbind</span>(lake_coords<span class="sc">$</span>x, lake_coords<span class="sc">$</span>y)</span>
<span id="cb2491-29"><a href="高级回归模型.html#cb2491-29" tabindex="-1"></a>knb <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords, <span class="at">k =</span> <span class="dv">4</span>)) <span class="co"># 每个点的4个最近邻</span></span>
<span id="cb2491-30"><a href="高级回归模型.html#cb2491-30" tabindex="-1"></a>W_list <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(knb, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>) <span class="co"># 行标准化的权重矩阵</span></span>
<span id="cb2491-31"><a href="高级回归模型.html#cb2491-31" tabindex="-1"></a></span>
<span id="cb2491-32"><a href="高级回归模型.html#cb2491-32" tabindex="-1"></a><span class="co"># 模拟空间随机效应</span></span>
<span id="cb2491-33"><a href="高级回归模型.html#cb2491-33" tabindex="-1"></a>spatial_effects <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_lakes, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb2491-34"><a href="高级回归模型.html#cb2491-34" tabindex="-1"></a></span>
<span id="cb2491-35"><a href="高级回归模型.html#cb2491-35" tabindex="-1"></a><span class="co"># 模拟水质数据（叶绿素浓度）</span></span>
<span id="cb2491-36"><a href="高级回归模型.html#cb2491-36" tabindex="-1"></a><span class="co"># 包含空间自相关、时间自相关和环境效应</span></span>
<span id="cb2491-37"><a href="高级回归模型.html#cb2491-37" tabindex="-1"></a>lake_data<span class="sc">$</span>chlorophyll <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb2491-38"><a href="高级回归模型.html#cb2491-38" tabindex="-1"></a></span>
<span id="cb2491-39"><a href="高级回归模型.html#cb2491-39" tabindex="-1"></a><span class="co"># 初始化第一年的数据</span></span>
<span id="cb2491-40"><a href="高级回归模型.html#cb2491-40" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_lakes) {</span>
<span id="cb2491-41"><a href="高级回归模型.html#cb2491-41" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> (i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> n_years <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2491-42"><a href="高级回归模型.html#cb2491-42" tabindex="-1"></a>  lake_data<span class="sc">$</span>chlorophyll[idx] <span class="ot">&lt;-</span> (</span>
<span id="cb2491-43"><a href="高级回归模型.html#cb2491-43" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">+</span> <span class="co"># 基准水平</span></span>
<span id="cb2491-44"><a href="高级回归模型.html#cb2491-44" tabindex="-1"></a>      <span class="fl">0.5</span> <span class="sc">*</span> lake_data<span class="sc">$</span>nutrient_input[idx] <span class="sc">+</span></span>
<span id="cb2491-45"><a href="高级回归模型.html#cb2491-45" tabindex="-1"></a>      <span class="fl">0.1</span> <span class="sc">*</span> lake_data<span class="sc">$</span>temperature[idx] <span class="sc">+</span></span>
<span id="cb2491-46"><a href="高级回归模型.html#cb2491-46" tabindex="-1"></a>      spatial_effects[i] <span class="sc">+</span></span>
<span id="cb2491-47"><a href="高级回归模型.html#cb2491-47" tabindex="-1"></a>      <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb2491-48"><a href="高级回归模型.html#cb2491-48" tabindex="-1"></a>  )</span>
<span id="cb2491-49"><a href="高级回归模型.html#cb2491-49" tabindex="-1"></a>}</span>
<span id="cb2491-50"><a href="高级回归模型.html#cb2491-50" tabindex="-1"></a></span>
<span id="cb2491-51"><a href="高级回归模型.html#cb2491-51" tabindex="-1"></a><span class="co"># 模拟后续年份（包含时间自相关）</span></span>
<span id="cb2491-52"><a href="高级回归模型.html#cb2491-52" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_lakes) {</span>
<span id="cb2491-53"><a href="高级回归模型.html#cb2491-53" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_years) {</span>
<span id="cb2491-54"><a href="高级回归模型.html#cb2491-54" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> (i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> n_years <span class="sc">+</span> t</span>
<span id="cb2491-55"><a href="高级回归模型.html#cb2491-55" tabindex="-1"></a>    prev_idx <span class="ot">&lt;-</span> (i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> n_years <span class="sc">+</span> (t <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb2491-56"><a href="高级回归模型.html#cb2491-56" tabindex="-1"></a></span>
<span id="cb2491-57"><a href="高级回归模型.html#cb2491-57" tabindex="-1"></a>    <span class="co"># 空间自相关：邻近湖泊的平均影响</span></span>
<span id="cb2491-58"><a href="高级回归模型.html#cb2491-58" tabindex="-1"></a>    neighbors <span class="ot">&lt;-</span> knb[[i]]</span>
<span id="cb2491-59"><a href="高级回归模型.html#cb2491-59" tabindex="-1"></a>    spatial_lag <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2491-60"><a href="高级回归模型.html#cb2491-60" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(neighbors) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb2491-61"><a href="高级回归模型.html#cb2491-61" tabindex="-1"></a>      neighbor_chlorophyll <span class="ot">&lt;-</span> <span class="fu">sapply</span>(neighbors, <span class="cf">function</span>(j) {</span>
<span id="cb2491-62"><a href="高级回归模型.html#cb2491-62" tabindex="-1"></a>        neighbor_idx <span class="ot">&lt;-</span> (j <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> n_years <span class="sc">+</span> (t <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb2491-63"><a href="高级回归模型.html#cb2491-63" tabindex="-1"></a>        lake_data<span class="sc">$</span>chlorophyll[neighbor_idx]</span>
<span id="cb2491-64"><a href="高级回归模型.html#cb2491-64" tabindex="-1"></a>      })</span>
<span id="cb2491-65"><a href="高级回归模型.html#cb2491-65" tabindex="-1"></a>      <span class="co"># 确保neighbor_chlorophyll不包含NA值</span></span>
<span id="cb2491-66"><a href="高级回归模型.html#cb2491-66" tabindex="-1"></a>      valid_neighbors <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(neighbor_chlorophyll)</span>
<span id="cb2491-67"><a href="高级回归模型.html#cb2491-67" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">sum</span>(valid_neighbors) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb2491-68"><a href="高级回归模型.html#cb2491-68" tabindex="-1"></a>        spatial_lag <span class="ot">&lt;-</span> <span class="fl">0.3</span> <span class="sc">*</span> <span class="fu">mean</span>(neighbor_chlorophyll[valid_neighbors]) <span class="co"># 空间自相关系数</span></span>
<span id="cb2491-69"><a href="高级回归模型.html#cb2491-69" tabindex="-1"></a>      }</span>
<span id="cb2491-70"><a href="高级回归模型.html#cb2491-70" tabindex="-1"></a>    }</span>
<span id="cb2491-71"><a href="高级回归模型.html#cb2491-71" tabindex="-1"></a></span>
<span id="cb2491-72"><a href="高级回归模型.html#cb2491-72" tabindex="-1"></a>    lake_data<span class="sc">$</span>chlorophyll[idx] <span class="ot">&lt;-</span> (</span>
<span id="cb2491-73"><a href="高级回归模型.html#cb2491-73" tabindex="-1"></a>      <span class="dv">2</span> <span class="sc">+</span> <span class="co"># 基准水平</span></span>
<span id="cb2491-74"><a href="高级回归模型.html#cb2491-74" tabindex="-1"></a>        <span class="fl">0.5</span> <span class="sc">*</span> lake_data<span class="sc">$</span>nutrient_input[idx] <span class="sc">+</span></span>
<span id="cb2491-75"><a href="高级回归模型.html#cb2491-75" tabindex="-1"></a>        <span class="fl">0.1</span> <span class="sc">*</span> lake_data<span class="sc">$</span>temperature[idx] <span class="sc">+</span></span>
<span id="cb2491-76"><a href="高级回归模型.html#cb2491-76" tabindex="-1"></a>        <span class="fl">0.6</span> <span class="sc">*</span> lake_data<span class="sc">$</span>chlorophyll[prev_idx] <span class="sc">+</span> <span class="co"># 时间自相关</span></span>
<span id="cb2491-77"><a href="高级回归模型.html#cb2491-77" tabindex="-1"></a>        spatial_lag <span class="sc">+</span> <span class="co"># 空间自相关</span></span>
<span id="cb2491-78"><a href="高级回归模型.html#cb2491-78" tabindex="-1"></a>        spatial_effects[i] <span class="sc">+</span></span>
<span id="cb2491-79"><a href="高级回归模型.html#cb2491-79" tabindex="-1"></a>        <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb2491-80"><a href="高级回归模型.html#cb2491-80" tabindex="-1"></a>    )</span>
<span id="cb2491-81"><a href="高级回归模型.html#cb2491-81" tabindex="-1"></a>  }</span>
<span id="cb2491-82"><a href="高级回归模型.html#cb2491-82" tabindex="-1"></a>}</span>
<span id="cb2491-83"><a href="高级回归模型.html#cb2491-83" tabindex="-1"></a></span>
<span id="cb2491-84"><a href="高级回归模型.html#cb2491-84" tabindex="-1"></a><span class="co"># 确保没有缺失值</span></span>
<span id="cb2491-85"><a href="高级回归模型.html#cb2491-85" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(lake_data<span class="sc">$</span>chlorophyll))) {</span>
<span id="cb2491-86"><a href="高级回归模型.html#cb2491-86" tabindex="-1"></a>  lake_data<span class="sc">$</span>chlorophyll[<span class="fu">is.na</span>(lake_data<span class="sc">$</span>chlorophyll)] <span class="ot">&lt;-</span> <span class="fu">mean</span>(lake_data<span class="sc">$</span>chlorophyll, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2491-87"><a href="高级回归模型.html#cb2491-87" tabindex="-1"></a>}</span>
<span id="cb2491-88"><a href="高级回归模型.html#cb2491-88" tabindex="-1"></a></span>
<span id="cb2491-89"><a href="高级回归模型.html#cb2491-89" tabindex="-1"></a><span class="co"># 构建空间权重矩阵对象</span></span>
<span id="cb2491-90"><a href="高级回归模型.html#cb2491-90" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">cbind</span>(lake_data<span class="sc">$</span>x_coord, lake_data<span class="sc">$</span>y_coord)</span>
<span id="cb2491-91"><a href="高级回归模型.html#cb2491-91" tabindex="-1"></a>knb <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords, <span class="at">k =</span> <span class="dv">4</span>))</span></code></pre></div>
<pre><code>## Warning in knearneigh(coords, k = 4): knearneigh: identical points found</code></pre>
<pre><code>## Warning in knearneigh(coords, k = 4): knearneigh: kd_tree not available for
## identical points</code></pre>
<pre><code>## Warning in knn2nb(knearneigh(coords, k = 4)): neighbour object has 50
## sub-graphs</code></pre>
<div class="sourceCode" id="cb2495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2495-1"><a href="高级回归模型.html#cb2495-1" tabindex="-1"></a>W_list <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(knb, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb2495-2"><a href="高级回归模型.html#cb2495-2" tabindex="-1"></a></span>
<span id="cb2495-3"><a href="高级回归模型.html#cb2495-3" tabindex="-1"></a><span class="co"># 空间自相关检验</span></span>
<span id="cb2495-4"><a href="高级回归模型.html#cb2495-4" tabindex="-1"></a><span class="co"># Moran&#39;s I检验</span></span>
<span id="cb2495-5"><a href="高级回归模型.html#cb2495-5" tabindex="-1"></a>moran_test <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(lake_data<span class="sc">$</span>chlorophyll, W_list)</span>
<span id="cb2495-6"><a href="高级回归模型.html#cb2495-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Moran&#39;s I检验结果:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Moran&#39;s I检验结果:</code></pre>
<div class="sourceCode" id="cb2497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2497-1"><a href="高级回归模型.html#cb2497-1" tabindex="-1"></a><span class="fu">print</span>(moran_test)</span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  lake_data$chlorophyll  
## weights: W_list    
## 
## Moran I statistic standard deviate = 1.8604, p-value = 0.03141
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##      0.0485619924     -0.0020040080      0.0007387294</code></pre>
<div class="sourceCode" id="cb2499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2499-1"><a href="高级回归模型.html#cb2499-1" tabindex="-1"></a><span class="co"># 构建空间滞后模型（SAR）</span></span>
<span id="cb2499-2"><a href="高级回归模型.html#cb2499-2" tabindex="-1"></a>sar_model <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(chlorophyll <span class="sc">~</span> nutrient_input <span class="sc">+</span> temperature,</span>
<span id="cb2499-3"><a href="高级回归模型.html#cb2499-3" tabindex="-1"></a>  <span class="at">data =</span> lake_data, <span class="at">listw =</span> W_list</span>
<span id="cb2499-4"><a href="高级回归模型.html#cb2499-4" tabindex="-1"></a>)</span>
<span id="cb2499-5"><a href="高级回归模型.html#cb2499-5" tabindex="-1"></a></span>
<span id="cb2499-6"><a href="高级回归模型.html#cb2499-6" tabindex="-1"></a><span class="co"># 模型摘要</span></span>
<span id="cb2499-7"><a href="高级回归模型.html#cb2499-7" tabindex="-1"></a><span class="fu">summary</span>(sar_model)</span></code></pre></div>
<pre><code>## 
## Call:lagsarlm(formula = chlorophyll ~ nutrient_input + temperature, 
##     data = lake_data, listw = W_list)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -13.52486  -4.72802  -0.50508   5.00009  13.95306 
## 
## Type: lag 
## Coefficients: (asymptotic standard errors) 
##                 Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)    12.154139   1.359621  8.9394   &lt;2e-16
## nutrient_input  0.313310   0.201148  1.5576   0.1193
## temperature     0.013652   0.049646  0.2750   0.7833
## 
## Rho: 0.17171, LR test value: 4.2663, p-value: 0.038875
## Asymptotic standard error: 0.062838
##     z-value: 2.7326, p-value: 0.0062842
## Wald statistic: 7.467, p-value: 0.0062842
## 
## Log likelihood: -1631.175 for lag model
## ML residual variance (sigma squared): 39.756, (sigma: 6.3053)
## Number of observations: 500 
## Number of parameters estimated: 5 
## AIC: 3272.3, (AIC for lm: 3274.6)
## LM test for residual autocorrelation
## test value: 20.37, p-value: 6.3818e-06</code></pre>
<div class="sourceCode" id="cb2501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2501-1"><a href="高级回归模型.html#cb2501-1" tabindex="-1"></a><span class="co"># 空间误差模型（SEM）</span></span>
<span id="cb2501-2"><a href="高级回归模型.html#cb2501-2" tabindex="-1"></a>sem_model <span class="ot">&lt;-</span> <span class="fu">errorsarlm</span>(chlorophyll <span class="sc">~</span> nutrient_input <span class="sc">+</span> temperature,</span>
<span id="cb2501-3"><a href="高级回归模型.html#cb2501-3" tabindex="-1"></a>  <span class="at">data =</span> lake_data, <span class="at">listw =</span> W_list</span>
<span id="cb2501-4"><a href="高级回归模型.html#cb2501-4" tabindex="-1"></a>)</span>
<span id="cb2501-5"><a href="高级回归模型.html#cb2501-5" tabindex="-1"></a></span>
<span id="cb2501-6"><a href="高级回归模型.html#cb2501-6" tabindex="-1"></a><span class="co"># 模型比较</span></span>
<span id="cb2501-7"><a href="高级回归模型.html#cb2501-7" tabindex="-1"></a><span class="fu">AIC</span>(sar_model, sem_model)</span></code></pre></div>
<pre><code>##           df      AIC
## sar_model  5 3272.349
## sem_model  5 3272.240</code></pre>
<div class="sourceCode" id="cb2503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2503-1"><a href="高级回归模型.html#cb2503-1" tabindex="-1"></a><span class="co"># 空间杜宾模型（SDM）- 包含解释变量的空间滞后</span></span>
<span id="cb2503-2"><a href="高级回归模型.html#cb2503-2" tabindex="-1"></a>sdm_model <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(chlorophyll <span class="sc">~</span> nutrient_input <span class="sc">+</span> temperature,</span>
<span id="cb2503-3"><a href="高级回归模型.html#cb2503-3" tabindex="-1"></a>  <span class="at">data =</span> lake_data, <span class="at">listw =</span> W_list,</span>
<span id="cb2503-4"><a href="高级回归模型.html#cb2503-4" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;mixed&quot;</span></span>
<span id="cb2503-5"><a href="高级回归模型.html#cb2503-5" tabindex="-1"></a>)</span>
<span id="cb2503-6"><a href="高级回归模型.html#cb2503-6" tabindex="-1"></a></span>
<span id="cb2503-7"><a href="高级回归模型.html#cb2503-7" tabindex="-1"></a><span class="co"># 模型比较</span></span>
<span id="cb2503-8"><a href="高级回归模型.html#cb2503-8" tabindex="-1"></a><span class="fu">AIC</span>(sar_model, sem_model, sdm_model)</span></code></pre></div>
<pre><code>##           df      AIC
## sar_model  5 3272.349
## sem_model  5 3272.240
## sdm_model  7 3276.112</code></pre>
<div class="sourceCode" id="cb2505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2505-1"><a href="高级回归模型.html#cb2505-1" tabindex="-1"></a><span class="co"># 提取空间自相关系数</span></span>
<span id="cb2505-2"><a href="高级回归模型.html#cb2505-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;空间自相关系数 (rho):&quot;</span>, sar_model<span class="sc">$</span>rho, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 空间自相关系数 (rho): 0.1717082</code></pre>
<div class="sourceCode" id="cb2507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2507-1"><a href="高级回归模型.html#cb2507-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;空间自相关系数标准误:&quot;</span>, sar_model<span class="sc">$</span>rho.se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 空间自相关系数标准误: 0.06283756</code></pre>
<div class="sourceCode" id="cb2509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2509-1"><a href="高级回归模型.html#cb2509-1" tabindex="-1"></a><span class="co"># 模型诊断</span></span>
<span id="cb2509-2"><a href="高级回归模型.html#cb2509-2" tabindex="-1"></a><span class="co"># 残差的空间自相关检验</span></span>
<span id="cb2509-3"><a href="高级回归模型.html#cb2509-3" tabindex="-1"></a>residuals_moran <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="fu">residuals</span>(sar_model), W_list)</span>
<span id="cb2509-4"><a href="高级回归模型.html#cb2509-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;残差的空间自相关检验:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 残差的空间自相关检验:</code></pre>
<div class="sourceCode" id="cb2511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2511-1"><a href="高级回归模型.html#cb2511-1" tabindex="-1"></a><span class="fu">print</span>(residuals_moran)</span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  residuals(sar_model)  
## weights: W_list    
## 
## Moran I statistic standard deviate = -0.32989, p-value = 0.6293
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##      -0.010970438      -0.002004008       0.000738753</code></pre>
<div class="sourceCode" id="cb2513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2513-1"><a href="高级回归模型.html#cb2513-1" tabindex="-1"></a><span class="co"># 可视化空间格局</span></span>
<span id="cb2513-2"><a href="高级回归模型.html#cb2513-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2513-3"><a href="高级回归模型.html#cb2513-3" tabindex="-1"></a>spatial_data <span class="ot">&lt;-</span> lake_data[lake_data<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">1</span>, ] <span class="co"># 使用第一年数据</span></span>
<span id="cb2513-4"><a href="高级回归模型.html#cb2513-4" tabindex="-1"></a><span class="fu">ggplot</span>(spatial_data, <span class="fu">aes</span>(<span class="at">x =</span> x_coord, <span class="at">y =</span> y_coord, <span class="at">color =</span> chlorophyll)) <span class="sc">+</span></span>
<span id="cb2513-5"><a href="高级回归模型.html#cb2513-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb2513-6"><a href="高级回归模型.html#cb2513-6" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb2513-7"><a href="高级回归模型.html#cb2513-7" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2513-8"><a href="高级回归模型.html#cb2513-8" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;经度&quot;</span>, <span class="at">y =</span> <span class="st">&quot;纬度&quot;</span>, <span class="at">color =</span> <span class="st">&quot;叶绿素浓度&quot;</span>,</span>
<span id="cb2513-9"><a href="高级回归模型.html#cb2513-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;湖泊叶绿素浓度的空间分布&quot;</span></span>
<span id="cb2513-10"><a href="高级回归模型.html#cb2513-10" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2513-11"><a href="高级回归模型.html#cb2513-11" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-29"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-29-1.png" alt="湖泊叶绿素浓度空间分布图" width="672" />
<p class="caption">
图2.21: 湖泊叶绿素浓度空间分布图
</p>
</div>
<p>在这个例子中，我们使用了几个关键函数：<code>moran.test()</code>用于检验空间自相关性，<code>lagsarlm()</code>用于构建空间滞后模型，<code>errorsarlm()</code>用于构建空间误差模型。通过这些函数，我们能够建模和检验生态数据的空间依赖性。</p>
</div>
<div id="时空自相关模型的生态学应用" class="section level3 hasAnchor" number="10.6.6">
<h3><span class="header-section-number">10.6.6</span> 时空自相关模型的生态学应用<a href="高级回归模型.html#时空自相关模型的生态学应用" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>时空自相关模型在生态学研究中具有广泛的应用价值，主要体现在以下几个方面：</p>
<p><strong>物种分布建模</strong>：传统的物种分布模型往往忽视空间自相关，导致模型参数估计有偏。时空模型能够正确考虑物种扩散限制、栖息地连通性等空间过程，提高分布预测的准确性。</p>
<p><strong>种群动态分析</strong>：种群数量在时间和空间上都具有自相关性。时空模型能够捕捉种群增长的惯性、密度依赖性、扩散过程等生态机制，为种群管理提供更可靠的依据。</p>
<p><strong>环境预测</strong>：环境因子如温度、降水、水质等在时空维度上具有强烈的自相关性。时空模型能够利用这种自相关性提高环境预测的精度，为气候变化研究和环境管理提供支持。</p>
<p><strong>生态系统过程建模</strong>：养分循环、能量流动、生物地球化学过程等生态系统过程在时空尺度上相互关联。时空模型能够揭示这些过程的时空格局和驱动机制。</p>
<p>让我们通过一个具体的生态学应用例子来展示时空模型的价值：</p>
<div class="sourceCode" id="cb2514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2514-1"><a href="高级回归模型.html#cb2514-1" tabindex="-1"></a><span class="co"># 鸟类种群动态的时空建模示例（简化版本）</span></span>
<span id="cb2514-2"><a href="高级回归模型.html#cb2514-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2514-3"><a href="高级回归模型.html#cb2514-3" tabindex="-1"></a>n_sites <span class="ot">&lt;-</span> <span class="dv">30</span> <span class="co"># 30个观测点</span></span>
<span id="cb2514-4"><a href="高级回归模型.html#cb2514-4" tabindex="-1"></a>n_years <span class="ot">&lt;-</span> <span class="dv">5</span>  <span class="co"># 5年观测（减少年份以简化计算）</span></span>
<span id="cb2514-5"><a href="高级回归模型.html#cb2514-5" tabindex="-1"></a></span>
<span id="cb2514-6"><a href="高级回归模型.html#cb2514-6" tabindex="-1"></a><span class="co"># 创建空间网格</span></span>
<span id="cb2514-7"><a href="高级回归模型.html#cb2514-7" tabindex="-1"></a>site_coords <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb2514-8"><a href="高级回归模型.html#cb2514-8" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb2514-9"><a href="高级回归模型.html#cb2514-9" tabindex="-1"></a>  <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb2514-10"><a href="高级回归模型.html#cb2514-10" tabindex="-1"></a>)</span>
<span id="cb2514-11"><a href="高级回归模型.html#cb2514-11" tabindex="-1"></a>site_coords<span class="sc">$</span>site_id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(site_coords)</span>
<span id="cb2514-12"><a href="高级回归模型.html#cb2514-12" tabindex="-1"></a></span>
<span id="cb2514-13"><a href="高级回归模型.html#cb2514-13" tabindex="-1"></a><span class="co"># 创建时空数据集</span></span>
<span id="cb2514-14"><a href="高级回归模型.html#cb2514-14" tabindex="-1"></a>bird_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2514-15"><a href="高级回归模型.html#cb2514-15" tabindex="-1"></a>  <span class="at">site_id =</span> <span class="fu">rep</span>(site_coords<span class="sc">$</span>site_id, <span class="at">each =</span> n_years),</span>
<span id="cb2514-16"><a href="高级回归模型.html#cb2514-16" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_years, <span class="at">times =</span> <span class="fu">nrow</span>(site_coords)),</span>
<span id="cb2514-17"><a href="高级回归模型.html#cb2514-17" tabindex="-1"></a>  <span class="at">x_coord =</span> <span class="fu">rep</span>(site_coords<span class="sc">$</span>x, <span class="at">each =</span> n_years),</span>
<span id="cb2514-18"><a href="高级回归模型.html#cb2514-18" tabindex="-1"></a>  <span class="at">y_coord =</span> <span class="fu">rep</span>(site_coords<span class="sc">$</span>y, <span class="at">each =</span> n_years),</span>
<span id="cb2514-19"><a href="高级回归模型.html#cb2514-19" tabindex="-1"></a>  <span class="at">habitat_quality =</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(site_coords) <span class="sc">*</span> n_years, <span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># 栖息地质量</span></span>
<span id="cb2514-20"><a href="高级回归模型.html#cb2514-20" tabindex="-1"></a>  <span class="at">precipitation =</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(site_coords) <span class="sc">*</span> n_years, <span class="dv">300</span>, <span class="dv">1200</span>) <span class="co"># 降水量</span></span>
<span id="cb2514-21"><a href="高级回归模型.html#cb2514-21" tabindex="-1"></a>)</span>
<span id="cb2514-22"><a href="高级回归模型.html#cb2514-22" tabindex="-1"></a></span>
<span id="cb2514-23"><a href="高级回归模型.html#cb2514-23" tabindex="-1"></a><span class="co"># 创建空间权重矩阵（基于邻接关系）</span></span>
<span id="cb2514-24"><a href="高级回归模型.html#cb2514-24" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(site_coords[, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)])</span>
<span id="cb2514-25"><a href="高级回归模型.html#cb2514-25" tabindex="-1"></a><span class="co"># 创建邻接矩阵（Queen邻接）</span></span>
<span id="cb2514-26"><a href="高级回归模型.html#cb2514-26" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">cell2nb</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="at">type =</span> <span class="st">&quot;queen&quot;</span>)</span>
<span id="cb2514-27"><a href="高级回归模型.html#cb2514-27" tabindex="-1"></a>W_list <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb2514-28"><a href="高级回归模型.html#cb2514-28" tabindex="-1"></a></span>
<span id="cb2514-29"><a href="高级回归模型.html#cb2514-29" tabindex="-1"></a><span class="co"># 简化模拟：使用更稳定的数据生成方法</span></span>
<span id="cb2514-30"><a href="高级回归模型.html#cb2514-30" tabindex="-1"></a><span class="co"># 模拟空间随机效应</span></span>
<span id="cb2514-31"><a href="高级回归模型.html#cb2514-31" tabindex="-1"></a>spatial_effects <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(site_coords), <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb2514-32"><a href="高级回归模型.html#cb2514-32" tabindex="-1"></a></span>
<span id="cb2514-33"><a href="高级回归模型.html#cb2514-33" tabindex="-1"></a><span class="co"># 模拟时间随机效应</span></span>
<span id="cb2514-34"><a href="高级回归模型.html#cb2514-34" tabindex="-1"></a>temporal_effects <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_years, <span class="dv">0</span>, <span class="fl">0.3</span>)</span>
<span id="cb2514-35"><a href="高级回归模型.html#cb2514-35" tabindex="-1"></a></span>
<span id="cb2514-36"><a href="高级回归模型.html#cb2514-36" tabindex="-1"></a><span class="co"># 模拟鸟类丰富度数据</span></span>
<span id="cb2514-37"><a href="高级回归模型.html#cb2514-37" tabindex="-1"></a>linear_predictor <span class="ot">&lt;-</span> (</span>
<span id="cb2514-38"><a href="高级回归模型.html#cb2514-38" tabindex="-1"></a>  <span class="dv">2</span> <span class="sc">+</span> <span class="co"># 截距</span></span>
<span id="cb2514-39"><a href="高级回归模型.html#cb2514-39" tabindex="-1"></a>    <span class="fl">0.5</span> <span class="sc">*</span> bird_data<span class="sc">$</span>habitat_quality <span class="sc">+</span></span>
<span id="cb2514-40"><a href="高级回归模型.html#cb2514-40" tabindex="-1"></a>    <span class="fl">0.001</span> <span class="sc">*</span> bird_data<span class="sc">$</span>precipitation <span class="sc">+</span></span>
<span id="cb2514-41"><a href="高级回归模型.html#cb2514-41" tabindex="-1"></a>    spatial_effects[bird_data<span class="sc">$</span>site_id] <span class="sc">+</span></span>
<span id="cb2514-42"><a href="高级回归模型.html#cb2514-42" tabindex="-1"></a>    temporal_effects[bird_data<span class="sc">$</span>year] <span class="sc">+</span></span>
<span id="cb2514-43"><a href="高级回归模型.html#cb2514-43" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="fu">nrow</span>(bird_data), <span class="dv">0</span>, <span class="fl">0.2</span>)</span>
<span id="cb2514-44"><a href="高级回归模型.html#cb2514-44" tabindex="-1"></a>)</span>
<span id="cb2514-45"><a href="高级回归模型.html#cb2514-45" tabindex="-1"></a></span>
<span id="cb2514-46"><a href="高级回归模型.html#cb2514-46" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">exp</span>(linear_predictor)</span>
<span id="cb2514-47"><a href="高级回归模型.html#cb2514-47" tabindex="-1"></a>bird_data<span class="sc">$</span>species_richness <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="fu">nrow</span>(bird_data), lambda)</span>
<span id="cb2514-48"><a href="高级回归模型.html#cb2514-48" tabindex="-1"></a></span>
<span id="cb2514-49"><a href="高级回归模型.html#cb2514-49" tabindex="-1"></a><span class="co"># 构建空间自回归模型（仅使用第一年数据演示）</span></span>
<span id="cb2514-50"><a href="高级回归模型.html#cb2514-50" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb2514-51"><a href="高级回归模型.html#cb2514-51" tabindex="-1"></a></span>
<span id="cb2514-52"><a href="高级回归模型.html#cb2514-52" tabindex="-1"></a><span class="co"># 使用第一年数据构建空间模型</span></span>
<span id="cb2514-53"><a href="高级回归模型.html#cb2514-53" tabindex="-1"></a>year1_data <span class="ot">&lt;-</span> bird_data[bird_data<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">1</span>, ]</span>
<span id="cb2514-54"><a href="高级回归模型.html#cb2514-54" tabindex="-1"></a></span>
<span id="cb2514-55"><a href="高级回归模型.html#cb2514-55" tabindex="-1"></a><span class="co"># 构建空间滞后模型</span></span>
<span id="cb2514-56"><a href="高级回归模型.html#cb2514-56" tabindex="-1"></a>sar_model <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(<span class="fu">log</span>(species_richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> habitat_quality <span class="sc">+</span> precipitation,</span>
<span id="cb2514-57"><a href="高级回归模型.html#cb2514-57" tabindex="-1"></a>  <span class="at">data =</span> year1_data, <span class="at">listw =</span> W_list</span>
<span id="cb2514-58"><a href="高级回归模型.html#cb2514-58" tabindex="-1"></a>)</span>
<span id="cb2514-59"><a href="高级回归模型.html#cb2514-59" tabindex="-1"></a></span>
<span id="cb2514-60"><a href="高级回归模型.html#cb2514-60" tabindex="-1"></a><span class="co"># 模型摘要</span></span>
<span id="cb2514-61"><a href="高级回归模型.html#cb2514-61" tabindex="-1"></a><span class="fu">summary</span>(sar_model)</span></code></pre></div>
<pre><code>## 
## Call:lagsarlm(formula = log(species_richness + 1) ~ habitat_quality + 
##     precipitation, data = year1_data, listw = W_list)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -1.025018 -0.195146 -0.061256  0.238585  1.465485 
## 
## Type: lag 
## Coefficients: (asymptotic standard errors) 
##                   Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)     2.56747047 1.00180127  2.5629  0.01038
## habitat_quality 0.03641369 0.26917425  0.1353  0.89239
## precipitation   0.00106643 0.00045131  2.3630  0.01813
## 
## Rho: -0.14685, LR test value: 0.20043, p-value: 0.65438
## Asymptotic standard error: 0.30926
##     z-value: -0.47483, p-value: 0.63491
## Wald statistic: 0.22546, p-value: 0.63491
## 
## Log likelihood: -18.08926 for lag model
## ML residual variance (sigma squared): 0.19486, (sigma: 0.44143)
## Number of observations: 30 
## Number of parameters estimated: 5 
## AIC: 46.179, (AIC for lm: 44.379)
## LM test for residual autocorrelation
## test value: 0.58835, p-value: 0.44306</code></pre>
<div class="sourceCode" id="cb2516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2516-1"><a href="高级回归模型.html#cb2516-1" tabindex="-1"></a><span class="co"># 提取空间自相关系数</span></span>
<span id="cb2516-2"><a href="高级回归模型.html#cb2516-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;空间自相关系数 (rho):&quot;</span>, sar_model<span class="sc">$</span>rho, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 空间自相关系数 (rho): -0.1468463</code></pre>
<div class="sourceCode" id="cb2518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2518-1"><a href="高级回归模型.html#cb2518-1" tabindex="-1"></a><span class="co"># 可视化空间格局</span></span>
<span id="cb2518-2"><a href="高级回归模型.html#cb2518-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2518-3"><a href="高级回归模型.html#cb2518-3" tabindex="-1"></a>spatial_plot_data <span class="ot">&lt;-</span> year1_data</span>
<span id="cb2518-4"><a href="高级回归模型.html#cb2518-4" tabindex="-1"></a>spatial_plot_data<span class="sc">$</span>predicted <span class="ot">&lt;-</span> <span class="fu">fitted</span>(sar_model)</span></code></pre></div>
<pre><code>## This method assumes the response is known - see manual page</code></pre>
<div class="sourceCode" id="cb2520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2520-1"><a href="高级回归模型.html#cb2520-1" tabindex="-1"></a><span class="fu">ggplot</span>(spatial_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> x_coord, <span class="at">y =</span> y_coord, <span class="at">color =</span> predicted)) <span class="sc">+</span></span>
<span id="cb2520-2"><a href="高级回归模型.html#cb2520-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb2520-3"><a href="高级回归模型.html#cb2520-3" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb2520-4"><a href="高级回归模型.html#cb2520-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2520-5"><a href="高级回归模型.html#cb2520-5" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y坐标&quot;</span>, <span class="at">color =</span> <span class="st">&quot;预测物种丰富度&quot;</span>,</span>
<span id="cb2520-6"><a href="高级回归模型.html#cb2520-6" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;鸟类物种丰富度的空间预测格局&quot;</span></span>
<span id="cb2520-7"><a href="高级回归模型.html#cb2520-7" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2520-8"><a href="高级回归模型.html#cb2520-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-30"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-30-1.png" alt="鸟类物种丰富度空间预测格局图" width="672" />
<p class="caption">
图2.22: 鸟类物种丰富度空间预测格局图
</p>
</div>
<div class="sourceCode" id="cb2521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2521-1"><a href="高级回归模型.html#cb2521-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;时空模型能够考虑空间位置和邻近站点的信息，</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 时空模型能够考虑空间位置和邻近站点的信息，</code></pre>
<div class="sourceCode" id="cb2523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2523-1"><a href="高级回归模型.html#cb2523-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;提供更准确的物种丰富度预测。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 提供更准确的物种丰富度预测。</code></pre>
</div>
<div id="模型诊断与注意事项-1" class="section level3 hasAnchor" number="10.6.7">
<h3><span class="header-section-number">10.6.7</span> 模型诊断与注意事项<a href="高级回归模型.html#模型诊断与注意事项-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>时空自相关模型的诊断比传统回归模型更为复杂，需要特别关注空间残差的相关性、模型设定的合理性和计算可行性。</p>
<p><strong>空间残差诊断</strong>：</p>
<div class="sourceCode" id="cb2525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2525-1"><a href="高级回归模型.html#cb2525-1" tabindex="-1"></a><span class="co"># 检查残差的空间自相关</span></span>
<span id="cb2525-2"><a href="高级回归模型.html#cb2525-2" tabindex="-1"></a>residuals_moran <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="fu">residuals</span>(sar_model), W_list)</span>
<span id="cb2525-3"><a href="高级回归模型.html#cb2525-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;残差的空间自相关检验:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 残差的空间自相关检验:</code></pre>
<div class="sourceCode" id="cb2527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2527-1"><a href="高级回归模型.html#cb2527-1" tabindex="-1"></a><span class="fu">print</span>(residuals_moran)</span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  residuals(sar_model)  
## weights: W_list    
## 
## Moran I statistic standard deviate = 0.61861, p-value = 0.2681
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##       0.022497602      -0.034482759       0.008484431</code></pre>
<div class="sourceCode" id="cb2529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2529-1"><a href="高级回归模型.html#cb2529-1" tabindex="-1"></a><span class="co"># 如果残差仍存在空间自相关，说明模型未能完全捕捉空间依赖性</span></span>
<span id="cb2529-2"><a href="高级回归模型.html#cb2529-2" tabindex="-1"></a><span class="co"># 可能需要更复杂的空间模型结构</span></span>
<span id="cb2529-3"><a href="高级回归模型.html#cb2529-3" tabindex="-1"></a></span>
<span id="cb2529-4"><a href="高级回归模型.html#cb2529-4" tabindex="-1"></a><span class="co"># 空间残差的可视化</span></span>
<span id="cb2529-5"><a href="高级回归模型.html#cb2529-5" tabindex="-1"></a>residual_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2529-6"><a href="高级回归模型.html#cb2529-6" tabindex="-1"></a>  <span class="at">x =</span> year1_data<span class="sc">$</span>x_coord,</span>
<span id="cb2529-7"><a href="高级回归模型.html#cb2529-7" tabindex="-1"></a>  <span class="at">y =</span> year1_data<span class="sc">$</span>y_coord,</span>
<span id="cb2529-8"><a href="高级回归模型.html#cb2529-8" tabindex="-1"></a>  <span class="at">residuals =</span> <span class="fu">residuals</span>(sar_model)</span>
<span id="cb2529-9"><a href="高级回归模型.html#cb2529-9" tabindex="-1"></a>)</span>
<span id="cb2529-10"><a href="高级回归模型.html#cb2529-10" tabindex="-1"></a></span>
<span id="cb2529-11"><a href="高级回归模型.html#cb2529-11" tabindex="-1"></a><span class="fu">ggplot</span>(residual_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> residuals)) <span class="sc">+</span></span>
<span id="cb2529-12"><a href="高级回归模型.html#cb2529-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2529-13"><a href="高级回归模型.html#cb2529-13" tabindex="-1"></a>  <span class="fu">scale_color_gradient2</span>(<span class="at">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb2529-14"><a href="高级回归模型.html#cb2529-14" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb2529-15"><a href="高级回归模型.html#cb2529-15" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y坐标&quot;</span>, <span class="at">color =</span> <span class="st">&quot;残差&quot;</span>,</span>
<span id="cb2529-16"><a href="高级回归模型.html#cb2529-16" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;空间模型残差分布&quot;</span></span>
<span id="cb2529-17"><a href="高级回归模型.html#cb2529-17" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb2529-18"><a href="高级回归模型.html#cb2529-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-31"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-31-1.png" alt="空间模型残差分布图" width="672" />
<p class="caption">
图2.23: 空间模型残差分布图
</p>
</div>
<p><strong>模型比较与选择</strong>：</p>
<div class="sourceCode" id="cb2530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2530-1"><a href="高级回归模型.html#cb2530-1" tabindex="-1"></a><span class="co"># 比较不同空间模型结构</span></span>
<span id="cb2530-2"><a href="高级回归模型.html#cb2530-2" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb2530-3"><a href="高级回归模型.html#cb2530-3" tabindex="-1"></a>  <span class="at">OLS =</span> <span class="fu">lm</span>(<span class="fu">log</span>(species_richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> habitat_quality <span class="sc">+</span> precipitation, <span class="at">data =</span> year1_data),</span>
<span id="cb2530-4"><a href="高级回归模型.html#cb2530-4" tabindex="-1"></a>  <span class="at">SAR =</span> sar_model</span>
<span id="cb2530-5"><a href="高级回归模型.html#cb2530-5" tabindex="-1"></a>)</span>
<span id="cb2530-6"><a href="高级回归模型.html#cb2530-6" tabindex="-1"></a></span>
<span id="cb2530-7"><a href="高级回归模型.html#cb2530-7" tabindex="-1"></a><span class="co"># 计算AIC</span></span>
<span id="cb2530-8"><a href="高级回归模型.html#cb2530-8" tabindex="-1"></a>model_aic <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models, AIC)</span>
<span id="cb2530-9"><a href="高级回归模型.html#cb2530-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模型AIC比较:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 模型AIC比较:</code></pre>
<div class="sourceCode" id="cb2532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2532-1"><a href="高级回归模型.html#cb2532-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sort</span>(model_aic))</span></code></pre></div>
<pre><code>##      OLS      SAR 
## 44.37896 46.17853</code></pre>
<div class="sourceCode" id="cb2534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2534-1"><a href="高级回归模型.html#cb2534-1" tabindex="-1"></a><span class="co"># 注意：由于数据集的差异，无法直接比较SAR、SEM和SDM模型</span></span>
<span id="cb2534-2"><a href="高级回归模型.html#cb2534-2" tabindex="-1"></a><span class="co"># 在实际应用中，应确保所有模型使用相同的数据集</span></span></code></pre></div>
<p><strong>常见问题与解决方案</strong>： - <strong>计算复杂性</strong>：时空模型通常计算密集，可能需要简化模型结构或使用近似算法 - <strong>权重矩阵选择</strong>：空间权重矩阵的选择对结果影响很大，需要基于生态学知识合理选择 - <strong>模型识别</strong>：某些时空模型可能存在识别问题，需要仔细检查模型设定 - <strong>尺度效应</strong>：空间和时间尺度选择会影响模型结果，需要进行多尺度分析</p>
<p>时空自相关模型为生态学家提供了一个强大的工具，使我们能够更准确地分析具有时空依赖性的生态数据，理解生态过程的时空动态，为生态保护和管理决策提供更可靠的科学依据。通过合理使用时序自相关模型，我们能够更好地捕捉生态系统的时空复杂性，揭示隐藏在数据背后的生态规律。</p>
</div>
</div>
<div id="结构方程模型" class="section level2 hasAnchor" number="10.7">
<h2><span class="header-section-number">10.7</span> 结构方程模型<a href="高级回归模型.html#结构方程模型" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在生态学研究中，我们经常面临一个根本性的挑战：生态系统的复杂因果关系网络。传统的统计方法如回归分析只能检验变量间的直接关系，但无法揭示复杂的因果机制。例如，气候变化可能直接影响物种分布，同时也通过改变竞争关系、捕食压力、资源可用性等多个途径产生间接影响。生态系统中的变量往往构成复杂的因果网络，其中许多重要的生态概念如生态系统健康、生物多样性、生态功能等都是无法直接观测的潜变量。结构方程模型（SEM）正是为解决这类问题而发展起来的，它通过整合测量模型和结构模型，能够同时检验复杂的因果假设和测量关系，为生态学研究提供了更强大的分析工具。</p>
<div id="结构方程模型的基本框架" class="section level3 hasAnchor" number="10.7.1">
<h3><span class="header-section-number">10.7.1</span> 结构方程模型的基本框架<a href="高级回归模型.html#结构方程模型的基本框架" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>结构方程模型由两个核心部分组成：测量模型和结构模型。测量模型描述潜变量与观测指标之间的关系，而结构模型则描述潜变量之间的因果关系。</p>
<p><strong>测量模型（Measurement Model）</strong>： 测量模型定义了潜变量如何通过观测变量来测量。例如，在研究生态系统健康时，我们可能使用水质指标、生物多样性指数、生态系统功能等多个观测变量来测量”生态系统健康”这个潜变量。测量模型的数学形式为：</p>
<p><span class="math display">\[x = \Lambda_x \xi + \delta\]</span> <span class="math display">\[y = \Lambda_y \eta + \epsilon\]</span></p>
<p>其中<span class="math inline">\(x\)</span>和<span class="math inline">\(y\)</span>分别是外生和内生观测变量，<span class="math inline">\(\xi\)</span>和<span class="math inline">\(\eta\)</span>是外生和内生潜变量，<span class="math inline">\(\Lambda_x\)</span>和<span class="math inline">\(\Lambda_y\)</span>是因子载荷矩阵，<span class="math inline">\(\delta\)</span>和<span class="math inline">\(\epsilon\)</span>是测量误差。</p>
<p><strong>结构模型（Structural Model）</strong>： 结构模型描述了潜变量之间的因果关系。例如，在研究气候变化对生态系统的影响时，我们可能假设气候变化通过影响物种组成进而影响生态系统功能。结构模型的数学形式为：</p>
<p><span class="math display">\[\eta = B\eta + \Gamma\xi + \zeta\]</span></p>
<p>其中<span class="math inline">\(\eta\)</span>是内生潜变量，<span class="math inline">\(\xi\)</span>是外生潜变量，<span class="math inline">\(B\)</span>是内生潜变量间的路径系数矩阵，<span class="math inline">\(\Gamma\)</span>是外生潜变量对内生潜变量的路径系数矩阵，<span class="math inline">\(\zeta\)</span>是结构残差。</p>
</div>
<div id="r语言中的结构方程模型实现" class="section level3 hasAnchor" number="10.7.2">
<h3><span class="header-section-number">10.7.2</span> R语言中的结构方程模型实现<a href="高级回归模型.html#r语言中的结构方程模型实现" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在R语言中，结构方程模型主要通过<code>lavaan</code>包实现，该包提供了简洁的语法来定义复杂的因果模型。让我们通过一个具体的生态学例子来演示SEM的应用。</p>
<div id="第一部分数据准备和模型设定" class="section level4 hasAnchor" number="10.7.2.1">
<h4><span class="header-section-number">10.7.2.1</span> 第一部分：数据准备和模型设定<a href="高级回归模型.html#第一部分数据准备和模型设定" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>假设我们研究森林生态系统中气候、土壤、植被和动物多样性之间的复杂关系：</p>
<div class="sourceCode" id="cb2535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2535-1"><a href="高级回归模型.html#cb2535-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb2535-2"><a href="高级回归模型.html#cb2535-2" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span></code></pre></div>
<pre><code>## This is lavaan 0.6-20
## lavaan is FREE software! Please report any bugs.</code></pre>
<div class="sourceCode" id="cb2537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2537-1"><a href="高级回归模型.html#cb2537-1" tabindex="-1"></a><span class="fu">library</span>(semPlot)</span>
<span id="cb2537-2"><a href="高级回归模型.html#cb2537-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2537-3"><a href="高级回归模型.html#cb2537-3" tabindex="-1"></a></span>
<span id="cb2537-4"><a href="高级回归模型.html#cb2537-4" tabindex="-1"></a><span class="co"># 模拟生态学数据：森林生态系统复杂关系</span></span>
<span id="cb2537-5"><a href="高级回归模型.html#cb2537-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb2537-6"><a href="高级回归模型.html#cb2537-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb2537-7"><a href="高级回归模型.html#cb2537-7" tabindex="-1"></a></span>
<span id="cb2537-8"><a href="高级回归模型.html#cb2537-8" tabindex="-1"></a>forest_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2537-9"><a href="高级回归模型.html#cb2537-9" tabindex="-1"></a>  <span class="co"># 气候因子（外生观测变量）</span></span>
<span id="cb2537-10"><a href="高级回归模型.html#cb2537-10" tabindex="-1"></a>  <span class="at">temperature =</span> <span class="fu">rnorm</span>(n, <span class="dv">15</span>, <span class="dv">3</span>), <span class="co"># 年均温</span></span>
<span id="cb2537-11"><a href="高级回归模型.html#cb2537-11" tabindex="-1"></a>  <span class="at">precipitation =</span> <span class="fu">rnorm</span>(n, <span class="dv">800</span>, <span class="dv">200</span>), <span class="co"># 年降水量</span></span>
<span id="cb2537-12"><a href="高级回归模型.html#cb2537-12" tabindex="-1"></a></span>
<span id="cb2537-13"><a href="高级回归模型.html#cb2537-13" tabindex="-1"></a>  <span class="co"># 土壤特性观测变量</span></span>
<span id="cb2537-14"><a href="高级回归模型.html#cb2537-14" tabindex="-1"></a>  <span class="at">soil_ph =</span> <span class="fu">rnorm</span>(n, <span class="fl">6.5</span>, <span class="fl">0.5</span>), <span class="co"># 土壤pH</span></span>
<span id="cb2537-15"><a href="高级回归模型.html#cb2537-15" tabindex="-1"></a>  <span class="at">soil_organic =</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>), <span class="co"># 土壤有机质含量</span></span>
<span id="cb2537-16"><a href="高级回归模型.html#cb2537-16" tabindex="-1"></a>  <span class="at">soil_nitrogen =</span> <span class="fu">rnorm</span>(n, <span class="fl">0.2</span>, <span class="fl">0.05</span>), <span class="co"># 土壤氮含量</span></span>
<span id="cb2537-17"><a href="高级回归模型.html#cb2537-17" tabindex="-1"></a></span>
<span id="cb2537-18"><a href="高级回归模型.html#cb2537-18" tabindex="-1"></a>  <span class="co"># 植被特性观测变量</span></span>
<span id="cb2537-19"><a href="高级回归模型.html#cb2537-19" tabindex="-1"></a>  <span class="at">tree_density =</span> <span class="fu">rnorm</span>(n, <span class="dv">500</span>, <span class="dv">100</span>), <span class="co"># 树木密度</span></span>
<span id="cb2537-20"><a href="高级回归模型.html#cb2537-20" tabindex="-1"></a>  <span class="at">canopy_cover =</span> <span class="fu">rnorm</span>(n, <span class="fl">0.7</span>, <span class="fl">0.1</span>), <span class="co"># 冠层覆盖度</span></span>
<span id="cb2537-21"><a href="高级回归模型.html#cb2537-21" tabindex="-1"></a>  <span class="at">understory_richness =</span> <span class="fu">rnorm</span>(n, <span class="dv">15</span>, <span class="dv">3</span>), <span class="co"># 林下植物丰富度</span></span>
<span id="cb2537-22"><a href="高级回归模型.html#cb2537-22" tabindex="-1"></a></span>
<span id="cb2537-23"><a href="高级回归模型.html#cb2537-23" tabindex="-1"></a>  <span class="co"># 动物多样性观测变量</span></span>
<span id="cb2537-24"><a href="高级回归模型.html#cb2537-24" tabindex="-1"></a>  <span class="at">bird_richness =</span> <span class="fu">rnorm</span>(n, <span class="dv">25</span>, <span class="dv">5</span>), <span class="co"># 鸟类丰富度</span></span>
<span id="cb2537-25"><a href="高级回归模型.html#cb2537-25" tabindex="-1"></a>  <span class="at">mammal_richness =</span> <span class="fu">rnorm</span>(n, <span class="dv">8</span>, <span class="dv">2</span>), <span class="co"># 哺乳动物丰富度</span></span>
<span id="cb2537-26"><a href="高级回归模型.html#cb2537-26" tabindex="-1"></a>  <span class="at">insect_richness =</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>) <span class="co"># 昆虫丰富度</span></span>
<span id="cb2537-27"><a href="高级回归模型.html#cb2537-27" tabindex="-1"></a>)</span>
<span id="cb2537-28"><a href="高级回归模型.html#cb2537-28" tabindex="-1"></a></span>
<span id="cb2537-29"><a href="高级回归模型.html#cb2537-29" tabindex="-1"></a><span class="co"># 模拟潜变量之间的真实关系</span></span>
<span id="cb2537-30"><a href="高级回归模型.html#cb2537-30" tabindex="-1"></a><span class="co"># 气候潜变量影响土壤潜变量</span></span>
<span id="cb2537-31"><a href="高级回归模型.html#cb2537-31" tabindex="-1"></a>forest_data<span class="sc">$</span>soil_ph <span class="ot">&lt;-</span> forest_data<span class="sc">$</span>soil_ph <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> forest_data<span class="sc">$</span>temperature</span>
<span id="cb2537-32"><a href="高级回归模型.html#cb2537-32" tabindex="-1"></a>forest_data<span class="sc">$</span>soil_organic <span class="ot">&lt;-</span> forest_data<span class="sc">$</span>soil_organic <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> forest_data<span class="sc">$</span>precipitation</span>
<span id="cb2537-33"><a href="高级回归模型.html#cb2537-33" tabindex="-1"></a></span>
<span id="cb2537-34"><a href="高级回归模型.html#cb2537-34" tabindex="-1"></a><span class="co"># 土壤潜变量影响植被潜变量</span></span>
<span id="cb2537-35"><a href="高级回归模型.html#cb2537-35" tabindex="-1"></a>forest_data<span class="sc">$</span>tree_density <span class="ot">&lt;-</span> forest_data<span class="sc">$</span>tree_density <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> forest_data<span class="sc">$</span>soil_ph</span>
<span id="cb2537-36"><a href="高级回归模型.html#cb2537-36" tabindex="-1"></a>forest_data<span class="sc">$</span>canopy_cover <span class="ot">&lt;-</span> forest_data<span class="sc">$</span>canopy_cover <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> forest_data<span class="sc">$</span>soil_organic</span>
<span id="cb2537-37"><a href="高级回归模型.html#cb2537-37" tabindex="-1"></a></span>
<span id="cb2537-38"><a href="高级回归模型.html#cb2537-38" tabindex="-1"></a><span class="co"># 植被潜变量影响动物多样性潜变量</span></span>
<span id="cb2537-39"><a href="高级回归模型.html#cb2537-39" tabindex="-1"></a>forest_data<span class="sc">$</span>bird_richness <span class="ot">&lt;-</span> forest_data<span class="sc">$</span>bird_richness <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> forest_data<span class="sc">$</span>tree_density</span>
<span id="cb2537-40"><a href="高级回归模型.html#cb2537-40" tabindex="-1"></a>forest_data<span class="sc">$</span>mammal_richness <span class="ot">&lt;-</span> forest_data<span class="sc">$</span>mammal_richness <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> forest_data<span class="sc">$</span>canopy_cover</span>
<span id="cb2537-41"><a href="高级回归模型.html#cb2537-41" tabindex="-1"></a></span>
<span id="cb2537-42"><a href="高级回归模型.html#cb2537-42" tabindex="-1"></a><span class="co"># 定义结构方程模型</span></span>
<span id="cb2537-43"><a href="高级回归模型.html#cb2537-43" tabindex="-1"></a><span class="co"># 使用lavaan包的模型语法</span></span>
<span id="cb2537-44"><a href="高级回归模型.html#cb2537-44" tabindex="-1"></a>sem_model <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb2537-45"><a href="高级回归模型.html#cb2537-45" tabindex="-1"></a><span class="st">  # 测量模型部分</span></span>
<span id="cb2537-46"><a href="高级回归模型.html#cb2537-46" tabindex="-1"></a><span class="st">  # 定义潜变量及其观测指标</span></span>
<span id="cb2537-47"><a href="高级回归模型.html#cb2537-47" tabindex="-1"></a><span class="st">  climate =~ temperature + precipitation</span></span>
<span id="cb2537-48"><a href="高级回归模型.html#cb2537-48" tabindex="-1"></a><span class="st">  soil =~ soil_ph + soil_organic + soil_nitrogen</span></span>
<span id="cb2537-49"><a href="高级回归模型.html#cb2537-49" tabindex="-1"></a><span class="st">  vegetation =~ tree_density + canopy_cover + understory_richness</span></span>
<span id="cb2537-50"><a href="高级回归模型.html#cb2537-50" tabindex="-1"></a><span class="st">  animal_diversity =~ bird_richness + mammal_richness + insect_richness</span></span>
<span id="cb2537-51"><a href="高级回归模型.html#cb2537-51" tabindex="-1"></a></span>
<span id="cb2537-52"><a href="高级回归模型.html#cb2537-52" tabindex="-1"></a><span class="st">  # 结构模型部分</span></span>
<span id="cb2537-53"><a href="高级回归模型.html#cb2537-53" tabindex="-1"></a><span class="st">  # 定义潜变量间的因果关系</span></span>
<span id="cb2537-54"><a href="高级回归模型.html#cb2537-54" tabindex="-1"></a><span class="st">  soil ~ climate</span></span>
<span id="cb2537-55"><a href="高级回归模型.html#cb2537-55" tabindex="-1"></a><span class="st">  vegetation ~ soil</span></span>
<span id="cb2537-56"><a href="高级回归模型.html#cb2537-56" tabindex="-1"></a><span class="st">  animal_diversity ~ vegetation + soil</span></span>
<span id="cb2537-57"><a href="高级回归模型.html#cb2537-57" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<p>在这个模型设定中，我们定义了四个潜变量：气候、土壤、植被和动物多样性，每个潜变量都有多个观测指标。结构模型部分定义了这些潜变量之间的因果关系路径。</p>
</div>
<div id="第二部分模型拟合和结果解释" class="section level4 hasAnchor" number="10.7.2.2">
<h4><span class="header-section-number">10.7.2.2</span> 第二部分：模型拟合和结果解释<a href="高级回归模型.html#第二部分模型拟合和结果解释" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>现在让我们拟合模型并解释结果：</p>
<div class="sourceCode" id="cb2538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2538-1"><a href="高级回归模型.html#cb2538-1" tabindex="-1"></a><span class="co"># 拟合结构方程模型</span></span>
<span id="cb2538-2"><a href="高级回归模型.html#cb2538-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(sem_model, <span class="at">data =</span> forest_data)</span></code></pre></div>
<pre><code>## Warning: lavaan-&gt;lav_data_full():  
##    some observed variances are (at least) a factor 1000 times larger than 
##    others; use varTable(fit) to investigate</code></pre>
<pre><code>## Warning: lavaan-&gt;lav_lavaan_step11_estoptim():  
##    Model estimation FAILED! Returning starting values.</code></pre>
<div class="sourceCode" id="cb2541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2541-1"><a href="高级回归模型.html#cb2541-1" tabindex="-1"></a><span class="co"># 模型摘要</span></span>
<span id="cb2541-2"><a href="高级回归模型.html#cb2541-2" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning: lavaan-&gt;lav_object_summary():  
##    fit measures not available if model did not converge</code></pre>
<pre><code>## lavaan 0.6-20 did NOT end normally after 1378 iterations
## ** WARNING ** Estimates below are most likely unreliable
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        26
## 
##   Number of observations                           200
## 
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                       Estimate   Std.Err  z-value  P(&gt;|z|)   Std.lv   Std.all
##   climate =~                                                                 
##     temperature           1.000                                0.027    0.010
##     precipitation      7709.974       NA                     208.948    1.052
##   soil =~                                                                    
##     soil_ph               1.000                                0.009    0.017
##     soil_organic       1081.213       NA                      10.068    1.000
##     soil_nitrogen         0.534       NA                       0.005    0.096
##   vegetation =~                                                              
##     tree_density          1.000                                0.008    0.000
##     canopy_cover       -132.754       NA                      -1.075   -1.051
##     undrstry_rchns       15.968       NA                       0.129    0.046
##   animal_diversity =~                                                        
##     bird_richness         1.000                                0.339    0.007
##     mammal_richnss        0.026       NA                       0.009    0.004
##     insect_richnss      124.269       NA                      42.071    4.821
## 
## Regressions:
##                      Estimate   Std.Err  z-value  P(&gt;|z|)   Std.lv   Std.all
##   soil ~                                                                    
##     climate              0.325       NA                       0.946    0.946
##   vegetation ~                                                              
##     soil                -0.823       NA                      -0.947   -0.947
##   animal_diversity ~                                                        
##     vegetation           0.077       NA                       0.002    0.002
##     soil                 0.290       NA                       0.008    0.008
## 
## Variances:
##                    Estimate   Std.Err  z-value  P(&gt;|z|)   Std.lv   Std.all
##    .temperature        7.966       NA                       7.966    1.000
##    .precipitation  -4180.094       NA                   -4180.094   -0.106
##    .soil_ph            0.304       NA                       0.304    1.000
##    .soil_organic      -0.008       NA                      -0.008   -0.000
##    .soil_nitrogen      0.003       NA                       0.003    0.991
##    .tree_density   10414.103       NA                   10414.103    1.000
##    .canopy_cover      -0.110       NA                      -0.110   -0.105
##    .undrstry_rchns     7.847       NA                       7.847    0.998
##    .bird_richness   2679.072       NA                    2679.072    1.000
##    .mammal_richnss     4.690       NA                       4.690    1.000
##    .insect_richnss -1693.805       NA                   -1693.805  -22.244
##     climate            0.001       NA                       1.000    1.000
##    .soil               0.000       NA                       0.105    0.105
##    .vegetation         0.000       NA                       0.103    0.103
##    .animal_divrsty     0.115       NA                       1.000    1.000</code></pre>
<div class="sourceCode" id="cb2544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2544-1"><a href="高级回归模型.html#cb2544-1" tabindex="-1"></a><span class="co"># 提取关键结果</span></span>
<span id="cb2544-2"><a href="高级回归模型.html#cb2544-2" tabindex="-1"></a><span class="co"># 测量模型结果：因子载荷</span></span>
<span id="cb2544-3"><a href="高级回归模型.html#cb2544-3" tabindex="-1"></a>factor_loadings <span class="ot">&lt;-</span> <span class="fu">parameterEstimates</span>(fit)</span>
<span id="cb2544-4"><a href="高级回归模型.html#cb2544-4" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(factor_loadings) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">all</span>(<span class="fu">c</span>(<span class="st">&quot;lhs&quot;</span>, <span class="st">&quot;rhs&quot;</span>, <span class="st">&quot;est&quot;</span>, <span class="st">&quot;std.all&quot;</span>) <span class="sc">%in%</span> <span class="fu">names</span>(factor_loadings))) {</span>
<span id="cb2544-5"><a href="高级回归模型.html#cb2544-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;测量模型因子载荷：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2544-6"><a href="高级回归模型.html#cb2544-6" tabindex="-1"></a>  <span class="fu">print</span>(factor_loadings[factor_loadings<span class="sc">$</span>op <span class="sc">==</span> <span class="st">&quot;=~&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;lhs&quot;</span>, <span class="st">&quot;rhs&quot;</span>, <span class="st">&quot;est&quot;</span>, <span class="st">&quot;std.all&quot;</span>)])</span>
<span id="cb2544-7"><a href="高级回归模型.html#cb2544-7" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb2544-8"><a href="高级回归模型.html#cb2544-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;无法提取因子载荷 - 模型可能未收敛</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2544-9"><a href="高级回归模型.html#cb2544-9" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 无法提取因子载荷 - 模型可能未收敛</code></pre>
<div class="sourceCode" id="cb2546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2546-1"><a href="高级回归模型.html#cb2546-1" tabindex="-1"></a><span class="co"># 结构模型结果：路径系数</span></span>
<span id="cb2546-2"><a href="高级回归模型.html#cb2546-2" tabindex="-1"></a>path_coefficients <span class="ot">&lt;-</span> <span class="fu">parameterEstimates</span>(fit)</span>
<span id="cb2546-3"><a href="高级回归模型.html#cb2546-3" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(path_coefficients) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">all</span>(<span class="fu">c</span>(<span class="st">&quot;lhs&quot;</span>, <span class="st">&quot;rhs&quot;</span>, <span class="st">&quot;est&quot;</span>, <span class="st">&quot;std.all&quot;</span>) <span class="sc">%in%</span> <span class="fu">names</span>(path_coefficients))) {</span>
<span id="cb2546-4"><a href="高级回归模型.html#cb2546-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;结构模型路径系数：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2546-5"><a href="高级回归模型.html#cb2546-5" tabindex="-1"></a>  <span class="fu">print</span>(path_coefficients[path_coefficients<span class="sc">$</span>op <span class="sc">==</span> <span class="st">&quot;~&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;lhs&quot;</span>, <span class="st">&quot;rhs&quot;</span>, <span class="st">&quot;est&quot;</span>, <span class="st">&quot;std.all&quot;</span>)])</span>
<span id="cb2546-6"><a href="高级回归模型.html#cb2546-6" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb2546-7"><a href="高级回归模型.html#cb2546-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;无法提取路径系数 - 模型可能未收敛</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2546-8"><a href="高级回归模型.html#cb2546-8" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 无法提取路径系数 - 模型可能未收敛</code></pre>
<div class="sourceCode" id="cb2548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2548-1"><a href="高级回归模型.html#cb2548-1" tabindex="-1"></a><span class="co"># 模型拟合优度指标</span></span>
<span id="cb2548-2"><a href="高级回归模型.html#cb2548-2" tabindex="-1"></a><span class="fu">tryCatch</span>({</span>
<span id="cb2548-3"><a href="高级回归模型.html#cb2548-3" tabindex="-1"></a>  fit_measures <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(fit)</span>
<span id="cb2548-4"><a href="高级回归模型.html#cb2548-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;模型拟合优度：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2548-5"><a href="高级回归模型.html#cb2548-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;CFI:&quot;</span>, fit_measures[<span class="st">&quot;cfi&quot;</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2548-6"><a href="高级回归模型.html#cb2548-6" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;TLI:&quot;</span>, fit_measures[<span class="st">&quot;tli&quot;</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2548-7"><a href="高级回归模型.html#cb2548-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;RMSEA:&quot;</span>, fit_measures[<span class="st">&quot;rmsea&quot;</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2548-8"><a href="高级回归模型.html#cb2548-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;SRMR:&quot;</span>, fit_measures[<span class="st">&quot;srmr&quot;</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2548-9"><a href="高级回归模型.html#cb2548-9" tabindex="-1"></a></span>
<span id="cb2548-10"><a href="高级回归模型.html#cb2548-10" tabindex="-1"></a>  <span class="co"># 模型拟合判断标准</span></span>
<span id="cb2548-11"><a href="高级回归模型.html#cb2548-11" tabindex="-1"></a>  <span class="cf">if</span> (fit_measures[<span class="st">&quot;cfi&quot;</span>] <span class="sc">&gt;</span> <span class="fl">0.90</span> <span class="sc">&amp;&amp;</span> fit_measures[<span class="st">&quot;rmsea&quot;</span>] <span class="sc">&lt;</span> <span class="fl">0.08</span>) {</span>
<span id="cb2548-12"><a href="高级回归模型.html#cb2548-12" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;模型拟合良好</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2548-13"><a href="高级回归模型.html#cb2548-13" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2548-14"><a href="高级回归模型.html#cb2548-14" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;模型拟合需要改进</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2548-15"><a href="高级回归模型.html#cb2548-15" tabindex="-1"></a>  }</span>
<span id="cb2548-16"><a href="高级回归模型.html#cb2548-16" tabindex="-1"></a>}, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb2548-17"><a href="高级回归模型.html#cb2548-17" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;模型未收敛，无法计算拟合优度指标</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2548-18"><a href="高级回归模型.html#cb2548-18" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;错误信息:&quot;</span>, e<span class="sc">$</span>message, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2548-19"><a href="高级回归模型.html#cb2548-19" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## 模型未收敛，无法计算拟合优度指标
## 错误信息: lavaan-&gt;lav_fit_measures():  
##    fit measures not available if model did not converge</code></pre>
</div>
<div id="第三部分模型可视化和效应分解" class="section level4 hasAnchor" number="10.7.2.3">
<h4><span class="header-section-number">10.7.2.3</span> 第三部分：模型可视化和效应分解<a href="高级回归模型.html#第三部分模型可视化和效应分解" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>让我们可视化模型结果并分析直接效应和间接效应：</p>
<div class="sourceCode" id="cb2550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2550-1"><a href="高级回归模型.html#cb2550-1" tabindex="-1"></a><span class="co"># 可视化结构方程模型</span></span>
<span id="cb2550-2"><a href="高级回归模型.html#cb2550-2" tabindex="-1"></a><span class="fu">semPaths</span>(fit,</span>
<span id="cb2550-3"><a href="高级回归模型.html#cb2550-3" tabindex="-1"></a>  <span class="at">what =</span> <span class="st">&quot;est&quot;</span>, <span class="at">whatLabels =</span> <span class="st">&quot;std&quot;</span>,</span>
<span id="cb2550-4"><a href="高级回归模型.html#cb2550-4" tabindex="-1"></a>  <span class="at">layout =</span> <span class="st">&quot;tree&quot;</span>, <span class="at">edge.label.cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb2550-5"><a href="高级回归模型.html#cb2550-5" tabindex="-1"></a>  <span class="at">style =</span> <span class="st">&quot;lisrel&quot;</span>, <span class="at">sizeMan =</span> <span class="dv">8</span>, <span class="at">sizeLat =</span> <span class="dv">10</span></span>
<span id="cb2550-6"><a href="高级回归模型.html#cb2550-6" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-35"></span>
<img src="10-modeling_and_prediction_part3_files/figure-html/unnamed-chunk-35-1.png" alt="森林生态系统结构方程模型路径图" width="672" />
<p class="caption">
图3.7: 森林生态系统结构方程模型路径图
</p>
</div>
<div class="sourceCode" id="cb2551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2551-1"><a href="高级回归模型.html#cb2551-1" tabindex="-1"></a><span class="co"># 计算直接效应、间接效应和总效应</span></span>
<span id="cb2551-2"><a href="高级回归模型.html#cb2551-2" tabindex="-1"></a>effects <span class="ot">&lt;-</span> <span class="fu">parameterEstimates</span>(fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2551-3"><a href="高级回归模型.html#cb2551-3" tabindex="-1"></a></span>
<span id="cb2551-4"><a href="高级回归模型.html#cb2551-4" tabindex="-1"></a><span class="co"># 提取气候对动物多样性的效应分解</span></span>
<span id="cb2551-5"><a href="高级回归模型.html#cb2551-5" tabindex="-1"></a>climate_animal_effects <span class="ot">&lt;-</span> effects[</span>
<span id="cb2551-6"><a href="高级回归模型.html#cb2551-6" tabindex="-1"></a>  effects<span class="sc">$</span>lhs <span class="sc">==</span> <span class="st">&quot;animal_diversity&quot;</span> <span class="sc">&amp;</span> effects<span class="sc">$</span>rhs <span class="sc">==</span> <span class="st">&quot;climate&quot;</span>,</span>
<span id="cb2551-7"><a href="高级回归模型.html#cb2551-7" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;lhs&quot;</span>, <span class="st">&quot;rhs&quot;</span>, <span class="st">&quot;est&quot;</span>, <span class="st">&quot;std.all&quot;</span>)</span>
<span id="cb2551-8"><a href="高级回归模型.html#cb2551-8" tabindex="-1"></a>]</span>
<span id="cb2551-9"><a href="高级回归模型.html#cb2551-9" tabindex="-1"></a></span>
<span id="cb2551-10"><a href="高级回归模型.html#cb2551-10" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(climate_animal_effects) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb2551-11"><a href="高级回归模型.html#cb2551-11" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;气候对动物多样性的直接效应：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2551-12"><a href="高级回归模型.html#cb2551-12" tabindex="-1"></a>  <span class="fu">print</span>(climate_animal_effects)</span>
<span id="cb2551-13"><a href="高级回归模型.html#cb2551-13" tabindex="-1"></a>}</span>
<span id="cb2551-14"><a href="高级回归模型.html#cb2551-14" tabindex="-1"></a></span>
<span id="cb2551-15"><a href="高级回归模型.html#cb2551-15" tabindex="-1"></a><span class="co"># 手动计算间接效应</span></span>
<span id="cb2551-16"><a href="高级回归模型.html#cb2551-16" tabindex="-1"></a><span class="co"># 气候 → 土壤 → 动物多样性</span></span>
<span id="cb2551-17"><a href="高级回归模型.html#cb2551-17" tabindex="-1"></a>indirect1 <span class="ot">&lt;-</span> effects[effects<span class="sc">$</span>lhs <span class="sc">==</span> <span class="st">&quot;soil&quot;</span> <span class="sc">&amp;</span> effects<span class="sc">$</span>rhs <span class="sc">==</span> <span class="st">&quot;climate&quot;</span>, <span class="st">&quot;std.all&quot;</span>] <span class="sc">*</span></span>
<span id="cb2551-18"><a href="高级回归模型.html#cb2551-18" tabindex="-1"></a>  effects[effects<span class="sc">$</span>lhs <span class="sc">==</span> <span class="st">&quot;animal_diversity&quot;</span> <span class="sc">&amp;</span> effects<span class="sc">$</span>rhs <span class="sc">==</span> <span class="st">&quot;soil&quot;</span>, <span class="st">&quot;std.all&quot;</span>]</span>
<span id="cb2551-19"><a href="高级回归模型.html#cb2551-19" tabindex="-1"></a></span>
<span id="cb2551-20"><a href="高级回归模型.html#cb2551-20" tabindex="-1"></a><span class="co"># 气候 → 土壤 → 植被 → 动物多样性</span></span>
<span id="cb2551-21"><a href="高级回归模型.html#cb2551-21" tabindex="-1"></a>indirect2 <span class="ot">&lt;-</span> effects[effects<span class="sc">$</span>lhs <span class="sc">==</span> <span class="st">&quot;soil&quot;</span> <span class="sc">&amp;</span> effects<span class="sc">$</span>rhs <span class="sc">==</span> <span class="st">&quot;climate&quot;</span>, <span class="st">&quot;std.all&quot;</span>] <span class="sc">*</span></span>
<span id="cb2551-22"><a href="高级回归模型.html#cb2551-22" tabindex="-1"></a>  effects[effects<span class="sc">$</span>lhs <span class="sc">==</span> <span class="st">&quot;vegetation&quot;</span> <span class="sc">&amp;</span> effects<span class="sc">$</span>rhs <span class="sc">==</span> <span class="st">&quot;soil&quot;</span>, <span class="st">&quot;std.all&quot;</span>] <span class="sc">*</span></span>
<span id="cb2551-23"><a href="高级回归模型.html#cb2551-23" tabindex="-1"></a>  effects[effects<span class="sc">$</span>lhs <span class="sc">==</span> <span class="st">&quot;animal_diversity&quot;</span> <span class="sc">&amp;</span> effects<span class="sc">$</span>rhs <span class="sc">==</span> <span class="st">&quot;vegetation&quot;</span>, <span class="st">&quot;std.all&quot;</span>]</span>
<span id="cb2551-24"><a href="高级回归模型.html#cb2551-24" tabindex="-1"></a></span>
<span id="cb2551-25"><a href="高级回归模型.html#cb2551-25" tabindex="-1"></a><span class="co"># 气候 → 植被 → 动物多样性</span></span>
<span id="cb2551-26"><a href="高级回归模型.html#cb2551-26" tabindex="-1"></a>indirect3 <span class="ot">&lt;-</span> effects[effects<span class="sc">$</span>lhs <span class="sc">==</span> <span class="st">&quot;vegetation&quot;</span> <span class="sc">&amp;</span> effects<span class="sc">$</span>rhs <span class="sc">==</span> <span class="st">&quot;climate&quot;</span>, <span class="st">&quot;std.all&quot;</span>] <span class="sc">*</span></span>
<span id="cb2551-27"><a href="高级回归模型.html#cb2551-27" tabindex="-1"></a>  effects[effects<span class="sc">$</span>lhs <span class="sc">==</span> <span class="st">&quot;animal_diversity&quot;</span> <span class="sc">&amp;</span> effects<span class="sc">$</span>rhs <span class="sc">==</span> <span class="st">&quot;vegetation&quot;</span>, <span class="st">&quot;std.all&quot;</span>]</span>
<span id="cb2551-28"><a href="高级回归模型.html#cb2551-28" tabindex="-1"></a></span>
<span id="cb2551-29"><a href="高级回归模型.html#cb2551-29" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;气候对动物多样性的间接效应：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 气候对动物多样性的间接效应：</code></pre>
<div class="sourceCode" id="cb2553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2553-1"><a href="高级回归模型.html#cb2553-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;通过土壤:&quot;</span>, indirect1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 通过土壤: 0.007536634</code></pre>
<div class="sourceCode" id="cb2555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2555-1"><a href="高级回归模型.html#cb2555-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;通过土壤和植被:&quot;</span>, indirect2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 通过土壤和植被: -0.001647872</code></pre>
<div class="sourceCode" id="cb2557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2557-1"><a href="高级回归模型.html#cb2557-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;通过植被:&quot;</span>, indirect3, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 通过植被:</code></pre>
<div class="sourceCode" id="cb2559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2559-1"><a href="高级回归模型.html#cb2559-1" tabindex="-1"></a><span class="co"># 总间接效应</span></span>
<span id="cb2559-2"><a href="高级回归模型.html#cb2559-2" tabindex="-1"></a>total_indirect <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">c</span>(indirect1, indirect2, indirect3), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2559-3"><a href="高级回归模型.html#cb2559-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;总间接效应:&quot;</span>, total_indirect, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 总间接效应: 0.005888762</code></pre>
</div>
<div id="第四部分模型诊断和修正" class="section level4 hasAnchor" number="10.7.2.4">
<h4><span class="header-section-number">10.7.2.4</span> 第四部分：模型诊断和修正<a href="高级回归模型.html#第四部分模型诊断和修正" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>如果模型拟合不理想，我们需要进行模型诊断和修正：</p>
<div class="sourceCode" id="cb2561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2561-1"><a href="高级回归模型.html#cb2561-1" tabindex="-1"></a><span class="co"># 模型诊断</span></span>
<span id="cb2561-2"><a href="高级回归模型.html#cb2561-2" tabindex="-1"></a><span class="co"># 检查修正指数（Modification Indices）</span></span>
<span id="cb2561-3"><a href="高级回归模型.html#cb2561-3" tabindex="-1"></a><span class="fu">tryCatch</span>({</span>
<span id="cb2561-4"><a href="高级回归模型.html#cb2561-4" tabindex="-1"></a>  mi <span class="ot">&lt;-</span> <span class="fu">modificationIndices</span>(fit)</span>
<span id="cb2561-5"><a href="高级回归模型.html#cb2561-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;前10个最大的修正指数：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2561-6"><a href="高级回归模型.html#cb2561-6" tabindex="-1"></a>  <span class="fu">print</span>(mi[<span class="fu">order</span>(<span class="sc">-</span>mi<span class="sc">$</span>mi), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ])</span>
<span id="cb2561-7"><a href="高级回归模型.html#cb2561-7" tabindex="-1"></a>}, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb2561-8"><a href="高级回归模型.html#cb2561-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;无法计算修正指数 - 信息矩阵奇异</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2561-9"><a href="高级回归模型.html#cb2561-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;错误信息:&quot;</span>, e<span class="sc">$</span>message, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2561-10"><a href="高级回归模型.html#cb2561-10" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## Warning: lavaan-&gt;modificationIndices():  
##    model did not converge</code></pre>
<pre><code>## 无法计算修正指数 - 信息矩阵奇异
## 错误信息: lavaan-&gt;modificationIndices():  
##    could not compute modification indices; information matrix is singular</code></pre>
<div class="sourceCode" id="cb2564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2564-1"><a href="高级回归模型.html#cb2564-1" tabindex="-1"></a><span class="co"># 检查残差相关矩阵</span></span>
<span id="cb2564-2"><a href="高级回归模型.html#cb2564-2" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">resid</span>(fit)<span class="sc">$</span>cov</span>
<span id="cb2564-3"><a href="高级回归模型.html#cb2564-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;标准化残差相关矩阵：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 标准化残差相关矩阵：</code></pre>
<div class="sourceCode" id="cb2566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2566-1"><a href="高级回归模型.html#cb2566-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(residuals, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##                        tmprtr    prcptt    sol_ph    sl_rgn    sl_ntr    tr_dns
## temperature            -0.001                                                  
## precipitation         -21.199    -3.179                                        
## soil_ph                 0.755    -8.310    -0.001                              
## soil_organic           -1.169    -0.094    -0.415    -0.001                    
## soil_nitrogen          -0.008     0.084    -0.001     0.000     0.000          
## tree_density           16.107 -1343.470     3.992   -65.710    -0.480   -39.157
## canopy_cover           -0.137    -0.012    -0.042     0.000     0.001    -5.029
## understory_richness     0.167    -2.271     0.120    -0.077     0.000    42.220
## bird_richness           8.795  -691.274     1.932   -33.382    -0.260  5251.210
## mammal_richness        -0.060    93.159     0.088     4.698     0.014    -7.174
## insect_richness         0.015     9.118     0.035     0.186     0.045    26.504
##                        cnpy_c    undrs_    brd_rc    mmml_r    insct_
## temperature                                                          
## precipitation                                                        
## soil_ph                                                              
## soil_organic                                                         
## soil_nitrogen                                                        
## tree_density                                                         
## canopy_cover            0.000                                        
## understory_richness    -0.007     0.000                              
## bird_richness          -2.593    21.031     6.174                    
## mammal_richness         0.480     0.182    -3.167     0.000          
## insect_richness         0.022     0.730    -1.601     0.096     0.001</code></pre>
<div class="sourceCode" id="cb2568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2568-1"><a href="高级回归模型.html#cb2568-1" tabindex="-1"></a><span class="co"># 识别大的残差相关（绝对值 &gt; 0.1）</span></span>
<span id="cb2568-2"><a href="高级回归模型.html#cb2568-2" tabindex="-1"></a>large_residuals <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(residuals) <span class="sc">&gt;</span> <span class="fl">0.1</span> <span class="sc">&amp;</span> <span class="fu">abs</span>(residuals) <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2568-3"><a href="高级回归模型.html#cb2568-3" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(large_residuals) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb2568-4"><a href="高级回归模型.html#cb2568-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;较大的残差相关：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2568-5"><a href="高级回归模型.html#cb2568-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(large_residuals)) {</span>
<span id="cb2568-6"><a href="高级回归模型.html#cb2568-6" tabindex="-1"></a>    row_idx <span class="ot">&lt;-</span> large_residuals[i, <span class="dv">1</span>]</span>
<span id="cb2568-7"><a href="高级回归模型.html#cb2568-7" tabindex="-1"></a>    col_idx <span class="ot">&lt;-</span> large_residuals[i, <span class="dv">2</span>]</span>
<span id="cb2568-8"><a href="高级回归模型.html#cb2568-8" tabindex="-1"></a>    <span class="cf">if</span> (row_idx <span class="sc">&lt;</span> col_idx) { <span class="co"># 避免重复</span></span>
<span id="cb2568-9"><a href="高级回归模型.html#cb2568-9" tabindex="-1"></a>      <span class="fu">cat</span>(</span>
<span id="cb2568-10"><a href="高级回归模型.html#cb2568-10" tabindex="-1"></a>        <span class="fu">rownames</span>(residuals)[row_idx], <span class="st">&quot;-&quot;</span>, <span class="fu">colnames</span>(residuals)[col_idx],</span>
<span id="cb2568-11"><a href="高级回归模型.html#cb2568-11" tabindex="-1"></a>        <span class="st">&quot;:&quot;</span>, residuals[row_idx, col_idx], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb2568-12"><a href="高级回归模型.html#cb2568-12" tabindex="-1"></a>      )</span>
<span id="cb2568-13"><a href="高级回归模型.html#cb2568-13" tabindex="-1"></a>    }</span>
<span id="cb2568-14"><a href="高级回归模型.html#cb2568-14" tabindex="-1"></a>  }</span>
<span id="cb2568-15"><a href="高级回归模型.html#cb2568-15" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 较大的残差相关：
## temperature - soil_ph : 0.7552942 
## soil_ph - soil_organic : -0.4148785 
## soil_nitrogen - tree_density : -0.4804069 
## temperature - canopy_cover : -0.1367134 
## temperature - understory_richness : 0.167476 
## soil_ph - understory_richness : 0.1200592 
## soil_nitrogen - bird_richness : -0.2598357 
## canopy_cover - mammal_richness : 0.4801637 
## understory_richness - mammal_richness : 0.181935 
## soil_organic - insect_richness : 0.1861398 
## understory_richness - insect_richness : 0.730047</code></pre>
<div class="sourceCode" id="cb2570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2570-1"><a href="高级回归模型.html#cb2570-1" tabindex="-1"></a><span class="co"># 模型修正（基于理论和统计证据）</span></span>
<span id="cb2570-2"><a href="高级回归模型.html#cb2570-2" tabindex="-1"></a><span class="co"># 如果发现某些观测变量间存在理论上的相关，可以添加残差相关</span></span>
<span id="cb2570-3"><a href="高级回归模型.html#cb2570-3" tabindex="-1"></a>sem_model_modified <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb2570-4"><a href="高级回归模型.html#cb2570-4" tabindex="-1"></a><span class="st">  # 测量模型</span></span>
<span id="cb2570-5"><a href="高级回归模型.html#cb2570-5" tabindex="-1"></a><span class="st">  climate =~ temperature + precipitation</span></span>
<span id="cb2570-6"><a href="高级回归模型.html#cb2570-6" tabindex="-1"></a><span class="st">  soil =~ soil_ph + soil_organic + soil_nitrogen</span></span>
<span id="cb2570-7"><a href="高级回归模型.html#cb2570-7" tabindex="-1"></a><span class="st">  vegetation =~ tree_density + canopy_cover + understory_richness</span></span>
<span id="cb2570-8"><a href="高级回归模型.html#cb2570-8" tabindex="-1"></a><span class="st">  animal_diversity =~ bird_richness + mammal_richness + insect_richness</span></span>
<span id="cb2570-9"><a href="高级回归模型.html#cb2570-9" tabindex="-1"></a></span>
<span id="cb2570-10"><a href="高级回归模型.html#cb2570-10" tabindex="-1"></a><span class="st">  # 结构模型</span></span>
<span id="cb2570-11"><a href="高级回归模型.html#cb2570-11" tabindex="-1"></a><span class="st">  soil ~ climate</span></span>
<span id="cb2570-12"><a href="高级回归模型.html#cb2570-12" tabindex="-1"></a><span class="st">  vegetation ~ soil</span></span>
<span id="cb2570-13"><a href="高级回归模型.html#cb2570-13" tabindex="-1"></a><span class="st">  animal_diversity ~ vegetation + soil</span></span>
<span id="cb2570-14"><a href="高级回归模型.html#cb2570-14" tabindex="-1"></a></span>
<span id="cb2570-15"><a href="高级回归模型.html#cb2570-15" tabindex="-1"></a><span class="st">  # 添加理论上有意义的残差相关</span></span>
<span id="cb2570-16"><a href="高级回归模型.html#cb2570-16" tabindex="-1"></a><span class="st">  temperature ~~ precipitation  # 气候变量间的相关</span></span>
<span id="cb2570-17"><a href="高级回归模型.html#cb2570-17" tabindex="-1"></a><span class="st">  soil_ph ~~ soil_organic       # 土壤特性间的相关</span></span>
<span id="cb2570-18"><a href="高级回归模型.html#cb2570-18" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb2570-19"><a href="高级回归模型.html#cb2570-19" tabindex="-1"></a></span>
<span id="cb2570-20"><a href="高级回归模型.html#cb2570-20" tabindex="-1"></a><span class="co"># 拟合修正模型</span></span>
<span id="cb2570-21"><a href="高级回归模型.html#cb2570-21" tabindex="-1"></a>fit_modified <span class="ot">&lt;-</span> <span class="fu">sem</span>(sem_model_modified, <span class="at">data =</span> forest_data)</span></code></pre></div>
<pre><code>## Warning: lavaan-&gt;lav_data_full():  
##    some observed variances are (at least) a factor 1000 times larger than 
##    others; use varTable(fit) to investigate</code></pre>
<pre><code>## Warning: lavaan-&gt;lav_lavaan_step11_estoptim():  
##    Model estimation FAILED! Returning starting values.</code></pre>
<div class="sourceCode" id="cb2573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2573-1"><a href="高级回归模型.html#cb2573-1" tabindex="-1"></a><span class="co"># 比较模型拟合</span></span>
<span id="cb2573-2"><a href="高级回归模型.html#cb2573-2" tabindex="-1"></a><span class="fu">tryCatch</span>({</span>
<span id="cb2573-3"><a href="高级回归模型.html#cb2573-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;原始模型 vs 修正模型比较：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2573-4"><a href="高级回归模型.html#cb2573-4" tabindex="-1"></a>  <span class="fu">anova</span>(fit, fit_modified)</span>
<span id="cb2573-5"><a href="高级回归模型.html#cb2573-5" tabindex="-1"></a>}, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb2573-6"><a href="高级回归模型.html#cb2573-6" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;无法比较模型 - 模型可能未收敛</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2573-7"><a href="高级回归模型.html#cb2573-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;错误信息:&quot;</span>, e<span class="sc">$</span>message, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2573-8"><a href="高级回归模型.html#cb2573-8" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## 原始模型 vs 修正模型比较：</code></pre>
<pre><code>## Warning: lavaan-&gt;lavTestLRT():  
##    not all models converged</code></pre>
<pre><code>## 无法比较模型 - 模型可能未收敛
## 错误信息: missing value where TRUE/FALSE needed</code></pre>
<div class="sourceCode" id="cb2577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2577-1"><a href="高级回归模型.html#cb2577-1" tabindex="-1"></a><span class="co"># 检查修正模型拟合优度</span></span>
<span id="cb2577-2"><a href="高级回归模型.html#cb2577-2" tabindex="-1"></a><span class="fu">tryCatch</span>({</span>
<span id="cb2577-3"><a href="高级回归模型.html#cb2577-3" tabindex="-1"></a>  fit_measures_modified <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(fit_modified)</span>
<span id="cb2577-4"><a href="高级回归模型.html#cb2577-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;修正模型拟合优度：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2577-5"><a href="高级回归模型.html#cb2577-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;CFI:&quot;</span>, fit_measures_modified[<span class="st">&quot;cfi&quot;</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2577-6"><a href="高级回归模型.html#cb2577-6" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;RMSEA:&quot;</span>, fit_measures_modified[<span class="st">&quot;rmsea&quot;</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2577-7"><a href="高级回归模型.html#cb2577-7" tabindex="-1"></a>}, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb2577-8"><a href="高级回归模型.html#cb2577-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;修正模型未收敛，无法计算拟合优度指标</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2577-9"><a href="高级回归模型.html#cb2577-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;错误信息:&quot;</span>, e<span class="sc">$</span>message, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2577-10"><a href="高级回归模型.html#cb2577-10" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## 修正模型未收敛，无法计算拟合优度指标
## 错误信息: lavaan-&gt;lav_fit_measures():  
##    fit measures not available if model did not converge</code></pre>
</div>
</div>
<div id="结构方程模型在生态学中的特殊价值" class="section level3 hasAnchor" number="10.7.3">
<h3><span class="header-section-number">10.7.3</span> 结构方程模型在生态学中的特殊价值<a href="高级回归模型.html#结构方程模型在生态学中的特殊价值" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>结构方程模型在生态学研究中具有独特的价值，主要体现在以下几个方面：</p>
<p><strong>检验复杂因果假设</strong>：SEM能够同时检验多个因果关系，揭示生态系统中复杂的因果网络，而不仅仅是变量间的相关关系。</p>
<p><strong>处理潜变量</strong>：许多重要的生态概念如生态系统健康、生物多样性、生态功能等都是无法直接观测的潜变量，SEM能够通过多个观测指标来测量这些潜变量。</p>
<p><strong>分离直接效应和间接效应</strong>：SEM能够量化变量间的直接效应和通过中介变量的间接效应，帮助我们理解生态过程的机制。</p>
<p><strong>整合观测数据和理论</strong>：SEM要求研究者基于生态学理论构建先验的因果模型，然后将数据与理论模型进行拟合，实现理论与数据的整合。</p>
<p><strong>处理测量误差</strong>：SEM明确考虑了观测变量的测量误差，提供更准确的参数估计。</p>
</div>
<div id="模型诊断与注意事项-2" class="section level3 hasAnchor" number="10.7.4">
<h3><span class="header-section-number">10.7.4</span> 模型诊断与注意事项<a href="高级回归模型.html#模型诊断与注意事项-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>结构方程模型的诊断比传统回归模型更为复杂，需要特别关注模型识别、拟合优度和理论合理性：</p>
<p><strong>模型识别检查</strong>：</p>
<div class="sourceCode" id="cb2579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2579-1"><a href="高级回归模型.html#cb2579-1" tabindex="-1"></a><span class="co"># 检查模型识别</span></span>
<span id="cb2579-2"><a href="高级回归模型.html#cb2579-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模型识别状态：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2579-3"><a href="高级回归模型.html#cb2579-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">lavInspect</span>(fit, <span class="st">&quot;post.check&quot;</span>))</span>
<span id="cb2579-4"><a href="高级回归模型.html#cb2579-4" tabindex="-1"></a></span>
<span id="cb2579-5"><a href="高级回归模型.html#cb2579-5" tabindex="-1"></a><span class="co"># 检查自由度</span></span>
<span id="cb2579-6"><a href="高级回归模型.html#cb2579-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模型自由度：&quot;</span>, <span class="fu">fitMeasures</span>(fit, <span class="st">&quot;df&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p><strong>拟合优度标准</strong>： - CFI &gt; 0.90：比较拟合指数，反映模型与饱和模型的比较 - TLI &gt; 0.90：Tucker-Lewis指数，考虑模型复杂度 - RMSEA &lt; 0.08：近似误差均方根，反映模型近似程度 - SRMR &lt; 0.08：标准化残差均方根，反映残差大小</p>
<p><strong>常见问题与解决方案</strong>： - <strong>模型不收敛</strong>：检查数据质量、模型设定是否合理 - <strong>拟合不佳</strong>：基于理论和修正指数进行模型修正 - <strong>识别问题</strong>：确保每个潜变量有足够多的观测指标 - <strong>样本量不足</strong>：SEM通常需要较大的样本量（n &gt; 200）</p>
<p>结构方程模型为生态学家提供了一个强大的工具，使我们能够检验复杂的生态因果假设，理解生态系统的复杂相互作用，为生态保护和管理决策提供更可靠的科学依据。通过合理使用结构方程模型，我们能够更好地揭示生态系统的内在机制，推动生态学理论的发展。</p>
</div>
</div>
<div id="总结-10" class="section level2 hasAnchor" number="10.8">
<h2><span class="header-section-number">10.8</span> 总结<a href="高级回归模型.html#总结-10" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="综合练习-8" class="section level2 hasAnchor" number="10.9">
<h2><span class="header-section-number">10.9</span> 综合练习<a href="高级回归模型.html#综合练习-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="模型选择与评估.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="机器学习.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": false,
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["ecological-statistics.pdf", "ecological-statistics.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
