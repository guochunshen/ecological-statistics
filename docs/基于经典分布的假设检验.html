<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 基于经典分布的假设检验 | 生态统计学</title>
  <meta name="description" content="6 基于经典分布的假设检验 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="6 基于经典分布的假设检验 | 生态统计学" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="6 基于经典分布的假设检验 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 基于经典分布的假设检验 | 生态统计学" />
  
  <meta name="twitter:description" content="6 基于经典分布的假设检验 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  

<meta name="author" content="沈国春、李勤" />


<meta name="date" content="2025-10-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="相关性与相似性.html"/>
<link rel="next" href="基于模拟的假设检验.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7cbaf067c715044120ee231397e9ace3";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">生态统计学</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#为什么"><i class="fa fa-check"></i><b>0.1</b> 为什么</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#在不确定的世界中寻找规律"><i class="fa fa-check"></i><b>0.1.1</b> 在不确定的世界中寻找规律</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#ai时代的机遇与陷阱"><i class="fa fa-check"></i><b>0.1.2</b> AI时代的机遇与陷阱</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#本书介绍"><i class="fa fa-check"></i><b>0.2</b> 本书介绍</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#本书特色与教学理念"><i class="fa fa-check"></i><b>0.2.1</b> 本书特色与教学理念</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#课程在线资源"><i class="fa fa-check"></i><b>0.3</b> 课程在线资源</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#学习方式"><i class="fa fa-check"></i><b>0.4</b> 学习方式</a>
<ul>
<li class="chapter" data-level="0.4.1" data-path="index.html"><a href="index.html#持续学习r语言的重要性"><i class="fa fa-check"></i><b>0.4.1</b> 持续学习R语言的重要性</a></li>
<li class="chapter" data-level="0.4.2" data-path="index.html"><a href="index.html#在错误中快速成长"><i class="fa fa-check"></i><b>0.4.2</b> 在错误中快速成长</a></li>
<li class="chapter" data-level="0.4.3" data-path="index.html"><a href="index.html#实践导向的学习策略"><i class="fa fa-check"></i><b>0.4.3</b> 实践导向的学习策略</a></li>
<li class="chapter" data-level="0.4.4" data-path="index.html"><a href="index.html#正确的上课姿势"><i class="fa fa-check"></i><b>0.4.4</b> 正确的上课姿势</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#重复本书例子"><i class="fa fa-check"></i><b>0.5</b> 重复本书例子</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="统计编程基础.html"><a href="统计编程基础.html"><i class="fa fa-check"></i><b>1</b> 统计编程基础</a>
<ul>
<li class="chapter" data-level="1.1" data-path="统计编程基础.html"><a href="统计编程基础.html#引言"><i class="fa fa-check"></i><b>1.1</b> 引言</a></li>
<li class="chapter" data-level="1.2" data-path="统计编程基础.html"><a href="统计编程基础.html#核心能力培养框架"><i class="fa fa-check"></i><b>1.2</b> 核心能力培养框架</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="统计编程基础.html"><a href="统计编程基础.html#高阶思维与问题解决能力"><i class="fa fa-check"></i><b>1.2.1</b> 高阶思维与问题解决能力</a></li>
<li class="chapter" data-level="1.2.2" data-path="统计编程基础.html"><a href="统计编程基础.html#与llm协同工作的能力"><i class="fa fa-check"></i><b>1.2.2</b> 与LLM协同工作的能力</a></li>
<li class="chapter" data-level="1.2.3" data-path="统计编程基础.html"><a href="统计编程基础.html#传统但愈发重要的软技能"><i class="fa fa-check"></i><b>1.2.3</b> 传统但愈发重要的软技能</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="统计编程基础.html"><a href="统计编程基础.html#通用编程思维基础"><i class="fa fa-check"></i><b>1.3</b> 通用编程思维基础</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="统计编程基础.html"><a href="统计编程基础.html#编程核心概念"><i class="fa fa-check"></i><b>1.3.1</b> 编程核心概念</a></li>
<li class="chapter" data-level="1.3.2" data-path="统计编程基础.html"><a href="统计编程基础.html#算法复杂度"><i class="fa fa-check"></i><b>1.3.2</b> 算法复杂度</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="统计编程基础.html"><a href="统计编程基础.html#ai协同编程技能"><i class="fa fa-check"></i><b>1.4</b> AI协同编程技能</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="统计编程基础.html"><a href="统计编程基础.html#ai编程模块安装"><i class="fa fa-check"></i><b>1.4.1</b> AI编程模块安装</a></li>
<li class="chapter" data-level="1.4.2" data-path="统计编程基础.html"><a href="统计编程基础.html#精准提问技巧"><i class="fa fa-check"></i><b>1.4.2</b> 精准提问技巧</a></li>
<li class="chapter" data-level="1.4.3" data-path="统计编程基础.html"><a href="统计编程基础.html#代码审查能力"><i class="fa fa-check"></i><b>1.4.3</b> 代码审查能力</a></li>
<li class="chapter" data-level="1.4.4" data-path="统计编程基础.html"><a href="统计编程基础.html#调试与错误处理"><i class="fa fa-check"></i><b>1.4.4</b> 调试与错误处理</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="统计编程基础.html"><a href="统计编程基础.html#总结"><i class="fa fa-check"></i><b>1.5</b> 总结</a></li>
<li class="chapter" data-level="1.6" data-path="统计编程基础.html"><a href="统计编程基础.html#综合练习"><i class="fa fa-check"></i><b>1.6</b> 综合练习</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="统计编程基础.html"><a href="统计编程基础.html#练习1"><i class="fa fa-check"></i><b>1.6.1</b> 练习1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="概率与分布.html"><a href="概率与分布.html"><i class="fa fa-check"></i><b>2</b> 概率与分布</a>
<ul>
<li class="chapter" data-level="2.1" data-path="概率与分布.html"><a href="概率与分布.html#引言-1"><i class="fa fa-check"></i><b>2.1</b> 引言</a></li>
<li class="chapter" data-level="2.2" data-path="概率与分布.html"><a href="概率与分布.html#蚂蚱午餐与概率"><i class="fa fa-check"></i><b>2.2</b> 蚂蚱午餐与概率</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="概率与分布.html"><a href="概率与分布.html#一只蚱蜢的午餐"><i class="fa fa-check"></i><b>2.2.1</b> 一只蚱蜢的午餐</a></li>
<li class="chapter" data-level="2.2.2" data-path="概率与分布.html"><a href="概率与分布.html#理想的猜测古典概率"><i class="fa fa-check"></i><b>2.2.2</b> 理想的猜测——古典概率</a></li>
<li class="chapter" data-level="2.2.3" data-path="概率与分布.html"><a href="概率与分布.html#数据的语言频率概率"><i class="fa fa-check"></i><b>2.2.3</b> 数据的语言——频率概率</a></li>
<li class="chapter" data-level="2.2.4" data-path="概率与分布.html"><a href="概率与分布.html#动态的更新贝叶斯概率"><i class="fa fa-check"></i><b>2.2.4</b> 动态的更新——贝叶斯概率</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="概率与分布.html"><a href="概率与分布.html#随机变量与分布"><i class="fa fa-check"></i><b>2.3</b> 随机变量与分布</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="概率与分布.html"><a href="概率与分布.html#随机变量"><i class="fa fa-check"></i><b>2.3.1</b> 随机变量</a></li>
<li class="chapter" data-level="2.3.2" data-path="概率与分布.html"><a href="概率与分布.html#概率分布"><i class="fa fa-check"></i><b>2.3.2</b> 概率分布</a></li>
<li class="chapter" data-level="2.3.3" data-path="概率与分布.html"><a href="概率与分布.html#累积概率分布从可能性到确定性"><i class="fa fa-check"></i><b>2.3.3</b> 累积概率分布：从可能性到确定性</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="概率与分布.html"><a href="概率与分布.html#午餐菜单离散随机变量的分布家族"><i class="fa fa-check"></i><b>2.4</b> 午餐菜单：离散随机变量的分布家族</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="概率与分布.html"><a href="概率与分布.html#伯努利分布一个是或否的终极问题"><i class="fa fa-check"></i><b>2.4.1</b> 伯努利分布：一个“是”或“否”的终极问题</a></li>
<li class="chapter" data-level="2.4.2" data-path="概率与分布.html"><a href="概率与分布.html#二项分布重复是非题的计数法则"><i class="fa fa-check"></i><b>2.4.2</b> 二项分布：重复“是非题”的计数法则</a></li>
<li class="chapter" data-level="2.4.3" data-path="概率与分布.html"><a href="概率与分布.html#多项式分布多元选择的全景图"><i class="fa fa-check"></i><b>2.4.3</b> 多项式分布：多元选择的“全景图”</a></li>
<li class="chapter" data-level="2.4.4" data-path="概率与分布.html"><a href="概率与分布.html#泊松分布罕见事件的低语者"><i class="fa fa-check"></i><b>2.4.4</b> 泊松分布：罕见事件的“低语者”</a></li>
<li class="chapter" data-level="2.4.5" data-path="概率与分布.html"><a href="概率与分布.html#几何分布等待第一次成功的耐心"><i class="fa fa-check"></i><b>2.4.5</b> 几何分布：等待“第一次成功”的耐心</a></li>
<li class="chapter" data-level="2.4.6" data-path="概率与分布.html"><a href="概率与分布.html#负二项分布等待最后一次成功的耐心"><i class="fa fa-check"></i><b>2.4.6</b> 负二项分布：等待“最后一次成功”的耐心</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="概率与分布.html"><a href="概率与分布.html#午餐法则连续随机变量的分布家族"><i class="fa fa-check"></i><b>2.5</b> 午餐法则：连续随机变量的分布家族</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="概率与分布.html"><a href="概率与分布.html#均匀分布纯粹的平等"><i class="fa fa-check"></i><b>2.5.1</b> 均匀分布：纯粹的平等</a></li>
<li class="chapter" data-level="2.5.2" data-path="概率与分布.html"><a href="概率与分布.html#指数分布等待的艺术"><i class="fa fa-check"></i><b>2.5.2</b> 指数分布：等待的艺术</a></li>
<li class="chapter" data-level="2.5.3" data-path="概率与分布.html"><a href="概率与分布.html#正态分布高斯分布自然界的钟形法则"><i class="fa fa-check"></i><b>2.5.3</b> 正态分布（高斯分布）：自然界的“钟形”法则</a></li>
<li class="chapter" data-level="2.5.4" data-path="概率与分布.html"><a href="概率与分布.html#威布尔分布生存分析的时间法则"><i class="fa fa-check"></i><b>2.5.4</b> 威布尔分布：生存分析的“时间法则”</a></li>
<li class="chapter" data-level="2.5.5" data-path="概率与分布.html"><a href="概率与分布.html#伽马分布更一般的等待时间模型"><i class="fa fa-check"></i><b>2.5.5</b> 伽马分布：更一般的等待时间模型</a></li>
<li class="chapter" data-level="2.5.6" data-path="概率与分布.html"><a href="概率与分布.html#贝塔分布比例变量的天然选择"><i class="fa fa-check"></i><b>2.5.6</b> 贝塔分布：比例变量的天然选择</a></li>
<li class="chapter" data-level="2.5.7" data-path="概率与分布.html"><a href="概率与分布.html#正态分布的魔力中心极限定理"><i class="fa fa-check"></i><b>2.5.7</b> 正态分布的魔力：中心极限定理</a></li>
<li class="chapter" data-level="2.5.8" data-path="概率与分布.html"><a href="概率与分布.html#生态学应用实例"><i class="fa fa-check"></i><b>2.5.8</b> 生态学应用实例</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="概率与分布.html"><a href="概率与分布.html#混合分布处理异质性数据"><i class="fa fa-check"></i><b>2.6</b> 混合分布：处理异质性数据</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="概率与分布.html"><a href="概率与分布.html#零膨胀分布处理零值过多的数据"><i class="fa fa-check"></i><b>2.6.1</b> 零膨胀分布：处理零值过多的数据</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="概率与分布.html"><a href="概率与分布.html#总结-2"><i class="fa fa-check"></i><b>2.7</b> 总结</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="描述统计.html"><a href="描述统计.html"><i class="fa fa-check"></i><b>3</b> 描述统计</a>
<ul>
<li class="chapter" data-level="3.1" data-path="描述统计.html"><a href="描述统计.html#引言-2"><i class="fa fa-check"></i><b>3.1</b> 引言</a></li>
<li class="chapter" data-level="3.2" data-path="描述统计.html"><a href="描述统计.html#描述统计基础"><i class="fa fa-check"></i><b>3.2</b> 描述统计基础</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="描述统计.html"><a href="描述统计.html#中心趋势测量"><i class="fa fa-check"></i><b>3.2.1</b> 中心趋势测量</a></li>
<li class="chapter" data-level="3.2.2" data-path="描述统计.html"><a href="描述统计.html#离散性测量"><i class="fa fa-check"></i><b>3.2.2</b> 离散性测量</a></li>
<li class="chapter" data-level="3.2.3" data-path="描述统计.html"><a href="描述统计.html#分布形状与矩测量"><i class="fa fa-check"></i><b>3.2.3</b> 分布形状与矩测量</a></li>
<li class="chapter" data-level="3.2.4" data-path="描述统计.html"><a href="描述统计.html#统计概念在概率分布图上的可视化"><i class="fa fa-check"></i><b>3.2.4</b> 统计概念在概率分布图上的可视化</a></li>
<li class="chapter" data-level="3.2.5" data-path="描述统计.html"><a href="描述统计.html#标准误的可视化理解"><i class="fa fa-check"></i><b>3.2.5</b> 标准误的可视化理解</a></li>
<li class="chapter" data-level="3.2.6" data-path="描述统计.html"><a href="描述统计.html#不同参数值的分布形状比较"><i class="fa fa-check"></i><b>3.2.6</b> 不同参数值的分布形状比较</a></li>
<li class="chapter" data-level="3.2.7" data-path="描述统计.html"><a href="描述统计.html#生态学意义总结"><i class="fa fa-check"></i><b>3.2.7</b> 生态学意义总结</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="描述统计.html"><a href="描述统计.html#环境异质性描述"><i class="fa fa-check"></i><b>3.3</b> 环境异质性描述</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="描述统计.html"><a href="描述统计.html#环境异质性的概念"><i class="fa fa-check"></i><b>3.3.1</b> 环境异质性的概念</a></li>
<li class="chapter" data-level="3.3.2" data-path="描述统计.html"><a href="描述统计.html#环境异质性的可视化理解"><i class="fa fa-check"></i><b>3.3.2</b> 环境异质性的可视化理解</a></li>
<li class="chapter" data-level="3.3.3" data-path="描述统计.html"><a href="描述统计.html#环境异质性的量化方法"><i class="fa fa-check"></i><b>3.3.3</b> 环境异质性的量化方法</a></li>
<li class="chapter" data-level="3.3.4" data-path="描述统计.html"><a href="描述统计.html#环境异质性的生态学意义"><i class="fa fa-check"></i><b>3.3.4</b> 环境异质性的生态学意义</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="描述统计.html"><a href="描述统计.html#个体特征描述"><i class="fa fa-check"></i><b>3.4</b> 个体特征描述</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="描述统计.html"><a href="描述统计.html#生存函数survival-function"><i class="fa fa-check"></i><b>3.4.1</b> 生存函数（Survival Function）</a></li>
<li class="chapter" data-level="3.4.2" data-path="描述统计.html"><a href="描述统计.html#瞬时死亡风险函数hazard-function"><i class="fa fa-check"></i><b>3.4.2</b> 瞬时死亡风险函数（Hazard Function）</a></li>
<li class="chapter" data-level="3.4.3" data-path="描述统计.html"><a href="描述统计.html#累积风险函数cumulative-hazard-function"><i class="fa fa-check"></i><b>3.4.3</b> 累积风险函数（Cumulative Hazard Function）</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="描述统计.html"><a href="描述统计.html#种群特征描述"><i class="fa fa-check"></i><b>3.5</b> 种群特征描述</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="描述统计.html"><a href="描述统计.html#gini系数"><i class="fa fa-check"></i><b>3.5.1</b> Gini系数</a></li>
<li class="chapter" data-level="3.5.2" data-path="描述统计.html"><a href="描述统计.html#lorenz曲线"><i class="fa fa-check"></i><b>3.5.2</b> Lorenz曲线</a></li>
<li class="chapter" data-level="3.5.3" data-path="描述统计.html"><a href="描述统计.html#基尼系数的生态学应用"><i class="fa fa-check"></i><b>3.5.3</b> 基尼系数的生态学应用</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="描述统计.html"><a href="描述统计.html#群落特征描述"><i class="fa fa-check"></i><b>3.6</b> 群落特征描述</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="描述统计.html"><a href="描述统计.html#物种多样性描述"><i class="fa fa-check"></i><b>3.6.1</b> 物种多样性描述</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="描述统计.html"><a href="描述统计.html#生态网络特征描述"><i class="fa fa-check"></i><b>3.7</b> 生态网络特征描述</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="描述统计.html"><a href="描述统计.html#网络拓扑指标"><i class="fa fa-check"></i><b>3.7.1</b> 网络拓扑指标</a></li>
<li class="chapter" data-level="3.7.2" data-path="描述统计.html"><a href="描述统计.html#食物网特征"><i class="fa fa-check"></i><b>3.7.2</b> 食物网特征</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="描述统计.html"><a href="描述统计.html#稳定性描述"><i class="fa fa-check"></i><b>3.8</b> 稳定性描述</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="描述统计.html"><a href="描述统计.html#抵抗力resistance"><i class="fa fa-check"></i><b>3.8.1</b> 抵抗力（Resistance）</a></li>
<li class="chapter" data-level="3.8.2" data-path="描述统计.html"><a href="描述统计.html#恢复力resilience"><i class="fa fa-check"></i><b>3.8.2</b> 恢复力（Resilience）</a></li>
<li class="chapter" data-level="3.8.3" data-path="描述统计.html"><a href="描述统计.html#持久性persistence"><i class="fa fa-check"></i><b>3.8.3</b> 持久性（Persistence）</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="描述统计.html"><a href="描述统计.html#总结-3"><i class="fa fa-check"></i><b>3.9</b> 总结</a></li>
<li class="chapter" data-level="3.10" data-path="描述统计.html"><a href="描述统计.html#综合练习-1"><i class="fa fa-check"></i><b>3.10</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="参数估计.html"><a href="参数估计.html"><i class="fa fa-check"></i><b>4</b> 参数估计</a>
<ul>
<li class="chapter" data-level="4.1" data-path="参数估计.html"><a href="参数估计.html#引言-3"><i class="fa fa-check"></i><b>4.1</b> 引言</a></li>
<li class="chapter" data-level="4.2" data-path="参数估计.html"><a href="参数估计.html#样本与总体"><i class="fa fa-check"></i><b>4.2</b> 样本与总体</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="参数估计.html"><a href="参数估计.html#抽样方法及其生态学应用"><i class="fa fa-check"></i><b>4.2.1</b> 抽样方法及其生态学应用</a></li>
<li class="chapter" data-level="4.2.2" data-path="参数估计.html"><a href="参数估计.html#r语言中的抽样实现"><i class="fa fa-check"></i><b>4.2.2</b> R语言中的抽样实现</a></li>
<li class="chapter" data-level="4.2.3" data-path="参数估计.html"><a href="参数估计.html#抽样误差与样本量确定"><i class="fa fa-check"></i><b>4.2.3</b> 抽样误差与样本量确定</a></li>
<li class="chapter" data-level="4.2.4" data-path="参数估计.html"><a href="参数估计.html#生态学抽样设计的实践考虑"><i class="fa fa-check"></i><b>4.2.4</b> 生态学抽样设计的实践考虑</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="参数估计.html"><a href="参数估计.html#参数估计基础"><i class="fa fa-check"></i><b>4.3</b> 参数估计基础</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="参数估计.html"><a href="参数估计.html#点估计"><i class="fa fa-check"></i><b>4.3.1</b> 点估计</a></li>
<li class="chapter" data-level="4.3.2" data-path="参数估计.html"><a href="参数估计.html#区间估计"><i class="fa fa-check"></i><b>4.3.2</b> 区间估计</a></li>
<li class="chapter" data-level="4.3.3" data-path="参数估计.html"><a href="参数估计.html#估计方法"><i class="fa fa-check"></i><b>4.3.3</b> 估计方法</a></li>
<li class="chapter" data-level="4.3.4" data-path="参数估计.html"><a href="参数估计.html#估计量性质如何评价一个估计方法的好坏"><i class="fa fa-check"></i><b>4.3.4</b> 估计量性质：如何评价一个估计方法的好坏？</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="参数估计.html"><a href="参数估计.html#种群大小估计"><i class="fa fa-check"></i><b>4.4</b> 种群大小估计</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="参数估计.html"><a href="参数估计.html#标记重捕法"><i class="fa fa-check"></i><b>4.4.1</b> 标记重捕法</a></li>
<li class="chapter" data-level="4.4.2" data-path="参数估计.html"><a href="参数估计.html#面积取样法"><i class="fa fa-check"></i><b>4.4.2</b> 面积取样法</a></li>
<li class="chapter" data-level="4.4.3" data-path="参数估计.html"><a href="参数估计.html#距离抽样法"><i class="fa fa-check"></i><b>4.4.3</b> 距离抽样法</a></li>
<li class="chapter" data-level="4.4.4" data-path="参数估计.html"><a href="参数估计.html#去除法"><i class="fa fa-check"></i><b>4.4.4</b> 去除法</a></li>
<li class="chapter" data-level="4.4.5" data-path="参数估计.html"><a href="参数估计.html#种群大小估计方法的选择与比较"><i class="fa fa-check"></i><b>4.4.5</b> 种群大小估计方法的选择与比较</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="参数估计.html"><a href="参数估计.html#物种多样性估计"><i class="fa fa-check"></i><b>4.5</b> 物种多样性估计</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="参数估计.html"><a href="参数估计.html#外推和内插方法"><i class="fa fa-check"></i><b>4.5.1</b> 外推和内插方法</a></li>
<li class="chapter" data-level="4.5.2" data-path="参数估计.html"><a href="参数估计.html#多样性估计的抽样偏差"><i class="fa fa-check"></i><b>4.5.2</b> 多样性估计的抽样偏差</a></li>
<li class="chapter" data-level="4.5.3" data-path="参数估计.html"><a href="参数估计.html#多样性估计方法的选择与比较"><i class="fa fa-check"></i><b>4.5.3</b> 多样性估计方法的选择与比较</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="参数估计.html"><a href="参数估计.html#总结-4"><i class="fa fa-check"></i><b>4.6</b> 总结</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="参数估计.html"><a href="参数估计.html#参数估计的生态学意义与理论基础"><i class="fa fa-check"></i><b>4.6.1</b> 参数估计的生态学意义与理论基础</a></li>
<li class="chapter" data-level="4.6.2" data-path="参数估计.html"><a href="参数估计.html#点估计与区间估计从单一数值到可信范围"><i class="fa fa-check"></i><b>4.6.2</b> 点估计与区间估计：从单一数值到可信范围</a></li>
<li class="chapter" data-level="4.6.3" data-path="参数估计.html"><a href="参数估计.html#主要估计方法及其生态学应用"><i class="fa fa-check"></i><b>4.6.3</b> 主要估计方法及其生态学应用</a></li>
<li class="chapter" data-level="4.6.4" data-path="参数估计.html"><a href="参数估计.html#种群大小估计生态学实践的核心任务"><i class="fa fa-check"></i><b>4.6.4</b> 种群大小估计：生态学实践的核心任务</a></li>
<li class="chapter" data-level="4.6.5" data-path="参数估计.html"><a href="参数估计.html#物种多样性估计群落生态学的量化基础"><i class="fa fa-check"></i><b>4.6.5</b> 物种多样性估计：群落生态学的量化基础</a></li>
<li class="chapter" data-level="4.6.6" data-path="参数估计.html"><a href="参数估计.html#参数估计在生态学决策中的重要性"><i class="fa fa-check"></i><b>4.6.6</b> 参数估计在生态学决策中的重要性</a></li>
<li class="chapter" data-level="4.6.7" data-path="参数估计.html"><a href="参数估计.html#未来发展方向与挑战"><i class="fa fa-check"></i><b>4.6.7</b> 未来发展方向与挑战</a></li>
<li class="chapter" data-level="4.6.8" data-path="参数估计.html"><a href="参数估计.html#结语"><i class="fa fa-check"></i><b>4.6.8</b> 结语</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="参数估计.html"><a href="参数估计.html#综合练习-2"><i class="fa fa-check"></i><b>4.7</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="相关性与相似性.html"><a href="相关性与相似性.html"><i class="fa fa-check"></i><b>5</b> 相关性与相似性</a>
<ul>
<li class="chapter" data-level="5.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#引言-4"><i class="fa fa-check"></i><b>5.1</b> 引言</a></li>
<li class="chapter" data-level="5.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#线性相关性"><i class="fa fa-check"></i><b>5.2</b> 线性相关性</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#pearson相关系数线性关系的度量"><i class="fa fa-check"></i><b>5.2.1</b> Pearson相关系数：线性关系的度量</a></li>
<li class="chapter" data-level="5.2.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#spearman秩相关单调关系的度量"><i class="fa fa-check"></i><b>5.2.2</b> Spearman秩相关：单调关系的度量</a></li>
<li class="chapter" data-level="5.2.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#kendalls-τ基于一致对的比例"><i class="fa fa-check"></i><b>5.2.3</b> Kendall’s τ：基于一致对的比例</a></li>
<li class="chapter" data-level="5.2.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#偏相关分析"><i class="fa fa-check"></i><b>5.2.4</b> 偏相关分析</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#非线性相关"><i class="fa fa-check"></i><b>5.3</b> 非线性相关</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#距离相关"><i class="fa fa-check"></i><b>5.3.1</b> 距离相关</a></li>
<li class="chapter" data-level="5.3.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#互信息"><i class="fa fa-check"></i><b>5.3.2</b> 互信息</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#时间自相关"><i class="fa fa-check"></i><b>5.4</b> 时间自相关</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#生态学中的时间自相关实例"><i class="fa fa-check"></i><b>5.4.1</b> 生态学中的时间自相关实例</a></li>
<li class="chapter" data-level="5.4.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#自相关函数acf时间依赖性的量化"><i class="fa fa-check"></i><b>5.4.2</b> 自相关函数（ACF）：时间依赖性的量化</a></li>
<li class="chapter" data-level="5.4.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#偏自相关函数pacf直接时间依赖的识别"><i class="fa fa-check"></i><b>5.4.3</b> 偏自相关函数（PACF）：直接时间依赖的识别</a></li>
<li class="chapter" data-level="5.4.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#时间序列平稳性分析的基础假设"><i class="fa fa-check"></i><b>5.4.4</b> 时间序列平稳性：分析的基础假设</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#空间自相关"><i class="fa fa-check"></i><b>5.5</b> 空间自相关</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#变异函数variogram空间依赖性的量化"><i class="fa fa-check"></i><b>5.5.1</b> 变异函数（Variogram）：空间依赖性的量化</a></li>
<li class="chapter" data-level="5.5.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#克里金插值基于空间自相关的预测方法"><i class="fa fa-check"></i><b>5.5.2</b> 克里金插值：基于空间自相关的预测方法</a></li>
<li class="chapter" data-level="5.5.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#空间自相关指数全局空间模式的检测"><i class="fa fa-check"></i><b>5.5.3</b> 空间自相关指数：全局空间模式的检测</a></li>
<li class="chapter" data-level="5.5.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#局部空间自相关空间异质性的识别"><i class="fa fa-check"></i><b>5.5.4</b> 局部空间自相关：空间异质性的识别</a></li>
<li class="chapter" data-level="5.5.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#空间平稳性空间分析的基础假设"><i class="fa fa-check"></i><b>5.5.5</b> 空间平稳性：空间分析的基础假设</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育相关性"><i class="fa fa-check"></i><b>5.6</b> 系统发育相关性</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育信号进化历史的印记"><i class="fa fa-check"></i><b>5.6.1</b> 系统发育信号：进化历史的印记</a></li>
<li class="chapter" data-level="5.6.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育独立对比去除系统发育影响的性状比较"><i class="fa fa-check"></i><b>5.6.2</b> 系统发育独立对比：去除系统发育影响的性状比较</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="相关性与相似性.html"><a href="相关性与相似性.html#相似性与距离"><i class="fa fa-check"></i><b>5.7</b> 相似性与距离</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#常用相似性系数"><i class="fa fa-check"></i><b>5.7.1</b> 常用相似性系数</a></li>
<li class="chapter" data-level="5.7.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#功能性状间相关性"><i class="fa fa-check"></i><b>5.7.2</b> 功能性状间相关性</a></li>
<li class="chapter" data-level="5.7.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#种内相关性"><i class="fa fa-check"></i><b>5.7.3</b> 种内相关性</a></li>
<li class="chapter" data-level="5.7.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#种间相关性"><i class="fa fa-check"></i><b>5.7.4</b> 种间相关性</a></li>
<li class="chapter" data-level="5.7.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#群落相似性"><i class="fa fa-check"></i><b>5.7.5</b> 群落相似性</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="相关性与相似性.html"><a href="相关性与相似性.html#总结-5"><i class="fa fa-check"></i><b>5.8</b> 总结</a></li>
<li class="chapter" data-level="5.9" data-path="相关性与相似性.html"><a href="相关性与相似性.html#综合练习-3"><i class="fa fa-check"></i><b>5.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html"><i class="fa fa-check"></i><b>6</b> 基于经典分布的假设检验</a>
<ul>
<li class="chapter" data-level="6.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#引言-5"><i class="fa fa-check"></i><b>6.1</b> 引言</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#假设检验基础"><i class="fa fa-check"></i><b>6.1.1</b> 假设检验基础</a></li>
<li class="chapter" data-level="6.1.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#假设检验的基本步骤"><i class="fa fa-check"></i><b>6.1.2</b> 假设检验的基本步骤</a></li>
<li class="chapter" data-level="6.1.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#零假设与备择假设"><i class="fa fa-check"></i><b>6.1.3</b> 零假设与备择假设</a></li>
<li class="chapter" data-level="6.1.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#检验统计量与p值"><i class="fa fa-check"></i><b>6.1.4</b> 检验统计量与p值</a></li>
<li class="chapter" data-level="6.1.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#显著性水平"><i class="fa fa-check"></i><b>6.1.5</b> 显著性水平</a></li>
<li class="chapter" data-level="6.1.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#效应大小与置信区间"><i class="fa fa-check"></i><b>6.1.6</b> 效应大小与置信区间</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本检验"><i class="fa fa-check"></i><b>6.2</b> 单样本检验</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本t检验"><i class="fa fa-check"></i><b>6.2.1</b> 单样本t检验</a></li>
<li class="chapter" data-level="6.2.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本符号检验"><i class="fa fa-check"></i><b>6.2.2</b> 单样本符号检验</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#双样本检验"><i class="fa fa-check"></i><b>6.3</b> 双样本检验</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#独立样本t检验"><i class="fa fa-check"></i><b>6.3.1</b> 独立样本t检验</a></li>
<li class="chapter" data-level="6.3.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#配对样本t检验"><i class="fa fa-check"></i><b>6.3.2</b> 配对样本t检验</a></li>
<li class="chapter" data-level="6.3.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#mann-whitney-u检验"><i class="fa fa-check"></i><b>6.3.3</b> Mann-Whitney U检验</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多样本检验"><i class="fa fa-check"></i><b>6.4</b> 多样本检验</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#方差分析anova"><i class="fa fa-check"></i><b>6.4.1</b> 方差分析（ANOVA）</a></li>
<li class="chapter" data-level="6.4.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#kruskal-wallis检验"><i class="fa fa-check"></i><b>6.4.2</b> Kruskal-Wallis检验</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#非参数检验方法"><i class="fa fa-check"></i><b>6.5</b> 非参数检验方法</a></li>
<li class="chapter" data-level="6.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较校正"><i class="fa fa-check"></i><b>6.6</b> 多重比较校正</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较问题的本质"><i class="fa fa-check"></i><b>6.6.1</b> 多重比较问题的本质</a></li>
<li class="chapter" data-level="6.6.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#bonferroni校正"><i class="fa fa-check"></i><b>6.6.2</b> Bonferroni校正</a></li>
<li class="chapter" data-level="6.6.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#tukey-hsd检验"><i class="fa fa-check"></i><b>6.6.3</b> Tukey HSD检验</a></li>
<li class="chapter" data-level="6.6.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#fdr错误发现率控制"><i class="fa fa-check"></i><b>6.6.4</b> FDR（错误发现率）控制</a></li>
<li class="chapter" data-level="6.6.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#生态学实例森林类型对鸟类多样性的影响"><i class="fa fa-check"></i><b>6.6.5</b> 生态学实例：森林类型对鸟类多样性的影响</a></li>
<li class="chapter" data-level="6.6.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较校正效果的可视化"><i class="fa fa-check"></i><b>6.6.6</b> 多重比较校正效果的可视化</a></li>
<li class="chapter" data-level="6.6.7" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#实用建议与最佳实践"><i class="fa fa-check"></i><b>6.6.7</b> 实用建议与最佳实践</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#功效分析"><i class="fa fa-check"></i><b>6.7</b> 功效分析</a></li>
<li class="chapter" data-level="6.8" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#总结-6"><i class="fa fa-check"></i><b>6.8</b> 总结</a></li>
<li class="chapter" data-level="6.9" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#综合练习-4"><i class="fa fa-check"></i><b>6.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html"><i class="fa fa-check"></i><b>7</b> 基于模拟的假设检验</a>
<ul>
<li class="chapter" data-level="7.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#引言-6"><i class="fa fa-check"></i><b>7.1</b> 引言</a></li>
<li class="chapter" data-level="7.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学层次与演进脉络"><i class="fa fa-check"></i><b>7.2</b> 方法学层次与演进脉络</a></li>
<li class="chapter" data-level="7.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验"><i class="fa fa-check"></i><b>7.3</b> 置换检验</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验的基本原理"><i class="fa fa-check"></i><b>7.3.1</b> 置换检验的基本原理</a></li>
<li class="chapter" data-level="7.3.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验的技术实现过程"><i class="fa fa-check"></i><b>7.3.2</b> 置换检验的技术实现过程</a></li>
<li class="chapter" data-level="7.3.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例"><i class="fa fa-check"></i><b>7.3.3</b> R语言实现示例</a></li>
<li class="chapter" data-level="7.3.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验在生态学中的应用价值与局限"><i class="fa fa-check"></i><b>7.3.4</b> 置换检验在生态学中的应用价值与局限</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验"><i class="fa fa-check"></i><b>7.4</b> 蒙特卡洛检验</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛方法的概念体系"><i class="fa fa-check"></i><b>7.4.1</b> 蒙特卡洛方法的概念体系</a></li>
<li class="chapter" data-level="7.4.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验的基本原理"><i class="fa fa-check"></i><b>7.4.2</b> 蒙特卡洛检验的基本原理</a></li>
<li class="chapter" data-level="7.4.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验的主要类型"><i class="fa fa-check"></i><b>7.4.3</b> 蒙特卡洛检验的主要类型</a></li>
<li class="chapter" data-level="7.4.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例空间分布随机性检验"><i class="fa fa-check"></i><b>7.4.4</b> R语言实现示例：空间分布随机性检验</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法检验"><i class="fa fa-check"></i><b>7.5</b> 自助法检验</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的基本原理"><i class="fa fa-check"></i><b>7.5.1</b> 自助法的基本原理</a></li>
<li class="chapter" data-level="7.5.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的实施步骤"><i class="fa fa-check"></i><b>7.5.2</b> 自助法的实施步骤</a></li>
<li class="chapter" data-level="7.5.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法在生态学中的应用"><i class="fa fa-check"></i><b>7.5.3</b> 自助法在生态学中的应用</a></li>
<li class="chapter" data-level="7.5.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例-1"><i class="fa fa-check"></i><b>7.5.4</b> R语言实现示例</a></li>
<li class="chapter" data-level="7.5.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的优势与局限"><i class="fa fa-check"></i><b>7.5.5</b> 自助法的优势与局限</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#基因型频率检验"><i class="fa fa-check"></i><b>7.6</b> 基因型频率检验</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#hardy-weinberg平衡检验"><i class="fa fa-check"></i><b>7.6.1</b> Hardy-Weinberg平衡检验</a></li>
<li class="chapter" data-level="7.6.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#连锁不平衡检验"><i class="fa fa-check"></i><b>7.6.2</b> 连锁不平衡检验</a></li>
<li class="chapter" data-level="7.6.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与选择建议"><i class="fa fa-check"></i><b>7.6.3</b> 方法学比较与选择建议</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#多样性差异检验"><i class="fa fa-check"></i><b>7.7</b> 多样性差异检验</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#群落多样性比较"><i class="fa fa-check"></i><b>7.7.1</b> 群落多样性比较</a></li>
<li class="chapter" data-level="7.7.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#相似性分析anosim"><i class="fa fa-check"></i><b>7.7.2</b> 相似性分析（ANOSIM）</a></li>
<li class="chapter" data-level="7.7.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与生态学应用建议"><i class="fa fa-check"></i><b>7.7.3</b> 方法学比较与生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#物种空间分布检验"><i class="fa fa-check"></i><b>7.8</b> 物种空间分布检验</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#空间分布模式检验"><i class="fa fa-check"></i><b>7.8.1</b> 空间分布模式检验</a></li>
<li class="chapter" data-level="7.8.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#点过程模型检验"><i class="fa fa-check"></i><b>7.8.2</b> 点过程模型检验</a></li>
<li class="chapter" data-level="7.8.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#空间生态学的统计挑战与解决方案"><i class="fa fa-check"></i><b>7.8.3</b> 空间生态学的统计挑战与解决方案</a></li>
<li class="chapter" data-level="7.8.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学应用与保护意义"><i class="fa fa-check"></i><b>7.8.4</b> 生态学应用与保护意义</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育信号检验"><i class="fa fa-check"></i><b>7.9</b> 系统发育信号检验</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育保守性检验"><i class="fa fa-check"></i><b>7.9.1</b> 系统发育保守性检验</a></li>
<li class="chapter" data-level="7.9.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育独立对比"><i class="fa fa-check"></i><b>7.9.2</b> 系统发育独立对比</a></li>
<li class="chapter" data-level="7.9.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与生态学应用建议-1"><i class="fa fa-check"></i><b>7.9.3</b> 方法学比较与生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学零模型检验"><i class="fa fa-check"></i><b>7.10</b> 生态学零模型检验</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#零模型的基本概念与生态学意义"><i class="fa fa-check"></i><b>7.10.1</b> 零模型的基本概念与生态学意义</a></li>
<li class="chapter" data-level="7.10.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#群落组装零模型检验"><i class="fa fa-check"></i><b>7.10.2</b> 群落组装零模型检验</a></li>
<li class="chapter" data-level="7.10.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态网络零模型检验"><i class="fa fa-check"></i><b>7.10.3</b> 生态网络零模型检验</a></li>
<li class="chapter" data-level="7.10.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#零模型检验的方法学比较与选择"><i class="fa fa-check"></i><b>7.10.4</b> 零模型检验的方法学比较与选择</a></li>
<li class="chapter" data-level="7.10.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学应用与保护意义-1"><i class="fa fa-check"></i><b>7.10.5</b> 生态学应用与保护意义</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#总结-7"><i class="fa fa-check"></i><b>7.11</b> 总结</a></li>
<li class="chapter" data-level="7.12" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#综合练习-5"><i class="fa fa-check"></i><b>7.12</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html"><i class="fa fa-check"></i><b>8</b> 简单线性回归模型</a>
<ul>
<li class="chapter" data-level="8.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#引言-7"><i class="fa fa-check"></i><b>8.1</b> 引言</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#为什么生态学本科生需要学习统计建模与预测"><i class="fa fa-check"></i><b>8.1.1</b> 为什么生态学本科生需要学习统计建模与预测？</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#线性回归模型生态关系的数学表达"><i class="fa fa-check"></i><b>8.2</b> 线性回归模型：生态关系的数学表达</a></li>
<li class="chapter" data-level="8.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#最小二乘估计"><i class="fa fa-check"></i><b>8.3</b> 最小二乘估计</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的lm函数详解"><i class="fa fa-check"></i><b>8.3.1</b> R语言中的lm()函数详解</a></li>
<li class="chapter" data-level="8.3.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#lm函数的基本语法"><i class="fa fa-check"></i><b>8.3.2</b> lm()函数的基本语法</a></li>
<li class="chapter" data-level="8.3.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型公式的详细说明"><i class="fa fa-check"></i><b>8.3.3</b> 模型公式的详细说明</a></li>
<li class="chapter" data-level="8.3.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#lm函数的返回对象"><i class="fa fa-check"></i><b>8.3.4</b> lm()函数的返回对象</a></li>
<li class="chapter" data-level="8.3.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#提取回归结果的常用函数"><i class="fa fa-check"></i><b>8.3.5</b> 提取回归结果的常用函数</a></li>
<li class="chapter" data-level="8.3.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#理解summary函数的输出"><i class="fa fa-check"></i><b>8.3.6</b> 理解summary()函数的输出</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#回归诊断验证模型的生态学合理性"><i class="fa fa-check"></i><b>8.4</b> 回归诊断：验证模型的生态学合理性</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#回归诊断图的系统解读"><i class="fa fa-check"></i><b>8.4.1</b> 回归诊断图的系统解读</a></li>
<li class="chapter" data-level="8.4.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型质量的综合评估"><i class="fa fa-check"></i><b>8.4.2</b> 模型质量的综合评估</a></li>
<li class="chapter" data-level="8.4.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学诊断问题的应对策略"><i class="fa fa-check"></i><b>8.4.3</b> 生态学诊断问题的应对策略</a></li>
<li class="chapter" data-level="8.4.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用实例-1"><i class="fa fa-check"></i><b>8.4.4</b> 生态学应用实例</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归多因子生态关系的综合分析"><i class="fa fa-check"></i><b>8.5</b> 多元线性回归：多因子生态关系的综合分析</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归的模型公式"><i class="fa fa-check"></i><b>8.5.1</b> 多元线性回归的模型公式</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归中的变量选择"><i class="fa fa-check"></i><b>8.6</b> 多元线性回归中的变量选择</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择的重要性"><i class="fa fa-check"></i><b>8.6.1</b> 变量选择的重要性</a></li>
<li class="chapter" data-level="8.6.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择的基本原则"><i class="fa fa-check"></i><b>8.6.2</b> 变量选择的基本原则</a></li>
<li class="chapter" data-level="8.6.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#常用的变量选择方法"><i class="fa fa-check"></i><b>8.6.3</b> 常用的变量选择方法</a></li>
<li class="chapter" data-level="8.6.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的模型选择实现"><i class="fa fa-check"></i><b>8.6.4</b> R语言中的模型选择实现</a></li>
<li class="chapter" data-level="8.6.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学变量选择的实践建议"><i class="fa fa-check"></i><b>8.6.5</b> 生态学变量选择的实践建议</a></li>
<li class="chapter" data-level="8.6.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型选择的注意事项"><i class="fa fa-check"></i><b>8.6.6</b> 模型选择的注意事项</a></li>
<li class="chapter" data-level="8.6.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#完整生态学案例分析鸟类丰富度与环境因子的关系"><i class="fa fa-check"></i><b>8.6.7</b> 完整生态学案例分析：鸟类丰富度与环境因子的关系</a></li>
<li class="chapter" data-level="8.6.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#完整模型拟合"><i class="fa fa-check"></i><b>8.6.8</b> 完整模型拟合</a></li>
<li class="chapter" data-level="8.6.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择过程"><i class="fa fa-check"></i><b>8.6.9</b> 变量选择过程</a></li>
<li class="chapter" data-level="8.6.10" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#最优模型选择与结果解释"><i class="fa fa-check"></i><b>8.6.10</b> 最优模型选择与结果解释</a></li>
<li class="chapter" data-level="8.6.11" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型诊断与假设检验"><i class="fa fa-check"></i><b>8.6.11</b> 模型诊断与假设检验</a></li>
<li class="chapter" data-level="8.6.12" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型预测与应用"><i class="fa fa-check"></i><b>8.6.12</b> 模型预测与应用</a></li>
<li class="chapter" data-level="8.6.13" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型比较与评估"><i class="fa fa-check"></i><b>8.6.13</b> 模型比较与评估</a></li>
<li class="chapter" data-level="8.6.14" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学解释与模型选择价值"><i class="fa fa-check"></i><b>8.6.14</b> 生态学解释与模型选择价值</a></li>
<li class="chapter" data-level="8.6.15" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#案例分析总结"><i class="fa fa-check"></i><b>8.6.15</b> 案例分析总结</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归非线性生态关系的数学描述"><i class="fa fa-check"></i><b>8.7</b> 多项式回归：非线性生态关系的数学描述</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归模型"><i class="fa fa-check"></i><b>8.7.1</b> 多项式回归模型</a></li>
<li class="chapter" data-level="8.7.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的多项式回归实现"><i class="fa fa-check"></i><b>8.7.2</b> R语言中的多项式回归实现</a></li>
<li class="chapter" data-level="8.7.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用实例-2"><i class="fa fa-check"></i><b>8.7.3</b> 生态学应用实例</a></li>
<li class="chapter" data-level="8.7.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归的生态学意义"><i class="fa fa-check"></i><b>8.7.4</b> 多项式回归的生态学意义</a></li>
<li class="chapter" data-level="8.7.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式阶数的选择"><i class="fa fa-check"></i><b>8.7.5</b> 多项式阶数的选择</a></li>
<li class="chapter" data-level="8.7.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归的注意事项"><i class="fa fa-check"></i><b>8.7.6</b> 多项式回归的注意事项</a></li>
<li class="chapter" data-level="8.7.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#过度拟合问题演示"><i class="fa fa-check"></i><b>8.7.7</b> 过度拟合问题演示</a></li>
<li class="chapter" data-level="8.7.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型可视化与比较"><i class="fa fa-check"></i><b>8.7.8</b> 模型可视化与比较</a></li>
<li class="chapter" data-level="8.7.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#统计指标与交叉验证"><i class="fa fa-check"></i><b>8.7.9</b> 统计指标与交叉验证</a></li>
<li class="chapter" data-level="8.7.10" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用建议"><i class="fa fa-check"></i><b>8.7.10</b> 生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#总结从线性到非线性从简单到复杂"><i class="fa fa-check"></i><b>8.8</b> 总结：从线性到非线性，从简单到复杂</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#核心概念回顾"><i class="fa fa-check"></i><b>8.8.1</b> 核心概念回顾</a></li>
<li class="chapter" data-level="8.8.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学建模思维"><i class="fa fa-check"></i><b>8.8.2</b> 生态学建模思维</a></li>
<li class="chapter" data-level="8.8.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#实践应用价值"><i class="fa fa-check"></i><b>8.8.3</b> 实践应用价值</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#综合练习-6"><i class="fa fa-check"></i><b>8.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="模型选择与评估.html"><a href="模型选择与评估.html"><i class="fa fa-check"></i><b>9</b> 模型选择与评估</a>
<ul>
<li class="chapter" data-level="9.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#引言-8"><i class="fa fa-check"></i><b>9.1</b> 引言</a></li>
<li class="chapter" data-level="9.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型选择"><i class="fa fa-check"></i><b>9.2</b> 模型选择</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型选择原则"><i class="fa fa-check"></i><b>9.2.1</b> 模型选择原则</a></li>
<li class="chapter" data-level="9.2.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#信息准则"><i class="fa fa-check"></i><b>9.2.2</b> 信息准则</a></li>
<li class="chapter" data-level="9.2.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#似然比检验"><i class="fa fa-check"></i><b>9.2.3</b> 似然比检验</a></li>
<li class="chapter" data-level="9.2.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型平均"><i class="fa fa-check"></i><b>9.2.4</b> 模型平均</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型评估"><i class="fa fa-check"></i><b>9.3</b> 模型评估</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#交叉验证"><i class="fa fa-check"></i><b>9.3.1</b> 交叉验证</a></li>
<li class="chapter" data-level="9.3.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#外部验证"><i class="fa fa-check"></i><b>9.3.2</b> 外部验证</a></li>
<li class="chapter" data-level="9.3.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型诊断"><i class="fa fa-check"></i><b>9.3.3</b> 模型诊断</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型选择与评估"><i class="fa fa-check"></i><b>9.4</b> 贝叶斯模型选择与评估</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯与频率学派的根本差异"><i class="fa fa-check"></i><b>9.4.1</b> 贝叶斯与频率学派的根本差异</a></li>
<li class="chapter" data-level="9.4.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型选择基本原理"><i class="fa fa-check"></i><b>9.4.2</b> 贝叶斯模型选择基本原理</a></li>
<li class="chapter" data-level="9.4.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯假设检验流程"><i class="fa fa-check"></i><b>9.4.3</b> 贝叶斯假设检验流程</a></li>
<li class="chapter" data-level="9.4.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型比较与选择"><i class="fa fa-check"></i><b>9.4.4</b> 贝叶斯模型比较与选择</a></li>
<li class="chapter" data-level="9.4.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯可信区间"><i class="fa fa-check"></i><b>9.4.5</b> 贝叶斯可信区间</a></li>
<li class="chapter" data-level="9.4.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯因子计算与解释"><i class="fa fa-check"></i><b>9.4.6</b> 贝叶斯因子计算与解释</a></li>
<li class="chapter" data-level="9.4.7" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型平均"><i class="fa fa-check"></i><b>9.4.7</b> 贝叶斯模型平均</a></li>
<li class="chapter" data-level="9.4.8" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯预测评估"><i class="fa fa-check"></i><b>9.4.8</b> 贝叶斯预测评估</a></li>
<li class="chapter" data-level="9.4.9" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯变量选择"><i class="fa fa-check"></i><b>9.4.9</b> 贝叶斯变量选择</a></li>
<li class="chapter" data-level="9.4.10" data-path="模型选择与评估.html"><a href="模型选择与评估.html#生态学应用价值"><i class="fa fa-check"></i><b>9.4.10</b> 生态学应用价值</a></li>
<li class="chapter" data-level="9.4.11" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯检验的生态学应用案例"><i class="fa fa-check"></i><b>9.4.11</b> 贝叶斯检验的生态学应用案例</a></li>
<li class="chapter" data-level="9.4.12" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯方法的局限性"><i class="fa fa-check"></i><b>9.4.12</b> 贝叶斯方法的局限性</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#总结-8"><i class="fa fa-check"></i><b>9.5</b> 总结</a></li>
<li class="chapter" data-level="9.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#综合练习-7"><i class="fa fa-check"></i><b>9.6</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="高级回归模型.html"><a href="高级回归模型.html"><i class="fa fa-check"></i><b>10</b> 高级回归模型</a>
<ul>
<li class="chapter" data-level="10.1" data-path="高级回归模型.html"><a href="高级回归模型.html#引言-9"><i class="fa fa-check"></i><b>10.1</b> 引言</a></li>
<li class="chapter" data-level="10.2" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型"><i class="fa fa-check"></i><b>10.2</b> 可加性模型</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型的基本原理"><i class="fa fa-check"></i><b>10.2.1</b> 可加性模型的基本原理</a></li>
<li class="chapter" data-level="10.2.2" data-path="高级回归模型.html"><a href="高级回归模型.html#与线性模型的比较"><i class="fa fa-check"></i><b>10.2.2</b> 与线性模型的比较</a></li>
<li class="chapter" data-level="10.2.3" data-path="高级回归模型.html"><a href="高级回归模型.html#常见的平滑函数"><i class="fa fa-check"></i><b>10.2.3</b> 常见的平滑函数</a></li>
<li class="chapter" data-level="10.2.4" data-path="高级回归模型.html"><a href="高级回归模型.html#平滑函数选择的生态学考量"><i class="fa fa-check"></i><b>10.2.4</b> 平滑函数选择的生态学考量</a></li>
<li class="chapter" data-level="10.2.5" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型中的系数概念"><i class="fa fa-check"></i><b>10.2.5</b> 可加性模型中的”系数”概念</a></li>
<li class="chapter" data-level="10.2.6" data-path="高级回归模型.html"><a href="高级回归模型.html#在r中的实现"><i class="fa fa-check"></i><b>10.2.6</b> 在R中的实现</a></li>
<li class="chapter" data-level="10.2.7" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学应用示例"><i class="fa fa-check"></i><b>10.2.7</b> 生态学应用示例</a></li>
<li class="chapter" data-level="10.2.8" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型诊断"><i class="fa fa-check"></i><b>10.2.8</b> 可加性模型诊断</a></li>
<li class="chapter" data-level="10.2.9" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型的优势与局限"><i class="fa fa-check"></i><b>10.2.9</b> 可加性模型的优势与局限</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="高级回归模型.html"><a href="高级回归模型.html#广义线性回归"><i class="fa fa-check"></i><b>10.3</b> 广义线性回归</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="高级回归模型.html"><a href="高级回归模型.html#广义线性模型的基本框架"><i class="fa fa-check"></i><b>10.3.1</b> 广义线性模型的基本框架</a></li>
<li class="chapter" data-level="10.3.2" data-path="高级回归模型.html"><a href="高级回归模型.html#与普通线性回归的根本区别"><i class="fa fa-check"></i><b>10.3.2</b> 与普通线性回归的根本区别</a></li>
<li class="chapter" data-level="10.3.3" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的glm实现"><i class="fa fa-check"></i><b>10.3.3</b> R语言中的GLM实现</a></li>
<li class="chapter" data-level="10.3.4" data-path="高级回归模型.html"><a href="高级回归模型.html#常见glm类型及其生态学应用"><i class="fa fa-check"></i><b>10.3.4</b> 常见GLM类型及其生态学应用</a></li>
<li class="chapter" data-level="10.3.5" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与解释"><i class="fa fa-check"></i><b>10.3.5</b> 模型诊断与解释</a></li>
<li class="chapter" data-level="10.3.6" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学意义与注意事项"><i class="fa fa-check"></i><b>10.3.6</b> 生态学意义与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="高级回归模型.html"><a href="高级回归模型.html#广义可加模型"><i class="fa fa-check"></i><b>10.4</b> 广义可加模型</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="高级回归模型.html"><a href="高级回归模型.html#gam的基本原理"><i class="fa fa-check"></i><b>10.4.1</b> GAM的基本原理</a></li>
<li class="chapter" data-level="10.4.2" data-path="高级回归模型.html"><a href="高级回归模型.html#在r中的实现-1"><i class="fa fa-check"></i><b>10.4.2</b> 在R中的实现</a></li>
<li class="chapter" data-level="10.4.3" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学应用示例-1"><i class="fa fa-check"></i><b>10.4.3</b> 生态学应用示例</a></li>
<li class="chapter" data-level="10.4.4" data-path="高级回归模型.html"><a href="高级回归模型.html#gam在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.4.4</b> GAM在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.4.5" data-path="高级回归模型.html"><a href="高级回归模型.html#高级功能"><i class="fa fa-check"></i><b>10.4.5</b> 高级功能</a></li>
<li class="chapter" data-level="10.4.6" data-path="高级回归模型.html"><a href="高级回归模型.html#模型选择与诊断"><i class="fa fa-check"></i><b>10.4.6</b> 模型选择与诊断</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型"><i class="fa fa-check"></i><b>10.5</b> 混合效应模型</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="高级回归模型.html"><a href="高级回归模型.html#固定效应与随机效应的生态学概念"><i class="fa fa-check"></i><b>10.5.1</b> 固定效应与随机效应的生态学概念</a></li>
<li class="chapter" data-level="10.5.2" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型的数学框架"><i class="fa fa-check"></i><b>10.5.2</b> 混合效应模型的数学框架</a></li>
<li class="chapter" data-level="10.5.3" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的混合效应模型实现"><i class="fa fa-check"></i><b>10.5.3</b> R语言中的混合效应模型实现</a></li>
<li class="chapter" data-level="10.5.4" data-path="高级回归模型.html"><a href="高级回归模型.html#固定效应和随机效应的筛选"><i class="fa fa-check"></i><b>10.5.4</b> 固定效应和随机效应的筛选</a></li>
<li class="chapter" data-level="10.5.5" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.5.5</b> 混合效应模型在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.5.6" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项"><i class="fa fa-check"></i><b>10.5.6</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型"><i class="fa fa-check"></i><b>10.6</b> 时空自相关模型</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型与混合效应模型的联系与区别"><i class="fa fa-check"></i><b>10.6.1</b> 时空自相关模型与混合效应模型的联系与区别</a></li>
<li class="chapter" data-level="10.6.2" data-path="高级回归模型.html"><a href="高级回归模型.html#空间自相关与时间自相关的生态学概念"><i class="fa fa-check"></i><b>10.6.2</b> 空间自相关与时间自相关的生态学概念</a></li>
<li class="chapter" data-level="10.6.3" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型的数学框架"><i class="fa fa-check"></i><b>10.6.3</b> 时空自相关模型的数学框架</a></li>
<li class="chapter" data-level="10.6.4" data-path="高级回归模型.html"><a href="高级回归模型.html#时空模型框架的联系与区别"><i class="fa fa-check"></i><b>10.6.4</b> 时空模型框架的联系与区别</a></li>
<li class="chapter" data-level="10.6.5" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的时空自相关模型实现"><i class="fa fa-check"></i><b>10.6.5</b> R语言中的时空自相关模型实现</a></li>
<li class="chapter" data-level="10.6.6" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型的生态学应用"><i class="fa fa-check"></i><b>10.6.6</b> 时空自相关模型的生态学应用</a></li>
<li class="chapter" data-level="10.6.7" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项-1"><i class="fa fa-check"></i><b>10.6.7</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型"><i class="fa fa-check"></i><b>10.7</b> 结构方程模型</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型的基本框架"><i class="fa fa-check"></i><b>10.7.1</b> 结构方程模型的基本框架</a></li>
<li class="chapter" data-level="10.7.2" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的结构方程模型实现"><i class="fa fa-check"></i><b>10.7.2</b> R语言中的结构方程模型实现</a></li>
<li class="chapter" data-level="10.7.3" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.7.3</b> 结构方程模型在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.7.4" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项-2"><i class="fa fa-check"></i><b>10.7.4</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="高级回归模型.html"><a href="高级回归模型.html#总结-9"><i class="fa fa-check"></i><b>10.8</b> 总结</a></li>
<li class="chapter" data-level="10.9" data-path="高级回归模型.html"><a href="高级回归模型.html#综合练习-8"><i class="fa fa-check"></i><b>10.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="机器学习.html"><a href="机器学习.html"><i class="fa fa-check"></i><b>11</b> 机器学习</a>
<ul>
<li class="chapter" data-level="11.1" data-path="机器学习.html"><a href="机器学习.html#引言-10"><i class="fa fa-check"></i><b>11.1</b> 引言</a></li>
<li class="chapter" data-level="11.2" data-path="机器学习.html"><a href="机器学习.html#决策树"><i class="fa fa-check"></i><b>11.2</b> 决策树</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与原理"><i class="fa fa-check"></i><b>11.2.1</b> 基本概念与原理</a></li>
<li class="chapter" data-level="11.2.2" data-path="机器学习.html"><a href="机器学习.html#决策树构建原理"><i class="fa fa-check"></i><b>11.2.2</b> 决策树构建原理</a></li>
<li class="chapter" data-level="11.2.3" data-path="机器学习.html"><a href="机器学习.html#分类树classification-trees"><i class="fa fa-check"></i><b>11.2.3</b> 分类树（Classification Trees）</a></li>
<li class="chapter" data-level="11.2.4" data-path="机器学习.html"><a href="机器学习.html#回归树regression-trees"><i class="fa fa-check"></i><b>11.2.4</b> 回归树（Regression Trees）</a></li>
<li class="chapter" data-level="11.2.5" data-path="机器学习.html"><a href="机器学习.html#分类树与回归树的比较"><i class="fa fa-check"></i><b>11.2.5</b> 分类树与回归树的比较</a></li>
<li class="chapter" data-level="11.2.6" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-3"><i class="fa fa-check"></i><b>11.2.6</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.2.7" data-path="机器学习.html"><a href="机器学习.html#优势与局限"><i class="fa fa-check"></i><b>11.2.7</b> 优势与局限</a></li>
<li class="chapter" data-level="11.2.8" data-path="机器学习.html"><a href="机器学习.html#r代码实现示例"><i class="fa fa-check"></i><b>11.2.8</b> R代码实现示例</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="机器学习.html"><a href="机器学习.html#随机森林"><i class="fa fa-check"></i><b>11.3</b> 随机森林</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="机器学习.html"><a href="机器学习.html#决策树与随机森林的关系"><i class="fa fa-check"></i><b>11.3.1</b> 决策树与随机森林的关系</a></li>
<li class="chapter" data-level="11.3.2" data-path="机器学习.html"><a href="机器学习.html#随机森林的三个随机"><i class="fa fa-check"></i><b>11.3.2</b> 随机森林的三个随机</a></li>
<li class="chapter" data-level="11.3.3" data-path="机器学习.html"><a href="机器学习.html#数学定义与原理"><i class="fa fa-check"></i><b>11.3.3</b> 数学定义与原理</a></li>
<li class="chapter" data-level="11.3.4" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理"><i class="fa fa-check"></i><b>11.3.4</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.3.5" data-path="机器学习.html"><a href="机器学习.html#r代码实现"><i class="fa fa-check"></i><b>11.3.5</b> R代码实现</a></li>
<li class="chapter" data-level="11.3.6" data-path="机器学习.html"><a href="机器学习.html#代码详细说明"><i class="fa fa-check"></i><b>11.3.6</b> 代码详细说明</a></li>
<li class="chapter" data-level="11.3.7" data-path="机器学习.html"><a href="机器学习.html#模型评估与验证"><i class="fa fa-check"></i><b>11.3.7</b> 模型评估与验证</a></li>
<li class="chapter" data-level="11.3.8" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-4"><i class="fa fa-check"></i><b>11.3.8</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.3.9" data-path="机器学习.html"><a href="机器学习.html#生态学应用价值-1"><i class="fa fa-check"></i><b>11.3.9</b> 生态学应用价值</a></li>
<li class="chapter" data-level="11.3.10" data-path="机器学习.html"><a href="机器学习.html#优势与局限的深入分析"><i class="fa fa-check"></i><b>11.3.10</b> 优势与局限的深入分析</a></li>
<li class="chapter" data-level="11.3.11" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望"><i class="fa fa-check"></i><b>11.3.11</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="机器学习.html"><a href="机器学习.html#支持向量机"><i class="fa fa-check"></i><b>11.4</b> 支持向量机</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与几何直觉"><i class="fa fa-check"></i><b>11.4.1</b> 基本概念与几何直觉</a></li>
<li class="chapter" data-level="11.4.2" data-path="机器学习.html"><a href="机器学习.html#数学原理与核心概念"><i class="fa fa-check"></i><b>11.4.2</b> 数学原理与核心概念</a></li>
<li class="chapter" data-level="11.4.3" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理-1"><i class="fa fa-check"></i><b>11.4.3</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.4.4" data-path="机器学习.html"><a href="机器学习.html#r代码实现-1"><i class="fa fa-check"></i><b>11.4.4</b> R代码实现</a></li>
<li class="chapter" data-level="11.4.5" data-path="机器学习.html"><a href="机器学习.html#代码详细说明-1"><i class="fa fa-check"></i><b>11.4.5</b> 代码详细说明</a></li>
<li class="chapter" data-level="11.4.6" data-path="机器学习.html"><a href="机器学习.html#模型评估与验证-1"><i class="fa fa-check"></i><b>11.4.6</b> 模型评估与验证</a></li>
<li class="chapter" data-level="11.4.7" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-5"><i class="fa fa-check"></i><b>11.4.7</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.4.8" data-path="机器学习.html"><a href="机器学习.html#优势与局限-1"><i class="fa fa-check"></i><b>11.4.8</b> 优势与局限</a></li>
<li class="chapter" data-level="11.4.9" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望-1"><i class="fa fa-check"></i><b>11.4.9</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="机器学习.html"><a href="机器学习.html#深度神经网络"><i class="fa fa-check"></i><b>11.5</b> 深度神经网络</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与生物学启发"><i class="fa fa-check"></i><b>11.5.1</b> 基本概念与生物学启发</a></li>
<li class="chapter" data-level="11.5.2" data-path="机器学习.html"><a href="机器学习.html#主要神经网络架构"><i class="fa fa-check"></i><b>11.5.2</b> 主要神经网络架构</a></li>
<li class="chapter" data-level="11.5.3" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理-2"><i class="fa fa-check"></i><b>11.5.3</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.5.4" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-6"><i class="fa fa-check"></i><b>11.5.4</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.5.5" data-path="机器学习.html"><a href="机器学习.html#优势与局限-2"><i class="fa fa-check"></i><b>11.5.5</b> 优势与局限</a></li>
<li class="chapter" data-level="11.5.6" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望-2"><i class="fa fa-check"></i><b>11.5.6</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="机器学习.html"><a href="机器学习.html#总结-10"><i class="fa fa-check"></i><b>11.6</b> 总结</a></li>
<li class="chapter" data-level="11.7" data-path="机器学习.html"><a href="机器学习.html#综合练习-9"><i class="fa fa-check"></i><b>11.7</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html"><i class="fa fa-check"></i><b>12</b> 附录1 R语言编程基础</a>
<ul>
<li class="chapter" data-level="12.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言介绍"><i class="fa fa-check"></i><b>12.1</b> R语言介绍</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#为什么生态学专业需要学习r"><i class="fa fa-check"></i><b>12.1.1</b> 为什么生态学专业需要学习R？</a></li>
<li class="chapter" data-level="12.1.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言简介与趣味应用"><i class="fa fa-check"></i><b>12.1.2</b> R语言简介与趣味应用</a></li>
<li class="chapter" data-level="12.1.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#环境设置和配置"><i class="fa fa-check"></i><b>12.1.3</b> 环境设置和配置</a></li>
<li class="chapter" data-level="12.1.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#项目文件夹结构设置"><i class="fa fa-check"></i><b>12.1.4</b> 项目文件夹结构设置</a></li>
<li class="chapter" data-level="12.1.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#基本包管理"><i class="fa fa-check"></i><b>12.1.5</b> 基本包管理</a></li>
<li class="chapter" data-level="12.1.6" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#工作目录设置"><i class="fa fa-check"></i><b>12.1.6</b> 工作目录设置</a></li>
<li class="chapter" data-level="12.1.7" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课前准备检查清单"><i class="fa fa-check"></i><b>12.1.7</b> 课前准备检查清单</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#数值向量创建与基本统计计算"><i class="fa fa-check"></i><b>12.2</b> 数值向量创建与基本统计计算</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景"><i class="fa fa-check"></i><b>12.2.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.2.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据"><i class="fa fa-check"></i><b>12.2.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.2.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程"><i class="fa fa-check"></i><b>12.2.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.2.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解"><i class="fa fa-check"></i><b>12.2.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.2.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习"><i class="fa fa-check"></i><b>12.2.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#字符型数据处理与向量索引操作"><i class="fa fa-check"></i><b>12.3</b> 字符型数据处理与向量索引操作</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-1"><i class="fa fa-check"></i><b>12.3.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.3.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-1"><i class="fa fa-check"></i><b>12.3.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.3.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-1"><i class="fa fa-check"></i><b>12.3.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.3.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-1"><i class="fa fa-check"></i><b>12.3.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.3.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-1"><i class="fa fa-check"></i><b>12.3.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#数据框结构理解与多类型数据管理"><i class="fa fa-check"></i><b>12.4</b> 数据框结构理解与多类型数据管理</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-2"><i class="fa fa-check"></i><b>12.4.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.4.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-2"><i class="fa fa-check"></i><b>12.4.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.4.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-2"><i class="fa fa-check"></i><b>12.4.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.4.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-2"><i class="fa fa-check"></i><b>12.4.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.4.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-2"><i class="fa fa-check"></i><b>12.4.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#列表数据结构与数据分组管理"><i class="fa fa-check"></i><b>12.5</b> 列表数据结构与数据分组管理</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-3"><i class="fa fa-check"></i><b>12.5.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.5.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-3"><i class="fa fa-check"></i><b>12.5.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.5.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-3"><i class="fa fa-check"></i><b>12.5.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.5.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-3"><i class="fa fa-check"></i><b>12.5.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.5.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-3"><i class="fa fa-check"></i><b>12.5.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#外部数据导入与条件筛选分析"><i class="fa fa-check"></i><b>12.6</b> 外部数据导入与条件筛选分析</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-4"><i class="fa fa-check"></i><b>12.6.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.6.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据文件bird_monitoring.csv"><i class="fa fa-check"></i><b>12.6.2</b> 演示数据文件（bird_monitoring.csv）</a></li>
<li class="chapter" data-level="12.6.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-4"><i class="fa fa-check"></i><b>12.6.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.6.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-4"><i class="fa fa-check"></i><b>12.6.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.6.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-4"><i class="fa fa-check"></i><b>12.6.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#缺失值和异常值的识别处理"><i class="fa fa-check"></i><b>12.7</b> 缺失值和异常值的识别处理</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-5"><i class="fa fa-check"></i><b>12.7.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.7.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-4"><i class="fa fa-check"></i><b>12.7.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.7.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-5"><i class="fa fa-check"></i><b>12.7.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.7.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-5"><i class="fa fa-check"></i><b>12.7.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.7.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-5"><i class="fa fa-check"></i><b>12.7.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#描述性统计分析与基础数据可视化"><i class="fa fa-check"></i><b>12.8</b> 描述性统计分析与基础数据可视化</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-6"><i class="fa fa-check"></i><b>12.8.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.8.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-5"><i class="fa fa-check"></i><b>12.8.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.8.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-6"><i class="fa fa-check"></i><b>12.8.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.8.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-6"><i class="fa fa-check"></i><b>12.8.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.8.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-6"><i class="fa fa-check"></i><b>12.8.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#条件判断循环结构与函数编程"><i class="fa fa-check"></i><b>12.9</b> 条件判断、循环结构与函数编程</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-7"><i class="fa fa-check"></i><b>12.9.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.9.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-6"><i class="fa fa-check"></i><b>12.9.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.9.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-7"><i class="fa fa-check"></i><b>12.9.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.9.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-7"><i class="fa fa-check"></i><b>12.9.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.9.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-7"><i class="fa fa-check"></i><b>12.9.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#现代数据科学工具包应用"><i class="fa fa-check"></i><b>12.10</b> 现代数据科学工具包应用</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-8"><i class="fa fa-check"></i><b>12.10.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.10.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-7"><i class="fa fa-check"></i><b>12.10.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.10.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-8"><i class="fa fa-check"></i><b>12.10.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.10.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-8"><i class="fa fa-check"></i><b>12.10.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.10.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-8"><i class="fa fa-check"></i><b>12.10.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#图形语法与科学绘图"><i class="fa fa-check"></i><b>12.11</b> 图形语法与科学绘图</a>
<ul>
<li class="chapter" data-level="12.11.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-9"><i class="fa fa-check"></i><b>12.11.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.11.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-8"><i class="fa fa-check"></i><b>12.11.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.11.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-9"><i class="fa fa-check"></i><b>12.11.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.11.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-9"><i class="fa fa-check"></i><b>12.11.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.11.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-9"><i class="fa fa-check"></i><b>12.11.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.12" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#综合练习-10"><i class="fa fa-check"></i><b>12.12</b> 综合练习</a>
<ul>
<li class="chapter" data-level="12.12.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习1-1"><i class="fa fa-check"></i><b>12.12.1</b> 练习1</a></li>
<li class="chapter" data-level="12.12.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习2"><i class="fa fa-check"></i><b>12.12.2</b> 练习2</a></li>
<li class="chapter" data-level="12.12.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习3"><i class="fa fa-check"></i><b>12.12.3</b> 练习3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://gitee.com/gcshen/ecological-statistics" target="blank">Gitee</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">生态统计学</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="基于经典分布的假设检验" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> 基于经典分布的假设检验<a href="基于经典分布的假设检验.html#基于经典分布的假设检验" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="引言-5" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> 引言<a href="基于经典分布的假设检验.html#引言-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在生态学研究的广阔领域中，我们常常面临这样的困境：当我们观察到某种现象时，如何判断这是真实的生态规律还是偶然的随机波动？当我们实施某种保护措施后，如何确定它确实产生了预期的效果？这些问题正是统计假设检验所要回答的核心问题。</p>
<p><strong>本章内容概览</strong>：本章将系统介绍<strong>经典假设检验方法</strong>，包括参数检验和传统非参数检验。这些方法是生态统计学的基础，为生态学家提供了在不确定性中做出科学判断的严谨框架。我们将从假设检验的基本概念开始，逐步深入到各种具体的检验方法，包括单样本检验、双样本检验、多样本检验，以及功效分析等关键技术。这些经典方法构成了生态学研究中统计推断的基石，为后续学习更现代的统计方法奠定坚实基础。</p>
<p>假设检验作为生态统计学的基石，是连接生态学理论与实证数据的桥梁。它为我们提供了一套严谨的数学框架，帮助我们在充满不确定性的自然系统中做出科学的判断。对于生态学本科生而言，掌握假设检验不仅意味着学会一种统计技术，更意味着获得了一种科学的思维方式，一种在复杂生态系统中识别真实信号的能力。</p>
<p>想象一下，你正在研究某自然保护区内的梅花鹿种群动态。经过多年的禁猎保护，你观察到种群数量有所上升。但这是保护措施的真实效果，还是种群自然波动的结果？通过假设检验，我们可以将这个问题转化为一个统计问题：比较禁猎前后的种群数量是否存在显著差异。使用配对t检验，我们可以计算出在假设保护措施无效的情况下，观察到当前或更极端差异的概率。如果这个概率足够小（通常小于5%），我们就有理由相信保护措施确实产生了效果。这种从”看起来像”到”统计上显著”的转变，正是假设检验赋予生态学研究的科学严谨性——它就像一把精密的雕刻刀，帮助我们在混沌的自然数据中雕琢出真实的生态规律。</p>
<p>生态学研究本质上是在噪声中寻找信号的过程。自然系统充满了变异——季节变化、随机事件、测量误差等等。假设检验帮助我们区分哪些模式是真实的生态过程，哪些只是随机波动的产物。例如，在研究不同森林类型对鸟类多样性的影响时，我们可能会观察到阔叶林中的鸟类种类似乎比针叶林更多。但这是真实的生态差异，还是抽样偶然性的结果？通过设定零假设（两种森林类型的鸟类多样性无差异）和备择假设（阔叶林多样性更高），然后收集数据并进行t检验或方差分析，我们可以基于统计证据得出科学结论。这种基于证据而非直觉的判断方式，是现代生态学研究的核心特征。</p>
<p>假设检验的应用贯穿生态学的各个领域。在物种保护中，我们需要检验保护措施是否真的提高了濒危物种的存活率；在入侵生态学中，我们需要判断外来物种是否对本地群落产生了显著影响；在污染生态学中，我们需要评估污染物排放对水生生物多样性的影响程度；在气候变化研究中，我们需要检验温度升高是否确实改变了物种的物候期。每一个生态学问题的背后，都隐藏着一个或多个需要检验的假设。</p>
<p>更重要的是，假设检验不仅仅是在数据收集后进行的分析工具，它还在研究设计阶段发挥着关键作用。通过功效分析，我们可以在研究开始前就评估检测预期效应的可能性。这帮助我们确定合理的样本量——避免样本过小导致无法检测真实效应，也避免样本过大造成资源浪费。例如，在设计一个检验施肥对草地生产力影响的实验时，我们可以基于预期的效应大小、可接受的错误率和期望的统计功效，计算出需要多少个重复样方。这种前瞻性的思考方式，使得我们的研究更加高效和可靠。</p>
<p>在现代生态学的学术交流中，假设检验已经成为一种标准语言。无论是撰写科研论文、参加学术会议，还是评审他人研究，对假设检验的理解都是必不可少的。生态学期刊要求研究者明确陈述他们的科学假设，选择适当的统计检验方法，正确解释p值、置信区间等统计概念，并对多重比较进行必要的校正。这些要求不仅确保了研究的科学严谨性，也促进了生态学知识的积累和进步。</p>
<p>学习假设检验的过程，实际上是在培养一种批判性的科学思维方式。它教会我们如何评估证据的强度，如何区分相关性和因果关系，如何理解统计结论的概率性质。当我们看到”p &lt; 0.05”的结果时，我们学会的不仅仅是如何解释这个数字，更重要的是理解这意味着什么——我们有证据反对零假设，但这种证据不是绝对的，而是基于概率的。这种对不确定性的认识，对”显著”结果保持合理怀疑的态度，是优秀生态学家的重要品质。就像一位经验丰富的生态学家在观察自然现象时既保持开放又保持谨慎一样，统计假设检验教会我们在数据海洋中航行时既要有发现的勇气，也要有质疑的智慧。</p>
<p>让我们通过一个完整的生态学实例来体会假设检验的实际应用。假设我们要研究施肥对草地生产力的影响，我们设计了一个随机化实验：随机分配一半样方接受施肥处理，另一半作为对照。经过一个生长季的观测，我们测量了所有样方的生物量。使用独立样本t检验比较两组的生物量差异，如果得到p &lt; 0.05的结果，我们有统计证据表明施肥确实提高了草地生产力。但优秀的生态学家不会止步于此——他们还会考虑效应大小（施肥带来的实际增产幅度）、置信区间（效应估计的不确定性范围），以及这个结果的生态学意义。这种全面的思考方式，正是假设检验训练所要达到的目标。</p>
<p>通过本章的学习，生态学本科生将逐步掌握假设检验的核心概念和方法。我们将从经典的参数检验（如t检验、方差分析）开始，了解它们的基本原理和适用条件；然后探讨非参数检验方法，应对生态数据中常见的非正态分布情况；我们还将学习多重比较校正技术，避免在同时进行多个检验时产生假阳性结果；最后，我们将介绍功效分析的概念，学习如何在研究设计阶段就确保我们的研究有足够的检测力。</p>
<p>假设检验不仅是一套统计工具，更是一种科学的思维方式。它帮助我们在复杂的自然系统中发现规律，在充满不确定性的生态过程中做出明智的判断。掌握假设检验，意味着你不仅学会了如何分析数据，更重要的是学会了如何像生态学家一样思考——严谨、批判、基于证据。这种能力将伴随你的整个科学生涯，无论你将来从事生态研究、环境保护还是资源管理，都将受益无穷。</p>
<p>在接下来的章节中，我们将深入探讨各种假设检验方法的具体应用，通过丰富的生态学实例，帮助你建立起运用统计工具解决实际生态问题的能力。让我们开始这段探索统计推断与生态规律交汇之处的旅程吧——这是一段从直觉走向证据、从猜测走向确信的科学探索之旅。</p>
<div id="假设检验基础" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> 假设检验基础<a href="基于经典分布的假设检验.html#假设检验基础" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="假设检验的基本步骤" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> 假设检验的基本步骤<a href="基于经典分布的假设检验.html#假设检验的基本步骤" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>假设检验虽然在不同情境下使用不同的统计方法，但都遵循一个通用的基本流程。理解这个通用流程有助于我们从更宏观的角度把握假设检验的本质，无论面对何种统计检验方法，都能保持清晰的思路。</p>
<p><strong>假设检验的通用流程</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>明确研究问题与假设设定</strong>
<ul>
<li>将生态学问题转化为统计问题</li>
<li>设定零假设（<span class="math inline">\(H_0\)</span>）和备择假设（<span class="math inline">\(H_1\)</span>）（详见下文零假设与备择假设小节）</li>
<li>确定检验类型（单侧或双侧）（详见下文零假设与备择假设小节）</li>
</ul></li>
<li><strong>选择适当的统计检验方法</strong>
<ul>
<li><strong>经典参数检验</strong>：基于理论分布（如t检验、F检验、<span class="math inline">\(\chi^2\)</span>检验）（详见下文单样本检验、双样本检验、多样本检验小节）</li>
<li><strong>非参数检验</strong>：不依赖分布假设（如符号检验、秩和检验）（详见下文非参数检验方法小节）</li>
<li><strong>模拟方法</strong>：基于随机化或重抽样（如置换检验、蒙特卡洛检验）（详见下文蒙特卡洛检验小节）</li>
</ul></li>
<li><strong>设定显著性水平（<span class="math inline">\(\alpha\)</span>）</strong>
<ul>
<li>通常设定为0.05，表示愿意接受5%的第一类错误风险（详见下文显著性水平小节）</li>
<li>在某些高风险研究中可能使用更严格的水平（如0.01）</li>
</ul></li>
<li><strong>收集数据并计算检验统计量</strong>
<ul>
<li>确保数据质量（独立性、代表性等）</li>
<li>计算适当的检验统计量（详见下文检验统计量与p值小节）</li>
</ul></li>
<li><strong>确定p值或临界值</strong>
<ul>
<li><strong>经典方法</strong>：基于理论分布计算p值（详见下文检验统计量与p值小节）</li>
<li><strong>模拟方法</strong>：通过随机化构建零分布，计算经验p值（详见下文蒙特卡洛检验小节）</li>
</ul></li>
<li><strong>做出统计决策</strong>
<ul>
<li>如果p值 &lt; <span class="math inline">\(\alpha\)</span>，拒绝零假设</li>
<li>如果p值 ≥ <span class="math inline">\(\alpha\)</span>，不拒绝零假设</li>
</ul></li>
<li><strong>解释结果并考虑生态学意义</strong>
<ul>
<li>统计显著性 ≠ 生态学重要性</li>
<li>结合效应大小、置信区间和专业知识（详见下文效应大小与置信区间小节）</li>
<li>考虑研究的局限性和潜在偏差</li>
</ul></li>
</ol>
<p><strong>模拟方法在假设检验中的特殊步骤</strong>：</p>
<p>对于基于模拟的检验方法（如置换检验、蒙特卡洛检验），第5步需要特别处理：</p>
<ol style="list-style-type: decimal">
<li><strong>构建零模型</strong>：根据零假设生成随机数据或重排观测值</li>
<li><strong>重复模拟</strong>：多次重复模拟过程（通常1000-10000次）</li>
<li><strong>构建经验分布</strong>：基于模拟结果构建检验统计量的零分布</li>
<li><strong>计算经验p值</strong>：比较观测统计量与经验分布的位置</li>
</ol>
<p><strong>生态学意义</strong>：这个通用流程体现了科学研究的严谨性。它帮助生态学家在复杂的自然系统中做出基于证据的判断，避免将随机波动误认为生态规律，也避免错过真实的生态效应。无论使用经典检验方法还是模拟方法，这个基本框架都适用，确保我们的统计推断既严谨又具有生态学意义。</p>
<p>让我们通过一个流程图来直观展示这个通用流程：</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:hypothesis-testing-flow-export"></span>
<img src="imgs/hypothesis_testing_flow.png" alt="假设检验通用流程图：展示从明确研究问题到解释结果的完整统计推断过程" width="300" />
<p class="caption">
图6.1: 假设检验通用流程图：展示从明确研究问题到解释结果的完整统计推断过程
</p>
</div>
<p>这个流程图清晰地展示了假设检验的完整过程，特别强调了模拟方法与传统方法的区别。在接下来的章节中，我们将详细探讨各种统计检验方法的具体实施，包括经典参数检验、非参数检验以及基于模拟的现代检验方法在生态学研究中的应用。</p>
</div>
<div id="零假设与备择假设" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> 零假设与备择假设<a href="基于经典分布的假设检验.html#零假设与备择假设" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在生态学研究中，我们常常需要回答这样的问题：某种生态干预是否产生了真实效应？不同生境中的物种多样性是否存在显著差异？某个环境因子是否与物种丰度相关？这些问题的核心都可以通过假设检验来回答。</p>
<p><strong>零假设（H₀）</strong>是统计检验的起点，它通常表示”无效应”、“无差异”或”无关联”的状态。在生态学语境中，零假设可以理解为：</p>
<ul>
<li>保护措施对种群数量没有影响</li>
<li>不同森林类型的鸟类多样性没有差异</li>
<li>污染物浓度与水生生物死亡率无关</li>
<li>气候变化对物候期没有显著影响</li>
</ul>
<p>零假设代表了”维持现状”或”没有新发现”的保守立场。在科学研究中，我们倾向于保守，要求有充分的证据才能推翻零假设。这种保守性体现了科学研究的严谨性——我们不会轻易接受新的发现，除非有强有力的证据支持。就像在生态调查中，我们不会因为看到几只鸟就断言整个种群发生了变化一样，统计检验要求我们保持谨慎和怀疑的态度。</p>
<p><strong>为什么零假设通常是”无效应”状态？</strong></p>
<p>零假设通常设定为”无效应”状态，这背后有着深刻的统计学和科学哲学原因。首先，从科学哲学的角度来看，可证伪性原则要求科学理论必须能够被潜在的证据所证伪。卡尔·波普尔强调的这一原则意味着，零假设作为”无效应”状态具有明确的证伪标准——如果我们观察到足够强的证据表明存在效应，就可以拒绝零假设。相比之下，复杂的零假设往往难以明确证伪，缺乏清晰的证伪标准。</p>
<p>其次，简约性原则（奥卡姆剃刀）在科学推理中起着重要作用。科学倾向于选择最简单的解释，除非有充分的证据支持更复杂的解释。“无效应”是最简单的假设，它不需要引入额外的参数或机制。只有当数据强烈支持时，我们才接受更复杂的备择假设。这种保守的态度有助于防止过度解释和假阳性发现。</p>
<p>从统计检验的逻辑结构来看，假设检验遵循”无罪推定”的逻辑框架。我们首先假设没有效应存在，然后寻找证据来反驳这个假设。这种结构确保了明确的决策标准——我们可以基于p值做出统计决策；可控的错误率——我们能够精确控制第一类错误的概率；以及可计算的概率——在零假设下，检验统计量的分布是已知的，便于计算p值。</p>
<p>数学上的便利性也是重要考量因素。“无效应”的零假设通常对应着已知的概率分布：均值差异为零对应t分布，方差比值为1对应F分布，观测频数等于期望频数对应卡方分布。这些已知分布使得我们可以精确计算p值和临界值，为统计推断提供了坚实的数学基础。</p>
<p>设定”无效应”的零假设还体现了科学的保守精神。我们不会轻易接受新的理论或发现，新理论必须通过严格的证据检验。这种保守性有助于防止假阳性发现和科学研究的过度解读，确保科学知识的稳健积累。</p>
<p>在生态学研究的实际考虑中，自然系统本身就充满了变异和噪声。设定”无效应”的零假设帮助我们区分真实的生态模式与随机波动，避免将偶然的相关性误认为因果关系，确保我们的发现具有统计稳健性。</p>
<p>虽然理论上可以设定更复杂的零假设（如”效应大小为0.5”而非”效应大小为0”），但这会带来诸多问题：难以确定合适的复杂零假设值，检验统计量的分布可能未知，难以解释p值的实际意义，增加了统计检验的主观性。</p>
<p>在某些特殊情况下，我们确实会使用非零的零假设，如等效性检验（检验效应是否小于某个有意义的阈值）、非劣效性检验（在医学试验中检验新疗法是否不劣于标准疗法）或基于先验知识的生物学零假设。然而，在大多数生态学研究中，“无效应”的零假设仍然是最常用和最合适的选择，因为它提供了清晰的统计框架、可解释的结果和稳健的科学推断。</p>
<p><strong>备择假设（H₁）</strong>则是我们想要证明的假设，它表示存在”有效应”、“有差异”或”有关联”。备择假设可以是：</p>
<ul>
<li>保护措施提高了种群数量</li>
<li>阔叶林的鸟类多样性高于针叶林</li>
<li>污染物浓度与水生生物死亡率正相关</li>
<li>气候变化导致物候期提前</li>
</ul>
<p>备择假设可以是<strong>单侧的</strong>（directional）或<strong>双侧的</strong>（non-directional）。单侧备择假设指定了效应的方向（如”施肥提高了生产力”），而双侧备择假设只关心是否存在差异，不指定方向（如”施肥改变了生产力”）。选择单侧还是双侧检验取决于研究问题的具体性质。</p>
<p><strong>生态学意义</strong>：零假设和备择假设的设定直接反映了我们要检验的生态学问题。它们将模糊的生态学疑问转化为明确的统计问题，为后续的数据收集和分析提供了清晰的框架。正确的假设设定是生态学研究成功的关键第一步。</p>
<p>让我们通过一个具体的生态学实例来理解假设设定：</p>
<blockquote>
<p><strong>实例：施肥对草地生产力的影响</strong></p>
<p>假设我们研究施肥对草地生态系统生产力的影响。我们随机分配20个样方，其中10个接受施肥处理，10个作为对照。经过一个生长季，我们测量每个样方的地上生物量。</p>
<ul>
<li><strong>零假设（H₀）</strong>：施肥组和对照组的平均生物量没有差异（μ施肥 = μ对照）</li>
<li><strong>备择假设（H₁）</strong>：施肥组和对照组的平均生物量存在差异（μ施肥 ≠ μ对照）</li>
</ul>
<p>这是一个双侧检验的例子，因为我们没有预设施肥一定会提高生产力（在某些情况下，过度施肥可能反而抑制生长）。</p>
</blockquote>
<p>为了更好地理解零假设与备择假设的分布关系，让我们通过R代码生成一个可视化图表：</p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="基于经典分布的假设检验.html#cb724-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb724-2"><a href="基于经典分布的假设检验.html#cb724-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb724-3"><a href="基于经典分布的假设检验.html#cb724-3" tabindex="-1"></a></span>
<span id="cb724-4"><a href="基于经典分布的假设检验.html#cb724-4" tabindex="-1"></a><span class="co"># 设置随机种子以确保结果可重现</span></span>
<span id="cb724-5"><a href="基于经典分布的假设检验.html#cb724-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb724-6"><a href="基于经典分布的假设检验.html#cb724-6" tabindex="-1"></a></span>
<span id="cb724-7"><a href="基于经典分布的假设检验.html#cb724-7" tabindex="-1"></a><span class="co"># 模拟零假设分布（均值=0）和备择假设分布（均值=2）</span></span>
<span id="cb724-8"><a href="基于经典分布的假设检验.html#cb724-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb724-9"><a href="基于经典分布的假设检验.html#cb724-9" tabindex="-1"></a>null_dist <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb724-10"><a href="基于经典分布的假设检验.html#cb724-10" tabindex="-1"></a>alt_dist <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb724-11"><a href="基于经典分布的假设检验.html#cb724-11" tabindex="-1"></a></span>
<span id="cb724-12"><a href="基于经典分布的假设检验.html#cb724-12" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb724-13"><a href="基于经典分布的假设检验.html#cb724-13" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb724-14"><a href="基于经典分布的假设检验.html#cb724-14" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(null_dist, alt_dist),</span>
<span id="cb724-15"><a href="基于经典分布的假设检验.html#cb724-15" tabindex="-1"></a>  <span class="at">distribution =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;零假设分布 (H₀)&quot;</span>, <span class="st">&quot;备择假设分布 (H₁)&quot;</span>), <span class="at">each =</span> n)</span>
<span id="cb724-16"><a href="基于经典分布的假设检验.html#cb724-16" tabindex="-1"></a>)</span>
<span id="cb724-17"><a href="基于经典分布的假设检验.html#cb724-17" tabindex="-1"></a></span>
<span id="cb724-18"><a href="基于经典分布的假设检验.html#cb724-18" tabindex="-1"></a><span class="co"># 绘制分布图</span></span>
<span id="cb724-19"><a href="基于经典分布的假设检验.html#cb724-19" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> distribution)) <span class="sc">+</span></span>
<span id="cb724-20"><a href="基于经典分布的假设检验.html#cb724-20" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb724-21"><a href="基于经典分布的假设检验.html#cb724-21" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">1.96</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb724-22"><a href="基于经典分布的假设检验.html#cb724-22" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">2.2</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">label =</span> <span class="st">&quot;临界值&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb724-23"><a href="基于经典分布的假设检验.html#cb724-23" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb724-24"><a href="基于经典分布的假设检验.html#cb724-24" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;零假设与备择假设分布&quot;</span>,</span>
<span id="cb724-25"><a href="基于经典分布的假设检验.html#cb724-25" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;检验统计量&quot;</span>, <span class="at">y =</span> <span class="st">&quot;密度&quot;</span>,</span>
<span id="cb724-26"><a href="基于经典分布的假设检验.html#cb724-26" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;红色虚线表示显著性水平α=0.05的临界值&quot;</span></span>
<span id="cb724-27"><a href="基于经典分布的假设检验.html#cb724-27" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb724-28"><a href="基于经典分布的假设检验.html#cb724-28" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb724-29"><a href="基于经典分布的假设检验.html#cb724-29" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1f77b4&quot;</span>, <span class="st">&quot;#ff7f0e&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:null-alternative-distribution"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/null-alternative-distribution-1.png" alt="零假设与备择假设分布比较：展示在零假设和备择假设下检验统计量的概率分布，以及显著性水平的临界值" width="768" />
<p class="caption">
图6.2: 零假设与备择假设分布比较：展示在零假设和备择假设下检验统计量的概率分布，以及显著性水平的临界值
</p>
</div>
<p>这个图表直观展示了在零假设（蓝色）和备择假设（橙色）下的检验统计量分布。红色虚线表示显著性水平α=0.05的临界值，当检验统计量超过这个临界值时，我们就有足够的证据拒绝零假设。</p>
</div>
<div id="检验统计量与p值" class="section level3 hasAnchor" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> 检验统计量与p值<a href="基于经典分布的假设检验.html#检验统计量与p值" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>一旦设定了假设，我们就需要收集数据并计算<strong>检验统计量</strong>。检验统计量是一个基于样本数据计算的数值，它量化了观测数据与零假设的偏离程度。不同的统计检验使用不同的检验统计量：</p>
<ul>
<li><strong>t检验</strong>：使用t统计量，衡量样本均值与理论值（或两个样本均值）的差异相对于抽样误差的大小</li>
<li><strong>方差分析（ANOVA）</strong>：使用F统计量，衡量组间变异与组内变异的比值</li>
<li><strong>卡方检验</strong>：使用χ²统计量，衡量观测频数与期望频数的差异</li>
</ul>
<p>检验统计量的计算公式考虑了样本大小、变异程度等因素，使得不同研究的结果可以进行比较。</p>
<p><strong>p值</strong>是假设检验中最核心的概念之一。p值定义为：在零假设为真的前提下，观测到当前检验统计量值或更极端值的概率。换句话说，p值告诉我们，如果零假设成立，我们有多大可能看到我们实际观测到的数据（或更极端的数据）。</p>
<p>p值的解释需要特别注意：</p>
<ul>
<li>p值<strong>不是</strong>零假设为真的概率</li>
<li>p值<strong>不是</strong>备择假设为真的概率</li>
<li>p值<strong>不是</strong>效应大小的度量</li>
<li>p值<strong>是</strong>在零假设下观测到当前证据强度的概率</li>
</ul>
<p><strong>生态学意义</strong>：p值为我们提供了量化证据强度的工具。一个很小的p值（如p &lt; 0.05）表明，如果零假设成立，我们观测到的数据是非常不可能的。这为我们拒绝零假设提供了统计依据。然而，p值的大小并不直接反映生态学重要性——一个统计上显著的结果可能在生态学上微不足道，反之亦然。就像在生态调查中，我们可能统计上”显著”地发现某种昆虫的数量增加了0.1%，但这样的微小变化在生态系统中可能毫无实际意义。</p>
<p>为了更直观地理解p值的概念，让我们通过R代码生成一个可视化图表：</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="基于经典分布的假设检验.html#cb725-1" tabindex="-1"></a><span class="co"># 模拟在零假设下的检验统计量分布</span></span>
<span id="cb725-2"><a href="基于经典分布的假设检验.html#cb725-2" tabindex="-1"></a>null_test_stats <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb725-3"><a href="基于经典分布的假设检验.html#cb725-3" tabindex="-1"></a></span>
<span id="cb725-4"><a href="基于经典分布的假设检验.html#cb725-4" tabindex="-1"></a><span class="co"># 假设我们观测到的检验统计量是2.5</span></span>
<span id="cb725-5"><a href="基于经典分布的假设检验.html#cb725-5" tabindex="-1"></a>observed_stat <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb725-6"><a href="基于经典分布的假设检验.html#cb725-6" tabindex="-1"></a></span>
<span id="cb725-7"><a href="基于经典分布的假设检验.html#cb725-7" tabindex="-1"></a><span class="co"># 计算p值（单侧检验）</span></span>
<span id="cb725-8"><a href="基于经典分布的假设检验.html#cb725-8" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(observed_stat)</span>
<span id="cb725-9"><a href="基于经典分布的假设检验.html#cb725-9" tabindex="-1"></a></span>
<span id="cb725-10"><a href="基于经典分布的假设检验.html#cb725-10" tabindex="-1"></a><span class="co"># 创建p值可视化数据</span></span>
<span id="cb725-11"><a href="基于经典分布的假设检验.html#cb725-11" tabindex="-1"></a>p_value_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">test_stat =</span> null_test_stats)</span>
<span id="cb725-12"><a href="基于经典分布的假设检验.html#cb725-12" tabindex="-1"></a></span>
<span id="cb725-13"><a href="基于经典分布的假设检验.html#cb725-13" tabindex="-1"></a><span class="co"># 计算密度数据</span></span>
<span id="cb725-14"><a href="基于经典分布的假设检验.html#cb725-14" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">density</span>(null_test_stats)</span>
<span id="cb725-15"><a href="基于经典分布的假设检验.html#cb725-15" tabindex="-1"></a>density_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> density_data<span class="sc">$</span>x, <span class="at">y =</span> density_data<span class="sc">$</span>y)</span>
<span id="cb725-16"><a href="基于经典分布的假设检验.html#cb725-16" tabindex="-1"></a></span>
<span id="cb725-17"><a href="基于经典分布的假设检验.html#cb725-17" tabindex="-1"></a><span class="co"># 绘制p值可视化图</span></span>
<span id="cb725-18"><a href="基于经典分布的假设检验.html#cb725-18" tabindex="-1"></a><span class="fu">ggplot</span>(p_value_df, <span class="fu">aes</span>(<span class="at">x =</span> test_stat)) <span class="sc">+</span></span>
<span id="cb725-19"><a href="基于经典分布的假设检验.html#cb725-19" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb725-20"><a href="基于经典分布的假设检验.html#cb725-20" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> observed_stat, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb725-21"><a href="基于经典分布的假设检验.html#cb725-21" tabindex="-1"></a>  <span class="fu">geom_area</span>(</span>
<span id="cb725-22"><a href="基于经典分布的假设检验.html#cb725-22" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(density_df, x <span class="sc">&gt;=</span> observed_stat),</span>
<span id="cb725-23"><a href="基于经典分布的假设检验.html#cb725-23" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb725-24"><a href="基于经典分布的假设检验.html#cb725-24" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb725-25"><a href="基于经典分布的假设检验.html#cb725-25" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb725-26"><a href="基于经典分布的假设检验.html#cb725-26" tabindex="-1"></a>    <span class="at">x =</span> observed_stat <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.1</span>,</span>
<span id="cb725-27"><a href="基于经典分布的假设检验.html#cb725-27" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;观测统计量 =&quot;</span>, <span class="fu">round</span>(observed_stat, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb725-28"><a href="基于经典分布的假设检验.html#cb725-28" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb725-29"><a href="基于经典分布的假设检验.html#cb725-29" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb725-30"><a href="基于经典分布的假设检验.html#cb725-30" tabindex="-1"></a>    <span class="at">x =</span> observed_stat <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.08</span>,</span>
<span id="cb725-31"><a href="基于经典分布的假设检验.html#cb725-31" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;p值 =&quot;</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>)), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb725-32"><a href="基于经典分布的假设检验.html#cb725-32" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb725-33"><a href="基于经典分布的假设检验.html#cb725-33" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb725-34"><a href="基于经典分布的假设检验.html#cb725-34" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;p值的可视化解释&quot;</span>,</span>
<span id="cb725-35"><a href="基于经典分布的假设检验.html#cb725-35" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;检验统计量（在零假设下）&quot;</span>, <span class="at">y =</span> <span class="st">&quot;密度&quot;</span>,</span>
<span id="cb725-36"><a href="基于经典分布的假设检验.html#cb725-36" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;红色区域表示p值：在H₀下观测到当前或更极端结果的概率&quot;</span></span>
<span id="cb725-37"><a href="基于经典分布的假设检验.html#cb725-37" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb725-38"><a href="基于经典分布的假设检验.html#cb725-38" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:p-value-visualization"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/p-value-visualization-1.png" alt="p值的可视化解释：通过概率密度函数展示p值作为在零假设下观测到当前或更极端检验统计量的概率" width="768" />
<p class="caption">
图6.3: p值的可视化解释：通过概率密度函数展示p值作为在零假设下观测到当前或更极端检验统计量的概率
</p>
</div>
<p>这个图表通过红色区域直观展示了p值的概念，即在零假设下观测到当前检验统计量值（红色垂直线）或更极端值的概率。p值越小，表明观测到的数据在零假设下越不可能发生，从而为我们拒绝零假设提供了更强的证据。</p>
</div>
<div id="显著性水平" class="section level3 hasAnchor" number="6.1.5">
<h3><span class="header-section-number">6.1.5</span> 显著性水平<a href="基于经典分布的假设检验.html#显著性水平" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>显著性水平（α）</strong>是我们在检验开始前设定的阈值，用于决定何时拒绝零假设。常用的显著性水平是α = 0.05，这意味着我们愿意接受5%的错误拒绝零假设的风险。在某些更严格的研究中，也可能使用α = 0.01或更小的值。</p>
<p>显著性水平的选择涉及<strong>第一类错误</strong>和<strong>第二类错误</strong>的权衡，这是假设检验中最容易混淆但至关重要的概念。</p>
<p><strong>第一类错误</strong>，也称为假阳性错误，发生在零假设实际上为真时，我们却错误地拒绝了它。这相当于”冤枉好人”的情况——我们错误地宣称存在某种效应或差异，而实际上这种效应或差异并不存在。第一类错误的概率由显著性水平α直接控制。当我们设定α = 0.05时，意味着即使零假设为真，我们也有5%的概率会错误地拒绝它。在生态学研究中，第一类错误可能导致我们错误地宣称某种保护措施有效、某个物种对环境变化敏感，或者某个污染物具有生态毒性，而实际上这些都是随机波动造成的假象。</p>
<p><strong>第二类错误</strong>，也称为假阴性错误，发生在备择假设实际上为真时，我们却错误地接受了零假设。这相当于”放过坏人”的情况——我们未能检测到真实存在的效应或差异。第二类错误的概率用β表示，其补数1-β就是统计功效，即正确检测到真实效应的概率。在生态学研究中，第二类错误可能导致我们错过真实的保护效应、未能发现物种对环境变化的真实响应，或者低估污染物的生态风险。就像在生态监测中，我们可能因为样本量不足而错过濒危物种的真实恢复趋势，导致保护措施被过早放弃。</p>
<p>这两类错误在生态学研究中具有不同的后果和重要性。第一类错误的后果往往是浪费资源——我们可能基于错误的发现投入大量人力物力去实施无效的保护措施，或者制定不必要的环境管制政策。例如，如果我们错误地宣称某种农药对非靶标昆虫有害（第一类错误），可能导致农民放弃使用有效的害虫控制方法，造成经济损失。</p>
<p>相比之下，第二类错误的后果往往是错失机会——我们可能因为未能检测到真实效应而错过重要的保护机会，或者忽视真实的环境风险。例如，如果我们未能检测到某种污染物对水生生物的真实毒性（第二类错误），可能导致生态系统持续受到损害，甚至造成不可逆的生态破坏。</p>
<p>在保护生物学研究中，第二类错误的后果往往比第一类错误更为严重。错过一个真实的保护效应意味着濒危物种可能继续面临威胁，生态系统可能持续退化。因此，在保护生物学中，我们可能愿意接受更高的α水平（如0.10）来降低第二类错误的风险，确保不会错过重要的保护机会。</p>
<p>相反，在涉及重大政策决策或资源分配的研究中，第一类错误的后果可能更为严重。例如，在评估某种新型农药的环境安全性时，错误地宣称其安全（第二类错误）可能导致广泛的生态破坏，而错误地宣称其有害（第一类错误）可能只是造成一些经济损失。在这种情况下，我们可能选择更严格的α水平（如0.01）来减少假阳性的风险。</p>
<p>让我们通过决策矩阵来系统理解这两类错误：</p>
<table>
<thead>
<tr class="header">
<th>统计决策  真实情况</th>
<th>零假设为真</th>
<th>备择假设为真</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>拒绝零假设</td>
<td>第一类错误（α）</td>
<td>正确决策（1-β）</td>
</tr>
<tr class="even">
<td>不拒绝零假设</td>
<td>正确决策（1-α）</td>
<td>第二类错误（β）</td>
</tr>
</tbody>
</table>
<p>其中β是第二类错误的概率，<strong>统计功效</strong>（1-β）是正确拒绝错误零假设的概率。这个矩阵清晰地展示了统计决策与真实情况之间的关系，帮助我们理解在什么情况下我们的决策是正确的，在什么情况下会犯错误。</p>
<p>在实际的生态学研究中，我们需要根据具体研究问题的性质在这两类错误之间进行权衡。这种权衡不仅涉及统计考量，还涉及生态学、经济学和社会学的多方面因素。优秀的生态学家会综合考虑这些因素，选择适当的显著性水平，并在解释研究结果时充分考虑两类错误的潜在影响。</p>
<p>让我们通过几个具体的生态学案例来进一步理解这两类错误的实际意义：</p>
<p><strong>案例一：入侵物种风险评估</strong> 假设我们研究某种外来植物是否会对本地生态系统造成危害。零假设是该植物不会对本地生态系统产生显著影响。如果我们错误地拒绝这个零假设（第一类错误），我们可能会投入大量资源去控制一个实际上无害的物种，造成不必要的经济损失。如果我们错误地接受这个零假设（第二类错误），我们可能会忽视一个真正的生态威胁，导致本地生态系统遭受不可逆的破坏。在这种情况下，第二类错误的后果通常更为严重，因此我们可能愿意接受较高的第一类错误风险来确保不会错过真正的威胁。</p>
<p><strong>案例二：保护措施效果评估</strong> 假设我们评估某种栖息地恢复措施对濒危鸟类种群的影响。零假设是保护措施没有效果。如果我们错误地拒绝这个零假设（第一类错误），我们可能会继续投入资源实施无效的保护措施，浪费有限的保护资金。如果我们错误地接受这个零假设（第二类错误），我们可能会放弃一个真正有效的保护方法，导致濒危物种继续面临威胁。在保护生物学中，第二类错误的后果往往更为严重，因为错过一个有效的保护机会可能意味着物种的灭绝。</p>
<p><strong>案例三：污染物生态毒性研究</strong> 假设我们研究某种工业废水对水生生物的影响。零假设是废水对水生生物没有毒性。如果我们错误地拒绝这个零假设（第一类错误），我们可能会要求企业投入大量资金建设不必要的污水处理设施，增加生产成本。如果我们错误地接受这个零假设（第二类错误），我们可能会允许有毒废水继续排放，导致水生生态系统遭受长期损害。在这种情况下，两类错误的后果都需要认真权衡，通常需要综合考虑生态风险和经济成本。</p>
<p>理解第一类错误和第二类错误的区别对于正确解释统计结果至关重要。当我们看到”p &lt; 0.05”的结果时，我们不仅要知道这提供了拒绝零假设的证据，还要意识到这个结论可能有5%的概率是错误的（第一类错误）。同样，当我们看到”p &gt; 0.05”的结果时，我们不能简单地认为”没有效应”，而应该考虑第二类错误的可能性——也许效应确实存在，但我们的研究没有足够的统计功效来检测它。</p>
<p><strong>为什么第一类错误通常控制在0.05水平？</strong></p>
<p>第一类错误水平α = 0.05的选择有着深厚的历史和科学传统。这个标准可以追溯到20世纪早期统计学家罗纳德·费舍尔的工作，他建议使用5%作为判断统计显著性的经验法则。这个选择并非基于严格的数学推导，而是基于实践考虑：5%提供了一个合理的平衡点，既不会过于宽松导致过多假阳性，也不会过于严格导致难以发现真实效应。在生态学中，这个标准已经被广泛接受，因为它提供了一个相对保守但又不是过于保守的决策阈值。</p>
<p><strong>为什么第二类错误往往控制得相对更高？</strong></p>
<p>第二类错误水平β通常设定在0.20左右，对应的统计功效为0.80。这意味着我们愿意接受20%的概率错过真实存在的效应。这个选择主要基于以下几个原因：</p>
<p>首先，从实际可行性考虑，要达到更高的统计功效（如0.90或0.95）通常需要极大的样本量，这在生态学研究中往往难以实现。生态学研究常常受到时间、经费和可行性的限制，过高的功效要求可能导致研究无法实施。</p>
<p>其次，从错误后果的权衡来看，在许多生态学情境中，第二类错误的后果虽然严重，但通常不像第一类错误那样会立即导致错误的决策。第一类错误可能直接导致我们实施无效的措施或制定错误的政策，而第二类错误更多是错失机会，这种后果往往可以通过后续研究来弥补。</p>
<p>此外，统计功效为0.80被认为是一个合理的折中点。这意味着我们有80%的概率检测到真实存在的效应，这个水平在大多数研究情境下被认为是足够的。当然，在特定的高风险研究中（如涉及濒危物种保护或重大环境风险评估），我们可能需要更高的功效（如0.90或0.95）。</p>
<p>最后，从资源分配的角度看，将功效从0.80提高到0.90通常需要不成比例地增加样本量。例如，在某些情况下，功效从0.80提高到0.90可能需要样本量增加50%甚至更多，这种投入产出比往往不被认为是合理的。</p>
<p>在生态学研究中，避免这两类错误的最佳策略包括：进行充分的功效分析来确定合适的样本量，使用适当的统计方法，考虑多重比较校正，以及结合效应大小和置信区间来全面评估研究结果。通过这种全面的方法，我们可以在统计严谨性和生态学实用性之间找到平衡，为生态保护和管理决策提供更可靠的科学依据。</p>
<p>为了更好地理解第一类错误和第二类错误的概念，让我们通过R代码生成一个可视化图表：</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="基于经典分布的假设检验.html#cb726-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb726-2"><a href="基于经典分布的假设检验.html#cb726-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co"># 显著性水平</span></span>
<span id="cb726-3"><a href="基于经典分布的假设检验.html#cb726-3" tabindex="-1"></a>effect_size <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="co"># 效应大小</span></span>
<span id="cb726-4"><a href="基于经典分布的假设检验.html#cb726-4" tabindex="-1"></a></span>
<span id="cb726-5"><a href="基于经典分布的假设检验.html#cb726-5" tabindex="-1"></a><span class="co"># 计算临界值（单侧检验）</span></span>
<span id="cb726-6"><a href="基于经典分布的假设检验.html#cb726-6" tabindex="-1"></a>critical_value <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha)</span>
<span id="cb726-7"><a href="基于经典分布的假设检验.html#cb726-7" tabindex="-1"></a></span>
<span id="cb726-8"><a href="基于经典分布的假设检验.html#cb726-8" tabindex="-1"></a><span class="co"># 计算第二类错误概率</span></span>
<span id="cb726-9"><a href="基于经典分布的假设检验.html#cb726-9" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(critical_value, <span class="at">mean =</span> effect_size)</span>
<span id="cb726-10"><a href="基于经典分布的假设检验.html#cb726-10" tabindex="-1"></a></span>
<span id="cb726-11"><a href="基于经典分布的假设检验.html#cb726-11" tabindex="-1"></a><span class="co"># 创建错误类型可视化数据</span></span>
<span id="cb726-12"><a href="基于经典分布的假设检验.html#cb726-12" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb726-13"><a href="基于经典分布的假设检验.html#cb726-13" tabindex="-1"></a>null_density <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x_vals, <span class="at">mean =</span> <span class="dv">0</span>)</span>
<span id="cb726-14"><a href="基于经典分布的假设检验.html#cb726-14" tabindex="-1"></a>alt_density <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x_vals, <span class="at">mean =</span> effect_size)</span>
<span id="cb726-15"><a href="基于经典分布的假设检验.html#cb726-15" tabindex="-1"></a></span>
<span id="cb726-16"><a href="基于经典分布的假设检验.html#cb726-16" tabindex="-1"></a>error_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb726-17"><a href="基于经典分布的假设检验.html#cb726-17" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rep</span>(x_vals, <span class="dv">2</span>),</span>
<span id="cb726-18"><a href="基于经典分布的假设检验.html#cb726-18" tabindex="-1"></a>  <span class="at">density =</span> <span class="fu">c</span>(null_density, alt_density),</span>
<span id="cb726-19"><a href="基于经典分布的假设检验.html#cb726-19" tabindex="-1"></a>  <span class="at">distribution =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;零假设分布&quot;</span>, <span class="st">&quot;备择假设分布&quot;</span>), <span class="at">each =</span> <span class="dv">1000</span>)</span>
<span id="cb726-20"><a href="基于经典分布的假设检验.html#cb726-20" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="基于经典分布的假设检验.html#cb727-1" tabindex="-1"></a><span class="co"># 绘制错误类型可视化图</span></span>
<span id="cb727-2"><a href="基于经典分布的假设检验.html#cb727-2" tabindex="-1"></a><span class="fu">ggplot</span>(error_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density, <span class="at">color =</span> distribution)) <span class="sc">+</span></span>
<span id="cb727-3"><a href="基于经典分布的假设检验.html#cb727-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb727-4"><a href="基于经典分布的假设检验.html#cb727-4" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> critical_value, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb727-5"><a href="基于经典分布的假设检验.html#cb727-5" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb727-6"><a href="基于经典分布的假设检验.html#cb727-6" tabindex="-1"></a>  <span class="co"># 第一类错误区域（假阳性）</span></span>
<span id="cb727-7"><a href="基于经典分布的假设检验.html#cb727-7" tabindex="-1"></a>  <span class="fu">geom_area</span>(</span>
<span id="cb727-8"><a href="基于经典分布的假设检验.html#cb727-8" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(error_df, x <span class="sc">&gt;=</span> critical_value <span class="sc">&amp;</span></span>
<span id="cb727-9"><a href="基于经典分布的假设检验.html#cb727-9" tabindex="-1"></a>                    distribution <span class="sc">==</span> <span class="st">&quot;零假设分布&quot;</span>),</span>
<span id="cb727-10"><a href="基于经典分布的假设检验.html#cb727-10" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span></span>
<span id="cb727-11"><a href="基于经典分布的假设检验.html#cb727-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb727-12"><a href="基于经典分布的假设检验.html#cb727-12" tabindex="-1"></a>  <span class="co"># 第二类错误区域（假阴性）</span></span>
<span id="cb727-13"><a href="基于经典分布的假设检验.html#cb727-13" tabindex="-1"></a>  <span class="fu">geom_area</span>(</span>
<span id="cb727-14"><a href="基于经典分布的假设检验.html#cb727-14" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(error_df, x <span class="sc">&lt;</span> critical_value <span class="sc">&amp;</span></span>
<span id="cb727-15"><a href="基于经典分布的假设检验.html#cb727-15" tabindex="-1"></a>                    distribution <span class="sc">==</span> <span class="st">&quot;备择假设分布&quot;</span>),</span>
<span id="cb727-16"><a href="基于经典分布的假设检验.html#cb727-16" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density), <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span></span>
<span id="cb727-17"><a href="基于经典分布的假设检验.html#cb727-17" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb727-18"><a href="基于经典分布的假设检验.html#cb727-18" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb727-19"><a href="基于经典分布的假设检验.html#cb727-19" tabindex="-1"></a>    <span class="at">x =</span> critical_value <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.1</span>,</span>
<span id="cb727-20"><a href="基于经典分布的假设检验.html#cb727-20" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;第一类错误</span><span class="sc">\n</span><span class="st">α =&quot;</span>, alpha), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb727-21"><a href="基于经典分布的假设检验.html#cb727-21" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb727-22"><a href="基于经典分布的假设检验.html#cb727-22" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb727-23"><a href="基于经典分布的假设检验.html#cb727-23" tabindex="-1"></a>    <span class="at">x =</span> critical_value <span class="sc">-</span> <span class="fl">0.8</span>, <span class="at">y =</span> <span class="fl">0.1</span>,</span>
<span id="cb727-24"><a href="基于经典分布的假设检验.html#cb727-24" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;第二类错误</span><span class="sc">\n</span><span class="st">β =&quot;</span>, <span class="fu">round</span>(beta, <span class="dv">3</span>)), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb727-25"><a href="基于经典分布的假设检验.html#cb727-25" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb727-26"><a href="基于经典分布的假设检验.html#cb727-26" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb727-27"><a href="基于经典分布的假设检验.html#cb727-27" tabindex="-1"></a>    <span class="at">x =</span> critical_value <span class="sc">+</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.2</span>,</span>
<span id="cb727-28"><a href="基于经典分布的假设检验.html#cb727-28" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;统计功效</span><span class="sc">\n</span><span class="st">1-β =&quot;</span>, <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">-</span> beta, <span class="dv">3</span>)),</span>
<span id="cb727-29"><a href="基于经典分布的假设检验.html#cb727-29" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;darkgreen&quot;</span></span>
<span id="cb727-30"><a href="基于经典分布的假设检验.html#cb727-30" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb727-31"><a href="基于经典分布的假设检验.html#cb727-31" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb727-32"><a href="基于经典分布的假设检验.html#cb727-32" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;第一类错误与第二类错误&quot;</span>,</span>
<span id="cb727-33"><a href="基于经典分布的假设检验.html#cb727-33" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;检验统计量&quot;</span>, <span class="at">y =</span> <span class="st">&quot;密度&quot;</span>,</span>
<span id="cb727-34"><a href="基于经典分布的假设检验.html#cb727-34" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;红色：第一类错误（假阳性），蓝色：第二类错误（假阴性）&quot;</span></span>
<span id="cb727-35"><a href="基于经典分布的假设检验.html#cb727-35" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb727-36"><a href="基于经典分布的假设检验.html#cb727-36" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb727-37"><a href="基于经典分布的假设检验.html#cb727-37" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1f77b4&quot;</span>, <span class="st">&quot;#ff7f0e&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:error-types-visualization"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/error-types-visualization-1.png" alt="第一类错误与第二类错误的可视化：展示假阳性（第一类错误）和假阴性（第二类错误）在统计决策中的概率分布" width="768" />
<p class="caption">
图6.4: 第一类错误与第二类错误的可视化：展示假阳性（第一类错误）和假阴性（第二类错误）在统计决策中的概率分布
</p>
</div>
<p>这个图表清晰地显示了第一类错误（红色区域，假阳性）和第二类错误（蓝色区域，假阴性）的概念，以及统计功效（1-β）作为正确检测真实效应的概率。在生态学研究中，我们需要在这两类错误之间进行权衡，根据研究的具体目的选择合适的显著性水平。</p>
<p>统计功效受到多个因素的影响，其中样本量是一个关键因素。让我们通过R代码生成一个图表来展示样本量如何影响统计功效：</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="基于经典分布的假设检验.html#cb728-1" tabindex="-1"></a><span class="co"># 模拟不同样本量下的统计功效</span></span>
<span id="cb728-2"><a href="基于经典分布的假设检验.html#cb728-2" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">10</span>)</span>
<span id="cb728-3"><a href="基于经典分布的假设检验.html#cb728-3" tabindex="-1"></a>effect_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>) <span class="co"># 小、中、大效应</span></span>
<span id="cb728-4"><a href="基于经典分布的假设检验.html#cb728-4" tabindex="-1"></a></span>
<span id="cb728-5"><a href="基于经典分布的假设检验.html#cb728-5" tabindex="-1"></a>power_df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">sample_size =</span> sample_sizes, <span class="at">effect_size =</span> effect_sizes)</span>
<span id="cb728-6"><a href="基于经典分布的假设检验.html#cb728-6" tabindex="-1"></a>power_df<span class="sc">$</span>power <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb728-7"><a href="基于经典分布的假设检验.html#cb728-7" tabindex="-1"></a></span>
<span id="cb728-8"><a href="基于经典分布的假设检验.html#cb728-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(power_df))) {</span>
<span id="cb728-9"><a href="基于经典分布的假设检验.html#cb728-9" tabindex="-1"></a>  n <span class="ot">&lt;-</span> power_df<span class="sc">$</span>sample_size[i]</span>
<span id="cb728-10"><a href="基于经典分布的假设检验.html#cb728-10" tabindex="-1"></a>  d <span class="ot">&lt;-</span> power_df<span class="sc">$</span>effect_size[i]</span>
<span id="cb728-11"><a href="基于经典分布的假设检验.html#cb728-11" tabindex="-1"></a>  <span class="co"># 使用t检验的近似功效计算</span></span>
<span id="cb728-12"><a href="基于经典分布的假设检验.html#cb728-12" tabindex="-1"></a>  power_df<span class="sc">$</span>power[i] <span class="ot">&lt;-</span> <span class="fu">power.t.test</span>(</span>
<span id="cb728-13"><a href="基于经典分布的假设检验.html#cb728-13" tabindex="-1"></a>    <span class="at">n =</span> n, <span class="at">delta =</span> d, <span class="at">sd =</span> <span class="dv">1</span>,</span>
<span id="cb728-14"><a href="基于经典分布的假设检验.html#cb728-14" tabindex="-1"></a>    <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span></span>
<span id="cb728-15"><a href="基于经典分布的假设检验.html#cb728-15" tabindex="-1"></a>  )<span class="sc">$</span>power</span>
<span id="cb728-16"><a href="基于经典分布的假设检验.html#cb728-16" tabindex="-1"></a>}</span>
<span id="cb728-17"><a href="基于经典分布的假设检验.html#cb728-17" tabindex="-1"></a></span>
<span id="cb728-18"><a href="基于经典分布的假设检验.html#cb728-18" tabindex="-1"></a><span class="co"># 绘制样本量对功效的影响图</span></span>
<span id="cb728-19"><a href="基于经典分布的假设检验.html#cb728-19" tabindex="-1"></a><span class="fu">ggplot</span>(power_df, <span class="fu">aes</span>(</span>
<span id="cb728-20"><a href="基于经典分布的假设检验.html#cb728-20" tabindex="-1"></a>  <span class="at">x =</span> sample_size, <span class="at">y =</span> power,</span>
<span id="cb728-21"><a href="基于经典分布的假设检验.html#cb728-21" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">factor</span>(effect_size)</span>
<span id="cb728-22"><a href="基于经典分布的假设检验.html#cb728-22" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb728-23"><a href="基于经典分布的假设检验.html#cb728-23" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb728-24"><a href="基于经典分布的假设检验.html#cb728-24" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb728-25"><a href="基于经典分布的假设检验.html#cb728-25" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span></span>
<span id="cb728-26"><a href="基于经典分布的假设检验.html#cb728-26" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">150</span>, <span class="at">y =</span> <span class="fl">0.82</span>, <span class="at">label =</span> <span class="st">&quot;常用功效阈值 (0.8)&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span></span>
<span id="cb728-27"><a href="基于经典分布的假设检验.html#cb728-27" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb728-28"><a href="基于经典分布的假设检验.html#cb728-28" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;样本量对统计功效的影响&quot;</span>,</span>
<span id="cb728-29"><a href="基于经典分布的假设检验.html#cb728-29" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;每组样本量&quot;</span>, <span class="at">y =</span> <span class="st">&quot;统计功效 (1-β)&quot;</span>,</span>
<span id="cb728-30"><a href="基于经典分布的假设检验.html#cb728-30" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;效应大小 (Cohen&#39;s d)&quot;</span>,</span>
<span id="cb728-31"><a href="基于经典分布的假设检验.html#cb728-31" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;效应大小越大，达到足够统计功效所需的样本量越小&quot;</span></span>
<span id="cb728-32"><a href="基于经典分布的假设检验.html#cb728-32" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb728-33"><a href="基于经典分布的假设检验.html#cb728-33" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb728-34"><a href="基于经典分布的假设检验.html#cb728-34" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1f77b4&quot;</span>, <span class="st">&quot;#ff7f0e&quot;</span>, <span class="st">&quot;#2ca02c&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:power-sample-size-visualization"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/power-sample-size-visualization-1.png" alt="样本量对统计功效的影响：展示在不同效应大小下，样本量增加如何提高统计功效" width="768" />
<p class="caption">
图6.5: 样本量对统计功效的影响：展示在不同效应大小下，样本量增加如何提高统计功效
</p>
</div>
<p>这个图表展示了不同效应大小下，样本量如何影响统计功效。通常我们期望统计功效达到0.8以上（灰色虚线），这意味着我们有80%的概率正确检测到真实存在的效应。从图表可以看出，效应大小越大，达到足够统计功效所需的样本量越小。</p>
<p>在生态学研究中，我们不仅要关注统计显著性，更要考虑<strong>生态学显著性</strong>。一个统计上显著但效应大小很小的结果可能在生态学上并不重要。因此，优秀的生态学家会同时报告p值、效应大小和置信区间，为读者提供全面的信息来评估研究结果的实际意义。</p>
</div>
<div id="效应大小与置信区间" class="section level3 hasAnchor" number="6.1.6">
<h3><span class="header-section-number">6.1.6</span> 效应大小与置信区间<a href="基于经典分布的假设检验.html#效应大小与置信区间" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在生态学研究中，仅仅知道某个效应是否统计显著是不够的。我们还需要了解这个效应有多大（效应大小）以及我们对这个效应的估计有多精确（置信区间）。这两个概念为我们提供了比p值更丰富的信息，帮助我们评估研究结果的生态学重要性。</p>
<p><strong>效应大小（Effect Size）</strong></p>
<p>效应大小是衡量研究结果实际重要性的量化指标，它描述了自变量对因变量的影响程度。与p值不同，效应大小不受样本量的影响，因此能够更直接地反映生态学重要性。</p>
<p>常见的效应大小指标包括：</p>
<ul>
<li><p><strong>Cohen’s d</strong>：用于t检验，表示标准化均值差异 <span class="math display">\[d = \frac{\bar{x}_1 - \bar{x}_2}{s_{pooled}}\]</span> 其中<span class="math inline">\(s_{pooled}\)</span>是合并标准差</p></li>
<li><p><strong><span class="math inline">\(\eta^2\)</span>（eta平方）</strong>：用于方差分析，表示方差解释比例 <span class="math display">\[\eta^2 = \frac{SS_{between}}{SS_{total}}\]</span></p></li>
<li><p><strong><span class="math inline">\(R^2\)</span>（决定系数）</strong>：用于回归分析，表示模型解释的变异比例</p></li>
<li><p><strong>Cramér’s V</strong>：用于卡方检验，表示分类变量间的关联强度</p></li>
</ul>
<p>在生态学研究中，效应大小的解释需要结合具体情境。例如，一个d = 0.2的效应在保护生物学中可能具有重要意义，而在某些生理学研究中可能微不足道。</p>
<p><strong>置信区间（Confidence Interval）</strong></p>
<p>置信区间提供了效应估计的不确定性范围（在之前章节中详细介绍过）。一个95%的置信区间意味着，如果我们重复进行同样的研究100次，大约有95次的置信区间会包含真实的总体参数。</p>
<p>置信区间的生态学意义：</p>
<ol style="list-style-type: decimal">
<li><strong>估计精度</strong>：窄的置信区间表示估计更精确</li>
<li><strong>效应方向</strong>：置信区间是否包含零值（无效应）</li>
<li><strong>生态学重要性</strong>：置信区间是否包含有生态学意义的阈值</li>
</ol>
<p>例如，在研究施肥对草地生产力的影响时，我们可能得到平均增产效应为15 kg/ha，95%置信区间为[10, 20] kg/ha。这个结果告诉我们： - 增产效应是统计显著的（置信区间不包含0） - 真实的增产效应可能在10-20 kg/ha之间 - 这个效应大小在生态学上可能具有重要意义</p>
<p>让我们通过R代码生成一个可视化图表来理解效应大小和置信区间的概念：</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="基于经典分布的假设检验.html#cb729-1" tabindex="-1"></a><span class="co"># 模拟多个研究的效应大小和置信区间</span></span>
<span id="cb729-2"><a href="基于经典分布的假设检验.html#cb729-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb729-3"><a href="基于经典分布的假设检验.html#cb729-3" tabindex="-1"></a>studies <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb729-4"><a href="基于经典分布的假设检验.html#cb729-4" tabindex="-1"></a>effect_sizes <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(studies, <span class="at">mean =</span> <span class="fl">0.5</span>, <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb729-5"><a href="基于经典分布的假设检验.html#cb729-5" tabindex="-1"></a>ci_lower <span class="ot">&lt;-</span> effect_sizes <span class="sc">-</span> <span class="fl">0.4</span> <span class="sc">+</span> <span class="fu">rnorm</span>(studies, <span class="dv">0</span>, <span class="fl">0.1</span>)</span>
<span id="cb729-6"><a href="基于经典分布的假设检验.html#cb729-6" tabindex="-1"></a>ci_upper <span class="ot">&lt;-</span> effect_sizes <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">+</span> <span class="fu">rnorm</span>(studies, <span class="dv">0</span>, <span class="fl">0.1</span>)</span>
<span id="cb729-7"><a href="基于经典分布的假设检验.html#cb729-7" tabindex="-1"></a></span>
<span id="cb729-8"><a href="基于经典分布的假设检验.html#cb729-8" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb729-9"><a href="基于经典分布的假设检验.html#cb729-9" tabindex="-1"></a>study_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb729-10"><a href="基于经典分布的假设检验.html#cb729-10" tabindex="-1"></a>  <span class="at">study =</span> <span class="dv">1</span><span class="sc">:</span>studies,</span>
<span id="cb729-11"><a href="基于经典分布的假设检验.html#cb729-11" tabindex="-1"></a>  <span class="at">effect_size =</span> effect_sizes,</span>
<span id="cb729-12"><a href="基于经典分布的假设检验.html#cb729-12" tabindex="-1"></a>  <span class="at">ci_lower =</span> ci_lower,</span>
<span id="cb729-13"><a href="基于经典分布的假设检验.html#cb729-13" tabindex="-1"></a>  <span class="at">ci_upper =</span> ci_upper,</span>
<span id="cb729-14"><a href="基于经典分布的假设检验.html#cb729-14" tabindex="-1"></a>  <span class="at">significant =</span> (ci_lower <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">|</span> ci_upper <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb729-15"><a href="基于经典分布的假设检验.html#cb729-15" tabindex="-1"></a>)</span>
<span id="cb729-16"><a href="基于经典分布的假设检验.html#cb729-16" tabindex="-1"></a></span>
<span id="cb729-17"><a href="基于经典分布的假设检验.html#cb729-17" tabindex="-1"></a><span class="co"># 绘制效应大小森林图</span></span>
<span id="cb729-18"><a href="基于经典分布的假设检验.html#cb729-18" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb729-19"><a href="基于经典分布的假设检验.html#cb729-19" tabindex="-1"></a><span class="fu">ggplot</span>(study_df, <span class="fu">aes</span>(<span class="at">x =</span> effect_size, <span class="at">y =</span> study)) <span class="sc">+</span></span>
<span id="cb729-20"><a href="基于经典分布的假设检验.html#cb729-20" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span></span>
<span id="cb729-21"><a href="基于经典分布的假设检验.html#cb729-21" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> significant), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb729-22"><a href="基于经典分布的假设检验.html#cb729-22" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ci_lower, <span class="at">xmax =</span> ci_upper, <span class="at">color =</span> significant),</span>
<span id="cb729-23"><a href="基于经典分布的假设检验.html#cb729-23" tabindex="-1"></a>    <span class="at">height =</span> <span class="fl">0.2</span></span>
<span id="cb729-24"><a href="基于经典分布的假设检验.html#cb729-24" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb729-25"><a href="基于经典分布的假设检验.html#cb729-25" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb729-26"><a href="基于经典分布的假设检验.html#cb729-26" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb729-27"><a href="基于经典分布的假设检验.html#cb729-27" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;效应大小与置信区间的森林图&quot;</span>,</span>
<span id="cb729-28"><a href="基于经典分布的假设检验.html#cb729-28" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;效应大小 (Cohen&#39;s d)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;研究编号&quot;</span>,</span>
<span id="cb729-29"><a href="基于经典分布的假设检验.html#cb729-29" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;蓝色点表示统计显著的结果，红色点表示不显著的结果&quot;</span></span>
<span id="cb729-30"><a href="基于经典分布的假设检验.html#cb729-30" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb729-31"><a href="基于经典分布的假设检验.html#cb729-31" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb729-32"><a href="基于经典分布的假设检验.html#cb729-32" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:effect-size-ci-visualization"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/effect-size-ci-visualization-1.png" alt="效应大小与置信区间的可视化：通过森林图展示多个研究的效应大小估计及其不确定性范围" width="768" />
<p class="caption">
图6.6: 效应大小与置信区间的可视化：通过森林图展示多个研究的效应大小估计及其不确定性范围
</p>
</div>
<p>这个图表展示了多个研究的效应大小估计及其置信区间。我们可以清楚地看到哪些研究的结果是统计显著的（置信区间不包含0），以及不同研究的效应大小估计。</p>
<p><strong>生态学意义</strong>：在生态学研究中，同时报告效应大小和置信区间有助于：</p>
<ol style="list-style-type: decimal">
<li><strong>避免过度解读p值</strong>：一个很小的p值可能对应很小的效应大小</li>
<li><strong>促进结果比较</strong>：不同研究的效应大小可以直接比较</li>
<li><strong>指导实践决策</strong>：基于效应大小评估干预措施的生态学重要性</li>
<li><strong>支持元分析</strong>：为后续的综述研究提供必要信息</li>
</ol>
<p>优秀的生态学研究应该同时关注统计显著性和生态学重要性。通过结合p值、效应大小和置信区间，我们能够对研究结果做出更全面、更合理的解释，为生态保护和管理决策提供更可靠的科学依据。</p>
</div>
</div>
<div id="单样本检验" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> 单样本检验<a href="基于经典分布的假设检验.html#单样本检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="单样本t检验" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> 单样本t检验<a href="基于经典分布的假设检验.html#单样本t检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在生态学研究中，我们常常需要检验某个样本的均值是否与特定的理论值或期望值存在显著差异。<strong>单样本t检验</strong>就是用于这种目的的参数检验方法。</p>
<p>单样本t检验的基本思想是比较样本均值与理论值之间的差异是否具有统计显著性。其零假设和备择假设通常设定为：</p>
<ul>
<li><strong>零假设（<span class="math inline">\(H_0\)</span>）</strong>：样本均值等于理论值（<span class="math inline">\(\mu = \mu_0\)</span>）</li>
<li><strong>备择假设（<span class="math inline">\(H_1\)</span>）</strong>：样本均值不等于理论值（<span class="math inline">\(\mu \neq \mu_0\)</span>），或者根据研究问题设定为单侧检验</li>
</ul>
<p>检验统计量<span class="math inline">\(t\)</span>的计算公式为：</p>
<p><span class="math display">\[t = \frac{\bar{x} - \mu_0}{s/\sqrt{n}}\]</span></p>
<p>其中<span class="math inline">\(\bar{x}\)</span>是样本均值，<span class="math inline">\(\mu_0\)</span>是理论值，<span class="math inline">\(s\)</span>是样本标准差，<span class="math inline">\(n\)</span>是样本量。这个统计量服从自由度为<span class="math inline">\(n-1\)</span>的<span class="math inline">\(t\)</span>分布。</p>
<p><strong>为什么<span class="math inline">\(t\)</span>统计量服从<span class="math inline">\(t\)</span>分布？</strong></p>
<p>要理解为什么<span class="math inline">\(t\)</span>统计量服从<span class="math inline">\(t\)</span>分布，我们需要从统计理论的角度来分析这个公式的构成。</p>
<p>首先，考虑分子部分<span class="math inline">\(\bar{x} - \mu_0\)</span>。根据中心极限定理，样本均值<span class="math inline">\(\bar{x}\)</span>的抽样分布近似正态分布，其均值为总体均值<span class="math inline">\(\mu\)</span>，标准差为<span class="math inline">\(\sigma/\sqrt{n}\)</span>（其中<span class="math inline">\(\sigma\)</span>是总体标准差）。在零假设<span class="math inline">\(H_0: \mu = \mu_0\)</span>下，我们有：</p>
<p><span class="math display">\[\frac{\bar{x} - \mu_0}{\sigma/\sqrt{n}} \sim N(0,1)\]</span></p>
<p>也就是说，如果我们知道总体标准差<span class="math inline">\(\sigma\)</span>，这个标准化统计量就服从标准正态分布。</p>
<p>然而，在实际研究中，我们通常不知道总体标准差<span class="math inline">\(\sigma\)</span>，只能用样本标准差<span class="math inline">\(s\)</span>来估计它。当我们用<span class="math inline">\(s\)</span>代替<span class="math inline">\(\sigma\)</span>时，统计量的分布就发生了变化。具体来说：</p>
<ul>
<li>分子<span class="math inline">\(\bar{x} - \mu_0\)</span>服从正态分布</li>
<li>分母<span class="math inline">\(s/\sqrt{n}\)</span>是样本标准误的估计</li>
<li>这两个量是相关的，因为<span class="math inline">\(s\)</span>也是从样本中计算出来的</li>
</ul>
<p>统计学家威廉·戈塞特（笔名”Student”）在1908年证明了，当总体服从正态分布时，这个统计量服从<span class="math inline">\(t\)</span>分布：</p>
<p><span class="math display">\[t = \frac{\bar{x} - \mu_0}{s/\sqrt{n}} \sim t_{n-1}\]</span></p>
<p>其中<span class="math inline">\(t_{n-1}\)</span>表示自由度为<span class="math inline">\(n-1\)</span>的<span class="math inline">\(t\)</span>分布。</p>
<p><strong>自由度<span class="math inline">\(n-1\)</span>的来源</strong></p>
<p>自由度<span class="math inline">\(n-1\)</span>的出现是因为我们在计算样本标准差<span class="math inline">\(s\)</span>时损失了一个自由度。样本标准差的计算公式为：</p>
<p><span class="math display">\[s = \sqrt{\frac{\sum_{i=1}^n (x_i - \bar{x})^2}{n-1}}\]</span></p>
<p>分母使用<span class="math inline">\(n-1\)</span>而不是<span class="math inline">\(n\)</span>是为了使<span class="math inline">\(s^2\)</span>成为总体方差<span class="math inline">\(\sigma^2\)</span>的无偏估计。这个<span class="math inline">\(n-1\)</span>就是自由度的来源。</p>
<p><strong><span class="math inline">\(t\)</span>分布与正态分布的关系</strong></p>
<p><span class="math inline">\(t\)</span>分布与正态分布形状相似，都是钟形曲线，但<span class="math inline">\(t\)</span>分布的尾部更厚。这意味着在相同的显著性水平下，<span class="math inline">\(t\)</span>分布的临界值比正态分布更大。当样本量<span class="math inline">\(n\)</span>增大时，<span class="math inline">\(t\)</span>分布逐渐接近正态分布：</p>
<ul>
<li>当<span class="math inline">\(n \to \infty\)</span>时，<span class="math inline">\(t\)</span>分布趋近于标准正态分布</li>
<li>对于小样本（如<span class="math inline">\(n &lt; 30\)</span>），<span class="math inline">\(t\)</span>分布与正态分布的差异比较明显</li>
<li>对于大样本（如<span class="math inline">\(n &gt; 30\)</span>），<span class="math inline">\(t\)</span>分布与正态分布非常接近</li>
</ul>
<p>这种性质使得<span class="math inline">\(t\)</span>检验特别适用于小样本情况，而大样本时<span class="math inline">\(t\)</span>检验与<span class="math inline">\(z\)</span>检验的结果会非常接近。</p>
<p>在生态学研究中，由于样本量往往有限，<span class="math inline">\(t\)</span>检验提供了比<span class="math inline">\(z\)</span>检验更准确的推断。当我们使用样本标准差<span class="math inline">\(s\)</span>代替未知的总体标准差<span class="math inline">\(\sigma\)</span>时，<span class="math inline">\(t\)</span>分布恰当地考虑了这种估计带来的不确定性，使得我们的统计推断更加保守和可靠。</p>
<p><strong>生态学意义</strong>：单样本t检验在生态学中有广泛的应用。例如，我们可以检验：</p>
<ul>
<li>某个湖泊的pH值是否偏离中性（pH = 7）</li>
<li>某种鸟类的平均体重是否与文献记载的标准值一致</li>
<li>某个保护区内的物种丰富度是否达到预期的保护目标</li>
<li>某种污染物的浓度是否超过环境安全标准</li>
</ul>
<p>让我们通过一个具体的生态学实例来理解单样本t检验的应用：</p>
<blockquote>
<p><strong>实例：检验河流pH值是否偏离中性</strong></p>
<p>假设我们研究某条受工业排放影响的河流，想要检验其pH值是否显著偏离中性（pH = 7）。我们在河流的不同断面采集了15个水样，测量其pH值。</p>
<ul>
<li><strong>零假设（<span class="math inline">\(H_0\)</span>）</strong>：河流的平均pH值等于7（<span class="math inline">\(\mu = 7\)</span>）</li>
<li><strong>备择假设（<span class="math inline">\(H_1\)</span>）</strong>：河流的平均pH值不等于7（<span class="math inline">\(\mu \neq 7\)</span>）</li>
</ul>
<p>如果检验结果显示p &lt; 0.05，我们有统计证据表明河流的pH值确实偏离中性，可能受到了工业排放的影响。</p>
</blockquote>
<p>单样本t检验的使用需要满足一些前提条件：数据应该近似正态分布，观测值之间相互独立。如果数据严重偏离正态分布，或者样本量很小，我们可能需要考虑使用非参数检验方法。</p>
<p>为了更好地理解单样本t检验的原理，让我们通过R代码生成一个可视化图表：</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="基于经典分布的假设检验.html#cb730-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb730-2"><a href="基于经典分布的假设检验.html#cb730-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb730-3"><a href="基于经典分布的假设检验.html#cb730-3" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="fl">7.0</span> <span class="co"># 理论值 $\mu_0$（中性pH）</span></span>
<span id="cb730-4"><a href="基于经典分布的假设检验.html#cb730-4" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> <span class="fl">6.8</span> <span class="co"># 样本均值 $\bar{x}$</span></span>
<span id="cb730-5"><a href="基于经典分布的假设检验.html#cb730-5" tabindex="-1"></a>sample_sd <span class="ot">&lt;-</span> <span class="fl">0.3</span> <span class="co"># 样本标准差 $s$</span></span>
<span id="cb730-6"><a href="基于经典分布的假设检验.html#cb730-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co"># 样本量 $n$</span></span>
<span id="cb730-7"><a href="基于经典分布的假设检验.html#cb730-7" tabindex="-1"></a></span>
<span id="cb730-8"><a href="基于经典分布的假设检验.html#cb730-8" tabindex="-1"></a><span class="co"># 计算t统计量</span></span>
<span id="cb730-9"><a href="基于经典分布的假设检验.html#cb730-9" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> (sample_mean <span class="sc">-</span> mu0) <span class="sc">/</span> (sample_sd <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb730-10"><a href="基于经典分布的假设检验.html#cb730-10" tabindex="-1"></a></span>
<span id="cb730-11"><a href="基于经典分布的假设检验.html#cb730-11" tabindex="-1"></a><span class="co"># 生成t分布数据</span></span>
<span id="cb730-12"><a href="基于经典分布的假设检验.html#cb730-12" tabindex="-1"></a>df <span class="ot">&lt;-</span> n <span class="sc">-</span> <span class="dv">1</span> <span class="co"># 自由度 $n-1$</span></span>
<span id="cb730-13"><a href="基于经典分布的假设检验.html#cb730-13" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb730-14"><a href="基于经典分布的假设检验.html#cb730-14" tabindex="-1"></a>t_density <span class="ot">&lt;-</span> <span class="fu">dt</span>(x_vals, <span class="at">df =</span> df)</span>
<span id="cb730-15"><a href="基于经典分布的假设检验.html#cb730-15" tabindex="-1"></a></span>
<span id="cb730-16"><a href="基于经典分布的假设检验.html#cb730-16" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb730-17"><a href="基于经典分布的假设检验.html#cb730-17" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_vals, <span class="at">density =</span> t_density)</span>
<span id="cb730-18"><a href="基于经典分布的假设检验.html#cb730-18" tabindex="-1"></a></span>
<span id="cb730-19"><a href="基于经典分布的假设检验.html#cb730-19" tabindex="-1"></a><span class="co"># 计算p值（双侧检验）</span></span>
<span id="cb730-20"><a href="基于经典分布的假设检验.html#cb730-20" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_stat), <span class="at">df =</span> df))</span></code></pre></div>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="基于经典分布的假设检验.html#cb731-1" tabindex="-1"></a><span class="co"># 绘制t分布图</span></span>
<span id="cb731-2"><a href="基于经典分布的假设检验.html#cb731-2" tabindex="-1"></a><span class="fu">ggplot</span>(t_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density)) <span class="sc">+</span></span>
<span id="cb731-3"><a href="基于经典分布的假设检验.html#cb731-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb731-4"><a href="基于经典分布的假设检验.html#cb731-4" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb731-5"><a href="基于经典分布的假设检验.html#cb731-5" tabindex="-1"></a>    <span class="at">xintercept =</span> t_stat, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb731-6"><a href="基于经典分布的假设检验.html#cb731-6" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span></span>
<span id="cb731-7"><a href="基于经典分布的假设检验.html#cb731-7" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb731-8"><a href="基于经典分布的假设检验.html#cb731-8" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb731-9"><a href="基于经典分布的假设检验.html#cb731-9" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="sc">-</span>t_stat, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb731-10"><a href="基于经典分布的假设检验.html#cb731-10" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span></span>
<span id="cb731-11"><a href="基于经典分布的假设检验.html#cb731-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb731-12"><a href="基于经典分布的假设检验.html#cb731-12" tabindex="-1"></a>  <span class="fu">geom_area</span>(</span>
<span id="cb731-13"><a href="基于经典分布的假设检验.html#cb731-13" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(t_df, x <span class="sc">&gt;=</span> <span class="fu">abs</span>(t_stat)),</span>
<span id="cb731-14"><a href="基于经典分布的假设检验.html#cb731-14" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span></span>
<span id="cb731-15"><a href="基于经典分布的假设检验.html#cb731-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb731-16"><a href="基于经典分布的假设检验.html#cb731-16" tabindex="-1"></a>  <span class="fu">geom_area</span>(</span>
<span id="cb731-17"><a href="基于经典分布的假设检验.html#cb731-17" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(t_df, x <span class="sc">&lt;=</span> <span class="sc">-</span><span class="fu">abs</span>(t_stat)),</span>
<span id="cb731-18"><a href="基于经典分布的假设检验.html#cb731-18" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span></span>
<span id="cb731-19"><a href="基于经典分布的假设检验.html#cb731-19" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb731-20"><a href="基于经典分布的假设检验.html#cb731-20" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb731-21"><a href="基于经典分布的假设检验.html#cb731-21" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb731-22"><a href="基于经典分布的假设检验.html#cb731-22" tabindex="-1"></a>    <span class="at">x =</span> t_stat <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.2</span>,</span>
<span id="cb731-23"><a href="基于经典分布的假设检验.html#cb731-23" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;$t$ =&quot;</span>, <span class="fu">round</span>(t_stat, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb731-24"><a href="基于经典分布的假设检验.html#cb731-24" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb731-25"><a href="基于经典分布的假设检验.html#cb731-25" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb731-26"><a href="基于经典分布的假设检验.html#cb731-26" tabindex="-1"></a>    <span class="at">x =</span> t_stat <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.15</span>,</span>
<span id="cb731-27"><a href="基于经典分布的假设检验.html#cb731-27" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;$p$ =&quot;</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>)), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb731-28"><a href="基于经典分布的假设检验.html#cb731-28" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb731-29"><a href="基于经典分布的假设检验.html#cb731-29" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb731-30"><a href="基于经典分布的假设检验.html#cb731-30" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;单样本t检验的可视化解释&quot;</span>,</span>
<span id="cb731-31"><a href="基于经典分布的假设检验.html#cb731-31" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;$t$统计量&quot;</span>, <span class="at">y =</span> <span class="st">&quot;密度&quot;</span>,</span>
<span id="cb731-32"><a href="基于经典分布的假设检验.html#cb731-32" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;红色区域表示$p$值，垂直线表示观测到的$t$统计量&quot;</span></span>
<span id="cb731-33"><a href="基于经典分布的假设检验.html#cb731-33" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb731-34"><a href="基于经典分布的假设检验.html#cb731-34" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:one-sample-t-test-visualization"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/one-sample-t-test-visualization-1.png" alt="单样本t检验的可视化解释：展示t分布、观测t统计量以及对应的p值区域" width="768" />
<p class="caption">
图6.7: 单样本t检验的可视化解释：展示t分布、观测t统计量以及对应的p值区域
</p>
</div>
<p>这个图表直观展示了单样本t检验的原理。蓝色曲线表示在零假设下的<span class="math inline">\(t\)</span>分布，红色垂直线表示我们观测到的<span class="math inline">\(t\)</span>统计量，红色区域表示<span class="math inline">\(p\)</span>值——在零假设下观测到当前或更极端<span class="math inline">\(t\)</span>值的概率。</p>
</div>
<div id="单样本符号检验" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> 单样本符号检验<a href="基于经典分布的假设检验.html#单样本符号检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>当数据不满足正态分布假设，或者我们想要检验中位数而不是均值时，<strong>单样本符号检验</strong>提供了一个强大的非参数替代方法。与t检验不同，符号检验不依赖于数据的分布形态，而是基于观测值与理论值之间差异的符号（正负号）来进行统计推断。</p>
<p>单样本符号检验的基本思想很简单：对于每个观测值，我们计算其与理论值的差异，然后只关注这些差异的符号（正号或负号），忽略差异的大小。检验统计量通常是正号（或负号）的数量。</p>
<p>其零假设和备择假设通常设定为：</p>
<ul>
<li><strong>零假设（<span class="math inline">\(H_0\)</span>）</strong>：样本中位数等于理论值（<span class="math inline">\(M = M_0\)</span>）</li>
<li><strong>备择假设（<span class="math inline">\(H_1\)</span>）</strong>：样本中位数不等于理论值（<span class="math inline">\(M \neq M_0\)</span>），或者根据研究问题设定为单侧检验</li>
</ul>
<p>在零假设下，正号和负号应该以相等的概率出现，因此检验统计量服从二项分布<span class="math inline">\(B(n, 0.5)\)</span>，其中<span class="math inline">\(n\)</span>是有效样本量（排除等于理论值的观测）。</p>
<p><strong>生态学意义</strong>：单样本符号检验在生态学中特别适用于以下情况：</p>
<ul>
<li>数据严重偏离正态分布，存在极端值或偏态分布</li>
<li>样本量很小，无法可靠地检验正态性</li>
<li>测量尺度是序数的，或者数据只包含相对大小信息</li>
<li>我们更关心中位数而不是均值，因为中位数对极端值不敏感</li>
</ul>
<p>例如，我们可以使用符号检验来：</p>
<ul>
<li>检验某种污染物的中位浓度是否超过环境标准</li>
<li>比较某个物种在不同年份的个体大小中位数是否有变化</li>
<li>检验某个生态指标的中位数是否达到管理目标</li>
</ul>
<p>让我们通过一个具体的生态学实例来理解单样本符号检验的应用：</p>
<blockquote>
<p><strong>实例：检验土壤重金属中位浓度是否超标</strong></p>
<p>假设我们研究某工业区附近的土壤重金属污染情况。环境标准规定铅的中位浓度不应超过50 mg/kg。我们在该区域采集了12个土壤样品，测量铅浓度。</p>
<ul>
<li><strong>零假设（<span class="math inline">\(H_0\)</span>）</strong>：土壤铅的中位浓度等于50 mg/kg（<span class="math inline">\(M = 50\)</span>）</li>
<li><strong>备择假设（<span class="math inline">\(H_1\)</span>）</strong>：土壤铅的中位浓度大于50 mg/kg（<span class="math inline">\(M &gt; 50\)</span>）</li>
</ul>
<p>这是一个单侧检验，因为我们只关心浓度是否超标。如果检验结果显示p &lt; 0.05，我们有统计证据表明土壤铅污染确实超过了环境标准。</p>
</blockquote>
<p>符号检验的主要优点是它对分布形态没有要求，对极端值不敏感。然而，它的缺点是统计功效通常低于对应的参数检验，因为它忽略了差异的大小信息。</p>
<p>为了更好地理解单样本符号检验的原理，让我们通过R代码生成一个可视化图表：</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="基于经典分布的假设检验.html#cb732-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb732-2"><a href="基于经典分布的假设检验.html#cb732-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb732-3"><a href="基于经典分布的假设检验.html#cb732-3" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># 理论中位值 $M_0$（环境标准）</span></span>
<span id="cb732-4"><a href="基于经典分布的假设检验.html#cb732-4" tabindex="-1"></a></span>
<span id="cb732-5"><a href="基于经典分布的假设检验.html#cb732-5" tabindex="-1"></a><span class="co"># 模拟土壤铅浓度数据（偏态分布）</span></span>
<span id="cb732-6"><a href="基于经典分布的假设检验.html#cb732-6" tabindex="-1"></a>soil_lead <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">48</span>, <span class="dv">52</span>, <span class="dv">55</span>, <span class="dv">58</span>, <span class="dv">62</span>, <span class="dv">65</span>, <span class="dv">68</span>, <span class="dv">72</span>, <span class="dv">75</span>, <span class="dv">85</span>, <span class="dv">120</span>)</span>
<span id="cb732-7"><a href="基于经典分布的假设检验.html#cb732-7" tabindex="-1"></a></span>
<span id="cb732-8"><a href="基于经典分布的假设检验.html#cb732-8" tabindex="-1"></a><span class="co"># 计算与理论值的差异</span></span>
<span id="cb732-9"><a href="基于经典分布的假设检验.html#cb732-9" tabindex="-1"></a>signs <span class="ot">&lt;-</span> <span class="fu">sign</span>(soil_lead <span class="sc">-</span> m0)</span>
<span id="cb732-10"><a href="基于经典分布的假设检验.html#cb732-10" tabindex="-1"></a>positive_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(signs <span class="sc">==</span> <span class="dv">1</span>) <span class="co"># 正号数量</span></span>
<span id="cb732-11"><a href="基于经典分布的假设检验.html#cb732-11" tabindex="-1"></a>negative_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(signs <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>) <span class="co"># 负号数量</span></span>
<span id="cb732-12"><a href="基于经典分布的假设检验.html#cb732-12" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(soil_lead) <span class="sc">-</span> <span class="fu">sum</span>(signs <span class="sc">==</span> <span class="dv">0</span>) <span class="co"># 有效样本量 $n$（排除等于理论值的观测）</span></span>
<span id="cb732-13"><a href="基于经典分布的假设检验.html#cb732-13" tabindex="-1"></a></span>
<span id="cb732-14"><a href="基于经典分布的假设检验.html#cb732-14" tabindex="-1"></a><span class="co"># 计算p值（单侧检验）</span></span>
<span id="cb732-15"><a href="基于经典分布的假设检验.html#cb732-15" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(positive_count <span class="sc">-</span> <span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb732-16"><a href="基于经典分布的假设检验.html#cb732-16" tabindex="-1"></a></span>
<span id="cb732-17"><a href="基于经典分布的假设检验.html#cb732-17" tabindex="-1"></a><span class="co"># 生成二项分布数据</span></span>
<span id="cb732-18"><a href="基于经典分布的假设检验.html#cb732-18" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>n</span>
<span id="cb732-19"><a href="基于经典分布的假设检验.html#cb732-19" tabindex="-1"></a>binom_density <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(x_vals, <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb732-20"><a href="基于经典分布的假设检验.html#cb732-20" tabindex="-1"></a></span>
<span id="cb732-21"><a href="基于经典分布的假设检验.html#cb732-21" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb732-22"><a href="基于经典分布的假设检验.html#cb732-22" tabindex="-1"></a>binom_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_vals, <span class="at">density =</span> binom_density)</span>
<span id="cb732-23"><a href="基于经典分布的假设检验.html#cb732-23" tabindex="-1"></a></span>
<span id="cb732-24"><a href="基于经典分布的假设检验.html#cb732-24" tabindex="-1"></a><span class="co"># 绘制二项分布图</span></span>
<span id="cb732-25"><a href="基于经典分布的假设检验.html#cb732-25" tabindex="-1"></a><span class="fu">ggplot</span>(binom_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density)) <span class="sc">+</span></span>
<span id="cb732-26"><a href="基于经典分布的假设检验.html#cb732-26" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb732-27"><a href="基于经典分布的假设检验.html#cb732-27" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> positive_count, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb732-28"><a href="基于经典分布的假设检验.html#cb732-28" tabindex="-1"></a>  <span class="fu">geom_area</span>(</span>
<span id="cb732-29"><a href="基于经典分布的假设检验.html#cb732-29" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(binom_df, x <span class="sc">&gt;=</span> positive_count),</span>
<span id="cb732-30"><a href="基于经典分布的假设检验.html#cb732-30" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb732-31"><a href="基于经典分布的假设检验.html#cb732-31" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb732-32"><a href="基于经典分布的假设检验.html#cb732-32" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb732-33"><a href="基于经典分布的假设检验.html#cb732-33" tabindex="-1"></a>    <span class="at">x =</span> positive_count <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fu">max</span>(binom_density) <span class="sc">*</span> <span class="fl">0.8</span>,</span>
<span id="cb732-34"><a href="基于经典分布的假设检验.html#cb732-34" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;正号数量 =&quot;</span>, positive_count), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb732-35"><a href="基于经典分布的假设检验.html#cb732-35" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb732-36"><a href="基于经典分布的假设检验.html#cb732-36" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb732-37"><a href="基于经典分布的假设检验.html#cb732-37" tabindex="-1"></a>    <span class="at">x =</span> positive_count <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fu">max</span>(binom_density) <span class="sc">*</span> <span class="fl">0.7</span>,</span>
<span id="cb732-38"><a href="基于经典分布的假设检验.html#cb732-38" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;$p$ =&quot;</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>)), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb732-39"><a href="基于经典分布的假设检验.html#cb732-39" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb732-40"><a href="基于经典分布的假设检验.html#cb732-40" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb732-41"><a href="基于经典分布的假设检验.html#cb732-41" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;单样本符号检验的可视化解释&quot;</span>,</span>
<span id="cb732-42"><a href="基于经典分布的假设检验.html#cb732-42" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;正号数量&quot;</span>, <span class="at">y =</span> <span class="st">&quot;概率&quot;</span>,</span>
<span id="cb732-43"><a href="基于经典分布的假设检验.html#cb732-43" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;红色区域表示$p$值，垂直线表示观测到的正号数量&quot;</span></span>
<span id="cb732-44"><a href="基于经典分布的假设检验.html#cb732-44" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb732-45"><a href="基于经典分布的假设检验.html#cb732-45" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sign-test-visualization"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/sign-test-visualization-1.png" alt="单样本符号检验的可视化解释：展示二项分布下正号数量的概率分布以及观测到的正号数量" width="768" />
<p class="caption">
图6.8: 单样本符号检验的可视化解释：展示二项分布下正号数量的概率分布以及观测到的正号数量
</p>
</div>
<p>这个图表直观展示了单样本符号检验的原理。蓝色柱状图表示在零假设下（正号和负号以相等概率出现）正号数量的二项分布，红色垂直线表示我们观测到的正号数量，红色区域表示<span class="math inline">\(p\)</span>值——在零假设下观测到当前或更多正号的概率。</p>
<p>在实际的生态学研究中，选择使用单样本t检验还是符号检验应该基于数据的特性和研究问题的性质。如果数据近似正态分布且没有极端值，t检验通常更有效。如果数据严重偏离正态分布或存在极端值，符号检验提供了更稳健的替代方法。</p>
</div>
</div>
<div id="双样本检验" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> 双样本检验<a href="基于经典分布的假设检验.html#双样本检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="独立样本t检验" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> 独立样本t检验<a href="基于经典分布的假设检验.html#独立样本t检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在生态学研究中，我们常常需要比较两个独立样本的均值是否存在显著差异。<strong>独立样本t检验</strong>就是用于这种目的的参数检验方法，特别适用于比较来自不同处理、不同生境或不同群体的生态数据。</p>
<p>独立样本t检验的基本思想是比较两个独立样本的均值差异是否具有统计显著性。其零假设和备择假设通常设定为：</p>
<ul>
<li><strong>零假设（<span class="math inline">\(H_0\)</span>）</strong>：两个样本的总体均值相等（<span class="math inline">\(\mu_1 = \mu_2\)</span>）</li>
<li><strong>备择假设（<span class="math inline">\(H_1\)</span>）</strong>：两个样本的总体均值不相等（<span class="math inline">\(\mu_1 \neq \mu_2\)</span>），或者根据研究问题设定为单侧检验</li>
</ul>
<p>检验统计量<span class="math inline">\(t\)</span>的计算公式为：</p>
<p><span class="math display">\[t = \frac{\bar{x}_1 - \bar{x}_2}{s_p \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}\]</span></p>
<p>其中<span class="math inline">\(\bar{x}_1\)</span>和<span class="math inline">\(\bar{x}_2\)</span>分别是两个样本的均值，<span class="math inline">\(n_1\)</span>和<span class="math inline">\(n_2\)</span>是样本量，<span class="math inline">\(s_p\)</span>是合并标准差，计算公式为：</p>
<p><span class="math display">\[s_p = \sqrt{\frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}}\]</span></p>
<p>这个统计量服从自由度为<span class="math inline">\(n_1 + n_2 - 2\)</span>的<span class="math inline">\(t\)</span>分布。</p>
<p><strong>为什么使用合并标准差？</strong></p>
<p>使用合并标准差<span class="math inline">\(s_p\)</span>而不是单独使用<span class="math inline">\(s_1\)</span>或<span class="math inline">\(s_2\)</span>是基于一个重要的假设：两个样本来自具有相同方差的总体。这个假设称为<strong>方差齐性</strong>。在方差齐性的前提下，合并标准差提供了对共同总体方差的更好估计，因为它结合了两个样本的信息。</p>
<p>如果方差齐性假设不成立，我们需要使用<strong>Welch’s t检验</strong>，它不假设两个样本具有相同的方差，其自由度的计算也更加复杂。</p>
<p><strong>生态学意义</strong>：独立样本t检验在生态学中有广泛的应用。例如，我们可以检验：</p>
<ul>
<li>施肥处理和对照处理的草地生产力是否存在显著差异</li>
<li>不同森林类型中的鸟类多样性是否存在显著差异</li>
<li>污染区域和清洁区域的土壤微生物丰度是否存在显著差异</li>
<li>保护区内外的物种丰富度是否存在显著差异</li>
</ul>
<p>让我们通过一个具体的生态学实例来理解独立样本t检验的应用：</p>
<blockquote>
<p><strong>实例：比较施肥对草地生产力的影响</strong></p>
<p>假设我们研究施肥对草地生态系统生产力的影响。我们随机分配20个样方，其中10个接受施肥处理，10个作为对照。经过一个生长季，我们测量每个样方的地上生物量。</p>
<ul>
<li><strong>零假设（<span class="math inline">\(H_0\)</span>)</strong>：施肥组和对照组的平均生物量没有差异</li>
<li><strong>备择假设（<span class="math inline">\(H_1\)</span>)</strong>：施肥组和对照组的平均生物量存在差异</li>
</ul>
<p>如果检验结果显示p &lt; 0.05，我们有统计证据表明施肥确实对草地生产力产生了显著影响。</p>
</blockquote>
<p>独立样本t检验的使用需要满足一些前提条件：数据应该近似正态分布，两个样本的方差应该相等（方差齐性），观测值之间相互独立。如果这些条件不满足，我们可能需要考虑使用非参数检验方法。</p>
<p>为了更好地理解独立样本t检验的原理，让我们通过R代码生成一个可视化图表：</p>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="基于经典分布的假设检验.html#cb733-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb733-2"><a href="基于经典分布的假设检验.html#cb733-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb733-3"><a href="基于经典分布的假设检验.html#cb733-3" tabindex="-1"></a></span>
<span id="cb733-4"><a href="基于经典分布的假设检验.html#cb733-4" tabindex="-1"></a><span class="co"># 模拟施肥组和对照组的数据</span></span>
<span id="cb733-5"><a href="基于经典分布的假设检验.html#cb733-5" tabindex="-1"></a>fertilizer_group <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">3</span>) <span class="co"># 施肥组，均值25</span></span>
<span id="cb733-6"><a href="基于经典分布的假设检验.html#cb733-6" tabindex="-1"></a>control_group <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>) <span class="co"># 对照组，均值20</span></span>
<span id="cb733-7"><a href="基于经典分布的假设检验.html#cb733-7" tabindex="-1"></a></span>
<span id="cb733-8"><a href="基于经典分布的假设检验.html#cb733-8" tabindex="-1"></a><span class="co"># 计算样本统计量</span></span>
<span id="cb733-9"><a href="基于经典分布的假设检验.html#cb733-9" tabindex="-1"></a>mean_fert <span class="ot">&lt;-</span> <span class="fu">mean</span>(fertilizer_group)</span>
<span id="cb733-10"><a href="基于经典分布的假设检验.html#cb733-10" tabindex="-1"></a>mean_control <span class="ot">&lt;-</span> <span class="fu">mean</span>(control_group)</span>
<span id="cb733-11"><a href="基于经典分布的假设检验.html#cb733-11" tabindex="-1"></a>sd_fert <span class="ot">&lt;-</span> <span class="fu">sd</span>(fertilizer_group)</span>
<span id="cb733-12"><a href="基于经典分布的假设检验.html#cb733-12" tabindex="-1"></a>sd_control <span class="ot">&lt;-</span> <span class="fu">sd</span>(control_group)</span>
<span id="cb733-13"><a href="基于经典分布的假设检验.html#cb733-13" tabindex="-1"></a></span>
<span id="cb733-14"><a href="基于经典分布的假设检验.html#cb733-14" tabindex="-1"></a><span class="co"># 计算合并标准差</span></span>
<span id="cb733-15"><a href="基于经典分布的假设检验.html#cb733-15" tabindex="-1"></a>n_fert <span class="ot">&lt;-</span> <span class="fu">length</span>(fertilizer_group)</span>
<span id="cb733-16"><a href="基于经典分布的假设检验.html#cb733-16" tabindex="-1"></a>n_control <span class="ot">&lt;-</span> <span class="fu">length</span>(control_group)</span>
<span id="cb733-17"><a href="基于经典分布的假设检验.html#cb733-17" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(((n_fert <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sd_fert<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb733-18"><a href="基于经典分布的假设检验.html#cb733-18" tabindex="-1"></a>              (n_control <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sd_control<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n_fert <span class="sc">+</span> n_control <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb733-19"><a href="基于经典分布的假设检验.html#cb733-19" tabindex="-1"></a></span>
<span id="cb733-20"><a href="基于经典分布的假设检验.html#cb733-20" tabindex="-1"></a><span class="co"># 计算t统计量</span></span>
<span id="cb733-21"><a href="基于经典分布的假设检验.html#cb733-21" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> (mean_fert <span class="sc">-</span> mean_control) <span class="sc">/</span> (sp <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">/</span> n_fert <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> n_control))</span></code></pre></div>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="基于经典分布的假设检验.html#cb734-1" tabindex="-1"></a><span class="co"># 生成t分布数据</span></span>
<span id="cb734-2"><a href="基于经典分布的假设检验.html#cb734-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> n_fert <span class="sc">+</span> n_control <span class="sc">-</span> <span class="dv">2</span> <span class="co"># 自由度 $n_1 + n_2 - 2$</span></span>
<span id="cb734-3"><a href="基于经典分布的假设检验.html#cb734-3" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb734-4"><a href="基于经典分布的假设检验.html#cb734-4" tabindex="-1"></a>t_density <span class="ot">&lt;-</span> <span class="fu">dt</span>(x_vals, <span class="at">df =</span> df)</span>
<span id="cb734-5"><a href="基于经典分布的假设检验.html#cb734-5" tabindex="-1"></a></span>
<span id="cb734-6"><a href="基于经典分布的假设检验.html#cb734-6" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb734-7"><a href="基于经典分布的假设检验.html#cb734-7" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_vals, <span class="at">density =</span> t_density)</span>
<span id="cb734-8"><a href="基于经典分布的假设检验.html#cb734-8" tabindex="-1"></a></span>
<span id="cb734-9"><a href="基于经典分布的假设检验.html#cb734-9" tabindex="-1"></a><span class="co"># 计算p值（双侧检验）</span></span>
<span id="cb734-10"><a href="基于经典分布的假设检验.html#cb734-10" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_stat), <span class="at">df =</span> df))</span></code></pre></div>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="基于经典分布的假设检验.html#cb735-1" tabindex="-1"></a><span class="co"># 绘制t分布图</span></span>
<span id="cb735-2"><a href="基于经典分布的假设检验.html#cb735-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb735-3"><a href="基于经典分布的假设检验.html#cb735-3" tabindex="-1"></a><span class="fu">ggplot</span>(t_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density)) <span class="sc">+</span></span>
<span id="cb735-4"><a href="基于经典分布的假设检验.html#cb735-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb735-5"><a href="基于经典分布的假设检验.html#cb735-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb735-6"><a href="基于经典分布的假设检验.html#cb735-6" tabindex="-1"></a>    <span class="at">xintercept =</span> t_stat, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb735-7"><a href="基于经典分布的假设检验.html#cb735-7" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span></span>
<span id="cb735-8"><a href="基于经典分布的假设检验.html#cb735-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb735-9"><a href="基于经典分布的假设检验.html#cb735-9" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb735-10"><a href="基于经典分布的假设检验.html#cb735-10" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="sc">-</span>t_stat, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb735-11"><a href="基于经典分布的假设检验.html#cb735-11" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span></span>
<span id="cb735-12"><a href="基于经典分布的假设检验.html#cb735-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb735-13"><a href="基于经典分布的假设检验.html#cb735-13" tabindex="-1"></a>  <span class="fu">geom_area</span>(</span>
<span id="cb735-14"><a href="基于经典分布的假设检验.html#cb735-14" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(t_df, x <span class="sc">&gt;=</span> <span class="fu">abs</span>(t_stat)),</span>
<span id="cb735-15"><a href="基于经典分布的假设检验.html#cb735-15" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span></span>
<span id="cb735-16"><a href="基于经典分布的假设检验.html#cb735-16" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb735-17"><a href="基于经典分布的假设检验.html#cb735-17" tabindex="-1"></a>  <span class="fu">geom_area</span>(</span>
<span id="cb735-18"><a href="基于经典分布的假设检验.html#cb735-18" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(t_df, x <span class="sc">&lt;=</span> <span class="sc">-</span><span class="fu">abs</span>(t_stat)),</span>
<span id="cb735-19"><a href="基于经典分布的假设检验.html#cb735-19" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span></span>
<span id="cb735-20"><a href="基于经典分布的假设检验.html#cb735-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb735-21"><a href="基于经典分布的假设检验.html#cb735-21" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb735-22"><a href="基于经典分布的假设检验.html#cb735-22" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb735-23"><a href="基于经典分布的假设检验.html#cb735-23" tabindex="-1"></a>    <span class="at">x =</span> t_stat <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.2</span>,</span>
<span id="cb735-24"><a href="基于经典分布的假设检验.html#cb735-24" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;$t$ =&quot;</span>, <span class="fu">round</span>(t_stat, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb735-25"><a href="基于经典分布的假设检验.html#cb735-25" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb735-26"><a href="基于经典分布的假设检验.html#cb735-26" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb735-27"><a href="基于经典分布的假设检验.html#cb735-27" tabindex="-1"></a>    <span class="at">x =</span> t_stat <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.15</span>,</span>
<span id="cb735-28"><a href="基于经典分布的假设检验.html#cb735-28" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;$p$ =&quot;</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>)), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb735-29"><a href="基于经典分布的假设检验.html#cb735-29" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb735-30"><a href="基于经典分布的假设检验.html#cb735-30" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb735-31"><a href="基于经典分布的假设检验.html#cb735-31" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;独立样本t检验的可视化解释&quot;</span>,</span>
<span id="cb735-32"><a href="基于经典分布的假设检验.html#cb735-32" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;$t$统计量&quot;</span>, <span class="at">y =</span> <span class="st">&quot;密度&quot;</span>,</span>
<span id="cb735-33"><a href="基于经典分布的假设检验.html#cb735-33" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;红色区域表示$p$值，垂直线表示观测到的$t$统计量&quot;</span></span>
<span id="cb735-34"><a href="基于经典分布的假设检验.html#cb735-34" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb735-35"><a href="基于经典分布的假设检验.html#cb735-35" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:independent-t-test-visualization"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/independent-t-test-visualization-1.png" alt="独立样本t检验的可视化解释：展示在零假设下t分布、观测t统计量以及对应的p值区域" width="768" />
<p class="caption">
图6.9: 独立样本t检验的可视化解释：展示在零假设下t分布、观测t统计量以及对应的p值区域
</p>
</div>
<p>这个图表直观展示了独立样本t检验的原理。蓝色曲线表示在零假设下的<span class="math inline">\(t\)</span>分布，红色垂直线表示我们观测到的<span class="math inline">\(t\)</span>统计量，红色区域表示<span class="math inline">\(p\)</span>值——在零假设下观测到当前或更极端<span class="math inline">\(t\)</span>值的概率。</p>
</div>
<div id="配对样本t检验" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> 配对样本t检验<a href="基于经典分布的假设检验.html#配对样本t检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在生态学研究中，我们常常需要比较同一研究对象在不同时间点或不同条件下的测量值。<strong>配对样本t检验</strong>就是专门用于这种配对设计数据的参数检验方法。</p>
<p>配对样本t检验的基本思想不是直接比较两个样本的均值，而是比较配对差异的均值是否显著不同于零。其零假设和备择假设通常设定为：</p>
<ul>
<li><strong>零假设（<span class="math inline">\(H_0\)</span>）</strong>：配对差异的总体均值等于零（<span class="math inline">\(\mu_d = 0\)</span>）</li>
<li><strong>备择假设（<span class="math inline">\(H_1\)</span>）</strong>：配对差异的总体均值不等于零（<span class="math inline">\(\mu_d \neq 0\)</span>），或者根据研究问题设定为单侧检验</li>
</ul>
<p>检验统计量<span class="math inline">\(t\)</span>的计算公式为：</p>
<p><span class="math display">\[t = \frac{\bar{d}}{s_d / \sqrt{n}}\]</span></p>
<p>其中<span class="math inline">\(\bar{d}\)</span>是配对差异的均值，<span class="math inline">\(s_d\)</span>是配对差异的标准差，<span class="math inline">\(n\)</span>是配对数。这个统计量服从自由度为<span class="math inline">\(n-1\)</span>的<span class="math inline">\(t\)</span>分布。</p>
<p><strong>为什么配对样本t检验通常更有效？</strong></p>
<p>配对样本t检验通过考虑个体间的变异，通常比独立样本t检验具有更高的统计功效。这是因为配对设计消除了个体间变异对检验的影响，使得我们能够更精确地检测处理效应。</p>
<p><strong>生态学意义</strong>：配对样本t检验在生态学中特别适用于以下情况：</p>
<ul>
<li>同一地块在不同年份的物种丰富度比较</li>
<li>同一动物个体在不同季节的体重变化</li>
<li>同一植物在不同处理前后的生理指标测量</li>
<li>同一水域在不同污染事件前后的水质参数</li>
</ul>
<p>让我们通过一个具体的生态学实例来理解配对样本t检验的应用：</p>
<blockquote>
<p><strong>实例：检验保护措施对鸟类数量的影响</strong></p>
<p>假设我们研究某种栖息地保护措施对特定鸟类种群的影响。我们在10个保护区实施保护措施前和实施一年后分别调查鸟类数量。</p>
<ul>
<li><strong>零假设（<span class="math inline">\(H_0\)</span>）</strong>：保护措施实施前后的鸟类数量没有差异（<span class="math inline">\(\mu_d = 0\)</span>）</li>
<li><strong>备择假设（<span class="math inline">\(H_1\)</span>）</strong>：保护措施实施后的鸟类数量高于实施前（<span class="math inline">\(\mu_d &gt; 0\)</span>）</li>
</ul>
<p>这是一个单侧检验，因为我们预期保护措施会提高鸟类数量。如果检验结果显示p &lt; 0.05，我们有统计证据表明保护措施确实产生了积极效果。</p>
</blockquote>
<p>配对样本t检验的使用需要满足一些前提条件：配对差异应该近似正态分布。如果这个条件不满足，我们可能需要考虑使用非参数检验方法，如Wilcoxon符号秩检验。</p>
<p>为了更好地理解配对样本t检验的原理，让我们通过R代码生成一个可视化图表：</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="基于经典分布的假设检验.html#cb736-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb736-2"><a href="基于经典分布的假设检验.html#cb736-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb736-3"><a href="基于经典分布的假设检验.html#cb736-3" tabindex="-1"></a></span>
<span id="cb736-4"><a href="基于经典分布的假设检验.html#cb736-4" tabindex="-1"></a><span class="co"># 模拟保护措施实施前后的鸟类数量数据</span></span>
<span id="cb736-5"><a href="基于经典分布的假设检验.html#cb736-5" tabindex="-1"></a>before_protection <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">12</span>, <span class="dv">20</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">19</span>, <span class="dv">13</span>, <span class="dv">21</span>) <span class="co"># 实施前</span></span>
<span id="cb736-6"><a href="基于经典分布的假设检验.html#cb736-6" tabindex="-1"></a>after_protection <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">15</span>, <span class="dv">24</span>, <span class="dv">19</span>, <span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">23</span>, <span class="dv">16</span>, <span class="dv">25</span>) <span class="co"># 实施后</span></span>
<span id="cb736-7"><a href="基于经典分布的假设检验.html#cb736-7" tabindex="-1"></a></span>
<span id="cb736-8"><a href="基于经典分布的假设检验.html#cb736-8" tabindex="-1"></a><span class="co"># 计算配对差异</span></span>
<span id="cb736-9"><a href="基于经典分布的假设检验.html#cb736-9" tabindex="-1"></a>differences <span class="ot">&lt;-</span> after_protection <span class="sc">-</span> before_protection</span>
<span id="cb736-10"><a href="基于经典分布的假设检验.html#cb736-10" tabindex="-1"></a></span>
<span id="cb736-11"><a href="基于经典分布的假设检验.html#cb736-11" tabindex="-1"></a><span class="co"># 计算配对差异的统计量</span></span>
<span id="cb736-12"><a href="基于经典分布的假设检验.html#cb736-12" tabindex="-1"></a>mean_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(differences)</span>
<span id="cb736-13"><a href="基于经典分布的假设检验.html#cb736-13" tabindex="-1"></a>sd_diff <span class="ot">&lt;-</span> <span class="fu">sd</span>(differences)</span>
<span id="cb736-14"><a href="基于经典分布的假设检验.html#cb736-14" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(differences)</span>
<span id="cb736-15"><a href="基于经典分布的假设检验.html#cb736-15" tabindex="-1"></a></span>
<span id="cb736-16"><a href="基于经典分布的假设检验.html#cb736-16" tabindex="-1"></a><span class="co"># 计算t统计量</span></span>
<span id="cb736-17"><a href="基于经典分布的假设检验.html#cb736-17" tabindex="-1"></a>t_stat <span class="ot">&lt;-</span> mean_diff <span class="sc">/</span> (sd_diff <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span></code></pre></div>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="基于经典分布的假设检验.html#cb737-1" tabindex="-1"></a><span class="co"># 生成t分布数据</span></span>
<span id="cb737-2"><a href="基于经典分布的假设检验.html#cb737-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> n <span class="sc">-</span> <span class="dv">1</span> <span class="co"># 自由度 $n-1$</span></span>
<span id="cb737-3"><a href="基于经典分布的假设检验.html#cb737-3" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb737-4"><a href="基于经典分布的假设检验.html#cb737-4" tabindex="-1"></a>t_density <span class="ot">&lt;-</span> <span class="fu">dt</span>(x_vals, <span class="at">df =</span> df)</span>
<span id="cb737-5"><a href="基于经典分布的假设检验.html#cb737-5" tabindex="-1"></a></span>
<span id="cb737-6"><a href="基于经典分布的假设检验.html#cb737-6" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb737-7"><a href="基于经典分布的假设检验.html#cb737-7" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_vals, <span class="at">density =</span> t_density)</span>
<span id="cb737-8"><a href="基于经典分布的假设检验.html#cb737-8" tabindex="-1"></a></span>
<span id="cb737-9"><a href="基于经典分布的假设检验.html#cb737-9" tabindex="-1"></a><span class="co"># 计算p值（单侧检验）</span></span>
<span id="cb737-10"><a href="基于经典分布的假设检验.html#cb737-10" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(t_stat, <span class="at">df =</span> df)</span></code></pre></div>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="基于经典分布的假设检验.html#cb738-1" tabindex="-1"></a><span class="co"># 绘制t分布图</span></span>
<span id="cb738-2"><a href="基于经典分布的假设检验.html#cb738-2" tabindex="-1"></a><span class="fu">ggplot</span>(t_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density)) <span class="sc">+</span></span>
<span id="cb738-3"><a href="基于经典分布的假设检验.html#cb738-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb738-4"><a href="基于经典分布的假设检验.html#cb738-4" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb738-5"><a href="基于经典分布的假设检验.html#cb738-5" tabindex="-1"></a>    <span class="at">xintercept =</span> t_stat, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb738-6"><a href="基于经典分布的假设检验.html#cb738-6" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span></span>
<span id="cb738-7"><a href="基于经典分布的假设检验.html#cb738-7" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb738-8"><a href="基于经典分布的假设检验.html#cb738-8" tabindex="-1"></a>  <span class="fu">geom_area</span>(</span>
<span id="cb738-9"><a href="基于经典分布的假设检验.html#cb738-9" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(t_df, x <span class="sc">&gt;=</span> t_stat),</span>
<span id="cb738-10"><a href="基于经典分布的假设检验.html#cb738-10" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span></span>
<span id="cb738-11"><a href="基于经典分布的假设检验.html#cb738-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb738-12"><a href="基于经典分布的假设检验.html#cb738-12" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb738-13"><a href="基于经典分布的假设检验.html#cb738-13" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb738-14"><a href="基于经典分布的假设检验.html#cb738-14" tabindex="-1"></a>    <span class="at">x =</span> t_stat <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.2</span>,</span>
<span id="cb738-15"><a href="基于经典分布的假设检验.html#cb738-15" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;$t$ =&quot;</span>, <span class="fu">round</span>(t_stat, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb738-16"><a href="基于经典分布的假设检验.html#cb738-16" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb738-17"><a href="基于经典分布的假设检验.html#cb738-17" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb738-18"><a href="基于经典分布的假设检验.html#cb738-18" tabindex="-1"></a>    <span class="at">x =</span> t_stat <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.15</span>,</span>
<span id="cb738-19"><a href="基于经典分布的假设检验.html#cb738-19" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;$p$ =&quot;</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>)), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb738-20"><a href="基于经典分布的假设检验.html#cb738-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb738-21"><a href="基于经典分布的假设检验.html#cb738-21" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb738-22"><a href="基于经典分布的假设检验.html#cb738-22" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;配对样本t检验的可视化解释&quot;</span>,</span>
<span id="cb738-23"><a href="基于经典分布的假设检验.html#cb738-23" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;$t$统计量&quot;</span>, <span class="at">y =</span> <span class="st">&quot;密度&quot;</span>,</span>
<span id="cb738-24"><a href="基于经典分布的假设检验.html#cb738-24" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;红色区域表示$p$值，垂直线表示观测到的$t$统计量&quot;</span></span>
<span id="cb738-25"><a href="基于经典分布的假设检验.html#cb738-25" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb738-26"><a href="基于经典分布的假设检验.html#cb738-26" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:paired-t-test-visualization"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/paired-t-test-visualization-1.png" alt="配对样本t检验的可视化解释：展示配对差异均值的t分布、观测t统计量以及对应的p值区域" width="768" />
<p class="caption">
图6.10: 配对样本t检验的可视化解释：展示配对差异均值的t分布、观测t统计量以及对应的p值区域
</p>
</div>
<p>这个图表直观展示了配对样本t检验的原理。蓝色曲线表示在零假设下的<span class="math inline">\(t\)</span>分布，红色垂直线表示我们观测到的<span class="math inline">\(t\)</span>统计量，红色区域表示<span class="math inline">\(p\)</span>值——在零假设下观测到当前或更极端<span class="math inline">\(t\)</span>值的概率。</p>
</div>
<div id="mann-whitney-u检验" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Mann-Whitney U检验<a href="基于经典分布的假设检验.html#mann-whitney-u检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>当数据不满足正态分布假设，或者我们想要比较两个独立样本的中位数而不是均值时，<strong>Mann-Whitney U检验</strong>提供了一个强大的非参数替代方法。这个检验也被称为Wilcoxon秩和检验。</p>
<p>Mann-Whitney U检验的基本思想是将两个样本的所有观测值合并排序，然后基于秩次来检验两个样本是否来自相同的分布。其零假设和备择假设通常设定为：</p>
<ul>
<li><strong>零假设（<span class="math inline">\(H_0\)</span>）</strong>：两个样本来自相同的分布</li>
<li><strong>备择假设（<span class="math inline">\(H_1\)</span>）</strong>：两个样本来自不同的分布，或者一个样本倾向于产生更大的值</li>
</ul>
<p>检验统计量<span class="math inline">\(U\)</span>的计算基于秩次：</p>
<p><span class="math display">\[U = n_1 n_2 + \frac{n_1(n_1 + 1)}{2} - R_1\]</span></p>
<p>其中<span class="math inline">\(n_1\)</span>和<span class="math inline">\(n_2\)</span>是两个样本的样本量，<span class="math inline">\(R_1\)</span>是第一个样本的秩和。</p>
<p><strong>为什么使用秩次而不是原始值？</strong></p>
<p>使用秩次而不是原始值使得检验对极端值不敏感，也不依赖于数据的分布形态。这使得Mann-Whitney U检验特别适用于偏态分布、存在极端值或测量尺度是序数的情况。</p>
<p><strong>生态学意义</strong>：Mann-Whitney U检验在生态学中特别适用于以下情况：</p>
<ul>
<li>数据严重偏离正态分布</li>
<li>样本量很小，无法可靠地检验正态性</li>
<li>存在极端值或异常值</li>
<li>测量尺度是序数的，或者数据只包含相对大小信息</li>
</ul>
<p>例如，我们可以使用Mann-Whitney U检验来：</p>
<ul>
<li>比较不同污染程度区域的生物指标中位数</li>
<li>检验不同管理措施对物种丰富度的影响</li>
<li>比较不同生境类型中的个体大小分布</li>
</ul>
<p>让我们通过一个具体的生态学实例来理解Mann-Whitney U检验的应用：</p>
<blockquote>
<p><strong>实例：比较不同污染区域的生物指标</strong></p>
<p>假设我们研究工业污染对河流底栖动物群落的影响。我们在污染区域和清洁区域各采集了8个样品，测量底栖动物的生物量。由于数据存在极端值且分布偏态，我们选择使用Mann-Whitney U检验。</p>
<ul>
<li><strong>零假设（<span class="math inline">\(H_0\)</span>）</strong>：污染区域和清洁区域的底栖动物生物量来自相同的分布</li>
<li><strong>备择假设（<span class="math inline">\(H_1\)</span>）</strong>：污染区域的底栖动物生物量倾向于低于清洁区域</li>
</ul>
<p>这是一个单侧检验，因为我们预期污染会降低生物量。如果检验结果显示p &lt; 0.05，我们有统计证据表明污染确实对底栖动物群落产生了负面影响。</p>
</blockquote>
<p>Mann-Whitney U检验的主要优点是它对分布形态没有要求，对极端值不敏感。然而，它的缺点是统计功效通常低于对应的参数检验（t检验），因为它忽略了数据的数值信息，只使用秩次信息。</p>
<p>为了更好地理解Mann-Whitney U检验的原理，让我们通过R代码生成一个可视化图表：</p>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="基于经典分布的假设检验.html#cb739-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb739-2"><a href="基于经典分布的假设检验.html#cb739-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb739-3"><a href="基于经典分布的假设检验.html#cb739-3" tabindex="-1"></a></span>
<span id="cb739-4"><a href="基于经典分布的假设检验.html#cb739-4" tabindex="-1"></a><span class="co"># 模拟污染区域和清洁区域的底栖动物生物量数据（偏态分布）</span></span>
<span id="cb739-5"><a href="基于经典分布的假设检验.html#cb739-5" tabindex="-1"></a>polluted_area <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">3.5</span>, <span class="fl">4.2</span>, <span class="fl">5.8</span>, <span class="fl">7.3</span>, <span class="fl">9.1</span>, <span class="fl">12.5</span>, <span class="fl">15.8</span>) <span class="co"># 污染区域</span></span>
<span id="cb739-6"><a href="基于经典分布的假设检验.html#cb739-6" tabindex="-1"></a>clean_area <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">8.2</span>, <span class="fl">10.5</span>, <span class="fl">12.8</span>, <span class="fl">15.3</span>, <span class="fl">18.7</span>, <span class="fl">22.1</span>, <span class="fl">25.4</span>, <span class="fl">28.9</span>) <span class="co"># 清洁区域</span></span>
<span id="cb739-7"><a href="基于经典分布的假设检验.html#cb739-7" tabindex="-1"></a></span>
<span id="cb739-8"><a href="基于经典分布的假设检验.html#cb739-8" tabindex="-1"></a><span class="co"># 合并数据并计算秩次</span></span>
<span id="cb739-9"><a href="基于经典分布的假设检验.html#cb739-9" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">c</span>(polluted_area, clean_area)</span>
<span id="cb739-10"><a href="基于经典分布的假设检验.html#cb739-10" tabindex="-1"></a>ranks <span class="ot">&lt;-</span> <span class="fu">rank</span>(all_data)</span>
<span id="cb739-11"><a href="基于经典分布的假设检验.html#cb739-11" tabindex="-1"></a></span>
<span id="cb739-12"><a href="基于经典分布的假设检验.html#cb739-12" tabindex="-1"></a><span class="co"># 计算污染区域的秩和</span></span>
<span id="cb739-13"><a href="基于经典分布的假设检验.html#cb739-13" tabindex="-1"></a>rank_polluted <span class="ot">&lt;-</span> <span class="fu">sum</span>(ranks[<span class="fu">seq_along</span>(polluted_area)])</span>
<span id="cb739-14"><a href="基于经典分布的假设检验.html#cb739-14" tabindex="-1"></a></span>
<span id="cb739-15"><a href="基于经典分布的假设检验.html#cb739-15" tabindex="-1"></a><span class="co"># 计算U统计量</span></span>
<span id="cb739-16"><a href="基于经典分布的假设检验.html#cb739-16" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(polluted_area)</span>
<span id="cb739-17"><a href="基于经典分布的假设检验.html#cb739-17" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(clean_area)</span>
<span id="cb739-18"><a href="基于经典分布的假设检验.html#cb739-18" tabindex="-1"></a>u_stat <span class="ot">&lt;-</span> n1 <span class="sc">*</span> n2 <span class="sc">+</span> n1 <span class="sc">*</span> (n1 <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span> <span class="sc">-</span> rank_polluted</span>
<span id="cb739-19"><a href="基于经典分布的假设检验.html#cb739-19" tabindex="-1"></a></span>
<span id="cb739-20"><a href="基于经典分布的假设检验.html#cb739-20" tabindex="-1"></a><span class="co"># 执行Mann-Whitney U检验</span></span>
<span id="cb739-21"><a href="基于经典分布的假设检验.html#cb739-21" tabindex="-1"></a>mw_test <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(polluted_area, clean_area, <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span>
<span id="cb739-22"><a href="基于经典分布的假设检验.html#cb739-22" tabindex="-1"></a></span>
<span id="cb739-23"><a href="基于经典分布的假设检验.html#cb739-23" tabindex="-1"></a><span class="co"># 创建数据框用于可视化</span></span>
<span id="cb739-24"><a href="基于经典分布的假设检验.html#cb739-24" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb739-25"><a href="基于经典分布的假设检验.html#cb739-25" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;污染区域&quot;</span>, <span class="st">&quot;清洁区域&quot;</span>), <span class="at">each =</span> <span class="dv">8</span>),</span>
<span id="cb739-26"><a href="基于经典分布的假设检验.html#cb739-26" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(polluted_area, clean_area),</span>
<span id="cb739-27"><a href="基于经典分布的假设检验.html#cb739-27" tabindex="-1"></a>  <span class="at">rank =</span> ranks</span>
<span id="cb739-28"><a href="基于经典分布的假设检验.html#cb739-28" tabindex="-1"></a>)</span>
<span id="cb739-29"><a href="基于经典分布的假设检验.html#cb739-29" tabindex="-1"></a></span>
<span id="cb739-30"><a href="基于经典分布的假设检验.html#cb739-30" tabindex="-1"></a><span class="co"># 绘制箱线图和秩次图</span></span>
<span id="cb739-31"><a href="基于经典分布的假设检验.html#cb739-31" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb739-32"><a href="基于经典分布的假设检验.html#cb739-32" tabindex="-1"></a><span class="fu">ggplot</span>(data_df, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> value, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb739-33"><a href="基于经典分布的假设检验.html#cb739-33" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb739-34"><a href="基于经典分布的假设检验.html#cb739-34" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb739-35"><a href="基于经典分布的假设检验.html#cb739-35" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb739-36"><a href="基于经典分布的假设检验.html#cb739-36" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Mann-Whitney U检验的可视化解释&quot;</span>,</span>
<span id="cb739-37"><a href="基于经典分布的假设检验.html#cb739-37" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;区域类型&quot;</span>, <span class="at">y =</span> <span class="st">&quot;底栖动物生物量&quot;</span>,</span>
<span id="cb739-38"><a href="基于经典分布的假设检验.html#cb739-38" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;U统计量 =&quot;</span>, <span class="fu">round</span>(u_stat, <span class="dv">2</span>),</span>
<span id="cb739-39"><a href="基于经典分布的假设检验.html#cb739-39" tabindex="-1"></a>                     <span class="st">&quot;, p值 =&quot;</span>, <span class="fu">round</span>(mw_test<span class="sc">$</span>p.value, <span class="dv">4</span>))</span>
<span id="cb739-40"><a href="基于经典分布的假设检验.html#cb739-40" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb739-41"><a href="基于经典分布的假设检验.html#cb739-41" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb739-42"><a href="基于经典分布的假设检验.html#cb739-42" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#ff7f0e&quot;</span>, <span class="st">&quot;#1f77b4&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:mann-whitney-visualization"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/mann-whitney-visualization-1.png" alt="Mann-Whitney U检验的可视化解释：通过箱线图展示污染区域和清洁区域底栖动物生物量的分布比较" width="768" />
<p class="caption">
图6.11: Mann-Whitney U检验的可视化解释：通过箱线图展示污染区域和清洁区域底栖动物生物量的分布比较
</p>
</div>
<p>这个图表直观展示了Mann-Whitney U检验的原理。箱线图显示了两个样本的分布情况，点表示各个观测值。检验基于这些观测值的秩次（排序位置）而不是原始数值来进行统计推断。</p>
<p>在实际的生态学研究中，选择使用独立样本t检验、配对样本t检验还是Mann-Whitney U检验应该基于数据的特性、研究设计和研究问题的性质。如果数据满足正态分布和方差齐性假设，t检验通常更有效。如果数据严重偏离正态分布或存在极端值，Mann-Whitney U检验提供了更稳健的替代方法。配对样本t检验则专门用于配对设计的数据，通常具有更高的统计功效。</p>
</div>
</div>
<div id="多样本检验" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> 多样本检验<a href="基于经典分布的假设检验.html#多样本检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="方差分析anova" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> 方差分析（ANOVA）<a href="基于经典分布的假设检验.html#方差分析anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在生态学研究中，我们常常需要比较三个或更多组别的均值是否存在显著差异。<strong>方差分析（ANOVA）</strong>就是用于这种目的的参数检验方法，它通过分析组间变异与组内变异的比值来检验多个总体均值是否相等。</p>
<p>方差分析的基本思想是将总变异分解为组间变异和组内变异，然后比较这两种变异的相对大小。其零假设和备择假设通常设定为：</p>
<ul>
<li><strong>零假设（<span class="math inline">\(H_0\)</span>）</strong>：所有组的总体均值相等（<span class="math inline">\(\mu_1 = \mu_2 = \cdots = \mu_k\)</span>）</li>
<li><strong>备择假设（<span class="math inline">\(H_1\)</span>）</strong>：至少有一对组的总体均值不相等</li>
</ul>
<p>检验统计量<span class="math inline">\(F\)</span>的计算基于方差分解：</p>
<p><span class="math display">\[F = \frac{MS_{between}}{MS_{within}} = \frac{SS_{between} / df_{between}}{SS_{within} / df_{within}}\]</span></p>
<p>其中： - <span class="math inline">\(SS_{between}\)</span>是组间平方和，衡量组间变异 - <span class="math inline">\(SS_{within}\)</span>是组内平方和，衡量组内变异 - <span class="math inline">\(df_{between} = k - 1\)</span>是组间自由度 - <span class="math inline">\(df_{within} = N - k\)</span>是组内自由度 - <span class="math inline">\(k\)</span>是组数，<span class="math inline">\(N\)</span>是总样本量</p>
<p>这个统计量服从自由度为<span class="math inline">\((k-1, N-k)\)</span>的<span class="math inline">\(F\)</span>分布。</p>
<p><strong>为什么使用F统计量而不是多个t检验？</strong></p>
<p>使用多个t检验来比较所有组对会导致<strong>第一类错误率膨胀</strong>，这是一个在生态统计学中非常重要的概念。让我们通过数学计算和可视化来深入理解这个问题。</p>
<p><strong>第一类错误率膨胀的数学原理</strong></p>
<p>假设我们有<span class="math inline">\(k\)</span>个组，需要进行<span class="math inline">\(m\)</span>次两两比较，其中：</p>
<p><span class="math display">\[m = \frac{k(k-1)}{2}\]</span></p>
<p>如果每次t检验的显著性水平设为<span class="math inline">\(\alpha = 0.05\)</span>，那么：</p>
<ul>
<li>单次检验的第一类错误概率：<span class="math inline">\(\alpha = 0.05\)</span></li>
<li>单次检验的正确决策概率：<span class="math inline">\(1 - \alpha = 0.95\)</span></li>
<li>所有<span class="math inline">\(m\)</span>次检验都正确决策的概率：<span class="math inline">\((1 - \alpha)^m\)</span></li>
<li>至少犯一次第一类错误的概率：<span class="math inline">\(1 - (1 - \alpha)^m\)</span></li>
</ul>
<p>让我们计算不同组数下的累积第一类错误率：</p>
<table>
<thead>
<tr class="header">
<th>组数 (<span class="math inline">\(k\)</span>)</th>
<th>比较次数 (<span class="math inline">\(m\)</span>)</th>
<th>累积第一类错误率</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>1</td>
<td>5.0%</td>
</tr>
<tr class="even">
<td>3</td>
<td>3</td>
<td>14.3%</td>
</tr>
<tr class="odd">
<td>4</td>
<td>6</td>
<td>26.5%</td>
</tr>
<tr class="even">
<td>5</td>
<td>10</td>
<td>40.1%</td>
</tr>
<tr class="odd">
<td>6</td>
<td>15</td>
<td>53.7%</td>
</tr>
<tr class="even">
<td>7</td>
<td>21</td>
<td>65.9%</td>
</tr>
<tr class="odd">
<td>8</td>
<td>28</td>
<td>76.2%</td>
</tr>
</tbody>
</table>
<p>从表中可以看出，当组数增加到5个时，累积第一类错误率已经达到40.1%，这意味着即使所有组实际上没有差异，我们也有40.1%的概率至少得到一个”显著”的假阳性结果。</p>
<p><strong>方差分析的解决方案</strong></p>
<p>方差分析通过一次检验同时比较所有组，将第一类错误率控制在预设的<span class="math inline">\(\alpha\)</span>水平（通常是5%）。其零假设是：</p>
<p><span class="math display">\[H_0: \mu_1 = \mu_2 = \cdots = \mu_k\]</span></p>
<p>备择假设是：</p>
<p><span class="math display">\[H_1: \text{至少有一对组的均值不相等}\]</span></p>
<p>通过F检验，我们可以在保持第一类错误率不变的情况下，检验所有组间是否存在显著差异。</p>
<p><strong>生态学意义</strong></p>
<p>在生态学研究中，我们经常需要比较多个处理、多个生境或多个物种群体。如果使用多个t检验：</p>
<ul>
<li>我们可能会错误地宣称某些处理有效果，而实际上这些差异只是随机波动</li>
<li>研究结论的可靠性会大大降低</li>
<li>后续的保护决策或管理措施可能基于错误的发现</li>
</ul>
<p>让我们通过R代码生成一个可视化图表来直观理解这个问题：</p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="基于经典分布的假设检验.html#cb740-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb740-2"><a href="基于经典分布的假设检验.html#cb740-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb740-3"><a href="基于经典分布的假设检验.html#cb740-3" tabindex="-1"></a></span>
<span id="cb740-4"><a href="基于经典分布的假设检验.html#cb740-4" tabindex="-1"></a><span class="co"># 模拟数据：实际上所有组来自相同的分布（零假设为真）</span></span>
<span id="cb740-5"><a href="基于经典分布的假设检验.html#cb740-5" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># 组数</span></span>
<span id="cb740-6"><a href="基于经典分布的假设检验.html#cb740-6" tabindex="-1"></a>n_per_group <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># 每组样本量</span></span>
<span id="cb740-7"><a href="基于经典分布的假设检验.html#cb740-7" tabindex="-1"></a></span>
<span id="cb740-8"><a href="基于经典分布的假设检验.html#cb740-8" tabindex="-1"></a><span class="co"># 生成数据 - 所有组都来自N(0,1)分布</span></span>
<span id="cb740-9"><a href="基于经典分布的假设检验.html#cb740-9" tabindex="-1"></a>group_data <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb740-10"><a href="基于经典分布的假设检验.html#cb740-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb740-11"><a href="基于经典分布的假设检验.html#cb740-11" tabindex="-1"></a>  group_data[[i]] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_per_group, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb740-12"><a href="基于经典分布的假设检验.html#cb740-12" tabindex="-1"></a>}</span>
<span id="cb740-13"><a href="基于经典分布的假设检验.html#cb740-13" tabindex="-1"></a></span>
<span id="cb740-14"><a href="基于经典分布的假设检验.html#cb740-14" tabindex="-1"></a><span class="co"># 计算所有两两比较的t检验</span></span>
<span id="cb740-15"><a href="基于经典分布的假设检验.html#cb740-15" tabindex="-1"></a>comparisons <span class="ot">&lt;-</span> <span class="fu">combn</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="dv">2</span>) <span class="co"># 所有可能的组对</span></span>
<span id="cb740-16"><a href="基于经典分布的假设检验.html#cb740-16" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">ncol</span>(comparisons) <span class="co"># 比较次数</span></span>
<span id="cb740-17"><a href="基于经典分布的假设检验.html#cb740-17" tabindex="-1"></a></span>
<span id="cb740-18"><a href="基于经典分布的假设检验.html#cb740-18" tabindex="-1"></a><span class="co"># 存储p值</span></span>
<span id="cb740-19"><a href="基于经典分布的假设检验.html#cb740-19" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb740-20"><a href="基于经典分布的假设检验.html#cb740-20" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb740-21"><a href="基于经典分布的假设检验.html#cb740-21" tabindex="-1"></a>  group1 <span class="ot">&lt;-</span> comparisons[<span class="dv">1</span>, i]</span>
<span id="cb740-22"><a href="基于经典分布的假设检验.html#cb740-22" tabindex="-1"></a>  group2 <span class="ot">&lt;-</span> comparisons[<span class="dv">2</span>, i]</span>
<span id="cb740-23"><a href="基于经典分布的假设检验.html#cb740-23" tabindex="-1"></a>  t_test_result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(group_data[[group1]], group_data[[group2]])</span>
<span id="cb740-24"><a href="基于经典分布的假设检验.html#cb740-24" tabindex="-1"></a>  p_values[i] <span class="ot">&lt;-</span> t_test_result<span class="sc">$</span>p.value</span>
<span id="cb740-25"><a href="基于经典分布的假设检验.html#cb740-25" tabindex="-1"></a>}</span>
<span id="cb740-26"><a href="基于经典分布的假设检验.html#cb740-26" tabindex="-1"></a></span>
<span id="cb740-27"><a href="基于经典分布的假设检验.html#cb740-27" tabindex="-1"></a><span class="co"># 执行方差分析</span></span>
<span id="cb740-28"><a href="基于经典分布的假设检验.html#cb740-28" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">unlist</span>(group_data)</span>
<span id="cb740-29"><a href="基于经典分布的假设检验.html#cb740-29" tabindex="-1"></a>group_labels <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">each =</span> n_per_group)</span>
<span id="cb740-30"><a href="基于经典分布的假设检验.html#cb740-30" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(all_data <span class="sc">~</span> <span class="fu">factor</span>(group_labels))</span>
<span id="cb740-31"><a href="基于经典分布的假设检验.html#cb740-31" tabindex="-1"></a>anova_p <span class="ot">&lt;-</span> <span class="fu">summary</span>(anova_result)[[<span class="dv">1</span>]][<span class="st">&quot;factor(group_labels)&quot;</span>, <span class="st">&quot;Pr(&gt;F)&quot;</span>]</span></code></pre></div>
<p><strong>数据生成说明</strong>：这段代码模拟了5个组的数据，所有组实际上来自相同的正态分布（零假设为真）。然后进行了所有可能的组对t检验（共10次比较），并执行了方差分析。</p>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="基于经典分布的假设检验.html#cb741-1" tabindex="-1"></a><span class="co"># 创建可视化数据</span></span>
<span id="cb741-2"><a href="基于经典分布的假设检验.html#cb741-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb741-3"><a href="基于经典分布的假设检验.html#cb741-3" tabindex="-1"></a></span>
<span id="cb741-4"><a href="基于经典分布的假设检验.html#cb741-4" tabindex="-1"></a><span class="co"># 数据框1：多个t检验的结果</span></span>
<span id="cb741-5"><a href="基于经典分布的假设检验.html#cb741-5" tabindex="-1"></a>t_test_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb741-6"><a href="基于经典分布的假设检验.html#cb741-6" tabindex="-1"></a>  <span class="at">comparison =</span> <span class="dv">1</span><span class="sc">:</span>m,</span>
<span id="cb741-7"><a href="基于经典分布的假设检验.html#cb741-7" tabindex="-1"></a>  <span class="at">p_value =</span> p_values,</span>
<span id="cb741-8"><a href="基于经典分布的假设检验.html#cb741-8" tabindex="-1"></a>  <span class="at">significant =</span> p_values <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb741-9"><a href="基于经典分布的假设检验.html#cb741-9" tabindex="-1"></a>)</span>
<span id="cb741-10"><a href="基于经典分布的假设检验.html#cb741-10" tabindex="-1"></a></span>
<span id="cb741-11"><a href="基于经典分布的假设检验.html#cb741-11" tabindex="-1"></a><span class="co"># 数据框2：方差分析结果</span></span>
<span id="cb741-12"><a href="基于经典分布的假设检验.html#cb741-12" tabindex="-1"></a>anova_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb741-13"><a href="基于经典分布的假设检验.html#cb741-13" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;ANOVA&quot;</span>,</span>
<span id="cb741-14"><a href="基于经典分布的假设检验.html#cb741-14" tabindex="-1"></a>  <span class="at">p_value =</span> anova_p,</span>
<span id="cb741-15"><a href="基于经典分布的假设检验.html#cb741-15" tabindex="-1"></a>  <span class="at">significant =</span> anova_p <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb741-16"><a href="基于经典分布的假设检验.html#cb741-16" tabindex="-1"></a>)</span>
<span id="cb741-17"><a href="基于经典分布的假设检验.html#cb741-17" tabindex="-1"></a></span>
<span id="cb741-18"><a href="基于经典分布的假设检验.html#cb741-18" tabindex="-1"></a><span class="co"># 计算累积第一类错误率</span></span>
<span id="cb741-19"><a href="基于经典分布的假设检验.html#cb741-19" tabindex="-1"></a>cumulative_error <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb741-20"><a href="基于经典分布的假设检验.html#cb741-20" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>,</span>
<span id="cb741-21"><a href="基于经典分布的假设检验.html#cb741-21" tabindex="-1"></a>  <span class="at">comparisons =</span> <span class="fu">choose</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">2</span>),</span>
<span id="cb741-22"><a href="基于经典分布的假设检验.html#cb741-22" tabindex="-1"></a>  <span class="at">error_rate =</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>)<span class="sc">^</span><span class="fu">choose</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">2</span>)</span>
<span id="cb741-23"><a href="基于经典分布的假设检验.html#cb741-23" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>数据准备说明</strong>：这段代码准备了用于可视化的数据，包括多个t检验的结果、方差分析结果，以及计算了不同组数下的累积第一类错误率。</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="基于经典分布的假设检验.html#cb742-1" tabindex="-1"></a><span class="co"># 绘制多个t检验的p值分布</span></span>
<span id="cb742-2"><a href="基于经典分布的假设检验.html#cb742-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(t_test_df, <span class="fu">aes</span>(</span>
<span id="cb742-3"><a href="基于经典分布的假设检验.html#cb742-3" tabindex="-1"></a>  <span class="at">x =</span> comparison, <span class="at">y =</span> p_value,</span>
<span id="cb742-4"><a href="基于经典分布的假设检验.html#cb742-4" tabindex="-1"></a>  <span class="at">color =</span> significant, <span class="at">shape =</span> significant</span>
<span id="cb742-5"><a href="基于经典分布的假设检验.html#cb742-5" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb742-6"><a href="基于经典分布的假设检验.html#cb742-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb742-7"><a href="基于经典分布的假设检验.html#cb742-7" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.05</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb742-8"><a href="基于经典分布的假设检验.html#cb742-8" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb742-9"><a href="基于经典分布的假设检验.html#cb742-9" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="dv">16</span>, <span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb742-10"><a href="基于经典分布的假设检验.html#cb742-10" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb742-11"><a href="基于经典分布的假设检验.html#cb742-11" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;多个t检验：p值分布&quot;</span>,</span>
<span id="cb742-12"><a href="基于经典分布的假设检验.html#cb742-12" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;比较编号&quot;</span>, <span class="at">y =</span> <span class="st">&quot;p值&quot;</span>,</span>
<span id="cb742-13"><a href="基于经典分布的假设检验.html#cb742-13" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;假阳性数量：&quot;</span>, <span class="fu">sum</span>(t_test_df<span class="sc">$</span>significant), <span class="st">&quot;/&quot;</span>, m)</span>
<span id="cb742-14"><a href="基于经典分布的假设检验.html#cb742-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb742-15"><a href="基于经典分布的假设检验.html#cb742-15" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb742-16"><a href="基于经典分布的假设检验.html#cb742-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb742-17"><a href="基于经典分布的假设检验.html#cb742-17" tabindex="-1"></a></span>
<span id="cb742-18"><a href="基于经典分布的假设检验.html#cb742-18" tabindex="-1"></a><span class="co"># 绘制累积第一类错误率</span></span>
<span id="cb742-19"><a href="基于经典分布的假设检验.html#cb742-19" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cumulative_error, <span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> error_rate)) <span class="sc">+</span></span>
<span id="cb742-20"><a href="基于经典分布的假设检验.html#cb742-20" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb742-21"><a href="基于经典分布的假设检验.html#cb742-21" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb742-22"><a href="基于经典分布的假设检验.html#cb742-22" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.05</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb742-23"><a href="基于经典分布的假设检验.html#cb742-23" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(error_rate <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)),</span>
<span id="cb742-24"><a href="基于经典分布的假设检验.html#cb742-24" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb742-25"><a href="基于经典分布的假设检验.html#cb742-25" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb742-26"><a href="基于经典分布的假设检验.html#cb742-26" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb742-27"><a href="基于经典分布的假设检验.html#cb742-27" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;累积第一类错误率&quot;</span>,</span>
<span id="cb742-28"><a href="基于经典分布的假设检验.html#cb742-28" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;组数 (k)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;累积第一类错误率&quot;</span>,</span>
<span id="cb742-29"><a href="基于经典分布的假设检验.html#cb742-29" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;红色虚线表示期望的5%错误率&quot;</span></span>
<span id="cb742-30"><a href="基于经典分布的假设检验.html#cb742-30" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb742-31"><a href="基于经典分布的假设检验.html#cb742-31" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb742-32"><a href="基于经典分布的假设检验.html#cb742-32" tabindex="-1"></a></span>
<span id="cb742-33"><a href="基于经典分布的假设检验.html#cb742-33" tabindex="-1"></a><span class="co"># 使用patchwork包组合图形</span></span>
<span id="cb742-34"><a href="基于经典分布的假设检验.html#cb742-34" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb742-35"><a href="基于经典分布的假设检验.html#cb742-35" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">plot_annotation</span>(</span>
<span id="cb742-36"><a href="基于经典分布的假设检验.html#cb742-36" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;多个t检验 vs 方差分析：第一类错误率控制&quot;</span>,</span>
<span id="cb742-37"><a href="基于经典分布的假设检验.html#cb742-37" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="fu">paste</span>(</span>
<span id="cb742-38"><a href="基于经典分布的假设检验.html#cb742-38" tabindex="-1"></a>    <span class="st">&quot;ANOVA p值：&quot;</span>, <span class="fu">round</span>(anova_p, <span class="dv">4</span>),</span>
<span id="cb742-39"><a href="基于经典分布的假设检验.html#cb742-39" tabindex="-1"></a>    <span class="st">&quot;（正确不拒绝零假设）&quot;</span></span>
<span id="cb742-40"><a href="基于经典分布的假设检验.html#cb742-40" tabindex="-1"></a>  )</span>
<span id="cb742-41"><a href="基于经典分布的假设检验.html#cb742-41" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:multiple-t-test-vs-anova"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/multiple-t-test-vs-anova-1.png" alt="多个t检验与方差分析的比较：展示多重比较导致的第一类错误率膨胀问题以及方差分析的解决方案" width="960" />
<p class="caption">
图6.12: 多个t检验与方差分析的比较：展示多重比较导致的第一类错误率膨胀问题以及方差分析的解决方案
</p>
</div>
<p><strong>图表解释</strong></p>
<ol style="list-style-type: decimal">
<li><strong>左图：多个t检验的p值分布</strong>
<ul>
<li>每个点代表一次两两比较的p值</li>
<li>红色点表示”显著”结果（p &lt; 0.05）</li>
<li>即使所有组实际上来自相同的分布（零假设为真），由于进行了多次检验，我们仍然可能得到一些”显著”的假阳性结果</li>
</ul></li>
<li><strong>右图：累积第一类错误率</strong>
<ul>
<li>随着组数增加，需要进行的两两比较次数急剧增加</li>
<li>累积第一类错误率迅速上升，远超过期望的5%水平</li>
<li>当组数达到8个时，累积第一类错误率高达76.2%</li>
</ul></li>
</ol>
<p><strong>实际生态学应用建议</strong></p>
<p>在生态学研究中，我们应该：</p>
<ol style="list-style-type: decimal">
<li><p><strong>首选方差分析</strong>：当比较三个或更多组时，使用方差分析而不是多个t检验</p></li>
<li><p><strong>如果方差分析显著，再进行事后检验</strong>：</p>
<ul>
<li>使用Tukey HSD检验进行所有两两比较</li>
<li>使用Bonferroni校正调整p值</li>
<li>使用Scheffé方法进行复杂的对比</li>
</ul></li>
<li><p><strong>报告完整的分析流程</strong>：</p>
<ul>
<li>先报告方差分析的总体结果</li>
<li>如果显著，再报告具体哪些组间存在差异</li>
<li>说明使用的多重比较校正方法</li>
</ul></li>
<li><p><strong>考虑研究设计</strong>：</p>
<ul>
<li>在实验设计阶段就考虑使用方差分析</li>
<li>确保样本量足够检测预期的效应大小</li>
<li>考虑使用重复测量方差分析处理时间序列数据</li>
</ul></li>
</ol>
<p>通过使用方差分析而不是多个t检验，我们能够在保持统计严谨性的同时，得出更可靠的生态学结论，为生态保护和管理决策提供更坚实的科学依据。</p>
<p><strong>单因素方差分析与多因素方差分析</strong></p>
<ul>
<li><strong>单因素方差分析</strong>：只有一个分类自变量，用于比较不同处理、不同生境或不同群体的效应</li>
<li><strong>多因素方差分析</strong>：有多个分类自变量，可以同时检验主效应和交互效应</li>
</ul>
<p><strong>生态学意义</strong>：方差分析在生态学中有广泛的应用。例如，我们可以检验：</p>
<ul>
<li>不同施肥水平对作物产量的影响</li>
<li>不同森林类型中的鸟类多样性差异</li>
<li>不同污染程度水域的水生生物群落差异</li>
<li>不同管理措施对草地生产力的影响</li>
</ul>
<p>让我们通过一个具体的生态学实例来理解方差分析的应用：</p>
<blockquote>
<p><strong>实例：比较不同森林类型的鸟类多样性</strong></p>
<p>假设我们研究三种不同森林类型（阔叶林、针叶林、混交林）中的鸟类多样性。我们在每种森林类型中随机选择10个样点，调查鸟类物种丰富度。</p>
<ul>
<li><strong>零假设（<span class="math inline">\(H_0\)</span>）</strong>：三种森林类型的鸟类物种丰富度均值相等</li>
<li><strong>备择假设（<span class="math inline">\(H_1\)</span>）</strong>：至少有一种森林类型的鸟类物种丰富度均值与其他不同</li>
</ul>
<p>如果方差分析结果显示p &lt; 0.05，我们有统计证据表明不同森林类型对鸟类多样性产生了显著影响。</p>
</blockquote>
<p>方差分析的使用需要满足一些前提条件：数据应该近似正态分布，各组方差应该相等（方差齐性），观测值之间相互独立。如果这些条件不满足，我们可能需要考虑使用非参数检验方法。</p>
<p>为了更好地理解方差分析的原理，让我们通过R代码生成一个可视化图表：</p>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="基于经典分布的假设检验.html#cb743-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb743-2"><a href="基于经典分布的假设检验.html#cb743-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb743-3"><a href="基于经典分布的假设检验.html#cb743-3" tabindex="-1"></a></span>
<span id="cb743-4"><a href="基于经典分布的假设检验.html#cb743-4" tabindex="-1"></a><span class="co"># 模拟三种森林类型的鸟类物种丰富度数据</span></span>
<span id="cb743-5"><a href="基于经典分布的假设检验.html#cb743-5" tabindex="-1"></a>broadleaf <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">2</span>) <span class="co"># 阔叶林</span></span>
<span id="cb743-6"><a href="基于经典分布的假设检验.html#cb743-6" tabindex="-1"></a>coniferous <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">12</span>, <span class="at">sd =</span> <span class="dv">2</span>) <span class="co"># 针叶林</span></span>
<span id="cb743-7"><a href="基于经典分布的假设检验.html#cb743-7" tabindex="-1"></a>mixed <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">14</span>, <span class="at">sd =</span> <span class="dv">2</span>) <span class="co"># 混交林</span></span>
<span id="cb743-8"><a href="基于经典分布的假设检验.html#cb743-8" tabindex="-1"></a></span>
<span id="cb743-9"><a href="基于经典分布的假设检验.html#cb743-9" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb743-10"><a href="基于经典分布的假设检验.html#cb743-10" tabindex="-1"></a>forest_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb743-11"><a href="基于经典分布的假设检验.html#cb743-11" tabindex="-1"></a>  <span class="at">richness =</span> <span class="fu">c</span>(broadleaf, coniferous, mixed),</span>
<span id="cb743-12"><a href="基于经典分布的假设检验.html#cb743-12" tabindex="-1"></a>  <span class="at">forest_type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;阔叶林&quot;</span>, <span class="st">&quot;针叶林&quot;</span>, <span class="st">&quot;混交林&quot;</span>), <span class="at">each =</span> <span class="dv">10</span>)</span>
<span id="cb743-13"><a href="基于经典分布的假设检验.html#cb743-13" tabindex="-1"></a>)</span>
<span id="cb743-14"><a href="基于经典分布的假设检验.html#cb743-14" tabindex="-1"></a></span>
<span id="cb743-15"><a href="基于经典分布的假设检验.html#cb743-15" tabindex="-1"></a><span class="co"># 执行方差分析</span></span>
<span id="cb743-16"><a href="基于经典分布的假设检验.html#cb743-16" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(richness <span class="sc">~</span> forest_type, <span class="at">data =</span> forest_data)</span>
<span id="cb743-17"><a href="基于经典分布的假设检验.html#cb743-17" tabindex="-1"></a></span>
<span id="cb743-18"><a href="基于经典分布的假设检验.html#cb743-18" tabindex="-1"></a><span class="co"># 提取F统计量和p值</span></span>
<span id="cb743-19"><a href="基于经典分布的假设检验.html#cb743-19" tabindex="-1"></a>f_stat <span class="ot">&lt;-</span> <span class="fu">summary</span>(anova_result)[[<span class="dv">1</span>]][<span class="st">&quot;forest_type&quot;</span>, <span class="st">&quot;F value&quot;</span>]</span>
<span id="cb743-20"><a href="基于经典分布的假设检验.html#cb743-20" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">summary</span>(anova_result)[[<span class="dv">1</span>]][<span class="st">&quot;forest_type&quot;</span>, <span class="st">&quot;Pr(&gt;F)&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="基于经典分布的假设检验.html#cb744-1" tabindex="-1"></a><span class="co"># 生成F分布数据</span></span>
<span id="cb744-2"><a href="基于经典分布的假设检验.html#cb744-2" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># 组间自由度 $k-1$</span></span>
<span id="cb744-3"><a href="基于经典分布的假设检验.html#cb744-3" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="dv">27</span> <span class="co"># 组内自由度 $N-k$</span></span>
<span id="cb744-4"><a href="基于经典分布的假设检验.html#cb744-4" tabindex="-1"></a>x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb744-5"><a href="基于经典分布的假设检验.html#cb744-5" tabindex="-1"></a>f_density <span class="ot">&lt;-</span> <span class="fu">df</span>(x_vals, <span class="at">df1 =</span> df1, <span class="at">df2 =</span> df2)</span>
<span id="cb744-6"><a href="基于经典分布的假设检验.html#cb744-6" tabindex="-1"></a></span>
<span id="cb744-7"><a href="基于经典分布的假设检验.html#cb744-7" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb744-8"><a href="基于经典分布的假设检验.html#cb744-8" tabindex="-1"></a>f_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_vals, <span class="at">density =</span> f_density)</span></code></pre></div>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="基于经典分布的假设检验.html#cb745-1" tabindex="-1"></a><span class="co"># 绘制F分布图</span></span>
<span id="cb745-2"><a href="基于经典分布的假设检验.html#cb745-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb745-3"><a href="基于经典分布的假设检验.html#cb745-3" tabindex="-1"></a><span class="fu">ggplot</span>(f_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density)) <span class="sc">+</span></span>
<span id="cb745-4"><a href="基于经典分布的假设检验.html#cb745-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb745-5"><a href="基于经典分布的假设检验.html#cb745-5" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb745-6"><a href="基于经典分布的假设检验.html#cb745-6" tabindex="-1"></a>    <span class="at">xintercept =</span> f_stat, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb745-7"><a href="基于经典分布的假设检验.html#cb745-7" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span></span>
<span id="cb745-8"><a href="基于经典分布的假设检验.html#cb745-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb745-9"><a href="基于经典分布的假设检验.html#cb745-9" tabindex="-1"></a>  <span class="fu">geom_area</span>(</span>
<span id="cb745-10"><a href="基于经典分布的假设检验.html#cb745-10" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">subset</span>(f_df, x <span class="sc">&gt;=</span> f_stat),</span>
<span id="cb745-11"><a href="基于经典分布的假设检验.html#cb745-11" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> density), <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span></span>
<span id="cb745-12"><a href="基于经典分布的假设检验.html#cb745-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb745-13"><a href="基于经典分布的假设检验.html#cb745-13" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb745-14"><a href="基于经典分布的假设检验.html#cb745-14" tabindex="-1"></a>    <span class="at">x =</span> f_stat <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.2</span>,</span>
<span id="cb745-15"><a href="基于经典分布的假设检验.html#cb745-15" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;$F$ =&quot;</span>, <span class="fu">round</span>(f_stat, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb745-16"><a href="基于经典分布的假设检验.html#cb745-16" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb745-17"><a href="基于经典分布的假设检验.html#cb745-17" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb745-18"><a href="基于经典分布的假设检验.html#cb745-18" tabindex="-1"></a>    <span class="at">x =</span> f_stat <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.15</span>,</span>
<span id="cb745-19"><a href="基于经典分布的假设检验.html#cb745-19" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;$p$ =&quot;</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>)), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb745-20"><a href="基于经典分布的假设检验.html#cb745-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb745-21"><a href="基于经典分布的假设检验.html#cb745-21" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb745-22"><a href="基于经典分布的假设检验.html#cb745-22" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;方差分析的可视化解释&quot;</span>,</span>
<span id="cb745-23"><a href="基于经典分布的假设检验.html#cb745-23" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;$F$统计量&quot;</span>, <span class="at">y =</span> <span class="st">&quot;密度&quot;</span>,</span>
<span id="cb745-24"><a href="基于经典分布的假设检验.html#cb745-24" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;红色区域表示$p$值，垂直线表示观测到的$F$统计量&quot;</span></span>
<span id="cb745-25"><a href="基于经典分布的假设检验.html#cb745-25" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb745-26"><a href="基于经典分布的假设检验.html#cb745-26" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:anova-visualization"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/anova-visualization-1.png" alt="方差分析的可视化解释：展示F分布、观测F统计量以及对应的p值区域" width="768" />
<p class="caption">
图6.13: 方差分析的可视化解释：展示F分布、观测F统计量以及对应的p值区域
</p>
</div>
<p>这个图表直观展示了方差分析的原理。蓝色曲线表示在零假设下的<span class="math inline">\(F\)</span>分布，红色垂直线表示我们观测到的<span class="math inline">\(F\)</span>统计量，红色区域表示<span class="math inline">\(p\)</span>值——在零假设下观测到当前或更极端<span class="math inline">\(F\)</span>值的概率。</p>
</div>
<div id="kruskal-wallis检验" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Kruskal-Wallis检验<a href="基于经典分布的假设检验.html#kruskal-wallis检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>当数据不满足正态分布假设，或者我们想要比较多个独立样本的中位数而不是均值时，<strong>Kruskal-Wallis检验</strong>提供了一个强大的非参数替代方法。这个检验是Mann-Whitney U检验在多个样本情况下的扩展。</p>
<p>Kruskal-Wallis检验的基本思想是将所有样本的观测值合并排序，然后基于秩次来检验多个样本是否来自相同的分布。其零假设和备择假设通常设定为：</p>
<ul>
<li><strong>零假设（<span class="math inline">\(H_0\)</span>）</strong>：所有样本来自相同的分布</li>
<li><strong>备择假设（<span class="math inline">\(H_1\)</span>）</strong>：至少有一个样本来自不同的分布</li>
</ul>
<p>检验统计量<span class="math inline">\(H\)</span>的计算基于秩次：</p>
<p><span class="math display">\[H = \frac{12}{N(N+1)} \sum_{i=1}^k \frac{R_i^2}{n_i} - 3(N+1)\]</span></p>
<p>其中： - <span class="math inline">\(k\)</span>是组数 - <span class="math inline">\(n_i\)</span>是第<span class="math inline">\(i\)</span>组的样本量 - <span class="math inline">\(R_i\)</span>是第<span class="math inline">\(i\)</span>组的秩和 - <span class="math inline">\(N\)</span>是总样本量</p>
<p>在大样本情况下，<span class="math inline">\(H\)</span>统计量近似服从自由度为<span class="math inline">\(k-1\)</span>的卡方分布。</p>
<p><strong>为什么使用秩次而不是原始值？</strong></p>
<p>使用秩次而不是原始值使得检验对极端值不敏感，也不依赖于数据的分布形态。这使得Kruskal-Wallis检验特别适用于偏态分布、存在极端值或测量尺度是序数的情况。</p>
<p><strong>生态学意义</strong>：Kruskal-Wallis检验在生态学中特别适用于以下情况：</p>
<ul>
<li>数据严重偏离正态分布</li>
<li>样本量很小，无法可靠地检验正态性</li>
<li>存在极端值或异常值</li>
<li>测量尺度是序数的，或者数据只包含相对大小信息</li>
</ul>
<p>例如，我们可以使用Kruskal-Wallis检验来：</p>
<ul>
<li>比较不同污染程度区域的多个生物指标</li>
<li>检验不同管理措施对多个物种丰富度的影响</li>
<li>比较不同生境类型中的多个个体大小分布</li>
</ul>
<p>让我们通过一个具体的生态学实例来理解Kruskal-Wallis检验的应用：</p>
<blockquote>
<p><strong>实例：比较不同污染程度区域的底栖动物生物量</strong></p>
<p>假设我们研究工业污染对河流底栖动物群落的影响。我们在轻度污染、中度污染和重度污染区域各采集了8个样品，测量底栖动物的生物量。由于数据存在极端值且分布偏态，我们选择使用Kruskal-Wallis检验。</p>
<ul>
<li><strong>零假设（<span class="math inline">\(H_0\)</span>）</strong>：三种污染程度区域的底栖动物生物量来自相同的分布</li>
<li><strong>备择假设（<span class="math inline">\(H_1\)</span>）</strong>：至少有一种污染程度区域的底栖动物生物量分布与其他不同</li>
</ul>
<p>如果检验结果显示p &lt; 0.05，我们有统计证据表明污染程度确实对底栖动物群落产生了显著影响。</p>
</blockquote>
<p>Kruskal-Wallis检验的主要优点是它对分布形态没有要求，对极端值不敏感。然而，它的缺点是统计功效通常低于对应的参数检验（方差分析），因为它忽略了数据的数值信息，只使用秩次信息。</p>
<p>为了更好地理解Kruskal-Wallis检验的原理，让我们通过R代码生成一个可视化图表：</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="基于经典分布的假设检验.html#cb746-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb746-2"><a href="基于经典分布的假设检验.html#cb746-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb746-3"><a href="基于经典分布的假设检验.html#cb746-3" tabindex="-1"></a></span>
<span id="cb746-4"><a href="基于经典分布的假设检验.html#cb746-4" tabindex="-1"></a><span class="co"># 模拟三种污染程度区域的底栖动物生物量数据（偏态分布）</span></span>
<span id="cb746-5"><a href="基于经典分布的假设检验.html#cb746-5" tabindex="-1"></a>light_pollution <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">8.2</span>, <span class="fl">10.5</span>, <span class="fl">12.8</span>, <span class="fl">15.3</span>, <span class="fl">18.7</span>, <span class="fl">22.1</span>, <span class="fl">25.4</span>, <span class="fl">28.9</span>) <span class="co"># 轻度污染</span></span>
<span id="cb746-6"><a href="基于经典分布的假设检验.html#cb746-6" tabindex="-1"></a>moderate_pollution <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.8</span>, <span class="fl">7.3</span>, <span class="fl">9.1</span>, <span class="fl">12.5</span>, <span class="fl">15.8</span>, <span class="fl">18.2</span>, <span class="fl">21.7</span>, <span class="fl">24.3</span>) <span class="co"># 中度污染</span></span>
<span id="cb746-7"><a href="基于经典分布的假设检验.html#cb746-7" tabindex="-1"></a>heavy_pollution <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">3.5</span>, <span class="fl">4.2</span>, <span class="fl">5.8</span>, <span class="fl">7.3</span>, <span class="fl">9.1</span>, <span class="fl">12.5</span>, <span class="fl">15.8</span>) <span class="co"># 重度污染</span></span>
<span id="cb746-8"><a href="基于经典分布的假设检验.html#cb746-8" tabindex="-1"></a></span>
<span id="cb746-9"><a href="基于经典分布的假设检验.html#cb746-9" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb746-10"><a href="基于经典分布的假设检验.html#cb746-10" tabindex="-1"></a>pollution_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb746-11"><a href="基于经典分布的假设检验.html#cb746-11" tabindex="-1"></a>  <span class="at">biomass =</span> <span class="fu">c</span>(light_pollution, moderate_pollution, heavy_pollution),</span>
<span id="cb746-12"><a href="基于经典分布的假设检验.html#cb746-12" tabindex="-1"></a>  <span class="at">pollution_level =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;轻度污染&quot;</span>, <span class="st">&quot;中度污染&quot;</span>, <span class="st">&quot;重度污染&quot;</span>), <span class="at">each =</span> <span class="dv">8</span>)</span>
<span id="cb746-13"><a href="基于经典分布的假设检验.html#cb746-13" tabindex="-1"></a>)</span>
<span id="cb746-14"><a href="基于经典分布的假设检验.html#cb746-14" tabindex="-1"></a></span>
<span id="cb746-15"><a href="基于经典分布的假设检验.html#cb746-15" tabindex="-1"></a><span class="co"># 执行Kruskal-Wallis检验</span></span>
<span id="cb746-16"><a href="基于经典分布的假设检验.html#cb746-16" tabindex="-1"></a>kw_test <span class="ot">&lt;-</span> <span class="fu">kruskal.test</span>(biomass <span class="sc">~</span> pollution_level, <span class="at">data =</span> pollution_data)</span>
<span id="cb746-17"><a href="基于经典分布的假设检验.html#cb746-17" tabindex="-1"></a></span>
<span id="cb746-18"><a href="基于经典分布的假设检验.html#cb746-18" tabindex="-1"></a><span class="co"># 创建数据框用于可视化</span></span>
<span id="cb746-19"><a href="基于经典分布的假设检验.html#cb746-19" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb746-20"><a href="基于经典分布的假设检验.html#cb746-20" tabindex="-1"></a><span class="fu">ggplot</span>(pollution_data, <span class="fu">aes</span>(<span class="at">x =</span> pollution_level, <span class="at">y =</span> biomass,</span>
<span id="cb746-21"><a href="基于经典分布的假设检验.html#cb746-21" tabindex="-1"></a>                           <span class="at">fill =</span> pollution_level)) <span class="sc">+</span></span>
<span id="cb746-22"><a href="基于经典分布的假设检验.html#cb746-22" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb746-23"><a href="基于经典分布的假设检验.html#cb746-23" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb746-24"><a href="基于经典分布的假设检验.html#cb746-24" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb746-25"><a href="基于经典分布的假设检验.html#cb746-25" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Kruskal-Wallis检验的可视化解释&quot;</span>,</span>
<span id="cb746-26"><a href="基于经典分布的假设检验.html#cb746-26" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;污染程度&quot;</span>, <span class="at">y =</span> <span class="st">&quot;底栖动物生物量&quot;</span>,</span>
<span id="cb746-27"><a href="基于经典分布的假设检验.html#cb746-27" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;H统计量 =&quot;</span>, <span class="fu">round</span>(kw_test<span class="sc">$</span>statistic, <span class="dv">2</span>),</span>
<span id="cb746-28"><a href="基于经典分布的假设检验.html#cb746-28" tabindex="-1"></a>                     <span class="st">&quot;, p值 =&quot;</span>, <span class="fu">round</span>(kw_test<span class="sc">$</span>p.value, <span class="dv">4</span>))</span>
<span id="cb746-29"><a href="基于经典分布的假设检验.html#cb746-29" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb746-30"><a href="基于经典分布的假设检验.html#cb746-30" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb746-31"><a href="基于经典分布的假设检验.html#cb746-31" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1f77b4&quot;</span>, <span class="st">&quot;#ff7f0e&quot;</span>, <span class="st">&quot;#2ca02c&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kruskal-wallis-visualization"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/kruskal-wallis-visualization-1.png" alt="Kruskal-Wallis检验的可视化解释：通过箱线图展示不同污染程度区域底栖动物生物量的分布比较" width="768" />
<p class="caption">
图6.14: Kruskal-Wallis检验的可视化解释：通过箱线图展示不同污染程度区域底栖动物生物量的分布比较
</p>
</div>
<p>这个图表直观展示了Kruskal-Wallis检验的原理。箱线图显示了三个样本的分布情况，点表示各个观测值。检验基于这些观测值的秩次（排序位置）而不是原始数值来进行统计推断。</p>
<p>在实际的生态学研究中，选择使用方差分析还是Kruskal-Wallis检验应该基于数据的特性、研究设计和研究问题的性质。如果数据满足正态分布和方差齐性假设，方差分析通常更有效。如果数据严重偏离正态分布或存在极端值，Kruskal-Wallis检验提供了更稳健的替代方法。</p>
</div>
</div>
<div id="非参数检验方法" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> 非参数检验方法<a href="基于经典分布的假设检验.html#非参数检验方法" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>符号检验</strong>： - 基于符号的非参数检验 - 生态学意义：适用于序数数据</p>
<p><strong>Wilcoxon符号秩检验</strong>： - 考虑排序的非参数检验 - 生态学意义：比符号检验更有效</p>
<p><strong>卡方检验</strong>： - 检验分类变量的关联性 - 拟合优度检验：检验观测分布与理论分布的拟合 - 独立性检验：检验两个分类变量的独立性 - 生态学意义：分析物种分布、生境偏好等</p>
<p><strong>方法学发展脉络说明</strong>：本章介绍的非参数检验方法虽然不依赖于严格的正态分布假设，但它们仍然是基于经典统计理论的传统方法。这些方法为生态学家提供了处理非正态数据的重要工具。然而，随着生态学研究的深入和复杂化，我们越来越多地遇到这样的情况：我们感兴趣的统计量根本没有现成的理论分布可以参照，或者数据的复杂性超出了传统方法的处理能力。在这种情况下，我们需要转向更灵活的现代统计方法——基于模拟的假设检验。这些方法将在下一章中详细介绍，它们通过计算机模拟来构建统计量的经验分布，为处理复杂的生态学问题提供了全新的解决方案。从经典的非参数检验到现代的基于模拟方法，体现了统计方法学从理论驱动到数据驱动的演进，为生态学家应对日益复杂的生态问题提供了更强大的工具包。</p>
</div>
<div id="多重比较校正" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> 多重比较校正<a href="基于经典分布的假设检验.html#多重比较校正" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="多重比较问题的本质" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> 多重比较问题的本质<a href="基于经典分布的假设检验.html#多重比较问题的本质" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在生态学研究中，当我们使用方差分析发现多个组间存在总体差异后，一个自然的问题随之而来：<strong>具体哪些组之间存在差异？</strong> 要回答这个问题，我们需要进行两两比较。然而，直接进行多个t检验会导致<strong>第一类错误率膨胀</strong>，这是一个在生态统计学中必须重视的问题。</p>
<p><strong>为什么需要多重比较校正？</strong></p>
<p>假设我们有<span class="math inline">\(k\)</span>个组，需要进行<span class="math inline">\(m\)</span>次两两比较，其中：</p>
<p><span class="math display">\[m = \frac{k(k-1)}{2}\]</span></p>
<p>如果每次检验的显著性水平设为<span class="math inline">\(\alpha = 0.05\)</span>，那么累积的第一类错误率为：</p>
<p><span class="math display">\[\alpha_{family} = 1 - (1 - \alpha)^m\]</span></p>
<p>这意味着即使所有组实际上没有差异，我们也有很高的概率至少得到一个”显著”的假阳性结果。多重比较校正的目的就是控制这个<strong>族错误率</strong>，确保我们的统计结论更加可靠。</p>
<p><strong>生态学意义</strong>：在生态保护和管理决策中，错误的统计结论可能导致资源浪费或错失保护机会。多重比较校正帮助我们避免将随机波动误认为真实的生态效应，为科学决策提供更可靠的依据。</p>
<p>让我们通过一个流程图来理解完整的分析流程：</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:multiple-comparison-flowchart-export"></span>
<img src="imgs/multiple_comparison_flow.png" alt="多重比较分析流程图：展示从方差分析到多重比较校正的完整统计分析流程" width="300" />
<p class="caption">
图6.15: 多重比较分析流程图：展示从方差分析到多重比较校正的完整统计分析流程
</p>
</div>
<p>这个流程图清晰地展示了多重比较校正在整个分析流程中的位置。只有在方差分析显示总体差异显著后，我们才需要进行多重比较校正来识别具体的差异组对。</p>
</div>
<div id="bonferroni校正" class="section level3 hasAnchor" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Bonferroni校正<a href="基于经典分布的假设检验.html#bonferroni校正" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Bonferroni校正</strong>是最简单也最保守的多重比较校正方法。其基本思想是将显著性水平<span class="math inline">\(\alpha\)</span>除以比较次数<span class="math inline">\(m\)</span>：</p>
<p><span class="math display">\[\alpha_{adjusted} = \frac{\alpha}{m}\]</span></p>
<p>其中<span class="math inline">\(\alpha\)</span>是期望的族错误率（通常为0.05），<span class="math inline">\(m\)</span>是比较次数。</p>
<p><strong>数学原理</strong>：</p>
<p>Bonferroni校正基于Bonferroni不等式，该不等式指出：</p>
<p><span class="math display">\[P(\bigcup_{i=1}^m A_i) \leq \sum_{i=1}^m P(A_i)\]</span></p>
<p>其中<span class="math inline">\(A_i\)</span>表示第<span class="math inline">\(i\)</span>次检验犯第一类错误的事件。通过将每次检验的显著性水平设为<span class="math inline">\(\alpha/m\)</span>，我们确保族错误率不超过<span class="math inline">\(\alpha\)</span>。</p>
<p><strong>优缺点</strong>： - <strong>优点</strong>：简单易用，计算方便 - <strong>缺点</strong>：过于保守，统计功效较低，特别是当比较次数很多时</p>
<p><strong>适用场景</strong>： - 检验次数较少的情况（<span class="math inline">\(m &lt; 10\)</span>） - 预先计划的比较（而非探索性分析） - 需要严格控制第一类错误的研究</p>
<p><strong>生态学意义</strong>：在生态风险评估或保护决策等高风险研究中，Bonferroni校正的保守性可能是有益的，因为它减少了假阳性发现的风险。</p>
</div>
<div id="tukey-hsd检验" class="section level3 hasAnchor" number="6.6.3">
<h3><span class="header-section-number">6.6.3</span> Tukey HSD检验<a href="基于经典分布的假设检验.html#tukey-hsd检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Tukey HSD（Honestly Significant Difference）检验</strong>是专门为方差分析后的事后比较设计的多重比较方法。它基于学生化极差分布，同时考虑所有可能的组对比较。</p>
<p><strong>原理</strong>：</p>
<p>Tukey HSD检验计算每个组对均值差异的置信区间：</p>
<p><span class="math display">\[\bar{x}_i - \bar{x}_j \pm q_{\alpha,k,df} \cdot \sqrt{\frac{MS_{within}}{n}}\]</span></p>
<p>其中： - <span class="math inline">\(q_{\alpha,k,df}\)</span>是学生化极差分布的临界值 - <span class="math inline">\(k\)</span>是组数 - <span class="math inline">\(df\)</span>是组内自由度 - <span class="math inline">\(MS_{within}\)</span>是组内均方 - <span class="math inline">\(n\)</span>是每组样本量（假设平衡设计）</p>
<p><strong>生态学应用</strong>： Tukey HSD检验是生态学中最常用的多重比较方法之一，特别适用于： - 比较不同处理对生物指标的影响 - 分析不同生境类型的生态差异 - 检验不同管理措施的效果</p>
</div>
<div id="fdr错误发现率控制" class="section level3 hasAnchor" number="6.6.4">
<h3><span class="header-section-number">6.6.4</span> FDR（错误发现率）控制<a href="基于经典分布的假设检验.html#fdr错误发现率控制" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>FDR（False Discovery Rate）控制</strong>是一种相对较新的多重比较校正方法，特别适用于大规模检验。与传统的族错误率控制不同，FDR控制的是<strong>被拒绝的零假设中错误拒绝的比例</strong>。</p>
<p><strong>Benjamini-Hochberg程序</strong>：</p>
<ol style="list-style-type: decimal">
<li>将<span class="math inline">\(m\)</span>个检验的p值从小到大排序：<span class="math inline">\(p_{(1)} \leq p_{(2)} \leq \cdots \leq p_{(m)}\)</span></li>
<li>找到最大的<span class="math inline">\(i\)</span>使得：<span class="math inline">\(p_{(i)} \leq \frac{i}{m} \cdot \alpha\)</span></li>
<li>拒绝所有<span class="math inline">\(p_{(1)}, p_{(2)}, \ldots, p_{(i)}\)</span>对应的零假设</li>
</ol>
<p><strong>适用场景</strong>： - 大规模检验（如基因表达分析、宏基因组学） - 探索性研究，希望在发现力和错误控制之间取得平衡 - 生态基因组学和环境DNA研究</p>
<p><strong>生态学意义</strong>：在生态基因组学研究中，我们常常需要同时检验数千个基因的表达差异。FDR控制方法允许我们识别更多真实的生物学信号，同时控制假阳性发现的比例。</p>
</div>
<div id="生态学实例森林类型对鸟类多样性的影响" class="section level3 hasAnchor" number="6.6.5">
<h3><span class="header-section-number">6.6.5</span> 生态学实例：森林类型对鸟类多样性的影响<a href="基于经典分布的假设检验.html#生态学实例森林类型对鸟类多样性的影响" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>让我们通过一个完整的生态学实例来理解多重比较校正的实际应用。假设我们研究三种不同森林类型（阔叶林、针叶林、混交林）对鸟类物种丰富度的影响。</p>
<p><strong>研究设计</strong>： - 在每种森林类型中随机选择12个样点 - 调查每个样点的鸟类物种丰富度 - 使用方差分析检验总体差异 - 如果显著，使用多重比较校正识别具体差异</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="基于经典分布的假设检验.html#cb747-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb747-2"><a href="基于经典分布的假设检验.html#cb747-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb747-3"><a href="基于经典分布的假设检验.html#cb747-3" tabindex="-1"></a></span>
<span id="cb747-4"><a href="基于经典分布的假设检验.html#cb747-4" tabindex="-1"></a><span class="co"># 模拟三种森林类型的鸟类物种丰富度数据</span></span>
<span id="cb747-5"><a href="基于经典分布的假设检验.html#cb747-5" tabindex="-1"></a>broadleaf <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">12</span>, <span class="at">mean =</span> <span class="dv">18</span>, <span class="at">sd =</span> <span class="dv">3</span>) <span class="co"># 阔叶林</span></span>
<span id="cb747-6"><a href="基于经典分布的假设检验.html#cb747-6" tabindex="-1"></a>coniferous <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">12</span>, <span class="at">mean =</span> <span class="dv">12</span>, <span class="at">sd =</span> <span class="dv">3</span>) <span class="co"># 针叶林</span></span>
<span id="cb747-7"><a href="基于经典分布的假设检验.html#cb747-7" tabindex="-1"></a>mixed <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">12</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">3</span>) <span class="co"># 混交林</span></span>
<span id="cb747-8"><a href="基于经典分布的假设检验.html#cb747-8" tabindex="-1"></a></span>
<span id="cb747-9"><a href="基于经典分布的假设检验.html#cb747-9" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb747-10"><a href="基于经典分布的假设检验.html#cb747-10" tabindex="-1"></a>forest_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb747-11"><a href="基于经典分布的假设检验.html#cb747-11" tabindex="-1"></a>  <span class="at">richness =</span> <span class="fu">c</span>(broadleaf, coniferous, mixed),</span>
<span id="cb747-12"><a href="基于经典分布的假设检验.html#cb747-12" tabindex="-1"></a>  <span class="at">forest_type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;阔叶林&quot;</span>, <span class="st">&quot;针叶林&quot;</span>, <span class="st">&quot;混交林&quot;</span>), <span class="at">each =</span> <span class="dv">12</span>)</span>
<span id="cb747-13"><a href="基于经典分布的假设检验.html#cb747-13" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="基于经典分布的假设检验.html#cb748-1" tabindex="-1"></a><span class="co"># 第一步：执行方差分析</span></span>
<span id="cb748-2"><a href="基于经典分布的假设检验.html#cb748-2" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(richness <span class="sc">~</span> forest_type, <span class="at">data =</span> forest_data)</span>
<span id="cb748-3"><a href="基于经典分布的假设检验.html#cb748-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 方差分析结果 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 方差分析结果 ===</code></pre>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="基于经典分布的假设检验.html#cb750-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(anova_result))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## forest_type  2  315.2  157.60   19.54 2.52e-06 ***
## Residuals   33  266.1    8.06                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="基于经典分布的假设检验.html#cb752-1" tabindex="-1"></a><span class="co"># 提取F统计量和p值</span></span>
<span id="cb752-2"><a href="基于经典分布的假设检验.html#cb752-2" tabindex="-1"></a>f_stat <span class="ot">&lt;-</span> <span class="fu">summary</span>(anova_result)[[<span class="dv">1</span>]][<span class="st">&quot;forest_type&quot;</span>, <span class="st">&quot;F value&quot;</span>]</span>
<span id="cb752-3"><a href="基于经典分布的假设检验.html#cb752-3" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">summary</span>(anova_result)[[<span class="dv">1</span>]][<span class="st">&quot;forest_type&quot;</span>, <span class="st">&quot;Pr(&gt;F)&quot;</span>]</span>
<span id="cb752-4"><a href="基于经典分布的假设检验.html#cb752-4" tabindex="-1"></a></span>
<span id="cb752-5"><a href="基于经典分布的假设检验.html#cb752-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">F统计量 =&quot;</span>, <span class="fu">round</span>(f_stat, <span class="dv">2</span>), <span class="st">&quot;，p值 =&quot;</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## F统计量 = 19.54 ，p值 = 0</code></pre>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="基于经典分布的假设检验.html#cb754-1" tabindex="-1"></a><span class="co"># 第二步：多重比较校正（仅在方差分析显著时执行）</span></span>
<span id="cb754-2"><a href="基于经典分布的假设检验.html#cb754-2" tabindex="-1"></a><span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb754-3"><a href="基于经典分布的假设检验.html#cb754-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;方差分析显著，进行多重比较校正...</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb754-4"><a href="基于经典分布的假设检验.html#cb754-4" tabindex="-1"></a></span>
<span id="cb754-5"><a href="基于经典分布的假设检验.html#cb754-5" tabindex="-1"></a>  <span class="co"># 方法1：Tukey HSD检验</span></span>
<span id="cb754-6"><a href="基于经典分布的假设检验.html#cb754-6" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;=== Tukey HSD检验结果 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb754-7"><a href="基于经典分布的假设检验.html#cb754-7" tabindex="-1"></a>  tukey_result <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb754-8"><a href="基于经典分布的假设检验.html#cb754-8" tabindex="-1"></a>  <span class="fu">print</span>(tukey_result)</span>
<span id="cb754-9"><a href="基于经典分布的假设检验.html#cb754-9" tabindex="-1"></a></span>
<span id="cb754-10"><a href="基于经典分布的假设检验.html#cb754-10" tabindex="-1"></a>  <span class="co"># 方法2：Bonferroni校正</span></span>
<span id="cb754-11"><a href="基于经典分布的假设检验.html#cb754-11" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== Bonferroni校正结果 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb754-12"><a href="基于经典分布的假设检验.html#cb754-12" tabindex="-1"></a>  pairwise_result <span class="ot">&lt;-</span> <span class="fu">pairwise.t.test</span>(forest_data<span class="sc">$</span>richness,</span>
<span id="cb754-13"><a href="基于经典分布的假设检验.html#cb754-13" tabindex="-1"></a>    forest_data<span class="sc">$</span>forest_type,</span>
<span id="cb754-14"><a href="基于经典分布的假设检验.html#cb754-14" tabindex="-1"></a>    <span class="at">p.adjust.method =</span> <span class="st">&quot;bonferroni&quot;</span></span>
<span id="cb754-15"><a href="基于经典分布的假设检验.html#cb754-15" tabindex="-1"></a>  )</span>
<span id="cb754-16"><a href="基于经典分布的假设检验.html#cb754-16" tabindex="-1"></a>  <span class="fu">print</span>(pairwise_result)</span>
<span id="cb754-17"><a href="基于经典分布的假设检验.html#cb754-17" tabindex="-1"></a></span>
<span id="cb754-18"><a href="基于经典分布的假设检验.html#cb754-18" tabindex="-1"></a>  <span class="co"># 方法3：FDR控制</span></span>
<span id="cb754-19"><a href="基于经典分布的假设检验.html#cb754-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== FDR控制结果 (Benjamini-Hochberg) ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb754-20"><a href="基于经典分布的假设检验.html#cb754-20" tabindex="-1"></a>  fdr_result <span class="ot">&lt;-</span> <span class="fu">pairwise.t.test</span>(forest_data<span class="sc">$</span>richness,</span>
<span id="cb754-21"><a href="基于经典分布的假设检验.html#cb754-21" tabindex="-1"></a>    forest_data<span class="sc">$</span>forest_type,</span>
<span id="cb754-22"><a href="基于经典分布的假设检验.html#cb754-22" tabindex="-1"></a>    <span class="at">p.adjust.method =</span> <span class="st">&quot;BH&quot;</span></span>
<span id="cb754-23"><a href="基于经典分布的假设检验.html#cb754-23" tabindex="-1"></a>  )</span>
<span id="cb754-24"><a href="基于经典分布的假设检验.html#cb754-24" tabindex="-1"></a>  <span class="fu">print</span>(fdr_result)</span>
<span id="cb754-25"><a href="基于经典分布的假设检验.html#cb754-25" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb754-26"><a href="基于经典分布的假设检验.html#cb754-26" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;方差分析不显著，无需进行多重比较校正。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb754-27"><a href="基于经典分布的假设检验.html#cb754-27" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 方差分析显著，进行多重比较校正...
## 
## === Tukey HSD检验结果 ===
##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = richness ~ forest_type, data = forest_data)
## 
## $forest_type
##                    diff        lwr       upr     p adj
## 针叶林-混交林 -4.187087 -7.0319354 -1.342239 0.0027969
## 阔叶林-混交林  3.030043  0.1851952  5.874891 0.0348485
## 阔叶林-针叶林  7.217131  4.3722824 10.061979 0.0000015
## 
## 
## === Bonferroni校正结果 ===
## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  forest_data$richness and forest_data$forest_type 
## 
##        混交林 针叶林 
## 针叶林 0.003  -      
## 阔叶林 0.040  1.5e-06
## 
## P value adjustment method: bonferroni 
## 
## === FDR控制结果 (Benjamini-Hochberg) ===
## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  forest_data$richness and forest_data$forest_type 
## 
##        混交林 针叶林 
## 针叶林 0.0015 -      
## 阔叶林 0.0134 1.5e-06
## 
## P value adjustment method: BH</code></pre>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="基于经典分布的假设检验.html#cb756-1" tabindex="-1"></a><span class="co"># 加载可视化包</span></span>
<span id="cb756-2"><a href="基于经典分布的假设检验.html#cb756-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb756-3"><a href="基于经典分布的假设检验.html#cb756-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb756-4"><a href="基于经典分布的假设检验.html#cb756-4" tabindex="-1"></a></span>
<span id="cb756-5"><a href="基于经典分布的假设检验.html#cb756-5" tabindex="-1"></a><span class="co"># 计算均值和标准误</span></span>
<span id="cb756-6"><a href="基于经典分布的假设检验.html#cb756-6" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> forest_data <span class="sc">%&gt;%</span></span>
<span id="cb756-7"><a href="基于经典分布的假设检验.html#cb756-7" tabindex="-1"></a>  <span class="fu">group_by</span>(forest_type) <span class="sc">%&gt;%</span></span>
<span id="cb756-8"><a href="基于经典分布的假设检验.html#cb756-8" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb756-9"><a href="基于经典分布的假设检验.html#cb756-9" tabindex="-1"></a>    <span class="at">mean_richness =</span> <span class="fu">mean</span>(richness),</span>
<span id="cb756-10"><a href="基于经典分布的假设检验.html#cb756-10" tabindex="-1"></a>    <span class="at">se_richness =</span> <span class="fu">sd</span>(richness) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>())</span>
<span id="cb756-11"><a href="基于经典分布的假设检验.html#cb756-11" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="基于经典分布的假设检验.html#cb757-1" tabindex="-1"></a><span class="co"># 绘制均值图</span></span>
<span id="cb757-2"><a href="基于经典分布的假设检验.html#cb757-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_stats, <span class="fu">aes</span>(</span>
<span id="cb757-3"><a href="基于经典分布的假设检验.html#cb757-3" tabindex="-1"></a>  <span class="at">x =</span> forest_type, <span class="at">y =</span> mean_richness,</span>
<span id="cb757-4"><a href="基于经典分布的假设检验.html#cb757-4" tabindex="-1"></a>  <span class="at">fill =</span> forest_type</span>
<span id="cb757-5"><a href="基于经典分布的假设检验.html#cb757-5" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb757-6"><a href="基于经典分布的假设检验.html#cb757-6" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb757-7"><a href="基于经典分布的假设检验.html#cb757-7" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(</span>
<span id="cb757-8"><a href="基于经典分布的假设检验.html#cb757-8" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb757-9"><a href="基于经典分布的假设检验.html#cb757-9" tabindex="-1"></a>      <span class="at">ymin =</span> mean_richness <span class="sc">-</span> se_richness,</span>
<span id="cb757-10"><a href="基于经典分布的假设检验.html#cb757-10" tabindex="-1"></a>      <span class="at">ymax =</span> mean_richness <span class="sc">+</span> se_richness</span>
<span id="cb757-11"><a href="基于经典分布的假设检验.html#cb757-11" tabindex="-1"></a>    ),</span>
<span id="cb757-12"><a href="基于经典分布的假设检验.html#cb757-12" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.2</span></span>
<span id="cb757-13"><a href="基于经典分布的假设检验.html#cb757-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb757-14"><a href="基于经典分布的假设检验.html#cb757-14" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb757-15"><a href="基于经典分布的假设检验.html#cb757-15" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;不同森林类型的鸟类物种丰富度&quot;</span>,</span>
<span id="cb757-16"><a href="基于经典分布的假设检验.html#cb757-16" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;森林类型&quot;</span>, <span class="at">y =</span> <span class="st">&quot;物种丰富度（均值±标准误）&quot;</span></span>
<span id="cb757-17"><a href="基于经典分布的假设检验.html#cb757-17" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb757-18"><a href="基于经典分布的假设检验.html#cb757-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb757-19"><a href="基于经典分布的假设检验.html#cb757-19" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1f77b4&quot;</span>, <span class="st">&quot;#ff7f0e&quot;</span>, <span class="st">&quot;#2ca02c&quot;</span>))</span>
<span id="cb757-20"><a href="基于经典分布的假设检验.html#cb757-20" tabindex="-1"></a></span>
<span id="cb757-21"><a href="基于经典分布的假设检验.html#cb757-21" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:multiple-comparison-mean-plot"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/multiple-comparison-mean-plot-1.png" alt="不同森林类型的鸟类物种丰富度均值图：展示三种森林类型的平均物种丰富度及其标准误" width="768" />
<p class="caption">
图6.16: 不同森林类型的鸟类物种丰富度均值图：展示三种森林类型的平均物种丰富度及其标准误
</p>
</div>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="基于经典分布的假设检验.html#cb758-1" tabindex="-1"></a><span class="co"># 绘制箱线图</span></span>
<span id="cb758-2"><a href="基于经典分布的假设检验.html#cb758-2" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(forest_data, <span class="fu">aes</span>(</span>
<span id="cb758-3"><a href="基于经典分布的假设检验.html#cb758-3" tabindex="-1"></a>  <span class="at">x =</span> forest_type, <span class="at">y =</span> richness,</span>
<span id="cb758-4"><a href="基于经典分布的假设检验.html#cb758-4" tabindex="-1"></a>  <span class="at">fill =</span> forest_type</span>
<span id="cb758-5"><a href="基于经典分布的假设检验.html#cb758-5" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb758-6"><a href="基于经典分布的假设检验.html#cb758-6" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb758-7"><a href="基于经典分布的假设检验.html#cb758-7" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb758-8"><a href="基于经典分布的假设检验.html#cb758-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb758-9"><a href="基于经典分布的假设检验.html#cb758-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;鸟类物种丰富度分布&quot;</span>,</span>
<span id="cb758-10"><a href="基于经典分布的假设检验.html#cb758-10" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;森林类型&quot;</span>, <span class="at">y =</span> <span class="st">&quot;物种丰富度&quot;</span></span>
<span id="cb758-11"><a href="基于经典分布的假设检验.html#cb758-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb758-12"><a href="基于经典分布的假设检验.html#cb758-12" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb758-13"><a href="基于经典分布的假设检验.html#cb758-13" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1f77b4&quot;</span>, <span class="st">&quot;#ff7f0e&quot;</span>, <span class="st">&quot;#2ca02c&quot;</span>))</span>
<span id="cb758-14"><a href="基于经典分布的假设检验.html#cb758-14" tabindex="-1"></a></span>
<span id="cb758-15"><a href="基于经典分布的假设检验.html#cb758-15" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:multiple-comparison-boxplot"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/multiple-comparison-boxplot-1.png" alt="不同森林类型的鸟类物种丰富度箱线图：展示三种森林类型的物种丰富度分布情况" width="768" />
<p class="caption">
图6.17: 不同森林类型的鸟类物种丰富度箱线图：展示三种森林类型的物种丰富度分布情况
</p>
</div>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="基于经典分布的假设检验.html#cb759-1" tabindex="-1"></a><span class="co"># 使用patchwork包组合图形</span></span>
<span id="cb759-2"><a href="基于经典分布的假设检验.html#cb759-2" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb759-3"><a href="基于经典分布的假设检验.html#cb759-3" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb759-4"><a href="基于经典分布的假设检验.html#cb759-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb759-5"><a href="基于经典分布的假设检验.html#cb759-5" tabindex="-1"></a></span>
<span id="cb759-6"><a href="基于经典分布的假设检验.html#cb759-6" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:multiple-comparison-combined-plot"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/multiple-comparison-combined-plot-1.png" alt="多重比较校正实例分析：展示不同森林类型鸟类物种丰富度的多重比较结果及其可视化" width="960" />
<p class="caption">
图6.18: 多重比较校正实例分析：展示不同森林类型鸟类物种丰富度的多重比较结果及其可视化
</p>
</div>
<p><strong>结果解释</strong>：</p>
<p>在这个实例中，我们首先使用方差分析检验三种森林类型的鸟类物种丰富度是否存在总体差异。如果方差分析显著（p &lt; 0.05），我们接着使用三种不同的多重比较校正方法：</p>
<ol style="list-style-type: decimal">
<li><strong>Tukey HSD检验</strong>：提供所有组对比较的调整后p值和置信区间</li>
<li><strong>Bonferroni校正</strong>：最保守的方法，适用于预先计划的比较</li>
<li><strong>FDR控制</strong>：在发现力和错误控制之间取得平衡</li>
</ol>
<p>通过比较不同校正方法的结果，我们可以更全面地理解组间差异的模式，并选择最适合研究目的的方法。</p>
</div>
<div id="多重比较校正效果的可视化" class="section level3 hasAnchor" number="6.6.6">
<h3><span class="header-section-number">6.6.6</span> 多重比较校正效果的可视化<a href="基于经典分布的假设检验.html#多重比较校正效果的可视化" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>让我们通过另一个可视化来理解多重比较校正如何影响p值的解释：</p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="基于经典分布的假设检验.html#cb760-1" tabindex="-1"></a><span class="co"># 模拟多个比较的p值</span></span>
<span id="cb760-2"><a href="基于经典分布的假设检验.html#cb760-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb760-3"><a href="基于经典分布的假设检验.html#cb760-3" tabindex="-1"></a>num_tests <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb760-4"><a href="基于经典分布的假设检验.html#cb760-4" tabindex="-1"></a></span>
<span id="cb760-5"><a href="基于经典分布的假设检验.html#cb760-5" tabindex="-1"></a><span class="co"># 生成p值（大部分来自零假设，少数来自备择假设）</span></span>
<span id="cb760-6"><a href="基于经典分布的假设检验.html#cb760-6" tabindex="-1"></a>null_pvalues <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># 零假设下的p值</span></span>
<span id="cb760-7"><a href="基于经典分布的假设检验.html#cb760-7" tabindex="-1"></a>alt_pvalues <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="fl">0.05</span>) <span class="co"># 备择假设下的p值</span></span>
<span id="cb760-8"><a href="基于经典分布的假设检验.html#cb760-8" tabindex="-1"></a>all_pvalues <span class="ot">&lt;-</span> <span class="fu">c</span>(null_pvalues, alt_pvalues)</span>
<span id="cb760-9"><a href="基于经典分布的假设检验.html#cb760-9" tabindex="-1"></a></span>
<span id="cb760-10"><a href="基于经典分布的假设检验.html#cb760-10" tabindex="-1"></a><span class="co"># 应用不同的多重比较校正</span></span>
<span id="cb760-11"><a href="基于经典分布的假设检验.html#cb760-11" tabindex="-1"></a>bonferroni_p <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(all_pvalues, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb760-12"><a href="基于经典分布的假设检验.html#cb760-12" tabindex="-1"></a>bh_p <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(all_pvalues, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb760-13"><a href="基于经典分布的假设检验.html#cb760-13" tabindex="-1"></a></span>
<span id="cb760-14"><a href="基于经典分布的假设检验.html#cb760-14" tabindex="-1"></a><span class="co"># 创建可视化数据</span></span>
<span id="cb760-15"><a href="基于经典分布的假设检验.html#cb760-15" tabindex="-1"></a>viz_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb760-16"><a href="基于经典分布的假设检验.html#cb760-16" tabindex="-1"></a>  <span class="at">test_id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>num_tests, <span class="dv">3</span>),</span>
<span id="cb760-17"><a href="基于经典分布的假设检验.html#cb760-17" tabindex="-1"></a>  <span class="at">p_value =</span> <span class="fu">c</span>(all_pvalues, bonferroni_p, bh_p),</span>
<span id="cb760-18"><a href="基于经典分布的假设检验.html#cb760-18" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;未校正&quot;</span>, <span class="st">&quot;Bonferroni&quot;</span>, <span class="st">&quot;FDR控制&quot;</span>), <span class="at">each =</span> num_tests),</span>
<span id="cb760-19"><a href="基于经典分布的假设检验.html#cb760-19" tabindex="-1"></a>  <span class="at">true_effect =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;无效应&quot;</span>, <span class="dv">15</span>), <span class="fu">rep</span>(<span class="st">&quot;有效应&quot;</span>, <span class="dv">5</span>)), <span class="dv">3</span>)</span>
<span id="cb760-20"><a href="基于经典分布的假设检验.html#cb760-20" tabindex="-1"></a>)</span>
<span id="cb760-21"><a href="基于经典分布的假设检验.html#cb760-21" tabindex="-1"></a></span>
<span id="cb760-22"><a href="基于经典分布的假设检验.html#cb760-22" tabindex="-1"></a><span class="co"># 绘制p值比较图</span></span>
<span id="cb760-23"><a href="基于经典分布的假设检验.html#cb760-23" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb760-24"><a href="基于经典分布的假设检验.html#cb760-24" tabindex="-1"></a><span class="fu">ggplot</span>(viz_data, <span class="fu">aes</span>(</span>
<span id="cb760-25"><a href="基于经典分布的假设检验.html#cb760-25" tabindex="-1"></a>  <span class="at">x =</span> test_id, <span class="at">y =</span> <span class="sc">-</span><span class="fu">log10</span>(p_value),</span>
<span id="cb760-26"><a href="基于经典分布的假设检验.html#cb760-26" tabindex="-1"></a>  <span class="at">color =</span> true_effect, <span class="at">shape =</span> method</span>
<span id="cb760-27"><a href="基于经典分布的假设检验.html#cb760-27" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb760-28"><a href="基于经典分布的假设检验.html#cb760-28" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb760-29"><a href="基于经典分布的假设检验.html#cb760-29" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fu">log10</span>(<span class="fl">0.05</span>), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb760-30"><a href="基于经典分布的假设检验.html#cb760-30" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb760-31"><a href="基于经典分布的假设检验.html#cb760-31" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb760-32"><a href="基于经典分布的假设检验.html#cb760-32" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;多重比较校正对p值的影响&quot;</span>,</span>
<span id="cb760-33"><a href="基于经典分布的假设检验.html#cb760-33" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;检验编号&quot;</span>, <span class="at">y =</span> <span class="st">&quot;-log10(p值)&quot;</span>,</span>
<span id="cb760-34"><a href="基于经典分布的假设检验.html#cb760-34" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;红色虚线表示显著性阈值 (p = 0.05)&quot;</span></span>
<span id="cb760-35"><a href="基于经典分布的假设检验.html#cb760-35" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb760-36"><a href="基于经典分布的假设检验.html#cb760-36" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb760-37"><a href="基于经典分布的假设检验.html#cb760-37" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;无效应&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;有效应&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb760-38"><a href="基于经典分布的假设检验.html#cb760-38" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">15</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:multiple-comparison-visualization"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/multiple-comparison-visualization-1.png" alt="多重比较校正效果的可视化：比较未校正、Bonferroni校正和FDR控制三种方法对p值的影响" width="960" />
<p class="caption">
图6.19: 多重比较校正效果的可视化：比较未校正、Bonferroni校正和FDR控制三种方法对p值的影响
</p>
</div>
<p><strong>图表解释</strong>：</p>
<p>这个图表展示了三种情况下的p值： - <strong>未校正</strong>：直接使用原始p值，可能产生多个假阳性 - <strong>Bonferroni校正</strong>：p值被严格调整，减少了假阳性但可能错过一些真实效应 - <strong>FDR控制</strong>：在控制假阳性比例的同时，保留了更多的真实效应</p>
<p>通过这个可视化，我们可以直观地理解不同校正方法如何在错误控制和发现力之间进行权衡。</p>
</div>
<div id="实用建议与最佳实践" class="section level3 hasAnchor" number="6.6.7">
<h3><span class="header-section-number">6.6.7</span> 实用建议与最佳实践<a href="基于经典分布的假设检验.html#实用建议与最佳实践" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在生态学研究中正确应用多重比较校正至关重要。以下是一些实用的建议：</p>
<p><strong>1. 选择合适的校正方法</strong></p>
<table>
<thead>
<tr class="header">
<th>研究情境</th>
<th>推荐方法</th>
<th>理由</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>预先计划的少量比较</td>
<td>Bonferroni</td>
<td>简单保守，严格控制第一类错误</td>
</tr>
<tr class="even">
<td>方差分析后的事后比较</td>
<td>Tukey HSD</td>
<td>专门设计，考虑所有组对比较</td>
</tr>
<tr class="odd">
<td>大规模探索性研究</td>
<td>FDR控制</td>
<td>平衡发现力和错误控制</td>
</tr>
<tr class="even">
<td>生态风险评估</td>
<td>Bonferroni</td>
<td>保守性有助于避免假阳性</td>
</tr>
<tr class="odd">
<td>生态基因组学</td>
<td>FDR控制</td>
<td>处理大量基因表达数据</td>
</tr>
</tbody>
</table>
<p><strong>2. 分析流程的最佳实践</strong></p>
<ul>
<li><strong>先总体，后具体</strong>：先进行方差分析检验总体差异，只有在总体差异显著时才进行多重比较</li>
<li><strong>明确研究目的</strong>：根据研究是验证性还是探索性选择校正方法</li>
<li><strong>报告完整信息</strong>：在论文中报告使用的校正方法、调整后的p值和置信区间</li>
<li><strong>考虑样本量</strong>：确保样本量足够检测预期的效应大小</li>
</ul>
<p><strong>3. 常见错误与避免方法</strong></p>
<ul>
<li><strong>错误</strong>：直接进行多个t检验而不校正
<ul>
<li><strong>避免</strong>：始终使用适当的校正方法</li>
</ul></li>
<li><strong>错误</strong>：在方差分析不显著时仍进行多重比较
<ul>
<li><strong>避免</strong>：只有在总体差异显著时才进行事后检验</li>
</ul></li>
<li><strong>错误</strong>：不报告使用的校正方法
<ul>
<li><strong>避免</strong>：在方法部分明确说明统计分析方法</li>
</ul></li>
<li><strong>错误</strong>：过度依赖单一校正方法
<ul>
<li><strong>避免</strong>：根据研究目的和数据特性选择合适的方法</li>
</ul></li>
</ul>
<p><strong>4. 生态学研究中的特殊考虑</strong></p>
<p>在生态学研究中，多重比较校正的选择还应考虑：</p>
<ul>
<li><strong>保护生物学</strong>：在濒危物种保护研究中，可能更倾向于保守的方法（如Bonferroni）来避免假阳性</li>
<li><strong>生态系统管理</strong>：在管理决策中，需要平衡统计严谨性和实际应用价值</li>
<li><strong>长期监测</strong>：在时间序列数据分析中，考虑重复测量方差分析和相应的事后检验</li>
</ul>
<p><strong>5. R语言实现技巧</strong></p>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="基于经典分布的假设检验.html#cb761-1" tabindex="-1"></a><span class="co"># 常用的多重比较校正函数</span></span>
<span id="cb761-2"><a href="基于经典分布的假设检验.html#cb761-2" tabindex="-1"></a></span>
<span id="cb761-3"><a href="基于经典分布的假设检验.html#cb761-3" tabindex="-1"></a><span class="co"># Tukey HSD检验</span></span>
<span id="cb761-4"><a href="基于经典分布的假设检验.html#cb761-4" tabindex="-1"></a><span class="co"># 假设已经执行了方差分析：aov_result &lt;- aov(response ~ group, data = data)</span></span>
<span id="cb761-5"><a href="基于经典分布的假设检验.html#cb761-5" tabindex="-1"></a><span class="fu">TukeyHSD</span>(aov_result)</span>
<span id="cb761-6"><a href="基于经典分布的假设检验.html#cb761-6" tabindex="-1"></a></span>
<span id="cb761-7"><a href="基于经典分布的假设检验.html#cb761-7" tabindex="-1"></a><span class="co"># Bonferroni校正</span></span>
<span id="cb761-8"><a href="基于经典分布的假设检验.html#cb761-8" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(data<span class="sc">$</span>response, data<span class="sc">$</span>group, <span class="at">p.adjust.method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb761-9"><a href="基于经典分布的假设检验.html#cb761-9" tabindex="-1"></a></span>
<span id="cb761-10"><a href="基于经典分布的假设检验.html#cb761-10" tabindex="-1"></a><span class="co"># FDR控制 (Benjamini-Hochberg)</span></span>
<span id="cb761-11"><a href="基于经典分布的假设检验.html#cb761-11" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(data<span class="sc">$</span>response, data<span class="sc">$</span>group, <span class="at">p.adjust.method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb761-12"><a href="基于经典分布的假设检验.html#cb761-12" tabindex="-1"></a></span>
<span id="cb761-13"><a href="基于经典分布的假设检验.html#cb761-13" tabindex="-1"></a><span class="co"># 其他校正方法</span></span>
<span id="cb761-14"><a href="基于经典分布的假设检验.html#cb761-14" tabindex="-1"></a><span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;holm&quot;</span>) <span class="co"># Holm校正</span></span>
<span id="cb761-15"><a href="基于经典分布的假设检验.html#cb761-15" tabindex="-1"></a><span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;fdr&quot;</span>) <span class="co"># FDR控制</span></span>
<span id="cb761-16"><a href="基于经典分布的假设检验.html#cb761-16" tabindex="-1"></a><span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;BY&quot;</span>) <span class="co"># Benjamini-Yekutieli</span></span></code></pre></div>
<p><strong>生态学意义</strong>：通过正确应用多重比较校正，生态学家能够： - 得出更可靠的统计结论 - 避免将随机波动误认为生态规律 - 为生态保护和管理决策提供更坚实的科学依据 - 促进生态学研究的严谨性和可重复性</p>
<p>记住，多重比较校正不是统计”魔术”，而是基于概率理论的严谨方法。理解其原理并正确应用，将使你的生态学研究更加科学和可信。</p>
</div>
</div>
<div id="功效分析" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> 功效分析<a href="基于经典分布的假设检验.html#功效分析" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在生态学研究中，我们不仅关心统计显著性，更关心研究是否有足够的能力检测到真实存在的生态效应。<strong>功效分析</strong>（Power Analysis）正是为此目的而设计的统计工具，它帮助我们在研究设计阶段就评估检测预期效应的可能性，从而确保我们的研究既不会因为样本过小而错过真实效应，也不会因为样本过大而浪费宝贵的科研资源。</p>
<p><strong>统计功效的概念与生态学意义</strong></p>
<p><strong>统计功效</strong>定义为正确拒绝错误零假设的概率，即1-β，其中β是第二类错误的概率。在生态学语境中，统计功效可以理解为：当某种生态效应确实存在时，我们的研究能够检测到这种效应的概率。例如，如果某种保护措施确实能够提高濒危物种的存活率，统计功效就是我们的研究能够正确发现这种保护效果的概率。</p>
<p>统计功效的生态学意义极为重要。一个功效不足的研究就像使用分辨率不足的望远镜观察星空——我们可能错过真实存在的天体，却误以为天空空无一物。在生态保护领域，功效不足的研究可能导致我们错过有效的保护措施，让濒危物种继续面临威胁；在环境风险评估中，功效不足可能让我们低估污染物的生态毒性，导致生态系统持续受损。因此，进行充分的功效分析不仅是统计严谨性的要求，更是生态伦理的体现。</p>
<p><strong>功效分析的核心要素</strong></p>
<p>功效分析涉及四个相互关联的核心要素，理解这些要素之间的关系对于合理设计生态学研究至关重要。这四个要素——效应大小、样本量、显著性水平和统计功效——构成了一个紧密相连的系统，任何一个要素的变化都会影响其他要素。在生态学研究中，我们需要在这些要素之间找到最优的平衡点，既要确保研究有足够的检测能力，又要考虑实际的资源约束和伦理考量。</p>
<p><strong>效应大小</strong>（Effect Size）是衡量生态效应实际重要性的量化指标，它反映了自变量对因变量影响的实际幅度。与统计显著性不同，效应大小关注的是生态学意义上的实际差异，而非统计概率。在生态学研究中，效应大小的概念具有多重维度：它可以是均值差异、方差解释比例、相关系数，或者是分类变量间的关联强度。</p>
<p>效应大小的生态学解释需要结合具体的研究情境和生态学背景。一个在生理学研究中微不足道的效应可能在保护生物学中具有决定性意义。例如，某种农药导致非靶标昆虫死亡率增加3%的效应，在农业生产的经济效益评估中可能被认为是可接受的副作用，但在保护濒危传粉昆虫物种时，这个微小的死亡率增加可能意味着整个种群的崩溃。同样，在气候变化研究中，年平均温度升高0.5℃的效应在短期气象观测中可能不显著，但对于高山生态系统的物种分布和物候期却可能产生深远影响。</p>
<p>效应大小的估计需要基于多方面的信息来源：文献回顾可以提供类似研究的效应大小范围；预实验数据可以提供初步的效应估计；专家经验可以基于生态学理论提供合理的预期；最小生态学重要差异（Minimum Ecologically Important Difference）的概念可以帮助确定具有实际生态意义的效应阈值。在缺乏可靠信息时，可以使用Cohen提出的效应大小标准作为参考：小效应（d=0.2）、中效应（d=0.5）、大效应（d=0.8），但这些标准在生态学中的应用需要谨慎，因为生态系统的复杂性和敏感性往往要求我们重新定义什么构成”重要”的效应。</p>
<p><strong>样本量</strong>（Sample Size）是研究中最直接可控的因素，也是连接统计理论与生态实践的桥梁。样本量直接影响统计功效的核心机制在于其对抽样误差的控制——样本量越大，样本统计量对总体参数的估计越精确，抽样误差越小，从而检测真实效应的能力越强。这种关系遵循平方根法则：标准误与样本量的平方根成反比，这意味着要将标准误减半，需要将样本量增加四倍。</p>
<p>然而，生态学研究在样本量选择上面临着独特的挑战和约束。野外调查往往受制于时间、经费和可行性的限制：在偏远地区进行生物多样性调查可能需要数周甚至数月的野外工作；保护生物学研究可能涉及数量极其有限的濒危物种个体；长期生态监测需要考虑研究的可持续性和对生态系统的干扰最小化。此外，生态系统的空间异质性和时间变异性也增加了确定合适样本量的复杂性。</p>
<p>功效分析在样本量确定中发挥着关键作用，它帮助我们在这些约束条件下找到最优的平衡点。通过功效分析，我们可以回答一系列关键问题：在给定的效应大小和显著性水平下，达到期望统计功效需要多大的样本量？如果实际条件限制了样本量，那么在这种样本量下我们能够检测到多小的效应？这种前瞻性的分析不仅优化了资源利用，也提高了研究的科学价值。</p>
<p><strong>显著性水平</strong>（Significance Level，α）是我们愿意接受的第一类错误风险，即在零假设实际上为真时错误地拒绝它的概率。在传统的统计实践中，α通常设定为0.05，但这个选择在生态学中需要更加细致的考量，因为它涉及到第一类错误和第二类错误之间的根本权衡。</p>
<p>在生态学研究中，显著性水平的选择应该基于对两类错误后果的深入分析。在保护生物学研究中，第二类错误的后果往往更为严重——错过一个真实的保护效应可能意味着濒危物种的继续衰退甚至灭绝。因此，在保护生物学中，我们可能愿意接受较高的α水平（如0.10）来换取更高的统计功效，确保不会错过重要的保护机会。例如，在评估某种栖息地恢复措施对濒危鸟类的影响时，我们可能更关心不要错过真实的正向效应，即使这意味着有10%的概率错误地宣称无效的措施有效。</p>
<p>相反，在涉及重大政策决策或资源分配的研究中，第一类错误的后果可能更为严重。错误地宣称某种污染物具有生态毒性可能导致不必要的环境管制和经济损失；错误地宣称某种外来物种具有入侵风险可能引发不必要的控制措施。在这种情况下，我们需要更严格的α水平（如0.01）来减少假阳性的风险。例如，在评估新型农药的环境安全性时，我们可能要求更强的证据来证明其有害性。</p>
<p><strong>统计功效</strong>（Statistical Power，1-β）是我们期望达到的检测能力，即在备择假设实际上为真时正确拒绝零假设的概率。在生态学研究中，统计功效通常设定为0.80，这个标准被认为是在统计严谨性和实际可行性之间的合理折中。</p>
<p>统计功效为0.80意味着我们有80%的概率正确检测到真实存在的效应，同时接受20%的错过真实效应的风险。这个选择主要基于以下几个考虑：首先，从实际可行性来看，要达到更高的统计功效（如0.90或0.95）通常需要极大的样本量增加，这在生态学研究中往往难以实现。其次，从资源分配的角度看，将功效从0.80提高到0.90通常需要不成比例的资源投入。最后，统计功效为0.80在大多数研究情境下被认为是足够的检测能力。</p>
<p>然而，在特定的高风险生态学研究中，我们可能需要更高的功效标准。在涉及濒危物种保护的研究中，错过真实保护效应的后果可能极为严重，因此可能需要0.90甚至0.95的功效水平。在重大环境风险评估中，低估污染物生态毒性的风险可能带来不可逆的生态破坏，同样需要更高的检测能力。在这些情况下，功效分析可以帮助我们理解达到更高功效所需的资源投入，为决策提供依据。</p>
<p><strong>功效分析在生态学研究设计中的应用</strong></p>
<p>功效分析最重要的应用是在研究设计阶段确定合适的样本量。通过功效分析，我们可以在研究开始前就回答一个关键问题：“为了有80%的概率检测到预期大小的效应，我需要多大的样本量？”</p>
<p>让我们通过一个具体的生态学实例来理解功效分析的实际应用：</p>
<blockquote>
<p><strong>实例：设计施肥对草地生产力影响的研究</strong></p>
<p>假设我们计划研究施肥对草地生态系统生产力的影响。基于文献回顾和预实验，我们预期施肥将使草地生物量平均增加20%（效应大小）。我们设定显著性水平α = 0.05，期望统计功效为0.80。</p>
<p>通过功效分析，我们可以计算出需要的样本量。如果计算结果显示每组需要15个重复样方，那么我们就知道：在这个样本量下，如果施肥确实能提高20%的生物量，我们有80%的概率能够检测到这种效应。</p>
<p>如果实地条件限制我们只能设置10个重复样方，功效分析可以告诉我们：在这个样本量下，统计功效可能只有60%。这意味着即使施肥确实有效，我们也有40%的概率会错过这个效应。这种前瞻性的认识帮助我们做出更明智的决策——要么调整研究设计，要么重新评估研究的可行性。</p>
</blockquote>
<p><strong>不同类型检验的功效分析</strong></p>
<p>不同的统计检验需要不同的功效分析方法。在生态学研究中，我们经常遇到的功效分析包括：</p>
<p><strong>t检验的功效分析</strong>适用于比较两个组均值差异的研究。例如，比较施肥处理和对照处理的草地生产力，或者比较污染区域和清洁区域的生物指标。t检验的功效分析相对简单，主要考虑效应大小（标准化均值差异）、样本量和显著性水平。</p>
<p><strong>方差分析的功效分析</strong>适用于比较三个或更多组均值的研究。例如，比较不同森林类型的鸟类多样性，或者评估不同管理措施对物种丰富度的影响。方差分析的功效分析需要考虑组数、效应大小（如η²或f）、样本量和显著性水平。</p>
<p><strong>相关分析和回归的功效分析</strong>适用于研究变量间关系的研究。例如，分析温度与物种丰富度的关系，或者建立环境因子与生态指标的预测模型。这类功效分析需要考虑相关系数、样本量和显著性水平。</p>
<p><strong>卡方检验的功效分析</strong>适用于分类数据的研究。例如，分析物种在不同生境中的分布差异，或者检验不同处理对生物存活率的影响。卡方检验的功效分析需要考虑效应大小（如Cramér’s V）、样本量和显著性水平。</p>
<p><strong>功效分析的实践建议与注意事项</strong></p>
<p>在进行功效分析时，生态学家需要注意以下几个关键点：</p>
<p><strong>合理估计效应大小</strong>是功效分析成功的关键。效应大小的估计可以基于：文献回顾（类似研究的效应大小）、预实验数据、专家经验，或者使用最小生态学重要差异（Minimum Ecologically Important Difference）的概念。在缺乏可靠信息时，可以使用Cohen提出的效应大小标准（小效应：d=0.2，中效应：d=0.5，大效应：d=0.8）作为参考。</p>
<p><strong>考虑研究的实际约束</strong>。生态学研究很少能在理想条件下进行，我们需要在统计理想和现实约束之间找到平衡。功效分析应该考虑：野外工作的可行性、经费限制、时间约束、伦理考量（如对濒危物种的干扰最小化）。</p>
<p><strong>进行敏感性分析</strong>。由于效应大小的估计往往存在不确定性，进行敏感性分析是明智的做法。我们可以计算不同效应大小假设下所需的样本量，从而了解研究对效应大小估计的敏感程度。</p>
<p><strong>报告完整的功效分析</strong>。在论文的方法部分，应该详细报告功效分析的过程：使用的效应大小估计及其依据、设定的显著性水平和统计功效、计算出的样本量、以及任何调整或妥协的考虑。</p>
<p><strong>生态学意义与伦理责任</strong></p>
<p>功效分析不仅仅是一个统计工具，它体现了生态学研究的科学严谨性和伦理责任。一个经过充分功效分析设计的研究：</p>
<ul>
<li><strong>提高了研究的科学价值</strong>：确保研究有足够的能力回答科学问题</li>
<li><strong>优化了资源利用</strong>：避免样本过小导致的资源浪费，也避免样本过大造成的不必要消耗</li>
<li><strong>增强了结果的可信度</strong>：统计上不显著的结果更可能是真实无效应，而非检测力不足</li>
<li><strong>促进了知识的积累</strong>：为后续的元分析和综述研究提供可靠的基础</li>
</ul>
<p>在生态保护和管理决策日益依赖科学证据的今天，功效分析成为了连接生态学理论与保护实践的重要桥梁。通过严谨的功效分析，我们不仅是在进行统计学计算，更是在履行对生态系统和未来世代的责任——确保我们的研究能够为生态保护提供真正有用的知识，而不是在统计迷雾中迷失方向。</p>
<p><strong>R语言实现示例</strong></p>
<p>在生态学研究中，R语言提供了强大的功效分析工具包<code>pwr</code>，可以帮助我们进行各种统计检验的功效分析。下面我们将详细介绍几个关键函数的用法和参数含义，并通过具体的生态学实例演示如何进行功效分析。</p>
<p><strong>1. 安装和加载pwr包</strong></p>
<p>首先需要安装并加载功效分析包：</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="基于经典分布的假设检验.html#cb762-1" tabindex="-1"></a><span class="co"># 加载pwr包</span></span>
<span id="cb762-2"><a href="基于经典分布的假设检验.html#cb762-2" tabindex="-1"></a><span class="fu">library</span>(pwr)</span></code></pre></div>
<p><code>pwr</code>包提供了多种统计检验的功效分析函数，包括t检验、方差分析、相关分析、卡方检验等。</p>
<p><strong>2. t检验的功效分析</strong></p>
<p><code>pwr.t.test()</code>函数用于t检验的功效分析，适用于比较两个组均值差异的研究。让我们通过一个具体的生态学实例来理解其用法：</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="基于经典分布的假设检验.html#cb763-1" tabindex="-1"></a><span class="co"># 实例：施肥对草地生产力影响的功效分析</span></span>
<span id="cb763-2"><a href="基于经典分布的假设检验.html#cb763-2" tabindex="-1"></a><span class="co"># 研究问题：比较施肥组和对照组的草地生物量</span></span>
<span id="cb763-3"><a href="基于经典分布的假设检验.html#cb763-3" tabindex="-1"></a><span class="co"># 预期效应大小：中等效应（Cohen&#39;s d = 0.5）</span></span>
<span id="cb763-4"><a href="基于经典分布的假设检验.html#cb763-4" tabindex="-1"></a><span class="co"># 显著性水平：α = 0.05</span></span>
<span id="cb763-5"><a href="基于经典分布的假设检验.html#cb763-5" tabindex="-1"></a><span class="co"># 期望功效：0.80</span></span>
<span id="cb763-6"><a href="基于经典分布的假设检验.html#cb763-6" tabindex="-1"></a></span>
<span id="cb763-7"><a href="基于经典分布的假设检验.html#cb763-7" tabindex="-1"></a><span class="co"># 计算所需样本量</span></span>
<span id="cb763-8"><a href="基于经典分布的假设检验.html#cb763-8" tabindex="-1"></a>t_power <span class="ot">&lt;-</span> <span class="fu">pwr.t.test</span>(</span>
<span id="cb763-9"><a href="基于经典分布的假设检验.html#cb763-9" tabindex="-1"></a>  <span class="at">d =</span> <span class="fl">0.5</span>, <span class="co"># 效应大小（Cohen&#39;s d）</span></span>
<span id="cb763-10"><a href="基于经典分布的假设检验.html#cb763-10" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="co"># 显著性水平</span></span>
<span id="cb763-11"><a href="基于经典分布的假设检验.html#cb763-11" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.8</span>, <span class="co"># 期望统计功效</span></span>
<span id="cb763-12"><a href="基于经典分布的假设检验.html#cb763-12" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>, <span class="co"># 检验类型：独立样本t检验</span></span>
<span id="cb763-13"><a href="基于经典分布的假设检验.html#cb763-13" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span> <span class="co"># 备择假设：双侧检验</span></span>
<span id="cb763-14"><a href="基于经典分布的假设检验.html#cb763-14" tabindex="-1"></a>)</span>
<span id="cb763-15"><a href="基于经典分布的假设检验.html#cb763-15" tabindex="-1"></a></span>
<span id="cb763-16"><a href="基于经典分布的假设检验.html#cb763-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 独立样本t检验功效分析 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 独立样本t检验功效分析 ===</code></pre>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="基于经典分布的假设检验.html#cb765-1" tabindex="-1"></a><span class="fu">print</span>(t_power)</span></code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 63.76561
##               d = 0.5
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</code></pre>
<p><strong>参数解释：</strong> - <code>d</code>：效应大小，使用Cohen’s d表示标准化均值差异。在生态学中，d=0.2表示小效应，d=0.5表示中效应，d=0.8表示大效应。 - <code>sig.level</code>：显著性水平，通常设为0.05。 - <code>power</code>：期望的统计功效，通常设为0.80。 - <code>type</code>：检验类型，可以是”two.sample”（独立样本）、“one.sample”（单样本）或”paired”（配对样本）。 - <code>alternative</code>：备择假设类型，可以是”two.sided”（双侧）、“greater”（单侧，组1&gt;组2）或”less”（单侧，组1&lt;组2）。</p>
<p><strong>结果解释：</strong> 输出结果会显示达到期望功效所需的每组样本量。在这个例子中，结果显示每组需要约64个样本才能以80%的概率检测到中等效应大小的差异。</p>
<p><strong>3. 方差分析的功效分析</strong></p>
<p><code>pwr.anova.test()</code>函数用于方差分析的功效分析，适用于比较三个或更多组均值的研究：</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="基于经典分布的假设检验.html#cb767-1" tabindex="-1"></a><span class="co"># 实例：不同森林类型对鸟类多样性影响的功效分析</span></span>
<span id="cb767-2"><a href="基于经典分布的假设检验.html#cb767-2" tabindex="-1"></a><span class="co"># 研究问题：比较阔叶林、针叶林、混交林的鸟类物种丰富度</span></span>
<span id="cb767-3"><a href="基于经典分布的假设检验.html#cb767-3" tabindex="-1"></a><span class="co"># 组数：3</span></span>
<span id="cb767-4"><a href="基于经典分布的假设检验.html#cb767-4" tabindex="-1"></a><span class="co"># 预期效应大小：中等效应（f = 0.25）</span></span>
<span id="cb767-5"><a href="基于经典分布的假设检验.html#cb767-5" tabindex="-1"></a><span class="co"># 显著性水平：α = 0.05</span></span>
<span id="cb767-6"><a href="基于经典分布的假设检验.html#cb767-6" tabindex="-1"></a><span class="co"># 期望功效：0.80</span></span>
<span id="cb767-7"><a href="基于经典分布的假设检验.html#cb767-7" tabindex="-1"></a></span>
<span id="cb767-8"><a href="基于经典分布的假设检验.html#cb767-8" tabindex="-1"></a><span class="co"># 计算所需样本量</span></span>
<span id="cb767-9"><a href="基于经典分布的假设检验.html#cb767-9" tabindex="-1"></a>anova_power <span class="ot">&lt;-</span> <span class="fu">pwr.anova.test</span>(</span>
<span id="cb767-10"><a href="基于经典分布的假设检验.html#cb767-10" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">3</span>, <span class="co"># 组数</span></span>
<span id="cb767-11"><a href="基于经典分布的假设检验.html#cb767-11" tabindex="-1"></a>  <span class="at">f =</span> <span class="fl">0.25</span>, <span class="co"># 效应大小（Cohen&#39;s f）</span></span>
<span id="cb767-12"><a href="基于经典分布的假设检验.html#cb767-12" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="co"># 显著性水平</span></span>
<span id="cb767-13"><a href="基于经典分布的假设检验.html#cb767-13" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.8</span> <span class="co"># 期望统计功效</span></span>
<span id="cb767-14"><a href="基于经典分布的假设检验.html#cb767-14" tabindex="-1"></a>)</span>
<span id="cb767-15"><a href="基于经典分布的假设检验.html#cb767-15" tabindex="-1"></a></span>
<span id="cb767-16"><a href="基于经典分布的假设检验.html#cb767-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 方差分析功效分析 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 方差分析功效分析 ===</code></pre>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="基于经典分布的假设检验.html#cb769-1" tabindex="-1"></a><span class="fu">print</span>(anova_power)</span></code></pre></div>
<pre><code>## 
##      Balanced one-way analysis of variance power calculation 
## 
##               k = 3
##               n = 52.3966
##               f = 0.25
##       sig.level = 0.05
##           power = 0.8
## 
## NOTE: n is number in each group</code></pre>
<p><strong>参数解释：</strong> - <code>k</code>：组数，即要比较的处理水平数量。 - <code>f</code>：效应大小，使用Cohen’s f表示。在方差分析中，f=0.1表示小效应，f=0.25表示中效应，f=0.4表示大效应。 - <code>sig.level</code>和<code>power</code>的含义与t检验相同。</p>
<p><strong>效应大小f的计算：</strong> Cohen’s f可以通过方差分析中的η²（eta平方）来计算： <span class="math display">\[f = \sqrt{\frac{\eta^2}{1-\eta^2}}\]</span> 其中η²表示组间方差占总方差的比例。</p>
<p><strong>4. 相关分析的功效分析</strong></p>
<p><code>pwr.r.test()</code>函数用于相关分析的功效分析，适用于研究两个连续变量之间的关系：</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="基于经典分布的假设检验.html#cb771-1" tabindex="-1"></a><span class="co"># 实例：温度与物种丰富度关系的功效分析</span></span>
<span id="cb771-2"><a href="基于经典分布的假设检验.html#cb771-2" tabindex="-1"></a><span class="co"># 研究问题：检验年平均温度与鸟类物种丰富度的相关性</span></span>
<span id="cb771-3"><a href="基于经典分布的假设检验.html#cb771-3" tabindex="-1"></a><span class="co"># 预期相关系数：r = 0.3（中等相关）</span></span>
<span id="cb771-4"><a href="基于经典分布的假设检验.html#cb771-4" tabindex="-1"></a><span class="co"># 显著性水平：α = 0.05</span></span>
<span id="cb771-5"><a href="基于经典分布的假设检验.html#cb771-5" tabindex="-1"></a><span class="co"># 期望功效：0.80</span></span>
<span id="cb771-6"><a href="基于经典分布的假设检验.html#cb771-6" tabindex="-1"></a></span>
<span id="cb771-7"><a href="基于经典分布的假设检验.html#cb771-7" tabindex="-1"></a><span class="co"># 计算所需样本量</span></span>
<span id="cb771-8"><a href="基于经典分布的假设检验.html#cb771-8" tabindex="-1"></a>cor_power <span class="ot">&lt;-</span> <span class="fu">pwr.r.test</span>(</span>
<span id="cb771-9"><a href="基于经典分布的假设检验.html#cb771-9" tabindex="-1"></a>  <span class="at">r =</span> <span class="fl">0.3</span>, <span class="co"># 预期相关系数</span></span>
<span id="cb771-10"><a href="基于经典分布的假设检验.html#cb771-10" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="co"># 显著性水平</span></span>
<span id="cb771-11"><a href="基于经典分布的假设检验.html#cb771-11" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.8</span>, <span class="co"># 期望统计功效</span></span>
<span id="cb771-12"><a href="基于经典分布的假设检验.html#cb771-12" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span> <span class="co"># 备择假设：双侧检验</span></span>
<span id="cb771-13"><a href="基于经典分布的假设检验.html#cb771-13" tabindex="-1"></a>)</span>
<span id="cb771-14"><a href="基于经典分布的假设检验.html#cb771-14" tabindex="-1"></a></span>
<span id="cb771-15"><a href="基于经典分布的假设检验.html#cb771-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 相关分析功效分析 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 相关分析功效分析 ===</code></pre>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="基于经典分布的假设检验.html#cb773-1" tabindex="-1"></a><span class="fu">print</span>(cor_power)</span></code></pre></div>
<pre><code>## 
##      approximate correlation power calculation (arctangh transformation) 
## 
##               n = 84.07364
##               r = 0.3
##       sig.level = 0.05
##           power = 0.8
##     alternative = two.sided</code></pre>
<p><strong>参数解释：</strong> - <code>r</code>：预期的相关系数。在生态学中，r=0.1表示弱相关，r=0.3表示中等相关，r=0.5表示强相关。</p>
<p><strong>5. 卡方检验的功效分析</strong></p>
<p><code>pwr.chisq.test()</code>函数用于卡方检验的功效分析，适用于分类数据的分析：</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="基于经典分布的假设检验.html#cb775-1" tabindex="-1"></a><span class="co"># 实例：物种在不同生境中分布差异的功效分析</span></span>
<span id="cb775-2"><a href="基于经典分布的假设检验.html#cb775-2" tabindex="-1"></a><span class="co"># 研究问题：检验物种在三种生境类型中的分布是否存在差异</span></span>
<span id="cb775-3"><a href="基于经典分布的假设检验.html#cb775-3" tabindex="-1"></a><span class="co"># 效应大小：w = 0.3（中等效应）</span></span>
<span id="cb775-4"><a href="基于经典分布的假设检验.html#cb775-4" tabindex="-1"></a><span class="co"># 自由度：df = 2（(行数-1)×(列数-1)）</span></span>
<span id="cb775-5"><a href="基于经典分布的假设检验.html#cb775-5" tabindex="-1"></a><span class="co"># 显著性水平：α = 0.05</span></span>
<span id="cb775-6"><a href="基于经典分布的假设检验.html#cb775-6" tabindex="-1"></a><span class="co"># 期望功效：0.80</span></span>
<span id="cb775-7"><a href="基于经典分布的假设检验.html#cb775-7" tabindex="-1"></a></span>
<span id="cb775-8"><a href="基于经典分布的假设检验.html#cb775-8" tabindex="-1"></a><span class="co"># 计算所需样本量</span></span>
<span id="cb775-9"><a href="基于经典分布的假设检验.html#cb775-9" tabindex="-1"></a>chisq_power <span class="ot">&lt;-</span> <span class="fu">pwr.chisq.test</span>(</span>
<span id="cb775-10"><a href="基于经典分布的假设检验.html#cb775-10" tabindex="-1"></a>  <span class="at">w =</span> <span class="fl">0.3</span>, <span class="co"># 效应大小（Cohen&#39;s w）</span></span>
<span id="cb775-11"><a href="基于经典分布的假设检验.html#cb775-11" tabindex="-1"></a>  <span class="at">N =</span> <span class="cn">NULL</span>, <span class="co"># 总样本量（待计算）</span></span>
<span id="cb775-12"><a href="基于经典分布的假设检验.html#cb775-12" tabindex="-1"></a>  <span class="at">df =</span> <span class="dv">2</span>, <span class="co"># 自由度</span></span>
<span id="cb775-13"><a href="基于经典分布的假设检验.html#cb775-13" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="co"># 显著性水平</span></span>
<span id="cb775-14"><a href="基于经典分布的假设检验.html#cb775-14" tabindex="-1"></a>  <span class="at">power =</span> <span class="fl">0.8</span> <span class="co"># 期望统计功效</span></span>
<span id="cb775-15"><a href="基于经典分布的假设检验.html#cb775-15" tabindex="-1"></a>)</span>
<span id="cb775-16"><a href="基于经典分布的假设检验.html#cb775-16" tabindex="-1"></a></span>
<span id="cb775-17"><a href="基于经典分布的假设检验.html#cb775-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 卡方检验功效分析 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 卡方检验功效分析 ===</code></pre>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="基于经典分布的假设检验.html#cb777-1" tabindex="-1"></a><span class="fu">print</span>(chisq_power)</span></code></pre></div>
<pre><code>## 
##      Chi squared power calculation 
## 
##               w = 0.3
##               N = 107.0521
##              df = 2
##       sig.level = 0.05
##           power = 0.8
## 
## NOTE: N is the number of observations</code></pre>
<p><strong>参数解释：</strong> - <code>w</code>：效应大小，使用Cohen’s w表示。在卡方检验中，w=0.1表示小效应，w=0.3表示中效应，w=0.5表示大效应。 - <code>df</code>：自由度，计算公式为(行数-1)×(列数-1)。 - <code>N</code>：总样本量。</p>
<p><strong>6. 功效曲线的绘制</strong></p>
<p>功效曲线可以直观地展示样本量与统计功效之间的关系，帮助我们理解样本量选择的权衡：</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="基于经典分布的假设检验.html#cb779-1" tabindex="-1"></a><span class="co"># 加载绘图包</span></span>
<span id="cb779-2"><a href="基于经典分布的假设检验.html#cb779-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb779-3"><a href="基于经典分布的假设检验.html#cb779-3" tabindex="-1"></a></span>
<span id="cb779-4"><a href="基于经典分布的假设检验.html#cb779-4" tabindex="-1"></a><span class="co"># 生成不同样本量下的功效数据</span></span>
<span id="cb779-5"><a href="基于经典分布的假设检验.html#cb779-5" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">5</span>)</span>
<span id="cb779-6"><a href="基于经典分布的假设检验.html#cb779-6" tabindex="-1"></a>power_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(sample_sizes, <span class="cf">function</span>(n) {</span>
<span id="cb779-7"><a href="基于经典分布的假设检验.html#cb779-7" tabindex="-1"></a>  <span class="fu">pwr.t.test</span>(</span>
<span id="cb779-8"><a href="基于经典分布的假设检验.html#cb779-8" tabindex="-1"></a>    <span class="at">n =</span> n, <span class="co"># 样本量</span></span>
<span id="cb779-9"><a href="基于经典分布的假设检验.html#cb779-9" tabindex="-1"></a>    <span class="at">d =</span> <span class="fl">0.5</span>, <span class="co"># 效应大小</span></span>
<span id="cb779-10"><a href="基于经典分布的假设检验.html#cb779-10" tabindex="-1"></a>    <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="co"># 显著性水平</span></span>
<span id="cb779-11"><a href="基于经典分布的假设检验.html#cb779-11" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>, <span class="co"># 检验类型</span></span>
<span id="cb779-12"><a href="基于经典分布的假设检验.html#cb779-12" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span></span>
<span id="cb779-13"><a href="基于经典分布的假设检验.html#cb779-13" tabindex="-1"></a>  )<span class="sc">$</span>power</span>
<span id="cb779-14"><a href="基于经典分布的假设检验.html#cb779-14" tabindex="-1"></a>})</span>
<span id="cb779-15"><a href="基于经典分布的假设检验.html#cb779-15" tabindex="-1"></a></span>
<span id="cb779-16"><a href="基于经典分布的假设检验.html#cb779-16" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb779-17"><a href="基于经典分布的假设检验.html#cb779-17" tabindex="-1"></a>power_curve <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb779-18"><a href="基于经典分布的假设检验.html#cb779-18" tabindex="-1"></a>  <span class="at">sample_size =</span> sample_sizes,</span>
<span id="cb779-19"><a href="基于经典分布的假设检验.html#cb779-19" tabindex="-1"></a>  <span class="at">power =</span> power_values</span>
<span id="cb779-20"><a href="基于经典分布的假设检验.html#cb779-20" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="基于经典分布的假设检验.html#cb780-1" tabindex="-1"></a><span class="co"># 绘制功效曲线</span></span>
<span id="cb780-2"><a href="基于经典分布的假设检验.html#cb780-2" tabindex="-1"></a><span class="fu">ggplot</span>(power_curve, <span class="fu">aes</span>(<span class="at">x =</span> sample_size, <span class="at">y =</span> power)) <span class="sc">+</span></span>
<span id="cb780-3"><a href="基于经典分布的假设检验.html#cb780-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb780-4"><a href="基于经典分布的假设检验.html#cb780-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb780-5"><a href="基于经典分布的假设检验.html#cb780-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb780-6"><a href="基于经典分布的假设检验.html#cb780-6" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> t_power<span class="sc">$</span>n, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb780-7"><a href="基于经典分布的假设检验.html#cb780-7" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb780-8"><a href="基于经典分布的假设检验.html#cb780-8" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb780-9"><a href="基于经典分布的假设检验.html#cb780-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="dv">80</span>, <span class="at">y =</span> <span class="fl">0.82</span>,</span>
<span id="cb780-10"><a href="基于经典分布的假设检验.html#cb780-10" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">&quot;期望功效阈值 (0.8)&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb780-11"><a href="基于经典分布的假设检验.html#cb780-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb780-12"><a href="基于经典分布的假设检验.html#cb780-12" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb780-13"><a href="基于经典分布的假设检验.html#cb780-13" tabindex="-1"></a>    <span class="at">x =</span> t_power<span class="sc">$</span>n <span class="sc">+</span> <span class="dv">8</span>, <span class="at">y =</span> <span class="fl">0.3</span>,</span>
<span id="cb780-14"><a href="基于经典分布的假设检验.html#cb780-14" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;所需样本量 =&quot;</span>, <span class="fu">round</span>(t_power<span class="sc">$</span>n)),</span>
<span id="cb780-15"><a href="基于经典分布的假设检验.html#cb780-15" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb780-16"><a href="基于经典分布的假设检验.html#cb780-16" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb780-17"><a href="基于经典分布的假设检验.html#cb780-17" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb780-18"><a href="基于经典分布的假设检验.html#cb780-18" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;样本量对统计功效的影响&quot;</span>,</span>
<span id="cb780-19"><a href="基于经典分布的假设检验.html#cb780-19" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;每组样本量&quot;</span>,</span>
<span id="cb780-20"><a href="基于经典分布的假设检验.html#cb780-20" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;统计功效&quot;</span>,</span>
<span id="cb780-21"><a href="基于经典分布的假设检验.html#cb780-21" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;展示在中等效应大小(d=0.5)和α=0.05条件下，样本量与统计功效的关系&quot;</span></span>
<span id="cb780-22"><a href="基于经典分布的假设检验.html#cb780-22" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb780-23"><a href="基于经典分布的假设检验.html#cb780-23" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb780-24"><a href="基于经典分布的假设检验.html#cb780-24" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb780-25"><a href="基于经典分布的假设检验.html#cb780-25" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb780-26"><a href="基于经典分布的假设检验.html#cb780-26" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb780-27"><a href="基于经典分布的假设检验.html#cb780-27" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:power-curve-plotting"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/power-curve-plotting-1.png" alt="样本量对统计功效的影响：展示在中等效应大小下样本量增加如何提高统计功效" width="768" />
<p class="caption">
图6.20: 样本量对统计功效的影响：展示在中等效应大小下样本量增加如何提高统计功效
</p>
</div>
<p><strong>图表解释：</strong> - 蓝色曲线显示随着样本量增加，统计功效逐渐提高 - 红色虚线表示常用的功效阈值0.80 - 绿色虚线显示达到0.80功效所需的样本量 - 从曲线可以看出，样本量较小时功效增长较快，样本量较大时增长趋于平缓</p>
<p><strong>7. 敏感性分析</strong></p>
<p>由于效应大小的估计往往存在不确定性，进行敏感性分析是明智的做法：</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="基于经典分布的假设检验.html#cb781-1" tabindex="-1"></a><span class="co"># 测试不同效应大小下的样本量需求</span></span>
<span id="cb781-2"><a href="基于经典分布的假设检验.html#cb781-2" tabindex="-1"></a>effect_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>) <span class="co"># 小、中小、中、大效应</span></span>
<span id="cb781-3"><a href="基于经典分布的假设检验.html#cb781-3" tabindex="-1"></a>sample_needs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(effect_sizes, <span class="cf">function</span>(d) {</span>
<span id="cb781-4"><a href="基于经典分布的假设检验.html#cb781-4" tabindex="-1"></a>  <span class="fu">pwr.t.test</span>(</span>
<span id="cb781-5"><a href="基于经典分布的假设检验.html#cb781-5" tabindex="-1"></a>    <span class="at">d =</span> d, <span class="at">sig.level =</span> <span class="fl">0.05</span>, <span class="at">power =</span> <span class="fl">0.8</span>,</span>
<span id="cb781-6"><a href="基于经典分布的假设检验.html#cb781-6" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span></span>
<span id="cb781-7"><a href="基于经典分布的假设检验.html#cb781-7" tabindex="-1"></a>  )<span class="sc">$</span>n</span>
<span id="cb781-8"><a href="基于经典分布的假设检验.html#cb781-8" tabindex="-1"></a>})</span>
<span id="cb781-9"><a href="基于经典分布的假设检验.html#cb781-9" tabindex="-1"></a></span>
<span id="cb781-10"><a href="基于经典分布的假设检验.html#cb781-10" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb781-11"><a href="基于经典分布的假设检验.html#cb781-11" tabindex="-1"></a>sensitivity_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb781-12"><a href="基于经典分布的假设检验.html#cb781-12" tabindex="-1"></a>  <span class="at">effect_size =</span> effect_sizes,</span>
<span id="cb781-13"><a href="基于经典分布的假设检验.html#cb781-13" tabindex="-1"></a>  <span class="at">sample_need =</span> sample_needs,</span>
<span id="cb781-14"><a href="基于经典分布的假设检验.html#cb781-14" tabindex="-1"></a>  <span class="at">effect_label =</span> <span class="fu">c</span>(</span>
<span id="cb781-15"><a href="基于经典分布的假设检验.html#cb781-15" tabindex="-1"></a>    <span class="st">&quot;小效应(d=0.2)&quot;</span>, <span class="st">&quot;中小效应(d=0.3)&quot;</span>,</span>
<span id="cb781-16"><a href="基于经典分布的假设检验.html#cb781-16" tabindex="-1"></a>    <span class="st">&quot;中效应(d=0.5)&quot;</span>, <span class="st">&quot;大效应(d=0.8)&quot;</span></span>
<span id="cb781-17"><a href="基于经典分布的假设检验.html#cb781-17" tabindex="-1"></a>  )</span>
<span id="cb781-18"><a href="基于经典分布的假设检验.html#cb781-18" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="基于经典分布的假设检验.html#cb782-1" tabindex="-1"></a><span class="co"># 绘制敏感性分析图</span></span>
<span id="cb782-2"><a href="基于经典分布的假设检验.html#cb782-2" tabindex="-1"></a><span class="fu">ggplot</span>(sensitivity_df, <span class="fu">aes</span>(<span class="at">x =</span> effect_label, <span class="at">y =</span> sample_need,</span>
<span id="cb782-3"><a href="基于经典分布的假设检验.html#cb782-3" tabindex="-1"></a>                           <span class="at">fill =</span> effect_label)) <span class="sc">+</span></span>
<span id="cb782-4"><a href="基于经典分布的假设检验.html#cb782-4" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb782-5"><a href="基于经典分布的假设检验.html#cb782-5" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;n =&quot;</span>, <span class="fu">round</span>(sample_need))),</span>
<span id="cb782-6"><a href="基于经典分布的假设检验.html#cb782-6" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb782-7"><a href="基于经典分布的假设检验.html#cb782-7" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb782-8"><a href="基于经典分布的假设检验.html#cb782-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb782-9"><a href="基于经典分布的假设检验.html#cb782-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;不同效应大小下的样本量需求&quot;</span>,</span>
<span id="cb782-10"><a href="基于经典分布的假设检验.html#cb782-10" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;效应大小&quot;</span>,</span>
<span id="cb782-11"><a href="基于经典分布的假设检验.html#cb782-11" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;所需样本量（每组）&quot;</span>,</span>
<span id="cb782-12"><a href="基于经典分布的假设检验.html#cb782-12" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;在α=0.05和功效=0.80条件下&quot;</span></span>
<span id="cb782-13"><a href="基于经典分布的假设检验.html#cb782-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb782-14"><a href="基于经典分布的假设检验.html#cb782-14" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb782-15"><a href="基于经典分布的假设检验.html#cb782-15" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb782-16"><a href="基于经典分布的假设检验.html#cb782-16" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb782-17"><a href="基于经典分布的假设检验.html#cb782-17" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb782-18"><a href="基于经典分布的假设检验.html#cb782-18" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb782-19"><a href="基于经典分布的假设检验.html#cb782-19" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb782-20"><a href="基于经典分布的假设检验.html#cb782-20" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:sensitivity-analysis-plot"></span>
<img src="06-classical_hypothesis_tests_files/figure-html/sensitivity-analysis-plot-1.png" alt="效应大小对所需样本量的影响：展示不同效应大小水平下达到期望统计功效所需的样本量" width="768" />
<p class="caption">
图6.21: 效应大小对所需样本量的影响：展示不同效应大小水平下达到期望统计功效所需的样本量
</p>
</div>
<p><strong>实践建议：</strong></p>
<ol style="list-style-type: decimal">
<li><strong>效应大小估计</strong>：基于文献回顾、预实验或专家经验合理估计效应大小</li>
<li><strong>多重检验校正</strong>：如果计划进行多个检验，考虑使用更严格的显著性水平</li>
<li><strong>资源约束考量</strong>：在功效分析和实际可行性之间找到平衡点</li>
<li><strong>报告完整性</strong>：在论文中详细报告功效分析的过程和结果</li>
</ol>
<p>通过这些详细的R语言实现示例，生态学家可以在研究设计阶段就对自己的研究有清晰的预期，确保研究既具有足够的统计检测能力，又在实际资源约束下可行。</p>
</div>
<div id="总结-6" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> 总结<a href="基于经典分布的假设检验.html#总结-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="综合练习-4" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> 综合练习<a href="基于经典分布的假设检验.html#综合练习-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="相关性与相似性.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="基于模拟的假设检验.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": false,
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["ecological-statistics.pdf", "ecological-statistics.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
