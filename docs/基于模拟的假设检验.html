<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 基于模拟的假设检验 | 生态统计学</title>
  <meta name="description" content="7 基于模拟的假设检验 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="7 基于模拟的假设检验 | 生态统计学" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="7 基于模拟的假设检验 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 基于模拟的假设检验 | 生态统计学" />
  
  <meta name="twitter:description" content="7 基于模拟的假设检验 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  

<meta name="author" content="沈国春、李勤" />


<meta name="date" content="2025-10-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="基于经典分布的假设检验.html"/>
<link rel="next" href="简单线性回归模型.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7cbaf067c715044120ee231397e9ace3";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">生态统计学</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#为什么"><i class="fa fa-check"></i><b>0.1</b> 为什么</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#在不确定的世界中寻找规律"><i class="fa fa-check"></i><b>0.1.1</b> 在不确定的世界中寻找规律</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#ai时代的机遇与陷阱"><i class="fa fa-check"></i><b>0.1.2</b> AI时代的机遇与陷阱</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#本书介绍"><i class="fa fa-check"></i><b>0.2</b> 本书介绍</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#本书特色与教学理念"><i class="fa fa-check"></i><b>0.2.1</b> 本书特色与教学理念</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#课程在线资源"><i class="fa fa-check"></i><b>0.3</b> 课程在线资源</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#学习方式"><i class="fa fa-check"></i><b>0.4</b> 学习方式</a>
<ul>
<li class="chapter" data-level="0.4.1" data-path="index.html"><a href="index.html#持续学习r语言的重要性"><i class="fa fa-check"></i><b>0.4.1</b> 持续学习R语言的重要性</a></li>
<li class="chapter" data-level="0.4.2" data-path="index.html"><a href="index.html#在错误中快速成长"><i class="fa fa-check"></i><b>0.4.2</b> 在错误中快速成长</a></li>
<li class="chapter" data-level="0.4.3" data-path="index.html"><a href="index.html#实践导向的学习策略"><i class="fa fa-check"></i><b>0.4.3</b> 实践导向的学习策略</a></li>
<li class="chapter" data-level="0.4.4" data-path="index.html"><a href="index.html#正确的上课姿势"><i class="fa fa-check"></i><b>0.4.4</b> 正确的上课姿势</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#重复本书例子"><i class="fa fa-check"></i><b>0.5</b> 重复本书例子</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="统计编程基础.html"><a href="统计编程基础.html"><i class="fa fa-check"></i><b>1</b> 统计编程基础</a>
<ul>
<li class="chapter" data-level="1.1" data-path="统计编程基础.html"><a href="统计编程基础.html#引言"><i class="fa fa-check"></i><b>1.1</b> 引言</a></li>
<li class="chapter" data-level="1.2" data-path="统计编程基础.html"><a href="统计编程基础.html#核心能力培养框架"><i class="fa fa-check"></i><b>1.2</b> 核心能力培养框架</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="统计编程基础.html"><a href="统计编程基础.html#高阶思维与问题解决能力"><i class="fa fa-check"></i><b>1.2.1</b> 高阶思维与问题解决能力</a></li>
<li class="chapter" data-level="1.2.2" data-path="统计编程基础.html"><a href="统计编程基础.html#与llm协同工作的能力"><i class="fa fa-check"></i><b>1.2.2</b> 与LLM协同工作的能力</a></li>
<li class="chapter" data-level="1.2.3" data-path="统计编程基础.html"><a href="统计编程基础.html#传统但愈发重要的软技能"><i class="fa fa-check"></i><b>1.2.3</b> 传统但愈发重要的软技能</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="统计编程基础.html"><a href="统计编程基础.html#通用编程思维基础"><i class="fa fa-check"></i><b>1.3</b> 通用编程思维基础</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="统计编程基础.html"><a href="统计编程基础.html#编程核心概念"><i class="fa fa-check"></i><b>1.3.1</b> 编程核心概念</a></li>
<li class="chapter" data-level="1.3.2" data-path="统计编程基础.html"><a href="统计编程基础.html#算法复杂度"><i class="fa fa-check"></i><b>1.3.2</b> 算法复杂度</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="统计编程基础.html"><a href="统计编程基础.html#ai协同编程技能"><i class="fa fa-check"></i><b>1.4</b> AI协同编程技能</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="统计编程基础.html"><a href="统计编程基础.html#ai编程模块安装"><i class="fa fa-check"></i><b>1.4.1</b> AI编程模块安装</a></li>
<li class="chapter" data-level="1.4.2" data-path="统计编程基础.html"><a href="统计编程基础.html#精准提问技巧"><i class="fa fa-check"></i><b>1.4.2</b> 精准提问技巧</a></li>
<li class="chapter" data-level="1.4.3" data-path="统计编程基础.html"><a href="统计编程基础.html#代码审查能力"><i class="fa fa-check"></i><b>1.4.3</b> 代码审查能力</a></li>
<li class="chapter" data-level="1.4.4" data-path="统计编程基础.html"><a href="统计编程基础.html#调试与错误处理"><i class="fa fa-check"></i><b>1.4.4</b> 调试与错误处理</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="统计编程基础.html"><a href="统计编程基础.html#总结"><i class="fa fa-check"></i><b>1.5</b> 总结</a></li>
<li class="chapter" data-level="1.6" data-path="统计编程基础.html"><a href="统计编程基础.html#综合练习"><i class="fa fa-check"></i><b>1.6</b> 综合练习</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="统计编程基础.html"><a href="统计编程基础.html#练习1"><i class="fa fa-check"></i><b>1.6.1</b> 练习1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="概率与分布.html"><a href="概率与分布.html"><i class="fa fa-check"></i><b>2</b> 概率与分布</a>
<ul>
<li class="chapter" data-level="2.1" data-path="概率与分布.html"><a href="概率与分布.html#引言-1"><i class="fa fa-check"></i><b>2.1</b> 引言</a></li>
<li class="chapter" data-level="2.2" data-path="概率与分布.html"><a href="概率与分布.html#蚂蚱午餐与概率"><i class="fa fa-check"></i><b>2.2</b> 蚂蚱午餐与概率</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="概率与分布.html"><a href="概率与分布.html#一只蚱蜢的午餐"><i class="fa fa-check"></i><b>2.2.1</b> 一只蚱蜢的午餐</a></li>
<li class="chapter" data-level="2.2.2" data-path="概率与分布.html"><a href="概率与分布.html#理想的猜测古典概率"><i class="fa fa-check"></i><b>2.2.2</b> 理想的猜测——古典概率</a></li>
<li class="chapter" data-level="2.2.3" data-path="概率与分布.html"><a href="概率与分布.html#数据的语言频率概率"><i class="fa fa-check"></i><b>2.2.3</b> 数据的语言——频率概率</a></li>
<li class="chapter" data-level="2.2.4" data-path="概率与分布.html"><a href="概率与分布.html#动态的更新贝叶斯概率"><i class="fa fa-check"></i><b>2.2.4</b> 动态的更新——贝叶斯概率</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="概率与分布.html"><a href="概率与分布.html#随机变量与分布"><i class="fa fa-check"></i><b>2.3</b> 随机变量与分布</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="概率与分布.html"><a href="概率与分布.html#概率分布"><i class="fa fa-check"></i><b>2.3.1</b> 概率分布</a></li>
<li class="chapter" data-level="2.3.2" data-path="概率与分布.html"><a href="概率与分布.html#累积概率分布从可能性到确定性"><i class="fa fa-check"></i><b>2.3.2</b> 累积概率分布：从可能性到确定性</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="概率与分布.html"><a href="概率与分布.html#午餐菜单离散随机变量的分布家族"><i class="fa fa-check"></i><b>2.4</b> 午餐菜单：离散随机变量的分布家族</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="概率与分布.html"><a href="概率与分布.html#伯努利分布一个是或否的终极问题"><i class="fa fa-check"></i><b>2.4.1</b> 伯努利分布：一个”是”或”否”的终极问题</a></li>
<li class="chapter" data-level="2.4.2" data-path="概率与分布.html"><a href="概率与分布.html#二项分布重复是非题的计数法则"><i class="fa fa-check"></i><b>2.4.2</b> 二项分布：重复”是非题”的计数法则</a></li>
<li class="chapter" data-level="2.4.3" data-path="概率与分布.html"><a href="概率与分布.html#多项式分布多元选择的全景图"><i class="fa fa-check"></i><b>2.4.3</b> 多项式分布：多元选择的”全景图”</a></li>
<li class="chapter" data-level="2.4.4" data-path="概率与分布.html"><a href="概率与分布.html#泊松分布罕见事件的低语者"><i class="fa fa-check"></i><b>2.4.4</b> 泊松分布：罕见事件的”低语者”</a></li>
<li class="chapter" data-level="2.4.5" data-path="概率与分布.html"><a href="概率与分布.html#几何分布等待第一次成功的耐心"><i class="fa fa-check"></i><b>2.4.5</b> 几何分布：等待”第一次成功”的耐心</a></li>
<li class="chapter" data-level="2.4.6" data-path="概率与分布.html"><a href="概率与分布.html#负二项分布等待最后一次成功的耐心"><i class="fa fa-check"></i><b>2.4.6</b> 负二项分布：等待”最后一次成功”的耐心</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="概率与分布.html"><a href="概率与分布.html#午餐法则连续随机变量的分布家族"><i class="fa fa-check"></i><b>2.5</b> 午餐法则：连续随机变量的分布家族</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="概率与分布.html"><a href="概率与分布.html#均匀分布纯粹的平等"><i class="fa fa-check"></i><b>2.5.1</b> 均匀分布：纯粹的平等</a></li>
<li class="chapter" data-level="2.5.2" data-path="概率与分布.html"><a href="概率与分布.html#指数分布等待的艺术"><i class="fa fa-check"></i><b>2.5.2</b> 指数分布：等待的艺术</a></li>
<li class="chapter" data-level="2.5.3" data-path="概率与分布.html"><a href="概率与分布.html#正态分布高斯分布自然界的钟形法则"><i class="fa fa-check"></i><b>2.5.3</b> 正态分布（高斯分布）：自然界的”钟形”法则</a></li>
<li class="chapter" data-level="2.5.4" data-path="概率与分布.html"><a href="概率与分布.html#威布尔分布生存分析的时间法则"><i class="fa fa-check"></i><b>2.5.4</b> 威布尔分布：生存分析的”时间法则”</a></li>
<li class="chapter" data-level="2.5.5" data-path="概率与分布.html"><a href="概率与分布.html#伽马分布更一般的等待时间模型"><i class="fa fa-check"></i><b>2.5.5</b> 伽马分布：更一般的等待时间模型</a></li>
<li class="chapter" data-level="2.5.6" data-path="概率与分布.html"><a href="概率与分布.html#贝塔分布比例变量的天然选择"><i class="fa fa-check"></i><b>2.5.6</b> 贝塔分布：比例变量的天然选择</a></li>
<li class="chapter" data-level="2.5.7" data-path="概率与分布.html"><a href="概率与分布.html#正态的魔力中心极限定理"><i class="fa fa-check"></i><b>2.5.7</b> 正态的魔力：中心极限定理</a></li>
<li class="chapter" data-level="2.5.8" data-path="概率与分布.html"><a href="概率与分布.html#生态学应用实例"><i class="fa fa-check"></i><b>2.5.8</b> 生态学应用实例</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="概率与分布.html"><a href="概率与分布.html#混合分布处理异质性数据"><i class="fa fa-check"></i><b>2.6</b> 混合分布：处理异质性数据</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="概率与分布.html"><a href="概率与分布.html#零膨胀分布处理零值过多的数据"><i class="fa fa-check"></i><b>2.6.1</b> 零膨胀分布：处理零值过多的数据</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="概率与分布.html"><a href="概率与分布.html#总结-2"><i class="fa fa-check"></i><b>2.7</b> 总结</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="描述统计.html"><a href="描述统计.html"><i class="fa fa-check"></i><b>3</b> 描述统计</a>
<ul>
<li class="chapter" data-level="3.1" data-path="描述统计.html"><a href="描述统计.html#引言-2"><i class="fa fa-check"></i><b>3.1</b> 引言</a></li>
<li class="chapter" data-level="3.2" data-path="描述统计.html"><a href="描述统计.html#描述统计基础"><i class="fa fa-check"></i><b>3.2</b> 描述统计基础</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="描述统计.html"><a href="描述统计.html#中心趋势测量"><i class="fa fa-check"></i><b>3.2.1</b> 中心趋势测量</a></li>
<li class="chapter" data-level="3.2.2" data-path="描述统计.html"><a href="描述统计.html#离散性测量"><i class="fa fa-check"></i><b>3.2.2</b> 离散性测量</a></li>
<li class="chapter" data-level="3.2.3" data-path="描述统计.html"><a href="描述统计.html#分布形状与矩测量"><i class="fa fa-check"></i><b>3.2.3</b> 分布形状与矩测量</a></li>
<li class="chapter" data-level="3.2.4" data-path="描述统计.html"><a href="描述统计.html#统计概念在概率分布图上的可视化"><i class="fa fa-check"></i><b>3.2.4</b> 统计概念在概率分布图上的可视化</a></li>
<li class="chapter" data-level="3.2.5" data-path="描述统计.html"><a href="描述统计.html#标准误的可视化理解"><i class="fa fa-check"></i><b>3.2.5</b> 标准误的可视化理解</a></li>
<li class="chapter" data-level="3.2.6" data-path="描述统计.html"><a href="描述统计.html#不同参数值的分布形状比较"><i class="fa fa-check"></i><b>3.2.6</b> 不同参数值的分布形状比较</a></li>
<li class="chapter" data-level="3.2.7" data-path="描述统计.html"><a href="描述统计.html#生态学意义总结"><i class="fa fa-check"></i><b>3.2.7</b> 生态学意义总结</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="描述统计.html"><a href="描述统计.html#环境异质性描述"><i class="fa fa-check"></i><b>3.3</b> 环境异质性描述</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="描述统计.html"><a href="描述统计.html#环境异质性的概念"><i class="fa fa-check"></i><b>3.3.1</b> 环境异质性的概念</a></li>
<li class="chapter" data-level="3.3.2" data-path="描述统计.html"><a href="描述统计.html#环境异质性的可视化理解"><i class="fa fa-check"></i><b>3.3.2</b> 环境异质性的可视化理解</a></li>
<li class="chapter" data-level="3.3.3" data-path="描述统计.html"><a href="描述统计.html#环境异质性的量化方法"><i class="fa fa-check"></i><b>3.3.3</b> 环境异质性的量化方法</a></li>
<li class="chapter" data-level="3.3.4" data-path="描述统计.html"><a href="描述统计.html#环境异质性的生态学意义"><i class="fa fa-check"></i><b>3.3.4</b> 环境异质性的生态学意义</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="描述统计.html"><a href="描述统计.html#个体特征描述"><i class="fa fa-check"></i><b>3.4</b> 个体特征描述</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="描述统计.html"><a href="描述统计.html#生存函数survival-function"><i class="fa fa-check"></i><b>3.4.1</b> 生存函数（Survival Function）</a></li>
<li class="chapter" data-level="3.4.2" data-path="描述统计.html"><a href="描述统计.html#瞬时死亡风险函数hazard-function"><i class="fa fa-check"></i><b>3.4.2</b> 瞬时死亡风险函数（Hazard Function）</a></li>
<li class="chapter" data-level="3.4.3" data-path="描述统计.html"><a href="描述统计.html#累积风险函数cumulative-hazard-function"><i class="fa fa-check"></i><b>3.4.3</b> 累积风险函数（Cumulative Hazard Function）</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="描述统计.html"><a href="描述统计.html#种群特征描述"><i class="fa fa-check"></i><b>3.5</b> 种群特征描述</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="描述统计.html"><a href="描述统计.html#gini系数"><i class="fa fa-check"></i><b>3.5.1</b> Gini系数</a></li>
<li class="chapter" data-level="3.5.2" data-path="描述统计.html"><a href="描述统计.html#lorenz曲线"><i class="fa fa-check"></i><b>3.5.2</b> Lorenz曲线</a></li>
<li class="chapter" data-level="3.5.3" data-path="描述统计.html"><a href="描述统计.html#基尼系数的生态学应用"><i class="fa fa-check"></i><b>3.5.3</b> 基尼系数的生态学应用</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="描述统计.html"><a href="描述统计.html#群落特征描述"><i class="fa fa-check"></i><b>3.6</b> 群落特征描述</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="描述统计.html"><a href="描述统计.html#物种多样性描述"><i class="fa fa-check"></i><b>3.6.1</b> 物种多样性描述</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="描述统计.html"><a href="描述统计.html#生态网络特征描述"><i class="fa fa-check"></i><b>3.7</b> 生态网络特征描述</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="描述统计.html"><a href="描述统计.html#网络拓扑指标"><i class="fa fa-check"></i><b>3.7.1</b> 网络拓扑指标</a></li>
<li class="chapter" data-level="3.7.2" data-path="描述统计.html"><a href="描述统计.html#食物网特征"><i class="fa fa-check"></i><b>3.7.2</b> 食物网特征</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="描述统计.html"><a href="描述统计.html#稳定性描述"><i class="fa fa-check"></i><b>3.8</b> 稳定性描述</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="描述统计.html"><a href="描述统计.html#抵抗力resistance"><i class="fa fa-check"></i><b>3.8.1</b> 抵抗力（Resistance）</a></li>
<li class="chapter" data-level="3.8.2" data-path="描述统计.html"><a href="描述统计.html#恢复力resilience"><i class="fa fa-check"></i><b>3.8.2</b> 恢复力（Resilience）</a></li>
<li class="chapter" data-level="3.8.3" data-path="描述统计.html"><a href="描述统计.html#持久性persistence"><i class="fa fa-check"></i><b>3.8.3</b> 持久性（Persistence）</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="描述统计.html"><a href="描述统计.html#总结-3"><i class="fa fa-check"></i><b>3.9</b> 总结</a></li>
<li class="chapter" data-level="3.10" data-path="描述统计.html"><a href="描述统计.html#综合练习-1"><i class="fa fa-check"></i><b>3.10</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="参数估计.html"><a href="参数估计.html"><i class="fa fa-check"></i><b>4</b> 参数估计</a>
<ul>
<li class="chapter" data-level="4.1" data-path="参数估计.html"><a href="参数估计.html#引言-3"><i class="fa fa-check"></i><b>4.1</b> 引言</a></li>
<li class="chapter" data-level="4.2" data-path="参数估计.html"><a href="参数估计.html#样本与总体"><i class="fa fa-check"></i><b>4.2</b> 样本与总体</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="参数估计.html"><a href="参数估计.html#抽样方法及其生态学应用"><i class="fa fa-check"></i><b>4.2.1</b> 抽样方法及其生态学应用</a></li>
<li class="chapter" data-level="4.2.2" data-path="参数估计.html"><a href="参数估计.html#r语言中的抽样实现"><i class="fa fa-check"></i><b>4.2.2</b> R语言中的抽样实现</a></li>
<li class="chapter" data-level="4.2.3" data-path="参数估计.html"><a href="参数估计.html#抽样误差与样本量确定"><i class="fa fa-check"></i><b>4.2.3</b> 抽样误差与样本量确定</a></li>
<li class="chapter" data-level="4.2.4" data-path="参数估计.html"><a href="参数估计.html#生态学抽样设计的实践考虑"><i class="fa fa-check"></i><b>4.2.4</b> 生态学抽样设计的实践考虑</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="参数估计.html"><a href="参数估计.html#参数估计基础"><i class="fa fa-check"></i><b>4.3</b> 参数估计基础</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="参数估计.html"><a href="参数估计.html#点估计"><i class="fa fa-check"></i><b>4.3.1</b> 点估计</a></li>
<li class="chapter" data-level="4.3.2" data-path="参数估计.html"><a href="参数估计.html#区间估计"><i class="fa fa-check"></i><b>4.3.2</b> 区间估计</a></li>
<li class="chapter" data-level="4.3.3" data-path="参数估计.html"><a href="参数估计.html#估计方法"><i class="fa fa-check"></i><b>4.3.3</b> 估计方法</a></li>
<li class="chapter" data-level="4.3.4" data-path="参数估计.html"><a href="参数估计.html#估计量性质如何评价一个估计方法的好坏"><i class="fa fa-check"></i><b>4.3.4</b> 估计量性质：如何评价一个估计方法的好坏？</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="参数估计.html"><a href="参数估计.html#种群大小估计"><i class="fa fa-check"></i><b>4.4</b> 种群大小估计</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="参数估计.html"><a href="参数估计.html#标记重捕法"><i class="fa fa-check"></i><b>4.4.1</b> 标记重捕法</a></li>
<li class="chapter" data-level="4.4.2" data-path="参数估计.html"><a href="参数估计.html#面积取样法"><i class="fa fa-check"></i><b>4.4.2</b> 面积取样法</a></li>
<li class="chapter" data-level="4.4.3" data-path="参数估计.html"><a href="参数估计.html#距离抽样法"><i class="fa fa-check"></i><b>4.4.3</b> 距离抽样法</a></li>
<li class="chapter" data-level="4.4.4" data-path="参数估计.html"><a href="参数估计.html#去除法"><i class="fa fa-check"></i><b>4.4.4</b> 去除法</a></li>
<li class="chapter" data-level="4.4.5" data-path="参数估计.html"><a href="参数估计.html#种群大小估计方法的选择与比较"><i class="fa fa-check"></i><b>4.4.5</b> 种群大小估计方法的选择与比较</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="参数估计.html"><a href="参数估计.html#物种多样性估计"><i class="fa fa-check"></i><b>4.5</b> 物种多样性估计</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="参数估计.html"><a href="参数估计.html#外推和内插方法"><i class="fa fa-check"></i><b>4.5.1</b> 外推和内插方法</a></li>
<li class="chapter" data-level="4.5.2" data-path="参数估计.html"><a href="参数估计.html#多样性估计的抽样偏差"><i class="fa fa-check"></i><b>4.5.2</b> 多样性估计的抽样偏差</a></li>
<li class="chapter" data-level="4.5.3" data-path="参数估计.html"><a href="参数估计.html#多样性估计方法的选择与比较"><i class="fa fa-check"></i><b>4.5.3</b> 多样性估计方法的选择与比较</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="参数估计.html"><a href="参数估计.html#总结-4"><i class="fa fa-check"></i><b>4.6</b> 总结</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="参数估计.html"><a href="参数估计.html#参数估计的生态学意义与理论基础"><i class="fa fa-check"></i><b>4.6.1</b> 参数估计的生态学意义与理论基础</a></li>
<li class="chapter" data-level="4.6.2" data-path="参数估计.html"><a href="参数估计.html#点估计与区间估计从单一数值到可信范围"><i class="fa fa-check"></i><b>4.6.2</b> 点估计与区间估计：从单一数值到可信范围</a></li>
<li class="chapter" data-level="4.6.3" data-path="参数估计.html"><a href="参数估计.html#主要估计方法及其生态学应用"><i class="fa fa-check"></i><b>4.6.3</b> 主要估计方法及其生态学应用</a></li>
<li class="chapter" data-level="4.6.4" data-path="参数估计.html"><a href="参数估计.html#种群大小估计生态学实践的核心任务"><i class="fa fa-check"></i><b>4.6.4</b> 种群大小估计：生态学实践的核心任务</a></li>
<li class="chapter" data-level="4.6.5" data-path="参数估计.html"><a href="参数估计.html#物种多样性估计群落生态学的量化基础"><i class="fa fa-check"></i><b>4.6.5</b> 物种多样性估计：群落生态学的量化基础</a></li>
<li class="chapter" data-level="4.6.6" data-path="参数估计.html"><a href="参数估计.html#参数估计在生态学决策中的重要性"><i class="fa fa-check"></i><b>4.6.6</b> 参数估计在生态学决策中的重要性</a></li>
<li class="chapter" data-level="4.6.7" data-path="参数估计.html"><a href="参数估计.html#未来发展方向与挑战"><i class="fa fa-check"></i><b>4.6.7</b> 未来发展方向与挑战</a></li>
<li class="chapter" data-level="4.6.8" data-path="参数估计.html"><a href="参数估计.html#结语"><i class="fa fa-check"></i><b>4.6.8</b> 结语</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="参数估计.html"><a href="参数估计.html#综合练习-2"><i class="fa fa-check"></i><b>4.7</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="相关性与相似性.html"><a href="相关性与相似性.html"><i class="fa fa-check"></i><b>5</b> 相关性与相似性</a>
<ul>
<li class="chapter" data-level="5.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#引言-4"><i class="fa fa-check"></i><b>5.1</b> 引言</a></li>
<li class="chapter" data-level="5.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#线性相关性"><i class="fa fa-check"></i><b>5.2</b> 线性相关性</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#pearson相关系数线性关系的度量"><i class="fa fa-check"></i><b>5.2.1</b> Pearson相关系数：线性关系的度量</a></li>
<li class="chapter" data-level="5.2.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#spearman秩相关单调关系的度量"><i class="fa fa-check"></i><b>5.2.2</b> Spearman秩相关：单调关系的度量</a></li>
<li class="chapter" data-level="5.2.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#kendalls-τ基于一致对的比例"><i class="fa fa-check"></i><b>5.2.3</b> Kendall’s τ：基于一致对的比例</a></li>
<li class="chapter" data-level="5.2.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#偏相关分析"><i class="fa fa-check"></i><b>5.2.4</b> 偏相关分析</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#非线性相关"><i class="fa fa-check"></i><b>5.3</b> 非线性相关</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#距离相关"><i class="fa fa-check"></i><b>5.3.1</b> 距离相关</a></li>
<li class="chapter" data-level="5.3.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#互信息"><i class="fa fa-check"></i><b>5.3.2</b> 互信息</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#时间自相关"><i class="fa fa-check"></i><b>5.4</b> 时间自相关</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#生态学中的时间自相关实例"><i class="fa fa-check"></i><b>5.4.1</b> 生态学中的时间自相关实例</a></li>
<li class="chapter" data-level="5.4.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#自相关函数acf时间依赖性的量化"><i class="fa fa-check"></i><b>5.4.2</b> 自相关函数（ACF）：时间依赖性的量化</a></li>
<li class="chapter" data-level="5.4.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#偏自相关函数pacf直接时间依赖的识别"><i class="fa fa-check"></i><b>5.4.3</b> 偏自相关函数（PACF）：直接时间依赖的识别</a></li>
<li class="chapter" data-level="5.4.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#时间序列平稳性分析的基础假设"><i class="fa fa-check"></i><b>5.4.4</b> 时间序列平稳性：分析的基础假设</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#空间自相关"><i class="fa fa-check"></i><b>5.5</b> 空间自相关</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#变异函数variogram空间依赖性的量化"><i class="fa fa-check"></i><b>5.5.1</b> 变异函数（Variogram）：空间依赖性的量化</a></li>
<li class="chapter" data-level="5.5.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#克里金插值基于空间自相关的预测方法"><i class="fa fa-check"></i><b>5.5.2</b> 克里金插值：基于空间自相关的预测方法</a></li>
<li class="chapter" data-level="5.5.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#空间自相关指数全局空间模式的检测"><i class="fa fa-check"></i><b>5.5.3</b> 空间自相关指数：全局空间模式的检测</a></li>
<li class="chapter" data-level="5.5.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#局部空间自相关空间异质性的识别"><i class="fa fa-check"></i><b>5.5.4</b> 局部空间自相关：空间异质性的识别</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育相关性"><i class="fa fa-check"></i><b>5.6</b> 系统发育相关性</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育信号进化历史的印记"><i class="fa fa-check"></i><b>5.6.1</b> 系统发育信号：进化历史的印记</a></li>
<li class="chapter" data-level="5.6.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育独立对比去除系统发育影响的性状比较"><i class="fa fa-check"></i><b>5.6.2</b> 系统发育独立对比：去除系统发育影响的性状比较</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="相关性与相似性.html"><a href="相关性与相似性.html#相似性与距离"><i class="fa fa-check"></i><b>5.7</b> 相似性与距离</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#常用相似性系数"><i class="fa fa-check"></i><b>5.7.1</b> 常用相似性系数</a></li>
<li class="chapter" data-level="5.7.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#功能性状间相关性"><i class="fa fa-check"></i><b>5.7.2</b> 功能性状间相关性</a></li>
<li class="chapter" data-level="5.7.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#种内相关性"><i class="fa fa-check"></i><b>5.7.3</b> 种内相关性</a></li>
<li class="chapter" data-level="5.7.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#种间相关性"><i class="fa fa-check"></i><b>5.7.4</b> 种间相关性</a></li>
<li class="chapter" data-level="5.7.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#群落相似性"><i class="fa fa-check"></i><b>5.7.5</b> 群落相似性</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="相关性与相似性.html"><a href="相关性与相似性.html#总结-5"><i class="fa fa-check"></i><b>5.8</b> 总结</a></li>
<li class="chapter" data-level="5.9" data-path="相关性与相似性.html"><a href="相关性与相似性.html#综合练习-3"><i class="fa fa-check"></i><b>5.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html"><i class="fa fa-check"></i><b>6</b> 基于经典分布的假设检验</a>
<ul>
<li class="chapter" data-level="6.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#引言-5"><i class="fa fa-check"></i><b>6.1</b> 引言</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#假设检验基础"><i class="fa fa-check"></i><b>6.1.1</b> 假设检验基础</a></li>
<li class="chapter" data-level="6.1.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#假设检验的基本步骤"><i class="fa fa-check"></i><b>6.1.2</b> 假设检验的基本步骤</a></li>
<li class="chapter" data-level="6.1.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#零假设与备择假设"><i class="fa fa-check"></i><b>6.1.3</b> 零假设与备择假设</a></li>
<li class="chapter" data-level="6.1.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#检验统计量与p值"><i class="fa fa-check"></i><b>6.1.4</b> 检验统计量与p值</a></li>
<li class="chapter" data-level="6.1.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#显著性水平"><i class="fa fa-check"></i><b>6.1.5</b> 显著性水平</a></li>
<li class="chapter" data-level="6.1.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#效应大小与置信区间"><i class="fa fa-check"></i><b>6.1.6</b> 效应大小与置信区间</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本检验"><i class="fa fa-check"></i><b>6.2</b> 单样本检验</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本t检验"><i class="fa fa-check"></i><b>6.2.1</b> 单样本t检验</a></li>
<li class="chapter" data-level="6.2.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本符号检验"><i class="fa fa-check"></i><b>6.2.2</b> 单样本符号检验</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#双样本检验"><i class="fa fa-check"></i><b>6.3</b> 双样本检验</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#独立样本t检验"><i class="fa fa-check"></i><b>6.3.1</b> 独立样本t检验</a></li>
<li class="chapter" data-level="6.3.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#配对样本t检验"><i class="fa fa-check"></i><b>6.3.2</b> 配对样本t检验</a></li>
<li class="chapter" data-level="6.3.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#mann-whitney-u检验"><i class="fa fa-check"></i><b>6.3.3</b> Mann-Whitney U检验</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多样本检验"><i class="fa fa-check"></i><b>6.4</b> 多样本检验</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#方差分析anova"><i class="fa fa-check"></i><b>6.4.1</b> 方差分析（ANOVA）</a></li>
<li class="chapter" data-level="6.4.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#kruskal-wallis检验"><i class="fa fa-check"></i><b>6.4.2</b> Kruskal-Wallis检验</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#非参数检验方法"><i class="fa fa-check"></i><b>6.5</b> 非参数检验方法</a></li>
<li class="chapter" data-level="6.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较校正"><i class="fa fa-check"></i><b>6.6</b> 多重比较校正</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较问题的本质"><i class="fa fa-check"></i><b>6.6.1</b> 多重比较问题的本质</a></li>
<li class="chapter" data-level="6.6.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#bonferroni校正"><i class="fa fa-check"></i><b>6.6.2</b> Bonferroni校正</a></li>
<li class="chapter" data-level="6.6.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#tukey-hsd检验"><i class="fa fa-check"></i><b>6.6.3</b> Tukey HSD检验</a></li>
<li class="chapter" data-level="6.6.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#fdr错误发现率控制"><i class="fa fa-check"></i><b>6.6.4</b> FDR（错误发现率）控制</a></li>
<li class="chapter" data-level="6.6.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#生态学实例森林类型对鸟类多样性的影响"><i class="fa fa-check"></i><b>6.6.5</b> 生态学实例：森林类型对鸟类多样性的影响</a></li>
<li class="chapter" data-level="6.6.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较校正效果的可视化"><i class="fa fa-check"></i><b>6.6.6</b> 多重比较校正效果的可视化</a></li>
<li class="chapter" data-level="6.6.7" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#实用建议与最佳实践"><i class="fa fa-check"></i><b>6.6.7</b> 实用建议与最佳实践</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#功效分析"><i class="fa fa-check"></i><b>6.7</b> 功效分析</a></li>
<li class="chapter" data-level="6.8" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#总结-6"><i class="fa fa-check"></i><b>6.8</b> 总结</a></li>
<li class="chapter" data-level="6.9" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#综合练习-4"><i class="fa fa-check"></i><b>6.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html"><i class="fa fa-check"></i><b>7</b> 基于模拟的假设检验</a>
<ul>
<li class="chapter" data-level="7.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#引言-6"><i class="fa fa-check"></i><b>7.1</b> 引言</a></li>
<li class="chapter" data-level="7.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学层次与演进脉络"><i class="fa fa-check"></i><b>7.2</b> 方法学层次与演进脉络</a></li>
<li class="chapter" data-level="7.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验"><i class="fa fa-check"></i><b>7.3</b> 置换检验</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验的基本原理"><i class="fa fa-check"></i><b>7.3.1</b> 置换检验的基本原理</a></li>
<li class="chapter" data-level="7.3.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验的技术实现过程"><i class="fa fa-check"></i><b>7.3.2</b> 置换检验的技术实现过程</a></li>
<li class="chapter" data-level="7.3.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例"><i class="fa fa-check"></i><b>7.3.3</b> R语言实现示例</a></li>
<li class="chapter" data-level="7.3.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验在生态学中的应用价值与局限"><i class="fa fa-check"></i><b>7.3.4</b> 置换检验在生态学中的应用价值与局限</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验"><i class="fa fa-check"></i><b>7.4</b> 蒙特卡洛检验</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛方法的概念体系"><i class="fa fa-check"></i><b>7.4.1</b> 蒙特卡洛方法的概念体系</a></li>
<li class="chapter" data-level="7.4.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验的基本原理"><i class="fa fa-check"></i><b>7.4.2</b> 蒙特卡洛检验的基本原理</a></li>
<li class="chapter" data-level="7.4.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验的主要类型"><i class="fa fa-check"></i><b>7.4.3</b> 蒙特卡洛检验的主要类型</a></li>
<li class="chapter" data-level="7.4.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例空间分布随机性检验"><i class="fa fa-check"></i><b>7.4.4</b> R语言实现示例：空间分布随机性检验</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法检验"><i class="fa fa-check"></i><b>7.5</b> 自助法检验</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的基本原理"><i class="fa fa-check"></i><b>7.5.1</b> 自助法的基本原理</a></li>
<li class="chapter" data-level="7.5.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的实施步骤"><i class="fa fa-check"></i><b>7.5.2</b> 自助法的实施步骤</a></li>
<li class="chapter" data-level="7.5.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法在生态学中的应用"><i class="fa fa-check"></i><b>7.5.3</b> 自助法在生态学中的应用</a></li>
<li class="chapter" data-level="7.5.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例-1"><i class="fa fa-check"></i><b>7.5.4</b> R语言实现示例</a></li>
<li class="chapter" data-level="7.5.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的优势与局限"><i class="fa fa-check"></i><b>7.5.5</b> 自助法的优势与局限</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#基因型频率检验"><i class="fa fa-check"></i><b>7.6</b> 基因型频率检验</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#hardy-weinberg平衡检验"><i class="fa fa-check"></i><b>7.6.1</b> Hardy-Weinberg平衡检验</a></li>
<li class="chapter" data-level="7.6.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#连锁不平衡检验"><i class="fa fa-check"></i><b>7.6.2</b> 连锁不平衡检验</a></li>
<li class="chapter" data-level="7.6.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与选择建议"><i class="fa fa-check"></i><b>7.6.3</b> 方法学比较与选择建议</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#多样性差异检验"><i class="fa fa-check"></i><b>7.7</b> 多样性差异检验</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#群落多样性比较"><i class="fa fa-check"></i><b>7.7.1</b> 群落多样性比较</a></li>
<li class="chapter" data-level="7.7.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#相似性分析anosim"><i class="fa fa-check"></i><b>7.7.2</b> 相似性分析（ANOSIM）</a></li>
<li class="chapter" data-level="7.7.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与生态学应用建议"><i class="fa fa-check"></i><b>7.7.3</b> 方法学比较与生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#物种空间分布检验"><i class="fa fa-check"></i><b>7.8</b> 物种空间分布检验</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#空间分布模式检验"><i class="fa fa-check"></i><b>7.8.1</b> 空间分布模式检验</a></li>
<li class="chapter" data-level="7.8.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#点过程模型检验"><i class="fa fa-check"></i><b>7.8.2</b> 点过程模型检验</a></li>
<li class="chapter" data-level="7.8.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#空间生态学的统计挑战与解决方案"><i class="fa fa-check"></i><b>7.8.3</b> 空间生态学的统计挑战与解决方案</a></li>
<li class="chapter" data-level="7.8.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学应用与保护意义"><i class="fa fa-check"></i><b>7.8.4</b> 生态学应用与保护意义</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育信号检验"><i class="fa fa-check"></i><b>7.9</b> 系统发育信号检验</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育保守性检验"><i class="fa fa-check"></i><b>7.9.1</b> 系统发育保守性检验</a></li>
<li class="chapter" data-level="7.9.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育独立对比"><i class="fa fa-check"></i><b>7.9.2</b> 系统发育独立对比</a></li>
<li class="chapter" data-level="7.9.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与生态学应用建议-1"><i class="fa fa-check"></i><b>7.9.3</b> 方法学比较与生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学零模型检验"><i class="fa fa-check"></i><b>7.10</b> 生态学零模型检验</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#零模型的基本概念与生态学意义"><i class="fa fa-check"></i><b>7.10.1</b> 零模型的基本概念与生态学意义</a></li>
<li class="chapter" data-level="7.10.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#群落组装零模型检验"><i class="fa fa-check"></i><b>7.10.2</b> 群落组装零模型检验</a></li>
<li class="chapter" data-level="7.10.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态网络零模型检验"><i class="fa fa-check"></i><b>7.10.3</b> 生态网络零模型检验</a></li>
<li class="chapter" data-level="7.10.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#零模型检验的方法学比较与选择"><i class="fa fa-check"></i><b>7.10.4</b> 零模型检验的方法学比较与选择</a></li>
<li class="chapter" data-level="7.10.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学应用与保护意义-1"><i class="fa fa-check"></i><b>7.10.5</b> 生态学应用与保护意义</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#总结-7"><i class="fa fa-check"></i><b>7.11</b> 总结</a></li>
<li class="chapter" data-level="7.12" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#综合练习-5"><i class="fa fa-check"></i><b>7.12</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html"><i class="fa fa-check"></i><b>8</b> 简单线性回归模型</a>
<ul>
<li class="chapter" data-level="8.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#引言-7"><i class="fa fa-check"></i><b>8.1</b> 引言</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#为什么生态学本科生需要学习统计建模与预测"><i class="fa fa-check"></i><b>8.1.1</b> 为什么生态学本科生需要学习统计建模与预测？</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#线性回归模型生态关系的数学表达"><i class="fa fa-check"></i><b>8.2</b> 线性回归模型：生态关系的数学表达</a></li>
<li class="chapter" data-level="8.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#最小二乘估计"><i class="fa fa-check"></i><b>8.3</b> 最小二乘估计</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的lm函数详解"><i class="fa fa-check"></i><b>8.3.1</b> R语言中的lm()函数详解</a></li>
<li class="chapter" data-level="8.3.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#lm函数的基本语法"><i class="fa fa-check"></i><b>8.3.2</b> lm()函数的基本语法</a></li>
<li class="chapter" data-level="8.3.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型公式的详细说明"><i class="fa fa-check"></i><b>8.3.3</b> 模型公式的详细说明</a></li>
<li class="chapter" data-level="8.3.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#lm函数的返回对象"><i class="fa fa-check"></i><b>8.3.4</b> lm()函数的返回对象</a></li>
<li class="chapter" data-level="8.3.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#提取回归结果的常用函数"><i class="fa fa-check"></i><b>8.3.5</b> 提取回归结果的常用函数</a></li>
<li class="chapter" data-level="8.3.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#理解summary函数的输出"><i class="fa fa-check"></i><b>8.3.6</b> 理解summary()函数的输出</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#回归诊断验证模型的生态学合理性"><i class="fa fa-check"></i><b>8.4</b> 回归诊断：验证模型的生态学合理性</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#回归诊断图的系统解读"><i class="fa fa-check"></i><b>8.4.1</b> 回归诊断图的系统解读</a></li>
<li class="chapter" data-level="8.4.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型质量的综合评估"><i class="fa fa-check"></i><b>8.4.2</b> 模型质量的综合评估</a></li>
<li class="chapter" data-level="8.4.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学诊断问题的应对策略"><i class="fa fa-check"></i><b>8.4.3</b> 生态学诊断问题的应对策略</a></li>
<li class="chapter" data-level="8.4.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用实例-1"><i class="fa fa-check"></i><b>8.4.4</b> 生态学应用实例</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归多因子生态关系的综合分析"><i class="fa fa-check"></i><b>8.5</b> 多元线性回归：多因子生态关系的综合分析</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归的模型公式"><i class="fa fa-check"></i><b>8.5.1</b> 多元线性回归的模型公式</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归中的变量选择"><i class="fa fa-check"></i><b>8.6</b> 多元线性回归中的变量选择</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择的重要性"><i class="fa fa-check"></i><b>8.6.1</b> 变量选择的重要性</a></li>
<li class="chapter" data-level="8.6.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择的基本原则"><i class="fa fa-check"></i><b>8.6.2</b> 变量选择的基本原则</a></li>
<li class="chapter" data-level="8.6.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#常用的变量选择方法"><i class="fa fa-check"></i><b>8.6.3</b> 常用的变量选择方法</a></li>
<li class="chapter" data-level="8.6.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的模型选择实现"><i class="fa fa-check"></i><b>8.6.4</b> R语言中的模型选择实现</a></li>
<li class="chapter" data-level="8.6.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学变量选择的实践建议"><i class="fa fa-check"></i><b>8.6.5</b> 生态学变量选择的实践建议</a></li>
<li class="chapter" data-level="8.6.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型选择的注意事项"><i class="fa fa-check"></i><b>8.6.6</b> 模型选择的注意事项</a></li>
<li class="chapter" data-level="8.6.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#完整生态学案例分析鸟类丰富度与环境因子的关系"><i class="fa fa-check"></i><b>8.6.7</b> 完整生态学案例分析：鸟类丰富度与环境因子的关系</a></li>
<li class="chapter" data-level="8.6.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#完整模型拟合"><i class="fa fa-check"></i><b>8.6.8</b> 完整模型拟合</a></li>
<li class="chapter" data-level="8.6.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择过程"><i class="fa fa-check"></i><b>8.6.9</b> 变量选择过程</a></li>
<li class="chapter" data-level="8.6.10" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#最优模型选择与结果解释"><i class="fa fa-check"></i><b>8.6.10</b> 最优模型选择与结果解释</a></li>
<li class="chapter" data-level="8.6.11" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型诊断与假设检验"><i class="fa fa-check"></i><b>8.6.11</b> 模型诊断与假设检验</a></li>
<li class="chapter" data-level="8.6.12" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型预测与应用"><i class="fa fa-check"></i><b>8.6.12</b> 模型预测与应用</a></li>
<li class="chapter" data-level="8.6.13" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型比较与评估"><i class="fa fa-check"></i><b>8.6.13</b> 模型比较与评估</a></li>
<li class="chapter" data-level="8.6.14" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学解释与模型选择价值"><i class="fa fa-check"></i><b>8.6.14</b> 生态学解释与模型选择价值</a></li>
<li class="chapter" data-level="8.6.15" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#案例分析总结"><i class="fa fa-check"></i><b>8.6.15</b> 案例分析总结</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归非线性生态关系的数学描述"><i class="fa fa-check"></i><b>8.7</b> 多项式回归：非线性生态关系的数学描述</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归模型"><i class="fa fa-check"></i><b>8.7.1</b> 多项式回归模型</a></li>
<li class="chapter" data-level="8.7.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的多项式回归实现"><i class="fa fa-check"></i><b>8.7.2</b> R语言中的多项式回归实现</a></li>
<li class="chapter" data-level="8.7.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用实例-2"><i class="fa fa-check"></i><b>8.7.3</b> 生态学应用实例</a></li>
<li class="chapter" data-level="8.7.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归的生态学意义"><i class="fa fa-check"></i><b>8.7.4</b> 多项式回归的生态学意义</a></li>
<li class="chapter" data-level="8.7.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式阶数的选择"><i class="fa fa-check"></i><b>8.7.5</b> 多项式阶数的选择</a></li>
<li class="chapter" data-level="8.7.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归的注意事项"><i class="fa fa-check"></i><b>8.7.6</b> 多项式回归的注意事项</a></li>
<li class="chapter" data-level="8.7.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#过度拟合问题演示"><i class="fa fa-check"></i><b>8.7.7</b> 过度拟合问题演示</a></li>
<li class="chapter" data-level="8.7.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型可视化与比较"><i class="fa fa-check"></i><b>8.7.8</b> 模型可视化与比较</a></li>
<li class="chapter" data-level="8.7.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#统计指标与交叉验证"><i class="fa fa-check"></i><b>8.7.9</b> 统计指标与交叉验证</a></li>
<li class="chapter" data-level="8.7.10" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用建议"><i class="fa fa-check"></i><b>8.7.10</b> 生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#总结从线性到非线性从简单到复杂"><i class="fa fa-check"></i><b>8.8</b> 总结：从线性到非线性，从简单到复杂</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#核心概念回顾"><i class="fa fa-check"></i><b>8.8.1</b> 核心概念回顾</a></li>
<li class="chapter" data-level="8.8.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学建模思维"><i class="fa fa-check"></i><b>8.8.2</b> 生态学建模思维</a></li>
<li class="chapter" data-level="8.8.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#实践应用价值"><i class="fa fa-check"></i><b>8.8.3</b> 实践应用价值</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#综合练习-6"><i class="fa fa-check"></i><b>8.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="模型选择与评估.html"><a href="模型选择与评估.html"><i class="fa fa-check"></i><b>9</b> 模型选择与评估</a>
<ul>
<li class="chapter" data-level="9.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#引言-8"><i class="fa fa-check"></i><b>9.1</b> 引言</a></li>
<li class="chapter" data-level="9.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型选择"><i class="fa fa-check"></i><b>9.2</b> 模型选择</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型选择原则"><i class="fa fa-check"></i><b>9.2.1</b> 模型选择原则</a></li>
<li class="chapter" data-level="9.2.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#信息准则"><i class="fa fa-check"></i><b>9.2.2</b> 信息准则</a></li>
<li class="chapter" data-level="9.2.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#似然比检验"><i class="fa fa-check"></i><b>9.2.3</b> 似然比检验</a></li>
<li class="chapter" data-level="9.2.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型平均"><i class="fa fa-check"></i><b>9.2.4</b> 模型平均</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型评估"><i class="fa fa-check"></i><b>9.3</b> 模型评估</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#交叉验证"><i class="fa fa-check"></i><b>9.3.1</b> 交叉验证</a></li>
<li class="chapter" data-level="9.3.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#外部验证"><i class="fa fa-check"></i><b>9.3.2</b> 外部验证</a></li>
<li class="chapter" data-level="9.3.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型诊断"><i class="fa fa-check"></i><b>9.3.3</b> 模型诊断</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型选择与评估"><i class="fa fa-check"></i><b>9.4</b> 贝叶斯模型选择与评估</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯与频率学派的根本差异"><i class="fa fa-check"></i><b>9.4.1</b> 贝叶斯与频率学派的根本差异</a></li>
<li class="chapter" data-level="9.4.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型选择基本原理"><i class="fa fa-check"></i><b>9.4.2</b> 贝叶斯模型选择基本原理</a></li>
<li class="chapter" data-level="9.4.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯假设检验流程"><i class="fa fa-check"></i><b>9.4.3</b> 贝叶斯假设检验流程</a></li>
<li class="chapter" data-level="9.4.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型比较与选择"><i class="fa fa-check"></i><b>9.4.4</b> 贝叶斯模型比较与选择</a></li>
<li class="chapter" data-level="9.4.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯可信区间"><i class="fa fa-check"></i><b>9.4.5</b> 贝叶斯可信区间</a></li>
<li class="chapter" data-level="9.4.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯因子计算与解释"><i class="fa fa-check"></i><b>9.4.6</b> 贝叶斯因子计算与解释</a></li>
<li class="chapter" data-level="9.4.7" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型平均"><i class="fa fa-check"></i><b>9.4.7</b> 贝叶斯模型平均</a></li>
<li class="chapter" data-level="9.4.8" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯预测评估"><i class="fa fa-check"></i><b>9.4.8</b> 贝叶斯预测评估</a></li>
<li class="chapter" data-level="9.4.9" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯变量选择"><i class="fa fa-check"></i><b>9.4.9</b> 贝叶斯变量选择</a></li>
<li class="chapter" data-level="9.4.10" data-path="模型选择与评估.html"><a href="模型选择与评估.html#生态学应用价值"><i class="fa fa-check"></i><b>9.4.10</b> 生态学应用价值</a></li>
<li class="chapter" data-level="9.4.11" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯检验的生态学应用案例"><i class="fa fa-check"></i><b>9.4.11</b> 贝叶斯检验的生态学应用案例</a></li>
<li class="chapter" data-level="9.4.12" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯方法的局限性"><i class="fa fa-check"></i><b>9.4.12</b> 贝叶斯方法的局限性</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#总结-8"><i class="fa fa-check"></i><b>9.5</b> 总结</a></li>
<li class="chapter" data-level="9.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#综合练习-7"><i class="fa fa-check"></i><b>9.6</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="高级回归模型.html"><a href="高级回归模型.html"><i class="fa fa-check"></i><b>10</b> 高级回归模型</a>
<ul>
<li class="chapter" data-level="10.1" data-path="高级回归模型.html"><a href="高级回归模型.html#引言-9"><i class="fa fa-check"></i><b>10.1</b> 引言</a></li>
<li class="chapter" data-level="10.2" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型"><i class="fa fa-check"></i><b>10.2</b> 可加性模型</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型的基本原理"><i class="fa fa-check"></i><b>10.2.1</b> 可加性模型的基本原理</a></li>
<li class="chapter" data-level="10.2.2" data-path="高级回归模型.html"><a href="高级回归模型.html#与线性模型的比较"><i class="fa fa-check"></i><b>10.2.2</b> 与线性模型的比较</a></li>
<li class="chapter" data-level="10.2.3" data-path="高级回归模型.html"><a href="高级回归模型.html#常见的平滑函数"><i class="fa fa-check"></i><b>10.2.3</b> 常见的平滑函数</a></li>
<li class="chapter" data-level="10.2.4" data-path="高级回归模型.html"><a href="高级回归模型.html#平滑函数选择的生态学考量"><i class="fa fa-check"></i><b>10.2.4</b> 平滑函数选择的生态学考量</a></li>
<li class="chapter" data-level="10.2.5" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型中的系数概念"><i class="fa fa-check"></i><b>10.2.5</b> 可加性模型中的”系数”概念</a></li>
<li class="chapter" data-level="10.2.6" data-path="高级回归模型.html"><a href="高级回归模型.html#在r中的实现"><i class="fa fa-check"></i><b>10.2.6</b> 在R中的实现</a></li>
<li class="chapter" data-level="10.2.7" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学应用示例"><i class="fa fa-check"></i><b>10.2.7</b> 生态学应用示例</a></li>
<li class="chapter" data-level="10.2.8" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型诊断"><i class="fa fa-check"></i><b>10.2.8</b> 可加性模型诊断</a></li>
<li class="chapter" data-level="10.2.9" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型的优势与局限"><i class="fa fa-check"></i><b>10.2.9</b> 可加性模型的优势与局限</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="高级回归模型.html"><a href="高级回归模型.html#广义线性回归"><i class="fa fa-check"></i><b>10.3</b> 广义线性回归</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="高级回归模型.html"><a href="高级回归模型.html#广义线性模型的基本框架"><i class="fa fa-check"></i><b>10.3.1</b> 广义线性模型的基本框架</a></li>
<li class="chapter" data-level="10.3.2" data-path="高级回归模型.html"><a href="高级回归模型.html#与普通线性回归的根本区别"><i class="fa fa-check"></i><b>10.3.2</b> 与普通线性回归的根本区别</a></li>
<li class="chapter" data-level="10.3.3" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的glm实现"><i class="fa fa-check"></i><b>10.3.3</b> R语言中的GLM实现</a></li>
<li class="chapter" data-level="10.3.4" data-path="高级回归模型.html"><a href="高级回归模型.html#常见glm类型及其生态学应用"><i class="fa fa-check"></i><b>10.3.4</b> 常见GLM类型及其生态学应用</a></li>
<li class="chapter" data-level="10.3.5" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与解释"><i class="fa fa-check"></i><b>10.3.5</b> 模型诊断与解释</a></li>
<li class="chapter" data-level="10.3.6" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学意义与注意事项"><i class="fa fa-check"></i><b>10.3.6</b> 生态学意义与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="高级回归模型.html"><a href="高级回归模型.html#广义可加模型"><i class="fa fa-check"></i><b>10.4</b> 广义可加模型</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="高级回归模型.html"><a href="高级回归模型.html#gam的基本原理"><i class="fa fa-check"></i><b>10.4.1</b> GAM的基本原理</a></li>
<li class="chapter" data-level="10.4.2" data-path="高级回归模型.html"><a href="高级回归模型.html#在r中的实现-1"><i class="fa fa-check"></i><b>10.4.2</b> 在R中的实现</a></li>
<li class="chapter" data-level="10.4.3" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学应用示例-1"><i class="fa fa-check"></i><b>10.4.3</b> 生态学应用示例</a></li>
<li class="chapter" data-level="10.4.4" data-path="高级回归模型.html"><a href="高级回归模型.html#gam在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.4.4</b> GAM在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.4.5" data-path="高级回归模型.html"><a href="高级回归模型.html#高级功能"><i class="fa fa-check"></i><b>10.4.5</b> 高级功能</a></li>
<li class="chapter" data-level="10.4.6" data-path="高级回归模型.html"><a href="高级回归模型.html#模型选择与诊断"><i class="fa fa-check"></i><b>10.4.6</b> 模型选择与诊断</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型"><i class="fa fa-check"></i><b>10.5</b> 混合效应模型</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="高级回归模型.html"><a href="高级回归模型.html#固定效应与随机效应的生态学概念"><i class="fa fa-check"></i><b>10.5.1</b> 固定效应与随机效应的生态学概念</a></li>
<li class="chapter" data-level="10.5.2" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型的数学框架"><i class="fa fa-check"></i><b>10.5.2</b> 混合效应模型的数学框架</a></li>
<li class="chapter" data-level="10.5.3" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的混合效应模型实现"><i class="fa fa-check"></i><b>10.5.3</b> R语言中的混合效应模型实现</a></li>
<li class="chapter" data-level="10.5.4" data-path="高级回归模型.html"><a href="高级回归模型.html#固定效应和随机效应的筛选"><i class="fa fa-check"></i><b>10.5.4</b> 固定效应和随机效应的筛选</a></li>
<li class="chapter" data-level="10.5.5" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.5.5</b> 混合效应模型在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.5.6" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项"><i class="fa fa-check"></i><b>10.5.6</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型"><i class="fa fa-check"></i><b>10.6</b> 时空自相关模型</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型与混合效应模型的联系与区别"><i class="fa fa-check"></i><b>10.6.1</b> 时空自相关模型与混合效应模型的联系与区别</a></li>
<li class="chapter" data-level="10.6.2" data-path="高级回归模型.html"><a href="高级回归模型.html#空间自相关与时间自相关的生态学概念"><i class="fa fa-check"></i><b>10.6.2</b> 空间自相关与时间自相关的生态学概念</a></li>
<li class="chapter" data-level="10.6.3" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型的数学框架"><i class="fa fa-check"></i><b>10.6.3</b> 时空自相关模型的数学框架</a></li>
<li class="chapter" data-level="10.6.4" data-path="高级回归模型.html"><a href="高级回归模型.html#时空模型框架的联系与区别"><i class="fa fa-check"></i><b>10.6.4</b> 时空模型框架的联系与区别</a></li>
<li class="chapter" data-level="10.6.5" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的时空自相关模型实现"><i class="fa fa-check"></i><b>10.6.5</b> R语言中的时空自相关模型实现</a></li>
<li class="chapter" data-level="10.6.6" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型的生态学应用"><i class="fa fa-check"></i><b>10.6.6</b> 时空自相关模型的生态学应用</a></li>
<li class="chapter" data-level="10.6.7" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项-1"><i class="fa fa-check"></i><b>10.6.7</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型"><i class="fa fa-check"></i><b>10.7</b> 结构方程模型</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型的基本框架"><i class="fa fa-check"></i><b>10.7.1</b> 结构方程模型的基本框架</a></li>
<li class="chapter" data-level="10.7.2" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的结构方程模型实现"><i class="fa fa-check"></i><b>10.7.2</b> R语言中的结构方程模型实现</a></li>
<li class="chapter" data-level="10.7.3" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.7.3</b> 结构方程模型在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.7.4" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项-2"><i class="fa fa-check"></i><b>10.7.4</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="高级回归模型.html"><a href="高级回归模型.html#总结-9"><i class="fa fa-check"></i><b>10.8</b> 总结</a></li>
<li class="chapter" data-level="10.9" data-path="高级回归模型.html"><a href="高级回归模型.html#综合练习-8"><i class="fa fa-check"></i><b>10.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="机器学习.html"><a href="机器学习.html"><i class="fa fa-check"></i><b>11</b> 机器学习</a>
<ul>
<li class="chapter" data-level="11.1" data-path="机器学习.html"><a href="机器学习.html#引言-10"><i class="fa fa-check"></i><b>11.1</b> 引言</a></li>
<li class="chapter" data-level="11.2" data-path="机器学习.html"><a href="机器学习.html#决策树"><i class="fa fa-check"></i><b>11.2</b> 决策树</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与原理"><i class="fa fa-check"></i><b>11.2.1</b> 基本概念与原理</a></li>
<li class="chapter" data-level="11.2.2" data-path="机器学习.html"><a href="机器学习.html#决策树构建原理"><i class="fa fa-check"></i><b>11.2.2</b> 决策树构建原理</a></li>
<li class="chapter" data-level="11.2.3" data-path="机器学习.html"><a href="机器学习.html#分类树classification-trees"><i class="fa fa-check"></i><b>11.2.3</b> 分类树（Classification Trees）</a></li>
<li class="chapter" data-level="11.2.4" data-path="机器学习.html"><a href="机器学习.html#回归树regression-trees"><i class="fa fa-check"></i><b>11.2.4</b> 回归树（Regression Trees）</a></li>
<li class="chapter" data-level="11.2.5" data-path="机器学习.html"><a href="机器学习.html#分类树与回归树的比较"><i class="fa fa-check"></i><b>11.2.5</b> 分类树与回归树的比较</a></li>
<li class="chapter" data-level="11.2.6" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-3"><i class="fa fa-check"></i><b>11.2.6</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.2.7" data-path="机器学习.html"><a href="机器学习.html#优势与局限"><i class="fa fa-check"></i><b>11.2.7</b> 优势与局限</a></li>
<li class="chapter" data-level="11.2.8" data-path="机器学习.html"><a href="机器学习.html#r代码实现示例"><i class="fa fa-check"></i><b>11.2.8</b> R代码实现示例</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="机器学习.html"><a href="机器学习.html#随机森林"><i class="fa fa-check"></i><b>11.3</b> 随机森林</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="机器学习.html"><a href="机器学习.html#决策树与随机森林的关系"><i class="fa fa-check"></i><b>11.3.1</b> 决策树与随机森林的关系</a></li>
<li class="chapter" data-level="11.3.2" data-path="机器学习.html"><a href="机器学习.html#随机森林的三个随机"><i class="fa fa-check"></i><b>11.3.2</b> 随机森林的三个随机</a></li>
<li class="chapter" data-level="11.3.3" data-path="机器学习.html"><a href="机器学习.html#数学定义与原理"><i class="fa fa-check"></i><b>11.3.3</b> 数学定义与原理</a></li>
<li class="chapter" data-level="11.3.4" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理"><i class="fa fa-check"></i><b>11.3.4</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.3.5" data-path="机器学习.html"><a href="机器学习.html#r代码实现"><i class="fa fa-check"></i><b>11.3.5</b> R代码实现</a></li>
<li class="chapter" data-level="11.3.6" data-path="机器学习.html"><a href="机器学习.html#代码详细说明"><i class="fa fa-check"></i><b>11.3.6</b> 代码详细说明</a></li>
<li class="chapter" data-level="11.3.7" data-path="机器学习.html"><a href="机器学习.html#模型评估与验证"><i class="fa fa-check"></i><b>11.3.7</b> 模型评估与验证</a></li>
<li class="chapter" data-level="11.3.8" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-4"><i class="fa fa-check"></i><b>11.3.8</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.3.9" data-path="机器学习.html"><a href="机器学习.html#生态学应用价值-1"><i class="fa fa-check"></i><b>11.3.9</b> 生态学应用价值</a></li>
<li class="chapter" data-level="11.3.10" data-path="机器学习.html"><a href="机器学习.html#优势与局限的深入分析"><i class="fa fa-check"></i><b>11.3.10</b> 优势与局限的深入分析</a></li>
<li class="chapter" data-level="11.3.11" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望"><i class="fa fa-check"></i><b>11.3.11</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="机器学习.html"><a href="机器学习.html#支持向量机"><i class="fa fa-check"></i><b>11.4</b> 支持向量机</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与几何直觉"><i class="fa fa-check"></i><b>11.4.1</b> 基本概念与几何直觉</a></li>
<li class="chapter" data-level="11.4.2" data-path="机器学习.html"><a href="机器学习.html#数学原理与核心概念"><i class="fa fa-check"></i><b>11.4.2</b> 数学原理与核心概念</a></li>
<li class="chapter" data-level="11.4.3" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理-1"><i class="fa fa-check"></i><b>11.4.3</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.4.4" data-path="机器学习.html"><a href="机器学习.html#r代码实现-1"><i class="fa fa-check"></i><b>11.4.4</b> R代码实现</a></li>
<li class="chapter" data-level="11.4.5" data-path="机器学习.html"><a href="机器学习.html#代码详细说明-1"><i class="fa fa-check"></i><b>11.4.5</b> 代码详细说明</a></li>
<li class="chapter" data-level="11.4.6" data-path="机器学习.html"><a href="机器学习.html#模型评估与验证-1"><i class="fa fa-check"></i><b>11.4.6</b> 模型评估与验证</a></li>
<li class="chapter" data-level="11.4.7" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-5"><i class="fa fa-check"></i><b>11.4.7</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.4.8" data-path="机器学习.html"><a href="机器学习.html#优势与局限-1"><i class="fa fa-check"></i><b>11.4.8</b> 优势与局限</a></li>
<li class="chapter" data-level="11.4.9" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望-1"><i class="fa fa-check"></i><b>11.4.9</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="机器学习.html"><a href="机器学习.html#深度神经网络"><i class="fa fa-check"></i><b>11.5</b> 深度神经网络</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与生物学启发"><i class="fa fa-check"></i><b>11.5.1</b> 基本概念与生物学启发</a></li>
<li class="chapter" data-level="11.5.2" data-path="机器学习.html"><a href="机器学习.html#主要神经网络架构"><i class="fa fa-check"></i><b>11.5.2</b> 主要神经网络架构</a></li>
<li class="chapter" data-level="11.5.3" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理-2"><i class="fa fa-check"></i><b>11.5.3</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.5.4" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-6"><i class="fa fa-check"></i><b>11.5.4</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.5.5" data-path="机器学习.html"><a href="机器学习.html#优势与局限-2"><i class="fa fa-check"></i><b>11.5.5</b> 优势与局限</a></li>
<li class="chapter" data-level="11.5.6" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望-2"><i class="fa fa-check"></i><b>11.5.6</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="机器学习.html"><a href="机器学习.html#总结-10"><i class="fa fa-check"></i><b>11.6</b> 总结</a></li>
<li class="chapter" data-level="11.7" data-path="机器学习.html"><a href="机器学习.html#综合练习-9"><i class="fa fa-check"></i><b>11.7</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html"><i class="fa fa-check"></i><b>12</b> 附录1 R语言编程基础</a>
<ul>
<li class="chapter" data-level="12.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言介绍"><i class="fa fa-check"></i><b>12.1</b> R语言介绍</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#为什么生态学专业需要学习r"><i class="fa fa-check"></i><b>12.1.1</b> 为什么生态学专业需要学习R？</a></li>
<li class="chapter" data-level="12.1.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言简介与趣味应用"><i class="fa fa-check"></i><b>12.1.2</b> R语言简介与趣味应用</a></li>
<li class="chapter" data-level="12.1.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#环境设置和配置"><i class="fa fa-check"></i><b>12.1.3</b> 环境设置和配置</a></li>
<li class="chapter" data-level="12.1.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#项目文件夹结构设置"><i class="fa fa-check"></i><b>12.1.4</b> 项目文件夹结构设置</a></li>
<li class="chapter" data-level="12.1.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#基本包管理"><i class="fa fa-check"></i><b>12.1.5</b> 基本包管理</a></li>
<li class="chapter" data-level="12.1.6" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#工作目录设置"><i class="fa fa-check"></i><b>12.1.6</b> 工作目录设置</a></li>
<li class="chapter" data-level="12.1.7" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课前准备检查清单"><i class="fa fa-check"></i><b>12.1.7</b> 课前准备检查清单</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#数值向量创建与基本统计计算"><i class="fa fa-check"></i><b>12.2</b> 数值向量创建与基本统计计算</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景"><i class="fa fa-check"></i><b>12.2.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.2.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据"><i class="fa fa-check"></i><b>12.2.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.2.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程"><i class="fa fa-check"></i><b>12.2.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.2.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解"><i class="fa fa-check"></i><b>12.2.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.2.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习"><i class="fa fa-check"></i><b>12.2.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#字符型数据处理与向量索引操作"><i class="fa fa-check"></i><b>12.3</b> 字符型数据处理与向量索引操作</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-1"><i class="fa fa-check"></i><b>12.3.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.3.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-1"><i class="fa fa-check"></i><b>12.3.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.3.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-1"><i class="fa fa-check"></i><b>12.3.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.3.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-1"><i class="fa fa-check"></i><b>12.3.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.3.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-1"><i class="fa fa-check"></i><b>12.3.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#数据框结构理解与多类型数据管理"><i class="fa fa-check"></i><b>12.4</b> 数据框结构理解与多类型数据管理</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-2"><i class="fa fa-check"></i><b>12.4.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.4.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-2"><i class="fa fa-check"></i><b>12.4.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.4.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-2"><i class="fa fa-check"></i><b>12.4.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.4.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-2"><i class="fa fa-check"></i><b>12.4.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.4.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-2"><i class="fa fa-check"></i><b>12.4.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#列表数据结构与数据分组管理"><i class="fa fa-check"></i><b>12.5</b> 列表数据结构与数据分组管理</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-3"><i class="fa fa-check"></i><b>12.5.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.5.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-3"><i class="fa fa-check"></i><b>12.5.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.5.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-3"><i class="fa fa-check"></i><b>12.5.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.5.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-3"><i class="fa fa-check"></i><b>12.5.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.5.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-3"><i class="fa fa-check"></i><b>12.5.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#外部数据导入与条件筛选分析"><i class="fa fa-check"></i><b>12.6</b> 外部数据导入与条件筛选分析</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-4"><i class="fa fa-check"></i><b>12.6.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.6.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据文件bird_monitoring.csv"><i class="fa fa-check"></i><b>12.6.2</b> 演示数据文件（bird_monitoring.csv）</a></li>
<li class="chapter" data-level="12.6.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-4"><i class="fa fa-check"></i><b>12.6.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.6.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-4"><i class="fa fa-check"></i><b>12.6.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.6.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-4"><i class="fa fa-check"></i><b>12.6.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#缺失值和异常值的识别处理"><i class="fa fa-check"></i><b>12.7</b> 缺失值和异常值的识别处理</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-5"><i class="fa fa-check"></i><b>12.7.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.7.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-4"><i class="fa fa-check"></i><b>12.7.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.7.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-5"><i class="fa fa-check"></i><b>12.7.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.7.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-5"><i class="fa fa-check"></i><b>12.7.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.7.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-5"><i class="fa fa-check"></i><b>12.7.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#描述性统计分析与基础数据可视化"><i class="fa fa-check"></i><b>12.8</b> 描述性统计分析与基础数据可视化</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-6"><i class="fa fa-check"></i><b>12.8.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.8.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-5"><i class="fa fa-check"></i><b>12.8.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.8.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-6"><i class="fa fa-check"></i><b>12.8.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.8.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-6"><i class="fa fa-check"></i><b>12.8.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.8.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-6"><i class="fa fa-check"></i><b>12.8.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#条件判断循环结构与函数编程"><i class="fa fa-check"></i><b>12.9</b> 条件判断、循环结构与函数编程</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-7"><i class="fa fa-check"></i><b>12.9.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.9.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-6"><i class="fa fa-check"></i><b>12.9.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.9.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-7"><i class="fa fa-check"></i><b>12.9.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.9.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-7"><i class="fa fa-check"></i><b>12.9.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.9.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-7"><i class="fa fa-check"></i><b>12.9.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#现代数据科学工具包应用"><i class="fa fa-check"></i><b>12.10</b> 现代数据科学工具包应用</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-8"><i class="fa fa-check"></i><b>12.10.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.10.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-7"><i class="fa fa-check"></i><b>12.10.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.10.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-8"><i class="fa fa-check"></i><b>12.10.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.10.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-8"><i class="fa fa-check"></i><b>12.10.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.10.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-8"><i class="fa fa-check"></i><b>12.10.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#图形语法与科学绘图"><i class="fa fa-check"></i><b>12.11</b> 图形语法与科学绘图</a>
<ul>
<li class="chapter" data-level="12.11.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-9"><i class="fa fa-check"></i><b>12.11.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.11.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-8"><i class="fa fa-check"></i><b>12.11.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.11.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-9"><i class="fa fa-check"></i><b>12.11.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.11.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-9"><i class="fa fa-check"></i><b>12.11.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.11.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-9"><i class="fa fa-check"></i><b>12.11.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.12" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#综合练习-10"><i class="fa fa-check"></i><b>12.12</b> 综合练习</a>
<ul>
<li class="chapter" data-level="12.12.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习1-1"><i class="fa fa-check"></i><b>12.12.1</b> 练习1</a></li>
<li class="chapter" data-level="12.12.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习2"><i class="fa fa-check"></i><b>12.12.2</b> 练习2</a></li>
<li class="chapter" data-level="12.12.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习3"><i class="fa fa-check"></i><b>12.12.3</b> 练习3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://gitee.com/gcshen/ecological-statistics" target="blank">Gitee</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">生态统计学</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="基于模拟的假设检验" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> 基于模拟的假设检验<a href="基于模拟的假设检验.html#基于模拟的假设检验" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="引言-6" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> 引言<a href="基于模拟的假设检验.html#引言-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在生态统计学的探索旅程中，我们已经掌握了基于经典统计分布的假设检验方法，这些方法如同生态学家手中的传统工具，在物种多样性比较、保护效果评估、环境因子分析等众多场景中发挥着重要作用。然而，当我们面对生态学研究中日益复杂的挑战时，传统方法有时显得力不从心。</p>
<p>本章将带领我们进入统计推断的新天地——基于模拟的假设检验方法。这些现代计算统计技术代表了统计思维的重要演进，它们不再拘泥于传统的理论分布框架，而是通过计算机模拟和概率推理来构建统计量的经验分布。我们将重点探讨蒙特卡洛检验、置换检验和自助法检验这三种核心方法，它们为生态学家提供了处理复杂生态问题的全新视角和强大工具。</p>
<p>在生态学研究实践中，我们常常遇到这样的困境：精心设计的统计量却找不到对应的理论分布。比如在研究珍稀鸟类巢位选择时，我们可能发现巢位到水源的距离呈现出某种聚集模式，但如何量化这种聚集程度？即使设计出”平均最近邻距离与随机期望的比值”这样的统计量，其理论分布也无从查考。</p>
<p>这时候，基于模拟的方法展现出其独特价值。我们可以将这种方法想象成生态学家的”数字实验室”——在计算机上模拟成千上万次随机过程，构建统计量的经验分布，然后将实际观测值与这个经验分布进行比较。如果观测值落在经验分布的极端位置，我们就有了拒绝随机假设的证据。</p>
<p>这种思维方式打破了传统统计推断的局限，让数据本身”诉说”其内在规律，而不是强行套入预设的理论框架。它特别适合处理生态学中常见的复杂统计量，为那些经典方法难以解决的问题提供了可行的解决方案。</p>
<p>基于模拟的方法在生态学研究中展现出广泛的应用前景，尤其擅长处理那些传统统计方法难以应对的复杂场景。当我们研究物种的空间分布时，需要量化聚集或分散的程度；分析食物网结构时，要评估网络的连接性和模块化特征；比较群落组成时，则要衡量物种组成的相似性差异。这些统计量往往缺乏现成的理论分布支持，但通过计算机模拟，我们可以为它们构建”经验分布”，实现可靠的统计推断。</p>
<p>为了更具体地理解这种方法的实际价值，让我们考虑一个热带雨林研究的实例。假设我们在1公顷的固定样地中标记了所有胸径大于10厘米的树木，并精确记录了它们的空间坐标。观察发现，某些树种呈现出明显的聚集分布特征，而另一些则相对分散。</p>
<p>为了客观量化这种分布模式，我们采用Ripley’s K函数作为统计指标。然而，这个函数的理论分布极其复杂，特别是在考虑边界效应和生境异质性的情况下。</p>
<p>此时，基于模拟的方法展现出其独特优势：我们可以在计算机上模拟成千上万次完全空间随机过程，每次都在相同的样地范围内随机分布相同数量的树木，然后计算每次模拟的Ripley’s K函数值。通过这种方式，我们构建了该统计量在零假设（树木分布完全随机）下的经验分布。</p>
<p>将实际观测的Ripley’s K函数值与这个经验分布进行比较，如果观测值落在分布的极端区域（如前5%或后5%），我们就可以得出树木分布模式显著偏离随机期望的结论。这种分析方法为理解物种空间分布的形成机制提供了有力的统计支持。</p>
<p>基于模拟的统计推断方法在生态学的多个分支领域都展现出强大的应用潜力。在种群遗传学研究中，这种方法帮助检验基因型频率是否偏离Hardy-Weinberg平衡；群落生态学家利用它比较不同处理下的物种组成差异；行为生态学家则借助它分析动物行为序列的非随机模式。面对这些多样化的研究问题，基于模拟的方法提供了灵活而可靠的统计解决方案。</p>
<p>从方法学角度看，基于模拟的假设检验主要分为两大类型：置换检验和蒙特卡洛方法。置换检验通过随机重排观测数据的标签来构建零分布，属于非参数检验范畴，不依赖于特定的分布假设。蒙特卡洛方法则是一个更广泛的概念，涵盖了所有基于随机模拟的统计推断技术。</p>
<p>在生态学实践中，蒙特卡洛方法主要包含两种形式：参数化蒙特卡洛检验基于理论模型生成模拟数据来构建零分布；非参数化蒙特卡洛方法则通过观测数据的重抽样来实现统计推断，其中最具代表性的就是<strong>自助法（bootstrap）</strong>。自助法检验通过有放回的重抽样来估计统计量的抽样分布，既可以构建置信区间，也能进行假设检验，从概念上可以视为蒙特卡洛方法的一种特殊形式。</p>
<p>这些方法在生态学研究中日益重要的原因在于它们能够有效处理生态数据的复杂性特征。生态数据通常具有空间自相关性、时间序列依赖性、异方差性等特点，这些特性往往使得传统参数检验的前提条件难以满足。相比之下，基于模拟的方法更加灵活，不依赖于严格的前提假设，让数据本身揭示其内在规律。</p>
<p>当然，我们也需要认识到基于模拟方法的局限性。它们对计算资源的要求较高，需要进行大量的重复模拟；结果的解释需要格外谨慎，因为模拟次数和具体方法都会影响最终结论。更重要的是，这些统计工具不能替代对生态学机制的深入理解，它们的主要作用是帮助我们评估观测模式是否显著偏离随机期望。</p>
<p>本章将系统介绍基于模拟的假设检验方法，帮助大家掌握蒙特卡洛检验的原理和应用，了解R语言中的具体实现方式；深入理解置换检验的技术细节，学会通过随机化构建零分布；探索自助法检验的强大功能，掌握通过重抽样估计统计量不确定性的技巧。</p>
<p>通过系统学习这些方法，大家将获得处理复杂生态学问题的统计工具包，能够应对传统统计方法难以解决的挑战。需要强调的是，统计方法本质上是工具，真正的科学洞察源于对生态学问题的深刻理解和严谨的推理过程。基于模拟的假设检验提供了更灵活、更强大的统计工具，但最终的科学结论必须建立在扎实的生态学理论基础和严谨的实验设计之上。</p>
<p>让我们共同开启这段探索统计推断新天地的旅程，在这里，数据不再是需要强行套入理论分布的被动对象，而是能够主动”诉说”内在规律的生动主体。</p>
</div>
<div id="方法学层次与演进脉络" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> 方法学层次与演进脉络<a href="基于模拟的假设检验.html#方法学层次与演进脉络" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>为了准确把握本章内容在生态统计学体系中的定位，我们需要简要回顾统计方法学的发展历程。</p>
<p><strong>经典统计方法</strong>（前一章内容）主要建立在参数理论基础上，依赖于已知的概率分布（如正态分布、t分布、F分布等）。这些方法包括参数检验（如t检验、方差分析）和传统非参数检验（如符号检验、秩和检验、卡方检验）。</p>
<p><strong>现代计算统计方法</strong>（本章内容）突破了传统理论分布的限制，主要介绍基于模拟的统计推断技术。</p>
<p><strong>基于模拟的方法</strong>通过计算机模拟构建统计量的经验分布，按照数据生成机制可以分为：</p>
<p><strong>置换检验</strong>：通过随机重排观测标签构建零分布，主要用于假设检验</p>
<p><strong>蒙特卡洛方法</strong>：广义的随机模拟方法，包括： - <strong>参数化蒙特卡洛检验</strong>：基于理论模型生成模拟数据 - <strong>非参数化蒙特卡洛方法</strong>：基于观测数据的重抽样 - <strong>自助法（bootstrap）</strong>：有放回重抽样，用于估计抽样分布和构建置信区间 - <strong>其他蒙特卡洛算法</strong>：如马尔可夫链蒙特卡洛（MCMC）、重要性抽样等</p>
<p><strong>方法学演进的意义</strong>： 从经典方法到现代方法的演进体现了统计推断从”理论驱动”向”数据驱动”的重要转变。经典方法依赖于严格的数学理论和分布假设，而现代方法更加灵活，能够处理复杂的、非标准的生态学问题。这种演进不是简单的替代关系，而是互补关系——经典方法为现代方法提供了理论基础，现代方法则扩展了经典方法的应用范围。</p>
<p>在生态学研究中，选择何种统计方法应该基于研究问题的性质、数据的特性以及可用的计算资源。优秀的生态学家应该掌握多种统计工具，能够根据具体情况选择最合适的方法。</p>
</div>
<div id="置换检验" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> 置换检验<a href="基于模拟的假设检验.html#置换检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>置换检验（Permutation Test），又称随机化检验（Randomization Test），是一种基于数据重排的非参数统计检验方法。其核心思想可以追溯到20世纪30年代，由R.A. Fisher和E.J.G. Pitman等人提出，但直到计算机技术普及后才在生态学研究中得到广泛应用。</p>
<div id="置换检验的基本原理" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> 置换检验的基本原理<a href="基于模拟的假设检验.html#置换检验的基本原理" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>置换检验的基本原理极其优雅：<strong>如果零假设为真，那么观测数据的标签（如处理组和对照组）就是可以任意交换的</strong>。换句话说，如果处理确实没有效应，那么将观测值随机分配到不同组别中，应该不会改变我们感兴趣的统计量（如组间均值差异）的分布特征。</p>
</div>
<div id="置换检验的技术实现过程" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> 置换检验的技术实现过程<a href="基于模拟的假设检验.html#置换检验的技术实现过程" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>置换检验的实施包含三个关键步骤：</p>
<p><strong>1. 计算观测统计量</strong> 首先，基于原始数据计算我们关心的检验统计量。在生态学中，这可能是： - 两个处理组间的物种丰富度差异 - 不同生境类型间的群落相似性指数 - 环境梯度上的物种分布模式统计量</p>
<p><strong>2. 构建零分布</strong> 通过随机重排观测数据的标签（如处理组标签），每次重排后重新计算检验统计量。重复这一过程数千次，构建统计量在零假设下的经验分布——即零分布。这一过程相当于在计算机上模拟”如果零假设为真，统计量可能呈现的随机变异”。</p>
<p><strong>3. 计算p值</strong> 将观测统计量与零分布进行比较，计算p值。p值定义为：在零假设下，获得与观测统计量同样极端或更极端结果的概率。具体而言，p值等于零分布中统计量绝对值大于或等于观测统计量绝对值的比例。</p>
</div>
<div id="r语言实现示例" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> R语言实现示例<a href="基于模拟的假设检验.html#r语言实现示例" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>以下通过几个典型的生态学场景展示置换检验在R中的实现：</p>
<p><strong>示例1：两组物种丰富度差异检验</strong></p>
<p>下面通过保护区内外物种丰富度比较的实例，展示置换检验的具体实现过程。这个例子模拟了保护区内和保护区外各20个样点的物种丰富度数据，通过置换检验来评估两组间的差异是否具有统计显著性。</p>
<p>首先进行数据准备和观测统计量计算：</p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="基于模拟的假设检验.html#cb759-1" tabindex="-1"></a><span class="co"># 数据准备：模拟保护区内外物种丰富度数据</span></span>
<span id="cb759-2"><a href="基于模拟的假设检验.html#cb759-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子确保结果可重复</span></span>
<span id="cb759-3"><a href="基于模拟的假设检验.html#cb759-3" tabindex="-1"></a></span>
<span id="cb759-4"><a href="基于模拟的假设检验.html#cb759-4" tabindex="-1"></a><span class="co"># 模拟保护区内物种丰富度，使用泊松分布生成数据</span></span>
<span id="cb759-5"><a href="基于模拟的假设检验.html#cb759-5" tabindex="-1"></a><span class="co"># 泊松分布适合模拟计数数据，lambda参数控制平均丰富度</span></span>
<span id="cb759-6"><a href="基于模拟的假设检验.html#cb759-6" tabindex="-1"></a>protected <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">20</span>, <span class="at">lambda =</span> <span class="dv">15</span>)  <span class="co"># 保护区内物种丰富度</span></span>
<span id="cb759-7"><a href="基于模拟的假设检验.html#cb759-7" tabindex="-1"></a></span>
<span id="cb759-8"><a href="基于模拟的假设检验.html#cb759-8" tabindex="-1"></a><span class="co"># 模拟保护区外物种丰富度，假设保护效果导致丰富度较低</span></span>
<span id="cb759-9"><a href="基于模拟的假设检验.html#cb759-9" tabindex="-1"></a>unprotected <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">20</span>, <span class="at">lambda =</span> <span class="dv">10</span>)  <span class="co"># 保护区外物种丰富度</span></span>
<span id="cb759-10"><a href="基于模拟的假设检验.html#cb759-10" tabindex="-1"></a></span>
<span id="cb759-11"><a href="基于模拟的假设检验.html#cb759-11" tabindex="-1"></a><span class="co"># 计算观测统计量：两组平均物种丰富度的差异</span></span>
<span id="cb759-12"><a href="基于模拟的假设检验.html#cb759-12" tabindex="-1"></a><span class="co"># 这是置换检验中需要评估的统计量</span></span>
<span id="cb759-13"><a href="基于模拟的假设检验.html#cb759-13" tabindex="-1"></a>obs_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(protected) <span class="sc">-</span> <span class="fu">mean</span>(unprotected)</span></code></pre></div>
<p>接下来进行置换检验的核心过程，通过随机重排构建零分布：</p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="基于模拟的假设检验.html#cb760-1" tabindex="-1"></a><span class="co"># 置换检验：通过随机重排构建零分布</span></span>
<span id="cb760-2"><a href="基于模拟的假设检验.html#cb760-2" tabindex="-1"></a>n_perm <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 置换次数，通常需要足够多次以确保结果稳定</span></span>
<span id="cb760-3"><a href="基于模拟的假设检验.html#cb760-3" tabindex="-1"></a>perm_diffs <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_perm)  <span class="co"># 存储每次置换得到的差异值</span></span>
<span id="cb760-4"><a href="基于模拟的假设检验.html#cb760-4" tabindex="-1"></a>combined <span class="ot">&lt;-</span> <span class="fu">c</span>(protected, unprotected)  <span class="co"># 合并两组数据用于随机重排</span></span>
<span id="cb760-5"><a href="基于模拟的假设检验.html#cb760-5" tabindex="-1"></a></span>
<span id="cb760-6"><a href="基于模拟的假设检验.html#cb760-6" tabindex="-1"></a><span class="co"># 置换检验循环：每次迭代进行一次随机重排</span></span>
<span id="cb760-7"><a href="基于模拟的假设检验.html#cb760-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_perm) {</span>
<span id="cb760-8"><a href="基于模拟的假设检验.html#cb760-8" tabindex="-1"></a>  <span class="co"># 随机重排合并后的数据，模拟零假设下的随机分配</span></span>
<span id="cb760-9"><a href="基于模拟的假设检验.html#cb760-9" tabindex="-1"></a>  perm_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined)</span>
<span id="cb760-10"><a href="基于模拟的假设检验.html#cb760-10" tabindex="-1"></a></span>
<span id="cb760-11"><a href="基于模拟的假设检验.html#cb760-11" tabindex="-1"></a>  <span class="co"># 计算重排后的组间差异</span></span>
<span id="cb760-12"><a href="基于模拟的假设检验.html#cb760-12" tabindex="-1"></a>  <span class="co"># 前20个值作为&quot;伪保护区内&quot;，后20个作为&quot;伪保护区外&quot;</span></span>
<span id="cb760-13"><a href="基于模拟的假设检验.html#cb760-13" tabindex="-1"></a>  perm_diffs[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(perm_sample[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]) <span class="sc">-</span> <span class="fu">mean</span>(perm_sample[<span class="dv">21</span><span class="sc">:</span><span class="dv">40</span>])</span>
<span id="cb760-14"><a href="基于模拟的假设检验.html#cb760-14" tabindex="-1"></a>}</span>
<span id="cb760-15"><a href="基于模拟的假设检验.html#cb760-15" tabindex="-1"></a></span>
<span id="cb760-16"><a href="基于模拟的假设检验.html#cb760-16" tabindex="-1"></a><span class="co"># 计算p值：评估观测差异在零分布中的极端程度</span></span>
<span id="cb760-17"><a href="基于模拟的假设检验.html#cb760-17" tabindex="-1"></a><span class="co"># p值定义为零分布中统计量绝对值大于等于观测统计量绝对值的比例</span></span>
<span id="cb760-18"><a href="基于模拟的假设检验.html#cb760-18" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(perm_diffs) <span class="sc">&gt;=</span> <span class="fu">abs</span>(obs_diff))</span>
<span id="cb760-19"><a href="基于模拟的假设检验.html#cb760-19" tabindex="-1"></a></span>
<span id="cb760-20"><a href="基于模拟的假设检验.html#cb760-20" tabindex="-1"></a><span class="co"># 输出检验结果</span></span>
<span id="cb760-21"><a href="基于模拟的假设检验.html#cb760-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;置换检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 置换检验结果：</code></pre>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="基于模拟的假设检验.html#cb762-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;观测差异:&quot;</span>, obs_diff, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 观测差异: 5.25</code></pre>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="基于模拟的假设检验.html#cb764-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## p值: 0</code></pre>
<p><strong>示例2：群落组成差异检验（置换ANOVA）</strong></p>
<p>群落组成差异检验是生态学研究中常见的问题，特别是在评估不同处理或生境对物种组成的影响时。下面使用vegan包中的adonis2函数进行置换多元方差分析（PERMANOVA），检验处理组和对照组在群落组成上的差异。</p>
<p>首先加载必要的包并准备群落数据：</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="基于模拟的假设检验.html#cb766-1" tabindex="-1"></a><span class="co"># 加载群落生态学分析包</span></span>
<span id="cb766-2"><a href="基于模拟的假设检验.html#cb766-2" tabindex="-1"></a><span class="fu">library</span>(vegan)  <span class="co"># 提供群落数据分析函数，包括置换检验</span></span>
<span id="cb766-3"><a href="基于模拟的假设检验.html#cb766-3" tabindex="-1"></a></span>
<span id="cb766-4"><a href="基于模拟的假设检验.html#cb766-4" tabindex="-1"></a><span class="co"># 模拟群落数据：20个样点，3个物种</span></span>
<span id="cb766-5"><a href="基于模拟的假设检验.html#cb766-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子确保结果可重复</span></span>
<span id="cb766-6"><a href="基于模拟的假设检验.html#cb766-6" tabindex="-1"></a></span>
<span id="cb766-7"><a href="基于模拟的假设检验.html#cb766-7" tabindex="-1"></a><span class="co"># 创建物种丰度矩阵，使用泊松分布模拟计数数据</span></span>
<span id="cb766-8"><a href="基于模拟的假设检验.html#cb766-8" tabindex="-1"></a><span class="co"># 矩阵维度：20行（样点）× 3列（物种）</span></span>
<span id="cb766-9"><a href="基于模拟的假设检验.html#cb766-9" tabindex="-1"></a>comm_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rpois</span>(<span class="dv">60</span>, <span class="at">lambda =</span> <span class="dv">5</span>), <span class="at">nrow =</span> <span class="dv">20</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb766-10"><a href="基于模拟的假设检验.html#cb766-10" tabindex="-1"></a></span>
<span id="cb766-11"><a href="基于模拟的假设检验.html#cb766-11" tabindex="-1"></a><span class="co"># 设置物种名称，便于结果解释</span></span>
<span id="cb766-12"><a href="基于模拟的假设检验.html#cb766-12" tabindex="-1"></a><span class="fu">colnames</span>(comm_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;物种A&quot;</span>, <span class="st">&quot;物种B&quot;</span>, <span class="st">&quot;物种C&quot;</span>)</span>
<span id="cb766-13"><a href="基于模拟的假设检验.html#cb766-13" tabindex="-1"></a></span>
<span id="cb766-14"><a href="基于模拟的假设检验.html#cb766-14" tabindex="-1"></a><span class="co"># 定义分组变量：10个处理组样点和10个对照组样点</span></span>
<span id="cb766-15"><a href="基于模拟的假设检验.html#cb766-15" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;处理组&quot;</span>, <span class="st">&quot;对照组&quot;</span>), <span class="at">each =</span> <span class="dv">10</span>)</span></code></pre></div>
<p>接下来进行置换ANOVA分析：</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="基于模拟的假设检验.html#cb767-1" tabindex="-1"></a><span class="co"># 置换ANOVA检验群落组成差异</span></span>
<span id="cb767-2"><a href="基于模拟的假设检验.html#cb767-2" tabindex="-1"></a><span class="co"># adonis2函数执行基于距离的置换多元方差分析（PERMANOVA）</span></span>
<span id="cb767-3"><a href="基于模拟的假设检验.html#cb767-3" tabindex="-1"></a><span class="co"># 该方法通过置换检验评估组间在群落组成上的差异显著性</span></span>
<span id="cb767-4"><a href="基于模拟的假设检验.html#cb767-4" tabindex="-1"></a>adonis_result <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(comm_data <span class="sc">~</span> groups, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb767-5"><a href="基于模拟的假设检验.html#cb767-5" tabindex="-1"></a></span>
<span id="cb767-6"><a href="基于模拟的假设检验.html#cb767-6" tabindex="-1"></a><span class="co"># 输出分析结果</span></span>
<span id="cb767-7"><a href="基于模拟的假设检验.html#cb767-7" tabindex="-1"></a><span class="fu">print</span>(adonis_result)</span></code></pre></div>
<pre><code>## Permutation test for adonis under reduced model
## Permutation: free
## Number of permutations: 999
## 
## adonis2(formula = comm_data ~ groups, method = &quot;bray&quot;)
##          Df SumOfSqs      R2      F Pr(&gt;F)
## Model     1  0.00981 0.01455 0.2658  0.791
## Residual 18  0.66465 0.98545              
## Total    19  0.67447 1.00000</code></pre>
<p><strong>示例3：空间自相关检验</strong></p>
<p>空间自相关分析是空间生态学中的重要内容，用于检验空间数据中是否存在非随机的空间模式。Moran’s I指数是常用的空间自相关度量指标，下面通过置换检验来评估其统计显著性。</p>
<p>首先加载空间分析包并准备空间数据：</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="基于模拟的假设检验.html#cb769-1" tabindex="-1"></a><span class="co"># 加载空间数据分析包</span></span>
<span id="cb769-2"><a href="基于模拟的假设检验.html#cb769-2" tabindex="-1"></a><span class="fu">library</span>(spdep)  <span class="co"># 提供空间自相关分析和置换检验功能</span></span>
<span id="cb769-3"><a href="基于模拟的假设检验.html#cb769-3" tabindex="-1"></a></span>
<span id="cb769-4"><a href="基于模拟的假设检验.html#cb769-4" tabindex="-1"></a><span class="co"># 模拟空间数据：30个空间点的坐标和属性值</span></span>
<span id="cb769-5"><a href="基于模拟的假设检验.html#cb769-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子确保结果可重复</span></span>
<span id="cb769-6"><a href="基于模拟的假设检验.html#cb769-6" tabindex="-1"></a></span>
<span id="cb769-7"><a href="基于模拟的假设检验.html#cb769-7" tabindex="-1"></a><span class="co"># 生成30个空间点的坐标，在单位正方形内均匀分布</span></span>
<span id="cb769-8"><a href="基于模拟的假设检验.html#cb769-8" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">runif</span>(<span class="dv">30</span>), <span class="fu">runif</span>(<span class="dv">30</span>))</span>
<span id="cb769-9"><a href="基于模拟的假设检验.html#cb769-9" tabindex="-1"></a></span>
<span id="cb769-10"><a href="基于模拟的假设检验.html#cb769-10" tabindex="-1"></a><span class="co"># 生成空间属性数据，使用标准正态分布</span></span>
<span id="cb769-11"><a href="基于模拟的假设检验.html#cb769-11" tabindex="-1"></a>sp_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>)</span></code></pre></div>
<p>接下来构建空间权重矩阵并进行Moran’s I置换检验：</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="基于模拟的假设检验.html#cb770-1" tabindex="-1"></a><span class="co"># 创建空间权重矩阵：定义空间邻接关系</span></span>
<span id="cb770-2"><a href="基于模拟的假设检验.html#cb770-2" tabindex="-1"></a><span class="co"># 使用k近邻方法构建邻接关系，每个点选择最近的5个邻居</span></span>
<span id="cb770-3"><a href="基于模拟的假设检验.html#cb770-3" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords, <span class="at">k =</span> <span class="dv">5</span>))</span>
<span id="cb770-4"><a href="基于模拟的假设检验.html#cb770-4" tabindex="-1"></a></span>
<span id="cb770-5"><a href="基于模拟的假设检验.html#cb770-5" tabindex="-1"></a><span class="co"># 将邻接关系转换为空间权重列表</span></span>
<span id="cb770-6"><a href="基于模拟的假设检验.html#cb770-6" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb)</span>
<span id="cb770-7"><a href="基于模拟的假设检验.html#cb770-7" tabindex="-1"></a></span>
<span id="cb770-8"><a href="基于模拟的假设检验.html#cb770-8" tabindex="-1"></a><span class="co"># Moran&#39;s I置换检验：检验空间自相关的显著性</span></span>
<span id="cb770-9"><a href="基于模拟的假设检验.html#cb770-9" tabindex="-1"></a><span class="co"># 使用999次置换构建零分布，评估观测Moran&#39;s I的极端程度</span></span>
<span id="cb770-10"><a href="基于模拟的假设检验.html#cb770-10" tabindex="-1"></a>moran_test <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(sp_data, w, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb770-11"><a href="基于模拟的假设检验.html#cb770-11" tabindex="-1"></a></span>
<span id="cb770-12"><a href="基于模拟的假设检验.html#cb770-12" tabindex="-1"></a><span class="co"># 输出检验结果</span></span>
<span id="cb770-13"><a href="基于模拟的假设检验.html#cb770-13" tabindex="-1"></a><span class="fu">print</span>(moran_test)</span></code></pre></div>
<pre><code>## 
##  Monte-Carlo simulation of Moran I
## 
## data:  sp_data 
## weights: w  
## number of simulations + 1: 1000 
## 
## statistic = -0.2891, observed rank = 1, p-value = 0.999
## alternative hypothesis: greater</code></pre>
<p><strong>示例4：使用coin包进行置换检验</strong></p>
<p>coin包提供了基于条件推断的置换检验框架，支持多种非参数统计检验。下面使用coin包重新分析示例1中的保护区内外物种丰富度数据，展示其简洁的语法和强大的功能。</p>
<p>首先加载coin包并准备数据：</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="基于模拟的假设检验.html#cb772-1" tabindex="-1"></a><span class="co"># 加载条件推断包</span></span>
<span id="cb772-2"><a href="基于模拟的假设检验.html#cb772-2" tabindex="-1"></a><span class="fu">library</span>(coin)  <span class="co"># 提供基于置换的非参数检验方法</span></span>
<span id="cb772-3"><a href="基于模拟的假设检验.html#cb772-3" tabindex="-1"></a></span>
<span id="cb772-4"><a href="基于模拟的假设检验.html#cb772-4" tabindex="-1"></a><span class="co"># 准备数据：使用示例1中的保护区内外物种丰富度数据</span></span>
<span id="cb772-5"><a href="基于模拟的假设检验.html#cb772-5" tabindex="-1"></a><span class="co"># 创建包含数值变量和分组变量的数据框</span></span>
<span id="cb772-6"><a href="基于模拟的假设检验.html#cb772-6" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb772-7"><a href="基于模拟的假设检验.html#cb772-7" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(protected, unprotected),  <span class="co"># 合并两组物种丰富度数据</span></span>
<span id="cb772-8"><a href="基于模拟的假设检验.html#cb772-8" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;保护区内&quot;</span>, <span class="st">&quot;保护区外&quot;</span>), <span class="at">each =</span> <span class="dv">20</span>))  <span class="co"># 定义分组因子</span></span>
<span id="cb772-9"><a href="基于模拟的假设检验.html#cb772-9" tabindex="-1"></a>)</span></code></pre></div>
<p>接下来使用coin包进行置换t检验：</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="基于模拟的假设检验.html#cb773-1" tabindex="-1"></a><span class="co"># 置换t检验：检验两组均值差异的显著性</span></span>
<span id="cb773-2"><a href="基于模拟的假设检验.html#cb773-2" tabindex="-1"></a><span class="co"># independence_test函数执行基于置换的独立样本检验</span></span>
<span id="cb773-3"><a href="基于模拟的假设检验.html#cb773-3" tabindex="-1"></a><span class="co"># 使用近似分布，重抽样1000次构建零分布</span></span>
<span id="cb773-4"><a href="基于模拟的假设检验.html#cb773-4" tabindex="-1"></a>test_result <span class="ot">&lt;-</span> <span class="fu">independence_test</span>(value <span class="sc">~</span> group,</span>
<span id="cb773-5"><a href="基于模拟的假设检验.html#cb773-5" tabindex="-1"></a>                                <span class="at">data =</span> data,</span>
<span id="cb773-6"><a href="基于模拟的假设检验.html#cb773-6" tabindex="-1"></a>                                <span class="at">distribution =</span> <span class="fu">approximate</span>(<span class="at">nresample =</span> <span class="dv">1000</span>))</span>
<span id="cb773-7"><a href="基于模拟的假设检验.html#cb773-7" tabindex="-1"></a></span>
<span id="cb773-8"><a href="基于模拟的假设检验.html#cb773-8" tabindex="-1"></a><span class="co"># 输出检验结果</span></span>
<span id="cb773-9"><a href="基于模拟的假设检验.html#cb773-9" tabindex="-1"></a><span class="fu">print</span>(test_result)</span></code></pre></div>
<pre><code>## 
##  Approximative General Independence Test
## 
## data:  value by group (保护区内, 保护区外)
## Z = 3.8802, p-value &lt; 0.001
## alternative hypothesis: two.sided</code></pre>
<p>这些示例展示了置换检验在不同生态学场景中的应用，从简单的均值差异检验到复杂的空间分析和群落分析。研究人员可以根据具体研究问题选择合适的置换检验方法。</p>
</div>
<div id="置换检验在生态学中的应用价值与局限" class="section level3 hasAnchor" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> 置换检验在生态学中的应用价值与局限<a href="基于模拟的假设检验.html#置换检验在生态学中的应用价值与局限" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>置换检验在生态学研究中展现出独特的应用价值，这主要源于其对生态数据特性的良好适应性。生态数据往往具有复杂的分布特征，如偏态分布、异方差性等，这些特征使得传统的参数检验方法难以适用。置换检验完全基于数据本身，不依赖于任何理论分布假设，这使其能够有效处理生态学中常见的非正态数据。更重要的是，许多生态学研究中关心的统计量，如多样性指数、空间自相关指数、网络拓扑指标等，根本没有现成的理论分布可供参照。置换检验通过构建经验分布的方式，为这些复杂统计量的统计推断提供了可行的解决方案。</p>
<p>在具体应用层面，置换检验能够保持数据的原始结构特征，包括样本量、数据范围等关键信息，这在实际应用中具有重要价值。与传统的参数检验相比，置换检验在小样本情况下表现出更好的适用性。当样本量较小时，参数检验的功效往往不足，而置换检验通过大量的随机化模拟，能够提供相对可靠的统计推断。这种特性使得置换检验特别适合处理生态学研究中常见的有限样本问题。</p>
<p>置换检验在生态学的各个分支领域都有广泛的应用。在群落生态学中，研究人员通过置换ANOVA或置换MANOVA来检验不同处理（如施肥、放牧）对植物群落组成的影响，评估处理间在物种组成上的差异显著性。在空间生态学中，置换检验被用于检验物种的空间分布是否偏离随机模式，通过随机重排物种在空间中的位置来构建Ripley’s K函数或Moran’s I指数的零分布。行为生态学家利用置换检验来分析动物的行为序列是否具有特定模式，通过随机重排行为事件的时间顺序来检验观测行为序列的非随机性。在保护生物学领域，置换检验被用于比较保护区内外的生物多样性，评估保护措施对物种丰富度和群落结构的影响。</p>
<p>然而，置换检验也存在一些固有的局限性。首先，置换检验对计算资源的要求较高，通常需要进行1000-10000次的随机化重复，这在大规模数据分析中可能成为瓶颈。其次，不同的随机化方案可能导致不同的结果，研究人员需要根据具体研究问题谨慎选择适当的随机化策略。最重要的是，统计显著性并不等同于生态重要性，置换检验的结果仍需结合生态学机制进行深入解释，避免过度依赖p值而忽视生态学意义。</p>
<p>在与其他统计方法的比较中，置换检验与参数检验形成互补关系而非替代关系。当参数检验的前提条件满足时，参数检验通常具有更高的统计效率；当前提条件不满足时，置换检验提供了可靠的替代方案。与自助法相比，两者虽然都基于重抽样思想，但应用目的不同：自助法通过有放回抽样来估计统计量的抽样分布，主要用于构建置信区间；而置换检验通过无放回的标签重排来构建零分布，主要用于假设检验。与蒙特卡洛检验的关系则体现在数据生成机制的差异上：蒙特卡洛检验基于理论模型生成模拟数据，而置换检验基于观测数据的重排，两者都是基于模拟的统计方法，但理论基础和应用场景有所不同。</p>
<p>在实际应用中，研究人员需要注意几个关键的技术细节。随机化次数的选择直接影响结果的精确性，建议至少进行1000次随机化，对于精确的p值估计，可能需要10000次或更多。为确保结果的可重复性，应在每次分析前设置随机数种子。当进行多个检验时，需要考虑多重比较问题，可采用Bonferroni校正或错误发现率控制等方法进行校正。最重要的是，统计显著性必须结合生态学意义进行解释，避免过度依赖p值而忽视生态学机制的理解。</p>
<p>置换检验代表了生态统计学从理论驱动向数据驱动的重要转变，为处理复杂的生态学问题提供了灵活而强大的统计工具。通过理解其原理、掌握其应用、认识其局限，生态学家能够在面对各种非标准统计问题时做出更加可靠的统计推断，推动生态学研究的深入发展。</p>
</div>
</div>
<div id="蒙特卡洛检验" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> 蒙特卡洛检验<a href="基于模拟的假设检验.html#蒙特卡洛检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="蒙特卡洛方法的概念体系" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> 蒙特卡洛方法的概念体系<a href="基于模拟的假设检验.html#蒙特卡洛方法的概念体系" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>蒙特卡洛方法是一个广义的概念，指所有基于随机模拟的统计推断方法。在生态统计学中，蒙特卡洛方法按照数据生成机制可以分为两大类：</p>
<p><strong>参数化蒙特卡洛检验</strong>：基于理论模型或假设分布生成全新的模拟数据，主要用于检验观测数据与理论模型的拟合优度。</p>
<p><strong>非参数化蒙特卡洛方法</strong>：基于观测数据的重抽样，其中最重要的就是<strong>自助法（bootstrap）</strong>。自助法通过有放回的重抽样来估计统计量的抽样分布，主要用于构建置信区间和参数估计。</p>
</div>
<div id="蒙特卡洛检验的基本原理" class="section level3 hasAnchor" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> 蒙特卡洛检验的基本原理<a href="基于模拟的假设检验.html#蒙特卡洛检验的基本原理" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>蒙特卡洛检验特指参数化蒙特卡洛检验，是一种基于随机模拟的统计推断方法，其名称来源于著名的蒙特卡洛赌场，反映了该方法依赖于随机抽样的本质。与置换检验不同，蒙特卡洛检验不是基于观测数据的重排，而是基于理论模型或假设分布生成模拟数据，通过大量的随机模拟来构建统计量的经验分布。</p>
<p>蒙特卡洛检验的核心思想是通过计算机模拟来近似统计量的抽样分布，特别适用于那些理论分布未知或过于复杂的统计量。在生态学研究中，许多复杂的统计量，如空间生态学中的Ripley’s K函数、群落生态学中的<span class="math inline">\(\beta\)</span>多样性指数、系统发育分析中的进化速率等，都没有现成的理论分布可供参照。蒙特卡洛检验为这些复杂统计量的统计推断提供了可行的解决方案。</p>
<p>蒙特卡洛检验的实施过程通常包括三个关键步骤。首先，基于零假设构建理论模型或假设分布，这个模型描述了在零假设成立时数据应该遵循的分布特征。其次，从这个理论模型中重复生成大量的模拟数据集，每次模拟都计算我们关心的统计量。最后，基于这些模拟统计量构建经验分布，将观测统计量与这个经验分布进行比较，计算p值或构建置信区间。</p>
<p>让我们通过一个具体的生态学例子来详细说明这三个步骤。假设我们正在研究某种树种的种子散布模式，我们想要检验观测到的种子散布距离是否显著偏离随机散布的期望。零假设是种子散布遵循随机散布模式。</p>
<p><strong>步骤1：构建理论模型</strong> 基于零假设，我们构建一个随机散布的理论模型。在这个模型中，种子从母树位置出发，散布距离和方向都是随机的。具体来说，我们可以假设散布距离服从指数分布（这是许多植物种子散布的常见模式），散布方向在0-360度之间均匀分布。这个理论模型描述了在零假设成立时种子散布应该遵循的分布特征。</p>
<p><strong>步骤2：生成模拟数据集并计算统计量</strong> 从构建的理论模型中，我们重复生成大量的模拟数据集。每次模拟都随机生成与观测数据相同数量的种子散布事件。对于每个模拟数据集，我们计算关心的统计量，比如平均散布距离、散布距离的变异系数、或者空间聚集指数。假设我们关心的是种子散布的平均距离，那么每次模拟都会计算这个平均距离统计量。重复这个过程1000次，我们就得到了1000个在零假设下的平均散布距离值。</p>
<p><strong>步骤3：构建经验分布并比较</strong> 基于这1000个模拟统计量，我们构建了平均散布距离在零假设下的经验分布。然后，我们将实际观测到的平均散布距离与这个经验分布进行比较。如果观测值落在这个经验分布的极端位置（比如最高的5%或最低的5%），那么我们就可以拒绝零假设，认为种子散布模式显著偏离了随机散布的期望。</p>
<p>这个例子清晰地展示了蒙特卡洛检验的逻辑流程：从理论模型构建，到模拟数据生成，再到统计比较。整个过程不依赖于任何现成的理论分布，而是完全基于计算机模拟来构建统计推断的基础。</p>
<p>与置换检验相比，蒙特卡洛检验在数据生成机制上存在根本差异。置换检验基于观测数据的重排，通过随机交换数据标签来构建零分布，其前提假设是如果零假设为真，那么数据的标签就是可以任意交换的。而蒙特卡洛检验则基于理论模型生成全新的模拟数据，其前提假设是我们能够准确描述零假设下的数据生成过程。这种差异使得两种方法适用于不同的研究场景：置换检验更适合于比较组间差异的检验，而蒙特卡洛检验更适合于检验观测数据与理论模型的拟合优度。</p>
<p>在生态学应用中，蒙特卡洛检验具有独特的优势。它能够处理那些置换检验难以适用的场景，比如检验观测数据是否来自某个特定的理论分布，或者评估复杂生态模型的拟合优度。例如，在检验物种的空间分布是否遵循完全空间随机过程时，蒙特卡洛检验可以通过模拟完全空间随机过程来构建期望分布；在检验系统发育信号时，可以通过模拟布朗运动演化过程来构建零分布。</p>
</div>
<div id="蒙特卡洛检验的主要类型" class="section level3 hasAnchor" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> 蒙特卡洛检验的主要类型<a href="基于模拟的假设检验.html#蒙特卡洛检验的主要类型" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在生态学研究中，常用的蒙特卡洛检验方法包括：</p>
<p><strong>完全空间随机性检验</strong>：检验物种的空间分布是否遵循完全空间随机过程。通过模拟完全空间随机过程生成期望分布，与观测空间模式进行比较。</p>
<p><strong>系统发育信号检验</strong>：检验性状是否具有系统发育保守性。通过模拟布朗运动演化过程构建零分布，检验观测性状的系统发育信号强度。</p>
<p><strong>群落零模型检验</strong>：检验群落物种共存是否随机。通过随机化群落矩阵构建期望分布，检验观测群落的非随机性。</p>
<p><strong>模型拟合优度检验</strong>：检验观测数据与理论模型的拟合程度。通过从理论模型生成模拟数据，构建拟合优度统计量的经验分布。</p>
</div>
<div id="r语言实现示例空间分布随机性检验" class="section level3 hasAnchor" number="7.4.4">
<h3><span class="header-section-number">7.4.4</span> R语言实现示例：空间分布随机性检验<a href="基于模拟的假设检验.html#r语言实现示例空间分布随机性检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>下面通过空间分布随机性检验的R代码来具体说明蒙特卡洛检验的三个步骤：</p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="基于模拟的假设检验.html#cb775-1" tabindex="-1"></a><span class="co"># 检验物种空间分布是否随机</span></span>
<span id="cb775-2"><a href="基于模拟的假设检验.html#cb775-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子保证结果可重复</span></span>
<span id="cb775-3"><a href="基于模拟的假设检验.html#cb775-3" tabindex="-1"></a>observed_pattern <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">100</span>), <span class="at">ncol =</span> <span class="dv">2</span>) <span class="co"># 在单位正方形内生成100个观测空间点</span></span>
<span id="cb775-4"><a href="基于模拟的假设检验.html#cb775-4" tabindex="-1"></a></span>
<span id="cb775-5"><a href="基于模拟的假设检验.html#cb775-5" tabindex="-1"></a><span class="co"># 蒙特卡洛模拟：完全空间随机过程</span></span>
<span id="cb775-6"><a href="基于模拟的假设检验.html#cb775-6" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 模拟次数</span></span>
<span id="cb775-7"><a href="基于模拟的假设检验.html#cb775-7" tabindex="-1"></a>sim_stats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)  <span class="co"># 存储每次模拟的统计量</span></span>
<span id="cb775-8"><a href="基于模拟的假设检验.html#cb775-8" tabindex="-1"></a></span>
<span id="cb775-9"><a href="基于模拟的假设检验.html#cb775-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb775-10"><a href="基于模拟的假设检验.html#cb775-10" tabindex="-1"></a>  <span class="co"># 模拟完全空间随机过程：在相同区域内随机生成100个点</span></span>
<span id="cb775-11"><a href="基于模拟的假设检验.html#cb775-11" tabindex="-1"></a>  sim_pattern <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">100</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb775-12"><a href="基于模拟的假设检验.html#cb775-12" tabindex="-1"></a>  <span class="co"># 计算空间聚集统计量：使用点间平均距离作为聚集程度指标</span></span>
<span id="cb775-13"><a href="基于模拟的假设检验.html#cb775-13" tabindex="-1"></a>  <span class="co"># 较小的平均距离表示空间聚集，较大的平均距离表示空间分散</span></span>
<span id="cb775-14"><a href="基于模拟的假设检验.html#cb775-14" tabindex="-1"></a>  sim_stats[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">dist</span>(sim_pattern))</span>
<span id="cb775-15"><a href="基于模拟的假设检验.html#cb775-15" tabindex="-1"></a>}</span>
<span id="cb775-16"><a href="基于模拟的假设检验.html#cb775-16" tabindex="-1"></a></span>
<span id="cb775-17"><a href="基于模拟的假设检验.html#cb775-17" tabindex="-1"></a><span class="co"># 计算观测统计量：观测数据的点间平均距离</span></span>
<span id="cb775-18"><a href="基于模拟的假设检验.html#cb775-18" tabindex="-1"></a>obs_stat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">dist</span>(observed_pattern))</span>
<span id="cb775-19"><a href="基于模拟的假设检验.html#cb775-19" tabindex="-1"></a></span>
<span id="cb775-20"><a href="基于模拟的假设检验.html#cb775-20" tabindex="-1"></a><span class="co"># 计算p值：观测统计量在零分布中的位置</span></span>
<span id="cb775-21"><a href="基于模拟的假设检验.html#cb775-21" tabindex="-1"></a><span class="co"># 这里使用单侧检验，检验观测数据是否比随机期望更聚集</span></span>
<span id="cb775-22"><a href="基于模拟的假设检验.html#cb775-22" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(sim_stats <span class="sc">&lt;=</span> obs_stat)</span>
<span id="cb775-23"><a href="基于模拟的假设检验.html#cb775-23" tabindex="-1"></a></span>
<span id="cb775-24"><a href="基于模拟的假设检验.html#cb775-24" tabindex="-1"></a><span class="co"># 输出蒙特卡洛检验结果</span></span>
<span id="cb775-25"><a href="基于模拟的假设检验.html#cb775-25" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;蒙特卡洛检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 蒙特卡洛检验结果：</code></pre>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="基于模拟的假设检验.html#cb777-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;观测统计量:&quot;</span>, obs_stat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 观测统计量: 0.5167571</code></pre>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="基于模拟的假设检验.html#cb779-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## p值: 0.43</code></pre>
<p><strong>代码与蒙特卡洛检验步骤的对应关系：</strong></p>
<p><strong>步骤1：构建理论模型</strong> - 理论模型：完全空间随机过程（Complete Spatial Randomness, CSR） - 代码体现：<code>matrix(runif(100), ncol = 2)</code> 在单位正方形内随机生成100个点 - 生态学意义：假设物种在空间中的分布是完全随机的，没有任何聚集或分散模式</p>
<p><strong>步骤2：生成模拟数据集并计算统计量</strong> - 模拟数据生成：<code>for (i in 1:n_sim)</code> 循环生成1000个模拟数据集 - 统计量计算：<code>mean(dist(sim_pattern))</code> 计算每个模拟数据集的空间点间平均距离 - 生态学意义：平均距离统计量反映了空间点的聚集程度，较小的平均距离表示空间聚集</p>
<p><strong>步骤3：构建经验分布并比较</strong> - 经验分布构建：<code>sim_stats</code> 向量包含了1000个模拟统计量 - 观测统计量：<code>mean(dist(observed_pattern))</code> 计算观测数据的平均距离 - 统计比较：<code>mean(sim_stats &lt;= obs_stat)</code> 计算p值，即模拟统计量小于等于观测统计量的比例 - 生态学解释：如果p值很小（如&lt;0.05），说明观测到的空间聚集模式在随机过程中很少出现，物种分布显著偏离随机模式</p>
<p>这个具体的代码示例清晰地展示了蒙特卡洛检验从理论模型构建到统计推断的完整流程，为生态学家检验空间分布模式提供了实用的工具。</p>
<p>这些示例展示了蒙特卡洛检验在生态学不同领域的应用，从空间生态学到系统发育分析，再到群落生态学。蒙特卡洛检验为处理那些理论分布未知的复杂统计问题提供了强大的工具，是生态统计学家工具箱中不可或缺的一部分。</p>
</div>
</div>
<div id="自助法检验" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> 自助法检验<a href="基于模拟的假设检验.html#自助法检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="自助法的基本原理" class="section level3 hasAnchor" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> 自助法的基本原理<a href="基于模拟的假设检验.html#自助法的基本原理" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>自助法（bootstrap）是蒙特卡洛方法的一种特殊形式，属于非参数化蒙特卡洛方法。其核心思想是通过对观测数据进行有放回的重抽样来估计统计量的抽样分布。自助法由Bradley Efron在1979年提出，现已成为现代统计学中最重要的工具之一。</p>
<p>自助法的基本假设是：观测样本能够代表总体的分布特征。通过对观测样本进行有放回的重抽样，我们可以生成大量的”自助样本”，这些自助样本在统计上等价于从原始总体中抽取的新样本。</p>
</div>
<div id="自助法的实施步骤" class="section level3 hasAnchor" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> 自助法的实施步骤<a href="基于模拟的假设检验.html#自助法的实施步骤" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>自助法的实施过程包括三个关键步骤：</p>
<p><strong>步骤1：生成自助样本</strong> 从原始观测数据中进行有放回的重抽样，生成与原始样本大小相同的自助样本。这个过程重复B次（通常B=1000-10000），得到B个自助样本。</p>
<p><strong>步骤2：计算统计量</strong> 对每个自助样本计算我们关心的统计量，比如均值、中位数、回归系数、多样性指数等。这样就得到了统计量的自助分布。</p>
<p><strong>步骤3：构建置信区间或进行假设检验</strong> 基于自助分布，我们可以构建统计量的置信区间，或者进行假设检验。常用的置信区间构建方法包括百分位数法、偏差校正法等。</p>
</div>
<div id="自助法在生态学中的应用" class="section level3 hasAnchor" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> 自助法在生态学中的应用<a href="基于模拟的假设检验.html#自助法在生态学中的应用" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>自助法在生态学研究中有着广泛的应用：</p>
<p><strong>参数估计的不确定性评估</strong>：估计生态学参数（如种群增长率、物种丰富度、多样性指数）的置信区间。</p>
<p><strong>模型参数的不确定性分析</strong>：评估生态模型参数估计的不确定性，如广义线性模型的系数、物种分布模型的参数等。</p>
<p><strong>假设检验</strong>：通过构建统计量的自助分布，进行非参数的假设检验。</p>
<p><strong>小样本问题处理</strong>：在小样本情况下，自助法能够提供比传统参数方法更可靠的统计推断。</p>
</div>
<div id="r语言实现示例-1" class="section level3 hasAnchor" number="7.5.4">
<h3><span class="header-section-number">7.5.4</span> R语言实现示例<a href="基于模拟的假设检验.html#r语言实现示例-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>示例1：多样性指数置信区间估计</strong></p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="基于模拟的假设检验.html#cb781-1" tabindex="-1"></a><span class="co"># 使用boot包进行自助法分析</span></span>
<span id="cb781-2"><a href="基于模拟的假设检验.html#cb781-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb781-3"><a href="基于模拟的假设检验.html#cb781-3" tabindex="-1"></a></span>
<span id="cb781-4"><a href="基于模拟的假设检验.html#cb781-4" tabindex="-1"></a><span class="co"># 模拟群落数据</span></span>
<span id="cb781-5"><a href="基于模拟的假设检验.html#cb781-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb781-6"><a href="基于模拟的假设检验.html#cb781-6" tabindex="-1"></a>species_counts <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">30</span>, <span class="at">lambda =</span> <span class="dv">5</span>)</span>
<span id="cb781-7"><a href="基于模拟的假设检验.html#cb781-7" tabindex="-1"></a></span>
<span id="cb781-8"><a href="基于模拟的假设检验.html#cb781-8" tabindex="-1"></a><span class="co"># 定义多样性指数计算函数</span></span>
<span id="cb781-9"><a href="基于模拟的假设检验.html#cb781-9" tabindex="-1"></a>shannon_func <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb781-10"><a href="基于模拟的假设检验.html#cb781-10" tabindex="-1"></a>  d <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb781-11"><a href="基于模拟的假设检验.html#cb781-11" tabindex="-1"></a>  p <span class="ot">&lt;-</span> d <span class="sc">/</span> <span class="fu">sum</span>(d)</span>
<span id="cb781-12"><a href="基于模拟的假设检验.html#cb781-12" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">sum</span>(p <span class="sc">*</span> <span class="fu">log</span>(p))</span>
<span id="cb781-13"><a href="基于模拟的假设检验.html#cb781-13" tabindex="-1"></a>}</span>
<span id="cb781-14"><a href="基于模拟的假设检验.html#cb781-14" tabindex="-1"></a></span>
<span id="cb781-15"><a href="基于模拟的假设检验.html#cb781-15" tabindex="-1"></a><span class="co"># 自助法估计</span></span>
<span id="cb781-16"><a href="基于模拟的假设检验.html#cb781-16" tabindex="-1"></a>boot_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(species_counts, shannon_func, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb781-17"><a href="基于模拟的假设检验.html#cb781-17" tabindex="-1"></a><span class="fu">print</span>(boot_result)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = species_counts, statistic = shannon_func, R = 1000)
## 
## 
## Bootstrap Statistics :
##     original      bias    std. error
## t1* 3.318858 0.002494391  0.01870289</code></pre>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="基于模拟的假设检验.html#cb783-1" tabindex="-1"></a><span class="co"># 计算95%置信区间</span></span>
<span id="cb783-2"><a href="基于模拟的假设检验.html#cb783-2" tabindex="-1"></a>boot_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_result, <span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb783-3"><a href="基于模拟的假设检验.html#cb783-3" tabindex="-1"></a><span class="fu">print</span>(boot_ci)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot_result, type = &quot;perc&quot;)
## 
## Intervals : 
## Level     Percentile     
## 95%   ( 3.281,  3.356 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
<div id="自助法的优势与局限" class="section level3 hasAnchor" number="7.5.5">
<h3><span class="header-section-number">7.5.5</span> 自助法的优势与局限<a href="基于模拟的假设检验.html#自助法的优势与局限" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>优势</strong>： - 不依赖于理论分布假设 - 适用于复杂统计量和模型 - 在小样本情况下表现良好 - 能够处理非标准统计问题</p>
<p><strong>局限</strong>： - 对异常值敏感 - 在极端偏态分布中可能表现不佳 - 计算强度较大 - 需要足够大的原始样本</p>
<p>自助法作为蒙特卡洛方法的重要组成部分，为生态学家提供了强大的统计推断工具，特别适用于处理那些传统参数方法难以解决的复杂生态学问题。</p>
</div>
</div>
<div id="基因型频率检验" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> 基因型频率检验<a href="基于模拟的假设检验.html#基因型频率检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>基因型频率检验是种群遗传学和进化生态学中的核心统计问题，基于模拟的假设检验方法在这些领域展现出独特的优势，特别是在处理小样本、稀有等位基因和复杂种群结构等传统方法难以应对的情况时。</p>
<div id="hardy-weinberg平衡检验" class="section level3 hasAnchor" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Hardy-Weinberg平衡检验<a href="基于模拟的假设检验.html#hardy-weinberg平衡检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>生态学问题背景</strong>：Hardy-Weinberg平衡是种群遗传学的基本原理，描述了在没有进化力量（如自然选择、基因漂变、迁移、突变）作用时，基因型频率在世代间保持稳定的数学关系。当观测到的基因型频率显著偏离Hardy-Weinberg平衡期望时，表明存在某种进化力量在起作用。</p>
<p><strong>传统方法的局限性</strong>：传统的Hardy-Weinberg平衡检验通常使用卡方检验或精确检验。然而，这些方法在小样本或稀有等位基因情况下表现不佳： - 卡方检验要求期望频数大于5，这在稀有等位基因中往往不满足 - 精确检验计算复杂，特别是对于多位点情况 - 传统方法难以处理种群亚结构等复杂情况</p>
<p><strong>基于模拟的解决方案</strong>：蒙特卡洛模拟为Hardy-Weinberg平衡检验提供了更灵活和强大的替代方法。其基本思路是通过随机模拟构建基因型频率在平衡状态下的经验分布。</p>
<p><strong>生态学实例：濒危物种的近亲繁殖检测</strong></p>
<p>假设我们研究一种濒危鸟类——朱鹮的种群遗传结构。由于种群数量稀少，我们只能采集到15个个体的基因型数据。我们关注某个微卫星位点，观测到以下基因型频率：</p>
<ul>
<li>AA: 2个个体</li>
<li>AB: 5个个体</li>
<li>BB: 8个个体</li>
</ul>
<p>等位基因频率：A = 0.3, B = 0.7</p>
<p>在Hardy-Weinberg平衡下，期望基因型频率应为： - AA: 15 × 0.3² = 1.35 - AB: 15 × 2 × 0.3 × 0.7 = 6.3 - BB: 15 × 0.7² = 7.35</p>
<p><strong>模拟检验过程</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>构建零模型</strong>：假设种群处于Hardy-Weinberg平衡状态</li>
<li><strong>生成模拟数据</strong>：基于观测等位基因频率，通过随机交配模拟生成基因型</li>
<li><strong>计算检验统计量</strong>：使用似然比统计量或卡方统计量</li>
<li><strong>重复模拟</strong>：进行10000次蒙特卡洛模拟</li>
<li><strong>计算经验p值</strong>：比较观测统计量与模拟分布的相对位置</li>
</ol>
<p><strong>R语言实现示例</strong>：</p>
<p>首先，我们设置观测数据和计算期望频率：</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="基于模拟的假设检验.html#cb785-1" tabindex="-1"></a><span class="co"># Hardy-Weinberg平衡检验：数据准备</span></span>
<span id="cb785-2"><a href="基于模拟的假设检验.html#cb785-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb785-3"><a href="基于模拟的假设检验.html#cb785-3" tabindex="-1"></a>observed <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">AA =</span> <span class="dv">2</span>, <span class="at">AB =</span> <span class="dv">5</span>, <span class="at">BB =</span> <span class="dv">8</span>) <span class="co"># 观测基因型频数</span></span>
<span id="cb785-4"><a href="基于模拟的假设检验.html#cb785-4" tabindex="-1"></a>allele_freq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">A =</span> <span class="fl">0.3</span>, <span class="at">B =</span> <span class="fl">0.7</span>) <span class="co"># 等位基因频率</span></span>
<span id="cb785-5"><a href="基于模拟的假设检验.html#cb785-5" tabindex="-1"></a>n_individuals <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb785-6"><a href="基于模拟的假设检验.html#cb785-6" tabindex="-1"></a></span>
<span id="cb785-7"><a href="基于模拟的假设检验.html#cb785-7" tabindex="-1"></a><span class="co"># 计算期望基因型频率</span></span>
<span id="cb785-8"><a href="基于模拟的假设检验.html#cb785-8" tabindex="-1"></a><span class="co"># 根据Hardy-Weinberg平衡原理：$p^2 + 2pq + q^2 = 1$</span></span>
<span id="cb785-9"><a href="基于模拟的假设检验.html#cb785-9" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb785-10"><a href="基于模拟的假设检验.html#cb785-10" tabindex="-1"></a>  <span class="at">AA =</span> n_individuals <span class="sc">*</span> allele_freq[<span class="st">&quot;A&quot;</span>]<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb785-11"><a href="基于模拟的假设检验.html#cb785-11" tabindex="-1"></a>  <span class="at">AB =</span> n_individuals <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> allele_freq[<span class="st">&quot;A&quot;</span>] <span class="sc">*</span> allele_freq[<span class="st">&quot;B&quot;</span>],</span>
<span id="cb785-12"><a href="基于模拟的假设检验.html#cb785-12" tabindex="-1"></a>  <span class="at">BB =</span> n_individuals <span class="sc">*</span> allele_freq[<span class="st">&quot;B&quot;</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb785-13"><a href="基于模拟的假设检验.html#cb785-13" tabindex="-1"></a>)</span>
<span id="cb785-14"><a href="基于模拟的假设检验.html#cb785-14" tabindex="-1"></a></span>
<span id="cb785-15"><a href="基于模拟的假设检验.html#cb785-15" tabindex="-1"></a><span class="co"># 计算观测卡方统计量</span></span>
<span id="cb785-16"><a href="基于模拟的假设检验.html#cb785-16" tabindex="-1"></a>obs_chisq <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb785-17"><a href="基于模拟的假设检验.html#cb785-17" tabindex="-1"></a></span>
<span id="cb785-18"><a href="基于模拟的假设检验.html#cb785-18" tabindex="-1"></a><span class="co"># 输出Hardy-Weinberg平衡检验的观测结果</span></span>
<span id="cb785-19"><a href="基于模拟的假设检验.html#cb785-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Hardy-Weinberg平衡检验 - 观测结果：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Hardy-Weinberg平衡检验 - 观测结果：</code></pre>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="基于模拟的假设检验.html#cb787-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;期望基因型频率:&quot;</span>, expected, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 期望基因型频率: 1.35 6.3 7.35</code></pre>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="基于模拟的假设检验.html#cb789-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;观测卡方统计量:&quot;</span>, obs_chisq, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 观测卡方统计量: 0.6386999</code></pre>
<p>接下来，我们进行蒙特卡洛模拟来构建零分布：</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="基于模拟的假设检验.html#cb791-1" tabindex="-1"></a><span class="co"># Hardy-Weinberg平衡检验：蒙特卡洛模拟</span></span>
<span id="cb791-2"><a href="基于模拟的假设检验.html#cb791-2" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb791-3"><a href="基于模拟的假设检验.html#cb791-3" tabindex="-1"></a>sim_chisq <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb791-4"><a href="基于模拟的假设检验.html#cb791-4" tabindex="-1"></a></span>
<span id="cb791-5"><a href="基于模拟的假设检验.html#cb791-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb791-6"><a href="基于模拟的假设检验.html#cb791-6" tabindex="-1"></a>  <span class="co"># 基于Hardy-Weinberg平衡生成模拟基因型</span></span>
<span id="cb791-7"><a href="基于模拟的假设检验.html#cb791-7" tabindex="-1"></a>  <span class="co"># 使用样本函数随机生成基因型，概率基于Hardy-Weinberg平衡</span></span>
<span id="cb791-8"><a href="基于模拟的假设检验.html#cb791-8" tabindex="-1"></a>  sim_genotypes <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;AA&quot;</span>, <span class="st">&quot;AB&quot;</span>, <span class="st">&quot;BB&quot;</span>),</span>
<span id="cb791-9"><a href="基于模拟的假设检验.html#cb791-9" tabindex="-1"></a>    <span class="at">size =</span> n_individuals,</span>
<span id="cb791-10"><a href="基于模拟的假设检验.html#cb791-10" tabindex="-1"></a>    <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb791-11"><a href="基于模拟的假设检验.html#cb791-11" tabindex="-1"></a>    <span class="at">prob =</span> <span class="fu">c</span>(</span>
<span id="cb791-12"><a href="基于模拟的假设检验.html#cb791-12" tabindex="-1"></a>      allele_freq[<span class="st">&quot;A&quot;</span>]<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb791-13"><a href="基于模拟的假设检验.html#cb791-13" tabindex="-1"></a>      <span class="dv">2</span> <span class="sc">*</span> allele_freq[<span class="st">&quot;A&quot;</span>] <span class="sc">*</span> allele_freq[<span class="st">&quot;B&quot;</span>],</span>
<span id="cb791-14"><a href="基于模拟的假设检验.html#cb791-14" tabindex="-1"></a>      allele_freq[<span class="st">&quot;B&quot;</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb791-15"><a href="基于模拟的假设检验.html#cb791-15" tabindex="-1"></a>    )</span>
<span id="cb791-16"><a href="基于模拟的假设检验.html#cb791-16" tabindex="-1"></a>  )</span>
<span id="cb791-17"><a href="基于模拟的假设检验.html#cb791-17" tabindex="-1"></a></span>
<span id="cb791-18"><a href="基于模拟的假设检验.html#cb791-18" tabindex="-1"></a>  <span class="co"># 计算模拟数据的卡方统计量</span></span>
<span id="cb791-19"><a href="基于模拟的假设检验.html#cb791-19" tabindex="-1"></a>  sim_counts <span class="ot">&lt;-</span> <span class="fu">table</span>(sim_genotypes)</span>
<span id="cb791-20"><a href="基于模拟的假设检验.html#cb791-20" tabindex="-1"></a>  sim_expected <span class="ot">&lt;-</span> expected[<span class="fu">names</span>(sim_counts)]</span>
<span id="cb791-21"><a href="基于模拟的假设检验.html#cb791-21" tabindex="-1"></a>  sim_chisq[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>((sim_counts <span class="sc">-</span> sim_expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> sim_expected)</span>
<span id="cb791-22"><a href="基于模拟的假设检验.html#cb791-22" tabindex="-1"></a>}</span>
<span id="cb791-23"><a href="基于模拟的假设检验.html#cb791-23" tabindex="-1"></a></span>
<span id="cb791-24"><a href="基于模拟的假设检验.html#cb791-24" tabindex="-1"></a><span class="co"># 计算经验p值</span></span>
<span id="cb791-25"><a href="基于模拟的假设检验.html#cb791-25" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(sim_chisq <span class="sc">&gt;=</span> obs_chisq)</span>
<span id="cb791-26"><a href="基于模拟的假设检验.html#cb791-26" tabindex="-1"></a></span>
<span id="cb791-27"><a href="基于模拟的假设检验.html#cb791-27" tabindex="-1"></a><span class="co"># 输出蒙特卡洛模拟结果</span></span>
<span id="cb791-28"><a href="基于模拟的假设检验.html#cb791-28" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Hardy-Weinberg平衡检验 - 蒙特卡洛模拟结果：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Hardy-Weinberg平衡检验 - 蒙特卡洛模拟结果：</code></pre>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="基于模拟的假设检验.html#cb793-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;经验p值:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 经验p值: NA</code></pre>
<p><strong>生态学意义</strong>：如果检验结果显示显著偏离Hardy-Weinberg平衡（p &lt; 0.05），可能表明朱鹮种群存在近亲繁殖、自然选择或种群亚结构等进化力量。这对于制定保护策略具有重要意义——如果检测到近亲繁殖，可能需要引入外来个体增加遗传多样性；如果检测到自然选择，可能需要关注特定基因型与环境适应的关系。</p>
</div>
<div id="连锁不平衡检验" class="section level3 hasAnchor" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> 连锁不平衡检验<a href="基于模拟的假设检验.html#连锁不平衡检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>生态学问题背景</strong>：连锁不平衡描述了两个或多个基因位点间等位基因的非随机关联。在生态学中，连锁不平衡可以揭示： - 基因间的功能关联或物理连锁 - 近期种群混合或瓶颈事件 - 自然选择对特定基因组合的作用</p>
<p><strong>传统方法的挑战</strong>：传统的连锁不平衡检验方法（如D’统计量、r²统计量）在大样本下渐近分布已知，但在小样本或复杂种群结构中，理论分布难以确定。</p>
<p><strong>基于模拟的优势</strong>：置换检验通过随机重排基因型来构建零分布，不依赖于理论分布假设，特别适合处理： - 小样本情况 - 多位点同时检验 - 存在种群结构的复杂情况</p>
<p><strong>生态学实例：适应性基因关联研究</strong></p>
<p>假设我们研究高山植物——雪莲对低温适应的遗传基础。我们检测了两个候选基因位点： - 位点1：抗冻蛋白基因（等位基因：F-抗冻，f-不抗冻） - 位点2：膜流动性基因（等位基因：M-高流动性，m-低流动性）</p>
<p>我们在不同海拔的种群中采样，想要检验这两个基因位点是否存在连锁不平衡，即特定的等位基因组合是否与海拔适应相关。</p>
<p>观测到的单倍型频率： - FM: 12 - Fm: 3 - fM: 2 - fm: 8</p>
<p><strong>置换检验过程</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>计算观测关联统计量</strong>：使用D’统计量或似然比统计量</li>
<li><strong>随机重排</strong>：保持每个位点的等位基因频率不变，随机重排位点间的关联</li>
<li><strong>构建零分布</strong>：重复重排10000次，每次计算关联统计量</li>
<li><strong>计算p值</strong>：比较观测统计量与零分布的位置</li>
</ol>
<p><strong>R语言实现示例</strong>：</p>
<p>首先，我们定义计算D’统计量的函数：</p>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="基于模拟的假设检验.html#cb795-1" tabindex="-1"></a><span class="co"># 连锁不平衡检验：定义D&#39;统计量计算函数</span></span>
<span id="cb795-2"><a href="基于模拟的假设检验.html#cb795-2" tabindex="-1"></a>calc_D_prime <span class="ot">&lt;-</span> <span class="cf">function</span>(hap) {</span>
<span id="cb795-3"><a href="基于模拟的假设检验.html#cb795-3" tabindex="-1"></a>  <span class="co"># 计算单倍型频率</span></span>
<span id="cb795-4"><a href="基于模拟的假设检验.html#cb795-4" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">table</span>(hap)</span>
<span id="cb795-5"><a href="基于模拟的假设检验.html#cb795-5" tabindex="-1"></a></span>
<span id="cb795-6"><a href="基于模拟的假设检验.html#cb795-6" tabindex="-1"></a>  <span class="co"># 计算等位基因频率</span></span>
<span id="cb795-7"><a href="基于模拟的假设检验.html#cb795-7" tabindex="-1"></a>  p_F <span class="ot">&lt;-</span> (counts[<span class="st">&quot;FM&quot;</span>] <span class="sc">+</span> counts[<span class="st">&quot;Fm&quot;</span>]) <span class="sc">/</span> <span class="fu">length</span>(hap)</span>
<span id="cb795-8"><a href="基于模拟的假设检验.html#cb795-8" tabindex="-1"></a>  p_f <span class="ot">&lt;-</span> (counts[<span class="st">&quot;fM&quot;</span>] <span class="sc">+</span> counts[<span class="st">&quot;fm&quot;</span>]) <span class="sc">/</span> <span class="fu">length</span>(hap)</span>
<span id="cb795-9"><a href="基于模拟的假设检验.html#cb795-9" tabindex="-1"></a>  p_M <span class="ot">&lt;-</span> (counts[<span class="st">&quot;FM&quot;</span>] <span class="sc">+</span> counts[<span class="st">&quot;fM&quot;</span>]) <span class="sc">/</span> <span class="fu">length</span>(hap)</span>
<span id="cb795-10"><a href="基于模拟的假设检验.html#cb795-10" tabindex="-1"></a>  p_m <span class="ot">&lt;-</span> (counts[<span class="st">&quot;Fm&quot;</span>] <span class="sc">+</span> counts[<span class="st">&quot;fm&quot;</span>]) <span class="sc">/</span> <span class="fu">length</span>(hap)</span>
<span id="cb795-11"><a href="基于模拟的假设检验.html#cb795-11" tabindex="-1"></a></span>
<span id="cb795-12"><a href="基于模拟的假设检验.html#cb795-12" tabindex="-1"></a>  <span class="co"># 计算连锁不平衡系数D</span></span>
<span id="cb795-13"><a href="基于模拟的假设检验.html#cb795-13" tabindex="-1"></a>  p_FM <span class="ot">&lt;-</span> counts[<span class="st">&quot;FM&quot;</span>] <span class="sc">/</span> <span class="fu">length</span>(hap)</span>
<span id="cb795-14"><a href="基于模拟的假设检验.html#cb795-14" tabindex="-1"></a>  D <span class="ot">&lt;-</span> p_FM <span class="sc">-</span> p_F <span class="sc">*</span> p_M</span>
<span id="cb795-15"><a href="基于模拟的假设检验.html#cb795-15" tabindex="-1"></a></span>
<span id="cb795-16"><a href="基于模拟的假设检验.html#cb795-16" tabindex="-1"></a>  <span class="co"># 计算D&#39;统计量（标准化的连锁不平衡）</span></span>
<span id="cb795-17"><a href="基于模拟的假设检验.html#cb795-17" tabindex="-1"></a>  D_max <span class="ot">&lt;-</span> <span class="fu">min</span>(p_F <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_M), (<span class="dv">1</span> <span class="sc">-</span> p_F) <span class="sc">*</span> p_M)</span>
<span id="cb795-18"><a href="基于模拟的假设检验.html#cb795-18" tabindex="-1"></a>  <span class="cf">if</span> (D <span class="sc">&gt;=</span> <span class="dv">0</span>) {</span>
<span id="cb795-19"><a href="基于模拟的假设检验.html#cb795-19" tabindex="-1"></a>    D_prime <span class="ot">&lt;-</span> D <span class="sc">/</span> D_max</span>
<span id="cb795-20"><a href="基于模拟的假设检验.html#cb795-20" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb795-21"><a href="基于模拟的假设检验.html#cb795-21" tabindex="-1"></a>    D_prime <span class="ot">&lt;-</span> D <span class="sc">/</span> <span class="fu">min</span>(p_F <span class="sc">*</span> p_M, (<span class="dv">1</span> <span class="sc">-</span> p_F) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_M))</span>
<span id="cb795-22"><a href="基于模拟的假设检验.html#cb795-22" tabindex="-1"></a>  }</span>
<span id="cb795-23"><a href="基于模拟的假设检验.html#cb795-23" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">abs</span>(D_prime))</span>
<span id="cb795-24"><a href="基于模拟的假设检验.html#cb795-24" tabindex="-1"></a>}</span></code></pre></div>
<p>接下来，我们计算观测统计量并进行置换检验：</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="基于模拟的假设检验.html#cb796-1" tabindex="-1"></a><span class="co"># 连锁不平衡检验：数据准备和观测统计量计算</span></span>
<span id="cb796-2"><a href="基于模拟的假设检验.html#cb796-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb796-3"><a href="基于模拟的假设检验.html#cb796-3" tabindex="-1"></a>haplotypes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;FM&quot;</span>, <span class="dv">12</span>), <span class="fu">rep</span>(<span class="st">&quot;Fm&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;fM&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;fm&quot;</span>, <span class="dv">8</span>))</span>
<span id="cb796-4"><a href="基于模拟的假设检验.html#cb796-4" tabindex="-1"></a>n_haplotypes <span class="ot">&lt;-</span> <span class="fu">length</span>(haplotypes)</span>
<span id="cb796-5"><a href="基于模拟的假设检验.html#cb796-5" tabindex="-1"></a></span>
<span id="cb796-6"><a href="基于模拟的假设检验.html#cb796-6" tabindex="-1"></a><span class="co"># 计算观测D&#39;统计量</span></span>
<span id="cb796-7"><a href="基于模拟的假设检验.html#cb796-7" tabindex="-1"></a>obs_D_prime <span class="ot">&lt;-</span> <span class="fu">calc_D_prime</span>(haplotypes)</span>
<span id="cb796-8"><a href="基于模拟的假设检验.html#cb796-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;观测D&#39;统计量:&quot;</span>, obs_D_prime, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 观测D&#39;统计量: 0.6428571</code></pre>
<p>最后，我们进行置换检验来构建零分布：</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="基于模拟的假设检验.html#cb798-1" tabindex="-1"></a><span class="co"># 连锁不平衡检验：置换检验</span></span>
<span id="cb798-2"><a href="基于模拟的假设检验.html#cb798-2" tabindex="-1"></a>n_perm <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb798-3"><a href="基于模拟的假设检验.html#cb798-3" tabindex="-1"></a>perm_D_prime <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_perm)</span>
<span id="cb798-4"><a href="基于模拟的假设检验.html#cb798-4" tabindex="-1"></a></span>
<span id="cb798-5"><a href="基于模拟的假设检验.html#cb798-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_perm) {</span>
<span id="cb798-6"><a href="基于模拟的假设检验.html#cb798-6" tabindex="-1"></a>  <span class="co"># 随机重排位点间的关联</span></span>
<span id="cb798-7"><a href="基于模拟的假设检验.html#cb798-7" tabindex="-1"></a>  <span class="co"># 保持每个位点的等位基因频率不变，只随机化位点间的关联</span></span>
<span id="cb798-8"><a href="基于模拟的假设检验.html#cb798-8" tabindex="-1"></a>  locus1 <span class="ot">&lt;-</span> <span class="fu">substr</span>(haplotypes, <span class="dv">1</span>, <span class="dv">1</span>) <span class="co"># 第一个位点（抗冻蛋白基因）</span></span>
<span id="cb798-9"><a href="基于模拟的假设检验.html#cb798-9" tabindex="-1"></a>  locus2 <span class="ot">&lt;-</span> <span class="fu">substr</span>(haplotypes, <span class="dv">2</span>, <span class="dv">2</span>) <span class="co"># 第二个位点（膜流动性基因）</span></span>
<span id="cb798-10"><a href="基于模拟的假设检验.html#cb798-10" tabindex="-1"></a>  perm_locus2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(locus2) <span class="co"># 随机重排第二个位点</span></span>
<span id="cb798-11"><a href="基于模拟的假设检验.html#cb798-11" tabindex="-1"></a>  perm_haplotypes <span class="ot">&lt;-</span> <span class="fu">paste0</span>(locus1, perm_locus2)</span>
<span id="cb798-12"><a href="基于模拟的假设检验.html#cb798-12" tabindex="-1"></a>  perm_D_prime[i] <span class="ot">&lt;-</span> <span class="fu">calc_D_prime</span>(perm_haplotypes)</span>
<span id="cb798-13"><a href="基于模拟的假设检验.html#cb798-13" tabindex="-1"></a>}</span>
<span id="cb798-14"><a href="基于模拟的假设检验.html#cb798-14" tabindex="-1"></a></span>
<span id="cb798-15"><a href="基于模拟的假设检验.html#cb798-15" tabindex="-1"></a><span class="co"># 计算经验p值</span></span>
<span id="cb798-16"><a href="基于模拟的假设检验.html#cb798-16" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(perm_D_prime <span class="sc">&gt;=</span> obs_D_prime)</span>
<span id="cb798-17"><a href="基于模拟的假设检验.html#cb798-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;经验p值:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 经验p值: 0.012</code></pre>
<p><strong>生态学意义</strong>：如果检验显示显著的连锁不平衡，表明抗冻蛋白基因和膜流动性基因可能存在功能关联，共同参与雪莲的低温适应。这种遗传关联信息对于理解物种的环境适应机制、预测气候变化响应以及指导保护育种都具有重要价值。</p>
</div>
<div id="方法学比较与选择建议" class="section level3 hasAnchor" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> 方法学比较与选择建议<a href="基于模拟的假设检验.html#方法学比较与选择建议" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>模拟方法 vs 传统方法的优势</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>小样本适用性</strong>：模拟方法在小样本情况下仍能提供可靠的p值估计</li>
<li><strong>分布自由</strong>：不依赖于渐近分布假设，适用于任何样本量</li>
<li><strong>灵活性</strong>：可以轻松扩展到复杂统计量或多位点情况</li>
<li><strong>直观性</strong>：经验分布比理论分布更易于理解和解释</li>
</ol>
<p><strong>适用场景推荐</strong>： - <strong>样本量 &lt; 50</strong>：优先考虑模拟方法 - <strong>稀有等位基因</strong>（频率 &lt; 0.05）：模拟方法更可靠 - <strong>多位点同时检验</strong>：模拟方法便于多重比较校正 - <strong>复杂种群结构</strong>：模拟方法可以整合结构信息</p>
<p><strong>生态学研究价值</strong>：基于模拟的基因型频率检验为生态学家提供了更强大的工具来探测微妙的进化信号，特别是在保护生物学和气候变化生态学等需要处理有限样本和复杂遗传结构的领域中，这些方法的价值尤为突出。</p>
</div>
</div>
<div id="多样性差异检验" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> 多样性差异检验<a href="基于模拟的假设检验.html#多样性差异检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>多样性差异检验是群落生态学和保护生物学中的核心统计问题。传统的参数检验方法在处理群落多样性数据时面临诸多挑战，而基于模拟的假设检验方法为这些复杂问题提供了更灵活和可靠的解决方案。</p>
<div id="群落多样性比较" class="section level3 hasAnchor" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> 群落多样性比较<a href="基于模拟的假设检验.html#群落多样性比较" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>生态学问题背景</strong>：群落多样性比较是生态学研究中最常见的问题之一。生态学家经常需要比较不同生境、不同处理或不同时间点的物种多样性。常用的多样性指数包括物种丰富度（物种数）、Shannon多样性指数、Simpson多样性指数等。然而，这些多样性指数的抽样分布通常未知，使得传统的参数检验方法难以适用。</p>
<p><strong>传统方法的局限性</strong>： - <strong>分布未知</strong>：大多数多样性指数没有已知的理论分布 - <strong>抽样效应</strong>：不同样本的抽样努力和覆盖度不同，影响多样性估计 - <strong>多重比较问题</strong>：同时比较多个群落时，传统方法难以处理多重比较校正 - <strong>小样本问题</strong>：在稀有物种或小样本情况下，参数检验的假设往往不成立</p>
<p><strong>基于模拟的解决方案</strong>：自助法和置换检验为群落多样性比较提供了强大的替代方法。自助法通过重抽样来估计多样性指数的抽样分布和置信区间，而置换检验通过随机化来检验多样性差异的显著性。</p>
<p><strong>生态学实例：森林恢复对鸟类多样性的影响评估</strong></p>
<p>假设我们研究不同恢复年限的人工林对鸟类多样性的影响。我们在三种林分中设置样线调查： - 5年恢复林：调查到15种鸟类 - 10年恢复林：调查到22种鸟类 - 原生林（对照）：调查到28种鸟类</p>
<p>我们不仅关心物种丰富度的差异，还希望比较Shannon多样性指数的差异。由于鸟类调查存在抽样变异，我们需要评估这些差异是否具有统计显著性。</p>
<p><strong>自助法检验过程</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>生成自助样本</strong>：对每个林分的观测数据进行有放回重抽样</li>
<li><strong>计算多样性指数</strong>：对每个自助样本计算Shannon多样性指数</li>
<li><strong>构建置信区间</strong>：基于自助分布构建95%置信区间</li>
<li><strong>比较差异</strong>：通过置信区间的重叠情况判断差异显著性</li>
</ol>
<p><strong>R语言实现示例</strong>：</p>
<p>首先，我们准备模拟的鸟类调查数据：</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="基于模拟的假设检验.html#cb800-1" tabindex="-1"></a><span class="co"># 群落多样性比较：数据准备</span></span>
<span id="cb800-2"><a href="基于模拟的假设检验.html#cb800-2" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb800-3"><a href="基于模拟的假设检验.html#cb800-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb800-4"><a href="基于模拟的假设检验.html#cb800-4" tabindex="-1"></a></span>
<span id="cb800-5"><a href="基于模拟的假设检验.html#cb800-5" tabindex="-1"></a><span class="co"># 模拟5年恢复林鸟类调查数据</span></span>
<span id="cb800-6"><a href="基于模拟的假设检验.html#cb800-6" tabindex="-1"></a>forest_5yr <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb800-7"><a href="基于模拟的假设检验.html#cb800-7" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种1&quot;</span>, <span class="dv">8</span>), <span class="fu">rep</span>(<span class="st">&quot;物种2&quot;</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">&quot;物种3&quot;</span>, <span class="dv">3</span>),</span>
<span id="cb800-8"><a href="基于模拟的假设检验.html#cb800-8" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种4&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;物种5&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种6&quot;</span>, <span class="dv">1</span>),</span>
<span id="cb800-9"><a href="基于模拟的假设检验.html#cb800-9" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种7&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种8&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种9&quot;</span>, <span class="dv">1</span>),</span>
<span id="cb800-10"><a href="基于模拟的假设检验.html#cb800-10" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种10&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种11&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种12&quot;</span>, <span class="dv">1</span>),</span>
<span id="cb800-11"><a href="基于模拟的假设检验.html#cb800-11" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种13&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种14&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种15&quot;</span>, <span class="dv">1</span>)</span>
<span id="cb800-12"><a href="基于模拟的假设检验.html#cb800-12" tabindex="-1"></a>)</span>
<span id="cb800-13"><a href="基于模拟的假设检验.html#cb800-13" tabindex="-1"></a></span>
<span id="cb800-14"><a href="基于模拟的假设检验.html#cb800-14" tabindex="-1"></a><span class="co"># 模拟10年恢复林鸟类调查数据</span></span>
<span id="cb800-15"><a href="基于模拟的假设检验.html#cb800-15" tabindex="-1"></a>forest_10yr <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb800-16"><a href="基于模拟的假设检验.html#cb800-16" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种1&quot;</span>, <span class="dv">12</span>), <span class="fu">rep</span>(<span class="st">&quot;物种2&quot;</span>, <span class="dv">8</span>), <span class="fu">rep</span>(<span class="st">&quot;物种3&quot;</span>, <span class="dv">6</span>),</span>
<span id="cb800-17"><a href="基于模拟的假设检验.html#cb800-17" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种4&quot;</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">&quot;物种5&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;物种6&quot;</span>, <span class="dv">2</span>),</span>
<span id="cb800-18"><a href="基于模拟的假设检验.html#cb800-18" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种7&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;物种8&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;物种9&quot;</span>, <span class="dv">2</span>),</span>
<span id="cb800-19"><a href="基于模拟的假设检验.html#cb800-19" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种10&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;物种11&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种12&quot;</span>, <span class="dv">1</span>),</span>
<span id="cb800-20"><a href="基于模拟的假设检验.html#cb800-20" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种13&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种14&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种15&quot;</span>, <span class="dv">1</span>),</span>
<span id="cb800-21"><a href="基于模拟的假设检验.html#cb800-21" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种16&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种17&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种18&quot;</span>, <span class="dv">1</span>),</span>
<span id="cb800-22"><a href="基于模拟的假设检验.html#cb800-22" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种19&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种20&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种21&quot;</span>, <span class="dv">1</span>),</span>
<span id="cb800-23"><a href="基于模拟的假设检验.html#cb800-23" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种22&quot;</span>, <span class="dv">1</span>)</span>
<span id="cb800-24"><a href="基于模拟的假设检验.html#cb800-24" tabindex="-1"></a>)</span>
<span id="cb800-25"><a href="基于模拟的假设检验.html#cb800-25" tabindex="-1"></a></span>
<span id="cb800-26"><a href="基于模拟的假设检验.html#cb800-26" tabindex="-1"></a><span class="co"># 模拟原生林鸟类调查数据</span></span>
<span id="cb800-27"><a href="基于模拟的假设检验.html#cb800-27" tabindex="-1"></a>primary_forest <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb800-28"><a href="基于模拟的假设检验.html#cb800-28" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种1&quot;</span>, <span class="dv">15</span>), <span class="fu">rep</span>(<span class="st">&quot;物种2&quot;</span>, <span class="dv">10</span>), <span class="fu">rep</span>(<span class="st">&quot;物种3&quot;</span>, <span class="dv">8</span>),</span>
<span id="cb800-29"><a href="基于模拟的假设检验.html#cb800-29" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种4&quot;</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="st">&quot;物种5&quot;</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">&quot;物种6&quot;</span>, <span class="dv">4</span>),</span>
<span id="cb800-30"><a href="基于模拟的假设检验.html#cb800-30" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种7&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;物种8&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;物种9&quot;</span>, <span class="dv">2</span>),</span>
<span id="cb800-31"><a href="基于模拟的假设检验.html#cb800-31" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种10&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;物种11&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;物种12&quot;</span>, <span class="dv">2</span>),</span>
<span id="cb800-32"><a href="基于模拟的假设检验.html#cb800-32" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种13&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种14&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种15&quot;</span>, <span class="dv">1</span>),</span>
<span id="cb800-33"><a href="基于模拟的假设检验.html#cb800-33" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种16&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种17&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种18&quot;</span>, <span class="dv">1</span>),</span>
<span id="cb800-34"><a href="基于模拟的假设检验.html#cb800-34" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种19&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种20&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种21&quot;</span>, <span class="dv">1</span>),</span>
<span id="cb800-35"><a href="基于模拟的假设检验.html#cb800-35" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种22&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种23&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种24&quot;</span>, <span class="dv">1</span>),</span>
<span id="cb800-36"><a href="基于模拟的假设检验.html#cb800-36" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种25&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种26&quot;</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">&quot;物种27&quot;</span>, <span class="dv">1</span>),</span>
<span id="cb800-37"><a href="基于模拟的假设检验.html#cb800-37" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">&quot;物种28&quot;</span>, <span class="dv">1</span>)</span>
<span id="cb800-38"><a href="基于模拟的假设检验.html#cb800-38" tabindex="-1"></a>)</span>
<span id="cb800-39"><a href="基于模拟的假设检验.html#cb800-39" tabindex="-1"></a></span>
<span id="cb800-40"><a href="基于模拟的假设检验.html#cb800-40" tabindex="-1"></a><span class="co"># 输出各林分物种数统计</span></span>
<span id="cb800-41"><a href="基于模拟的假设检验.html#cb800-41" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;各林分物种丰富度统计：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 各林分物种丰富度统计：</code></pre>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="基于模拟的假设检验.html#cb802-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;5年恢复林物种数:&quot;</span>, <span class="fu">length</span>(<span class="fu">unique</span>(forest_5yr)), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 5年恢复林物种数: 15</code></pre>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="基于模拟的假设检验.html#cb804-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;10年恢复林物种数:&quot;</span>, <span class="fu">length</span>(<span class="fu">unique</span>(forest_10yr)), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 10年恢复林物种数: 22</code></pre>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="基于模拟的假设检验.html#cb806-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;原生林物种数:&quot;</span>, <span class="fu">length</span>(<span class="fu">unique</span>(primary_forest)), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 原生林物种数: 28</code></pre>
<p>接下来，我们定义自助法函数并进行多样性估计：</p>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="基于模拟的假设检验.html#cb808-1" tabindex="-1"></a><span class="co"># 群落多样性比较：定义自助法函数</span></span>
<span id="cb808-2"><a href="基于模拟的假设检验.html#cb808-2" tabindex="-1"></a>bootstrap_diversity <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">n_boot =</span> <span class="dv">1000</span>) {</span>
<span id="cb808-3"><a href="基于模拟的假设检验.html#cb808-3" tabindex="-1"></a>  boot_diversity <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_boot)</span>
<span id="cb808-4"><a href="基于模拟的假设检验.html#cb808-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_boot) {</span>
<span id="cb808-5"><a href="基于模拟的假设检验.html#cb808-5" tabindex="-1"></a>    <span class="co"># 有放回重抽样</span></span>
<span id="cb808-6"><a href="基于模拟的假设检验.html#cb808-6" tabindex="-1"></a>    boot_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(data, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb808-7"><a href="基于模拟的假设检验.html#cb808-7" tabindex="-1"></a>    <span class="co"># 计算物种频率表</span></span>
<span id="cb808-8"><a href="基于模拟的假设检验.html#cb808-8" tabindex="-1"></a>    species_table <span class="ot">&lt;-</span> <span class="fu">table</span>(boot_sample)</span>
<span id="cb808-9"><a href="基于模拟的假设检验.html#cb808-9" tabindex="-1"></a>    <span class="co"># 计算Shannon多样性指数</span></span>
<span id="cb808-10"><a href="基于模拟的假设检验.html#cb808-10" tabindex="-1"></a>    boot_diversity[i] <span class="ot">&lt;-</span> vegan<span class="sc">::</span><span class="fu">diversity</span>(species_table, <span class="at">index =</span> <span class="st">&quot;shannon&quot;</span>)</span>
<span id="cb808-11"><a href="基于模拟的假设检验.html#cb808-11" tabindex="-1"></a>  }</span>
<span id="cb808-12"><a href="基于模拟的假设检验.html#cb808-12" tabindex="-1"></a>  <span class="fu">return</span>(boot_diversity)</span>
<span id="cb808-13"><a href="基于模拟的假设检验.html#cb808-13" tabindex="-1"></a>}</span>
<span id="cb808-14"><a href="基于模拟的假设检验.html#cb808-14" tabindex="-1"></a></span>
<span id="cb808-15"><a href="基于模拟的假设检验.html#cb808-15" tabindex="-1"></a><span class="co"># 执行自助法分析</span></span>
<span id="cb808-16"><a href="基于模拟的假设检验.html#cb808-16" tabindex="-1"></a>boot_5yr <span class="ot">&lt;-</span> <span class="fu">bootstrap_diversity</span>(forest_5yr)</span>
<span id="cb808-17"><a href="基于模拟的假设检验.html#cb808-17" tabindex="-1"></a>boot_10yr <span class="ot">&lt;-</span> <span class="fu">bootstrap_diversity</span>(forest_10yr)</span>
<span id="cb808-18"><a href="基于模拟的假设检验.html#cb808-18" tabindex="-1"></a>boot_primary <span class="ot">&lt;-</span> <span class="fu">bootstrap_diversity</span>(primary_forest)</span></code></pre></div>
<p>最后，我们计算置信区间并输出结果：</p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="基于模拟的假设检验.html#cb809-1" tabindex="-1"></a><span class="co"># 群落多样性比较：结果计算和输出</span></span>
<span id="cb809-2"><a href="基于模拟的假设检验.html#cb809-2" tabindex="-1"></a><span class="co"># 计算95%置信区间</span></span>
<span id="cb809-3"><a href="基于模拟的假设检验.html#cb809-3" tabindex="-1"></a>ci_5yr <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_5yr, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb809-4"><a href="基于模拟的假设检验.html#cb809-4" tabindex="-1"></a>ci_10yr <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_10yr, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb809-5"><a href="基于模拟的假设检验.html#cb809-5" tabindex="-1"></a>ci_primary <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_primary, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb809-6"><a href="基于模拟的假设检验.html#cb809-6" tabindex="-1"></a></span>
<span id="cb809-7"><a href="基于模拟的假设检验.html#cb809-7" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb809-8"><a href="基于模拟的假设检验.html#cb809-8" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb809-9"><a href="基于模拟的假设检验.html#cb809-9" tabindex="-1"></a>  <span class="st">&quot;5年恢复林 Shannon多样性: &quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(boot_5yr), <span class="dv">3</span>),</span>
<span id="cb809-10"><a href="基于模拟的假设检验.html#cb809-10" tabindex="-1"></a>  <span class="st">&quot; 95%CI:[&quot;</span>, <span class="fu">round</span>(ci_5yr[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>, <span class="fu">round</span>(ci_5yr[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb809-11"><a href="基于模拟的假设检验.html#cb809-11" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 5年恢复林 Shannon多样性:  2.081  95%CI:[ 1.675 , 2.394 ]</code></pre>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="基于模拟的假设检验.html#cb811-1" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb811-2"><a href="基于模拟的假设检验.html#cb811-2" tabindex="-1"></a>  <span class="st">&quot;10年恢复林 Shannon多样性: &quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(boot_10yr), <span class="dv">3</span>),</span>
<span id="cb811-3"><a href="基于模拟的假设检验.html#cb811-3" tabindex="-1"></a>  <span class="st">&quot; 95%CI:[&quot;</span>, <span class="fu">round</span>(ci_10yr[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>, <span class="fu">round</span>(ci_10yr[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb811-4"><a href="基于模拟的假设检验.html#cb811-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 10年恢复林 Shannon多样性:  2.459  95%CI:[ 2.187 , 2.702 ]</code></pre>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="基于模拟的假设检验.html#cb813-1" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb813-2"><a href="基于模拟的假设检验.html#cb813-2" tabindex="-1"></a>  <span class="st">&quot;原生林 Shannon多样性: &quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(boot_primary), <span class="dv">3</span>),</span>
<span id="cb813-3"><a href="基于模拟的假设检验.html#cb813-3" tabindex="-1"></a>  <span class="st">&quot; 95%CI:[&quot;</span>, <span class="fu">round</span>(ci_primary[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">&quot;,&quot;</span>, <span class="fu">round</span>(ci_primary[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb813-4"><a href="基于模拟的假设检验.html#cb813-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 原生林 Shannon多样性:  2.67  95%CI:[ 2.433 , 2.894 ]</code></pre>
<p><strong>生态学意义</strong>：通过自助法构建的置信区间，我们可以更可靠地评估不同恢复阶段林分的鸟类多样性差异。如果置信区间不重叠，表明多样性差异具有统计显著性。这种分析为森林恢复效果评估提供了量化依据，有助于优化恢复策略和时间规划。</p>
</div>
<div id="相似性分析anosim" class="section level3 hasAnchor" number="7.7.2">
<h3><span class="header-section-number">7.7.2</span> 相似性分析（ANOSIM）<a href="基于模拟的假设检验.html#相似性分析anosim" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>生态学问题背景</strong>：ANOSIM（Analysis of Similarities）是一种基于距离矩阵的非参数检验方法，专门用于检验群落组成的组间差异。在生态学中，我们经常需要比较不同处理、不同生境或不同时间点的群落组成是否显著不同。</p>
<p><strong>传统方法的挑战</strong>：传统的多元方差分析（MANOVA）要求数据满足多元正态性和方差-协方差矩阵齐性等严格假设，这些假设在群落数据中往往不成立。群落数据通常是多变量的、非正态的，且存在大量的零值。</p>
<p><strong>基于模拟的优势</strong>：ANOSIM通过置换检验来构建R统计量的零分布，不依赖于数据的分布假设，特别适合处理： - 多变量群落数据 - 非正态分布数据 - 存在大量零值的数据 - 复杂的实验设计</p>
<p><strong>生态学实例：污染对底栖动物群落的影响研究</strong></p>
<p>假设我们研究工业废水排放对河流底栖动物群落的影响。我们在三个河段设置采样点： - 上游清洁区（5个样点） - 排放口附近（5个样点） - 下游恢复区（5个样点）</p>
<p>我们在每个样点采集底栖动物，鉴定到种级，获得物种丰度数据。我们想要检验这三个河段的底栖动物群落组成是否存在显著差异。</p>
<p><strong>ANOSIM检验过程</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>计算距离矩阵</strong>：使用Bray-Curtis距离或其他合适的生态距离</li>
<li><strong>计算观测R统计量</strong>：R统计量衡量组间差异与组内差异的相对大小</li>
<li><strong>随机置换</strong>：随机重排样点的组别标签</li>
<li><strong>构建零分布</strong>：重复置换1000次，每次计算R统计量</li>
<li><strong>计算p值</strong>：比较观测R统计量与零分布的位置</li>
</ol>
<p><strong>R语言实现示例</strong>：</p>
<p>下面的代码展示了ANOSIM分析的具体实现过程。首先我们模拟底栖动物群落数据并执行分析：</p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="基于模拟的假设检验.html#cb815-1" tabindex="-1"></a><span class="co"># ANOSIM分析：污染对底栖动物群落的影响</span></span>
<span id="cb815-2"><a href="基于模拟的假设检验.html#cb815-2" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb815-3"><a href="基于模拟的假设检验.html#cb815-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb815-4"><a href="基于模拟的假设检验.html#cb815-4" tabindex="-1"></a></span>
<span id="cb815-5"><a href="基于模拟的假设检验.html#cb815-5" tabindex="-1"></a><span class="co"># 模拟底栖动物群落数据</span></span>
<span id="cb815-6"><a href="基于模拟的假设检验.html#cb815-6" tabindex="-1"></a><span class="co"># 创建物种丰度矩阵（15个样点 × 20个物种）</span></span>
<span id="cb815-7"><a href="基于模拟的假设检验.html#cb815-7" tabindex="-1"></a>species_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">15</span>, <span class="at">ncol =</span> <span class="dv">20</span>)</span>
<span id="cb815-8"><a href="基于模拟的假设检验.html#cb815-8" tabindex="-1"></a><span class="fu">rownames</span>(species_matrix) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;样点&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>)</span>
<span id="cb815-9"><a href="基于模拟的假设检验.html#cb815-9" tabindex="-1"></a><span class="fu">colnames</span>(species_matrix) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;物种&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb815-10"><a href="基于模拟的假设检验.html#cb815-10" tabindex="-1"></a></span>
<span id="cb815-11"><a href="基于模拟的假设检验.html#cb815-11" tabindex="-1"></a><span class="co"># 上游清洁区（物种丰富，分布均匀）</span></span>
<span id="cb815-12"><a href="基于模拟的假设检验.html#cb815-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb815-13"><a href="基于模拟的假设检验.html#cb815-13" tabindex="-1"></a>  species_matrix[i, ] <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">20</span>, <span class="at">lambda =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">5</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">3</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>)))</span>
<span id="cb815-14"><a href="基于模拟的假设检验.html#cb815-14" tabindex="-1"></a>}</span>
<span id="cb815-15"><a href="基于模拟的假设检验.html#cb815-15" tabindex="-1"></a></span>
<span id="cb815-16"><a href="基于模拟的假设检验.html#cb815-16" tabindex="-1"></a><span class="co"># 排放口附近（物种贫乏，耐污种占优势）</span></span>
<span id="cb815-17"><a href="基于模拟的假设检验.html#cb815-17" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb815-18"><a href="基于模拟的假设检验.html#cb815-18" tabindex="-1"></a>  species_matrix[i, ] <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">20</span>, <span class="at">lambda =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">8</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="dv">15</span>)))</span>
<span id="cb815-19"><a href="基于模拟的假设检验.html#cb815-19" tabindex="-1"></a>}</span>
<span id="cb815-20"><a href="基于模拟的假设检验.html#cb815-20" tabindex="-1"></a></span>
<span id="cb815-21"><a href="基于模拟的假设检验.html#cb815-21" tabindex="-1"></a><span class="co"># 下游恢复区（中等恢复）</span></span>
<span id="cb815-22"><a href="基于模拟的假设检验.html#cb815-22" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">15</span>) {</span>
<span id="cb815-23"><a href="基于模拟的假设检验.html#cb815-23" tabindex="-1"></a>  species_matrix[i, ] <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">20</span>, <span class="at">lambda =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">4</span>, <span class="dv">8</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">12</span>)))</span>
<span id="cb815-24"><a href="基于模拟的假设检验.html#cb815-24" tabindex="-1"></a>}</span>
<span id="cb815-25"><a href="基于模拟的假设检验.html#cb815-25" tabindex="-1"></a></span>
<span id="cb815-26"><a href="基于模拟的假设检验.html#cb815-26" tabindex="-1"></a><span class="co"># 分组变量</span></span>
<span id="cb815-27"><a href="基于模拟的假设检验.html#cb815-27" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;上游清洁区&quot;</span>, <span class="st">&quot;排放口附近&quot;</span>, <span class="st">&quot;下游恢复区&quot;</span>), <span class="at">each =</span> <span class="dv">5</span>))</span>
<span id="cb815-28"><a href="基于模拟的假设检验.html#cb815-28" tabindex="-1"></a></span>
<span id="cb815-29"><a href="基于模拟的假设检验.html#cb815-29" tabindex="-1"></a><span class="co"># 执行ANOSIM分析</span></span>
<span id="cb815-30"><a href="基于模拟的假设检验.html#cb815-30" tabindex="-1"></a>anosim_result <span class="ot">&lt;-</span> <span class="fu">anosim</span>(species_matrix, groups, <span class="at">distance =</span> <span class="st">&quot;bray&quot;</span>, <span class="at">permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb815-31"><a href="基于模拟的假设检验.html#cb815-31" tabindex="-1"></a></span>
<span id="cb815-32"><a href="基于模拟的假设检验.html#cb815-32" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb815-33"><a href="基于模拟的假设检验.html#cb815-33" tabindex="-1"></a><span class="fu">print</span>(anosim_result)</span></code></pre></div>
<pre><code>## 
## Call:
## anosim(x = species_matrix, grouping = groups, permutations = 1000,      distance = &quot;bray&quot;) 
## Dissimilarity: bray 
## 
## ANOSIM statistic R: 0.7102 
##       Significance: 0.000999 
## 
## Permutation: free
## Number of permutations: 1000</code></pre>
<p>图<a href="基于模拟的假设检验.html#fig:anosim-rank-plot">7.1</a>展示了ANOSIM分析的排序差异箱线图：</p>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="基于模拟的假设检验.html#cb817-1" tabindex="-1"></a><span class="co"># 可视化ANOSIM结果</span></span>
<span id="cb817-2"><a href="基于模拟的假设检验.html#cb817-2" tabindex="-1"></a><span class="fu">plot</span>(anosim_result, <span class="at">main =</span> <span class="st">&quot;ANOSIM分析：不同河段底栖动物群落差异&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:anosim-rank-plot"></span>
<img src="07-simulation_based_tests_files/figure-html/anosim-rank-plot-1.png" alt="ANOSIM分析：不同河段底栖动物群落排序差异检验" width="672" />
<p class="caption">
图7.1: ANOSIM分析：不同河段底栖动物群落排序差异检验
</p>
</div>
<p>图<a href="基于模拟的假设检验.html#fig:nmds-community-plot">7.2</a>展示了底栖动物群落组成的NMDS排序图：</p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="基于模拟的假设检验.html#cb818-1" tabindex="-1"></a><span class="co"># 补充分析：群落组成排序图</span></span>
<span id="cb818-2"><a href="基于模拟的假设检验.html#cb818-2" tabindex="-1"></a>nmds_result <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(species_matrix, <span class="at">distance =</span> <span class="st">&quot;bray&quot;</span>)</span></code></pre></div>
<pre><code>## Wisconsin double standardization
## Run 0 stress 0.1618011 
## Run 1 stress 0.1678915 
## Run 2 stress 0.1678915 
## Run 3 stress 0.1630338 
## Run 4 stress 0.1724275 
## Run 5 stress 0.1698024 
## Run 6 stress 0.1665195 
## Run 7 stress 0.1723473 
## Run 8 stress 0.1667996 
## Run 9 stress 0.1692174 
## Run 10 stress 0.1637253 
## Run 11 stress 0.1659473 
## Run 12 stress 0.1686562 
## Run 13 stress 0.1698033 
## Run 14 stress 0.1706665 
## Run 15 stress 0.1646155 
## Run 16 stress 0.1951268 
## Run 17 stress 0.1618011 
## ... Procrustes: rmse 2.279223e-05  max resid 4.598501e-05 
## ... Similar to previous best
## Run 18 stress 0.169443 
## Run 19 stress 0.1686562 
## Run 20 stress 0.1618011 
## ... Procrustes: rmse 2.53791e-05  max resid 4.811224e-05 
## ... Similar to previous best
## *** Best solution repeated 2 times</code></pre>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="基于模拟的假设检验.html#cb820-1" tabindex="-1"></a><span class="fu">plot</span>(nmds_result, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;底栖动物群落NMDS排序&quot;</span>)</span>
<span id="cb820-2"><a href="基于模拟的假设检验.html#cb820-2" tabindex="-1"></a><span class="fu">points</span>(nmds_result, <span class="at">col =</span> <span class="fu">as.numeric</span>(groups), <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb820-3"><a href="基于模拟的假设检验.html#cb820-3" tabindex="-1"></a><span class="fu">ordiellipse</span>(nmds_result, groups, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb820-4"><a href="基于模拟的假设检验.html#cb820-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">levels</span>(groups), <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:nmds-community-plot"></span>
<img src="07-simulation_based_tests_files/figure-html/nmds-community-plot-1.png" alt="底栖动物群落组成的NMDS排序分析" width="672" />
<p class="caption">
图7.2: 底栖动物群落组成的NMDS排序分析
</p>
</div>
<p><strong>结果解释</strong>： - <strong>R统计量</strong>：取值范围-1到1，值越大表示组间差异越明显 - <strong>p值</strong>：检验组间差异的统计显著性 - <strong>典型解读</strong>：R &gt; 0.75表示组间分离很好；R &gt; 0.5表示组间分离明显；R &gt; 0.25表示组间存在分离趋势</p>
<p><strong>生态学意义</strong>：如果ANOSIM检验显示显著差异（p &lt; 0.05），表明工业废水排放确实对底栖动物群落组成产生了显著影响。结合R统计量的大小，我们可以量化这种影响的程度。这种分析为环境管理和污染控制提供了科学依据，有助于确定保护优先区和恢复目标。</p>
</div>
<div id="方法学比较与生态学应用建议" class="section level3 hasAnchor" number="7.7.3">
<h3><span class="header-section-number">7.7.3</span> 方法学比较与生态学应用建议<a href="基于模拟的假设检验.html#方法学比较与生态学应用建议" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>多样性比较方法的选择策略</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>单一多样性指数比较</strong>：
<ul>
<li><strong>小样本情况</strong>：优先使用自助法构建置信区间</li>
<li><strong>大样本情况</strong>：可考虑参数检验，但需验证分布假设</li>
<li><strong>多重比较</strong>：使用自助法结合FDR控制</li>
</ul></li>
<li><strong>群落组成差异检验</strong>：
<ul>
<li><strong>组数=2</strong>：考虑使用置换t检验或ANOSIM</li>
<li><strong>组数&gt;2</strong>：ANOSIM或PERMANOVA（置换多元方差分析）</li>
<li><strong>复杂设计</strong>：使用adonis2()函数进行置换MANOVA</li>
</ul></li>
<li><strong>空间和时间序列分析</strong>：
<ul>
<li><strong>空间自相关</strong>：使用Moran’s I置换检验</li>
<li><strong>时间趋势</strong>：使用Mantel检验或时序置换检验</li>
</ul></li>
</ol>
<p><strong>生态学研究的最佳实践</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>样本量规划</strong>：在进行多样性研究前，通过功效分析确定合适的样本量</li>
<li><strong>多重比较校正</strong>：当进行多个多样性指数或多个组间比较时，使用适当的校正方法</li>
<li><strong>结果可视化</strong>：结合排序图、多样性曲线等可视化方法，增强结果的可解释性</li>
<li><strong>生态学解释</strong>：统计显著性必须结合生态学机制进行解释，避免过度依赖p值</li>
</ol>
<p><strong>保护生物学应用</strong>：在保护生物学中，基于模拟的多样性检验方法特别有价值： - <strong>濒危物种监测</strong>：小样本情况下的可靠性评估 - <strong>保护效果评估</strong>：比较保护区内外的生物多样性 - <strong>恢复生态学</strong>：评估生态恢复项目的成效 - <strong>气候变化研究</strong>：监测物种组成对气候变化的响应</p>
<p>通过这些基于模拟的统计方法，生态学家能够更可靠地评估生物多样性的变化模式，为生态保护和管理决策提供坚实的科学基础。</p>
</div>
</div>
<div id="物种空间分布检验" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> 物种空间分布检验<a href="基于模拟的假设检验.html#物种空间分布检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>物种空间分布检验是空间生态学和景观生态学中的核心统计问题。基于模拟的假设检验方法在这些领域具有不可替代的价值，因为大多数空间统计量没有已知的理论分布，必须通过蒙特卡洛模拟来构建零分布和进行统计推断。</p>
<div id="空间分布模式检验" class="section level3 hasAnchor" number="7.8.1">
<h3><span class="header-section-number">7.8.1</span> 空间分布模式检验<a href="基于模拟的假设检验.html#空间分布模式检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>生态学问题背景</strong>：理解物种在空间中的分布模式是生态学的基本问题。物种可能呈现三种基本的空间分布模式：随机分布、聚集分布和均匀分布。这些分布模式反映了物种的生态学特性、种内种间关系以及环境异质性的影响。</p>
<p><strong>传统方法的局限性</strong>：传统的空间分布检验方法往往依赖于严格的数学假设，如： - 空间独立性假设 - 均匀生境假设 - 大样本渐近分布 这些假设在真实的生态系统中往往不成立，特别是在存在环境梯度、边界效应和空间自相关的情况下。</p>
<p><strong>基于模拟的优势</strong>：蒙特卡洛模拟通过随机化过程构建空间统计量的经验分布，能够： - 考虑复杂的边界条件 - 处理空间自相关问题 - 适应异质性生境 - 提供小样本下的可靠推断</p>
<p><strong>生态学实例：热带雨林树种空间分布格局研究</strong></p>
<p>假设我们在巴西亚马逊雨林中设置一个1公顷的固定样地，标记了所有胸径大于10厘米的树木，并记录了它们的坐标。我们关注某个优势树种——巴西坚果树的分布模式，想要检验其分布是否显著偏离随机模式。</p>
<p>观测数据：在1公顷样地中记录了85棵巴西坚果树的空间坐标。</p>
<p><strong>完全空间随机性（CSR）检验过程</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>构建零模型</strong>：假设树木分布遵循完全空间随机过程</li>
<li><strong>生成模拟点模式</strong>：在相同的样地边界内随机生成85个点</li>
<li><strong>计算空间统计量</strong>：使用Ripley’s K函数或其他空间统计量</li>
<li><strong>重复模拟</strong>：进行999次蒙特卡洛模拟</li>
<li><strong>构建包络线</strong>：基于模拟结果构建统计量的置信包络</li>
<li><strong>比较观测模式</strong>：检验观测统计量是否超出包络范围</li>
</ol>
<p><strong>R语言实现示例</strong>：</p>
<p>下面的代码展示了空间分布模式检验的具体实现过程（图<a href="基于模拟的假设检验.html#fig:ripley-k-envelope">7.3</a>）：</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="基于模拟的假设检验.html#cb821-1" tabindex="-1"></a><span class="co"># 物种空间分布模式的蒙特卡洛检验</span></span>
<span id="cb821-2"><a href="基于模拟的假设检验.html#cb821-2" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb821-3"><a href="基于模拟的假设检验.html#cb821-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb821-4"><a href="基于模拟的假设检验.html#cb821-4" tabindex="-1"></a></span>
<span id="cb821-5"><a href="基于模拟的假设检验.html#cb821-5" tabindex="-1"></a><span class="co"># 创建观测点模式（简化示例）</span></span>
<span id="cb821-6"><a href="基于模拟的假设检验.html#cb821-6" tabindex="-1"></a><span class="co"># 假设在100m×100m的样地中有85棵树</span></span>
<span id="cb821-7"><a href="基于模拟的假设检验.html#cb821-7" tabindex="-1"></a>observed_pattern <span class="ot">&lt;-</span> <span class="fu">ppp</span>(</span>
<span id="cb821-8"><a href="基于模拟的假设检验.html#cb821-8" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">85</span>, <span class="dv">0</span>, <span class="dv">100</span>), <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">85</span>, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb821-9"><a href="基于模拟的假设检验.html#cb821-9" tabindex="-1"></a>  <span class="at">window =</span> <span class="fu">owin</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>))</span>
<span id="cb821-10"><a href="基于模拟的假设检验.html#cb821-10" tabindex="-1"></a>)</span>
<span id="cb821-11"><a href="基于模拟的假设检验.html#cb821-11" tabindex="-1"></a></span>
<span id="cb821-12"><a href="基于模拟的假设检验.html#cb821-12" tabindex="-1"></a><span class="co"># 计算观测Ripley&#39;s K函数</span></span>
<span id="cb821-13"><a href="基于模拟的假设检验.html#cb821-13" tabindex="-1"></a>obs_K <span class="ot">&lt;-</span> <span class="fu">Kest</span>(observed_pattern, <span class="at">correction =</span> <span class="st">&quot;border&quot;</span>)</span>
<span id="cb821-14"><a href="基于模拟的假设检验.html#cb821-14" tabindex="-1"></a></span>
<span id="cb821-15"><a href="基于模拟的假设检验.html#cb821-15" tabindex="-1"></a><span class="co"># 蒙特卡洛模拟：完全空间随机性</span></span>
<span id="cb821-16"><a href="基于模拟的假设检验.html#cb821-16" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb821-17"><a href="基于模拟的假设检验.html#cb821-17" tabindex="-1"></a>sim_patterns <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb821-18"><a href="基于模拟的假设检验.html#cb821-18" tabindex="-1"></a>sim_K <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb821-19"><a href="基于模拟的假设检验.html#cb821-19" tabindex="-1"></a></span>
<span id="cb821-20"><a href="基于模拟的假设检验.html#cb821-20" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb821-21"><a href="基于模拟的假设检验.html#cb821-21" tabindex="-1"></a>  <span class="co"># 生成完全空间随机点模式</span></span>
<span id="cb821-22"><a href="基于模拟的假设检验.html#cb821-22" tabindex="-1"></a>  sim_pattern <span class="ot">&lt;-</span> <span class="fu">rpoispp</span>(<span class="dv">85</span> <span class="sc">/</span> <span class="dv">10000</span>, <span class="at">win =</span> observed_pattern<span class="sc">$</span>window)</span>
<span id="cb821-23"><a href="基于模拟的假设检验.html#cb821-23" tabindex="-1"></a>  sim_patterns[[i]] <span class="ot">&lt;-</span> sim_pattern</span>
<span id="cb821-24"><a href="基于模拟的假设检验.html#cb821-24" tabindex="-1"></a>  sim_K[[i]] <span class="ot">&lt;-</span> <span class="fu">Kest</span>(sim_pattern, <span class="at">correction =</span> <span class="st">&quot;border&quot;</span>)</span>
<span id="cb821-25"><a href="基于模拟的假设检验.html#cb821-25" tabindex="-1"></a>}</span>
<span id="cb821-26"><a href="基于模拟的假设检验.html#cb821-26" tabindex="-1"></a></span>
<span id="cb821-27"><a href="基于模拟的假设检验.html#cb821-27" tabindex="-1"></a><span class="co"># 构建包络线</span></span>
<span id="cb821-28"><a href="基于模拟的假设检验.html#cb821-28" tabindex="-1"></a>K_envelope <span class="ot">&lt;-</span> <span class="fu">envelope</span>(observed_pattern, Kest,</span>
<span id="cb821-29"><a href="基于模拟的假设检验.html#cb821-29" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">999</span>,</span>
<span id="cb821-30"><a href="基于模拟的假设检验.html#cb821-30" tabindex="-1"></a>  <span class="at">correction =</span> <span class="st">&quot;border&quot;</span>,</span>
<span id="cb821-31"><a href="基于模拟的假设检验.html#cb821-31" tabindex="-1"></a>  <span class="at">simulate =</span> <span class="fu">expression</span>(<span class="fu">rpoispp</span>(<span class="dv">85</span> <span class="sc">/</span> <span class="dv">10000</span>))</span>
<span id="cb821-32"><a href="基于模拟的假设检验.html#cb821-32" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Generating 999 simulations by evaluating expression  ...
## 1, 2, 3, ......10.........20.........30.........40.........50.........60..
## .......70.........80.........90.........100.........110.........120.........130
## .........140.........150.........160.........170.........180.........190........
## .200.........210.........220.........230.........240.........250.........260......
## ...270.........280.........290.........300.........310.........320.........330....
## .....340.........350.........360.........370.........380.........390.........400..
## .......410.........420.........430.........440.........450.........460.........470
## .........480.........490.........500.........510.........520.........530........
## .540.........550.........560.........570.........580.........590.........600......
## ...610.........620.........630.........640.........650.........660.........670....
## .....680.........690.........700.........710.........720.........730.........740..
## .......750.........760.........770.........780.........790.........800.........810
## .........820.........830.........840.........850.........860.........870........
## .880.........890.........900.........910.........920.........930.........940......
## ...950.........960.........970.........980.........990........
## 999.
## 
## Done.</code></pre>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="基于模拟的假设检验.html#cb823-1" tabindex="-1"></a><span class="co"># 可视化结果</span></span>
<span id="cb823-2"><a href="基于模拟的假设检验.html#cb823-2" tabindex="-1"></a><span class="fu">plot</span>(K_envelope,</span>
<span id="cb823-3"><a href="基于模拟的假设检验.html#cb823-3" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;巴西坚果树空间分布模式检验&quot;</span>,</span>
<span id="cb823-4"><a href="基于模拟的假设检验.html#cb823-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;距离 (m)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;K(r)&quot;</span>,</span>
<span id="cb823-5"><a href="基于模拟的假设检验.html#cb823-5" tabindex="-1"></a>  <span class="at">legend =</span> <span class="cn">FALSE</span></span>
<span id="cb823-6"><a href="基于模拟的假设检验.html#cb823-6" tabindex="-1"></a>)</span>
<span id="cb823-7"><a href="基于模拟的假设检验.html#cb823-7" tabindex="-1"></a></span>
<span id="cb823-8"><a href="基于模拟的假设检验.html#cb823-8" tabindex="-1"></a><span class="co"># 添加理论期望线（完全空间随机性）</span></span>
<span id="cb823-9"><a href="基于模拟的假设检验.html#cb823-9" tabindex="-1"></a><span class="fu">curve</span>(pi <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span>, <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">25</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb823-10"><a href="基于模拟的假设检验.html#cb823-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb823-11"><a href="基于模拟的假设检验.html#cb823-11" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;观测K函数&quot;</span>, <span class="st">&quot;模拟包络&quot;</span>, <span class="st">&quot;理论CSR&quot;</span>),</span>
<span id="cb823-12"><a href="基于模拟的假设检验.html#cb823-12" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb823-13"><a href="基于模拟的假设检验.html#cb823-13" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ripley-k-envelope"></span>
<img src="07-simulation_based_tests_files/figure-html/ripley-k-envelope-1.png" alt="巴西坚果树空间分布模式检验：Ripley's K函数包络分析" width="672" />
<p class="caption">
图7.3: 巴西坚果树空间分布模式检验：Ripley’s K函数包络分析
</p>
</div>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="基于模拟的假设检验.html#cb824-1" tabindex="-1"></a><span class="co"># 计算显著性</span></span>
<span id="cb824-2"><a href="基于模拟的假设检验.html#cb824-2" tabindex="-1"></a><span class="co"># 如果在某个距离范围内观测K函数超出包络，表明分布显著偏离随机</span></span></code></pre></div>
<p><strong>结果解释</strong>： - 如果观测K函数在包络线之上：表明空间聚集分布 - 如果观测K函数在包络线之下：表明空间均匀分布 - 如果观测K函数在包络线之内：不能拒绝随机分布假设</p>
<p><strong>生态学意义</strong>：如果检验显示巴西坚果树呈现显著的空间聚集分布，这可能反映了： - 种子散布限制（种子主要落在母树附近） - 微生境偏好（特定土壤或光照条件） - 种间相互作用（如与传粉者或种子散布者的关系） 这种空间分布信息对于理解物种的生态学特性、设计保护区和预测种群动态都具有重要意义。</p>
</div>
<div id="点过程模型检验" class="section level3 hasAnchor" number="7.8.2">
<h3><span class="header-section-number">7.8.2</span> 点过程模型检验<a href="基于模拟的假设检验.html#点过程模型检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>生态学问题背景</strong>：点过程模型为描述和分析空间点模式提供了系统的数学框架。在生态学中，我们不仅关心物种是否随机分布，更希望了解其分布的具体机制。点过程模型检验帮助我们评估观测数据与各种理论模型的拟合优度。</p>
<p><strong>传统方法的挑战</strong>：传统的模型拟合优度检验通常基于似然比检验或信息准则，但这些方法： - 依赖于大样本渐近理论 - 难以处理复杂的空间依赖性 - 对模型误设敏感</p>
<p><strong>基于模拟的优势</strong>：蒙特卡洛模拟通过从拟合模型中生成模拟数据来构建检验统计量的经验分布，能够： - 处理任何复杂的点过程模型 - 提供小样本下的可靠p值 - 检验模型的多方面拟合优度</p>
<p><strong>生态学实例：珊瑚礁鱼类栖息地选择机制研究</strong></p>
<p>假设我们研究印度洋珊瑚礁中某种珊瑚鱼——小丑鱼的分布模式。我们在一个珊瑚礁区域记录了小丑鱼个体的空间位置，同时测量了环境变量（珊瑚覆盖率、水深、水流速度）。我们想要检验小丑鱼的分布是否可以用环境异质性来解释。</p>
<p><strong>点过程模型检验过程</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>拟合点过程模型</strong>：使用泊松点过程模型或其他合适的模型</li>
<li><strong>计算拟合优度统计量</strong>：如残差、伪残差或其他诊断统计量</li>
<li><strong>生成模拟数据</strong>：从拟合模型中生成模拟点模式</li>
<li><strong>构建经验分布</strong>：基于模拟数据计算检验统计量</li>
<li><strong>比较观测值</strong>：检验观测统计量在经验分布中的位置</li>
</ol>
<p><strong>R语言实现示例</strong>：</p>
<p>下面的代码展示了点过程模型拟合优度检验的具体实现过程。首先我们模拟小丑鱼分布数据并拟合模型：</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="基于模拟的假设检验.html#cb825-1" tabindex="-1"></a><span class="co"># 点过程模型的蒙特卡洛拟合优度检验</span></span>
<span id="cb825-2"><a href="基于模拟的假设检验.html#cb825-2" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb825-3"><a href="基于模拟的假设检验.html#cb825-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb825-4"><a href="基于模拟的假设检验.html#cb825-4" tabindex="-1"></a></span>
<span id="cb825-5"><a href="基于模拟的假设检验.html#cb825-5" tabindex="-1"></a><span class="co"># 模拟小丑鱼分布数据</span></span>
<span id="cb825-6"><a href="基于模拟的假设检验.html#cb825-6" tabindex="-1"></a><span class="co"># 创建环境协变量（珊瑚覆盖率）</span></span>
<span id="cb825-7"><a href="基于模拟的假设检验.html#cb825-7" tabindex="-1"></a>coral_coverage <span class="ot">&lt;-</span> <span class="fu">as.im</span>(<span class="cf">function</span>(x, y) {</span>
<span id="cb825-8"><a href="基于模拟的假设检验.html#cb825-8" tabindex="-1"></a>  <span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>((x <span class="sc">-</span> <span class="dv">50</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (y <span class="sc">-</span> <span class="dv">50</span>)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">1000</span>) <span class="sc">+</span> <span class="fl">0.3</span></span>
<span id="cb825-9"><a href="基于模拟的假设检验.html#cb825-9" tabindex="-1"></a>}, <span class="at">W =</span> <span class="fu">owin</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)))</span>
<span id="cb825-10"><a href="基于模拟的假设检验.html#cb825-10" tabindex="-1"></a></span>
<span id="cb825-11"><a href="基于模拟的假设检验.html#cb825-11" tabindex="-1"></a><span class="co"># 生成基于环境的小丑鱼分布（非齐次泊松过程）</span></span>
<span id="cb825-12"><a href="基于模拟的假设检验.html#cb825-12" tabindex="-1"></a>lambda0 <span class="ot">&lt;-</span> <span class="fl">0.01</span> <span class="co"># 基础强度</span></span>
<span id="cb825-13"><a href="基于模拟的假设检验.html#cb825-13" tabindex="-1"></a>intensity <span class="ot">&lt;-</span> <span class="fu">eval.im</span>(lambda0 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> coral_coverage))</span>
<span id="cb825-14"><a href="基于模拟的假设检验.html#cb825-14" tabindex="-1"></a>observed_fish <span class="ot">&lt;-</span> <span class="fu">rpoispp</span>(intensity)</span>
<span id="cb825-15"><a href="基于模拟的假设检验.html#cb825-15" tabindex="-1"></a></span>
<span id="cb825-16"><a href="基于模拟的假设检验.html#cb825-16" tabindex="-1"></a><span class="co"># 拟合非齐次泊松点过程模型</span></span>
<span id="cb825-17"><a href="基于模拟的假设检验.html#cb825-17" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="fu">ppm</span>(observed_fish <span class="sc">~</span> coral_coverage)</span>
<span id="cb825-18"><a href="基于模拟的假设检验.html#cb825-18" tabindex="-1"></a><span class="fu">summary</span>(fit_model)</span></code></pre></div>
<pre><code>## Point process model
## Fitted to data: observed_fish
## Fitting method: maximum likelihood (Berman-Turner approximation)
## Model was fitted using glm()
## Algorithm converged
## Call:
## ppm.formula(Q = observed_fish ~ coral_coverage)
## Edge correction: &quot;border&quot;
##  [border correction distance r = 0 ]
## --------------------------------------------------------------------------------
## Quadrature scheme (Berman-Turner) = data + dummy + weights
## 
## Data pattern:
## Planar point pattern:  193 points
## Average intensity 0.0193 points per square unit
## Window: rectangle = [0, 100] x [0, 100] units
## Window area = 10000 square units
## 
## Dummy quadrature points:
##      32 x 32 grid of dummy points, plus 4 corner points
##      dummy spacing: 3.125 units
## 
## Original dummy parameters: =
## Planar point pattern:  1028 points
## Average intensity 0.103 points per square unit
## Window: rectangle = [0, 100] x [0, 100] units
## Window area = 10000 square units
## Quadrature weights:
##      (counting weights based on 32 x 32 array of rectangular tiles)
## All weights:
##  range: [3.26, 9.77] total: 10000
## Weights on data points:
##  range: [3.26, 4.88] total: 900
## Weights on dummy points:
##  range: [3.26, 9.77] total: 9100
## --------------------------------------------------------------------------------
## FITTED :
## 
## Nonstationary Poisson process
## 
## ---- Intensity: ----
## 
## Log intensity: ~coral_coverage
## Model depends on external covariate &#39;coral_coverage&#39;
## Covariates provided:
##  coral_coverage: im
## 
## Fitted trend coefficients:
##    (Intercept) coral_coverage 
##     -4.2767794      0.6330506 
## 
##                  Estimate      S.E.    CI95.lo   CI95.hi Ztest       Zval
## (Intercept)    -4.2767794 0.2117614 -4.6918241 -3.861735   *** -20.196218
## coral_coverage  0.6330506 0.3749223 -0.1017836  1.367885         1.688485
## 
## ----------- gory details -----
## 
## Fitted regular parameters (theta):
##    (Intercept) coral_coverage 
##     -4.2767794      0.6330506 
## 
## Fitted exp(theta):
##    (Intercept) coral_coverage 
##     0.01388732     1.88334717</code></pre>
<p>图<a href="基于模拟的假设检验.html#fig:coral-coverage-dist">7.4</a>展示了模拟的珊瑚覆盖率分布情况：</p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="基于模拟的假设检验.html#cb827-1" tabindex="-1"></a><span class="co"># 可视化珊瑚覆盖率分布</span></span>
<span id="cb827-2"><a href="基于模拟的假设检验.html#cb827-2" tabindex="-1"></a><span class="fu">plot</span>(coral_coverage, <span class="at">main =</span> <span class="st">&quot;珊瑚覆盖率分布&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:coral-coverage-dist"></span>
<img src="07-simulation_based_tests_files/figure-html/coral-coverage-dist-1.png" alt="模拟的珊瑚覆盖率空间分布" width="672" />
<p class="caption">
图7.4: 模拟的珊瑚覆盖率空间分布
</p>
</div>
<p>图<a href="基于模拟的假设检验.html#fig:fish-distribution-coral">7.5</a>展示了小丑鱼在珊瑚覆盖率背景下的实际分布：</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="基于模拟的假设检验.html#cb828-1" tabindex="-1"></a><span class="co"># 可视化小丑鱼在珊瑚覆盖率背景下的分布</span></span>
<span id="cb828-2"><a href="基于模拟的假设检验.html#cb828-2" tabindex="-1"></a><span class="fu">plot</span>(coral_coverage, <span class="at">main =</span> <span class="st">&quot;小丑鱼分布与珊瑚覆盖率&quot;</span>)</span>
<span id="cb828-3"><a href="基于模拟的假设检验.html#cb828-3" tabindex="-1"></a><span class="fu">plot</span>(observed_fish, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">cols =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fish-distribution-coral"></span>
<img src="07-simulation_based_tests_files/figure-html/fish-distribution-coral-1.png" alt="小丑鱼在珊瑚覆盖率背景下的空间分布" width="672" />
<p class="caption">
图7.5: 小丑鱼在珊瑚覆盖率背景下的空间分布
</p>
</div>
<p>接下来进行拟合优度检验：</p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="基于模拟的假设检验.html#cb829-1" tabindex="-1"></a><span class="co"># 拟合优度检验：残差分析</span></span>
<span id="cb829-2"><a href="基于模拟的假设检验.html#cb829-2" tabindex="-1"></a><span class="co"># 计算观测残差</span></span>
<span id="cb829-3"><a href="基于模拟的假设检验.html#cb829-3" tabindex="-1"></a>obs_residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit_model, <span class="at">type =</span> <span class="st">&quot;raw&quot;</span>)</span>
<span id="cb829-4"><a href="基于模拟的假设检验.html#cb829-4" tabindex="-1"></a></span>
<span id="cb829-5"><a href="基于模拟的假设检验.html#cb829-5" tabindex="-1"></a><span class="co"># 蒙特卡洛拟合优度检验</span></span>
<span id="cb829-6"><a href="基于模拟的假设检验.html#cb829-6" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb829-7"><a href="基于模拟的假设检验.html#cb829-7" tabindex="-1"></a>sim_residual_stats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb829-8"><a href="基于模拟的假设检验.html#cb829-8" tabindex="-1"></a></span>
<span id="cb829-9"><a href="基于模拟的假设检验.html#cb829-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb829-10"><a href="基于模拟的假设检验.html#cb829-10" tabindex="-1"></a>  <span class="co"># 从拟合模型中生成模拟数据</span></span>
<span id="cb829-11"><a href="基于模拟的假设检验.html#cb829-11" tabindex="-1"></a>  sim_pattern <span class="ot">&lt;-</span> <span class="fu">simulate</span>(fit_model)[[<span class="dv">1</span>]]</span>
<span id="cb829-12"><a href="基于模拟的假设检验.html#cb829-12" tabindex="-1"></a></span>
<span id="cb829-13"><a href="基于模拟的假设检验.html#cb829-13" tabindex="-1"></a>  <span class="co"># 用相同模型拟合模拟数据</span></span>
<span id="cb829-14"><a href="基于模拟的假设检验.html#cb829-14" tabindex="-1"></a>  sim_fit <span class="ot">&lt;-</span> <span class="fu">ppm</span>(sim_pattern <span class="sc">~</span> coral_coverage)</span>
<span id="cb829-15"><a href="基于模拟的假设检验.html#cb829-15" tabindex="-1"></a></span>
<span id="cb829-16"><a href="基于模拟的假设检验.html#cb829-16" tabindex="-1"></a>  <span class="co"># 计算模拟残差统计量（使用残差的绝对值积分）</span></span>
<span id="cb829-17"><a href="基于模拟的假设检验.html#cb829-17" tabindex="-1"></a>  sim_residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(sim_fit, <span class="at">type =</span> <span class="st">&quot;raw&quot;</span>)</span>
<span id="cb829-18"><a href="基于模拟的假设检验.html#cb829-18" tabindex="-1"></a>  sim_residual_stats[i] <span class="ot">&lt;-</span> <span class="fu">integral</span>(sim_residuals)</span>
<span id="cb829-19"><a href="基于模拟的假设检验.html#cb829-19" tabindex="-1"></a>}</span>
<span id="cb829-20"><a href="基于模拟的假设检验.html#cb829-20" tabindex="-1"></a></span>
<span id="cb829-21"><a href="基于模拟的假设检验.html#cb829-21" tabindex="-1"></a><span class="co"># 计算观测残差统计量</span></span>
<span id="cb829-22"><a href="基于模拟的假设检验.html#cb829-22" tabindex="-1"></a>obs_residual_stat <span class="ot">&lt;-</span> <span class="fu">integral</span>(obs_residuals)</span>
<span id="cb829-23"><a href="基于模拟的假设检验.html#cb829-23" tabindex="-1"></a></span>
<span id="cb829-24"><a href="基于模拟的假设检验.html#cb829-24" tabindex="-1"></a><span class="co"># 计算p值</span></span>
<span id="cb829-25"><a href="基于模拟的假设检验.html#cb829-25" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(sim_residual_stats <span class="sc">&gt;=</span> obs_residual_stat)</span>
<span id="cb829-26"><a href="基于模拟的假设检验.html#cb829-26" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;观测残差统计量:&quot;</span>, obs_residual_stat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 观测残差统计量: -1.963697e-10</code></pre>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="基于模拟的假设检验.html#cb831-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;拟合优度检验p值:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 拟合优度检验p值: 0.4444444</code></pre>
<p>图<a href="基于模拟的假设检验.html#fig:predicted-fish-intensity">7.6</a>展示了模型预测的小丑鱼分布强度：</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="基于模拟的假设检验.html#cb833-1" tabindex="-1"></a><span class="co"># 模型预测强度图</span></span>
<span id="cb833-2"><a href="基于模拟的假设检验.html#cb833-2" tabindex="-1"></a>predicted_intensity <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_model)</span>
<span id="cb833-3"><a href="基于模拟的假设检验.html#cb833-3" tabindex="-1"></a><span class="fu">plot</span>(predicted_intensity, <span class="at">main =</span> <span class="st">&quot;预测的小丑鱼分布强度&quot;</span>)</span>
<span id="cb833-4"><a href="基于模拟的假设检验.html#cb833-4" tabindex="-1"></a><span class="fu">plot</span>(observed_fish, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">cols =</span> <span class="st">&quot;white&quot;</span>, <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:predicted-fish-intensity"></span>
<img src="07-simulation_based_tests_files/figure-html/predicted-fish-intensity-1.png" alt="点过程模型预测的小丑鱼分布强度" width="672" />
<p class="caption">
图7.6: 点过程模型预测的小丑鱼分布强度
</p>
</div>
<p><strong>生态学意义</strong>：如果拟合优度检验显示模型拟合良好（p值不显著），表明小丑鱼的分布主要受珊瑚覆盖率的影响。这支持了”栖息地选择”假说——小丑鱼倾向于选择珊瑚覆盖率高的区域。如果模型拟合不佳，可能表明存在其他重要因素，如： - 种内竞争导致的空间排斥 - 捕食风险的空间变异 - 社会行为的空间组织</p>
</div>
<div id="空间生态学的统计挑战与解决方案" class="section level3 hasAnchor" number="7.8.3">
<h3><span class="header-section-number">7.8.3</span> 空间生态学的统计挑战与解决方案<a href="基于模拟的假设检验.html#空间生态学的统计挑战与解决方案" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>边界效应处理</strong>：在空间分析中，边界效应是一个重要问题。基于模拟的方法可以通过： - 使用相同的边界条件进行模拟 - 应用边界校正方法 - 使用周期性边界条件 来有效处理边界效应。</p>
<p><strong>空间自相关</strong>：生态数据通常存在空间自相关，这违反了传统统计的独立性假设。蒙特卡洛方法通过： - 保持空间结构进行随机化 - 使用条件模拟方法 - 应用空间自回归模型 来正确处理空间依赖性。</p>
<p><strong>多重尺度分析</strong>：生态过程在不同空间尺度上运作。基于模拟的方法支持： - 多尺度空间分析 - 尺度依赖性检验 - 最优尺度选择</p>
<p><strong>R语言中的空间分析工具</strong>：</p>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="基于模拟的假设检验.html#cb834-1" tabindex="-1"></a><span class="co"># 常用的空间分析包</span></span>
<span id="cb834-2"><a href="基于模拟的假设检验.html#cb834-2" tabindex="-1"></a><span class="fu">library</span>(spatstat) <span class="co"># 点模式分析</span></span>
<span id="cb834-3"><a href="基于模拟的假设检验.html#cb834-3" tabindex="-1"></a><span class="fu">library</span>(spdep) <span class="co"># 空间依赖性分析</span></span>
<span id="cb834-4"><a href="基于模拟的假设检验.html#cb834-4" tabindex="-1"></a><span class="fu">library</span>(gstat) <span class="co"># 地统计学</span></span>
<span id="cb834-5"><a href="基于模拟的假设检验.html#cb834-5" tabindex="-1"></a><span class="fu">library</span>(geoR) <span class="co"># 地统计学</span></span>
<span id="cb834-6"><a href="基于模拟的假设检验.html#cb834-6" tabindex="-1"></a><span class="fu">library</span>(adespatial) <span class="co"># 空间生态学</span></span>
<span id="cb834-7"><a href="基于模拟的假设检验.html#cb834-7" tabindex="-1"></a></span>
<span id="cb834-8"><a href="基于模拟的假设检验.html#cb834-8" tabindex="-1"></a><span class="co"># 空间自相关检验示例</span></span>
<span id="cb834-9"><a href="基于模拟的假设检验.html#cb834-9" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb834-10"><a href="基于模拟的假设检验.html#cb834-10" tabindex="-1"></a></span>
<span id="cb834-11"><a href="基于模拟的假设检验.html#cb834-11" tabindex="-1"></a><span class="co"># 创建空间权重矩阵</span></span>
<span id="cb834-12"><a href="基于模拟的假设检验.html#cb834-12" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">runif</span>(<span class="dv">50</span>), <span class="fu">runif</span>(<span class="dv">50</span>))</span>
<span id="cb834-13"><a href="基于模拟的假设检验.html#cb834-13" tabindex="-1"></a>nb <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords, <span class="at">k =</span> <span class="dv">5</span>))</span>
<span id="cb834-14"><a href="基于模拟的假设检验.html#cb834-14" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb)</span>
<span id="cb834-15"><a href="基于模拟的假设检验.html#cb834-15" tabindex="-1"></a></span>
<span id="cb834-16"><a href="基于模拟的假设检验.html#cb834-16" tabindex="-1"></a><span class="co"># 模拟空间自相关数据</span></span>
<span id="cb834-17"><a href="基于模拟的假设检验.html#cb834-17" tabindex="-1"></a>sp_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb834-18"><a href="基于模拟的假设检验.html#cb834-18" tabindex="-1"></a><span class="co"># 引入空间自相关</span></span>
<span id="cb834-19"><a href="基于模拟的假设检验.html#cb834-19" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb834-20"><a href="基于模拟的假设检验.html#cb834-20" tabindex="-1"></a>  sp_data <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">lag.listw</span>(w, sp_data) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">50</span>)</span>
<span id="cb834-21"><a href="基于模拟的假设检验.html#cb834-21" tabindex="-1"></a>}</span>
<span id="cb834-22"><a href="基于模拟的假设检验.html#cb834-22" tabindex="-1"></a></span>
<span id="cb834-23"><a href="基于模拟的假设检验.html#cb834-23" tabindex="-1"></a><span class="co"># Moran&#39;s I置换检验</span></span>
<span id="cb834-24"><a href="基于模拟的假设检验.html#cb834-24" tabindex="-1"></a>moran_test <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(sp_data, w, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb834-25"><a href="基于模拟的假设检验.html#cb834-25" tabindex="-1"></a><span class="fu">print</span>(moran_test)</span></code></pre></div>
<pre><code>## 
##  Monte-Carlo simulation of Moran I
## 
## data:  sp_data 
## weights: w  
## number of simulations + 1: 1000 
## 
## statistic = 0.055655, observed rank = 832, p-value = 0.168
## alternative hypothesis: greater</code></pre>
</div>
<div id="生态学应用与保护意义" class="section level3 hasAnchor" number="7.8.4">
<h3><span class="header-section-number">7.8.4</span> 生态学应用与保护意义<a href="基于模拟的假设检验.html#生态学应用与保护意义" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>保护生物学应用</strong>： - <strong>保护区设计</strong>：基于物种空间分布模式优化保护区网络 - <strong>栖息地破碎化评估</strong>：检验生境破碎对物种分布的影响 - <strong>入侵物种监测</strong>：检测入侵物种的空间扩散模式</p>
<p><strong>恢复生态学应用</strong>： - <strong>恢复效果评估</strong>：比较恢复前后物种空间分布的变化 - <strong>种子源定位</strong>：识别重要的种群补充源 - <strong>连通性分析</strong>：评估生境斑块间的功能连通性</p>
<p><strong>气候变化研究</strong>： - <strong>分布范围变化</strong>：监测物种分布范围对气候变化的响应 - <strong>分布边界移动</strong>：检验分布边界的气候驱动因素 - <strong>避难所识别</strong>：识别气候变化的潜在避难所</p>
<p>通过基于模拟的空间分布检验方法，生态学家能够更可靠地推断物种空间分布的形成机制，为理解生态过程、预测生态系统变化和制定有效的保护策略提供坚实的科学基础。这些方法特别适合处理生态学中常见的复杂空间模式和小样本问题，是空间生态学研究中不可或缺的统计工具。</p>
</div>
</div>
<div id="系统发育信号检验" class="section level2 hasAnchor" number="7.9">
<h2><span class="header-section-number">7.9</span> 系统发育信号检验<a href="基于模拟的假设检验.html#系统发育信号检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>系统发育信号检验是进化生态学和比较生物学中的核心统计问题，旨在检验物种性状是否受到系统发育历史的影响。基于模拟的假设检验方法在这些分析中发挥着关键作用，特别是当性状的演化过程复杂或样本量有限时。</p>
<div id="系统发育保守性检验" class="section level3 hasAnchor" number="7.9.1">
<h3><span class="header-section-number">7.9.1</span> 系统发育保守性检验<a href="基于模拟的假设检验.html#系统发育保守性检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>生态学问题背景</strong>：系统发育保守性描述的是亲缘关系较近的物种在性状上比随机期望更为相似的现象。理解性状的系统发育信号对于揭示生态适应的进化历史、预测物种对环境变化的响应以及指导保护策略都具有重要意义。</p>
<p><strong>传统方法的局限性</strong>：传统的系统发育信号检验方法（如Blomberg’s K检验、Pagel’s <span class="math inline">\(\lambda\)</span>检验）依赖于特定的演化模型假设，如布朗运动模型。然而，这些假设在真实的生态系统中往往过于简化： - 布朗运动假设性状演化是随机的，忽略了自然选择的作用 - 模型对异常物种或快速辐射事件敏感 - 在小样本情况下，理论分布的近似可能不准确 - 难以处理复杂的演化过程，如性状的趋同进化</p>
<p><strong>基于模拟的优势</strong>：蒙特卡洛模拟通过随机化系统发育树尖端的性状值来构建零分布，不依赖于特定的演化模型假设，特别适合处理： - 非标准演化模型的检验 - 小样本系统发育分析 - 复杂性状演化模式的识别 - 多种系统发育信号指标的比较</p>
<p><strong>生态学实例：植物功能性状的系统发育信号分析</strong></p>
<p>假设我们研究温带森林中30种木本植物的功能性状（如比叶面积、木材密度、最大树高）是否具有系统发育保守性。我们拥有这些物种的系统发育树和性状测量数据。</p>
<p><strong>蒙特卡洛检验过程</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>计算观测系统发育信号</strong>：使用Blomberg’s K统计量或Pagel’s <span class="math inline">\(\lambda\)</span>统计量</li>
<li><strong>构建零模型</strong>：假设性状在系统发育树尖端的分布是随机的</li>
<li><strong>随机化模拟</strong>：保持系统发育树结构不变，随机重排性状值在树尖端的分布</li>
<li><strong>构建经验分布</strong>：重复模拟1000次，每次计算系统发育信号统计量</li>
<li><strong>计算p值</strong>：比较观测统计量与经验分布的位置</li>
</ol>
<p><strong>R语言实现示例</strong>：</p>
<p>下面的代码展示了系统发育信号检验的具体实现过程（图<a href="基于模拟的假设检验.html#fig:phylogenetic-signal">7.7</a>）：</p>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="基于模拟的假设检验.html#cb836-1" tabindex="-1"></a><span class="co"># 系统发育信号检验的蒙特卡洛模拟</span></span>
<span id="cb836-2"><a href="基于模拟的假设检验.html#cb836-2" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb836-3"><a href="基于模拟的假设检验.html#cb836-3" tabindex="-1"></a><span class="fu">library</span>(picante)</span>
<span id="cb836-4"><a href="基于模拟的假设检验.html#cb836-4" tabindex="-1"></a></span>
<span id="cb836-5"><a href="基于模拟的假设检验.html#cb836-5" tabindex="-1"></a><span class="co"># 模拟系统发育树和性状数据</span></span>
<span id="cb836-6"><a href="基于模拟的假设检验.html#cb836-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb836-7"><a href="基于模拟的假设检验.html#cb836-7" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="dv">30</span>) <span class="co"># 生成30个物种的系统发育树</span></span>
<span id="cb836-8"><a href="基于模拟的假设检验.html#cb836-8" tabindex="-1"></a>trait_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>) <span class="co"># 模拟性状数据</span></span>
<span id="cb836-9"><a href="基于模拟的假设检验.html#cb836-9" tabindex="-1"></a><span class="fu">names</span>(trait_data) <span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.label</span>
<span id="cb836-10"><a href="基于模拟的假设检验.html#cb836-10" tabindex="-1"></a></span>
<span id="cb836-11"><a href="基于模拟的假设检验.html#cb836-11" tabindex="-1"></a><span class="co"># 计算观测Blomberg&#39;s K统计量</span></span>
<span id="cb836-12"><a href="基于模拟的假设检验.html#cb836-12" tabindex="-1"></a>obs_K <span class="ot">&lt;-</span> <span class="fu">Kcalc</span>(trait_data, tree)</span>
<span id="cb836-13"><a href="基于模拟的假设检验.html#cb836-13" tabindex="-1"></a></span>
<span id="cb836-14"><a href="基于模拟的假设检验.html#cb836-14" tabindex="-1"></a><span class="co"># 蒙特卡洛模拟</span></span>
<span id="cb836-15"><a href="基于模拟的假设检验.html#cb836-15" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb836-16"><a href="基于模拟的假设检验.html#cb836-16" tabindex="-1"></a>sim_K <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb836-17"><a href="基于模拟的假设检验.html#cb836-17" tabindex="-1"></a></span>
<span id="cb836-18"><a href="基于模拟的假设检验.html#cb836-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb836-19"><a href="基于模拟的假设检验.html#cb836-19" tabindex="-1"></a>  <span class="co"># 随机重排性状值（保持系统发育树结构）</span></span>
<span id="cb836-20"><a href="基于模拟的假设检验.html#cb836-20" tabindex="-1"></a>  sim_trait <span class="ot">&lt;-</span> <span class="fu">sample</span>(trait_data)</span>
<span id="cb836-21"><a href="基于模拟的假设检验.html#cb836-21" tabindex="-1"></a>  <span class="fu">names</span>(sim_trait) <span class="ot">&lt;-</span> tree<span class="sc">$</span>tip.label</span>
<span id="cb836-22"><a href="基于模拟的假设检验.html#cb836-22" tabindex="-1"></a></span>
<span id="cb836-23"><a href="基于模拟的假设检验.html#cb836-23" tabindex="-1"></a>  <span class="co"># 计算模拟的K统计量</span></span>
<span id="cb836-24"><a href="基于模拟的假设检验.html#cb836-24" tabindex="-1"></a>  sim_K[i] <span class="ot">&lt;-</span> <span class="fu">Kcalc</span>(sim_trait, tree)</span>
<span id="cb836-25"><a href="基于模拟的假设检验.html#cb836-25" tabindex="-1"></a>}</span>
<span id="cb836-26"><a href="基于模拟的假设检验.html#cb836-26" tabindex="-1"></a></span>
<span id="cb836-27"><a href="基于模拟的假设检验.html#cb836-27" tabindex="-1"></a><span class="co"># 计算经验p值</span></span>
<span id="cb836-28"><a href="基于模拟的假设检验.html#cb836-28" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(sim_K <span class="sc">&gt;=</span> <span class="fu">as.numeric</span>(obs_K))</span>
<span id="cb836-29"><a href="基于模拟的假设检验.html#cb836-29" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;观测Blomberg&#39;s K统计量:&quot;</span>, obs_K, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 观测Blomberg&#39;s K统计量: 0.3065341</code></pre>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="基于模拟的假设检验.html#cb838-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;经验p值:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 经验p值: 0.446</code></pre>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="基于模拟的假设检验.html#cb840-1" tabindex="-1"></a><span class="co"># 使用phytools包进行更复杂的系统发育信号检验</span></span>
<span id="cb840-2"><a href="基于模拟的假设检验.html#cb840-2" tabindex="-1"></a><span class="fu">library</span>(phytools)</span>
<span id="cb840-3"><a href="基于模拟的假设检验.html#cb840-3" tabindex="-1"></a></span>
<span id="cb840-4"><a href="基于模拟的假设检验.html#cb840-4" tabindex="-1"></a><span class="co"># Pagel&#39;s $\lambda$检验</span></span>
<span id="cb840-5"><a href="基于模拟的假设检验.html#cb840-5" tabindex="-1"></a>lambda_test <span class="ot">&lt;-</span> <span class="fu">phylosig</span>(tree, trait_data, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>)</span>
<span id="cb840-6"><a href="基于模拟的假设检验.html#cb840-6" tabindex="-1"></a><span class="fu">print</span>(lambda_test)</span></code></pre></div>
<pre><code>## 
## Phylogenetic signal lambda : 0.00132165 
## logL(lambda) : -59.7517 
## LR(lambda=0) : 0.000110223 
## P-value (based on LR test) : 0.991623</code></pre>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="基于模拟的假设检验.html#cb842-1" tabindex="-1"></a><span class="co"># 可视化系统发育信号</span></span>
<span id="cb842-2"><a href="基于模拟的假设检验.html#cb842-2" tabindex="-1"></a><span class="co"># 绘制系统发育树和性状值</span></span>
<span id="cb842-3"><a href="基于模拟的假设检验.html#cb842-3" tabindex="-1"></a><span class="fu">plotTree</span>(tree, <span class="at">type =</span> <span class="st">&quot;fan&quot;</span>, <span class="at">fsize =</span> <span class="fl">0.8</span>)</span>
<span id="cb842-4"><a href="基于模拟的假设检验.html#cb842-4" tabindex="-1"></a><span class="fu">tiplabels</span>(</span>
<span id="cb842-5"><a href="基于模拟的假设检验.html#cb842-5" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>))(<span class="dv">30</span>)[<span class="fu">rank</span>(trait_data)],</span>
<span id="cb842-6"><a href="基于模拟的假设检验.html#cb842-6" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">1.5</span></span>
<span id="cb842-7"><a href="基于模拟的假设检验.html#cb842-7" tabindex="-1"></a>)</span>
<span id="cb842-8"><a href="基于模拟的假设检验.html#cb842-8" tabindex="-1"></a></span>
<span id="cb842-9"><a href="基于模拟的假设检验.html#cb842-9" tabindex="-1"></a><span class="co"># 添加性状值颜色图例</span></span>
<span id="cb842-10"><a href="基于模拟的假设检验.html#cb842-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>,</span>
<span id="cb842-11"><a href="基于模拟的假设检验.html#cb842-11" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;低性状值&quot;</span>, <span class="st">&quot;高性状值&quot;</span>),</span>
<span id="cb842-12"><a href="基于模拟的假设检验.html#cb842-12" tabindex="-1"></a>  <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb842-13"><a href="基于模拟的假设检验.html#cb842-13" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:phylogenetic-signal"></span>
<img src="07-simulation_based_tests_files/figure-html/phylogenetic-signal-1.png" alt="植物功能性状系统发育信号检验与可视化" width="672" />
<p class="caption">
图7.7: 植物功能性状系统发育信号检验与可视化
</p>
</div>
<p><strong>生态学意义</strong>：如果检验显示显著的系统发育信号（p &lt; 0.05），表明这些功能性状在亲缘关系较近的物种间更为相似。这支持了”系统发育生态位保守性”假说——物种倾向于保留祖先的生态特性。这种信息对于理解群落组装机制、预测物种对气候变化的响应以及设计基于系统发育多样性的保护策略都具有重要价值。</p>
</div>
<div id="系统发育独立对比" class="section level3 hasAnchor" number="7.9.2">
<h3><span class="header-section-number">7.9.2</span> 系统发育独立对比<a href="基于模拟的假设检验.html#系统发育独立对比" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>生态学问题背景</strong>：在比较生物学研究中，我们需要检验不同性状间的生态关系，但由于物种间存在系统发育相关性，传统的统计方法可能产生有偏的结论。系统发育独立对比通过去除系统发育影响，为性状间的生态关系检验提供了正确的统计框架。</p>
<p><strong>传统方法的挑战</strong>：传统的相关性分析或回归分析假设观测值相互独立，但系统发育相关的物种违背了这一假设： - 亲缘关系较近的物种在多个性状上可能同时相似 - 这种共有的系统发育历史可能产生虚假的相关性 - 传统方法可能高估或低估性状间的真实生态关系</p>
<p><strong>基于模拟的解决方案</strong>：置换检验通过随机化系统发育树的结构或性状值的分布来构建零分布，特别适合处理： - 复杂系统发育结构的校正 - 多种性状组合的联合检验 - 非标准系统发育模型的验证</p>
<p><strong>生态学实例：植物防御性状与生长速率的关系研究</strong></p>
<p>假设我们研究热带雨林中40种树种的化学防御物质含量与生长速率的关系。由于这些树种具有系统发育相关性，我们需要使用系统发育独立对比来正确检验这种关系。</p>
<p><strong>置换检验过程</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>计算观测相关性</strong>：使用系统发育独立对比计算防御性状与生长速率的相关系数</li>
<li><strong>随机化系统发育结构</strong>：随机重排系统发育树的拓扑结构或分支长度</li>
<li><strong>构建零分布</strong>：重复随机化1000次，每次计算相关性统计量</li>
<li><strong>计算p值</strong>：比较观测相关性与零分布的位置</li>
</ol>
<p><strong>R语言实现示例</strong>：</p>
<p>下面的代码展示了系统发育独立对比分析的具体实现过程（图<a href="基于模拟的假设检验.html#fig:phylogenetic-contrasts">7.8</a>）：</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="基于模拟的假设检验.html#cb843-1" tabindex="-1"></a><span class="co"># 系统发育独立对比的置换检验</span></span>
<span id="cb843-2"><a href="基于模拟的假设检验.html#cb843-2" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb843-3"><a href="基于模拟的假设检验.html#cb843-3" tabindex="-1"></a><span class="fu">library</span>(geiger)</span>
<span id="cb843-4"><a href="基于模拟的假设检验.html#cb843-4" tabindex="-1"></a></span>
<span id="cb843-5"><a href="基于模拟的假设检验.html#cb843-5" tabindex="-1"></a><span class="co"># 模拟系统发育树和性状数据</span></span>
<span id="cb843-6"><a href="基于模拟的假设检验.html#cb843-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb843-7"><a href="基于模拟的假设检验.html#cb843-7" tabindex="-1"></a>tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(<span class="dv">40</span>) <span class="co"># 40个物种的系统发育树</span></span>
<span id="cb843-8"><a href="基于模拟的假设检验.html#cb843-8" tabindex="-1"></a></span>
<span id="cb843-9"><a href="基于模拟的假设检验.html#cb843-9" tabindex="-1"></a><span class="co"># 模拟相关性状（受系统发育影响）</span></span>
<span id="cb843-10"><a href="基于模拟的假设检验.html#cb843-10" tabindex="-1"></a>defense_trait <span class="ot">&lt;-</span> <span class="fu">rTraitCont</span>(tree, <span class="at">model =</span> <span class="st">&quot;BM&quot;</span>, <span class="at">sigma =</span> <span class="dv">1</span>)</span>
<span id="cb843-11"><a href="基于模拟的假设检验.html#cb843-11" tabindex="-1"></a>growth_rate <span class="ot">&lt;-</span> <span class="fl">0.6</span> <span class="sc">*</span> defense_trait <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> <span class="fu">rTraitCont</span>(tree, <span class="at">model =</span> <span class="st">&quot;BM&quot;</span>, <span class="at">sigma =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb843-12"><a href="基于模拟的假设检验.html#cb843-12" tabindex="-1"></a></span>
<span id="cb843-13"><a href="基于模拟的假设检验.html#cb843-13" tabindex="-1"></a><span class="co"># 计算系统发育独立对比</span></span>
<span id="cb843-14"><a href="基于模拟的假设检验.html#cb843-14" tabindex="-1"></a>pic_defense <span class="ot">&lt;-</span> <span class="fu">pic</span>(defense_trait, tree)</span>
<span id="cb843-15"><a href="基于模拟的假设检验.html#cb843-15" tabindex="-1"></a>pic_growth <span class="ot">&lt;-</span> <span class="fu">pic</span>(growth_rate, tree)</span>
<span id="cb843-16"><a href="基于模拟的假设检验.html#cb843-16" tabindex="-1"></a></span>
<span id="cb843-17"><a href="基于模拟的假设检验.html#cb843-17" tabindex="-1"></a><span class="co"># 计算观测相关性（去除系统发育影响后）</span></span>
<span id="cb843-18"><a href="基于模拟的假设检验.html#cb843-18" tabindex="-1"></a>obs_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(pic_defense, pic_growth)</span>
<span id="cb843-19"><a href="基于模拟的假设检验.html#cb843-19" tabindex="-1"></a></span>
<span id="cb843-20"><a href="基于模拟的假设检验.html#cb843-20" tabindex="-1"></a><span class="co"># 置换检验：随机化系统发育结构</span></span>
<span id="cb843-21"><a href="基于模拟的假设检验.html#cb843-21" tabindex="-1"></a>n_perm <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb843-22"><a href="基于模拟的假设检验.html#cb843-22" tabindex="-1"></a>perm_cor <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_perm)</span>
<span id="cb843-23"><a href="基于模拟的假设检验.html#cb843-23" tabindex="-1"></a></span>
<span id="cb843-24"><a href="基于模拟的假设检验.html#cb843-24" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_perm) {</span>
<span id="cb843-25"><a href="基于模拟的假设检验.html#cb843-25" tabindex="-1"></a>  <span class="co"># 随机重排系统发育树尖端的性状关联</span></span>
<span id="cb843-26"><a href="基于模拟的假设检验.html#cb843-26" tabindex="-1"></a>  perm_tree <span class="ot">&lt;-</span> tree</span>
<span id="cb843-27"><a href="基于模拟的假设检验.html#cb843-27" tabindex="-1"></a>  perm_tree<span class="sc">$</span>tip.label <span class="ot">&lt;-</span> <span class="fu">sample</span>(perm_tree<span class="sc">$</span>tip.label)</span>
<span id="cb843-28"><a href="基于模拟的假设检验.html#cb843-28" tabindex="-1"></a></span>
<span id="cb843-29"><a href="基于模拟的假设检验.html#cb843-29" tabindex="-1"></a>  <span class="co"># 计算置换后的PIC相关性</span></span>
<span id="cb843-30"><a href="基于模拟的假设检验.html#cb843-30" tabindex="-1"></a>  perm_pic_defense <span class="ot">&lt;-</span> <span class="fu">pic</span>(defense_trait[perm_tree<span class="sc">$</span>tip.label], perm_tree)</span>
<span id="cb843-31"><a href="基于模拟的假设检验.html#cb843-31" tabindex="-1"></a>  perm_pic_growth <span class="ot">&lt;-</span> <span class="fu">pic</span>(growth_rate[perm_tree<span class="sc">$</span>tip.label], perm_tree)</span>
<span id="cb843-32"><a href="基于模拟的假设检验.html#cb843-32" tabindex="-1"></a>  perm_cor[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(perm_pic_defense, perm_pic_growth)</span>
<span id="cb843-33"><a href="基于模拟的假设检验.html#cb843-33" tabindex="-1"></a>}</span>
<span id="cb843-34"><a href="基于模拟的假设检验.html#cb843-34" tabindex="-1"></a></span>
<span id="cb843-35"><a href="基于模拟的假设检验.html#cb843-35" tabindex="-1"></a><span class="co"># 计算p值</span></span>
<span id="cb843-36"><a href="基于模拟的假设检验.html#cb843-36" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(perm_cor) <span class="sc">&gt;=</span> <span class="fu">abs</span>(obs_cor))</span>
<span id="cb843-37"><a href="基于模拟的假设检验.html#cb843-37" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;观测PIC相关性:&quot;</span>, obs_cor, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 观测PIC相关性: 0.7710981</code></pre>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="基于模拟的假设检验.html#cb845-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;经验p值:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 经验p值: 0.973</code></pre>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="基于模拟的假设检验.html#cb847-1" tabindex="-1"></a><span class="co"># 可视化结果</span></span>
<span id="cb847-2"><a href="基于模拟的假设检验.html#cb847-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb847-3"><a href="基于模拟的假设检验.html#cb847-3" tabindex="-1"></a></span>
<span id="cb847-4"><a href="基于模拟的假设检验.html#cb847-4" tabindex="-1"></a><span class="co"># 原始性状的相关性图</span></span>
<span id="cb847-5"><a href="基于模拟的假设检验.html#cb847-5" tabindex="-1"></a><span class="fu">plot</span>(defense_trait, growth_rate,</span>
<span id="cb847-6"><a href="基于模拟的假设检验.html#cb847-6" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb847-7"><a href="基于模拟的假设检验.html#cb847-7" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;防御物质含量&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;生长速率&quot;</span>,</span>
<span id="cb847-8"><a href="基于模拟的假设检验.html#cb847-8" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;原始性状相关性&quot;</span></span>
<span id="cb847-9"><a href="基于模拟的假设检验.html#cb847-9" tabindex="-1"></a>)</span>
<span id="cb847-10"><a href="基于模拟的假设检验.html#cb847-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(growth_rate <span class="sc">~</span> defense_trait), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb847-11"><a href="基于模拟的假设检验.html#cb847-11" tabindex="-1"></a></span>
<span id="cb847-12"><a href="基于模拟的假设检验.html#cb847-12" tabindex="-1"></a><span class="co"># 系统发育独立对比的相关性图</span></span>
<span id="cb847-13"><a href="基于模拟的假设检验.html#cb847-13" tabindex="-1"></a><span class="fu">plot</span>(pic_defense, pic_growth,</span>
<span id="cb847-14"><a href="基于模拟的假设检验.html#cb847-14" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb847-15"><a href="基于模拟的假设检验.html#cb847-15" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;防御物质PIC&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;生长速率PIC&quot;</span>,</span>
<span id="cb847-16"><a href="基于模拟的假设检验.html#cb847-16" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;系统发育独立对比相关性&quot;</span></span>
<span id="cb847-17"><a href="基于模拟的假设检验.html#cb847-17" tabindex="-1"></a>)</span>
<span id="cb847-18"><a href="基于模拟的假设检验.html#cb847-18" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(pic_growth <span class="sc">~</span> pic_defense), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb847-19"><a href="基于模拟的假设检验.html#cb847-19" tabindex="-1"></a></span>
<span id="cb847-20"><a href="基于模拟的假设检验.html#cb847-20" tabindex="-1"></a><span class="co"># 添加相关性系数</span></span>
<span id="cb847-21"><a href="基于模拟的假设检验.html#cb847-21" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.8</span> <span class="sc">*</span> <span class="fu">max</span>(pic_defense), <span class="fl">0.9</span> <span class="sc">*</span> <span class="fu">max</span>(pic_growth),</span>
<span id="cb847-22"><a href="基于模拟的假设检验.html#cb847-22" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="st">&quot;r =&quot;</span>, <span class="fu">round</span>(obs_cor, <span class="dv">3</span>)),</span>
<span id="cb847-23"><a href="基于模拟的假设检验.html#cb847-23" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb847-24"><a href="基于模拟的假设检验.html#cb847-24" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:phylogenetic-contrasts"></span>
<img src="07-simulation_based_tests_files/figure-html/phylogenetic-contrasts-1.png" alt="植物防御性状与生长速率关系的系统发育独立对比分析" width="672" />
<p class="caption">
图7.8: 植物防御性状与生长速率关系的系统发育独立对比分析
</p>
</div>
<p><strong>生态学意义</strong>：通过系统发育独立对比的置换检验，我们可以更可靠地推断防御性状与生长速率之间的生态权衡关系。如果检验显示显著的正相关（p &lt; 0.05），表明在去除系统发育影响后，防御物质含量高的物种确实具有较慢的生长速率，支持了”生长-防御权衡”假说。这种分析为理解植物生活史策略的进化提供了重要证据。</p>
</div>
<div id="方法学比较与生态学应用建议-1" class="section level3 hasAnchor" number="7.9.3">
<h3><span class="header-section-number">7.9.3</span> 方法学比较与生态学应用建议<a href="基于模拟的假设检验.html#方法学比较与生态学应用建议-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>系统发育信号检验方法的选择策略</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>Blomberg’s K检验</strong>：
<ul>
<li>适用于连续性状的系统发育信号检验</li>
<li>基于性状在系统发育树上的方差比较</li>
<li>K &gt; 1表示比布朗运动期望更强的系统发育信号</li>
</ul></li>
<li><strong>Pagel’s <span class="math inline">\(\lambda\)</span>检验</strong>：
<ul>
<li>通过最大似然估计检验系统发育信号</li>
<li><span class="math inline">\(\lambda\)</span>参数衡量系统发育对性状变异的解释程度</li>
<li>可以检验多种演化模型的拟合优度</li>
</ul></li>
<li><strong>置换检验方法</strong>：
<ul>
<li>不依赖于特定的演化模型假设</li>
<li>适用于小样本和非标准性状分布</li>
<li>可以灵活检验多种系统发育信号指标</li>
</ul></li>
</ol>
<p><strong>生态学研究的最佳实践</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>多方法验证</strong>：使用多种系统发育信号检验方法相互验证</li>
<li><strong>敏感性分析</strong>：检验结果对系统发育树不确定性的敏感性</li>
<li><strong>生态学解释</strong>：结合生态学机制解释系统发育信号的意义</li>
<li><strong>保护应用</strong>：在保护生物学中考虑系统发育多样性的价值</li>
</ol>
<p><strong>进化生态学应用</strong>：系统发育信号检验在进化生态学中具有广泛的应用价值： - <strong>适应性进化研究</strong>：检验性状是否受到自然选择的作用 - <strong>群落生态学</strong>：理解系统发育对群落组装的约束 - <strong>保护生物学</strong>：基于系统发育多样性设计保护优先区 - <strong>气候变化研究</strong>：预测物种对气候变化的系统发育响应模式</p>
<p>通过这些基于模拟的系统发育分析方法，生态学家能够更可靠地推断性状的进化历史，为理解生物多样性的形成机制和预测生态系统对全球变化的响应提供坚实的进化生物学基础。</p>
</div>
</div>
<div id="生态学零模型检验" class="section level2 hasAnchor" number="7.10">
<h2><span class="header-section-number">7.10</span> 生态学零模型检验<a href="基于模拟的假设检验.html#生态学零模型检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="零模型的基本概念与生态学意义" class="section level3 hasAnchor" number="7.10.1">
<h3><span class="header-section-number">7.10.1</span> 零模型的基本概念与生态学意义<a href="基于模拟的假设检验.html#零模型的基本概念与生态学意义" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>生态学问题背景</strong>：零模型（Null Model）是生态学中用于检验观测模式是否显著偏离随机期望的统计工具。在生态学研究中，我们经常观察到各种复杂的生态模式——物种在群落中的特定组合、生态网络中物种间的相互作用、空间分布中的聚集或分散模式等。这些模式是真实的生态过程（如竞争、捕食、环境过滤）的结果，还是仅仅反映了随机过程？零模型为我们提供了回答这个问题的严谨统计框架。</p>
<p><strong>零模型的核心思想</strong>：零模型通过构建一个”随机期望”来检验观测模式。其基本逻辑是：如果观测模式与随机期望没有显著差异，那么我们可以认为观测模式可能只是随机过程的产物；如果观测模式显著偏离随机期望，那么可能存在某种生态过程在起作用。</p>
<p><strong>生态学意义</strong>：零模型检验在生态学中具有广泛的应用价值。它帮助我们区分真实的生态规律与随机波动，为理解群落组装机制、物种共存模式、生态网络结构等基本生态学问题提供了重要的统计工具。</p>
</div>
<div id="群落组装零模型检验" class="section level3 hasAnchor" number="7.10.2">
<h3><span class="header-section-number">7.10.2</span> 群落组装零模型检验<a href="基于模拟的假设检验.html#群落组装零模型检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>生态学问题背景</strong>：群落组装是生态学的核心问题之一。我们想要理解为什么特定的物种会在特定的群落中共同出现。是环境过滤、种间竞争、扩散限制等生态过程决定了群落的物种组成，还是物种的组合只是随机过程的结果？</p>
<p><strong>传统方法的局限性</strong>：传统的群落分析方法（如多样性指数、相似性分析）虽然能够描述群落的特征，但难以区分这些特征是生态过程的结果还是随机期望。传统的统计检验往往依赖于特定的分布假设，而这些假设在复杂的群落数据中往往不成立。</p>
<p><strong>基于模拟的优势</strong>：群落组装零模型通过随机化群落矩阵来构建期望分布，不依赖于特定的分布假设，特别适合处理： - 复杂的物种-环境关系 - 多物种间的相互作用 - 空间和时间异质性 - 小样本群落数据</p>
<p><strong>生态学实例：检验热带雨林树种共存机制</strong></p>
<p>假设我们研究亚马逊热带雨林中树种的共存机制。我们在一个1公顷的固定样地中记录了所有胸径大于10厘米的树木，获得了物种组成数据。我们想要检验树种在群落中的共存是否随机，还是受到生态过程的约束。</p>
<p><strong>零模型检验过程</strong>：</p>
<ol style="list-style-type: decimal">
<li><p><strong>构建零模型</strong>：基于不同的随机化算法构建零模型</p>
<ul>
<li><strong>固定行和列总和</strong>：保持物种出现频率和样点物种丰富度不变</li>
<li><strong>固定行总和</strong>：只保持物种出现频率不变</li>
<li><strong>固定列总和</strong>：只保持样点物种丰富度不变</li>
</ul></li>
<li><p><strong>计算检验统计量</strong>：使用群落结构指数，如：</p>
<ul>
<li><strong>C-score</strong>：衡量物种共现的非随机性</li>
<li><strong>Checkerboard score</strong>：检测竞争排斥模式</li>
<li><strong>Nestedness</strong>：检验群落的嵌套结构</li>
</ul></li>
<li><p><strong>随机化模拟</strong>：重复模拟1000次，每次计算检验统计量</p></li>
<li><p><strong>构建经验分布</strong>：基于模拟结果构建统计量的零分布</p></li>
<li><p><strong>计算p值</strong>：比较观测统计量与零分布的位置</p></li>
</ol>
<p><strong>R语言实现示例</strong>：</p>
<p>下面的代码展示了群落组装零模型检验的具体实现过程。首先我们模拟热带雨林群落数据并执行零模型分析：</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="基于模拟的假设检验.html#cb848-1" tabindex="-1"></a><span class="co"># 群落组装零模型检验</span></span>
<span id="cb848-2"><a href="基于模拟的假设检验.html#cb848-2" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb848-3"><a href="基于模拟的假设检验.html#cb848-3" tabindex="-1"></a><span class="fu">library</span>(bipartite)</span>
<span id="cb848-4"><a href="基于模拟的假设检验.html#cb848-4" tabindex="-1"></a></span>
<span id="cb848-5"><a href="基于模拟的假设检验.html#cb848-5" tabindex="-1"></a><span class="co"># 模拟热带雨林群落数据（物种×样点矩阵）</span></span>
<span id="cb848-6"><a href="基于模拟的假设检验.html#cb848-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb848-7"><a href="基于模拟的假设检验.html#cb848-7" tabindex="-1"></a>n_species <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb848-8"><a href="基于模拟的假设检验.html#cb848-8" tabindex="-1"></a>n_sites <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb848-9"><a href="基于模拟的假设检验.html#cb848-9" tabindex="-1"></a></span>
<span id="cb848-10"><a href="基于模拟的假设检验.html#cb848-10" tabindex="-1"></a><span class="co"># 创建环境梯度</span></span>
<span id="cb848-11"><a href="基于模拟的假设检验.html#cb848-11" tabindex="-1"></a>env_gradient <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> n_sites)</span>
<span id="cb848-12"><a href="基于模拟的假设检验.html#cb848-12" tabindex="-1"></a></span>
<span id="cb848-13"><a href="基于模拟的假设检验.html#cb848-13" tabindex="-1"></a><span class="co"># 模拟物种对环境梯度的响应（非随机群落）</span></span>
<span id="cb848-14"><a href="基于模拟的假设检验.html#cb848-14" tabindex="-1"></a>comm_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n_species, <span class="at">ncol =</span> n_sites)</span>
<span id="cb848-15"><a href="基于模拟的假设检验.html#cb848-15" tabindex="-1"></a><span class="fu">rownames</span>(comm_matrix) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;物种&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_species)</span>
<span id="cb848-16"><a href="基于模拟的假设检验.html#cb848-16" tabindex="-1"></a><span class="fu">colnames</span>(comm_matrix) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;样点&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_sites)</span>
<span id="cb848-17"><a href="基于模拟的假设检验.html#cb848-17" tabindex="-1"></a></span>
<span id="cb848-18"><a href="基于模拟的假设检验.html#cb848-18" tabindex="-1"></a><span class="co"># 物种对环境的最适值</span></span>
<span id="cb848-19"><a href="基于模拟的假设检验.html#cb848-19" tabindex="-1"></a>species_optima <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_species, <span class="dv">2</span>, <span class="dv">8</span>)</span>
<span id="cb848-20"><a href="基于模拟的假设检验.html#cb848-20" tabindex="-1"></a>species_tolerance <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_species, <span class="fl">0.5</span>, <span class="dv">2</span>)</span>
<span id="cb848-21"><a href="基于模拟的假设检验.html#cb848-21" tabindex="-1"></a></span>
<span id="cb848-22"><a href="基于模拟的假设检验.html#cb848-22" tabindex="-1"></a><span class="co"># 基于环境梯度的物种分布</span></span>
<span id="cb848-23"><a href="基于模拟的假设检验.html#cb848-23" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_species) {</span>
<span id="cb848-24"><a href="基于模拟的假设检验.html#cb848-24" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sites) {</span>
<span id="cb848-25"><a href="基于模拟的假设检验.html#cb848-25" tabindex="-1"></a>    <span class="co"># 高斯响应曲线</span></span>
<span id="cb848-26"><a href="基于模拟的假设检验.html#cb848-26" tabindex="-1"></a>    prob <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>(env_gradient[j] <span class="sc">-</span> species_optima[i])<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> species_tolerance[i]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb848-27"><a href="基于模拟的假设检验.html#cb848-27" tabindex="-1"></a>    comm_matrix[i, j] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, prob)</span>
<span id="cb848-28"><a href="基于模拟的假设检验.html#cb848-28" tabindex="-1"></a>  }</span>
<span id="cb848-29"><a href="基于模拟的假设检验.html#cb848-29" tabindex="-1"></a>}</span>
<span id="cb848-30"><a href="基于模拟的假设检验.html#cb848-30" tabindex="-1"></a></span>
<span id="cb848-31"><a href="基于模拟的假设检验.html#cb848-31" tabindex="-1"></a><span class="co"># 计算观测C-score（物种共现非随机性）</span></span>
<span id="cb848-32"><a href="基于模拟的假设检验.html#cb848-32" tabindex="-1"></a>calc_c_score <span class="ot">&lt;-</span> <span class="cf">function</span>(mat) {</span>
<span id="cb848-33"><a href="基于模拟的假设检验.html#cb848-33" tabindex="-1"></a>  n_spp <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mat)</span>
<span id="cb848-34"><a href="基于模拟的假设检验.html#cb848-34" tabindex="-1"></a>  c_scores <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">choose</span>(n_spp, <span class="dv">2</span>))</span>
<span id="cb848-35"><a href="基于模拟的假设检验.html#cb848-35" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb848-36"><a href="基于模拟的假设检验.html#cb848-36" tabindex="-1"></a></span>
<span id="cb848-37"><a href="基于模拟的假设检验.html#cb848-37" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_spp <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb848-38"><a href="基于模拟的假设检验.html#cb848-38" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n_spp) {</span>
<span id="cb848-39"><a href="基于模拟的假设检验.html#cb848-39" tabindex="-1"></a>      <span class="co"># 计算物种i和j的共现模式</span></span>
<span id="cb848-40"><a href="基于模拟的假设检验.html#cb848-40" tabindex="-1"></a>      both_present <span class="ot">&lt;-</span> <span class="fu">sum</span>(mat[i, ] <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> mat[j, ] <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb848-41"><a href="基于模拟的假设检验.html#cb848-41" tabindex="-1"></a>      only_i <span class="ot">&lt;-</span> <span class="fu">sum</span>(mat[i, ] <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> mat[j, ] <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb848-42"><a href="基于模拟的假设检验.html#cb848-42" tabindex="-1"></a>      only_j <span class="ot">&lt;-</span> <span class="fu">sum</span>(mat[i, ] <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> mat[j, ] <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb848-43"><a href="基于模拟的假设检验.html#cb848-43" tabindex="-1"></a></span>
<span id="cb848-44"><a href="基于模拟的假设检验.html#cb848-44" tabindex="-1"></a>      c_scores[idx] <span class="ot">&lt;-</span> only_i <span class="sc">*</span> only_j</span>
<span id="cb848-45"><a href="基于模拟的假设检验.html#cb848-45" tabindex="-1"></a>      idx <span class="ot">&lt;-</span> idx <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb848-46"><a href="基于模拟的假设检验.html#cb848-46" tabindex="-1"></a>    }</span>
<span id="cb848-47"><a href="基于模拟的假设检验.html#cb848-47" tabindex="-1"></a>  }</span>
<span id="cb848-48"><a href="基于模拟的假设检验.html#cb848-48" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(c_scores))</span>
<span id="cb848-49"><a href="基于模拟的假设检验.html#cb848-49" tabindex="-1"></a>}</span>
<span id="cb848-50"><a href="基于模拟的假设检验.html#cb848-50" tabindex="-1"></a></span>
<span id="cb848-51"><a href="基于模拟的假设检验.html#cb848-51" tabindex="-1"></a>obs_c_score <span class="ot">&lt;-</span> <span class="fu">calc_c_score</span>(comm_matrix)</span>
<span id="cb848-52"><a href="基于模拟的假设检验.html#cb848-52" tabindex="-1"></a></span>
<span id="cb848-53"><a href="基于模拟的假设检验.html#cb848-53" tabindex="-1"></a><span class="co"># 零模型模拟：固定行和列总和</span></span>
<span id="cb848-54"><a href="基于模拟的假设检验.html#cb848-54" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb848-55"><a href="基于模拟的假设检验.html#cb848-55" tabindex="-1"></a>sim_c_scores <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb848-56"><a href="基于模拟的假设检验.html#cb848-56" tabindex="-1"></a></span>
<span id="cb848-57"><a href="基于模拟的假设检验.html#cb848-57" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb848-58"><a href="基于模拟的假设检验.html#cb848-58" tabindex="-1"></a>  <span class="co"># 使用swap算法随机化群落矩阵</span></span>
<span id="cb848-59"><a href="基于模拟的假设检验.html#cb848-59" tabindex="-1"></a>  sim_matrix <span class="ot">&lt;-</span> comm_matrix</span>
<span id="cb848-60"><a href="基于模拟的假设检验.html#cb848-60" tabindex="-1"></a></span>
<span id="cb848-61"><a href="基于模拟的假设检验.html#cb848-61" tabindex="-1"></a>  <span class="co"># 简单的随机化：保持行和列总和不变</span></span>
<span id="cb848-62"><a href="基于模拟的假设检验.html#cb848-62" tabindex="-1"></a>  <span class="co"># 在实际应用中可以使用更复杂的算法如swap算法</span></span>
<span id="cb848-63"><a href="基于模拟的假设检验.html#cb848-63" tabindex="-1"></a>  sim_matrix <span class="ot">&lt;-</span> <span class="fu">r2dtable</span>(<span class="dv">1</span>, <span class="fu">rowSums</span>(comm_matrix), <span class="fu">colSums</span>(comm_matrix))[[<span class="dv">1</span>]]</span>
<span id="cb848-64"><a href="基于模拟的假设检验.html#cb848-64" tabindex="-1"></a>  sim_matrix[sim_matrix <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb848-65"><a href="基于模拟的假设检验.html#cb848-65" tabindex="-1"></a></span>
<span id="cb848-66"><a href="基于模拟的假设检验.html#cb848-66" tabindex="-1"></a>  sim_c_scores[i] <span class="ot">&lt;-</span> <span class="fu">calc_c_score</span>(sim_matrix)</span>
<span id="cb848-67"><a href="基于模拟的假设检验.html#cb848-67" tabindex="-1"></a>}</span>
<span id="cb848-68"><a href="基于模拟的假设检验.html#cb848-68" tabindex="-1"></a></span>
<span id="cb848-69"><a href="基于模拟的假设检验.html#cb848-69" tabindex="-1"></a><span class="co"># 计算p值</span></span>
<span id="cb848-70"><a href="基于模拟的假设检验.html#cb848-70" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(sim_c_scores <span class="sc">&gt;=</span> obs_c_score)</span>
<span id="cb848-71"><a href="基于模拟的假设检验.html#cb848-71" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;观测C-score:&quot;</span>, obs_c_score, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 观测C-score: 13.67126</code></pre>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="基于模拟的假设检验.html#cb850-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;零模型检验p值:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 零模型检验p值: 0</code></pre>
<p>图<a href="基于模拟的假设检验.html#fig:c-score-null-dist">7.9</a>展示了群落组装零模型检验的C-score零分布：</p>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="基于模拟的假设检验.html#cb852-1" tabindex="-1"></a><span class="co"># 可视化零分布结果</span></span>
<span id="cb852-2"><a href="基于模拟的假设检验.html#cb852-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb852-3"><a href="基于模拟的假设检验.html#cb852-3" tabindex="-1"></a></span>
<span id="cb852-4"><a href="基于模拟的假设检验.html#cb852-4" tabindex="-1"></a><span class="co"># 创建零分布可视化数据</span></span>
<span id="cb852-5"><a href="基于模拟的假设检验.html#cb852-5" tabindex="-1"></a>null_dist_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">c_score =</span> sim_c_scores)</span>
<span id="cb852-6"><a href="基于模拟的假设检验.html#cb852-6" tabindex="-1"></a></span>
<span id="cb852-7"><a href="基于模拟的假设检验.html#cb852-7" tabindex="-1"></a><span class="fu">ggplot</span>(null_dist_df, <span class="fu">aes</span>(<span class="at">x =</span> c_score)) <span class="sc">+</span></span>
<span id="cb852-8"><a href="基于模拟的假设检验.html#cb852-8" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb852-9"><a href="基于模拟的假设检验.html#cb852-9" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> obs_c_score, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb852-10"><a href="基于模拟的假设检验.html#cb852-10" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb852-11"><a href="基于模拟的假设检验.html#cb852-11" tabindex="-1"></a>    <span class="at">x =</span> obs_c_score <span class="sc">*</span> <span class="fl">1.1</span>, <span class="at">y =</span> <span class="dv">50</span>,</span>
<span id="cb852-12"><a href="基于模拟的假设检验.html#cb852-12" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;观测C-score =&quot;</span>, <span class="fu">round</span>(obs_c_score, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb852-13"><a href="基于模拟的假设检验.html#cb852-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb852-14"><a href="基于模拟的假设检验.html#cb852-14" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb852-15"><a href="基于模拟的假设检验.html#cb852-15" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;群落组装零模型检验&quot;</span>,</span>
<span id="cb852-16"><a href="基于模拟的假设检验.html#cb852-16" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;C-score&quot;</span>, <span class="at">y =</span> <span class="st">&quot;频数&quot;</span>,</span>
<span id="cb852-17"><a href="基于模拟的假设检验.html#cb852-17" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;p值 =&quot;</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>))</span>
<span id="cb852-18"><a href="基于模拟的假设检验.html#cb852-18" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb852-19"><a href="基于模拟的假设检验.html#cb852-19" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:c-score-null-dist"></span>
<img src="07-simulation_based_tests_files/figure-html/c-score-null-dist-1.png" alt="热带雨林群落组装零模型检验：C-score零分布与观测值比较" width="672" />
<p class="caption">
图7.9: 热带雨林群落组装零模型检验：C-score零分布与观测值比较
</p>
</div>
<p>图<a href="基于模拟的假设检验.html#fig:community-matrix-heatmap">7.10</a>展示了热带雨林群落的物种分布热图：</p>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="基于模拟的假设检验.html#cb853-1" tabindex="-1"></a><span class="co"># 群落矩阵热图</span></span>
<span id="cb853-2"><a href="基于模拟的假设检验.html#cb853-2" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb853-3"><a href="基于模拟的假设检验.html#cb853-3" tabindex="-1"></a>comm_melt <span class="ot">&lt;-</span> <span class="fu">melt</span>(comm_matrix)</span>
<span id="cb853-4"><a href="基于模拟的假设检验.html#cb853-4" tabindex="-1"></a><span class="fu">colnames</span>(comm_melt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;物种&quot;</span>, <span class="st">&quot;样点&quot;</span>, <span class="st">&quot;存在&quot;</span>)</span>
<span id="cb853-5"><a href="基于模拟的假设检验.html#cb853-5" tabindex="-1"></a></span>
<span id="cb853-6"><a href="基于模拟的假设检验.html#cb853-6" tabindex="-1"></a><span class="fu">ggplot</span>(comm_melt, <span class="fu">aes</span>(<span class="at">x =</span> 样点, <span class="at">y =</span> 物种, <span class="at">fill =</span> <span class="fu">factor</span>(存在))) <span class="sc">+</span></span>
<span id="cb853-7"><a href="基于模拟的假设检验.html#cb853-7" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb853-8"><a href="基于模拟的假设检验.html#cb853-8" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>)) <span class="sc">+</span></span>
<span id="cb853-9"><a href="基于模拟的假设检验.html#cb853-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb853-10"><a href="基于模拟的假设检验.html#cb853-10" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;热带雨林群落物种分布&quot;</span>,</span>
<span id="cb853-11"><a href="基于模拟的假设检验.html#cb853-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;样点&quot;</span>, <span class="at">y =</span> <span class="st">&quot;物种&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;存在&quot;</span></span>
<span id="cb853-12"><a href="基于模拟的假设检验.html#cb853-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb853-13"><a href="基于模拟的假设检验.html#cb853-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb853-14"><a href="基于模拟的假设检验.html#cb853-14" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb853-15"><a href="基于模拟的假设检验.html#cb853-15" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb853-16"><a href="基于模拟的假设检验.html#cb853-16" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb853-17"><a href="基于模拟的假设检验.html#cb853-17" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:community-matrix-heatmap"></span>
<img src="07-simulation_based_tests_files/figure-html/community-matrix-heatmap-1.png" alt="热带雨林群落物种分布热图：基于环境梯度的物种分布模式" width="672" />
<p class="caption">
图7.10: 热带雨林群落物种分布热图：基于环境梯度的物种分布模式
</p>
</div>
<p><strong>生态学意义</strong>：如果零模型检验显示显著的C-score（p &lt; 0.05），表明树种的共现模式显著偏离随机期望。较高的C-score通常表示物种间存在竞争排斥——物种倾向于避免在相同的样点中共存。这支持了”竞争排斥”假说在热带雨林群落组装中的重要性。</p>
</div>
<div id="生态网络零模型检验" class="section level3 hasAnchor" number="7.10.3">
<h3><span class="header-section-number">7.10.3</span> 生态网络零模型检验<a href="基于模拟的假设检验.html#生态网络零模型检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>生态学问题背景</strong>：生态网络（如食物网、传粉网络、种子散布网络）是生态系统中物种间相互作用的复杂表现形式。理解生态网络的结构特征对于揭示生态系统的稳定性和功能至关重要。我们想要知道观测到的网络结构（如模块化、嵌套性、连接性）是否显著偏离随机期望。</p>
<p><strong>传统方法的挑战</strong>：传统的网络分析方法主要描述网络的结构特征，但难以评估这些特征是否具有统计显著性。网络结构的复杂性使得理论分布难以确定，特别是对于真实生态网络中常见的非随机模式。</p>
<p><strong>基于模拟的优势</strong>：生态网络零模型通过随机化网络结构来构建期望分布，能够： - 检验网络拓扑特征的统计显著性 - 区分不同生态过程对网络结构的影响 - 处理各种类型的生态网络（二分网络、加权网络等） - 考虑网络的生物学约束（如物种的生态位）</p>
<p><strong>生态学实例：检验传粉网络的嵌套结构</strong></p>
<p>假设我们研究地中海灌丛生态系统的传粉网络。我们记录了植物物种与传粉昆虫物种之间的相互作用，构建了一个传粉网络。我们想要检验这个网络是否具有显著的嵌套结构——一种常见的生态网络模式，其中特化物种倾向于与泛化物种的子集相互作用。</p>
<p><strong>零模型检验过程</strong>：</p>
<ol style="list-style-type: decimal">
<li><p><strong>构建零模型</strong>：使用不同的随机化算法</p>
<ul>
<li><strong>固定度分布</strong>：保持每个物种的连接数不变</li>
<li><strong>固定连接数</strong>：只保持网络的总连接数不变</li>
<li><strong>概率模型</strong>：基于物种特性生成随机网络</li>
</ul></li>
<li><p><strong>计算检验统计量</strong>：使用网络嵌套性指数，如：</p>
<ul>
<li><strong>NODF</strong>（Nestedness based on Overlap and Decreasing Fill）</li>
<li><strong>温度</strong>（Matrix Temperature）</li>
<li><strong>二分网络嵌套性</strong></li>
</ul></li>
<li><p><strong>随机化模拟</strong>：重复模拟1000次，每次计算嵌套性指数</p></li>
<li><p><strong>构建经验分布</strong>：基于模拟结果构建嵌套性指数的零分布</p></li>
<li><p><strong>计算p值</strong>：比较观测嵌套性与零分布的位置</p></li>
</ol>
<p><strong>R语言实现示例</strong>：</p>
<p>下面的代码展示了传粉网络嵌套性零模型检验的具体实现过程。首先我们模拟传粉网络数据并执行零模型分析：</p>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="基于模拟的假设检验.html#cb854-1" tabindex="-1"></a><span class="co"># 生态网络零模型检验：传粉网络嵌套性</span></span>
<span id="cb854-2"><a href="基于模拟的假设检验.html#cb854-2" tabindex="-1"></a><span class="fu">library</span>(bipartite)</span>
<span id="cb854-3"><a href="基于模拟的假设检验.html#cb854-3" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb854-4"><a href="基于模拟的假设检验.html#cb854-4" tabindex="-1"></a></span>
<span id="cb854-5"><a href="基于模拟的假设检验.html#cb854-5" tabindex="-1"></a><span class="co"># 模拟传粉网络数据（植物×传粉者矩阵）</span></span>
<span id="cb854-6"><a href="基于模拟的假设检验.html#cb854-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb854-7"><a href="基于模拟的假设检验.html#cb854-7" tabindex="-1"></a>n_plants <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb854-8"><a href="基于模拟的假设检验.html#cb854-8" tabindex="-1"></a>n_pollinators <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb854-9"><a href="基于模拟的假设检验.html#cb854-9" tabindex="-1"></a></span>
<span id="cb854-10"><a href="基于模拟的假设检验.html#cb854-10" tabindex="-1"></a><span class="co"># 创建嵌套结构的传粉网络</span></span>
<span id="cb854-11"><a href="基于模拟的假设检验.html#cb854-11" tabindex="-1"></a>pollination_network <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n_plants, <span class="at">ncol =</span> n_pollinators)</span>
<span id="cb854-12"><a href="基于模拟的假设检验.html#cb854-12" tabindex="-1"></a><span class="fu">rownames</span>(pollination_network) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;植物&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_plants)</span>
<span id="cb854-13"><a href="基于模拟的假设检验.html#cb854-13" tabindex="-1"></a><span class="fu">colnames</span>(pollination_network) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;传粉者&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_pollinators)</span>
<span id="cb854-14"><a href="基于模拟的假设检验.html#cb854-14" tabindex="-1"></a></span>
<span id="cb854-15"><a href="基于模拟的假设检验.html#cb854-15" tabindex="-1"></a><span class="co"># 生成嵌套结构</span></span>
<span id="cb854-16"><a href="基于模拟的假设检验.html#cb854-16" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_plants) {</span>
<span id="cb854-17"><a href="基于模拟的假设检验.html#cb854-17" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_pollinators) {</span>
<span id="cb854-18"><a href="基于模拟的假设检验.html#cb854-18" tabindex="-1"></a>    <span class="co"># 嵌套结构：特化物种与泛化物种的子集相互作用</span></span>
<span id="cb854-19"><a href="基于模拟的假设检验.html#cb854-19" tabindex="-1"></a>    prob <span class="ot">&lt;-</span> (n_plants <span class="sc">-</span> i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n_plants <span class="sc">*</span></span>
<span id="cb854-20"><a href="基于模拟的假设检验.html#cb854-20" tabindex="-1"></a>      (n_pollinators <span class="sc">-</span> j <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n_pollinators</span>
<span id="cb854-21"><a href="基于模拟的假设检验.html#cb854-21" tabindex="-1"></a>    pollination_network[i, j] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="dv">1</span>, prob <span class="sc">*</span> <span class="fl">0.8</span>)</span>
<span id="cb854-22"><a href="基于模拟的假设检验.html#cb854-22" tabindex="-1"></a>  }</span>
<span id="cb854-23"><a href="基于模拟的假设检验.html#cb854-23" tabindex="-1"></a>}</span>
<span id="cb854-24"><a href="基于模拟的假设检验.html#cb854-24" tabindex="-1"></a></span>
<span id="cb854-25"><a href="基于模拟的假设检验.html#cb854-25" tabindex="-1"></a><span class="co"># 计算观测嵌套性（NODF）</span></span>
<span id="cb854-26"><a href="基于模拟的假设检验.html#cb854-26" tabindex="-1"></a>obs_nestedness <span class="ot">&lt;-</span> <span class="fu">nested</span>(pollination_network, <span class="at">method =</span> <span class="st">&quot;NODF2&quot;</span>)</span>
<span id="cb854-27"><a href="基于模拟的假设检验.html#cb854-27" tabindex="-1"></a></span>
<span id="cb854-28"><a href="基于模拟的假设检验.html#cb854-28" tabindex="-1"></a><span class="co"># 零模型模拟：固定行和列总和</span></span>
<span id="cb854-29"><a href="基于模拟的假设检验.html#cb854-29" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb854-30"><a href="基于模拟的假设检验.html#cb854-30" tabindex="-1"></a>sim_nestedness <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb854-31"><a href="基于模拟的假设检验.html#cb854-31" tabindex="-1"></a></span>
<span id="cb854-32"><a href="基于模拟的假设检验.html#cb854-32" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb854-33"><a href="基于模拟的假设检验.html#cb854-33" tabindex="-1"></a>  <span class="co"># 使用nullmodel函数生成零模型</span></span>
<span id="cb854-34"><a href="基于模拟的假设检验.html#cb854-34" tabindex="-1"></a>  sim_network <span class="ot">&lt;-</span> pollination_network</span>
<span id="cb854-35"><a href="基于模拟的假设检验.html#cb854-35" tabindex="-1"></a></span>
<span id="cb854-36"><a href="基于模拟的假设检验.html#cb854-36" tabindex="-1"></a>  <span class="co"># 保持行和列总和不变的随机化</span></span>
<span id="cb854-37"><a href="基于模拟的假设检验.html#cb854-37" tabindex="-1"></a>  sim_network <span class="ot">&lt;-</span> <span class="fu">r2dtable</span>(</span>
<span id="cb854-38"><a href="基于模拟的假设检验.html#cb854-38" tabindex="-1"></a>    <span class="dv">1</span>, <span class="fu">rowSums</span>(pollination_network),</span>
<span id="cb854-39"><a href="基于模拟的假设检验.html#cb854-39" tabindex="-1"></a>    <span class="fu">colSums</span>(pollination_network)</span>
<span id="cb854-40"><a href="基于模拟的假设检验.html#cb854-40" tabindex="-1"></a>  )[[<span class="dv">1</span>]]</span>
<span id="cb854-41"><a href="基于模拟的假设检验.html#cb854-41" tabindex="-1"></a>  sim_network[sim_network <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb854-42"><a href="基于模拟的假设检验.html#cb854-42" tabindex="-1"></a></span>
<span id="cb854-43"><a href="基于模拟的假设检验.html#cb854-43" tabindex="-1"></a>  sim_nestedness[i] <span class="ot">&lt;-</span> <span class="fu">nested</span>(sim_network, <span class="at">method =</span> <span class="st">&quot;NODF2&quot;</span>)</span>
<span id="cb854-44"><a href="基于模拟的假设检验.html#cb854-44" tabindex="-1"></a>}</span>
<span id="cb854-45"><a href="基于模拟的假设检验.html#cb854-45" tabindex="-1"></a></span>
<span id="cb854-46"><a href="基于模拟的假设检验.html#cb854-46" tabindex="-1"></a><span class="co"># 计算p值</span></span>
<span id="cb854-47"><a href="基于模拟的假设检验.html#cb854-47" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(sim_nestedness <span class="sc">&gt;=</span> obs_nestedness)</span>
<span id="cb854-48"><a href="基于模拟的假设检验.html#cb854-48" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;观测嵌套性(NODF):&quot;</span>, obs_nestedness, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 观测嵌套性(NODF): 25.46973</code></pre>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="基于模拟的假设检验.html#cb856-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;零模型检验p值:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 零模型检验p值: 0.014</code></pre>
<p>图<a href="基于模拟的假设检验.html#fig:nestedness-null-dist">7.11</a>展示了传粉网络嵌套性零模型检验的零分布：</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="基于模拟的假设检验.html#cb858-1" tabindex="-1"></a><span class="co"># 可视化零分布结果</span></span>
<span id="cb858-2"><a href="基于模拟的假设检验.html#cb858-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb858-3"><a href="基于模拟的假设检验.html#cb858-3" tabindex="-1"></a></span>
<span id="cb858-4"><a href="基于模拟的假设检验.html#cb858-4" tabindex="-1"></a><span class="co"># 创建零分布可视化数据</span></span>
<span id="cb858-5"><a href="基于模拟的假设检验.html#cb858-5" tabindex="-1"></a>null_dist_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">nestedness =</span> sim_nestedness)</span>
<span id="cb858-6"><a href="基于模拟的假设检验.html#cb858-6" tabindex="-1"></a></span>
<span id="cb858-7"><a href="基于模拟的假设检验.html#cb858-7" tabindex="-1"></a><span class="fu">ggplot</span>(null_dist_df, <span class="fu">aes</span>(<span class="at">x =</span> nestedness)) <span class="sc">+</span></span>
<span id="cb858-8"><a href="基于模拟的假设检验.html#cb858-8" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb858-9"><a href="基于模拟的假设检验.html#cb858-9" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> obs_nestedness, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb858-10"><a href="基于模拟的假设检验.html#cb858-10" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb858-11"><a href="基于模拟的假设检验.html#cb858-11" tabindex="-1"></a>    <span class="at">x =</span> obs_nestedness <span class="sc">*</span> <span class="fl">1.1</span>, <span class="at">y =</span> <span class="dv">50</span>,</span>
<span id="cb858-12"><a href="基于模拟的假设检验.html#cb858-12" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;观测嵌套性 =&quot;</span>, <span class="fu">round</span>(obs_nestedness, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb858-13"><a href="基于模拟的假设检验.html#cb858-13" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb858-14"><a href="基于模拟的假设检验.html#cb858-14" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb858-15"><a href="基于模拟的假设检验.html#cb858-15" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;传粉网络嵌套性零模型检验&quot;</span>,</span>
<span id="cb858-16"><a href="基于模拟的假设检验.html#cb858-16" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;嵌套性(NODF)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;频数&quot;</span>,</span>
<span id="cb858-17"><a href="基于模拟的假设检验.html#cb858-17" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;p值 =&quot;</span>, <span class="fu">round</span>(p_value, <span class="dv">4</span>))</span>
<span id="cb858-18"><a href="基于模拟的假设检验.html#cb858-18" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb858-19"><a href="基于模拟的假设检验.html#cb858-19" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:nestedness-null-dist"></span>
<img src="07-simulation_based_tests_files/figure-html/nestedness-null-dist-1.png" alt="传粉网络嵌套性零模型检验：嵌套性零分布与观测值比较" width="672" />
<p class="caption">
图7.11: 传粉网络嵌套性零模型检验：嵌套性零分布与观测值比较
</p>
</div>
<p>图<a href="基于模拟的假设检验.html#fig:pollination-network-structure">7.12</a>展示了传粉网络的结构图：</p>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="基于模拟的假设检验.html#cb859-1" tabindex="-1"></a><span class="co"># 网络可视化</span></span>
<span id="cb859-2"><a href="基于模拟的假设检验.html#cb859-2" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb859-3"><a href="基于模拟的假设检验.html#cb859-3" tabindex="-1"></a></span>
<span id="cb859-4"><a href="基于模拟的假设检验.html#cb859-4" tabindex="-1"></a><span class="co"># 创建二分网络</span></span>
<span id="cb859-5"><a href="基于模拟的假设检验.html#cb859-5" tabindex="-1"></a>bipartite_graph <span class="ot">&lt;-</span> <span class="fu">graph.incidence</span>(pollination_network)</span>
<span id="cb859-6"><a href="基于模拟的假设检验.html#cb859-6" tabindex="-1"></a></span>
<span id="cb859-7"><a href="基于模拟的假设检验.html#cb859-7" tabindex="-1"></a><span class="co"># 设置顶点颜色和形状</span></span>
<span id="cb859-8"><a href="基于模拟的假设检验.html#cb859-8" tabindex="-1"></a><span class="fu">V</span>(bipartite_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(bipartite_graph)<span class="sc">$</span>type,</span>
<span id="cb859-9"><a href="基于模拟的假设检验.html#cb859-9" tabindex="-1"></a>                                   <span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;yellow&quot;</span>)</span>
<span id="cb859-10"><a href="基于模拟的假设检验.html#cb859-10" tabindex="-1"></a><span class="fu">V</span>(bipartite_graph)<span class="sc">$</span>shape <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(bipartite_graph)<span class="sc">$</span>type, <span class="st">&quot;square&quot;</span>, <span class="st">&quot;circle&quot;</span>)</span>
<span id="cb859-11"><a href="基于模拟的假设检验.html#cb859-11" tabindex="-1"></a><span class="fu">V</span>(bipartite_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb859-12"><a href="基于模拟的假设检验.html#cb859-12" tabindex="-1"></a><span class="fu">V</span>(bipartite_graph)<span class="sc">$</span>label.cex <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb859-13"><a href="基于模拟的假设检验.html#cb859-13" tabindex="-1"></a></span>
<span id="cb859-14"><a href="基于模拟的假设检验.html#cb859-14" tabindex="-1"></a><span class="co"># 绘制网络图</span></span>
<span id="cb859-15"><a href="基于模拟的假设检验.html#cb859-15" tabindex="-1"></a><span class="fu">plot</span>(bipartite_graph,</span>
<span id="cb859-16"><a href="基于模拟的假设检验.html#cb859-16" tabindex="-1"></a>  <span class="at">layout =</span> layout.bipartite,</span>
<span id="cb859-17"><a href="基于模拟的假设检验.html#cb859-17" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;传粉网络结构&quot;</span>,</span>
<span id="cb859-18"><a href="基于模拟的假设检验.html#cb859-18" tabindex="-1"></a>  <span class="at">vertex.label =</span> <span class="cn">NA</span></span>
<span id="cb859-19"><a href="基于模拟的假设检验.html#cb859-19" tabindex="-1"></a>)</span>
<span id="cb859-20"><a href="基于模拟的假设检验.html#cb859-20" tabindex="-1"></a></span>
<span id="cb859-21"><a href="基于模拟的假设检验.html#cb859-21" tabindex="-1"></a><span class="co"># 添加图例</span></span>
<span id="cb859-22"><a href="基于模拟的假设检验.html#cb859-22" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>,</span>
<span id="cb859-23"><a href="基于模拟的假设检验.html#cb859-23" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;植物&quot;</span>, <span class="st">&quot;传粉者&quot;</span>),</span>
<span id="cb859-24"><a href="基于模拟的假设检验.html#cb859-24" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>),</span>
<span id="cb859-25"><a href="基于模拟的假设检验.html#cb859-25" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;yellow&quot;</span>),</span>
<span id="cb859-26"><a href="基于模拟的假设检验.html#cb859-26" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb859-27"><a href="基于模拟的假设检验.html#cb859-27" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:pollination-network-structure"></span>
<img src="07-simulation_based_tests_files/figure-html/pollination-network-structure-1.png" alt="传粉网络结构可视化：植物与传粉者的二分网络" width="672" />
<p class="caption">
图7.12: 传粉网络结构可视化：植物与传粉者的二分网络
</p>
</div>
<p>图<a href="基于模拟的假设检验.html#fig:pollination-matrix-heatmap">7.13</a>展示了传粉网络相互作用的矩阵热图：</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="基于模拟的假设检验.html#cb860-1" tabindex="-1"></a><span class="co"># 网络矩阵热图</span></span>
<span id="cb860-2"><a href="基于模拟的假设检验.html#cb860-2" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb860-3"><a href="基于模拟的假设检验.html#cb860-3" tabindex="-1"></a>network_melt <span class="ot">&lt;-</span> <span class="fu">melt</span>(pollination_network)</span>
<span id="cb860-4"><a href="基于模拟的假设检验.html#cb860-4" tabindex="-1"></a><span class="fu">colnames</span>(network_melt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;植物&quot;</span>, <span class="st">&quot;传粉者&quot;</span>, <span class="st">&quot;相互作用&quot;</span>)</span>
<span id="cb860-5"><a href="基于模拟的假设检验.html#cb860-5" tabindex="-1"></a></span>
<span id="cb860-6"><a href="基于模拟的假设检验.html#cb860-6" tabindex="-1"></a><span class="fu">ggplot</span>(network_melt, <span class="fu">aes</span>(<span class="at">x =</span> 传粉者, <span class="at">y =</span> 植物, <span class="at">fill =</span> <span class="fu">factor</span>(相互作用))) <span class="sc">+</span></span>
<span id="cb860-7"><a href="基于模拟的假设检验.html#cb860-7" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb860-8"><a href="基于模拟的假设检验.html#cb860-8" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;purple&quot;</span>)) <span class="sc">+</span></span>
<span id="cb860-9"><a href="基于模拟的假设检验.html#cb860-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb860-10"><a href="基于模拟的假设检验.html#cb860-10" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;传粉网络相互作用矩阵&quot;</span>,</span>
<span id="cb860-11"><a href="基于模拟的假设检验.html#cb860-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;传粉者&quot;</span>, <span class="at">y =</span> <span class="st">&quot;植物&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;相互作用&quot;</span></span>
<span id="cb860-12"><a href="基于模拟的假设检验.html#cb860-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb860-13"><a href="基于模拟的假设检验.html#cb860-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb860-14"><a href="基于模拟的假设检验.html#cb860-14" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb860-15"><a href="基于模拟的假设检验.html#cb860-15" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb860-16"><a href="基于模拟的假设检验.html#cb860-16" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb860-17"><a href="基于模拟的假设检验.html#cb860-17" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:pollination-matrix-heatmap"></span>
<img src="07-simulation_based_tests_files/figure-html/pollination-matrix-heatmap-1.png" alt="传粉网络相互作用矩阵热图：嵌套结构的可视化" width="672" />
<p class="caption">
图7.13: 传粉网络相互作用矩阵热图：嵌套结构的可视化
</p>
</div>
<p><strong>生态学意义</strong>：如果零模型检验显示显著的嵌套性（p &lt; 0.05），表明传粉网络的结构确实具有嵌套模式。嵌套结构通常被认为能够增强生态网络的稳定性和韧性——当某些物种消失时，嵌套结构有助于维持网络的连接性。这种结构信息对于理解传粉服务的稳定性和设计保护策略具有重要意义。</p>
</div>
<div id="零模型检验的方法学比较与选择" class="section level3 hasAnchor" number="7.10.4">
<h3><span class="header-section-number">7.10.4</span> 零模型检验的方法学比较与选择<a href="基于模拟的假设检验.html#零模型检验的方法学比较与选择" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>不同类型的零模型算法</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>完全随机模型</strong>：
<ul>
<li>算法：完全随机重排相互作用</li>
<li>适用场景：检验网络连接性的非随机性</li>
<li>生态学意义：最基本的零模型，检验是否存在任何非随机结构</li>
</ul></li>
<li><strong>固定度分布模型</strong>：
<ul>
<li>算法：保持每个物种的连接数不变</li>
<li>适用场景：检验网络结构的其他特征（如嵌套性、模块化）</li>
<li>生态学意义：考虑物种生态位宽度的约束</li>
</ul></li>
<li><strong>概率模型</strong>：
<ul>
<li>算法：基于物种特性生成随机网络</li>
<li>适用场景：检验特定生态假说</li>
<li>生态学意义：整合生物学知识构建更真实的零模型</li>
</ul></li>
</ol>
<p><strong>生态学研究的最佳实践</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>多模型比较</strong>：使用多种零模型算法相互验证</li>
<li><strong>生物学合理性</strong>：选择与生态过程相符的随机化算法</li>
<li><strong>敏感性分析</strong>：检验结果对不同零模型算法的敏感性</li>
<li><strong>生态学解释</strong>：结合生态学机制解释统计结果</li>
</ol>
<p><strong>R语言中的零模型分析工具</strong>：</p>
<p>下面的代码展示了常用的零模型分析工具及其应用。首先我们加载相关包并执行物种共现零模型分析：</p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="基于模拟的假设检验.html#cb861-1" tabindex="-1"></a><span class="co"># 常用的零模型分析包</span></span>
<span id="cb861-2"><a href="基于模拟的假设检验.html#cb861-2" tabindex="-1"></a><span class="fu">library</span>(vegan) <span class="co"># 群落生态学零模型</span></span>
<span id="cb861-3"><a href="基于模拟的假设检验.html#cb861-3" tabindex="-1"></a><span class="fu">library</span>(bipartite) <span class="co"># 二分网络零模型</span></span>
<span id="cb861-4"><a href="基于模拟的假设检验.html#cb861-4" tabindex="-1"></a><span class="fu">library</span>(igraph) <span class="co"># 网络分析</span></span>
<span id="cb861-5"><a href="基于模拟的假设检验.html#cb861-5" tabindex="-1"></a><span class="fu">library</span>(EcoSimR) <span class="co"># 生态学零模型</span></span>
<span id="cb861-6"><a href="基于模拟的假设检验.html#cb861-6" tabindex="-1"></a><span class="fu">library</span>(spaa) <span class="co"># 物种关联分析</span></span>
<span id="cb861-7"><a href="基于模拟的假设检验.html#cb861-7" tabindex="-1"></a></span>
<span id="cb861-8"><a href="基于模拟的假设检验.html#cb861-8" tabindex="-1"></a><span class="co"># EcoSimR包中的零模型分析示例</span></span>
<span id="cb861-9"><a href="基于模拟的假设检验.html#cb861-9" tabindex="-1"></a><span class="fu">library</span>(EcoSimR)</span>
<span id="cb861-10"><a href="基于模拟的假设检验.html#cb861-10" tabindex="-1"></a></span>
<span id="cb861-11"><a href="基于模拟的假设检验.html#cb861-11" tabindex="-1"></a><span class="co"># 物种共现零模型</span></span>
<span id="cb861-12"><a href="基于模拟的假设检验.html#cb861-12" tabindex="-1"></a><span class="co"># 使用固定行和列总和的算法</span></span>
<span id="cb861-13"><a href="基于模拟的假设检验.html#cb861-13" tabindex="-1"></a>cooc_null <span class="ot">&lt;-</span> <span class="fu">cooc_null_model</span>(comm_matrix,</span>
<span id="cb861-14"><a href="基于模拟的假设检验.html#cb861-14" tabindex="-1"></a>  <span class="at">algo =</span> <span class="st">&quot;sim9&quot;</span>,</span>
<span id="cb861-15"><a href="基于模拟的假设检验.html#cb861-15" tabindex="-1"></a>  <span class="at">nReps =</span> <span class="dv">1000</span>,</span>
<span id="cb861-16"><a href="基于模拟的假设检验.html#cb861-16" tabindex="-1"></a>  <span class="at">suppressProg =</span> <span class="cn">TRUE</span></span>
<span id="cb861-17"><a href="基于模拟的假设检验.html#cb861-17" tabindex="-1"></a>)</span>
<span id="cb861-18"><a href="基于模拟的假设检验.html#cb861-18" tabindex="-1"></a></span>
<span id="cb861-19"><a href="基于模拟的假设检验.html#cb861-19" tabindex="-1"></a><span class="fu">summary</span>(cooc_null)</span></code></pre></div>
<pre><code>## Time Stamp:  Tue Oct  7 08:58:22 2025 
## Reproducible:  
## Number of Replications:  
## Elapsed Time:  0.18 secs 
## Metric:  c_score 
## Algorithm:  sim9 
## Observed Index:  13.671 
## Mean Of Simulated Index:  12.275 
## Variance Of Simulated Index:  0.0081194 
## Lower 95% (1-tail):  12.138 
## Upper 95% (1-tail):  12.432 
## Lower 95% (2-tail):  12.113 
## Upper 95% (2-tail):  12.469 
## Lower-tail P &gt;  0.999 
## Upper-tail P &lt;  0.001 
## Observed metric &gt; 1000 simulated metrics 
## Observed metric &lt; 0 simulated metrics 
## Observed metric = 0 simulated metrics 
## Standardized Effect Size (SES):  15.494</code></pre>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="基于模拟的假设检验.html#cb863-1" tabindex="-1"></a><span class="co"># 网络嵌套性零模型</span></span>
<span id="cb863-2"><a href="基于模拟的假设检验.html#cb863-2" tabindex="-1"></a><span class="co"># 使用vegan包中的permatswap函数</span></span>
<span id="cb863-3"><a href="基于模拟的假设检验.html#cb863-3" tabindex="-1"></a>net_null <span class="ot">&lt;-</span> <span class="fu">permatswap</span>(pollination_network, <span class="at">method =</span> <span class="st">&quot;quasiswap&quot;</span>, <span class="at">times =</span> <span class="dv">1000</span>)</span>
<span id="cb863-4"><a href="基于模拟的假设检验.html#cb863-4" tabindex="-1"></a></span>
<span id="cb863-5"><a href="基于模拟的假设检验.html#cb863-5" tabindex="-1"></a><span class="co"># 提取模拟结果并计算嵌套性</span></span>
<span id="cb863-6"><a href="基于模拟的假设检验.html#cb863-6" tabindex="-1"></a>null_results <span class="ot">&lt;-</span> <span class="fu">sapply</span>(net_null<span class="sc">$</span>perm, <span class="cf">function</span>(mat) {</span>
<span id="cb863-7"><a href="基于模拟的假设检验.html#cb863-7" tabindex="-1"></a>  <span class="fu">nested</span>(mat, <span class="at">method =</span> <span class="st">&quot;NODF2&quot;</span>)</span>
<span id="cb863-8"><a href="基于模拟的假设检验.html#cb863-8" tabindex="-1"></a>})</span>
<span id="cb863-9"><a href="基于模拟的假设检验.html#cb863-9" tabindex="-1"></a></span>
<span id="cb863-10"><a href="基于模拟的假设检验.html#cb863-10" tabindex="-1"></a><span class="co"># 计算观测嵌套性</span></span>
<span id="cb863-11"><a href="基于模拟的假设检验.html#cb863-11" tabindex="-1"></a>obs_nestedness <span class="ot">&lt;-</span> <span class="fu">nested</span>(pollination_network, <span class="at">method =</span> <span class="st">&quot;NODF2&quot;</span>)</span>
<span id="cb863-12"><a href="基于模拟的假设检验.html#cb863-12" tabindex="-1"></a></span>
<span id="cb863-13"><a href="基于模拟的假设检验.html#cb863-13" tabindex="-1"></a><span class="co"># 计算p值</span></span>
<span id="cb863-14"><a href="基于模拟的假设检验.html#cb863-14" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(null_results <span class="sc">&gt;=</span> obs_nestedness)</span>
<span id="cb863-15"><a href="基于模拟的假设检验.html#cb863-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;观测嵌套性:&quot;</span>, obs_nestedness, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 观测嵌套性: 25.46973</code></pre>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="基于模拟的假设检验.html#cb865-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## p值: 0.628</code></pre>
<p>图<a href="基于模拟的假设检验.html#fig:cooc-null-model-plot">7.14</a>展示了EcoSimR包中物种共现零模型的检验结果：</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="基于模拟的假设检验.html#cb867-1" tabindex="-1"></a><span class="co"># 可视化物种共现零模型结果</span></span>
<span id="cb867-2"><a href="基于模拟的假设检验.html#cb867-2" tabindex="-1"></a><span class="fu">plot</span>(cooc_null)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cooc-null-model-plot"></span>
<img src="07-simulation_based_tests_files/figure-html/cooc-null-model-plot-1.png" alt="物种共现零模型检验：EcoSimR包分析结果" width="672" />
<p class="caption">
图7.14: 物种共现零模型检验：EcoSimR包分析结果
</p>
</div>
<p>图<a href="基于模拟的假设检验.html#fig:nestedness-null-hist">7.15</a>展示了网络嵌套性零模型的零分布直方图：</p>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="基于模拟的假设检验.html#cb868-1" tabindex="-1"></a><span class="co"># 可视化嵌套性零分布</span></span>
<span id="cb868-2"><a href="基于模拟的假设检验.html#cb868-2" tabindex="-1"></a><span class="fu">hist</span>(null_results, <span class="at">main =</span> <span class="st">&quot;嵌套性零分布&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;嵌套性指数&quot;</span>)</span>
<span id="cb868-3"><a href="基于模拟的假设检验.html#cb868-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> obs_nestedness, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:nestedness-null-hist"></span>
<img src="07-simulation_based_tests_files/figure-html/nestedness-null-hist-1.png" alt="网络嵌套性零模型检验：嵌套性指数零分布" width="672" />
<p class="caption">
图7.15: 网络嵌套性零模型检验：嵌套性指数零分布
</p>
</div>
</div>
<div id="生态学应用与保护意义-1" class="section level3 hasAnchor" number="7.10.5">
<h3><span class="header-section-number">7.10.5</span> 生态学应用与保护意义<a href="基于模拟的假设检验.html#生态学应用与保护意义-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>保护生物学应用</strong>： - <strong>保护区设计</strong>：基于物种共现模式优化保护区网络 - <strong>入侵物种风险评估</strong>：检验外来物种与本地物种的相互作用模式 - <strong>生态系统恢复</strong>：评估恢复后群落的组装过程</p>
<p><strong>群落生态学应用</strong>： - <strong>群落构建机制</strong>：区分环境过滤、竞争排斥、扩散限制的相对重要性 - <strong>生物多样性维持</strong>：理解物种共存机制 - <strong>生态系统功能</strong>：检验网络结构与生态系统功能的关系</p>
<p><strong>全球变化研究</strong>： - <strong>气候变化响应</strong>：监测群落结构对气候变化的响应 - <strong>栖息地破碎化</strong>：检验生境破碎对物种相互作用的影响 - <strong>物种分布变化</strong>：预测物种分布范围变化的生态后果</p>
<p><strong>生态学意义</strong>：零模型检验为生态学家提供了强大的统计工具来检验生态学假说。通过构建合理的随机期望，我们能够更可靠地推断观测生态模式的形成机制，为理解生态过程、预测生态系统变化和制定有效的保护策略提供坚实的科学基础。这些方法特别适合处理生态学中常见的复杂模式和小样本问题，是现代生态学研究不可或缺的统计工具。</p>
</div>
</div>
<div id="总结-7" class="section level2 hasAnchor" number="7.11">
<h2><span class="header-section-number">7.11</span> 总结<a href="基于模拟的假设检验.html#总结-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="综合练习-5" class="section level2 hasAnchor" number="7.12">
<h2><span class="header-section-number">7.12</span> 综合练习<a href="基于模拟的假设检验.html#综合练习-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="基于经典分布的假设检验.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="简单线性回归模型.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": false,
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["ecological-statistics.pdf", "ecological-statistics.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
