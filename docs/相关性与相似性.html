<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 相关性与相似性 | 生态统计学</title>
  <meta name="description" content="5 相关性与相似性 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="5 相关性与相似性 | 生态统计学" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="5 相关性与相似性 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 相关性与相似性 | 生态统计学" />
  
  <meta name="twitter:description" content="5 相关性与相似性 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  

<meta name="author" content="沈国春、李勤" />


<meta name="date" content="2025-10-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="参数估计.html"/>
<link rel="next" href="基于经典分布的假设检验.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7cbaf067c715044120ee231397e9ace3";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">生态统计学</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#为什么要学生态统计"><i class="fa fa-check"></i><b>0.1</b> 为什么要学生态统计</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#在不确定的世界中寻找规律"><i class="fa fa-check"></i><b>0.1.1</b> 在不确定的世界中寻找规律</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#ai时代的机遇与陷阱"><i class="fa fa-check"></i><b>0.1.2</b> AI时代的机遇与陷阱</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#本书介绍"><i class="fa fa-check"></i><b>0.2</b> 本书介绍</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#课程在线资源"><i class="fa fa-check"></i><b>0.3</b> 课程在线资源</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#学习方式"><i class="fa fa-check"></i><b>0.4</b> 学习方式</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="统计编程基础.html"><a href="统计编程基础.html"><i class="fa fa-check"></i><b>1</b> 统计编程基础</a>
<ul>
<li class="chapter" data-level="1.1" data-path="统计编程基础.html"><a href="统计编程基础.html#引言"><i class="fa fa-check"></i><b>1.1</b> 引言</a></li>
<li class="chapter" data-level="1.2" data-path="统计编程基础.html"><a href="统计编程基础.html#核心能力培养框架"><i class="fa fa-check"></i><b>1.2</b> 核心能力培养框架</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="统计编程基础.html"><a href="统计编程基础.html#高阶思维与问题解决能力"><i class="fa fa-check"></i><b>1.2.1</b> 高阶思维与问题解决能力</a></li>
<li class="chapter" data-level="1.2.2" data-path="统计编程基础.html"><a href="统计编程基础.html#与llm协同工作的能力"><i class="fa fa-check"></i><b>1.2.2</b> 与LLM协同工作的能力</a></li>
<li class="chapter" data-level="1.2.3" data-path="统计编程基础.html"><a href="统计编程基础.html#传统但愈发重要的软技能"><i class="fa fa-check"></i><b>1.2.3</b> 传统但愈发重要的软技能</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="统计编程基础.html"><a href="统计编程基础.html#通用编程思维基础"><i class="fa fa-check"></i><b>1.3</b> 通用编程思维基础</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="统计编程基础.html"><a href="统计编程基础.html#编程核心概念"><i class="fa fa-check"></i><b>1.3.1</b> 编程核心概念</a></li>
<li class="chapter" data-level="1.3.2" data-path="统计编程基础.html"><a href="统计编程基础.html#算法复杂度"><i class="fa fa-check"></i><b>1.3.2</b> 算法复杂度</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="统计编程基础.html"><a href="统计编程基础.html#ai协同编程技能"><i class="fa fa-check"></i><b>1.4</b> AI协同编程技能</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="统计编程基础.html"><a href="统计编程基础.html#ai编程模块安装"><i class="fa fa-check"></i><b>1.4.1</b> AI编程模块安装</a></li>
<li class="chapter" data-level="1.4.2" data-path="统计编程基础.html"><a href="统计编程基础.html#精准提问技巧"><i class="fa fa-check"></i><b>1.4.2</b> 精准提问技巧</a></li>
<li class="chapter" data-level="1.4.3" data-path="统计编程基础.html"><a href="统计编程基础.html#代码审查能力"><i class="fa fa-check"></i><b>1.4.3</b> 代码审查能力</a></li>
<li class="chapter" data-level="1.4.4" data-path="统计编程基础.html"><a href="统计编程基础.html#调试与错误处理"><i class="fa fa-check"></i><b>1.4.4</b> 调试与错误处理</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="统计编程基础.html"><a href="统计编程基础.html#总结"><i class="fa fa-check"></i><b>1.5</b> 总结</a></li>
<li class="chapter" data-level="1.6" data-path="统计编程基础.html"><a href="统计编程基础.html#综合练习"><i class="fa fa-check"></i><b>1.6</b> 综合练习</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="统计编程基础.html"><a href="统计编程基础.html#练习1"><i class="fa fa-check"></i><b>1.6.1</b> 练习1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="概率与分布.html"><a href="概率与分布.html"><i class="fa fa-check"></i><b>2</b> 概率与分布</a>
<ul>
<li class="chapter" data-level="2.1" data-path="概率与分布.html"><a href="概率与分布.html#引言-1"><i class="fa fa-check"></i><b>2.1</b> 引言</a></li>
<li class="chapter" data-level="2.2" data-path="概率与分布.html"><a href="概率与分布.html#蚂蚱午餐与概率"><i class="fa fa-check"></i><b>2.2</b> 蚂蚱午餐与概率</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="概率与分布.html"><a href="概率与分布.html#一只蚱蜢的午餐"><i class="fa fa-check"></i><b>2.2.1</b> 一只蚱蜢的午餐</a></li>
<li class="chapter" data-level="2.2.2" data-path="概率与分布.html"><a href="概率与分布.html#理想的猜测古典概率"><i class="fa fa-check"></i><b>2.2.2</b> 理想的猜测——古典概率</a></li>
<li class="chapter" data-level="2.2.3" data-path="概率与分布.html"><a href="概率与分布.html#数据的语言频率概率"><i class="fa fa-check"></i><b>2.2.3</b> 数据的语言——频率概率</a></li>
<li class="chapter" data-level="2.2.4" data-path="概率与分布.html"><a href="概率与分布.html#动态的更新贝叶斯概率"><i class="fa fa-check"></i><b>2.2.4</b> 动态的更新——贝叶斯概率</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="概率与分布.html"><a href="概率与分布.html#随机变量与分布"><i class="fa fa-check"></i><b>2.3</b> 随机变量与分布</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="概率与分布.html"><a href="概率与分布.html#概率分布"><i class="fa fa-check"></i><b>2.3.1</b> 概率分布</a></li>
<li class="chapter" data-level="2.3.2" data-path="概率与分布.html"><a href="概率与分布.html#累积概率分布从可能性到确定性"><i class="fa fa-check"></i><b>2.3.2</b> 累积概率分布：从可能性到确定性</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="概率与分布.html"><a href="概率与分布.html#午餐菜单离散随机变量的分布家族"><i class="fa fa-check"></i><b>2.4</b> 午餐菜单：离散随机变量的分布家族</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="概率与分布.html"><a href="概率与分布.html#伯努利分布一个是或否的终极问题"><i class="fa fa-check"></i><b>2.4.1</b> 伯努利分布：一个”是”或”否”的终极问题</a></li>
<li class="chapter" data-level="2.4.2" data-path="概率与分布.html"><a href="概率与分布.html#二项分布重复是非题的计数法则"><i class="fa fa-check"></i><b>2.4.2</b> 二项分布：重复”是非题”的计数法则</a></li>
<li class="chapter" data-level="2.4.3" data-path="概率与分布.html"><a href="概率与分布.html#多项式分布多元选择的全景图"><i class="fa fa-check"></i><b>2.4.3</b> 多项式分布：多元选择的”全景图”</a></li>
<li class="chapter" data-level="2.4.4" data-path="概率与分布.html"><a href="概率与分布.html#泊松分布罕见事件的低语者"><i class="fa fa-check"></i><b>2.4.4</b> 泊松分布：罕见事件的”低语者”</a></li>
<li class="chapter" data-level="2.4.5" data-path="概率与分布.html"><a href="概率与分布.html#几何分布等待第一次成功的耐心"><i class="fa fa-check"></i><b>2.4.5</b> 几何分布：等待”第一次成功”的耐心</a></li>
<li class="chapter" data-level="2.4.6" data-path="概率与分布.html"><a href="概率与分布.html#负二项分布等待最后一次成功的耐心"><i class="fa fa-check"></i><b>2.4.6</b> 负二项分布：等待”最后一次成功”的耐心</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="概率与分布.html"><a href="概率与分布.html#午餐法则连续随机变量的分布家族"><i class="fa fa-check"></i><b>2.5</b> 午餐法则：连续随机变量的分布家族</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="概率与分布.html"><a href="概率与分布.html#均匀分布纯粹的平等"><i class="fa fa-check"></i><b>2.5.1</b> 均匀分布：纯粹的平等</a></li>
<li class="chapter" data-level="2.5.2" data-path="概率与分布.html"><a href="概率与分布.html#指数分布等待的艺术"><i class="fa fa-check"></i><b>2.5.2</b> 指数分布：等待的艺术</a></li>
<li class="chapter" data-level="2.5.3" data-path="概率与分布.html"><a href="概率与分布.html#正态分布高斯分布自然界的钟形法则"><i class="fa fa-check"></i><b>2.5.3</b> 正态分布（高斯分布）：自然界的”钟形”法则</a></li>
<li class="chapter" data-level="2.5.4" data-path="概率与分布.html"><a href="概率与分布.html#威布尔分布生存分析的时间法则"><i class="fa fa-check"></i><b>2.5.4</b> 威布尔分布：生存分析的”时间法则”</a></li>
<li class="chapter" data-level="2.5.5" data-path="概率与分布.html"><a href="概率与分布.html#伽马分布更一般的等待时间模型"><i class="fa fa-check"></i><b>2.5.5</b> 伽马分布：更一般的等待时间模型</a></li>
<li class="chapter" data-level="2.5.6" data-path="概率与分布.html"><a href="概率与分布.html#贝塔分布比例变量的天然选择"><i class="fa fa-check"></i><b>2.5.6</b> 贝塔分布：比例变量的天然选择</a></li>
<li class="chapter" data-level="2.5.7" data-path="概率与分布.html"><a href="概率与分布.html#正态的魔力中心极限定理"><i class="fa fa-check"></i><b>2.5.7</b> 正态的魔力：中心极限定理</a></li>
<li class="chapter" data-level="2.5.8" data-path="概率与分布.html"><a href="概率与分布.html#生态学应用实例"><i class="fa fa-check"></i><b>2.5.8</b> 生态学应用实例</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="概率与分布.html"><a href="概率与分布.html#混合分布处理异质性数据"><i class="fa fa-check"></i><b>2.6</b> 混合分布：处理异质性数据</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="概率与分布.html"><a href="概率与分布.html#零膨胀分布处理零值过多的数据"><i class="fa fa-check"></i><b>2.6.1</b> 零膨胀分布：处理零值过多的数据</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="概率与分布.html"><a href="概率与分布.html#总结-2"><i class="fa fa-check"></i><b>2.7</b> 总结</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="描述统计.html"><a href="描述统计.html"><i class="fa fa-check"></i><b>3</b> 描述统计</a>
<ul>
<li class="chapter" data-level="3.1" data-path="描述统计.html"><a href="描述统计.html#引言-2"><i class="fa fa-check"></i><b>3.1</b> 引言</a></li>
<li class="chapter" data-level="3.2" data-path="描述统计.html"><a href="描述统计.html#描述统计基础"><i class="fa fa-check"></i><b>3.2</b> 描述统计基础</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="描述统计.html"><a href="描述统计.html#中心趋势测量"><i class="fa fa-check"></i><b>3.2.1</b> 中心趋势测量</a></li>
<li class="chapter" data-level="3.2.2" data-path="描述统计.html"><a href="描述统计.html#离散性测量"><i class="fa fa-check"></i><b>3.2.2</b> 离散性测量</a></li>
<li class="chapter" data-level="3.2.3" data-path="描述统计.html"><a href="描述统计.html#分布形状与矩测量"><i class="fa fa-check"></i><b>3.2.3</b> 分布形状与矩测量</a></li>
<li class="chapter" data-level="3.2.4" data-path="描述统计.html"><a href="描述统计.html#统计概念在概率分布图上的可视化"><i class="fa fa-check"></i><b>3.2.4</b> 统计概念在概率分布图上的可视化</a></li>
<li class="chapter" data-level="3.2.5" data-path="描述统计.html"><a href="描述统计.html#标准误的可视化理解"><i class="fa fa-check"></i><b>3.2.5</b> 标准误的可视化理解</a></li>
<li class="chapter" data-level="3.2.6" data-path="描述统计.html"><a href="描述统计.html#不同参数值的分布形状比较"><i class="fa fa-check"></i><b>3.2.6</b> 不同参数值的分布形状比较</a></li>
<li class="chapter" data-level="3.2.7" data-path="描述统计.html"><a href="描述统计.html#生态学意义总结"><i class="fa fa-check"></i><b>3.2.7</b> 生态学意义总结</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="描述统计.html"><a href="描述统计.html#环境异质性描述"><i class="fa fa-check"></i><b>3.3</b> 环境异质性描述</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="描述统计.html"><a href="描述统计.html#环境异质性的概念"><i class="fa fa-check"></i><b>3.3.1</b> 环境异质性的概念</a></li>
<li class="chapter" data-level="3.3.2" data-path="描述统计.html"><a href="描述统计.html#环境异质性的可视化理解"><i class="fa fa-check"></i><b>3.3.2</b> 环境异质性的可视化理解</a></li>
<li class="chapter" data-level="3.3.3" data-path="描述统计.html"><a href="描述统计.html#环境异质性的量化方法"><i class="fa fa-check"></i><b>3.3.3</b> 环境异质性的量化方法</a></li>
<li class="chapter" data-level="3.3.4" data-path="描述统计.html"><a href="描述统计.html#环境异质性的生态学意义"><i class="fa fa-check"></i><b>3.3.4</b> 环境异质性的生态学意义</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="描述统计.html"><a href="描述统计.html#个体特征描述"><i class="fa fa-check"></i><b>3.4</b> 个体特征描述</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="描述统计.html"><a href="描述统计.html#生存函数survival-function"><i class="fa fa-check"></i><b>3.4.1</b> 生存函数（Survival Function）</a></li>
<li class="chapter" data-level="3.4.2" data-path="描述统计.html"><a href="描述统计.html#瞬时死亡风险函数hazard-function"><i class="fa fa-check"></i><b>3.4.2</b> 瞬时死亡风险函数（Hazard Function）</a></li>
<li class="chapter" data-level="3.4.3" data-path="描述统计.html"><a href="描述统计.html#累积风险函数cumulative-hazard-function"><i class="fa fa-check"></i><b>3.4.3</b> 累积风险函数（Cumulative Hazard Function）</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="描述统计.html"><a href="描述统计.html#种群特征描述"><i class="fa fa-check"></i><b>3.5</b> 种群特征描述</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="描述统计.html"><a href="描述统计.html#gini系数"><i class="fa fa-check"></i><b>3.5.1</b> Gini系数</a></li>
<li class="chapter" data-level="3.5.2" data-path="描述统计.html"><a href="描述统计.html#lorenz曲线"><i class="fa fa-check"></i><b>3.5.2</b> Lorenz曲线</a></li>
<li class="chapter" data-level="3.5.3" data-path="描述统计.html"><a href="描述统计.html#基尼系数的生态学应用"><i class="fa fa-check"></i><b>3.5.3</b> 基尼系数的生态学应用</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="描述统计.html"><a href="描述统计.html#群落特征描述"><i class="fa fa-check"></i><b>3.6</b> 群落特征描述</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="描述统计.html"><a href="描述统计.html#物种多样性描述"><i class="fa fa-check"></i><b>3.6.1</b> 物种多样性描述</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="描述统计.html"><a href="描述统计.html#生态网络特征描述"><i class="fa fa-check"></i><b>3.7</b> 生态网络特征描述</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="描述统计.html"><a href="描述统计.html#网络拓扑指标"><i class="fa fa-check"></i><b>3.7.1</b> 网络拓扑指标</a></li>
<li class="chapter" data-level="3.7.2" data-path="描述统计.html"><a href="描述统计.html#食物网特征"><i class="fa fa-check"></i><b>3.7.2</b> 食物网特征</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="描述统计.html"><a href="描述统计.html#稳定性描述"><i class="fa fa-check"></i><b>3.8</b> 稳定性描述</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="描述统计.html"><a href="描述统计.html#抵抗力resistance"><i class="fa fa-check"></i><b>3.8.1</b> 抵抗力（Resistance）</a></li>
<li class="chapter" data-level="3.8.2" data-path="描述统计.html"><a href="描述统计.html#恢复力resilience"><i class="fa fa-check"></i><b>3.8.2</b> 恢复力（Resilience）</a></li>
<li class="chapter" data-level="3.8.3" data-path="描述统计.html"><a href="描述统计.html#持久性persistence"><i class="fa fa-check"></i><b>3.8.3</b> 持久性（Persistence）</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="描述统计.html"><a href="描述统计.html#总结-3"><i class="fa fa-check"></i><b>3.9</b> 总结</a></li>
<li class="chapter" data-level="3.10" data-path="描述统计.html"><a href="描述统计.html#综合练习-1"><i class="fa fa-check"></i><b>3.10</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="参数估计.html"><a href="参数估计.html"><i class="fa fa-check"></i><b>4</b> 参数估计</a>
<ul>
<li class="chapter" data-level="4.1" data-path="参数估计.html"><a href="参数估计.html#引言-3"><i class="fa fa-check"></i><b>4.1</b> 引言</a></li>
<li class="chapter" data-level="4.2" data-path="参数估计.html"><a href="参数估计.html#样本与总体"><i class="fa fa-check"></i><b>4.2</b> 样本与总体</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="参数估计.html"><a href="参数估计.html#抽样方法及其生态学应用"><i class="fa fa-check"></i><b>4.2.1</b> 抽样方法及其生态学应用</a></li>
<li class="chapter" data-level="4.2.2" data-path="参数估计.html"><a href="参数估计.html#r语言中的抽样实现"><i class="fa fa-check"></i><b>4.2.2</b> R语言中的抽样实现</a></li>
<li class="chapter" data-level="4.2.3" data-path="参数估计.html"><a href="参数估计.html#抽样误差与样本量确定"><i class="fa fa-check"></i><b>4.2.3</b> 抽样误差与样本量确定</a></li>
<li class="chapter" data-level="4.2.4" data-path="参数估计.html"><a href="参数估计.html#生态学抽样设计的实践考虑"><i class="fa fa-check"></i><b>4.2.4</b> 生态学抽样设计的实践考虑</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="参数估计.html"><a href="参数估计.html#参数估计基础"><i class="fa fa-check"></i><b>4.3</b> 参数估计基础</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="参数估计.html"><a href="参数估计.html#点估计"><i class="fa fa-check"></i><b>4.3.1</b> 点估计</a></li>
<li class="chapter" data-level="4.3.2" data-path="参数估计.html"><a href="参数估计.html#区间估计"><i class="fa fa-check"></i><b>4.3.2</b> 区间估计</a></li>
<li class="chapter" data-level="4.3.3" data-path="参数估计.html"><a href="参数估计.html#估计方法"><i class="fa fa-check"></i><b>4.3.3</b> 估计方法</a></li>
<li class="chapter" data-level="4.3.4" data-path="参数估计.html"><a href="参数估计.html#估计量性质如何评价一个估计方法的好坏"><i class="fa fa-check"></i><b>4.3.4</b> 估计量性质：如何评价一个估计方法的好坏？</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="参数估计.html"><a href="参数估计.html#种群大小估计"><i class="fa fa-check"></i><b>4.4</b> 种群大小估计</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="参数估计.html"><a href="参数估计.html#标记重捕法"><i class="fa fa-check"></i><b>4.4.1</b> 标记重捕法</a></li>
<li class="chapter" data-level="4.4.2" data-path="参数估计.html"><a href="参数估计.html#面积取样法"><i class="fa fa-check"></i><b>4.4.2</b> 面积取样法</a></li>
<li class="chapter" data-level="4.4.3" data-path="参数估计.html"><a href="参数估计.html#距离抽样法"><i class="fa fa-check"></i><b>4.4.3</b> 距离抽样法</a></li>
<li class="chapter" data-level="4.4.4" data-path="参数估计.html"><a href="参数估计.html#去除法"><i class="fa fa-check"></i><b>4.4.4</b> 去除法</a></li>
<li class="chapter" data-level="4.4.5" data-path="参数估计.html"><a href="参数估计.html#种群大小估计方法的选择与比较"><i class="fa fa-check"></i><b>4.4.5</b> 种群大小估计方法的选择与比较</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="参数估计.html"><a href="参数估计.html#稀有种估计"><i class="fa fa-check"></i><b>4.5</b> 稀有种估计</a></li>
<li class="chapter" data-level="4.6" data-path="参数估计.html"><a href="参数估计.html#物种多样性估计"><i class="fa fa-check"></i><b>4.6</b> 物种多样性估计</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="参数估计.html"><a href="参数估计.html#外推和内插方法"><i class="fa fa-check"></i><b>4.6.1</b> 外推和内插方法</a></li>
<li class="chapter" data-level="4.6.2" data-path="参数估计.html"><a href="参数估计.html#多样性估计的抽样偏差"><i class="fa fa-check"></i><b>4.6.2</b> 多样性估计的抽样偏差</a></li>
<li class="chapter" data-level="4.6.3" data-path="参数估计.html"><a href="参数估计.html#多样性估计方法的选择与比较"><i class="fa fa-check"></i><b>4.6.3</b> 多样性估计方法的选择与比较</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="参数估计.html"><a href="参数估计.html#总结-4"><i class="fa fa-check"></i><b>4.7</b> 总结</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="参数估计.html"><a href="参数估计.html#参数估计的生态学意义与理论基础"><i class="fa fa-check"></i><b>4.7.1</b> 参数估计的生态学意义与理论基础</a></li>
<li class="chapter" data-level="4.7.2" data-path="参数估计.html"><a href="参数估计.html#点估计与区间估计从单一数值到可信范围"><i class="fa fa-check"></i><b>4.7.2</b> 点估计与区间估计：从单一数值到可信范围</a></li>
<li class="chapter" data-level="4.7.3" data-path="参数估计.html"><a href="参数估计.html#主要估计方法及其生态学应用"><i class="fa fa-check"></i><b>4.7.3</b> 主要估计方法及其生态学应用</a></li>
<li class="chapter" data-level="4.7.4" data-path="参数估计.html"><a href="参数估计.html#种群大小估计生态学实践的核心任务"><i class="fa fa-check"></i><b>4.7.4</b> 种群大小估计：生态学实践的核心任务</a></li>
<li class="chapter" data-level="4.7.5" data-path="参数估计.html"><a href="参数估计.html#物种多样性估计群落生态学的量化基础"><i class="fa fa-check"></i><b>4.7.5</b> 物种多样性估计：群落生态学的量化基础</a></li>
<li class="chapter" data-level="4.7.6" data-path="参数估计.html"><a href="参数估计.html#参数估计在生态学决策中的重要性"><i class="fa fa-check"></i><b>4.7.6</b> 参数估计在生态学决策中的重要性</a></li>
<li class="chapter" data-level="4.7.7" data-path="参数估计.html"><a href="参数估计.html#未来发展方向与挑战"><i class="fa fa-check"></i><b>4.7.7</b> 未来发展方向与挑战</a></li>
<li class="chapter" data-level="4.7.8" data-path="参数估计.html"><a href="参数估计.html#结语"><i class="fa fa-check"></i><b>4.7.8</b> 结语</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="参数估计.html"><a href="参数估计.html#综合练习-2"><i class="fa fa-check"></i><b>4.8</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="相关性与相似性.html"><a href="相关性与相似性.html"><i class="fa fa-check"></i><b>5</b> 相关性与相似性</a>
<ul>
<li class="chapter" data-level="5.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#引言-4"><i class="fa fa-check"></i><b>5.1</b> 引言</a></li>
<li class="chapter" data-level="5.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#相关性统计基础"><i class="fa fa-check"></i><b>5.2</b> 相关性统计基础</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#相关分析"><i class="fa fa-check"></i><b>5.2.1</b> 相关分析</a></li>
<li class="chapter" data-level="5.2.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#偏相关分析"><i class="fa fa-check"></i><b>5.2.2</b> 偏相关分析</a></li>
<li class="chapter" data-level="5.2.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#距离相关"><i class="fa fa-check"></i><b>5.2.3</b> 距离相关</a></li>
<li class="chapter" data-level="5.2.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#互信息"><i class="fa fa-check"></i><b>5.2.4</b> 互信息</a></li>
<li class="chapter" data-level="5.2.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#非线性关系度量"><i class="fa fa-check"></i><b>5.2.5</b> 非线性关系度量</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#自相关"><i class="fa fa-check"></i><b>5.3</b> 自相关</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#时间自相关"><i class="fa fa-check"></i><b>5.3.1</b> 时间自相关</a></li>
<li class="chapter" data-level="5.3.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#空间自相关"><i class="fa fa-check"></i><b>5.3.2</b> 空间自相关</a></li>
<li class="chapter" data-level="5.3.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育相关性"><i class="fa fa-check"></i><b>5.3.3</b> 系统发育相关性</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#相似性与距离"><i class="fa fa-check"></i><b>5.4</b> 相似性与距离</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#常用相似性系数"><i class="fa fa-check"></i><b>5.4.1</b> 常用相似性系数</a></li>
<li class="chapter" data-level="5.4.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#功能性状间相关性"><i class="fa fa-check"></i><b>5.4.2</b> 功能性状间相关性</a></li>
<li class="chapter" data-level="5.4.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#种内相关性"><i class="fa fa-check"></i><b>5.4.3</b> 种内相关性</a></li>
<li class="chapter" data-level="5.4.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#种间相关性"><i class="fa fa-check"></i><b>5.4.4</b> 种间相关性</a></li>
<li class="chapter" data-level="5.4.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#群落相似性"><i class="fa fa-check"></i><b>5.4.5</b> 群落相似性</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#总结-5"><i class="fa fa-check"></i><b>5.5</b> 总结</a></li>
<li class="chapter" data-level="5.6" data-path="相关性与相似性.html"><a href="相关性与相似性.html#综合练习-3"><i class="fa fa-check"></i><b>5.6</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html"><i class="fa fa-check"></i><b>6</b> 基于经典分布的假设检验</a>
<ul>
<li class="chapter" data-level="6.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#引言-5"><i class="fa fa-check"></i><b>6.1</b> 引言</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#假设检验基础"><i class="fa fa-check"></i><b>6.1.1</b> 假设检验基础</a></li>
<li class="chapter" data-level="6.1.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#假设检验的基本步骤"><i class="fa fa-check"></i><b>6.1.2</b> 假设检验的基本步骤</a></li>
<li class="chapter" data-level="6.1.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#零假设与备择假设"><i class="fa fa-check"></i><b>6.1.3</b> 零假设与备择假设</a></li>
<li class="chapter" data-level="6.1.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#检验统计量与p值"><i class="fa fa-check"></i><b>6.1.4</b> 检验统计量与p值</a></li>
<li class="chapter" data-level="6.1.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#显著性水平"><i class="fa fa-check"></i><b>6.1.5</b> 显著性水平</a></li>
<li class="chapter" data-level="6.1.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#效应大小与置信区间"><i class="fa fa-check"></i><b>6.1.6</b> 效应大小与置信区间</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本检验"><i class="fa fa-check"></i><b>6.2</b> 单样本检验</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本t检验"><i class="fa fa-check"></i><b>6.2.1</b> 单样本t检验</a></li>
<li class="chapter" data-level="6.2.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本符号检验"><i class="fa fa-check"></i><b>6.2.2</b> 单样本符号检验</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#双样本检验"><i class="fa fa-check"></i><b>6.3</b> 双样本检验</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#独立样本t检验"><i class="fa fa-check"></i><b>6.3.1</b> 独立样本t检验</a></li>
<li class="chapter" data-level="6.3.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#配对样本t检验"><i class="fa fa-check"></i><b>6.3.2</b> 配对样本t检验</a></li>
<li class="chapter" data-level="6.3.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#mann-whitney-u检验"><i class="fa fa-check"></i><b>6.3.3</b> Mann-Whitney U检验</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多样本检验"><i class="fa fa-check"></i><b>6.4</b> 多样本检验</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#方差分析anova"><i class="fa fa-check"></i><b>6.4.1</b> 方差分析（ANOVA）</a></li>
<li class="chapter" data-level="6.4.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#kruskal-wallis检验"><i class="fa fa-check"></i><b>6.4.2</b> Kruskal-Wallis检验</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#非参数检验方法"><i class="fa fa-check"></i><b>6.5</b> 非参数检验方法</a></li>
<li class="chapter" data-level="6.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较校正"><i class="fa fa-check"></i><b>6.6</b> 多重比较校正</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较问题的本质"><i class="fa fa-check"></i><b>6.6.1</b> 多重比较问题的本质</a></li>
<li class="chapter" data-level="6.6.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#bonferroni校正"><i class="fa fa-check"></i><b>6.6.2</b> Bonferroni校正</a></li>
<li class="chapter" data-level="6.6.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#tukey-hsd检验"><i class="fa fa-check"></i><b>6.6.3</b> Tukey HSD检验</a></li>
<li class="chapter" data-level="6.6.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#fdr错误发现率控制"><i class="fa fa-check"></i><b>6.6.4</b> FDR（错误发现率）控制</a></li>
<li class="chapter" data-level="6.6.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#生态学实例森林类型对鸟类多样性的影响"><i class="fa fa-check"></i><b>6.6.5</b> 生态学实例：森林类型对鸟类多样性的影响</a></li>
<li class="chapter" data-level="6.6.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较校正效果的可视化"><i class="fa fa-check"></i><b>6.6.6</b> 多重比较校正效果的可视化</a></li>
<li class="chapter" data-level="6.6.7" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#实用建议与最佳实践"><i class="fa fa-check"></i><b>6.6.7</b> 实用建议与最佳实践</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#功效分析"><i class="fa fa-check"></i><b>6.7</b> 功效分析</a></li>
<li class="chapter" data-level="6.8" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#总结-6"><i class="fa fa-check"></i><b>6.8</b> 总结</a></li>
<li class="chapter" data-level="6.9" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#综合练习-4"><i class="fa fa-check"></i><b>6.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html"><i class="fa fa-check"></i><b>7</b> 基于模拟的假设检验</a>
<ul>
<li class="chapter" data-level="7.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#引言-6"><i class="fa fa-check"></i><b>7.1</b> 引言</a></li>
<li class="chapter" data-level="7.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学层次与演进脉络"><i class="fa fa-check"></i><b>7.2</b> 方法学层次与演进脉络</a></li>
<li class="chapter" data-level="7.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验"><i class="fa fa-check"></i><b>7.3</b> 置换检验</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验的基本原理"><i class="fa fa-check"></i><b>7.3.1</b> 置换检验的基本原理</a></li>
<li class="chapter" data-level="7.3.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验的技术实现过程"><i class="fa fa-check"></i><b>7.3.2</b> 置换检验的技术实现过程</a></li>
<li class="chapter" data-level="7.3.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例"><i class="fa fa-check"></i><b>7.3.3</b> R语言实现示例</a></li>
<li class="chapter" data-level="7.3.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验在生态学中的应用价值与局限"><i class="fa fa-check"></i><b>7.3.4</b> 置换检验在生态学中的应用价值与局限</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验"><i class="fa fa-check"></i><b>7.4</b> 蒙特卡洛检验</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛方法的概念体系"><i class="fa fa-check"></i><b>7.4.1</b> 蒙特卡洛方法的概念体系</a></li>
<li class="chapter" data-level="7.4.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验的基本原理"><i class="fa fa-check"></i><b>7.4.2</b> 蒙特卡洛检验的基本原理</a></li>
<li class="chapter" data-level="7.4.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验的主要类型"><i class="fa fa-check"></i><b>7.4.3</b> 蒙特卡洛检验的主要类型</a></li>
<li class="chapter" data-level="7.4.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例空间分布随机性检验"><i class="fa fa-check"></i><b>7.4.4</b> R语言实现示例：空间分布随机性检验</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法检验"><i class="fa fa-check"></i><b>7.5</b> 自助法检验</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的基本原理"><i class="fa fa-check"></i><b>7.5.1</b> 自助法的基本原理</a></li>
<li class="chapter" data-level="7.5.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的实施步骤"><i class="fa fa-check"></i><b>7.5.2</b> 自助法的实施步骤</a></li>
<li class="chapter" data-level="7.5.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法在生态学中的应用"><i class="fa fa-check"></i><b>7.5.3</b> 自助法在生态学中的应用</a></li>
<li class="chapter" data-level="7.5.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例-1"><i class="fa fa-check"></i><b>7.5.4</b> R语言实现示例</a></li>
<li class="chapter" data-level="7.5.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的优势与局限"><i class="fa fa-check"></i><b>7.5.5</b> 自助法的优势与局限</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#基因型频率检验"><i class="fa fa-check"></i><b>7.6</b> 基因型频率检验</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#hardy-weinberg平衡检验"><i class="fa fa-check"></i><b>7.6.1</b> Hardy-Weinberg平衡检验</a></li>
<li class="chapter" data-level="7.6.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#连锁不平衡检验"><i class="fa fa-check"></i><b>7.6.2</b> 连锁不平衡检验</a></li>
<li class="chapter" data-level="7.6.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与选择建议"><i class="fa fa-check"></i><b>7.6.3</b> 方法学比较与选择建议</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#多样性差异检验"><i class="fa fa-check"></i><b>7.7</b> 多样性差异检验</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#群落多样性比较"><i class="fa fa-check"></i><b>7.7.1</b> 群落多样性比较</a></li>
<li class="chapter" data-level="7.7.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#相似性分析anosim"><i class="fa fa-check"></i><b>7.7.2</b> 相似性分析（ANOSIM）</a></li>
<li class="chapter" data-level="7.7.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与生态学应用建议"><i class="fa fa-check"></i><b>7.7.3</b> 方法学比较与生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#物种空间分布检验"><i class="fa fa-check"></i><b>7.8</b> 物种空间分布检验</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#空间分布模式检验"><i class="fa fa-check"></i><b>7.8.1</b> 空间分布模式检验</a></li>
<li class="chapter" data-level="7.8.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#点过程模型检验"><i class="fa fa-check"></i><b>7.8.2</b> 点过程模型检验</a></li>
<li class="chapter" data-level="7.8.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#空间生态学的统计挑战与解决方案"><i class="fa fa-check"></i><b>7.8.3</b> 空间生态学的统计挑战与解决方案</a></li>
<li class="chapter" data-level="7.8.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学应用与保护意义"><i class="fa fa-check"></i><b>7.8.4</b> 生态学应用与保护意义</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育信号检验"><i class="fa fa-check"></i><b>7.9</b> 系统发育信号检验</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育保守性检验"><i class="fa fa-check"></i><b>7.9.1</b> 系统发育保守性检验</a></li>
<li class="chapter" data-level="7.9.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育独立对比"><i class="fa fa-check"></i><b>7.9.2</b> 系统发育独立对比</a></li>
<li class="chapter" data-level="7.9.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与生态学应用建议-1"><i class="fa fa-check"></i><b>7.9.3</b> 方法学比较与生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学零模型检验"><i class="fa fa-check"></i><b>7.10</b> 生态学零模型检验</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#零模型的基本概念与生态学意义"><i class="fa fa-check"></i><b>7.10.1</b> 零模型的基本概念与生态学意义</a></li>
<li class="chapter" data-level="7.10.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#群落组装零模型检验"><i class="fa fa-check"></i><b>7.10.2</b> 群落组装零模型检验</a></li>
<li class="chapter" data-level="7.10.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态网络零模型检验"><i class="fa fa-check"></i><b>7.10.3</b> 生态网络零模型检验</a></li>
<li class="chapter" data-level="7.10.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#零模型检验的方法学比较与选择"><i class="fa fa-check"></i><b>7.10.4</b> 零模型检验的方法学比较与选择</a></li>
<li class="chapter" data-level="7.10.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学应用与保护意义-1"><i class="fa fa-check"></i><b>7.10.5</b> 生态学应用与保护意义</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#总结-7"><i class="fa fa-check"></i><b>7.11</b> 总结</a></li>
<li class="chapter" data-level="7.12" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#综合练习-5"><i class="fa fa-check"></i><b>7.12</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html"><i class="fa fa-check"></i><b>8</b> 简单线性回归模型</a>
<ul>
<li class="chapter" data-level="8.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#引言-7"><i class="fa fa-check"></i><b>8.1</b> 引言</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#为什么生态学本科生需要学习统计建模与预测"><i class="fa fa-check"></i><b>8.1.1</b> 为什么生态学本科生需要学习统计建模与预测？</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#线性回归模型生态关系的数学表达"><i class="fa fa-check"></i><b>8.2</b> 线性回归模型：生态关系的数学表达</a></li>
<li class="chapter" data-level="8.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#最小二乘估计"><i class="fa fa-check"></i><b>8.3</b> 最小二乘估计</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的lm函数详解"><i class="fa fa-check"></i><b>8.3.1</b> R语言中的lm()函数详解</a></li>
<li class="chapter" data-level="8.3.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#lm函数的基本语法"><i class="fa fa-check"></i><b>8.3.2</b> lm()函数的基本语法</a></li>
<li class="chapter" data-level="8.3.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型公式的详细说明"><i class="fa fa-check"></i><b>8.3.3</b> 模型公式的详细说明</a></li>
<li class="chapter" data-level="8.3.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#lm函数的返回对象"><i class="fa fa-check"></i><b>8.3.4</b> lm()函数的返回对象</a></li>
<li class="chapter" data-level="8.3.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#提取回归结果的常用函数"><i class="fa fa-check"></i><b>8.3.5</b> 提取回归结果的常用函数</a></li>
<li class="chapter" data-level="8.3.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#理解summary函数的输出"><i class="fa fa-check"></i><b>8.3.6</b> 理解summary()函数的输出</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#回归诊断验证模型的生态学合理性"><i class="fa fa-check"></i><b>8.4</b> 回归诊断：验证模型的生态学合理性</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#回归诊断图的系统解读"><i class="fa fa-check"></i><b>8.4.1</b> 回归诊断图的系统解读</a></li>
<li class="chapter" data-level="8.4.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型质量的综合评估"><i class="fa fa-check"></i><b>8.4.2</b> 模型质量的综合评估</a></li>
<li class="chapter" data-level="8.4.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学诊断问题的应对策略"><i class="fa fa-check"></i><b>8.4.3</b> 生态学诊断问题的应对策略</a></li>
<li class="chapter" data-level="8.4.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用实例-1"><i class="fa fa-check"></i><b>8.4.4</b> 生态学应用实例</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归多因子生态关系的综合分析"><i class="fa fa-check"></i><b>8.5</b> 多元线性回归：多因子生态关系的综合分析</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归的模型公式"><i class="fa fa-check"></i><b>8.5.1</b> 多元线性回归的模型公式</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归中的变量选择"><i class="fa fa-check"></i><b>8.6</b> 多元线性回归中的变量选择</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择的重要性"><i class="fa fa-check"></i><b>8.6.1</b> 变量选择的重要性</a></li>
<li class="chapter" data-level="8.6.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择的基本原则"><i class="fa fa-check"></i><b>8.6.2</b> 变量选择的基本原则</a></li>
<li class="chapter" data-level="8.6.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#常用的变量选择方法"><i class="fa fa-check"></i><b>8.6.3</b> 常用的变量选择方法</a></li>
<li class="chapter" data-level="8.6.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的模型选择实现"><i class="fa fa-check"></i><b>8.6.4</b> R语言中的模型选择实现</a></li>
<li class="chapter" data-level="8.6.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学变量选择的实践建议"><i class="fa fa-check"></i><b>8.6.5</b> 生态学变量选择的实践建议</a></li>
<li class="chapter" data-level="8.6.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型选择的注意事项"><i class="fa fa-check"></i><b>8.6.6</b> 模型选择的注意事项</a></li>
<li class="chapter" data-level="8.6.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#完整生态学案例分析鸟类丰富度与环境因子的关系"><i class="fa fa-check"></i><b>8.6.7</b> 完整生态学案例分析：鸟类丰富度与环境因子的关系</a></li>
<li class="chapter" data-level="8.6.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#完整模型拟合"><i class="fa fa-check"></i><b>8.6.8</b> 完整模型拟合</a></li>
<li class="chapter" data-level="8.6.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择过程"><i class="fa fa-check"></i><b>8.6.9</b> 变量选择过程</a></li>
<li class="chapter" data-level="8.6.10" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#最优模型选择与结果解释"><i class="fa fa-check"></i><b>8.6.10</b> 最优模型选择与结果解释</a></li>
<li class="chapter" data-level="8.6.11" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型诊断与假设检验"><i class="fa fa-check"></i><b>8.6.11</b> 模型诊断与假设检验</a></li>
<li class="chapter" data-level="8.6.12" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型预测与应用"><i class="fa fa-check"></i><b>8.6.12</b> 模型预测与应用</a></li>
<li class="chapter" data-level="8.6.13" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型比较与评估"><i class="fa fa-check"></i><b>8.6.13</b> 模型比较与评估</a></li>
<li class="chapter" data-level="8.6.14" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学解释与模型选择价值"><i class="fa fa-check"></i><b>8.6.14</b> 生态学解释与模型选择价值</a></li>
<li class="chapter" data-level="8.6.15" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#案例分析总结"><i class="fa fa-check"></i><b>8.6.15</b> 案例分析总结</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归非线性生态关系的数学描述"><i class="fa fa-check"></i><b>8.7</b> 多项式回归：非线性生态关系的数学描述</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归模型"><i class="fa fa-check"></i><b>8.7.1</b> 多项式回归模型</a></li>
<li class="chapter" data-level="8.7.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的多项式回归实现"><i class="fa fa-check"></i><b>8.7.2</b> R语言中的多项式回归实现</a></li>
<li class="chapter" data-level="8.7.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用实例-2"><i class="fa fa-check"></i><b>8.7.3</b> 生态学应用实例</a></li>
<li class="chapter" data-level="8.7.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归的生态学意义"><i class="fa fa-check"></i><b>8.7.4</b> 多项式回归的生态学意义</a></li>
<li class="chapter" data-level="8.7.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式阶数的选择"><i class="fa fa-check"></i><b>8.7.5</b> 多项式阶数的选择</a></li>
<li class="chapter" data-level="8.7.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归的注意事项"><i class="fa fa-check"></i><b>8.7.6</b> 多项式回归的注意事项</a></li>
<li class="chapter" data-level="8.7.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#过度拟合问题演示"><i class="fa fa-check"></i><b>8.7.7</b> 过度拟合问题演示</a></li>
<li class="chapter" data-level="8.7.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型可视化与比较"><i class="fa fa-check"></i><b>8.7.8</b> 模型可视化与比较</a></li>
<li class="chapter" data-level="8.7.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#统计指标与交叉验证"><i class="fa fa-check"></i><b>8.7.9</b> 统计指标与交叉验证</a></li>
<li class="chapter" data-level="8.7.10" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用建议"><i class="fa fa-check"></i><b>8.7.10</b> 生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#总结从线性到非线性从简单到复杂"><i class="fa fa-check"></i><b>8.8</b> 总结：从线性到非线性，从简单到复杂</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#核心概念回顾"><i class="fa fa-check"></i><b>8.8.1</b> 核心概念回顾</a></li>
<li class="chapter" data-level="8.8.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学建模思维"><i class="fa fa-check"></i><b>8.8.2</b> 生态学建模思维</a></li>
<li class="chapter" data-level="8.8.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#实践应用价值"><i class="fa fa-check"></i><b>8.8.3</b> 实践应用价值</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#综合练习-6"><i class="fa fa-check"></i><b>8.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="模型选择与评估.html"><a href="模型选择与评估.html"><i class="fa fa-check"></i><b>9</b> 模型选择与评估</a>
<ul>
<li class="chapter" data-level="9.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#引言-8"><i class="fa fa-check"></i><b>9.1</b> 引言</a></li>
<li class="chapter" data-level="9.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型选择"><i class="fa fa-check"></i><b>9.2</b> 模型选择</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型选择原则"><i class="fa fa-check"></i><b>9.2.1</b> 模型选择原则</a></li>
<li class="chapter" data-level="9.2.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#信息准则"><i class="fa fa-check"></i><b>9.2.2</b> 信息准则</a></li>
<li class="chapter" data-level="9.2.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#似然比检验"><i class="fa fa-check"></i><b>9.2.3</b> 似然比检验</a></li>
<li class="chapter" data-level="9.2.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型平均"><i class="fa fa-check"></i><b>9.2.4</b> 模型平均</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型评估"><i class="fa fa-check"></i><b>9.3</b> 模型评估</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#交叉验证"><i class="fa fa-check"></i><b>9.3.1</b> 交叉验证</a></li>
<li class="chapter" data-level="9.3.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#外部验证"><i class="fa fa-check"></i><b>9.3.2</b> 外部验证</a></li>
<li class="chapter" data-level="9.3.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型诊断"><i class="fa fa-check"></i><b>9.3.3</b> 模型诊断</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型选择与评估"><i class="fa fa-check"></i><b>9.4</b> 贝叶斯模型选择与评估</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯与频率学派的根本差异"><i class="fa fa-check"></i><b>9.4.1</b> 贝叶斯与频率学派的根本差异</a></li>
<li class="chapter" data-level="9.4.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型选择基本原理"><i class="fa fa-check"></i><b>9.4.2</b> 贝叶斯模型选择基本原理</a></li>
<li class="chapter" data-level="9.4.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯假设检验流程"><i class="fa fa-check"></i><b>9.4.3</b> 贝叶斯假设检验流程</a></li>
<li class="chapter" data-level="9.4.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型比较与选择"><i class="fa fa-check"></i><b>9.4.4</b> 贝叶斯模型比较与选择</a></li>
<li class="chapter" data-level="9.4.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯可信区间"><i class="fa fa-check"></i><b>9.4.5</b> 贝叶斯可信区间</a></li>
<li class="chapter" data-level="9.4.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯因子计算与解释"><i class="fa fa-check"></i><b>9.4.6</b> 贝叶斯因子计算与解释</a></li>
<li class="chapter" data-level="9.4.7" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型平均"><i class="fa fa-check"></i><b>9.4.7</b> 贝叶斯模型平均</a></li>
<li class="chapter" data-level="9.4.8" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯预测评估"><i class="fa fa-check"></i><b>9.4.8</b> 贝叶斯预测评估</a></li>
<li class="chapter" data-level="9.4.9" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯变量选择"><i class="fa fa-check"></i><b>9.4.9</b> 贝叶斯变量选择</a></li>
<li class="chapter" data-level="9.4.10" data-path="模型选择与评估.html"><a href="模型选择与评估.html#生态学应用价值"><i class="fa fa-check"></i><b>9.4.10</b> 生态学应用价值</a></li>
<li class="chapter" data-level="9.4.11" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯检验的生态学应用案例"><i class="fa fa-check"></i><b>9.4.11</b> 贝叶斯检验的生态学应用案例</a></li>
<li class="chapter" data-level="9.4.12" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯方法的局限性"><i class="fa fa-check"></i><b>9.4.12</b> 贝叶斯方法的局限性</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#总结-8"><i class="fa fa-check"></i><b>9.5</b> 总结</a></li>
<li class="chapter" data-level="9.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#综合练习-7"><i class="fa fa-check"></i><b>9.6</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="高级回归模型.html"><a href="高级回归模型.html"><i class="fa fa-check"></i><b>10</b> 高级回归模型</a>
<ul>
<li class="chapter" data-level="10.1" data-path="高级回归模型.html"><a href="高级回归模型.html#引言-9"><i class="fa fa-check"></i><b>10.1</b> 引言</a></li>
<li class="chapter" data-level="10.2" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型"><i class="fa fa-check"></i><b>10.2</b> 可加性模型</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型的基本原理"><i class="fa fa-check"></i><b>10.2.1</b> 可加性模型的基本原理</a></li>
<li class="chapter" data-level="10.2.2" data-path="高级回归模型.html"><a href="高级回归模型.html#与线性模型的比较"><i class="fa fa-check"></i><b>10.2.2</b> 与线性模型的比较</a></li>
<li class="chapter" data-level="10.2.3" data-path="高级回归模型.html"><a href="高级回归模型.html#常见的平滑函数"><i class="fa fa-check"></i><b>10.2.3</b> 常见的平滑函数</a></li>
<li class="chapter" data-level="10.2.4" data-path="高级回归模型.html"><a href="高级回归模型.html#平滑函数选择的生态学考量"><i class="fa fa-check"></i><b>10.2.4</b> 平滑函数选择的生态学考量</a></li>
<li class="chapter" data-level="10.2.5" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型中的系数概念"><i class="fa fa-check"></i><b>10.2.5</b> 可加性模型中的”系数”概念</a></li>
<li class="chapter" data-level="10.2.6" data-path="高级回归模型.html"><a href="高级回归模型.html#在r中的实现"><i class="fa fa-check"></i><b>10.2.6</b> 在R中的实现</a></li>
<li class="chapter" data-level="10.2.7" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学应用示例"><i class="fa fa-check"></i><b>10.2.7</b> 生态学应用示例</a></li>
<li class="chapter" data-level="10.2.8" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型诊断"><i class="fa fa-check"></i><b>10.2.8</b> 可加性模型诊断</a></li>
<li class="chapter" data-level="10.2.9" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型的优势与局限"><i class="fa fa-check"></i><b>10.2.9</b> 可加性模型的优势与局限</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="高级回归模型.html"><a href="高级回归模型.html#广义线性回归"><i class="fa fa-check"></i><b>10.3</b> 广义线性回归</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="高级回归模型.html"><a href="高级回归模型.html#广义线性模型的基本框架"><i class="fa fa-check"></i><b>10.3.1</b> 广义线性模型的基本框架</a></li>
<li class="chapter" data-level="10.3.2" data-path="高级回归模型.html"><a href="高级回归模型.html#与普通线性回归的根本区别"><i class="fa fa-check"></i><b>10.3.2</b> 与普通线性回归的根本区别</a></li>
<li class="chapter" data-level="10.3.3" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的glm实现"><i class="fa fa-check"></i><b>10.3.3</b> R语言中的GLM实现</a></li>
<li class="chapter" data-level="10.3.4" data-path="高级回归模型.html"><a href="高级回归模型.html#常见glm类型及其生态学应用"><i class="fa fa-check"></i><b>10.3.4</b> 常见GLM类型及其生态学应用</a></li>
<li class="chapter" data-level="10.3.5" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与解释"><i class="fa fa-check"></i><b>10.3.5</b> 模型诊断与解释</a></li>
<li class="chapter" data-level="10.3.6" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学意义与注意事项"><i class="fa fa-check"></i><b>10.3.6</b> 生态学意义与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="高级回归模型.html"><a href="高级回归模型.html#广义可加模型"><i class="fa fa-check"></i><b>10.4</b> 广义可加模型</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="高级回归模型.html"><a href="高级回归模型.html#gam的基本原理"><i class="fa fa-check"></i><b>10.4.1</b> GAM的基本原理</a></li>
<li class="chapter" data-level="10.4.2" data-path="高级回归模型.html"><a href="高级回归模型.html#在r中的实现-1"><i class="fa fa-check"></i><b>10.4.2</b> 在R中的实现</a></li>
<li class="chapter" data-level="10.4.3" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学应用示例-1"><i class="fa fa-check"></i><b>10.4.3</b> 生态学应用示例</a></li>
<li class="chapter" data-level="10.4.4" data-path="高级回归模型.html"><a href="高级回归模型.html#gam在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.4.4</b> GAM在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.4.5" data-path="高级回归模型.html"><a href="高级回归模型.html#高级功能"><i class="fa fa-check"></i><b>10.4.5</b> 高级功能</a></li>
<li class="chapter" data-level="10.4.6" data-path="高级回归模型.html"><a href="高级回归模型.html#模型选择与诊断"><i class="fa fa-check"></i><b>10.4.6</b> 模型选择与诊断</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型"><i class="fa fa-check"></i><b>10.5</b> 混合效应模型</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="高级回归模型.html"><a href="高级回归模型.html#固定效应与随机效应的生态学概念"><i class="fa fa-check"></i><b>10.5.1</b> 固定效应与随机效应的生态学概念</a></li>
<li class="chapter" data-level="10.5.2" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型的数学框架"><i class="fa fa-check"></i><b>10.5.2</b> 混合效应模型的数学框架</a></li>
<li class="chapter" data-level="10.5.3" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的混合效应模型实现"><i class="fa fa-check"></i><b>10.5.3</b> R语言中的混合效应模型实现</a></li>
<li class="chapter" data-level="10.5.4" data-path="高级回归模型.html"><a href="高级回归模型.html#固定效应和随机效应的筛选"><i class="fa fa-check"></i><b>10.5.4</b> 固定效应和随机效应的筛选</a></li>
<li class="chapter" data-level="10.5.5" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.5.5</b> 混合效应模型在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.5.6" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项"><i class="fa fa-check"></i><b>10.5.6</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型"><i class="fa fa-check"></i><b>10.6</b> 时空自相关模型</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型与混合效应模型的联系与区别"><i class="fa fa-check"></i><b>10.6.1</b> 时空自相关模型与混合效应模型的联系与区别</a></li>
<li class="chapter" data-level="10.6.2" data-path="高级回归模型.html"><a href="高级回归模型.html#空间自相关与时间自相关的生态学概念"><i class="fa fa-check"></i><b>10.6.2</b> 空间自相关与时间自相关的生态学概念</a></li>
<li class="chapter" data-level="10.6.3" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型的数学框架"><i class="fa fa-check"></i><b>10.6.3</b> 时空自相关模型的数学框架</a></li>
<li class="chapter" data-level="10.6.4" data-path="高级回归模型.html"><a href="高级回归模型.html#时空模型框架的联系与区别"><i class="fa fa-check"></i><b>10.6.4</b> 时空模型框架的联系与区别</a></li>
<li class="chapter" data-level="10.6.5" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的时空自相关模型实现"><i class="fa fa-check"></i><b>10.6.5</b> R语言中的时空自相关模型实现</a></li>
<li class="chapter" data-level="10.6.6" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型的生态学应用"><i class="fa fa-check"></i><b>10.6.6</b> 时空自相关模型的生态学应用</a></li>
<li class="chapter" data-level="10.6.7" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项-1"><i class="fa fa-check"></i><b>10.6.7</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型"><i class="fa fa-check"></i><b>10.7</b> 结构方程模型</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型的基本框架"><i class="fa fa-check"></i><b>10.7.1</b> 结构方程模型的基本框架</a></li>
<li class="chapter" data-level="10.7.2" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的结构方程模型实现"><i class="fa fa-check"></i><b>10.7.2</b> R语言中的结构方程模型实现</a></li>
<li class="chapter" data-level="10.7.3" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.7.3</b> 结构方程模型在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.7.4" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项-2"><i class="fa fa-check"></i><b>10.7.4</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="高级回归模型.html"><a href="高级回归模型.html#总结-9"><i class="fa fa-check"></i><b>10.8</b> 总结</a></li>
<li class="chapter" data-level="10.9" data-path="高级回归模型.html"><a href="高级回归模型.html#综合练习-8"><i class="fa fa-check"></i><b>10.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="机器学习.html"><a href="机器学习.html"><i class="fa fa-check"></i><b>11</b> 机器学习</a>
<ul>
<li class="chapter" data-level="11.1" data-path="机器学习.html"><a href="机器学习.html#引言-10"><i class="fa fa-check"></i><b>11.1</b> 引言</a></li>
<li class="chapter" data-level="11.2" data-path="机器学习.html"><a href="机器学习.html#决策树"><i class="fa fa-check"></i><b>11.2</b> 决策树</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与原理"><i class="fa fa-check"></i><b>11.2.1</b> 基本概念与原理</a></li>
<li class="chapter" data-level="11.2.2" data-path="机器学习.html"><a href="机器学习.html#决策树构建原理"><i class="fa fa-check"></i><b>11.2.2</b> 决策树构建原理</a></li>
<li class="chapter" data-level="11.2.3" data-path="机器学习.html"><a href="机器学习.html#分类树classification-trees"><i class="fa fa-check"></i><b>11.2.3</b> 分类树（Classification Trees）</a></li>
<li class="chapter" data-level="11.2.4" data-path="机器学习.html"><a href="机器学习.html#回归树regression-trees"><i class="fa fa-check"></i><b>11.2.4</b> 回归树（Regression Trees）</a></li>
<li class="chapter" data-level="11.2.5" data-path="机器学习.html"><a href="机器学习.html#分类树与回归树的比较"><i class="fa fa-check"></i><b>11.2.5</b> 分类树与回归树的比较</a></li>
<li class="chapter" data-level="11.2.6" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-3"><i class="fa fa-check"></i><b>11.2.6</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.2.7" data-path="机器学习.html"><a href="机器学习.html#优势与局限"><i class="fa fa-check"></i><b>11.2.7</b> 优势与局限</a></li>
<li class="chapter" data-level="11.2.8" data-path="机器学习.html"><a href="机器学习.html#r代码实现示例"><i class="fa fa-check"></i><b>11.2.8</b> R代码实现示例</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="机器学习.html"><a href="机器学习.html#随机森林"><i class="fa fa-check"></i><b>11.3</b> 随机森林</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="机器学习.html"><a href="机器学习.html#决策树与随机森林的关系"><i class="fa fa-check"></i><b>11.3.1</b> 决策树与随机森林的关系</a></li>
<li class="chapter" data-level="11.3.2" data-path="机器学习.html"><a href="机器学习.html#随机森林的三个随机"><i class="fa fa-check"></i><b>11.3.2</b> 随机森林的三个随机</a></li>
<li class="chapter" data-level="11.3.3" data-path="机器学习.html"><a href="机器学习.html#数学定义与原理"><i class="fa fa-check"></i><b>11.3.3</b> 数学定义与原理</a></li>
<li class="chapter" data-level="11.3.4" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理"><i class="fa fa-check"></i><b>11.3.4</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.3.5" data-path="机器学习.html"><a href="机器学习.html#r代码实现"><i class="fa fa-check"></i><b>11.3.5</b> R代码实现</a></li>
<li class="chapter" data-level="11.3.6" data-path="机器学习.html"><a href="机器学习.html#代码详细说明"><i class="fa fa-check"></i><b>11.3.6</b> 代码详细说明</a></li>
<li class="chapter" data-level="11.3.7" data-path="机器学习.html"><a href="机器学习.html#模型评估与验证"><i class="fa fa-check"></i><b>11.3.7</b> 模型评估与验证</a></li>
<li class="chapter" data-level="11.3.8" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-4"><i class="fa fa-check"></i><b>11.3.8</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.3.9" data-path="机器学习.html"><a href="机器学习.html#生态学应用价值-1"><i class="fa fa-check"></i><b>11.3.9</b> 生态学应用价值</a></li>
<li class="chapter" data-level="11.3.10" data-path="机器学习.html"><a href="机器学习.html#优势与局限的深入分析"><i class="fa fa-check"></i><b>11.3.10</b> 优势与局限的深入分析</a></li>
<li class="chapter" data-level="11.3.11" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望"><i class="fa fa-check"></i><b>11.3.11</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="机器学习.html"><a href="机器学习.html#支持向量机"><i class="fa fa-check"></i><b>11.4</b> 支持向量机</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与几何直觉"><i class="fa fa-check"></i><b>11.4.1</b> 基本概念与几何直觉</a></li>
<li class="chapter" data-level="11.4.2" data-path="机器学习.html"><a href="机器学习.html#数学原理与核心概念"><i class="fa fa-check"></i><b>11.4.2</b> 数学原理与核心概念</a></li>
<li class="chapter" data-level="11.4.3" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理-1"><i class="fa fa-check"></i><b>11.4.3</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.4.4" data-path="机器学习.html"><a href="机器学习.html#r代码实现-1"><i class="fa fa-check"></i><b>11.4.4</b> R代码实现</a></li>
<li class="chapter" data-level="11.4.5" data-path="机器学习.html"><a href="机器学习.html#代码详细说明-1"><i class="fa fa-check"></i><b>11.4.5</b> 代码详细说明</a></li>
<li class="chapter" data-level="11.4.6" data-path="机器学习.html"><a href="机器学习.html#模型评估与验证-1"><i class="fa fa-check"></i><b>11.4.6</b> 模型评估与验证</a></li>
<li class="chapter" data-level="11.4.7" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-5"><i class="fa fa-check"></i><b>11.4.7</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.4.8" data-path="机器学习.html"><a href="机器学习.html#优势与局限-1"><i class="fa fa-check"></i><b>11.4.8</b> 优势与局限</a></li>
<li class="chapter" data-level="11.4.9" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望-1"><i class="fa fa-check"></i><b>11.4.9</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="机器学习.html"><a href="机器学习.html#深度神经网络"><i class="fa fa-check"></i><b>11.5</b> 深度神经网络</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与生物学启发"><i class="fa fa-check"></i><b>11.5.1</b> 基本概念与生物学启发</a></li>
<li class="chapter" data-level="11.5.2" data-path="机器学习.html"><a href="机器学习.html#主要神经网络架构"><i class="fa fa-check"></i><b>11.5.2</b> 主要神经网络架构</a></li>
<li class="chapter" data-level="11.5.3" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理-2"><i class="fa fa-check"></i><b>11.5.3</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.5.4" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-6"><i class="fa fa-check"></i><b>11.5.4</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.5.5" data-path="机器学习.html"><a href="机器学习.html#优势与局限-2"><i class="fa fa-check"></i><b>11.5.5</b> 优势与局限</a></li>
<li class="chapter" data-level="11.5.6" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望-2"><i class="fa fa-check"></i><b>11.5.6</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="机器学习.html"><a href="机器学习.html#总结-10"><i class="fa fa-check"></i><b>11.6</b> 总结</a></li>
<li class="chapter" data-level="11.7" data-path="机器学习.html"><a href="机器学习.html#综合练习-9"><i class="fa fa-check"></i><b>11.7</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html"><i class="fa fa-check"></i><b>12</b> 附录1 R语言编程基础</a>
<ul>
<li class="chapter" data-level="12.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言介绍"><i class="fa fa-check"></i><b>12.1</b> R语言介绍</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#为什么生态学专业需要学习r"><i class="fa fa-check"></i><b>12.1.1</b> 为什么生态学专业需要学习R？</a></li>
<li class="chapter" data-level="12.1.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言简介与趣味应用"><i class="fa fa-check"></i><b>12.1.2</b> R语言简介与趣味应用</a></li>
<li class="chapter" data-level="12.1.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#环境设置和配置"><i class="fa fa-check"></i><b>12.1.3</b> 环境设置和配置</a></li>
<li class="chapter" data-level="12.1.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#项目文件夹结构设置"><i class="fa fa-check"></i><b>12.1.4</b> 项目文件夹结构设置</a></li>
<li class="chapter" data-level="12.1.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#基本包管理"><i class="fa fa-check"></i><b>12.1.5</b> 基本包管理</a></li>
<li class="chapter" data-level="12.1.6" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#工作目录设置"><i class="fa fa-check"></i><b>12.1.6</b> 工作目录设置</a></li>
<li class="chapter" data-level="12.1.7" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课前准备检查清单"><i class="fa fa-check"></i><b>12.1.7</b> 课前准备检查清单</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#数值向量创建与基本统计计算"><i class="fa fa-check"></i><b>12.2</b> 数值向量创建与基本统计计算</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景"><i class="fa fa-check"></i><b>12.2.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.2.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据"><i class="fa fa-check"></i><b>12.2.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.2.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程"><i class="fa fa-check"></i><b>12.2.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.2.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解"><i class="fa fa-check"></i><b>12.2.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.2.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习"><i class="fa fa-check"></i><b>12.2.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#字符型数据处理与向量索引操作"><i class="fa fa-check"></i><b>12.3</b> 字符型数据处理与向量索引操作</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-1"><i class="fa fa-check"></i><b>12.3.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.3.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-1"><i class="fa fa-check"></i><b>12.3.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.3.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-1"><i class="fa fa-check"></i><b>12.3.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.3.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-1"><i class="fa fa-check"></i><b>12.3.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.3.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-1"><i class="fa fa-check"></i><b>12.3.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#数据框结构理解与多类型数据管理"><i class="fa fa-check"></i><b>12.4</b> 数据框结构理解与多类型数据管理</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-2"><i class="fa fa-check"></i><b>12.4.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.4.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-2"><i class="fa fa-check"></i><b>12.4.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.4.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-2"><i class="fa fa-check"></i><b>12.4.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.4.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-2"><i class="fa fa-check"></i><b>12.4.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.4.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-2"><i class="fa fa-check"></i><b>12.4.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#列表数据结构与数据分组管理"><i class="fa fa-check"></i><b>12.5</b> 列表数据结构与数据分组管理</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-3"><i class="fa fa-check"></i><b>12.5.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.5.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-3"><i class="fa fa-check"></i><b>12.5.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.5.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-3"><i class="fa fa-check"></i><b>12.5.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.5.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-3"><i class="fa fa-check"></i><b>12.5.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.5.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-3"><i class="fa fa-check"></i><b>12.5.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#外部数据导入与条件筛选分析"><i class="fa fa-check"></i><b>12.6</b> 外部数据导入与条件筛选分析</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-4"><i class="fa fa-check"></i><b>12.6.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.6.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据文件bird_monitoring.csv"><i class="fa fa-check"></i><b>12.6.2</b> 演示数据文件（bird_monitoring.csv）</a></li>
<li class="chapter" data-level="12.6.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-4"><i class="fa fa-check"></i><b>12.6.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.6.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-4"><i class="fa fa-check"></i><b>12.6.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.6.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-4"><i class="fa fa-check"></i><b>12.6.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#缺失值和异常值的识别处理"><i class="fa fa-check"></i><b>12.7</b> 缺失值和异常值的识别处理</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-5"><i class="fa fa-check"></i><b>12.7.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.7.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-4"><i class="fa fa-check"></i><b>12.7.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.7.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-5"><i class="fa fa-check"></i><b>12.7.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.7.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-5"><i class="fa fa-check"></i><b>12.7.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.7.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-5"><i class="fa fa-check"></i><b>12.7.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#描述性统计分析与基础数据可视化"><i class="fa fa-check"></i><b>12.8</b> 描述性统计分析与基础数据可视化</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-6"><i class="fa fa-check"></i><b>12.8.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.8.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-5"><i class="fa fa-check"></i><b>12.8.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.8.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-6"><i class="fa fa-check"></i><b>12.8.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.8.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-6"><i class="fa fa-check"></i><b>12.8.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.8.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-6"><i class="fa fa-check"></i><b>12.8.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#条件判断循环结构与函数编程"><i class="fa fa-check"></i><b>12.9</b> 条件判断、循环结构与函数编程</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-7"><i class="fa fa-check"></i><b>12.9.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.9.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-6"><i class="fa fa-check"></i><b>12.9.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.9.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-7"><i class="fa fa-check"></i><b>12.9.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.9.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-7"><i class="fa fa-check"></i><b>12.9.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.9.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-7"><i class="fa fa-check"></i><b>12.9.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#现代数据科学工具包应用"><i class="fa fa-check"></i><b>12.10</b> 现代数据科学工具包应用</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-8"><i class="fa fa-check"></i><b>12.10.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.10.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-7"><i class="fa fa-check"></i><b>12.10.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.10.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-8"><i class="fa fa-check"></i><b>12.10.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.10.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-8"><i class="fa fa-check"></i><b>12.10.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.10.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-8"><i class="fa fa-check"></i><b>12.10.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#图形语法与科学绘图"><i class="fa fa-check"></i><b>12.11</b> 图形语法与科学绘图</a>
<ul>
<li class="chapter" data-level="12.11.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-9"><i class="fa fa-check"></i><b>12.11.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.11.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-8"><i class="fa fa-check"></i><b>12.11.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.11.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-9"><i class="fa fa-check"></i><b>12.11.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.11.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-9"><i class="fa fa-check"></i><b>12.11.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.11.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-9"><i class="fa fa-check"></i><b>12.11.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.12" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#综合练习-10"><i class="fa fa-check"></i><b>12.12</b> 综合练习</a>
<ul>
<li class="chapter" data-level="12.12.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习1-1"><i class="fa fa-check"></i><b>12.12.1</b> 练习1</a></li>
<li class="chapter" data-level="12.12.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习2"><i class="fa fa-check"></i><b>12.12.2</b> 练习2</a></li>
<li class="chapter" data-level="12.12.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习3"><i class="fa fa-check"></i><b>12.12.3</b> 练习3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://gitee.com/gcshen/ecological-statistics" target="blank">Gitee</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">生态统计学</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="相关性与相似性" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> 相关性与相似性<a href="相关性与相似性.html#相关性与相似性" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="引言-4" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> 引言<a href="相关性与相似性.html#引言-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>生态学研究的一个核心任务是揭示自然界中各种现象之间的内在联系。在前面的章节中，我们学习了如何描述生态系统的特征，如种群数量、物种多样性等。然而，生态学的真正魅力在于理解这些特征之间的相互关系——环境因子如何影响物种分布？物种之间如何相互作用？群落结构如何响应环境变化？这些问题的答案往往隐藏在变量间的相关性或相似性之中。</p>
<p>相关性与相似性分析是揭示这些生态关系的重要统计工具。本章将带领大家从描述生态系统特征转向理解生态系统关系，这是生态学研究从现象描述到规律发现的关键跨越。对于生态学本科生而言，掌握这些分析方法不仅能够提升研究能力，更重要的是培养一种关系思维——学会从相互联系的角度来理解复杂的生态系统。</p>
<p>为什么生态学专业的学生需要学习相关性与相似性？首先，生态系统的本质是一个由无数相互关联的组分构成的复杂网络。从微观的基因表达到宏观的物种分布，从短期的种群动态到长期的气候变化响应，相关性分析为我们提供了量化这些关系的数学语言。例如，通过相关性分析，我们可以确定温度变化与物种丰富度之间的关系强度，或者评估不同环境因子对群落结构的相对重要性。</p>
<p>其次，相似性分析在生态学中具有广泛的应用价值。当我们研究不同群落的物种组成时，需要量化它们之间的相似程度；当我们分析功能性状的协变模式时，需要评估性状间的相似性关系；当我们构建生态网络时，需要基于相似性来识别物种间的相互作用。相似性分析不仅帮助我们理解生态系统的结构特征，还为保护生物学中的优先区识别、生态恢复中的参考系统选择提供了科学依据。</p>
<p>本章的内容安排遵循从基础到应用、从简单到复杂的学习路径。我们将首先介绍相关性统计的基础知识，包括Pearson相关系数、Spearman秩相关、Kendall’s τ等常用方法。随后，我们将深入探讨更复杂的相关性概念，如偏相关分析、距离相关和互信息。</p>
<p>自相关分析是本章的另一个重要组成部分，它专门处理具有时间或空间依赖性的生态数据。时间自相关分析帮助我们理解生态过程的时间动态，空间自相关分析则揭示了生态现象的空间格局。此外，我们还将介绍系统发育相关性分析，帮助我们理解性状的系统发育保守性和生态适应机制。</p>
<p>相似性与距离度量构成了本章的后半部分内容。我们将系统介绍常用的相似性系数和距离度量方法，探讨功能性状间相关性的生态学意义，以及经济型谱理论在理解植物功能策略中的应用。</p>
<p>种内相关性和种间相关性分析将帮助我们理解生物个体和物种间的空间分布模式和相互作用关系。最后，群落相似性分析将整合前面学到的各种方法，全面揭示群落结构的空间格局和环境梯度响应。</p>
<p>学习相关性与相似性分析不仅是为了掌握统计工具，更重要的是培养系统思维的能力。在生态学研究中，很少有现象是孤立存在的，理解它们之间的相互关系往往比理解单个现象本身更为重要。通过本章的学习，希望大家能够建立起从关系角度思考生态问题的习惯，为未来的生态学研究和保护实践奠定坚实的统计基础。</p>
</div>
<div id="相关性统计基础" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> 相关性统计基础<a href="相关性与相似性.html#相关性统计基础" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在生态学研究中，我们经常需要探索不同变量之间的关系。例如，我们可能想知道：森林中树木的胸径与树高之间是否存在某种关系？降水量与植物多样性之间有何联系？这些问题的答案往往需要通过相关性分析来获得。相关性分析为我们提供了一种量化变量间关系强度和方向的统计工具。</p>
<div id="相关分析" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> 相关分析<a href="相关性与相似性.html#相关分析" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="pearson相关系数线性关系的度量" class="section level4 hasAnchor" number="5.2.1.1">
<h4><span class="header-section-number">5.2.1.1</span> Pearson相关系数：线性关系的度量<a href="相关性与相似性.html#pearson相关系数线性关系的度量" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>假设我们正在研究一片温带森林中树木的胸径与树高的关系。我们测量了50棵树的胸径（cm）和树高（m），想要了解这两个变量之间是否存在线性关系。</p>
<p>Pearson相关系数是统计学中最经典的线性相关性度量方法，由卡尔·皮尔逊于1895年提出。它专门用于量化两个连续变量之间的线性关系强度和方向。其核心思想是通过计算两个变量的协方差与各自标准差的乘积之比来标准化协方差的大小，从而得到一个无量纲的相关系数。</p>
<p>Pearson相关系数的取值范围在-1到1之间。正值表示正相关关系，即当一个变量增加时另一个变量也倾向于增加；负值表示负相关关系，即当一个变量增加时另一个变量倾向于减少；0值则表示两个变量之间不存在线性相关关系。</p>
<p>值得注意的是，Pearson相关系数只能检测线性关系，对于非线性关系可能会给出接近0的值，即使变量间存在强烈的非线性关联。这种方法对异常值比较敏感，且要求数据大致满足正态分布假设。</p>
<p>在生态学研究中，Pearson相关系数常用于分析环境梯度与生物响应之间的线性趋势，如温度与物种丰富度的关系、土壤养分与植物生长的关系等。然而，生态学家需要谨慎使用这种方法，因为许多生态关系本质上是非线性的。此外，Pearson相关系数只能反映变量间的统计关联，不能证明因果关系，这在复杂的生态系统中尤为重要。</p>
<p><strong>数学定义</strong>：对于两个变量<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>，Pearson相关系数<span class="math inline">\(r\)</span>定义为：</p>
<p><span class="math display">\[r = \frac{\sum_{i=1}^{n}(X_i - \bar{X})(Y_i - \bar{Y})}{\sqrt{\sum_{i=1}^{n}(X_i - \bar{X})^2}\sqrt{\sum_{i=1}^{n}(Y_i - \bar{Y})^2}}\]</span></p>
<p>其中<span class="math inline">\(n\)</span>是样本量，<span class="math inline">\(\bar{X}\)</span>和<span class="math inline">\(\bar{Y}\)</span>分别是<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>的样本均值。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="相关性与相似性.html#cb522-1" tabindex="-1"></a><span class="co"># Pearson相关系数示例：树木胸径与树高的关系</span></span>
<span id="cb522-2"><a href="相关性与相似性.html#cb522-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb522-3"><a href="相关性与相似性.html#cb522-3" tabindex="-1"></a></span>
<span id="cb522-4"><a href="相关性与相似性.html#cb522-4" tabindex="-1"></a><span class="co"># 模拟树木数据</span></span>
<span id="cb522-5"><a href="相关性与相似性.html#cb522-5" tabindex="-1"></a>n_trees <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb522-6"><a href="相关性与相似性.html#cb522-6" tabindex="-1"></a>dbh <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_trees, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">5</span>) <span class="co"># 胸径(cm)</span></span>
<span id="cb522-7"><a href="相关性与相似性.html#cb522-7" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> dbh <span class="sc">+</span> <span class="fu">rnorm</span>(n_trees, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>) <span class="co"># 树高(m)</span></span>
<span id="cb522-8"><a href="相关性与相似性.html#cb522-8" tabindex="-1"></a></span>
<span id="cb522-9"><a href="相关性与相似性.html#cb522-9" tabindex="-1"></a><span class="co"># 计算Pearson相关系数</span></span>
<span id="cb522-10"><a href="相关性与相似性.html#cb522-10" tabindex="-1"></a>pearson_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(dbh, height, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb522-11"><a href="相关性与相似性.html#cb522-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Pearson相关系数：&quot;</span>, <span class="fu">round</span>(pearson_cor, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Pearson相关系数： 0.59</code></pre>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="相关性与相似性.html#cb524-1" tabindex="-1"></a><span class="co"># 可视化散点图</span></span>
<span id="cb524-2"><a href="相关性与相似性.html#cb524-2" tabindex="-1"></a><span class="fu">plot</span>(dbh, height,</span>
<span id="cb524-3"><a href="相关性与相似性.html#cb524-3" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb524-4"><a href="相关性与相似性.html#cb524-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;胸径 (cm)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;树高 (m)&quot;</span>,</span>
<span id="cb524-5"><a href="相关性与相似性.html#cb524-5" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;树木胸径与树高的关系&quot;</span></span>
<span id="cb524-6"><a href="相关性与相似性.html#cb524-6" tabindex="-1"></a>)</span>
<span id="cb524-7"><a href="相关性与相似性.html#cb524-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(height <span class="sc">~</span> dbh), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb524-8"><a href="相关性与相似性.html#cb524-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb524-9"><a href="相关性与相似性.html#cb524-9" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">paste</span>(<span class="st">&quot;r =&quot;</span>, <span class="fu">round</span>(pearson_cor, <span class="dv">3</span>)),</span>
<span id="cb524-10"><a href="相关性与相似性.html#cb524-10" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb524-11"><a href="相关性与相似性.html#cb524-11" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-3-1.png" alt="树木胸径与树高的关系散点图，显示线性相关关系" width="672" />
<p class="caption">
图2.1: 树木胸径与树高的关系散点图，显示线性相关关系
</p>
</div>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="相关性与相似性.html#cb525-1" tabindex="-1"></a><span class="co"># 进行相关性检验</span></span>
<span id="cb525-2"><a href="相关性与相似性.html#cb525-2" tabindex="-1"></a>cor_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(dbh, height, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb525-3"><a href="相关性与相似性.html#cb525-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;相关性检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb525-4"><a href="相关性与相似性.html#cb525-4" tabindex="-1"></a>    <span class="st">&quot;t统计量：&quot;</span>, <span class="fu">round</span>(cor_test<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb525-5"><a href="相关性与相似性.html#cb525-5" tabindex="-1"></a>    <span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(cor_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb525-6"><a href="相关性与相似性.html#cb525-6" tabindex="-1"></a>    <span class="st">&quot;95%置信区间：[&quot;</span>, <span class="fu">round</span>(cor_test<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb525-7"><a href="相关性与相似性.html#cb525-7" tabindex="-1"></a>    <span class="st">&quot;,&quot;</span>, <span class="fu">round</span>(cor_test<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb525-8"><a href="相关性与相似性.html#cb525-8" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 相关性检验结果：
## t统计量：5.068
## p值：6.39e-06
## 95%置信区间：[0.373,0.746]</code></pre>
<p><strong>生态学意义</strong>：Pearson相关系数在生态学中广泛应用于量化环境因子与生物响应之间的关系，如温度与物种丰富度的关系、养分浓度与植物生长的关系等。</p>
</div>
<div id="spearman秩相关单调关系的度量" class="section level4 hasAnchor" number="5.2.1.2">
<h4><span class="header-section-number">5.2.1.2</span> Spearman秩相关：单调关系的度量<a href="相关性与相似性.html#spearman秩相关单调关系的度量" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>在研究河流水质与底栖动物多样性的关系时，我们发现两者之间的关系可能不是严格的线性关系，但存在明显的单调趋势——水质越好，多样性越高。</p>
<p>Spearman秩相关系数是一种基于秩次的非参数相关性度量方法，由查尔斯·斯皮尔曼于1904年提出。与Pearson相关系数专注于线性关系不同，Spearman相关专门用于检测变量间的单调关系——即当一个变量增加时，另一个变量也倾向于增加（正单调关系）或减少（负单调关系），无论这种关系是线性的还是非线性的。</p>
<p>这种方法的独特之处在于它完全基于变量的秩次信息，而不是原始数值大小，这使得它对异常值具有天然的鲁棒性。在计算Spearman相关系数时，我们首先将每个变量的观测值转换为秩次（即按大小排序后的位置），然后计算这些秩次之间的Pearson相关系数。</p>
<p>Spearman相关系数的取值范围在-1到1之间。正值表示正单调关系，负值表示负单调关系，0值表示没有单调关系。值得注意的是，Spearman相关系数度量的是变量间关系的单调性强度，而不是线性强度。这意味着即使两个变量之间存在强烈的非线性单调关系，Spearman相关也能给出接近1或-1的值，而Pearson相关在这种情况下可能给出接近0的值。</p>
<p>在生态学研究中，这种特性使得Spearman相关特别适用于分析等级数据、存在异常值的数据、或者分布未知的数据。例如，在分析环境梯度对物种分布的影响时，许多生态响应关系本质上是单调但非线性的，如物种丰富度随海拔或纬度的变化、生物量随养分浓度的变化等。此外，Spearman相关对数据的分布形式没有严格要求，不要求变量满足正态分布假设，这使其在处理生态学中常见的偏态分布数据时具有明显优势。然而，生态学家需要注意，Spearman相关只能检测单调关系，对于非单调的复杂关系（如U型关系、周期性关系）仍然无法有效识别。</p>
<p><strong>数学定义</strong>：对于两个变量<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>，Spearman相关系数<span class="math inline">\(\rho\)</span>定义为：</p>
<p><span class="math display">\[\rho = 1 - \frac{6\sum_{i=1}^{n}d_i^2}{n(n^2-1)}\]</span></p>
<p>其中<span class="math inline">\(d_i\)</span>是第<span class="math inline">\(i\)</span>个观测在<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>上的秩次差，<span class="math inline">\(n\)</span>是样本量。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="相关性与相似性.html#cb527-1" tabindex="-1"></a><span class="co"># Spearman秩相关示例：河流水质与底栖动物多样性</span></span>
<span id="cb527-2"><a href="相关性与相似性.html#cb527-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb527-3"><a href="相关性与相似性.html#cb527-3" tabindex="-1"></a></span>
<span id="cb527-4"><a href="相关性与相似性.html#cb527-4" tabindex="-1"></a><span class="co"># 模拟河流数据</span></span>
<span id="cb527-5"><a href="相关性与相似性.html#cb527-5" tabindex="-1"></a>n_rivers <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb527-6"><a href="相关性与相似性.html#cb527-6" tabindex="-1"></a>water_quality <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_rivers, <span class="dv">0</span>, <span class="dv">100</span>) <span class="co"># 水质指数（0-100）</span></span>
<span id="cb527-7"><a href="相关性与相似性.html#cb527-7" tabindex="-1"></a><span class="co"># 模拟单调但非线性的关系</span></span>
<span id="cb527-8"><a href="相关性与相似性.html#cb527-8" tabindex="-1"></a>macroinvertebrate_diversity <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> water_quality <span class="sc">+</span></span>
<span id="cb527-9"><a href="相关性与相似性.html#cb527-9" tabindex="-1"></a>  <span class="fl">0.01</span> <span class="sc">*</span> water_quality<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb527-10"><a href="相关性与相似性.html#cb527-10" tabindex="-1"></a>  <span class="fu">rnorm</span>(n_rivers, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb527-11"><a href="相关性与相似性.html#cb527-11" tabindex="-1"></a></span>
<span id="cb527-12"><a href="相关性与相似性.html#cb527-12" tabindex="-1"></a><span class="co"># 计算Spearman相关系数</span></span>
<span id="cb527-13"><a href="相关性与相似性.html#cb527-13" tabindex="-1"></a>spearman_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(water_quality, macroinvertebrate_diversity, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb527-14"><a href="相关性与相似性.html#cb527-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Spearman相关系数：&quot;</span>, <span class="fu">round</span>(spearman_cor, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Spearman相关系数： 0.991</code></pre>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="相关性与相似性.html#cb529-1" tabindex="-1"></a><span class="co"># 进行相关性检验</span></span>
<span id="cb529-2"><a href="相关性与相似性.html#cb529-2" tabindex="-1"></a>spearman_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(water_quality, macroinvertebrate_diversity, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb529-3"><a href="相关性与相似性.html#cb529-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Spearman检验p值：&quot;</span>, <span class="fu">format.pval</span>(spearman_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Spearman检验p值： &lt;2e-16</code></pre>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="相关性与相似性.html#cb531-1" tabindex="-1"></a><span class="co"># 可视化关系</span></span>
<span id="cb531-2"><a href="相关性与相似性.html#cb531-2" tabindex="-1"></a><span class="fu">plot</span>(water_quality, macroinvertebrate_diversity,</span>
<span id="cb531-3"><a href="相关性与相似性.html#cb531-3" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb531-4"><a href="相关性与相似性.html#cb531-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;水质指数&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;底栖动物多样性&quot;</span>,</span>
<span id="cb531-5"><a href="相关性与相似性.html#cb531-5" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;河流水质与底栖动物多样性的关系&quot;</span></span>
<span id="cb531-6"><a href="相关性与相似性.html#cb531-6" tabindex="-1"></a>)</span>
<span id="cb531-7"><a href="相关性与相似性.html#cb531-7" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(water_quality, macroinvertebrate_diversity), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb531-8"><a href="相关性与相似性.html#cb531-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb531-9"><a href="相关性与相似性.html#cb531-9" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">paste</span>(<span class="st">&quot;ρ =&quot;</span>, <span class="fu">round</span>(spearman_cor, <span class="dv">3</span>)),</span>
<span id="cb531-10"><a href="相关性与相似性.html#cb531-10" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb531-11"><a href="相关性与相似性.html#cb531-11" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-6-1.png" alt="河流水质与底栖动物多样性的关系散点图，显示单调非线性关系" width="672" />
<p class="caption">
图5.1: 河流水质与底栖动物多样性的关系散点图，显示单调非线性关系
</p>
</div>
<p><strong>生态学意义</strong>：Spearman相关特别适用于生态学中常见的等级数据或存在异常值的情况，如物种丰富度的排序比较、环境梯度的响应分析等。</p>
</div>
<div id="kendalls-τ基于一致对的比例" class="section level4 hasAnchor" number="5.2.1.3">
<h4><span class="header-section-number">5.2.1.3</span> Kendall’s τ：基于一致对的比例<a href="相关性与相似性.html#kendalls-τ基于一致对的比例" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>在研究鸟类迁徙时间与气温变化的关系时，我们想要一个对异常值不敏感的相关性度量，因为个别极端天气事件可能影响整体趋势的判断。</p>
<p>Kendall’s τ（tau）是另一种基于秩次的非参数相关性度量方法，由英国统计学家莫里斯·肯德尔于1938年提出。与Spearman相关类似，Kendall’s τ也用于度量变量间的单调关系，但其计算原理和统计性质有所不同。Kendall’s τ的核心思想是基于数据对的一致性来评估变量间的关系强度。具体而言，它考察所有可能的数据对（共<span class="math inline">\(\frac{1}{2}n(n-1)\)</span>对），统计其中一致对和不一致对的数量。一致对是指当<span class="math inline">\(X_i &lt; X_j\)</span>时<span class="math inline">\(Y_i &lt; Y_j\)</span>，或者当<span class="math inline">\(X_i &gt; X_j\)</span>时<span class="math inline">\(Y_i &gt; Y_j\)</span>的数据对，即两个变量在排序上保持一致；不一致对则是指排序相反的数据对。Kendall’s τ的计算公式反映了这种一致对与不一致对的净比例，其取值范围在-1到1之间，与Pearson和Spearman相关系数相同。</p>
<p>Kendall’s τ的一个重要特点是其对异常值的极端稳健性。由于它只关注数据对的相对排序而不关心具体的数值大小，单个异常值对整体估计的影响非常有限。这种特性使得Kendall’s τ特别适用于生态学中常见的小样本研究、存在测量误差的数据、或者包含极端观测值的情况。例如，在气候变化对物候影响的研究中，个别异常温暖的年份可能会显著影响Pearson相关系数的估计，但对Kendall’s τ的影响相对较小。另一个重要优势是Kendall’s τ具有更直观的概率解释：当Kendall’s τ等于0.6时，可以理解为任意随机选择的一对观测值，它们在这两个变量上具有一致排序的概率比不一致排序的概率高60%。这种概率解释在生态学应用中往往比相关系数本身更容易理解和传达。此外，Kendall’s τ的抽样分布在小样本情况下更加稳定，其标准误的计算也比Spearman相关更为精确。然而，Kendall’s τ的计算复杂度较高，对于大样本数据计算时间较长，这是其在实际应用中的一个局限。在生态学研究中，Kendall’s τ特别适用于时间序列分析、物种对环境梯度的响应研究、以及需要处理等级数据或存在大量结（ties）的情况。</p>
<p><strong>数学定义</strong>：对于两个变量<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>，Kendall’s τ定义为：</p>
<p><span class="math display">\[\tau = \frac{(一致对的数量) - (不一致对的数量)}{\frac{1}{2}n(n-1)}\]</span></p>
<p>其中一致对是指当<span class="math inline">\(X_i &lt; X_j\)</span>时<span class="math inline">\(Y_i &lt; Y_j\)</span>，或者当<span class="math inline">\(X_i &gt; X_j\)</span>时<span class="math inline">\(Y_i &gt; Y_j\)</span>的数据对。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="相关性与相似性.html#cb532-1" tabindex="-1"></a><span class="co"># Kendall&#39;s τ示例：鸟类迁徙时间与气温变化</span></span>
<span id="cb532-2"><a href="相关性与相似性.html#cb532-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb532-3"><a href="相关性与相似性.html#cb532-3" tabindex="-1"></a></span>
<span id="cb532-4"><a href="相关性与相似性.html#cb532-4" tabindex="-1"></a><span class="co"># 模拟迁徙数据</span></span>
<span id="cb532-5"><a href="相关性与相似性.html#cb532-5" tabindex="-1"></a>n_years <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb532-6"><a href="相关性与相似性.html#cb532-6" tabindex="-1"></a>spring_temperature <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_years, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">3</span>) <span class="co"># 春季平均温度</span></span>
<span id="cb532-7"><a href="相关性与相似性.html#cb532-7" tabindex="-1"></a><span class="co"># 添加一个异常值</span></span>
<span id="cb532-8"><a href="相关性与相似性.html#cb532-8" tabindex="-1"></a>spring_temperature[<span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="dv">25</span> <span class="co"># 异常温暖的年份</span></span>
<span id="cb532-9"><a href="相关性与相似性.html#cb532-9" tabindex="-1"></a>arrival_date <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> spring_temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n_years, <span class="dv">0</span>, <span class="dv">5</span>) <span class="co"># 到达日期（儒略日）</span></span>
<span id="cb532-10"><a href="相关性与相似性.html#cb532-10" tabindex="-1"></a></span>
<span id="cb532-11"><a href="相关性与相似性.html#cb532-11" tabindex="-1"></a><span class="co"># 计算Kendall&#39;s τ</span></span>
<span id="cb532-12"><a href="相关性与相似性.html#cb532-12" tabindex="-1"></a>kendall_tau <span class="ot">&lt;-</span> <span class="fu">cor</span>(spring_temperature, arrival_date, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb532-13"><a href="相关性与相似性.html#cb532-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Kendall&#39;s τ：&quot;</span>, <span class="fu">round</span>(kendall_tau, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Kendall&#39;s τ： -0.54</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="相关性与相似性.html#cb534-1" tabindex="-1"></a><span class="co"># 比较不同方法的结果</span></span>
<span id="cb534-2"><a href="相关性与相似性.html#cb534-2" tabindex="-1"></a>pearson_comp <span class="ot">&lt;-</span> <span class="fu">cor</span>(spring_temperature, arrival_date, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb534-3"><a href="相关性与相似性.html#cb534-3" tabindex="-1"></a>spearman_comp <span class="ot">&lt;-</span> <span class="fu">cor</span>(spring_temperature, arrival_date, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb534-4"><a href="相关性与相似性.html#cb534-4" tabindex="-1"></a></span>
<span id="cb534-5"><a href="相关性与相似性.html#cb534-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;不同相关性系数的比较：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb534-6"><a href="相关性与相似性.html#cb534-6" tabindex="-1"></a>    <span class="st">&quot;Pearson：&quot;</span>, <span class="fu">round</span>(pearson_comp, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb534-7"><a href="相关性与相似性.html#cb534-7" tabindex="-1"></a>    <span class="st">&quot;Spearman：&quot;</span>, <span class="fu">round</span>(spearman_comp, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb534-8"><a href="相关性与相似性.html#cb534-8" tabindex="-1"></a>    <span class="st">&quot;Kendall&#39;s τ：&quot;</span>, <span class="fu">round</span>(kendall_tau, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb534-9"><a href="相关性与相似性.html#cb534-9" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 不同相关性系数的比较：
## Pearson：-0.79
## Spearman：-0.692
## Kendall&#39;s τ：-0.54</code></pre>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="相关性与相似性.html#cb536-1" tabindex="-1"></a><span class="co"># 可视化数据</span></span>
<span id="cb536-2"><a href="相关性与相似性.html#cb536-2" tabindex="-1"></a><span class="fu">plot</span>(spring_temperature, arrival_date,</span>
<span id="cb536-3"><a href="相关性与相似性.html#cb536-3" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>,</span>
<span id="cb536-4"><a href="相关性与相似性.html#cb536-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;春季平均温度 (°C)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;鸟类到达日期（儒略日）&quot;</span>,</span>
<span id="cb536-5"><a href="相关性与相似性.html#cb536-5" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;气温变化与鸟类迁徙时间的关系&quot;</span></span>
<span id="cb536-6"><a href="相关性与相似性.html#cb536-6" tabindex="-1"></a>)</span>
<span id="cb536-7"><a href="相关性与相似性.html#cb536-7" tabindex="-1"></a><span class="fu">points</span>(spring_temperature[<span class="dv">10</span>], arrival_date[<span class="dv">10</span>], <span class="at">pch =</span> <span class="dv">17</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb536-8"><a href="相关性与相似性.html#cb536-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb536-9"><a href="相关性与相似性.html#cb536-9" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;正常数据&quot;</span>, <span class="st">&quot;异常值&quot;</span>),</span>
<span id="cb536-10"><a href="相关性与相似性.html#cb536-10" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">17</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;purple&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb536-11"><a href="相关性与相似性.html#cb536-11" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-7-1.png" alt="鸟类迁徙时间与气温变化的关系散点图，显示对异常值的稳健性" width="672" />
<p class="caption">
图5.2: 鸟类迁徙时间与气温变化的关系散点图，显示对异常值的稳健性
</p>
</div>
<p><strong>生态学意义</strong>：Kendall’s τ在小样本或存在异常值的情况下表现稳定，适用于生态时间序列分析、物种对环境变化的响应研究等。</p>
</div>
</div>
<div id="偏相关分析" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> 偏相关分析<a href="相关性与相似性.html#偏相关分析" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在研究森林生产力与降水量的关系时，我们发现温度也可能同时影响这两个变量。为了了解降水量对生产力的直接影响，我们需要控制温度的影响。</p>
<p>偏相关分析是一种重要的统计技术，用于在控制其他变量（称为控制变量或协变量）的影响后，评估两个变量之间的净相关关系。在生态学研究中，变量间的关系往往受到多种环境因子的共同影响，简单的双变量相关分析可能无法揭示变量间的真实关系。偏相关分析通过数学方法”剥离”控制变量的影响，使我们能够更准确地评估目标变量间的直接关系。这种方法的理论基础可以追溯到20世纪初，但直到多元统计方法的发展才在生态学中得到广泛应用。偏相关分析的核心思想是：如果两个变量<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>都与第三个变量<span class="math inline">\(Z\)</span>相关，那么<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>之间的简单相关可能部分或完全由它们与<span class="math inline">\(Z\)</span>的共同关系所驱动。通过控制<span class="math inline">\(Z\)</span>的影响，我们可以得到<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>之间的”纯净”相关，即排除了<span class="math inline">\(Z\)</span>的混淆效应后的直接关系。</p>
<p>偏相关系数的计算基于残差分析的思想。具体而言，我们首先通过线性回归分别从<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>中去除<span class="math inline">\(Z\)</span>的影响，得到两个残差序列，然后计算这两个残差序列之间的相关系数。这个相关系数就是<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>在控制<span class="math inline">\(Z\)</span>后的偏相关系数。从数学上看，偏相关系数可以理解为在保持<span class="math inline">\(Z\)</span>不变的情况下，<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>之间的条件相关。在生态学应用中，偏相关分析具有极其重要的价值。例如，在研究森林生产力与降水量的关系时，温度可能同时影响这两个变量——温度较高时通常降水量也较多，同时温度本身也直接影响植物的光合作用效率。如果不控制温度的影响，我们可能会高估降水量对生产力的直接作用。偏相关分析能够帮助我们识别这种”伪相关”或”间接相关”，从而更准确地理解生态系统的内在机制。此外，偏相关分析在生态网络构建、物种相互作用分析、环境因子筛选等复杂生态学问题中都有广泛应用。然而，生态学家需要注意，偏相关分析仍然基于线性关系的假设，且要求控制变量与目标变量之间的关系大致满足线性模型的前提条件。在高度非线性的生态系统中，偏相关分析的结果需要谨慎解释。</p>
<p><strong>数学定义</strong>：对于变量<span class="math inline">\(X\)</span>、<span class="math inline">\(Y\)</span>和控制变量<span class="math inline">\(Z\)</span>，<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>在控制<span class="math inline">\(Z\)</span>后的偏相关系数为：</p>
<p><span class="math display">\[r_{XY.Z} = \frac{r_{XY} - r_{XZ}r_{YZ}}{\sqrt{(1-r_{XZ}^2)(1-r_{YZ}^2)}}\]</span></p>
<p>其中<span class="math inline">\(r_{XY}\)</span>、<span class="math inline">\(r_{XZ}\)</span>、<span class="math inline">\(r_{YZ}\)</span>分别是相应的Pearson相关系数。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="相关性与相似性.html#cb537-1" tabindex="-1"></a><span class="co"># 偏相关分析示例：森林生产力与降水量的关系</span></span>
<span id="cb537-2"><a href="相关性与相似性.html#cb537-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb537-3"><a href="相关性与相似性.html#cb537-3" tabindex="-1"></a></span>
<span id="cb537-4"><a href="相关性与相似性.html#cb537-4" tabindex="-1"></a><span class="co"># 模拟森林生态系统数据</span></span>
<span id="cb537-5"><a href="相关性与相似性.html#cb537-5" tabindex="-1"></a>n_plots <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb537-6"><a href="相关性与相似性.html#cb537-6" tabindex="-1"></a>precipitation <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_plots, <span class="at">mean =</span> <span class="dv">1000</span>, <span class="at">sd =</span> <span class="dv">200</span>) <span class="co"># 年降水量(mm)</span></span>
<span id="cb537-7"><a href="相关性与相似性.html#cb537-7" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_plots, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">3</span>) <span class="co"># 年平均温度(°C)</span></span>
<span id="cb537-8"><a href="相关性与相似性.html#cb537-8" tabindex="-1"></a><span class="co"># 生产力同时受降水和温度影响</span></span>
<span id="cb537-9"><a href="相关性与相似性.html#cb537-9" tabindex="-1"></a>productivity <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.002</span> <span class="sc">*</span> precipitation <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n_plots, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb537-10"><a href="相关性与相似性.html#cb537-10" tabindex="-1"></a></span>
<span id="cb537-11"><a href="相关性与相似性.html#cb537-11" tabindex="-1"></a><span class="co"># 计算简单相关系数</span></span>
<span id="cb537-12"><a href="相关性与相似性.html#cb537-12" tabindex="-1"></a>simple_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(precipitation, productivity)</span>
<span id="cb537-13"><a href="相关性与相似性.html#cb537-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;降水量与生产力的简单相关系数：&quot;</span>, <span class="fu">round</span>(simple_cor, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 降水量与生产力的简单相关系数： 0.33</code></pre>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="相关性与相似性.html#cb539-1" tabindex="-1"></a><span class="co"># 计算偏相关系数（控制温度影响）</span></span>
<span id="cb539-2"><a href="相关性与相似性.html#cb539-2" tabindex="-1"></a><span class="fu">library</span>(ppcor) <span class="co"># 需要安装：install.packages(&quot;ppcor&quot;)</span></span>
<span id="cb539-3"><a href="相关性与相似性.html#cb539-3" tabindex="-1"></a></span>
<span id="cb539-4"><a href="相关性与相似性.html#cb539-4" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb539-5"><a href="相关性与相似性.html#cb539-5" tabindex="-1"></a>eco_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(precipitation, temperature, productivity)</span>
<span id="cb539-6"><a href="相关性与相似性.html#cb539-6" tabindex="-1"></a>partial_cor <span class="ot">&lt;-</span> <span class="fu">pcor</span>(eco_data)<span class="sc">$</span>estimate</span>
<span id="cb539-7"><a href="相关性与相似性.html#cb539-7" tabindex="-1"></a></span>
<span id="cb539-8"><a href="相关性与相似性.html#cb539-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;偏相关系数矩阵：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 偏相关系数矩阵：</code></pre>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="相关性与相似性.html#cb541-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(partial_cor, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##               precipitation temperature productivity
## precipitation         1.000      -0.223        0.389
## temperature          -0.223       1.000        0.666
## productivity          0.389       0.666        1.000</code></pre>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="相关性与相似性.html#cb543-1" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb543-2"><a href="相关性与相似性.html#cb543-2" tabindex="-1"></a>  <span class="st">&quot;</span><span class="sc">\n</span><span class="st">控制温度后，降水量与生产力的偏相关系数：&quot;</span>,</span>
<span id="cb543-3"><a href="相关性与相似性.html#cb543-3" tabindex="-1"></a>  <span class="fu">round</span>(partial_cor[<span class="st">&quot;precipitation&quot;</span>, <span class="st">&quot;productivity&quot;</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb543-4"><a href="相关性与相似性.html#cb543-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 
## 控制温度后，降水量与生产力的偏相关系数： 0.389</code></pre>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="相关性与相似性.html#cb545-1" tabindex="-1"></a><span class="co"># 可视化偏相关关系</span></span>
<span id="cb545-2"><a href="相关性与相似性.html#cb545-2" tabindex="-1"></a><span class="co"># 使用残差法展示偏相关</span></span>
<span id="cb545-3"><a href="相关性与相似性.html#cb545-3" tabindex="-1"></a>resid_precip <span class="ot">&lt;-</span> <span class="fu">resid</span>(<span class="fu">lm</span>(precipitation <span class="sc">~</span> temperature))</span>
<span id="cb545-4"><a href="相关性与相似性.html#cb545-4" tabindex="-1"></a>resid_prod <span class="ot">&lt;-</span> <span class="fu">resid</span>(<span class="fu">lm</span>(productivity <span class="sc">~</span> temperature))</span>
<span id="cb545-5"><a href="相关性与相似性.html#cb545-5" tabindex="-1"></a></span>
<span id="cb545-6"><a href="相关性与相似性.html#cb545-6" tabindex="-1"></a><span class="fu">plot</span>(resid_precip, resid_prod,</span>
<span id="cb545-7"><a href="相关性与相似性.html#cb545-7" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;brown&quot;</span>,</span>
<span id="cb545-8"><a href="相关性与相似性.html#cb545-8" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;降水量残差（控制温度后）&quot;</span>,</span>
<span id="cb545-9"><a href="相关性与相似性.html#cb545-9" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;生产力残差（控制温度后）&quot;</span>,</span>
<span id="cb545-10"><a href="相关性与相似性.html#cb545-10" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;控制温度影响后的降水量与生产力关系&quot;</span></span>
<span id="cb545-11"><a href="相关性与相似性.html#cb545-11" tabindex="-1"></a>)</span>
<span id="cb545-12"><a href="相关性与相似性.html#cb545-12" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(resid_prod <span class="sc">~</span> resid_precip), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb545-13"><a href="相关性与相似性.html#cb545-13" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb545-14"><a href="相关性与相似性.html#cb545-14" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">paste</span>(</span>
<span id="cb545-15"><a href="相关性与相似性.html#cb545-15" tabindex="-1"></a>    <span class="st">&quot;偏相关系数 =&quot;</span>,</span>
<span id="cb545-16"><a href="相关性与相似性.html#cb545-16" tabindex="-1"></a>    <span class="fu">round</span>(partial_cor[<span class="st">&quot;precipitation&quot;</span>, <span class="st">&quot;productivity&quot;</span>], <span class="dv">3</span>)</span>
<span id="cb545-17"><a href="相关性与相似性.html#cb545-17" tabindex="-1"></a>  ),</span>
<span id="cb545-18"><a href="相关性与相似性.html#cb545-18" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb545-19"><a href="相关性与相似性.html#cb545-19" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-10-1.png" alt="控制温度影响后的降水量与生产力关系散点图" width="672" />
<p class="caption">
图2.6: 控制温度影响后的降水量与生产力关系散点图
</p>
</div>
<p><strong>生态学意义</strong>：偏相关分析在生态学中非常重要，因为它能帮助识别变量间的直接因果关系，排除混杂变量的影响，在复杂的生态系统研究中尤为有用。</p>
</div>
<div id="距离相关" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> 距离相关<a href="相关性与相似性.html#距离相关" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在研究植物功能性状之间的关系时，我们可能发现某些性状间存在复杂的非线性关系，传统的线性相关方法无法有效捕捉这些模式。</p>
<p>距离相关是一种革命性的非参数相关性度量方法，由统计学家Gábor J. Székely等人于2007年提出，它能够检测任意分布变量间的依赖关系，包括线性和非线性关系。与传统的相关性度量方法不同，距离相关不依赖于变量间的线性或单调关系假设，而是基于变量间距离的协方差来度量相关性。这种方法的独特之处在于它能够检测任何形式的统计依赖关系，只要这种依赖关系在概率意义上是存在的。距离相关的核心概念是距离协方差和距离方差，这些概念扩展了传统的协方差和方差概念，使其能够捕捉更复杂的依赖模式。距离协方差度量的是两个变量在距离空间中的协同变化程度，而距离方差则度量单个变量在距离空间中的变异程度。</p>
<p>距离相关系数的取值范围在0到1之间，其中0表示变量间完全独立，1表示变量间存在确定的函数关系。值得注意的是，距离相关具有一个非常重要的性质：当且仅当两个变量相互独立时，距离相关系数等于0。这一性质使得距离相关成为检验变量独立性的有力工具。在生态学研究中，这种特性具有重要的应用价值。许多生态关系本质上是非线性的，如物种-面积关系、功能性状权衡、种群动态模型等，传统的线性相关方法往往无法充分描述这些复杂模式。距离相关能够有效捕捉这些非线性关系，为生态学家提供了更全面的分析工具。例如，在分析植物功能性状间的关系时，我们可能发现叶面积与比叶重之间存在U型关系——中等大小的叶片具有最高的比叶重，而过大或过小的叶片比叶重较低。这种复杂的非线性关系用Pearson或Spearman相关可能无法有效检测，但距离相关能够给出显著的非零值。此外，距离相关对变量的分布形式没有要求，适用于连续变量、离散变量甚至混合类型的数据，这使其在处理生态学中常见的复杂数据类型时具有明显优势。然而，生态学家需要注意，距离相关的计算复杂度较高，对于大样本数据可能需要较长的计算时间，且其统计性质在小样本情况下的表现仍需谨慎评估。</p>
<p><strong>数学定义</strong>：对于两个变量<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>，距离相关系数定义为：</p>
<p><span class="math display">\[dCor(X,Y) = \frac{dCov(X,Y)}{\sqrt{dVar(X)dVar(Y)}}\]</span></p>
<p>其中<span class="math inline">\(dCov\)</span>是距离协方差，<span class="math inline">\(dVar\)</span>是距离方差。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="相关性与相似性.html#cb546-1" tabindex="-1"></a><span class="co"># 距离相关示例：植物功能性状间的关系</span></span>
<span id="cb546-2"><a href="相关性与相似性.html#cb546-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb546-3"><a href="相关性与相似性.html#cb546-3" tabindex="-1"></a></span>
<span id="cb546-4"><a href="相关性与相似性.html#cb546-4" tabindex="-1"></a><span class="co"># 模拟植物功能性状数据</span></span>
<span id="cb546-5"><a href="相关性与相似性.html#cb546-5" tabindex="-1"></a>n_plants <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb546-6"><a href="相关性与相似性.html#cb546-6" tabindex="-1"></a>leaf_area <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_plants, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>) <span class="co"># 叶面积(cm²)</span></span>
<span id="cb546-7"><a href="相关性与相似性.html#cb546-7" tabindex="-1"></a><span class="co"># 模拟非线性关系：比叶重与叶面积的U型关系</span></span>
<span id="cb546-8"><a href="相关性与相似性.html#cb546-8" tabindex="-1"></a>specific_leaf_area <span class="ot">&lt;-</span> <span class="dv">150</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> (leaf_area <span class="sc">-</span> <span class="dv">20</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n_plants, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb546-9"><a href="相关性与相似性.html#cb546-9" tabindex="-1"></a></span>
<span id="cb546-10"><a href="相关性与相似性.html#cb546-10" tabindex="-1"></a><span class="co"># 计算距离相关</span></span>
<span id="cb546-11"><a href="相关性与相似性.html#cb546-11" tabindex="-1"></a><span class="fu">library</span>(energy) <span class="co"># 需要安装：install.packages(&quot;energy&quot;)</span></span>
<span id="cb546-12"><a href="相关性与相似性.html#cb546-12" tabindex="-1"></a></span>
<span id="cb546-13"><a href="相关性与相似性.html#cb546-13" tabindex="-1"></a>dcor_result <span class="ot">&lt;-</span> <span class="fu">dcor</span>(leaf_area, specific_leaf_area)</span>
<span id="cb546-14"><a href="相关性与相似性.html#cb546-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;距离相关系数：&quot;</span>, <span class="fu">round</span>(dcor_result, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 距离相关系数： 0.454</code></pre>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="相关性与相似性.html#cb548-1" tabindex="-1"></a><span class="co"># 比较不同相关性方法</span></span>
<span id="cb548-2"><a href="相关性与相似性.html#cb548-2" tabindex="-1"></a>pearson_dc <span class="ot">&lt;-</span> <span class="fu">cor</span>(leaf_area, specific_leaf_area, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb548-3"><a href="相关性与相似性.html#cb548-3" tabindex="-1"></a>spearman_dc <span class="ot">&lt;-</span> <span class="fu">cor</span>(leaf_area, specific_leaf_area, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb548-4"><a href="相关性与相似性.html#cb548-4" tabindex="-1"></a></span>
<span id="cb548-5"><a href="相关性与相似性.html#cb548-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;不同相关性方法的比较：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb548-6"><a href="相关性与相似性.html#cb548-6" tabindex="-1"></a>    <span class="st">&quot;Pearson相关系数：&quot;</span>, <span class="fu">round</span>(pearson_dc, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb548-7"><a href="相关性与相似性.html#cb548-7" tabindex="-1"></a>    <span class="st">&quot;Spearman相关系数：&quot;</span>, <span class="fu">round</span>(spearman_dc, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb548-8"><a href="相关性与相似性.html#cb548-8" tabindex="-1"></a>    <span class="st">&quot;距离相关系数：&quot;</span>, <span class="fu">round</span>(dcor_result, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb548-9"><a href="相关性与相似性.html#cb548-9" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 不同相关性方法的比较：
## Pearson相关系数：0.133
## Spearman相关系数：0.04
## 距离相关系数：0.454</code></pre>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="相关性与相似性.html#cb550-1" tabindex="-1"></a><span class="co"># 可视化非线性关系</span></span>
<span id="cb550-2"><a href="相关性与相似性.html#cb550-2" tabindex="-1"></a><span class="fu">plot</span>(leaf_area, specific_leaf_area,</span>
<span id="cb550-3"><a href="相关性与相似性.html#cb550-3" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb550-4"><a href="相关性与相似性.html#cb550-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;叶面积 (cm²)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;比叶重 (g/m²)&quot;</span>,</span>
<span id="cb550-5"><a href="相关性与相似性.html#cb550-5" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;植物功能性状间的非线性关系&quot;</span></span>
<span id="cb550-6"><a href="相关性与相似性.html#cb550-6" tabindex="-1"></a>)</span>
<span id="cb550-7"><a href="相关性与相似性.html#cb550-7" tabindex="-1"></a></span>
<span id="cb550-8"><a href="相关性与相似性.html#cb550-8" tabindex="-1"></a><span class="co"># 添加局部回归曲线</span></span>
<span id="cb550-9"><a href="相关性与相似性.html#cb550-9" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(leaf_area, specific_leaf_area), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb550-10"><a href="相关性与相似性.html#cb550-10" tabindex="-1"></a></span>
<span id="cb550-11"><a href="相关性与相似性.html#cb550-11" tabindex="-1"></a><span class="co"># 添加二次拟合曲线</span></span>
<span id="cb550-12"><a href="相关性与相似性.html#cb550-12" tabindex="-1"></a>quad_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(specific_leaf_area <span class="sc">~</span> <span class="fu">poly</span>(leaf_area, <span class="dv">2</span>))</span>
<span id="cb550-13"><a href="相关性与相似性.html#cb550-13" tabindex="-1"></a>leaf_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(leaf_area), <span class="fu">max</span>(leaf_area), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb550-14"><a href="相关性与相似性.html#cb550-14" tabindex="-1"></a>pred_quad <span class="ot">&lt;-</span> <span class="fu">predict</span>(quad_fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">leaf_area =</span> leaf_seq))</span>
<span id="cb550-15"><a href="相关性与相似性.html#cb550-15" tabindex="-1"></a><span class="fu">lines</span>(leaf_seq, pred_quad, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb550-16"><a href="相关性与相似性.html#cb550-16" tabindex="-1"></a></span>
<span id="cb550-17"><a href="相关性与相似性.html#cb550-17" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;top&quot;</span>,</span>
<span id="cb550-18"><a href="相关性与相似性.html#cb550-18" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;观测数据&quot;</span>, <span class="st">&quot;局部回归&quot;</span>, <span class="st">&quot;二次拟合&quot;</span>),</span>
<span id="cb550-19"><a href="相关性与相似性.html#cb550-19" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb550-20"><a href="相关性与相似性.html#cb550-20" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>, <span class="cn">NA</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb550-21"><a href="相关性与相似性.html#cb550-21" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-12"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-12-1.png" alt="植物功能性状间的非线性关系散点图，显示U型关系" width="672" />
<p class="caption">
图3.1: 植物功能性状间的非线性关系散点图，显示U型关系
</p>
</div>
<p><strong>生态学意义</strong>：距离相关特别适用于生态学中常见的复杂非线性关系，如物种-面积关系、功能性状权衡、种群动态模型等。</p>
</div>
<div id="互信息" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> 互信息<a href="相关性与相似性.html#互信息" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在研究环境因子对物种分布的联合影响时，我们想要量化多个环境变量共同包含的关于物种分布的信息量。</p>
<p>互信息是基于信息论的依赖关系度量，它量化了两个变量间共享的信息量。与传统的相关性不同，互信息能够捕捉任何类型的统计依赖关系。互信息的概念源于信息论，由克劳德·香农在1948年提出，最初用于通信系统中的信息传输研究，后来被广泛应用于统计分析和机器学习领域。互信息的核心思想是衡量知道一个变量的值能够减少另一个变量不确定性的程度。从信息论的角度来看，如果两个变量完全独立，那么知道其中一个变量的值不会提供关于另一个变量的任何信息，此时互信息为零；如果两个变量存在完全确定的函数关系，那么知道一个变量的值就能完全确定另一个变量，此时互信息达到最大值。</p>
<p>互信息的一个重要特性是它对变量间关系的类型没有限制，能够检测线性和非线性关系、单调和非单调关系，甚至是复杂的多模态关系。这种普适性使得互信息在生态学研究中具有独特的优势，因为许多生态关系本质上是非线性和复杂的。例如，在研究环境因子对物种分布的影响时，物种对环境梯度的响应往往不是简单的线性关系，而是存在阈值效应、饱和效应或最优区间等复杂模式。互信息能够有效捕捉这些复杂的依赖关系，而传统的线性相关方法可能会遗漏重要的生态信息。</p>
<p>另一个重要特点是互信息对变量的分布形式没有严格要求，适用于连续变量、离散变量甚至混合类型的数据。在生态学中，我们经常需要处理不同类型的数据，如连续的环境变量（温度、降水）、离散的分类变量（生境类型、土壤类型）和二元变量（物种出现/缺失）。互信息提供了一个统一的框架来处理这些不同类型变量间的依赖关系。此外，互信息具有对称性，即<span class="math inline">\(I(X;Y) = I(Y;X)\)</span>，这反映了变量间信息共享的相互性。互信息的取值范围从0到正无穷，其中0表示变量间完全独立，正值表示存在信息共享。为了便于解释，有时会将互信息标准化到[0,1]区间，如通过除以变量的熵来得到标准化互信息。在生态学应用中，互信息特别适合用于特征选择、生态网络构建、物种分布建模等需要处理复杂非线性关系的场景。</p>
<p><strong>数学定义</strong>：对于两个离散随机变量<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>，互信息定义为：</p>
<p><span class="math display">\[I(X;Y) = \sum_{x\in X}\sum_{y\in Y} p(x,y) \log\left(\frac{p(x,y)}{p(x)p(y)}\right)\]</span></p>
<p>对于连续变量，需要使用积分形式。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="相关性与相似性.html#cb551-1" tabindex="-1"></a><span class="co"># 互信息示例：环境因子与物种分布的依赖关系</span></span>
<span id="cb551-2"><a href="相关性与相似性.html#cb551-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb551-3"><a href="相关性与相似性.html#cb551-3" tabindex="-1"></a></span>
<span id="cb551-4"><a href="相关性与相似性.html#cb551-4" tabindex="-1"></a><span class="co"># 模拟环境数据和物种出现数据</span></span>
<span id="cb551-5"><a href="相关性与相似性.html#cb551-5" tabindex="-1"></a>n_sites <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb551-6"><a href="相关性与相似性.html#cb551-6" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_sites, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>) <span class="co"># 温度</span></span>
<span id="cb551-7"><a href="相关性与相似性.html#cb551-7" tabindex="-1"></a>precipitation <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_sites, <span class="at">mean =</span> <span class="dv">800</span>, <span class="at">sd =</span> <span class="dv">200</span>) <span class="co"># 降水量</span></span>
<span id="cb551-8"><a href="相关性与相似性.html#cb551-8" tabindex="-1"></a></span>
<span id="cb551-9"><a href="相关性与相似性.html#cb551-9" tabindex="-1"></a><span class="co"># 物种出现概率与环境因子的复杂关系</span></span>
<span id="cb551-10"><a href="相关性与相似性.html#cb551-10" tabindex="-1"></a>species_prob <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="fl">0.1</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fl">0.002</span> <span class="sc">*</span> precipitation <span class="sc">-</span></span>
<span id="cb551-11"><a href="相关性与相似性.html#cb551-11" tabindex="-1"></a>  <span class="fl">0.0001</span> <span class="sc">*</span> temperature <span class="sc">*</span> precipitation <span class="sc">-</span> <span class="dv">15</span>)</span>
<span id="cb551-12"><a href="相关性与相似性.html#cb551-12" tabindex="-1"></a>species_presence <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_sites, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> species_prob)</span>
<span id="cb551-13"><a href="相关性与相似性.html#cb551-13" tabindex="-1"></a></span>
<span id="cb551-14"><a href="相关性与相似性.html#cb551-14" tabindex="-1"></a><span class="co"># 计算互信息</span></span>
<span id="cb551-15"><a href="相关性与相似性.html#cb551-15" tabindex="-1"></a><span class="fu">library</span>(infotheo) <span class="co"># 需要安装：install.packages(&quot;infotheo&quot;)</span></span>
<span id="cb551-16"><a href="相关性与相似性.html#cb551-16" tabindex="-1"></a></span>
<span id="cb551-17"><a href="相关性与相似性.html#cb551-17" tabindex="-1"></a><span class="co"># 离散化连续变量（互信息计算需要离散数据）</span></span>
<span id="cb551-18"><a href="相关性与相似性.html#cb551-18" tabindex="-1"></a>temp_disc <span class="ot">&lt;-</span> <span class="fu">discretize</span>(temperature, <span class="at">disc =</span> <span class="st">&quot;equalfreq&quot;</span>, <span class="at">nbins =</span> <span class="dv">5</span>)</span>
<span id="cb551-19"><a href="相关性与相似性.html#cb551-19" tabindex="-1"></a>precip_disc <span class="ot">&lt;-</span> <span class="fu">discretize</span>(precipitation, <span class="at">disc =</span> <span class="st">&quot;equalfreq&quot;</span>, <span class="at">nbins =</span> <span class="dv">5</span>)</span>
<span id="cb551-20"><a href="相关性与相似性.html#cb551-20" tabindex="-1"></a></span>
<span id="cb551-21"><a href="相关性与相似性.html#cb551-21" tabindex="-1"></a><span class="co"># 计算互信息</span></span>
<span id="cb551-22"><a href="相关性与相似性.html#cb551-22" tabindex="-1"></a>mi_temp <span class="ot">&lt;-</span> <span class="fu">mutinformation</span>(temp_disc, species_presence)</span>
<span id="cb551-23"><a href="相关性与相似性.html#cb551-23" tabindex="-1"></a>mi_precip <span class="ot">&lt;-</span> <span class="fu">mutinformation</span>(precip_disc, species_presence)</span>
<span id="cb551-24"><a href="相关性与相似性.html#cb551-24" tabindex="-1"></a>mi_joint <span class="ot">&lt;-</span> <span class="fu">mutinformation</span>(<span class="fu">cbind</span>(temp_disc, precip_disc), species_presence)</span>
<span id="cb551-25"><a href="相关性与相似性.html#cb551-25" tabindex="-1"></a></span>
<span id="cb551-26"><a href="相关性与相似性.html#cb551-26" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;互信息分析结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb551-27"><a href="相关性与相似性.html#cb551-27" tabindex="-1"></a>    <span class="st">&quot;温度与物种出现的互信息：&quot;</span>, <span class="fu">round</span>(mi_temp, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb551-28"><a href="相关性与相似性.html#cb551-28" tabindex="-1"></a>    <span class="st">&quot;降水量与物种出现的互信息：&quot;</span>, <span class="fu">round</span>(mi_precip, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb551-29"><a href="相关性与相似性.html#cb551-29" tabindex="-1"></a>    <span class="st">&quot;温度与降水量联合与物种出现的互信息：&quot;</span>, <span class="fu">round</span>(mi_joint, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb551-30"><a href="相关性与相似性.html#cb551-30" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 互信息分析结果：
## 温度与物种出现的互信息：0
## 降水量与物种出现的互信息：0
## 温度与降水量联合与物种出现的互信息：0</code></pre>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="相关性与相似性.html#cb553-1" tabindex="-1"></a><span class="co"># 可视化物种出现与环境因子的关系</span></span>
<span id="cb553-2"><a href="相关性与相似性.html#cb553-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb553-3"><a href="相关性与相似性.html#cb553-3" tabindex="-1"></a></span>
<span id="cb553-4"><a href="相关性与相似性.html#cb553-4" tabindex="-1"></a><span class="co"># 温度与物种出现</span></span>
<span id="cb553-5"><a href="相关性与相似性.html#cb553-5" tabindex="-1"></a><span class="fu">plot</span>(temperature, species_presence,</span>
<span id="cb553-6"><a href="相关性与相似性.html#cb553-6" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;blue&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.6</span>),</span>
<span id="cb553-7"><a href="相关性与相似性.html#cb553-7" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;温度 (°C)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;物种出现 (0/1)&quot;</span>,</span>
<span id="cb553-8"><a href="相关性与相似性.html#cb553-8" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;温度与物种出现的关系&quot;</span></span>
<span id="cb553-9"><a href="相关性与相似性.html#cb553-9" tabindex="-1"></a>)</span>
<span id="cb553-10"><a href="相关性与相似性.html#cb553-10" tabindex="-1"></a><span class="co"># 添加逻辑回归曲线</span></span>
<span id="cb553-11"><a href="相关性与相似性.html#cb553-11" tabindex="-1"></a>temp_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(temperature), <span class="fu">max</span>(temperature), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb553-12"><a href="相关性与相似性.html#cb553-12" tabindex="-1"></a>logit_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(species_presence <span class="sc">~</span> temperature, <span class="at">family =</span> binomial)</span>
<span id="cb553-13"><a href="相关性与相似性.html#cb553-13" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_fit,</span>
<span id="cb553-14"><a href="相关性与相似性.html#cb553-14" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">temperature =</span> temp_seq),</span>
<span id="cb553-15"><a href="相关性与相似性.html#cb553-15" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb553-16"><a href="相关性与相似性.html#cb553-16" tabindex="-1"></a>)</span>
<span id="cb553-17"><a href="相关性与相似性.html#cb553-17" tabindex="-1"></a><span class="fu">lines</span>(temp_seq, pred_prob, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb553-18"><a href="相关性与相似性.html#cb553-18" tabindex="-1"></a></span>
<span id="cb553-19"><a href="相关性与相似性.html#cb553-19" tabindex="-1"></a><span class="co"># 降水量与物种出现</span></span>
<span id="cb553-20"><a href="相关性与相似性.html#cb553-20" tabindex="-1"></a><span class="fu">plot</span>(precipitation, species_presence,</span>
<span id="cb553-21"><a href="相关性与相似性.html#cb553-21" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;green&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.6</span>),</span>
<span id="cb553-22"><a href="相关性与相似性.html#cb553-22" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;降水量 (mm)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;物种出现 (0/1)&quot;</span>,</span>
<span id="cb553-23"><a href="相关性与相似性.html#cb553-23" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;降水量与物种出现的关系&quot;</span></span>
<span id="cb553-24"><a href="相关性与相似性.html#cb553-24" tabindex="-1"></a>)</span>
<span id="cb553-25"><a href="相关性与相似性.html#cb553-25" tabindex="-1"></a><span class="co"># 添加逻辑回归曲线</span></span>
<span id="cb553-26"><a href="相关性与相似性.html#cb553-26" tabindex="-1"></a>precip_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(precipitation), <span class="fu">max</span>(precipitation), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb553-27"><a href="相关性与相似性.html#cb553-27" tabindex="-1"></a>logit_fit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(species_presence <span class="sc">~</span> precipitation, <span class="at">family =</span> binomial)</span>
<span id="cb553-28"><a href="相关性与相似性.html#cb553-28" tabindex="-1"></a>pred_prob2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_fit2,</span>
<span id="cb553-29"><a href="相关性与相似性.html#cb553-29" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">precipitation =</span> precip_seq),</span>
<span id="cb553-30"><a href="相关性与相似性.html#cb553-30" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb553-31"><a href="相关性与相似性.html#cb553-31" tabindex="-1"></a>)</span>
<span id="cb553-32"><a href="相关性与相似性.html#cb553-32" tabindex="-1"></a><span class="fu">lines</span>(precip_seq, pred_prob2, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-13"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-13-1.png" alt="环境因子与物种分布的关系逻辑回归曲线" width="672" />
<p class="caption">
图4.2: 环境因子与物种分布的关系逻辑回归曲线
</p>
</div>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="相关性与相似性.html#cb554-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><strong>生态学意义</strong>：互信息在生态学中广泛应用于特征选择、生态网络构建、物种分布建模等领域，特别适合处理复杂的非线性关系和分类数据。</p>
</div>
<div id="非线性关系度量" class="section level3 hasAnchor" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> 非线性关系度量<a href="相关性与相似性.html#非线性关系度量" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>生态系统中许多关系都是非线性的，如物种-面积关系、剂量-响应关系、种群增长模型等。传统的线性相关方法往往无法充分描述这些复杂模式。</p>
<p>非线性关系度量包括前面介绍的距离相关、互信息等方法，它们不依赖于线性假设，能够捕捉各种复杂的关系模式。在生态学研究中，非线性关系比线性关系更为普遍，因为生态系统中的许多过程都涉及阈值效应、饱和效应、最优区间和反馈机制等非线性动态。例如，物种-面积关系通常呈现幂律形式，种群增长遵循逻辑斯蒂曲线，功能性状间的权衡关系可能呈现U型或S型模式，物种对环境梯度的响应往往存在最优区间。这些复杂的非线性模式无法用传统的线性相关方法来充分描述，因此需要专门的非线性关系度量方法。</p>
<p>距离相关和互信息是两种主要的非线性关系度量方法，它们各有特点和适用场景。距离相关基于变量在距离空间中的协方差来度量依赖关系，能够检测任何形式的统计依赖，包括线性和非线性关系。它的一个重要性质是当且仅当两个变量相互独立时，距离相关系数等于零，这使其成为检验变量独立性的有力工具。距离相关对变量的分布形式没有要求，适用于连续变量和混合类型的数据，但在计算复杂度上相对较高，特别是对于大样本数据。</p>
<p>互信息则基于信息论的概念，量化两个变量间共享的信息量。它能够检测任何类型的统计依赖关系，包括线性和非线性关系、单调和非单调关系。互信息的一个重要优势是它对变量的数据类型没有限制，可以处理连续变量、离散变量和分类变量，这使其特别适合生态学中常见的混合数据类型分析。此外，互信息具有清晰的信息论解释，能够提供关于变量间信息共享程度的直观理解。</p>
<p>除了距离相关和互信息，还有其他非线性关系度量方法，如基于核的方法、基于图的方法和基于模型的方法。基于核的方法通过将数据映射到高维特征空间来检测非线性关系，基于图的方法通过构建变量间的图结构来识别依赖关系，基于模型的方法则通过拟合非线性模型来量化关系强度。在生态学实践中，选择哪种非线性关系度量方法需要考虑数据的特征、研究的目的和计算资源的限制。通常建议使用多种方法进行比较，以获得对生态关系更全面和稳健的认识。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="相关性与相似性.html#cb555-1" tabindex="-1"></a><span class="co"># 非线性关系度量综合示例</span></span>
<span id="cb555-2"><a href="相关性与相似性.html#cb555-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb555-3"><a href="相关性与相似性.html#cb555-3" tabindex="-1"></a></span>
<span id="cb555-4"><a href="相关性与相似性.html#cb555-4" tabindex="-1"></a><span class="co"># 模拟不同类型的非线性关系</span></span>
<span id="cb555-5"><a href="相关性与相似性.html#cb555-5" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb555-6"><a href="相关性与相似性.html#cb555-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> n_obs)</span>
<span id="cb555-7"><a href="相关性与相似性.html#cb555-7" tabindex="-1"></a></span>
<span id="cb555-8"><a href="相关性与相似性.html#cb555-8" tabindex="-1"></a><span class="co"># 1. 二次关系（U型）</span></span>
<span id="cb555-9"><a href="相关性与相似性.html#cb555-9" tabindex="-1"></a>y_quadratic <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">-</span> <span class="fl">0.1</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n_obs, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb555-10"><a href="相关性与相似性.html#cb555-10" tabindex="-1"></a></span>
<span id="cb555-11"><a href="相关性与相似性.html#cb555-11" tabindex="-1"></a><span class="co"># 2. 指数关系</span></span>
<span id="cb555-12"><a href="相关性与相似性.html#cb555-12" tabindex="-1"></a>y_exponential <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fl">0.3</span> <span class="sc">*</span> x) <span class="sc">+</span> <span class="fu">rnorm</span>(n_obs, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb555-13"><a href="相关性与相似性.html#cb555-13" tabindex="-1"></a></span>
<span id="cb555-14"><a href="相关性与相似性.html#cb555-14" tabindex="-1"></a><span class="co"># 3. 周期性关系</span></span>
<span id="cb555-15"><a href="相关性与相似性.html#cb555-15" tabindex="-1"></a>y_periodic <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="fl">0.8</span> <span class="sc">*</span> x) <span class="sc">+</span> <span class="fu">rnorm</span>(n_obs, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb555-16"><a href="相关性与相似性.html#cb555-16" tabindex="-1"></a></span>
<span id="cb555-17"><a href="相关性与相似性.html#cb555-17" tabindex="-1"></a><span class="co"># 计算不同相关性度量</span></span>
<span id="cb555-18"><a href="相关性与相似性.html#cb555-18" tabindex="-1"></a>cor_methods <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb555-19"><a href="相关性与相似性.html#cb555-19" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb555-20"><a href="相关性与相似性.html#cb555-20" tabindex="-1"></a>  results<span class="sc">$</span>pearson <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb555-21"><a href="相关性与相似性.html#cb555-21" tabindex="-1"></a>  results<span class="sc">$</span>spearman <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb555-22"><a href="相关性与相似性.html#cb555-22" tabindex="-1"></a>  results<span class="sc">$</span>kendall <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb555-23"><a href="相关性与相似性.html#cb555-23" tabindex="-1"></a></span>
<span id="cb555-24"><a href="相关性与相似性.html#cb555-24" tabindex="-1"></a>  <span class="co"># 距离相关</span></span>
<span id="cb555-25"><a href="相关性与相似性.html#cb555-25" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">require</span>(energy)) {</span>
<span id="cb555-26"><a href="相关性与相似性.html#cb555-26" tabindex="-1"></a>    results<span class="sc">$</span>dcor <span class="ot">&lt;-</span> <span class="fu">dcor</span>(x, y)</span>
<span id="cb555-27"><a href="相关性与相似性.html#cb555-27" tabindex="-1"></a>  }</span>
<span id="cb555-28"><a href="相关性与相似性.html#cb555-28" tabindex="-1"></a></span>
<span id="cb555-29"><a href="相关性与相似性.html#cb555-29" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb555-30"><a href="相关性与相似性.html#cb555-30" tabindex="-1"></a>}</span>
<span id="cb555-31"><a href="相关性与相似性.html#cb555-31" tabindex="-1"></a></span>
<span id="cb555-32"><a href="相关性与相似性.html#cb555-32" tabindex="-1"></a><span class="co"># 分析三种非线性关系</span></span>
<span id="cb555-33"><a href="相关性与相似性.html#cb555-33" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;二次关系的相关性分析：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 二次关系的相关性分析：</code></pre>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="相关性与相似性.html#cb557-1" tabindex="-1"></a>quad_cor <span class="ot">&lt;-</span> <span class="fu">cor_methods</span>(x, y_quadratic)</span>
<span id="cb557-2"><a href="相关性与相似性.html#cb557-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">lapply</span>(quad_cor, round, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## $pearson
## [1] -0.86
## 
## $spearman
## [1] -0.842
## 
## $kendall
## [1] -0.681
## 
## $dcor
## [1] 0.888</code></pre>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="相关性与相似性.html#cb559-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">指数关系的相关性分析：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 指数关系的相关性分析：</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="相关性与相似性.html#cb561-1" tabindex="-1"></a>exp_cor <span class="ot">&lt;-</span> <span class="fu">cor_methods</span>(x, y_exponential)</span>
<span id="cb561-2"><a href="相关性与相似性.html#cb561-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">lapply</span>(exp_cor, round, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## $pearson
## [1] 0.899
## 
## $spearman
## [1] 0.904
## 
## $kendall
## [1] 0.738
## 
## $dcor
## [1] 0.902</code></pre>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="相关性与相似性.html#cb563-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">周期性关系的相关性分析：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 周期性关系的相关性分析：</code></pre>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="相关性与相似性.html#cb565-1" tabindex="-1"></a>period_cor <span class="ot">&lt;-</span> <span class="fu">cor_methods</span>(x, y_periodic)</span>
<span id="cb565-2"><a href="相关性与相似性.html#cb565-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">lapply</span>(period_cor, round, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## $pearson
## [1] -0.125
## 
## $spearman
## [1] -0.114
## 
## $kendall
## [1] -0.076
## 
## $dcor
## [1] 0.479</code></pre>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="相关性与相似性.html#cb567-1" tabindex="-1"></a><span class="co"># 可视化不同类型的非线性关系</span></span>
<span id="cb567-2"><a href="相关性与相似性.html#cb567-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb567-3"><a href="相关性与相似性.html#cb567-3" tabindex="-1"></a></span>
<span id="cb567-4"><a href="相关性与相似性.html#cb567-4" tabindex="-1"></a><span class="co"># 二次关系</span></span>
<span id="cb567-5"><a href="相关性与相似性.html#cb567-5" tabindex="-1"></a><span class="fu">plot</span>(x, y_quadratic,</span>
<span id="cb567-6"><a href="相关性与相似性.html#cb567-6" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb567-7"><a href="相关性与相似性.html#cb567-7" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;二次关系 (U型)&quot;</span>,</span>
<span id="cb567-8"><a href="相关性与相似性.html#cb567-8" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb567-9"><a href="相关性与相似性.html#cb567-9" tabindex="-1"></a>)</span>
<span id="cb567-10"><a href="相关性与相似性.html#cb567-10" tabindex="-1"></a>quad_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_quadratic <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>))</span>
<span id="cb567-11"><a href="相关性与相似性.html#cb567-11" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">predict</span>(quad_fit), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb567-12"><a href="相关性与相似性.html#cb567-12" tabindex="-1"></a></span>
<span id="cb567-13"><a href="相关性与相似性.html#cb567-13" tabindex="-1"></a><span class="co"># 指数关系</span></span>
<span id="cb567-14"><a href="相关性与相似性.html#cb567-14" tabindex="-1"></a><span class="fu">plot</span>(x, y_exponential,</span>
<span id="cb567-15"><a href="相关性与相似性.html#cb567-15" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>,</span>
<span id="cb567-16"><a href="相关性与相似性.html#cb567-16" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;指数关系&quot;</span>,</span>
<span id="cb567-17"><a href="相关性与相似性.html#cb567-17" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb567-18"><a href="相关性与相似性.html#cb567-18" tabindex="-1"></a>)</span>
<span id="cb567-19"><a href="相关性与相似性.html#cb567-19" tabindex="-1"></a>exp_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y_exponential) <span class="sc">~</span> x)</span>
<span id="cb567-20"><a href="相关性与相似性.html#cb567-20" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">exp</span>(<span class="fu">predict</span>(exp_fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x))), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb567-21"><a href="相关性与相似性.html#cb567-21" tabindex="-1"></a></span>
<span id="cb567-22"><a href="相关性与相似性.html#cb567-22" tabindex="-1"></a><span class="co"># 周期性关系</span></span>
<span id="cb567-23"><a href="相关性与相似性.html#cb567-23" tabindex="-1"></a><span class="fu">plot</span>(x, y_periodic,</span>
<span id="cb567-24"><a href="相关性与相似性.html#cb567-24" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>,</span>
<span id="cb567-25"><a href="相关性与相似性.html#cb567-25" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;周期性关系&quot;</span>,</span>
<span id="cb567-26"><a href="相关性与相似性.html#cb567-26" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb567-27"><a href="相关性与相似性.html#cb567-27" tabindex="-1"></a>)</span>
<span id="cb567-28"><a href="相关性与相似性.html#cb567-28" tabindex="-1"></a>period_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_periodic <span class="sc">~</span> <span class="fu">sin</span>(<span class="fl">0.8</span> <span class="sc">*</span> x) <span class="sc">+</span> <span class="fu">cos</span>(<span class="fl">0.8</span> <span class="sc">*</span> x))</span>
<span id="cb567-29"><a href="相关性与相似性.html#cb567-29" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">predict</span>(period_fit), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb567-30"><a href="相关性与相似性.html#cb567-30" tabindex="-1"></a></span>
<span id="cb567-31"><a href="相关性与相似性.html#cb567-31" tabindex="-1"></a><span class="co"># 方法比较图</span></span>
<span id="cb567-32"><a href="相关性与相似性.html#cb567-32" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Pearson&quot;</span>, <span class="st">&quot;Spearman&quot;</span>, <span class="st">&quot;Kendall&quot;</span>, <span class="st">&quot;Distance&quot;</span>)</span>
<span id="cb567-33"><a href="相关性与相似性.html#cb567-33" tabindex="-1"></a>quad_values <span class="ot">&lt;-</span> <span class="fu">c</span>(quad_cor<span class="sc">$</span>pearson, quad_cor<span class="sc">$</span>spearman, quad_cor<span class="sc">$</span>kendall, quad_cor<span class="sc">$</span>dcor)</span>
<span id="cb567-34"><a href="相关性与相似性.html#cb567-34" tabindex="-1"></a></span>
<span id="cb567-35"><a href="相关性与相似性.html#cb567-35" tabindex="-1"></a><span class="fu">barplot</span>(quad_values,</span>
<span id="cb567-36"><a href="相关性与相似性.html#cb567-36" tabindex="-1"></a>  <span class="at">names.arg =</span> methods, <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">4</span>),</span>
<span id="cb567-37"><a href="相关性与相似性.html#cb567-37" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;不同方法在二次关系中的表现&quot;</span>,</span>
<span id="cb567-38"><a href="相关性与相似性.html#cb567-38" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;相关系数&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb567-39"><a href="相关性与相似性.html#cb567-39" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-14-1.png" alt="不同类型非线性关系的可视化及方法比较" width="672" />
<p class="caption">
图4.3: 不同类型非线性关系的可视化及方法比较
</p>
</div>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="相关性与相似性.html#cb568-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><strong>生态学意义</strong>：非线性关系度量方法为生态学家提供了更全面的工具来探索复杂的生态关系。在真实的生态系统中，线性关系往往是特例而非普遍规律，掌握这些非线性分析方法对于准确理解生态过程至关重要。</p>
</div>
</div>
<div id="自相关" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> 自相关<a href="相关性与相似性.html#自相关" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在生态学研究中，许多数据具有时间或空间依赖性，即相邻的观测值之间往往存在某种关联。这种关联性被称为自相关，它反映了生态过程在时间或空间上的连续性。理解自相关对于正确分析生态数据至关重要，因为忽略自相关可能导致统计推断的错误。</p>
<div id="时间自相关" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> 时间自相关<a href="相关性与相似性.html#时间自相关" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>时间自相关是指同一变量在不同时间点上的观测值之间的相关性。在生态学中，许多过程都具有时间连续性，如种群动态、气候变化、物候变化等。时间自相关分析帮助我们理解这些过程的动态特征和内在规律。</p>
<div id="自相关函数acf时间依赖性的量化" class="section level4 hasAnchor" number="5.3.1.1">
<h4><span class="header-section-number">5.3.1.1</span> 自相关函数（ACF）：时间依赖性的量化<a href="相关性与相似性.html#自相关函数acf时间依赖性的量化" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>假设我们正在研究一个湖泊中浮游植物生物量的季节变化，我们记录了连续36个月的观测数据，想要了解生物量在不同时间滞后下的自相关性模式。</p>
<p>自相关函数是时间序列分析中最基础的工具之一，用于量化时间序列在不同时间滞后下的自相关性强度。ACF的核心思想是计算时间序列与其自身在不同时间滞后下的相关系数，从而揭示时间序列中的周期性、趋势和记忆效应。对于时间滞后<span class="math inline">\(k\)</span>，自相关系数<span class="math inline">\(\rho_k\)</span>定义为时间序列<span class="math inline">\(X_t\)</span>与<span class="math inline">\(X_{t+k}\)</span>之间的相关系数。ACF的取值范围在-1到1之间，正值表示正自相关（即高值倾向于跟随高值，低值倾向于跟随低值），负值表示负自相关（即高值倾向于跟随低值，低值倾向于跟随高值），0值表示没有自相关。</p>
<p>在生态学研究中，ACF具有重要的应用价值。例如，在分析种群动态时，显著的正自相关可能表明种群具有惯性效应或密度依赖性调节；显著的负自相关可能表明存在过度补偿机制；周期性模式可能反映季节性波动或多年周期。ACF还能帮助识别时间序列中的趋势成分——如果ACF缓慢衰减，表明存在趋势；如果ACF快速衰减到零，表明序列是平稳的。此外，ACF在构建时间序列模型（如ARIMA模型）时也起着关键作用，它为选择合适的模型阶数提供了重要依据。</p>
<p><strong>数学定义</strong>：对于时间序列<span class="math inline">\(\{X_t\}\)</span>，滞后<span class="math inline">\(k\)</span>的自相关系数定义为：</p>
<p><span class="math display">\[\rho_k = \frac{\sum_{t=k+1}^{n}(X_t - \bar{X})(X_{t-k} - \bar{X})}{\sum_{t=1}^{n}(X_t - \bar{X})^2}\]</span></p>
<p>其中<span class="math inline">\(n\)</span>是时间序列长度，<span class="math inline">\(\bar{X}\)</span>是序列的样本均值。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="相关性与相似性.html#cb569-1" tabindex="-1"></a><span class="co"># 自相关函数示例：湖泊浮游植物生物量的季节变化</span></span>
<span id="cb569-2"><a href="相关性与相似性.html#cb569-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb569-3"><a href="相关性与相似性.html#cb569-3" tabindex="-1"></a></span>
<span id="cb569-4"><a href="相关性与相似性.html#cb569-4" tabindex="-1"></a><span class="co"># 模拟湖泊浮游植物生物量数据（36个月）</span></span>
<span id="cb569-5"><a href="相关性与相似性.html#cb569-5" tabindex="-1"></a>n_months <span class="ot">&lt;-</span> <span class="dv">36</span></span>
<span id="cb569-6"><a href="相关性与相似性.html#cb569-6" tabindex="-1"></a>months <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n_months</span>
<span id="cb569-7"><a href="相关性与相似性.html#cb569-7" tabindex="-1"></a></span>
<span id="cb569-8"><a href="相关性与相似性.html#cb569-8" tabindex="-1"></a><span class="co"># 模拟具有季节性和趋势的生物量数据</span></span>
<span id="cb569-9"><a href="相关性与相似性.html#cb569-9" tabindex="-1"></a>base_trend <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> months <span class="co"># 基础趋势</span></span>
<span id="cb569-10"><a href="相关性与相似性.html#cb569-10" tabindex="-1"></a>seasonal <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> months <span class="sc">/</span> <span class="dv">12</span>) <span class="co"># 季节性成分</span></span>
<span id="cb569-11"><a href="相关性与相似性.html#cb569-11" tabindex="-1"></a>noise <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_months, <span class="dv">0</span>, <span class="dv">5</span>) <span class="co"># 随机噪声</span></span>
<span id="cb569-12"><a href="相关性与相似性.html#cb569-12" tabindex="-1"></a>phytoplankton_biomass <span class="ot">&lt;-</span> base_trend <span class="sc">+</span> seasonal <span class="sc">+</span> noise</span>
<span id="cb569-13"><a href="相关性与相似性.html#cb569-13" tabindex="-1"></a></span>
<span id="cb569-14"><a href="相关性与相似性.html#cb569-14" tabindex="-1"></a><span class="co"># 计算自相关函数</span></span>
<span id="cb569-15"><a href="相关性与相似性.html#cb569-15" tabindex="-1"></a>acf_result <span class="ot">&lt;-</span> <span class="fu">acf</span>(phytoplankton_biomass, <span class="at">lag.max =</span> <span class="dv">20</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb569-16"><a href="相关性与相似性.html#cb569-16" tabindex="-1"></a></span>
<span id="cb569-17"><a href="相关性与相似性.html#cb569-17" tabindex="-1"></a><span class="co"># 可视化自相关函数</span></span>
<span id="cb569-18"><a href="相关性与相似性.html#cb569-18" tabindex="-1"></a><span class="fu">plot</span>(acf_result,</span>
<span id="cb569-19"><a href="相关性与相似性.html#cb569-19" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;浮游植物生物量的自相关函数&quot;</span>,</span>
<span id="cb569-20"><a href="相关性与相似性.html#cb569-20" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;滞后（月）&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;自相关系数&quot;</span></span>
<span id="cb569-21"><a href="相关性与相似性.html#cb569-21" tabindex="-1"></a>)</span>
<span id="cb569-22"><a href="相关性与相似性.html#cb569-22" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-15-1"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-15-1.png" alt="浮游植物生物量的自相关函数和时间序列图" width="672" />
<p class="caption">
图5.3: 浮游植物生物量的自相关函数和时间序列图
</p>
</div>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="相关性与相似性.html#cb570-1" tabindex="-1"></a><span class="co"># 提取关键的自相关系数</span></span>
<span id="cb570-2"><a href="相关性与相似性.html#cb570-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;关键滞后下的自相关系数：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb570-3"><a href="相关性与相似性.html#cb570-3" tabindex="-1"></a>    <span class="st">&quot;滞后1个月：&quot;</span>, <span class="fu">round</span>(acf_result<span class="sc">$</span>acf[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb570-4"><a href="相关性与相似性.html#cb570-4" tabindex="-1"></a>    <span class="st">&quot;滞后12个月（年周期）：&quot;</span>, <span class="fu">round</span>(acf_result<span class="sc">$</span>acf[<span class="dv">13</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb570-5"><a href="相关性与相似性.html#cb570-5" tabindex="-1"></a>    <span class="st">&quot;滞后6个月（半年周期）：&quot;</span>, <span class="fu">round</span>(acf_result<span class="sc">$</span>acf[<span class="dv">7</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb570-6"><a href="相关性与相似性.html#cb570-6" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 关键滞后下的自相关系数：
## 滞后1个月：0.772
## 滞后12个月（年周期）：0.528
## 滞后6个月（半年周期）：-0.724</code></pre>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="相关性与相似性.html#cb572-1" tabindex="-1"></a><span class="co"># 进行Ljung-Box检验（检验自相关的显著性）</span></span>
<span id="cb572-2"><a href="相关性与相似性.html#cb572-2" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb572-3"><a href="相关性与相似性.html#cb572-3" tabindex="-1"></a>lb_test <span class="ot">&lt;-</span> <span class="fu">Box.test</span>(phytoplankton_biomass, <span class="at">lag =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>)</span>
<span id="cb572-4"><a href="相关性与相似性.html#cb572-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Ljung-Box检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb572-5"><a href="相关性与相似性.html#cb572-5" tabindex="-1"></a>    <span class="st">&quot;检验统计量：&quot;</span>, <span class="fu">round</span>(lb_test<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb572-6"><a href="相关性与相似性.html#cb572-6" tabindex="-1"></a>    <span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(lb_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb572-7"><a href="相关性与相似性.html#cb572-7" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Ljung-Box检验结果：
## 检验统计量：108.11
## p值：&lt;2e-16</code></pre>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="相关性与相似性.html#cb574-1" tabindex="-1"></a><span class="co"># 可视化原始时间序列</span></span>
<span id="cb574-2"><a href="相关性与相似性.html#cb574-2" tabindex="-1"></a><span class="fu">plot</span>(months, phytoplankton_biomass,</span>
<span id="cb574-3"><a href="相关性与相似性.html#cb574-3" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb574-4"><a href="相关性与相似性.html#cb574-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;时间（月）&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;浮游植物生物量&quot;</span>,</span>
<span id="cb574-5"><a href="相关性与相似性.html#cb574-5" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;湖泊浮游植物生物量的时间序列&quot;</span></span>
<span id="cb574-6"><a href="相关性与相似性.html#cb574-6" tabindex="-1"></a>)</span>
<span id="cb574-7"><a href="相关性与相似性.html#cb574-7" tabindex="-1"></a><span class="fu">lines</span>(months, base_trend, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb574-8"><a href="相关性与相似性.html#cb574-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb574-9"><a href="相关性与相似性.html#cb574-9" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;观测值&quot;</span>, <span class="st">&quot;趋势线&quot;</span>),</span>
<span id="cb574-10"><a href="相关性与相似性.html#cb574-10" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb574-11"><a href="相关性与相似性.html#cb574-11" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-15-2"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-15-2.png" alt="浮游植物生物量的自相关函数和时间序列图" width="672" />
<p class="caption">
图5.4: 浮游植物生物量的自相关函数和时间序列图
</p>
</div>
<p><strong>生态学意义</strong>：自相关函数在生态学中广泛应用于检测种群波动的周期性、环境因子的记忆效应、生态过程的持续性等时间动态特征。</p>
</div>
<div id="偏自相关函数pacf直接时间依赖的识别" class="section level4 hasAnchor" number="5.3.1.2">
<h4><span class="header-section-number">5.3.1.2</span> 偏自相关函数（PACF）：直接时间依赖的识别<a href="相关性与相似性.html#偏自相关函数pacf直接时间依赖的识别" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>在研究森林年轮宽度的时间序列时，我们想要了解在控制了中间时间滞后的影响后，当前年轮宽度与过去年轮宽度的直接关系，这有助于确定合适的时间序列模型阶数。</p>
<p>偏自相关函数是时间序列分析中的另一个重要工具，它度量了在控制中间时间滞后影响后，时间序列与其自身在特定滞后下的直接相关性。与自相关函数不同，PACF排除了通过中间滞后传递的间接相关性，只保留直接的相关性。这种特性使得PACF在识别时间序列模型的自回归阶数时特别有用。对于滞后<span class="math inline">\(k\)</span>，偏自相关系数<span class="math inline">\(\phi_{kk}\)</span>可以理解为在回归模型<span class="math inline">\(X_t = \phi_1 X_{t-1} + \phi_2 X_{t-2} + \cdots + \phi_k X_{t-k} + \epsilon_t\)</span>中，系数<span class="math inline">\(\phi_k\)</span>的估计值。</p>
<p>PACF的计算通常基于Yule-Walker方程或通过逐步回归方法实现。在生态学时间序列分析中，PACF的主要作用是帮助确定自回归模型的合适阶数。如果PACF在滞后<span class="math inline">\(p\)</span>之后截尾（即之后的偏自相关系数不再显著），那么<span class="math inline">\(p\)</span>阶自回归模型可能是合适的。这种截尾模式为构建ARIMA模型提供了重要依据。例如，在分析气候时间序列时，PACF可以帮助识别气候系统的记忆长度；在分析种群动态时，PACF可以揭示密度依赖调节的时间尺度。</p>
<p>PACF与ACF的结合使用能够提供对时间序列结构的全面理解。ACF反映了总的相关性（包括直接和间接相关性），而PACF只反映直接相关性。这种区别在生态学应用中非常重要，因为它帮助我们区分生态过程中的直接因果联系和通过中间过程传递的间接联系。例如，在食物网动态中，捕食者与猎物的关系可能通过多个营养级传递，PACF可以帮助识别直接的相互作用关系。</p>
<p><strong>数学定义</strong>：偏自相关系数<span class="math inline">\(\phi_{kk}\)</span>可以通过求解Yule-Walker方程得到：</p>
<p><span class="math display">\[\begin{bmatrix}
\rho_0 &amp; \rho_1 &amp; \cdots &amp; \rho_{k-1} \\
\rho_1 &amp; \rho_0 &amp; \cdots &amp; \rho_{k-2} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\rho_{k-1} &amp; \rho_{k-2} &amp; \cdots &amp; \rho_0
\end{bmatrix}
\begin{bmatrix}
\phi_{k1} \\
\phi_{k2} \\
\vdots \\
\phi_{kk}
\end{bmatrix}
=
\begin{bmatrix}
\rho_1 \\
\rho_2 \\
\vdots \\
\rho_k
\end{bmatrix}\]</span></p>
<p>其中<span class="math inline">\(\phi_{kk}\)</span>就是滞后<span class="math inline">\(k\)</span>的偏自相关系数。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="相关性与相似性.html#cb575-1" tabindex="-1"></a><span class="co"># 偏自相关函数示例：森林年轮宽度的时间序列</span></span>
<span id="cb575-2"><a href="相关性与相似性.html#cb575-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb575-3"><a href="相关性与相似性.html#cb575-3" tabindex="-1"></a></span>
<span id="cb575-4"><a href="相关性与相似性.html#cb575-4" tabindex="-1"></a><span class="co"># 模拟森林年轮宽度数据（100年）</span></span>
<span id="cb575-5"><a href="相关性与相似性.html#cb575-5" tabindex="-1"></a>n_years <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb575-6"><a href="相关性与相似性.html#cb575-6" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n_years</span>
<span id="cb575-7"><a href="相关性与相似性.html#cb575-7" tabindex="-1"></a></span>
<span id="cb575-8"><a href="相关性与相似性.html#cb575-8" tabindex="-1"></a><span class="co"># 模拟自回归过程：当前年轮宽度受前2年影响</span></span>
<span id="cb575-9"><a href="相关性与相似性.html#cb575-9" tabindex="-1"></a><span class="co"># AR(2)过程：X_t = 0.6*X_{t-1} - 0.3*X_{t-2} + ε_t</span></span>
<span id="cb575-10"><a href="相关性与相似性.html#cb575-10" tabindex="-1"></a>tree_ring_width <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_years)</span>
<span id="cb575-11"><a href="相关性与相似性.html#cb575-11" tabindex="-1"></a>tree_ring_width[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>)</span>
<span id="cb575-12"><a href="相关性与相似性.html#cb575-12" tabindex="-1"></a>tree_ring_width[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>)</span>
<span id="cb575-13"><a href="相关性与相似性.html#cb575-13" tabindex="-1"></a></span>
<span id="cb575-14"><a href="相关性与相似性.html#cb575-14" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span>n_years) {</span>
<span id="cb575-15"><a href="相关性与相似性.html#cb575-15" tabindex="-1"></a>  tree_ring_width[t] <span class="ot">&lt;-</span> <span class="fl">0.6</span> <span class="sc">*</span> tree_ring_width[t <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">-</span> <span class="fl">0.3</span> <span class="sc">*</span> tree_ring_width[t <span class="sc">-</span> <span class="dv">2</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb575-16"><a href="相关性与相似性.html#cb575-16" tabindex="-1"></a>}</span>
<span id="cb575-17"><a href="相关性与相似性.html#cb575-17" tabindex="-1"></a></span>
<span id="cb575-18"><a href="相关性与相似性.html#cb575-18" tabindex="-1"></a><span class="co"># 添加趋势和季节性（年际变化）</span></span>
<span id="cb575-19"><a href="相关性与相似性.html#cb575-19" tabindex="-1"></a>tree_ring_width <span class="ot">&lt;-</span> tree_ring_width <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> years <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> years <span class="sc">/</span> <span class="dv">30</span>)</span>
<span id="cb575-20"><a href="相关性与相似性.html#cb575-20" tabindex="-1"></a></span>
<span id="cb575-21"><a href="相关性与相似性.html#cb575-21" tabindex="-1"></a><span class="co"># 计算偏自相关函数</span></span>
<span id="cb575-22"><a href="相关性与相似性.html#cb575-22" tabindex="-1"></a>pacf_result <span class="ot">&lt;-</span> <span class="fu">pacf</span>(tree_ring_width, <span class="at">lag.max =</span> <span class="dv">15</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb575-23"><a href="相关性与相似性.html#cb575-23" tabindex="-1"></a></span>
<span id="cb575-24"><a href="相关性与相似性.html#cb575-24" tabindex="-1"></a><span class="co"># 可视化偏自相关函数</span></span>
<span id="cb575-25"><a href="相关性与相似性.html#cb575-25" tabindex="-1"></a><span class="fu">plot</span>(pacf_result,</span>
<span id="cb575-26"><a href="相关性与相似性.html#cb575-26" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;森林年轮宽度的偏自相关函数&quot;</span>,</span>
<span id="cb575-27"><a href="相关性与相似性.html#cb575-27" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;滞后（年）&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;偏自相关系数&quot;</span></span>
<span id="cb575-28"><a href="相关性与相似性.html#cb575-28" tabindex="-1"></a>)</span>
<span id="cb575-29"><a href="相关性与相似性.html#cb575-29" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-16-1"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-16-1.png" alt="森林年轮宽度的偏自相关函数和时间序列图" width="672" />
<p class="caption">
图5.5: 森林年轮宽度的偏自相关函数和时间序列图
</p>
</div>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="相关性与相似性.html#cb576-1" tabindex="-1"></a><span class="co"># 提取关键的偏自相关系数</span></span>
<span id="cb576-2"><a href="相关性与相似性.html#cb576-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;关键滞后下的偏自相关系数：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb576-3"><a href="相关性与相似性.html#cb576-3" tabindex="-1"></a>    <span class="st">&quot;滞后1年：&quot;</span>, <span class="fu">round</span>(pacf_result<span class="sc">$</span>acf[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb576-4"><a href="相关性与相似性.html#cb576-4" tabindex="-1"></a>    <span class="st">&quot;滞后2年：&quot;</span>, <span class="fu">round</span>(pacf_result<span class="sc">$</span>acf[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb576-5"><a href="相关性与相似性.html#cb576-5" tabindex="-1"></a>    <span class="st">&quot;滞后3年：&quot;</span>, <span class="fu">round</span>(pacf_result<span class="sc">$</span>acf[<span class="dv">3</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb576-6"><a href="相关性与相似性.html#cb576-6" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 关键滞后下的偏自相关系数：
## 滞后1年：0.782
## 滞后2年：-0.252
## 滞后3年：0.254</code></pre>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="相关性与相似性.html#cb578-1" tabindex="-1"></a><span class="co"># 比较ACF和PACF</span></span>
<span id="cb578-2"><a href="相关性与相似性.html#cb578-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb578-3"><a href="相关性与相似性.html#cb578-3" tabindex="-1"></a></span>
<span id="cb578-4"><a href="相关性与相似性.html#cb578-4" tabindex="-1"></a><span class="co"># ACF图</span></span>
<span id="cb578-5"><a href="相关性与相似性.html#cb578-5" tabindex="-1"></a><span class="fu">acf</span>(tree_ring_width, <span class="at">lag.max =</span> <span class="dv">15</span>, <span class="at">main =</span> <span class="st">&quot;自相关函数&quot;</span>)</span>
<span id="cb578-6"><a href="相关性与相似性.html#cb578-6" tabindex="-1"></a></span>
<span id="cb578-7"><a href="相关性与相似性.html#cb578-7" tabindex="-1"></a><span class="co"># PACF图</span></span>
<span id="cb578-8"><a href="相关性与相似性.html#cb578-8" tabindex="-1"></a><span class="fu">pacf</span>(tree_ring_width, <span class="at">lag.max =</span> <span class="dv">15</span>, <span class="at">main =</span> <span class="st">&quot;偏自相关函数&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-16-2"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-16-2.png" alt="森林年轮宽度的偏自相关函数和时间序列图" width="672" />
<p class="caption">
图5.6: 森林年轮宽度的偏自相关函数和时间序列图
</p>
</div>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="相关性与相似性.html#cb579-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb579-2"><a href="相关性与相似性.html#cb579-2" tabindex="-1"></a></span>
<span id="cb579-3"><a href="相关性与相似性.html#cb579-3" tabindex="-1"></a><span class="co"># 拟合AR模型并确定最优阶数</span></span>
<span id="cb579-4"><a href="相关性与相似性.html#cb579-4" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb579-5"><a href="相关性与相似性.html#cb579-5" tabindex="-1"></a></span>
<span id="cb579-6"><a href="相关性与相似性.html#cb579-6" tabindex="-1"></a><span class="co"># 使用AIC准则选择最优AR模型阶数</span></span>
<span id="cb579-7"><a href="相关性与相似性.html#cb579-7" tabindex="-1"></a>best_ar <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(tree_ring_width,</span>
<span id="cb579-8"><a href="相关性与相似性.html#cb579-8" tabindex="-1"></a>  <span class="at">max.p =</span> <span class="dv">10</span>, <span class="at">max.q =</span> <span class="dv">0</span>, <span class="at">max.d =</span> <span class="dv">0</span>,</span>
<span id="cb579-9"><a href="相关性与相似性.html#cb579-9" tabindex="-1"></a>  <span class="at">seasonal =</span> <span class="cn">FALSE</span>, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span> <span class="cn">FALSE</span></span>
<span id="cb579-10"><a href="相关性与相似性.html#cb579-10" tabindex="-1"></a>)</span>
<span id="cb579-11"><a href="相关性与相似性.html#cb579-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">最优AR模型阶数：&quot;</span>, best_ar<span class="sc">$</span>arma[<span class="dv">1</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb579-12"><a href="相关性与相似性.html#cb579-12" tabindex="-1"></a>  <span class="st">&quot;模型系数：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 最优AR模型阶数： 3 
##  模型系数：</code></pre>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="相关性与相似性.html#cb581-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(best_ar))</span></code></pre></div>
<pre><code>##        ar1        ar2        ar3  intercept 
##  1.1139434 -0.5072173  0.2773914  2.0968099</code></pre>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="相关性与相似性.html#cb583-1" tabindex="-1"></a><span class="co"># 可视化原始时间序列</span></span>
<span id="cb583-2"><a href="相关性与相似性.html#cb583-2" tabindex="-1"></a><span class="fu">plot</span>(years, tree_ring_width,</span>
<span id="cb583-3"><a href="相关性与相似性.html#cb583-3" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb583-4"><a href="相关性与相似性.html#cb583-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;年份&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;年轮宽度 (mm)&quot;</span>,</span>
<span id="cb583-5"><a href="相关性与相似性.html#cb583-5" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;森林年轮宽度的时间序列&quot;</span></span>
<span id="cb583-6"><a href="相关性与相似性.html#cb583-6" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-16-3"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-16-3.png" alt="森林年轮宽度的偏自相关函数和时间序列图" width="672" />
<p class="caption">
图5.7: 森林年轮宽度的偏自相关函数和时间序列图
</p>
</div>
<p><strong>生态学意义</strong>：偏自相关函数在生态学中主要用于识别时间序列模型的自回归阶数，帮助理解生态过程的直接时间依赖关系和内在动态机制。</p>
</div>
<div id="时间序列平稳性分析的基础假设" class="section level4 hasAnchor" number="5.3.1.3">
<h4><span class="header-section-number">5.3.1.3</span> 时间序列平稳性：分析的基础假设<a href="相关性与相似性.html#时间序列平稳性分析的基础假设" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>在分析鸟类种群数量的长期监测数据时，我们需要首先检验时间序列的平稳性，因为非平稳时间序列可能导致伪相关和错误的统计推断。</p>
<p>时间序列平稳性是时间序列分析的基本假设，指的是时间序列的统计特性（如均值、方差和自相关结构）不随时间变化。具体而言，严格平稳要求时间序列的任意有限维联合分布都不随时间平移而改变，而弱平稳（也称为二阶平稳）只要求均值恒定、方差有限且自协方差只依赖于时间差而不依赖于具体时间点。在生态学实践中，我们通常关注弱平稳性，因为它更容易检验且对于大多数时间序列分析方法已经足够。</p>
<p>平稳性检验在生态学时间序列分析中具有至关重要的意义。许多经典的时间序列方法，如自回归模型、移动平均模型和谱分析，都建立在平稳性假设的基础上。如果时间序列是非平稳的，直接应用这些方法可能导致严重的统计问题，如伪回归（spurious regression）和无效的假设检验。生态学中的许多时间序列都表现出非平稳特征，如长期趋势（气候变化导致的温度上升）、季节性变化（物候的季节性波动）、结构性断点（生态系统突变事件）等。</p>
<p>检验时间序列平稳性的常用方法包括图示法、自相关函数分析、单位根检验（如ADF检验、KPSS检验）等。图示法通过观察时间序列图来识别明显的趋势或季节性模式；自相关函数分析通过检查ACF的衰减模式来判断平稳性——平稳时间序列的ACF应该快速衰减到零，而非平稳时间序列的ACF通常衰减缓慢；单位根检验则提供统计检验来正式判断时间序列是否具有单位根（非平稳的标志）。</p>
<p>当发现时间序列非平稳时，通常需要进行差分或变换来使其平稳化。一阶差分可以去除线性趋势，季节性差分可以去除季节性模式，而对数变换或Box-Cox变换可以稳定方差。经过这些处理后的平稳时间序列就可以安全地应用各种时间序列分析方法了。在生态学应用中，理解时间序列的平稳性不仅关系到统计方法的正确使用，也帮助我们识别生态系统的长期变化模式和动态特征。</p>
<p><strong>数学定义</strong>：弱平稳时间序列满足：</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(E[X_t] = \mu\)</span>（常数均值）</li>
<li><span class="math inline">\(Var[X_t] = \sigma^2 &lt; \infty\)</span>（有限常数方差）</li>
<li><span class="math inline">\(Cov[X_t, X_{t+k}] = \gamma_k\)</span>（自协方差只依赖于滞后<span class="math inline">\(k\)</span>，不依赖于<span class="math inline">\(t\)</span>）</li>
</ol>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="相关性与相似性.html#cb584-1" tabindex="-1"></a><span class="co"># 时间序列平稳性检验示例：鸟类种群数量监测</span></span>
<span id="cb584-2"><a href="相关性与相似性.html#cb584-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb584-3"><a href="相关性与相似性.html#cb584-3" tabindex="-1"></a></span>
<span id="cb584-4"><a href="相关性与相似性.html#cb584-4" tabindex="-1"></a><span class="co"># 模拟鸟类种群数量数据（50年）</span></span>
<span id="cb584-5"><a href="相关性与相似性.html#cb584-5" tabindex="-1"></a>n_years <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb584-6"><a href="相关性与相似性.html#cb584-6" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n_years</span>
<span id="cb584-7"><a href="相关性与相似性.html#cb584-7" tabindex="-1"></a></span>
<span id="cb584-8"><a href="相关性与相似性.html#cb584-8" tabindex="-1"></a><span class="co"># 模拟非平稳时间序列：具有趋势和季节性的种群动态</span></span>
<span id="cb584-9"><a href="相关性与相似性.html#cb584-9" tabindex="-1"></a><span class="co"># 趋势成分：种群总体下降趋势</span></span>
<span id="cb584-10"><a href="相关性与相似性.html#cb584-10" tabindex="-1"></a>trend <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> years</span>
<span id="cb584-11"><a href="相关性与相似性.html#cb584-11" tabindex="-1"></a><span class="co"># 季节性成分：年际波动</span></span>
<span id="cb584-12"><a href="相关性与相似性.html#cb584-12" tabindex="-1"></a>seasonal <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> years <span class="sc">/</span> <span class="dv">5</span>)</span>
<span id="cb584-13"><a href="相关性与相似性.html#cb584-13" tabindex="-1"></a><span class="co"># 随机成分</span></span>
<span id="cb584-14"><a href="相关性与相似性.html#cb584-14" tabindex="-1"></a>random <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(n_years, <span class="dv">0</span>, <span class="dv">2</span>)) <span class="co"># 随机游走，增加非平稳性</span></span>
<span id="cb584-15"><a href="相关性与相似性.html#cb584-15" tabindex="-1"></a></span>
<span id="cb584-16"><a href="相关性与相似性.html#cb584-16" tabindex="-1"></a>bird_population <span class="ot">&lt;-</span> trend <span class="sc">+</span> seasonal <span class="sc">+</span> random <span class="sc">+</span> <span class="fu">rnorm</span>(n_years, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb584-17"><a href="相关性与相似性.html#cb584-17" tabindex="-1"></a></span>
<span id="cb584-18"><a href="相关性与相似性.html#cb584-18" tabindex="-1"></a><span class="co"># 可视化原始时间序列</span></span>
<span id="cb584-19"><a href="相关性与相似性.html#cb584-19" tabindex="-1"></a><span class="fu">plot</span>(years, bird_population,</span>
<span id="cb584-20"><a href="相关性与相似性.html#cb584-20" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;brown&quot;</span>,</span>
<span id="cb584-21"><a href="相关性与相似性.html#cb584-21" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;年份&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;鸟类种群数量&quot;</span>,</span>
<span id="cb584-22"><a href="相关性与相似性.html#cb584-22" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;鸟类种群数量的时间序列&quot;</span></span>
<span id="cb584-23"><a href="相关性与相似性.html#cb584-23" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-17-1"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-17-1.png" alt="鸟类种群数量的时间序列平稳性检验和分解" width="672" />
<p class="caption">
图5.8: 鸟类种群数量的时间序列平稳性检验和分解
</p>
</div>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="相关性与相似性.html#cb585-1" tabindex="-1"></a><span class="co"># 检验平稳性：ADF检验（Augmented Dickey-Fuller Test）</span></span>
<span id="cb585-2"><a href="相关性与相似性.html#cb585-2" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb585-3"><a href="相关性与相似性.html#cb585-3" tabindex="-1"></a></span>
<span id="cb585-4"><a href="相关性与相似性.html#cb585-4" tabindex="-1"></a>adf_test <span class="ot">&lt;-</span> <span class="fu">adf.test</span>(bird_population)</span>
<span id="cb585-5"><a href="相关性与相似性.html#cb585-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;ADF单位根检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb585-6"><a href="相关性与相似性.html#cb585-6" tabindex="-1"></a>    <span class="st">&quot;检验统计量：&quot;</span>, <span class="fu">round</span>(adf_test<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb585-7"><a href="相关性与相似性.html#cb585-7" tabindex="-1"></a>    <span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(adf_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb585-8"><a href="相关性与相似性.html#cb585-8" tabindex="-1"></a>    <span class="st">&quot;原假设：时间序列有单位根（非平稳）</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb585-9"><a href="相关性与相似性.html#cb585-9" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## ADF单位根检验结果：
## 检验统计量：-2.818
## p值：0.246
## 原假设：时间序列有单位根（非平稳）</code></pre>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="相关性与相似性.html#cb587-1" tabindex="-1"></a><span class="cf">if</span> (adf_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb587-2"><a href="相关性与相似性.html#cb587-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;结论：拒绝原假设，时间序列是平稳的</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb587-3"><a href="相关性与相似性.html#cb587-3" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb587-4"><a href="相关性与相似性.html#cb587-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;结论：不能拒绝原假设，时间序列可能是非平稳的</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb587-5"><a href="相关性与相似性.html#cb587-5" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 结论：不能拒绝原假设，时间序列可能是非平稳的</code></pre>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="相关性与相似性.html#cb589-1" tabindex="-1"></a><span class="co"># KPSS检验（另一种平稳性检验）</span></span>
<span id="cb589-2"><a href="相关性与相似性.html#cb589-2" tabindex="-1"></a>kpss_test <span class="ot">&lt;-</span> <span class="fu">kpss.test</span>(bird_population)</span>
<span id="cb589-3"><a href="相关性与相似性.html#cb589-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">KPSS平稳性检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb589-4"><a href="相关性与相似性.html#cb589-4" tabindex="-1"></a>    <span class="st">&quot;检验统计量：&quot;</span>, <span class="fu">round</span>(kpss_test<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb589-5"><a href="相关性与相似性.html#cb589-5" tabindex="-1"></a>    <span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(kpss_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb589-6"><a href="相关性与相似性.html#cb589-6" tabindex="-1"></a>    <span class="st">&quot;原假设：时间序列是平稳的</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb589-7"><a href="相关性与相似性.html#cb589-7" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## KPSS平稳性检验结果：
## 检验统计量：1.201
## p值：0.01
## 原假设：时间序列是平稳的</code></pre>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="相关性与相似性.html#cb591-1" tabindex="-1"></a><span class="cf">if</span> (kpss_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb591-2"><a href="相关性与相似性.html#cb591-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;结论：拒绝原假设，时间序列是非平稳的</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb591-3"><a href="相关性与相似性.html#cb591-3" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb591-4"><a href="相关性与相似性.html#cb591-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;结论：不能拒绝原假设，时间序列可能是平稳的</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb591-5"><a href="相关性与相似性.html#cb591-5" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 结论：拒绝原假设，时间序列是非平稳的</code></pre>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="相关性与相似性.html#cb593-1" tabindex="-1"></a><span class="co"># 如果非平稳，进行差分处理</span></span>
<span id="cb593-2"><a href="相关性与相似性.html#cb593-2" tabindex="-1"></a><span class="cf">if</span> (adf_test<span class="sc">$</span>p.value <span class="sc">&gt;=</span> <span class="fl">0.05</span>) {</span>
<span id="cb593-3"><a href="相关性与相似性.html#cb593-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">进行一阶差分处理...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb593-4"><a href="相关性与相似性.html#cb593-4" tabindex="-1"></a>  bird_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(bird_population)</span>
<span id="cb593-5"><a href="相关性与相似性.html#cb593-5" tabindex="-1"></a></span>
<span id="cb593-6"><a href="相关性与相似性.html#cb593-6" tabindex="-1"></a>  <span class="co"># 检验差分后序列的平稳性</span></span>
<span id="cb593-7"><a href="相关性与相似性.html#cb593-7" tabindex="-1"></a>  adf_diff <span class="ot">&lt;-</span> <span class="fu">adf.test</span>(bird_diff)</span>
<span id="cb593-8"><a href="相关性与相似性.html#cb593-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;差分后序列的ADF检验：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb593-9"><a href="相关性与相似性.html#cb593-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(adf_diff<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb593-10"><a href="相关性与相似性.html#cb593-10" tabindex="-1"></a></span>
<span id="cb593-11"><a href="相关性与相似性.html#cb593-11" tabindex="-1"></a>  <span class="co"># 可视化差分前后的对比</span></span>
<span id="cb593-12"><a href="相关性与相似性.html#cb593-12" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb593-13"><a href="相关性与相似性.html#cb593-13" tabindex="-1"></a></span>
<span id="cb593-14"><a href="相关性与相似性.html#cb593-14" tabindex="-1"></a>  <span class="co"># 原始序列</span></span>
<span id="cb593-15"><a href="相关性与相似性.html#cb593-15" tabindex="-1"></a>  <span class="fu">plot</span>(years, bird_population,</span>
<span id="cb593-16"><a href="相关性与相似性.html#cb593-16" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;brown&quot;</span>,</span>
<span id="cb593-17"><a href="相关性与相似性.html#cb593-17" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;原始序列&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;年份&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;种群数量&quot;</span></span>
<span id="cb593-18"><a href="相关性与相似性.html#cb593-18" tabindex="-1"></a>  )</span>
<span id="cb593-19"><a href="相关性与相似性.html#cb593-19" tabindex="-1"></a></span>
<span id="cb593-20"><a href="相关性与相似性.html#cb593-20" tabindex="-1"></a>  <span class="co"># 差分后序列</span></span>
<span id="cb593-21"><a href="相关性与相似性.html#cb593-21" tabindex="-1"></a>  <span class="fu">plot</span>(years[<span class="sc">-</span><span class="dv">1</span>], bird_diff,</span>
<span id="cb593-22"><a href="相关性与相似性.html#cb593-22" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb593-23"><a href="相关性与相似性.html#cb593-23" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;一阶差分后序列&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;年份&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;差分值&quot;</span></span>
<span id="cb593-24"><a href="相关性与相似性.html#cb593-24" tabindex="-1"></a>  )</span>
<span id="cb593-25"><a href="相关性与相似性.html#cb593-25" tabindex="-1"></a></span>
<span id="cb593-26"><a href="相关性与相似性.html#cb593-26" tabindex="-1"></a>  <span class="co"># 原始序列的ACF</span></span>
<span id="cb593-27"><a href="相关性与相似性.html#cb593-27" tabindex="-1"></a>  <span class="fu">acf</span>(bird_population, <span class="at">main =</span> <span class="st">&quot;原始序列的ACF&quot;</span>)</span>
<span id="cb593-28"><a href="相关性与相似性.html#cb593-28" tabindex="-1"></a></span>
<span id="cb593-29"><a href="相关性与相似性.html#cb593-29" tabindex="-1"></a>  <span class="co"># 差分后序列的ACF</span></span>
<span id="cb593-30"><a href="相关性与相似性.html#cb593-30" tabindex="-1"></a>  <span class="fu">acf</span>(bird_diff, <span class="at">main =</span> <span class="st">&quot;差分后序列的ACF&quot;</span>)</span>
<span id="cb593-31"><a href="相关性与相似性.html#cb593-31" tabindex="-1"></a></span>
<span id="cb593-32"><a href="相关性与相似性.html#cb593-32" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb593-33"><a href="相关性与相似性.html#cb593-33" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## 进行一阶差分处理...</code></pre>
<pre><code>## 差分后序列的ADF检验：
## p值： 0.01</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-17-2"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-17-2.png" alt="鸟类种群数量的时间序列平稳性检验和分解" width="672" />
<p class="caption">
图5.9: 鸟类种群数量的时间序列平稳性检验和分解
</p>
</div>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="相关性与相似性.html#cb596-1" tabindex="-1"></a><span class="co"># 分解时间序列（趋势、季节、随机成分）</span></span>
<span id="cb596-2"><a href="相关性与相似性.html#cb596-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(bird_population) <span class="sc">&gt;=</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">12</span>) { <span class="co"># 需要足够的数据点进行季节性分解</span></span>
<span id="cb596-3"><a href="相关性与相似性.html#cb596-3" tabindex="-1"></a>  ts_data <span class="ot">&lt;-</span> <span class="fu">ts</span>(bird_population, <span class="at">frequency =</span> <span class="dv">5</span>) <span class="co"># 假设5年周期</span></span>
<span id="cb596-4"><a href="相关性与相似性.html#cb596-4" tabindex="-1"></a>  decompose_result <span class="ot">&lt;-</span> <span class="fu">decompose</span>(ts_data)</span>
<span id="cb596-5"><a href="相关性与相似性.html#cb596-5" tabindex="-1"></a>  <span class="fu">plot</span>(decompose_result)</span>
<span id="cb596-6"><a href="相关性与相似性.html#cb596-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-17-3"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-17-3.png" alt="鸟类种群数量的时间序列平稳性检验和分解" width="672" />
<p class="caption">
图5.10: 鸟类种群数量的时间序列平稳性检验和分解
</p>
</div>
<p><strong>生态学意义</strong>：时间序列平稳性是生态时间序列分析的基本前提，正确的平稳性检验和处理对于避免伪相关、确保统计推断的有效性至关重要，特别是在分析长期生态监测数据和气候变化影响研究时。</p>
</div>
</div>
<div id="空间自相关" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> 空间自相关<a href="相关性与相似性.html#空间自相关" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>空间自相关是指地理空间中相邻位置上的观测值之间的相关性。在生态学中，许多现象都具有空间依赖性，如物种分布、环境因子的空间变异、种群的空间格局等。空间自相关分析帮助我们理解生态现象的空间结构和空间过程。</p>
<div id="变异函数variogram空间依赖性的量化" class="section level4 hasAnchor" number="5.3.2.1">
<h4><span class="header-section-number">5.3.2.1</span> 变异函数（Variogram）：空间依赖性的量化<a href="相关性与相似性.html#变异函数variogram空间依赖性的量化" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>假设我们正在研究一片草原上植物物种丰富度的空间分布，我们在100个样点上测量了物种数，想要了解物种丰富度在空间上的依赖关系如何随距离变化。</p>
<p>变异函数是地统计学中的核心工具，用于量化空间自相关随距离的变化模式。变异函数描述的是空间变量在特定距离下的半方差，即相同距离的观测点对之间差异的期望值的一半。变异函数的核心思想是：在空间上相近的观测值往往比相距较远的观测值更相似，这种相似性随着距离的增加而逐渐减弱，直到达到某个距离后相似性不再随距离变化。变异函数通常通过三个关键参数来描述空间依赖结构：块金值（nugget）、基台值（sill）和变程（range）。块金值代表距离为零时的半方差，反映了测量误差或小尺度变异；基台值代表半方差达到稳定时的值，反映了变量的总空间变异；变程代表空间自相关存在的最大距离，反映了空间依赖性的尺度。</p>
<p>在生态学研究中，变异函数具有广泛的应用价值。例如，在分析物种分布时，变异函数可以帮助识别物种聚集的尺度；在研究环境异质性时，变异函数可以揭示环境因子的空间结构；在生态监测设计中，变异函数可以为确定合适的采样间距提供依据。变异函数的形状也提供了关于空间过程的重要信息：如果变异函数快速上升并达到基台值，表明空间依赖性在较小尺度上存在；如果变异函数缓慢上升，表明空间依赖性在较大尺度上存在；如果变异函数呈现周期性波动，可能反映重复的空间格局。此外，拟合的理论变异函数模型（如球状模型、指数模型、高斯模型等）可以用于空间插值（克里金法）和空间预测。</p>
<p><strong>数学定义</strong>：对于空间变量<span class="math inline">\(Z(\mathbf{s})\)</span>，其中<span class="math inline">\(\mathbf{s}\)</span>表示空间位置，变异函数定义为：</p>
<p><span class="math display">\[\gamma(\mathbf{h}) = \frac{1}{2}E[(Z(\mathbf{s} + \mathbf{h}) - Z(\mathbf{s}))^2]\]</span></p>
<p>其中<span class="math inline">\(\mathbf{h}\)</span>是空间滞后向量，<span class="math inline">\(E[\cdot]\)</span>表示期望值。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="相关性与相似性.html#cb597-1" tabindex="-1"></a><span class="co"># 变异函数示例：草原植物物种丰富度的空间分布</span></span>
<span id="cb597-2"><a href="相关性与相似性.html#cb597-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb597-3"><a href="相关性与相似性.html#cb597-3" tabindex="-1"></a></span>
<span id="cb597-4"><a href="相关性与相似性.html#cb597-4" tabindex="-1"></a><span class="co"># 模拟空间数据：100个样点的坐标和物种丰富度</span></span>
<span id="cb597-5"><a href="相关性与相似性.html#cb597-5" tabindex="-1"></a><span class="fu">library</span>(gstat)</span>
<span id="cb597-6"><a href="相关性与相似性.html#cb597-6" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb597-7"><a href="相关性与相似性.html#cb597-7" tabindex="-1"></a></span>
<span id="cb597-8"><a href="相关性与相似性.html#cb597-8" tabindex="-1"></a>n_sites <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb597-9"><a href="相关性与相似性.html#cb597-9" tabindex="-1"></a></span>
<span id="cb597-10"><a href="相关性与相似性.html#cb597-10" tabindex="-1"></a><span class="co"># 生成随机空间坐标</span></span>
<span id="cb597-11"><a href="相关性与相似性.html#cb597-11" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb597-12"><a href="相关性与相似性.html#cb597-12" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">runif</span>(n_sites, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb597-13"><a href="相关性与相似性.html#cb597-13" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">runif</span>(n_sites, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb597-14"><a href="相关性与相似性.html#cb597-14" tabindex="-1"></a>)</span>
<span id="cb597-15"><a href="相关性与相似性.html#cb597-15" tabindex="-1"></a></span>
<span id="cb597-16"><a href="相关性与相似性.html#cb597-16" tabindex="-1"></a><span class="co"># 模拟具有空间自相关的物种丰富度数据</span></span>
<span id="cb597-17"><a href="相关性与相似性.html#cb597-17" tabindex="-1"></a><span class="co"># 使用高斯随机场模拟空间相关性</span></span>
<span id="cb597-18"><a href="相关性与相似性.html#cb597-18" tabindex="-1"></a><span class="fu">library</span>(geoR)</span>
<span id="cb597-19"><a href="相关性与相似性.html#cb597-19" tabindex="-1"></a></span>
<span id="cb597-20"><a href="相关性与相似性.html#cb597-20" tabindex="-1"></a><span class="co"># 设置空间相关参数</span></span>
<span id="cb597-21"><a href="相关性与相似性.html#cb597-21" tabindex="-1"></a>mean_richness <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># 平均物种丰富度</span></span>
<span id="cb597-22"><a href="相关性与相似性.html#cb597-22" tabindex="-1"></a>spatial_range <span class="ot">&lt;-</span> <span class="dv">30</span> <span class="co"># 空间相关范围</span></span>
<span id="cb597-23"><a href="相关性与相似性.html#cb597-23" tabindex="-1"></a>spatial_variance <span class="ot">&lt;-</span> <span class="dv">25</span> <span class="co"># 空间方差</span></span>
<span id="cb597-24"><a href="相关性与相似性.html#cb597-24" tabindex="-1"></a></span>
<span id="cb597-25"><a href="相关性与相似性.html#cb597-25" tabindex="-1"></a><span class="co"># 生成高斯随机场</span></span>
<span id="cb597-26"><a href="相关性与相似性.html#cb597-26" tabindex="-1"></a>grf_model <span class="ot">&lt;-</span> <span class="fu">grf</span>(</span>
<span id="cb597-27"><a href="相关性与相似性.html#cb597-27" tabindex="-1"></a>  <span class="at">n =</span> n_sites,</span>
<span id="cb597-28"><a href="相关性与相似性.html#cb597-28" tabindex="-1"></a>  <span class="at">grid =</span> <span class="st">&quot;irreg&quot;</span>,</span>
<span id="cb597-29"><a href="相关性与相似性.html#cb597-29" tabindex="-1"></a>  <span class="at">xlims =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb597-30"><a href="相关性与相似性.html#cb597-30" tabindex="-1"></a>  <span class="at">ylims =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb597-31"><a href="相关性与相似性.html#cb597-31" tabindex="-1"></a>  <span class="at">cov.pars =</span> <span class="fu">c</span>(spatial_variance, spatial_range),</span>
<span id="cb597-32"><a href="相关性与相似性.html#cb597-32" tabindex="-1"></a>  <span class="at">cov.model =</span> <span class="st">&quot;exponential&quot;</span></span>
<span id="cb597-33"><a href="相关性与相似性.html#cb597-33" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## grf: simulation(s) on randomly chosen locations with  100  points
## grf: process with  1  covariance structure(s)
## grf: nugget effect is: tausq= 0 
## grf: covariance model 1 is: exponential(sigmasq=25, phi=30)
## grf: decomposition algorithm used is:  cholesky 
## grf: End of simulation procedure. Number of realizations: 1</code></pre>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="相关性与相似性.html#cb599-1" tabindex="-1"></a>species_richness <span class="ot">&lt;-</span> mean_richness <span class="sc">+</span> grf_model<span class="sc">$</span>data</span>
<span id="cb599-2"><a href="相关性与相似性.html#cb599-2" tabindex="-1"></a></span>
<span id="cb599-3"><a href="相关性与相似性.html#cb599-3" tabindex="-1"></a><span class="co"># 创建空间数据框</span></span>
<span id="cb599-4"><a href="相关性与相似性.html#cb599-4" tabindex="-1"></a>spatial_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb599-5"><a href="相关性与相似性.html#cb599-5" tabindex="-1"></a>  <span class="at">x =</span> grf_model<span class="sc">$</span>coords[, <span class="dv">1</span>],</span>
<span id="cb599-6"><a href="相关性与相似性.html#cb599-6" tabindex="-1"></a>  <span class="at">y =</span> grf_model<span class="sc">$</span>coords[, <span class="dv">2</span>],</span>
<span id="cb599-7"><a href="相关性与相似性.html#cb599-7" tabindex="-1"></a>  <span class="at">richness =</span> species_richness</span>
<span id="cb599-8"><a href="相关性与相似性.html#cb599-8" tabindex="-1"></a>)</span>
<span id="cb599-9"><a href="相关性与相似性.html#cb599-9" tabindex="-1"></a><span class="fu">coordinates</span>(spatial_data) <span class="ot">&lt;-</span> <span class="er">~</span> x <span class="sc">+</span> y</span>
<span id="cb599-10"><a href="相关性与相似性.html#cb599-10" tabindex="-1"></a></span>
<span id="cb599-11"><a href="相关性与相似性.html#cb599-11" tabindex="-1"></a><span class="co"># 计算经验变异函数</span></span>
<span id="cb599-12"><a href="相关性与相似性.html#cb599-12" tabindex="-1"></a>variogram_emp <span class="ot">&lt;-</span> <span class="fu">variogram</span>(richness <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> spatial_data)</span>
<span id="cb599-13"><a href="相关性与相似性.html#cb599-13" tabindex="-1"></a></span>
<span id="cb599-14"><a href="相关性与相似性.html#cb599-14" tabindex="-1"></a><span class="co"># 可视化经验变异函数</span></span>
<span id="cb599-15"><a href="相关性与相似性.html#cb599-15" tabindex="-1"></a><span class="fu">plot</span>(variogram_emp,</span>
<span id="cb599-16"><a href="相关性与相似性.html#cb599-16" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;物种丰富度的经验变异函数&quot;</span>,</span>
<span id="cb599-17"><a href="相关性与相似性.html#cb599-17" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;距离&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;半方差&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb599-18"><a href="相关性与相似性.html#cb599-18" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-18-1"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-18-1.png" alt="物种丰富度的经验变异函数和空间分布图" width="672" />
<p class="caption">
图5.11: 物种丰富度的经验变异函数和空间分布图
</p>
</div>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="相关性与相似性.html#cb600-1" tabindex="-1"></a><span class="co"># 拟合理论变异函数模型（指数模型）</span></span>
<span id="cb600-2"><a href="相关性与相似性.html#cb600-2" tabindex="-1"></a>variogram_fit <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(variogram_emp, <span class="at">model =</span> <span class="fu">vgm</span>(<span class="dv">25</span>, <span class="st">&quot;Exp&quot;</span>, <span class="dv">30</span>, <span class="dv">5</span>))</span>
<span id="cb600-3"><a href="相关性与相似性.html#cb600-3" tabindex="-1"></a></span>
<span id="cb600-4"><a href="相关性与相似性.html#cb600-4" tabindex="-1"></a><span class="co"># 可视化拟合结果</span></span>
<span id="cb600-5"><a href="相关性与相似性.html#cb600-5" tabindex="-1"></a><span class="fu">plot</span>(variogram_emp, variogram_fit,</span>
<span id="cb600-6"><a href="相关性与相似性.html#cb600-6" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;变异函数拟合&quot;</span>,</span>
<span id="cb600-7"><a href="相关性与相似性.html#cb600-7" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;距离&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;半方差&quot;</span></span>
<span id="cb600-8"><a href="相关性与相似性.html#cb600-8" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-18-2"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-18-2.png" alt="物种丰富度的经验变异函数和空间分布图" width="672" />
<p class="caption">
图5.12: 物种丰富度的经验变异函数和空间分布图
</p>
</div>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="相关性与相似性.html#cb601-1" tabindex="-1"></a><span class="co"># 提取变异函数参数</span></span>
<span id="cb601-2"><a href="相关性与相似性.html#cb601-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;变异函数参数：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb601-3"><a href="相关性与相似性.html#cb601-3" tabindex="-1"></a>    <span class="st">&quot;块金值 (nugget)：&quot;</span>, variogram_fit<span class="sc">$</span>psill[<span class="dv">1</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb601-4"><a href="相关性与相似性.html#cb601-4" tabindex="-1"></a>    <span class="st">&quot;偏基台值 (partial sill)：&quot;</span>, variogram_fit<span class="sc">$</span>psill[<span class="dv">2</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb601-5"><a href="相关性与相似性.html#cb601-5" tabindex="-1"></a>    <span class="st">&quot;基台值 (sill)：&quot;</span>, <span class="fu">sum</span>(variogram_fit<span class="sc">$</span>psill), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb601-6"><a href="相关性与相似性.html#cb601-6" tabindex="-1"></a>    <span class="st">&quot;变程 (range)：&quot;</span>, variogram_fit<span class="sc">$</span>range[<span class="dv">2</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb601-7"><a href="相关性与相似性.html#cb601-7" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 变异函数参数：
## 块金值 (nugget)：0
## 偏基台值 (partial sill)：252.118
## 基台值 (sill)：252.118
## 变程 (range)：411.6164</code></pre>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="相关性与相似性.html#cb603-1" tabindex="-1"></a><span class="co"># 可视化空间分布</span></span>
<span id="cb603-2"><a href="相关性与相似性.html#cb603-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb603-3"><a href="相关性与相似性.html#cb603-3" tabindex="-1"></a>spatial_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(spatial_data)</span>
<span id="cb603-4"><a href="相关性与相似性.html#cb603-4" tabindex="-1"></a></span>
<span id="cb603-5"><a href="相关性与相似性.html#cb603-5" tabindex="-1"></a><span class="fu">ggplot</span>(spatial_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> richness)) <span class="sc">+</span></span>
<span id="cb603-6"><a href="相关性与相似性.html#cb603-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb603-7"><a href="相关性与相似性.html#cb603-7" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">high =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb603-8"><a href="相关性与相似性.html#cb603-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb603-9"><a href="相关性与相似性.html#cb603-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;植物物种丰富度的空间分布&quot;</span>,</span>
<span id="cb603-10"><a href="相关性与相似性.html#cb603-10" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y坐标&quot;</span>, <span class="at">color =</span> <span class="st">&quot;物种数&quot;</span></span>
<span id="cb603-11"><a href="相关性与相似性.html#cb603-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb603-12"><a href="相关性与相似性.html#cb603-12" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-18-3"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-18-3.png" alt="物种丰富度的经验变异函数和空间分布图" width="672" />
<p class="caption">
图5.13: 物种丰富度的经验变异函数和空间分布图
</p>
</div>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="相关性与相似性.html#cb604-1" tabindex="-1"></a><span class="co"># 进行空间插值（普通克里金法）</span></span>
<span id="cb604-2"><a href="相关性与相似性.html#cb604-2" tabindex="-1"></a><span class="fu">library</span>(automap)</span>
<span id="cb604-3"><a href="相关性与相似性.html#cb604-3" tabindex="-1"></a></span>
<span id="cb604-4"><a href="相关性与相似性.html#cb604-4" tabindex="-1"></a><span class="co"># 创建插值网格</span></span>
<span id="cb604-5"><a href="相关性与相似性.html#cb604-5" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb604-6"><a href="相关性与相似性.html#cb604-6" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">50</span>),</span>
<span id="cb604-7"><a href="相关性与相似性.html#cb604-7" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb604-8"><a href="相关性与相似性.html#cb604-8" tabindex="-1"></a>)</span>
<span id="cb604-9"><a href="相关性与相似性.html#cb604-9" tabindex="-1"></a><span class="fu">coordinates</span>(grid) <span class="ot">&lt;-</span> <span class="er">~</span> x <span class="sc">+</span> y</span>
<span id="cb604-10"><a href="相关性与相似性.html#cb604-10" tabindex="-1"></a><span class="fu">gridded</span>(grid) <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb604-11"><a href="相关性与相似性.html#cb604-11" tabindex="-1"></a></span>
<span id="cb604-12"><a href="相关性与相似性.html#cb604-12" tabindex="-1"></a><span class="co"># 执行克里金插值</span></span>
<span id="cb604-13"><a href="相关性与相似性.html#cb604-13" tabindex="-1"></a>kriging_result <span class="ot">&lt;-</span> <span class="fu">autoKrige</span>(richness <span class="sc">~</span> <span class="dv">1</span>, spatial_data, grid)</span></code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="相关性与相似性.html#cb606-1" tabindex="-1"></a><span class="co"># 可视化插值结果</span></span>
<span id="cb606-2"><a href="相关性与相似性.html#cb606-2" tabindex="-1"></a><span class="fu">plot</span>(kriging_result)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-18-4"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-18-4.png" alt="物种丰富度的经验变异函数和空间分布图" width="672" />
<p class="caption">
图5.14: 物种丰富度的经验变异函数和空间分布图
</p>
</div>
<p><strong>生态学意义</strong>：变异函数在生态学中广泛应用于量化空间依赖性的尺度，如物种分布的空间格局、环境异质性的空间结构、种群聚集的空间范围等。</p>
</div>
<div id="空间自相关指数全局空间模式的检测" class="section level4 hasAnchor" number="5.3.2.2">
<h4><span class="header-section-number">5.3.2.2</span> 空间自相关指数：全局空间模式的检测<a href="相关性与相似性.html#空间自相关指数全局空间模式的检测" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>在研究森林中树木分布的空间格局时，我们想要了解整个研究区域内树木分布是随机分布、聚集分布还是均匀分布，这需要使用全局空间自相关指数来量化。</p>
<p>空间自相关指数是量化空间数据中自相关程度的统计量，其中最著名的是Moran’s I和Geary’s C。这些指数提供了对全局空间模式的整体度量，帮助我们判断空间数据是否表现出显著的空间自相关。Moran’s I是最常用的全局空间自相关指数，其计算原理类似于Pearson相关系数，但应用于空间邻接关系。Moran’s I的取值范围通常在-1到1之间，正值表示正空间自相关（即相似的值在空间上聚集），负值表示负空间自相关（即相异的值在空间上聚集），0值表示没有空间自相关（即随机分布）。</p>
<p>Geary’s C是另一个重要的全局空间自相关指数，其计算基于相邻观测值之间的差异。与Moran’s I不同，Geary’s C的取值范围在0到2之间，其中0表示完全正空间自相关，1表示没有空间自相关，大于1的值表示负空间自相关。Geary’s C对局部差异更加敏感，而Moran’s I对全局模式更加敏感。在生态学应用中，这两种指数往往结合使用，以提供对空间模式的全面理解。</p>
<p>空间自相关指数的计算需要定义空间权重矩阵，该矩阵量化了不同空间位置之间的邻接关系或空间影响。常见的权重定义方法包括基于距离的权重（如反距离权重）、基于邻接的权重（如queen邻接、rook邻接）和基于核函数的权重。权重矩阵的选择对空间自相关分析的结果有重要影响，需要根据研究的具体背景和空间过程的性质来合理选择。</p>
<p>在生态学研究中，空间自相关指数具有重要的应用价值。例如，在保护生物学中，Moran’s I可以帮助识别物种的热点区域；在景观生态学中，空间自相关分析可以揭示生境破碎化的空间模式；在种群生态学中，这些指数可以量化种群的聚集程度。此外，空间自相关检验还为许多空间统计方法提供了基础，如空间回归模型、空间方差分析等。</p>
<p><strong>数学定义</strong>：</p>
<ul>
<li><strong>Moran’s I</strong>：</li>
</ul>
<p><span class="math display">\[I = \frac{n}{\sum_{i=1}^{n}\sum_{j=1}^{n}w_{ij}} \cdot \frac{\sum_{i=1}^{n}\sum_{j=1}^{n}w_{ij}(x_i - \bar{x})(x_j - \bar{x})}{\sum_{i=1}^{n}(x_i - \bar{x})^2}\]</span></p>
<p>其中<span class="math inline">\(n\)</span>是观测点数，<span class="math inline">\(x_i\)</span>是第<span class="math inline">\(i\)</span>个观测值，<span class="math inline">\(\bar{x}\)</span>是样本均值，<span class="math inline">\(w_{ij}\)</span>是空间权重。</p>
<ul>
<li><strong>Geary’s C</strong>：</li>
</ul>
<p><span class="math display">\[C = \frac{(n-1)}{2\sum_{i=1}^{n}\sum_{j=1}^{n}w_{ij}} \cdot \frac{\sum_{i=1}^{n}\sum_{j=1}^{n}w_{ij}(x_i - x_j)^2}{\sum_{i=1}^{n}(x_i - \bar{x})^2}\]</span></p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="相关性与相似性.html#cb607-1" tabindex="-1"></a><span class="co"># 空间自相关指数示例：森林树木分布的空间格局</span></span>
<span id="cb607-2"><a href="相关性与相似性.html#cb607-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb607-3"><a href="相关性与相似性.html#cb607-3" tabindex="-1"></a></span>
<span id="cb607-4"><a href="相关性与相似性.html#cb607-4" tabindex="-1"></a><span class="co"># 模拟森林树木数据</span></span>
<span id="cb607-5"><a href="相关性与相似性.html#cb607-5" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb607-6"><a href="相关性与相似性.html#cb607-6" tabindex="-1"></a></span>
<span id="cb607-7"><a href="相关性与相似性.html#cb607-7" tabindex="-1"></a>n_trees <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb607-8"><a href="相关性与相似性.html#cb607-8" tabindex="-1"></a></span>
<span id="cb607-9"><a href="相关性与相似性.html#cb607-9" tabindex="-1"></a><span class="co"># 生成树木坐标（模拟聚集分布）</span></span>
<span id="cb607-10"><a href="相关性与相似性.html#cb607-10" tabindex="-1"></a><span class="co"># 使用聚类过程生成聚集分布的坐标</span></span>
<span id="cb607-11"><a href="相关性与相似性.html#cb607-11" tabindex="-1"></a>cluster_centers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb607-12"><a href="相关性与相似性.html#cb607-12" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb607-13"><a href="相关性与相似性.html#cb607-13" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb607-14"><a href="相关性与相似性.html#cb607-14" tabindex="-1"></a>)</span>
<span id="cb607-15"><a href="相关性与相似性.html#cb607-15" tabindex="-1"></a></span>
<span id="cb607-16"><a href="相关性与相似性.html#cb607-16" tabindex="-1"></a>tree_coords <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">numeric</span>(<span class="dv">0</span>), <span class="at">y =</span> <span class="fu">numeric</span>(<span class="dv">0</span>))</span>
<span id="cb607-17"><a href="相关性与相似性.html#cb607-17" tabindex="-1"></a></span>
<span id="cb607-18"><a href="相关性与相似性.html#cb607-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cluster_centers)) {</span>
<span id="cb607-19"><a href="相关性与相似性.html#cb607-19" tabindex="-1"></a>  n_cluster <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">15</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">1</span>) <span class="co"># 每个簇的树木数量</span></span>
<span id="cb607-20"><a href="相关性与相似性.html#cb607-20" tabindex="-1"></a>  cluster_trees <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb607-21"><a href="相关性与相似性.html#cb607-21" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(n_cluster, cluster_centers<span class="sc">$</span>x[i], <span class="dv">8</span>),</span>
<span id="cb607-22"><a href="相关性与相似性.html#cb607-22" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">rnorm</span>(n_cluster, cluster_centers<span class="sc">$</span>y[i], <span class="dv">8</span>)</span>
<span id="cb607-23"><a href="相关性与相似性.html#cb607-23" tabindex="-1"></a>  )</span>
<span id="cb607-24"><a href="相关性与相似性.html#cb607-24" tabindex="-1"></a>  tree_coords <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tree_coords, cluster_trees)</span>
<span id="cb607-25"><a href="相关性与相似性.html#cb607-25" tabindex="-1"></a>}</span>
<span id="cb607-26"><a href="相关性与相似性.html#cb607-26" tabindex="-1"></a></span>
<span id="cb607-27"><a href="相关性与相似性.html#cb607-27" tabindex="-1"></a><span class="co"># 确保总数为n_trees</span></span>
<span id="cb607-28"><a href="相关性与相似性.html#cb607-28" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(tree_coords) <span class="sc">&gt;</span> n_trees) {</span>
<span id="cb607-29"><a href="相关性与相似性.html#cb607-29" tabindex="-1"></a>  tree_coords <span class="ot">&lt;-</span> tree_coords[<span class="dv">1</span><span class="sc">:</span>n_trees, ]</span>
<span id="cb607-30"><a href="相关性与相似性.html#cb607-30" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb607-31"><a href="相关性与相似性.html#cb607-31" tabindex="-1"></a>  <span class="co"># 添加一些随机分布的树木</span></span>
<span id="cb607-32"><a href="相关性与相似性.html#cb607-32" tabindex="-1"></a>  n_extra <span class="ot">&lt;-</span> n_trees <span class="sc">-</span> <span class="fu">nrow</span>(tree_coords)</span>
<span id="cb607-33"><a href="相关性与相似性.html#cb607-33" tabindex="-1"></a>  extra_trees <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb607-34"><a href="相关性与相似性.html#cb607-34" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">runif</span>(n_extra, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb607-35"><a href="相关性与相似性.html#cb607-35" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">runif</span>(n_extra, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb607-36"><a href="相关性与相似性.html#cb607-36" tabindex="-1"></a>  )</span>
<span id="cb607-37"><a href="相关性与相似性.html#cb607-37" tabindex="-1"></a>  tree_coords <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tree_coords, extra_trees)</span>
<span id="cb607-38"><a href="相关性与相似性.html#cb607-38" tabindex="-1"></a>}</span>
<span id="cb607-39"><a href="相关性与相似性.html#cb607-39" tabindex="-1"></a></span>
<span id="cb607-40"><a href="相关性与相似性.html#cb607-40" tabindex="-1"></a><span class="co"># 模拟树木胸径（具有空间自相关）</span></span>
<span id="cb607-41"><a href="相关性与相似性.html#cb607-41" tabindex="-1"></a><span class="co"># 使用空间平滑过程</span></span>
<span id="cb607-42"><a href="相关性与相似性.html#cb607-42" tabindex="-1"></a><span class="fu">coordinates</span>(tree_coords) <span class="ot">&lt;-</span> <span class="er">~</span> x <span class="sc">+</span> y</span>
<span id="cb607-43"><a href="相关性与相似性.html#cb607-43" tabindex="-1"></a></span>
<span id="cb607-44"><a href="相关性与相似性.html#cb607-44" tabindex="-1"></a><span class="co"># 创建空间权重矩阵（基于k近邻）</span></span>
<span id="cb607-45"><a href="相关性与相似性.html#cb607-45" tabindex="-1"></a>knn_weights <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(tree_coords, <span class="at">k =</span> <span class="dv">5</span>))</span>
<span id="cb607-46"><a href="相关性与相似性.html#cb607-46" tabindex="-1"></a>listw_weights <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(knn_weights, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb607-47"><a href="相关性与相似性.html#cb607-47" tabindex="-1"></a></span>
<span id="cb607-48"><a href="相关性与相似性.html#cb607-48" tabindex="-1"></a><span class="co"># 模拟具有空间自相关的胸径数据</span></span>
<span id="cb607-49"><a href="相关性与相似性.html#cb607-49" tabindex="-1"></a><span class="co"># 使用空间自回归过程</span></span>
<span id="cb607-50"><a href="相关性与相似性.html#cb607-50" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb607-51"><a href="相关性与相似性.html#cb607-51" tabindex="-1"></a>spatial_autocorr <span class="ot">&lt;-</span> <span class="fl">0.7</span> <span class="co"># 空间自相关强度</span></span>
<span id="cb607-52"><a href="相关性与相似性.html#cb607-52" tabindex="-1"></a></span>
<span id="cb607-53"><a href="相关性与相似性.html#cb607-53" tabindex="-1"></a><span class="co"># 生成空间自相关数据</span></span>
<span id="cb607-54"><a href="相关性与相似性.html#cb607-54" tabindex="-1"></a>n <span class="ot">&lt;-</span> n_trees</span>
<span id="cb607-55"><a href="相关性与相似性.html#cb607-55" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">listw2mat</span>(listw_weights)</span>
<span id="cb607-56"><a href="相关性与相似性.html#cb607-56" tabindex="-1"></a>I_minus_rhoW <span class="ot">&lt;-</span> <span class="fu">diag</span>(n) <span class="sc">-</span> spatial_autocorr <span class="sc">*</span> W</span>
<span id="cb607-57"><a href="相关性与相似性.html#cb607-57" tabindex="-1"></a></span>
<span id="cb607-58"><a href="相关性与相似性.html#cb607-58" tabindex="-1"></a><span class="co"># 确保矩阵可逆</span></span>
<span id="cb607-59"><a href="相关性与相似性.html#cb607-59" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">rcond</span>(I_minus_rhoW) <span class="sc">&gt;</span> <span class="fl">1e-10</span>) {</span>
<span id="cb607-60"><a href="相关性与相似性.html#cb607-60" tabindex="-1"></a>  tree_dbh <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">solve</span>(I_minus_rhoW) <span class="sc">%*%</span> <span class="fu">rnorm</span>(n, <span class="dv">25</span>, <span class="dv">5</span>))</span>
<span id="cb607-61"><a href="相关性与相似性.html#cb607-61" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb607-62"><a href="相关性与相似性.html#cb607-62" tabindex="-1"></a>  <span class="co"># 如果矩阵不可逆，使用近似方法</span></span>
<span id="cb607-63"><a href="相关性与相似性.html#cb607-63" tabindex="-1"></a>  tree_dbh <span class="ot">&lt;-</span> <span class="dv">25</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb607-64"><a href="相关性与相似性.html#cb607-64" tabindex="-1"></a>}</span>
<span id="cb607-65"><a href="相关性与相似性.html#cb607-65" tabindex="-1"></a></span>
<span id="cb607-66"><a href="相关性与相似性.html#cb607-66" tabindex="-1"></a><span class="co"># 计算Moran&#39;s I</span></span>
<span id="cb607-67"><a href="相关性与相似性.html#cb607-67" tabindex="-1"></a>moran_test <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(tree_dbh, listw_weights)</span>
<span id="cb607-68"><a href="相关性与相似性.html#cb607-68" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Moran&#39;s I检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb607-69"><a href="相关性与相似性.html#cb607-69" tabindex="-1"></a>    <span class="st">&quot;Moran&#39;s I统计量：&quot;</span>, <span class="fu">round</span>(moran_test<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb607-70"><a href="相关性与相似性.html#cb607-70" tabindex="-1"></a>    <span class="st">&quot;期望值：&quot;</span>, <span class="fu">round</span>(moran_test<span class="sc">$</span>estimate[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb607-71"><a href="相关性与相似性.html#cb607-71" tabindex="-1"></a>    <span class="st">&quot;方差：&quot;</span>, <span class="fu">round</span>(moran_test<span class="sc">$</span>estimate[<span class="dv">3</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb607-72"><a href="相关性与相似性.html#cb607-72" tabindex="-1"></a>    <span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(moran_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb607-73"><a href="相关性与相似性.html#cb607-73" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## Moran&#39;s I检验结果：
## Moran&#39;s I统计量：0.425
## 期望值：-0.01
## 方差：0.003
## p值：4.48e-15</code></pre>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="相关性与相似性.html#cb609-1" tabindex="-1"></a><span class="co"># 计算Geary&#39;s C</span></span>
<span id="cb609-2"><a href="相关性与相似性.html#cb609-2" tabindex="-1"></a>geary_test <span class="ot">&lt;-</span> <span class="fu">geary.test</span>(tree_dbh, listw_weights)</span>
<span id="cb609-3"><a href="相关性与相似性.html#cb609-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Geary&#39;s C检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb609-4"><a href="相关性与相似性.html#cb609-4" tabindex="-1"></a>    <span class="st">&quot;Geary&#39;s C统计量：&quot;</span>, <span class="fu">round</span>(geary_test<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb609-5"><a href="相关性与相似性.html#cb609-5" tabindex="-1"></a>    <span class="st">&quot;期望值：&quot;</span>, <span class="fu">round</span>(geary_test<span class="sc">$</span>estimate[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb609-6"><a href="相关性与相似性.html#cb609-6" tabindex="-1"></a>    <span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(geary_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb609-7"><a href="相关性与相似性.html#cb609-7" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Geary&#39;s C检验结果：
## Geary&#39;s C统计量：0.568
## 期望值：1
## p值：7.06e-11</code></pre>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="相关性与相似性.html#cb611-1" tabindex="-1"></a><span class="co"># 可视化空间分布和自相关</span></span>
<span id="cb611-2"><a href="相关性与相似性.html#cb611-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb611-3"><a href="相关性与相似性.html#cb611-3" tabindex="-1"></a></span>
<span id="cb611-4"><a href="相关性与相似性.html#cb611-4" tabindex="-1"></a><span class="co"># 树木坐标分布</span></span>
<span id="cb611-5"><a href="相关性与相似性.html#cb611-5" tabindex="-1"></a><span class="fu">plot</span>(tree_coords,</span>
<span id="cb611-6"><a href="相关性与相似性.html#cb611-6" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb611-7"><a href="相关性与相似性.html#cb611-7" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;树木空间分布&quot;</span>,</span>
<span id="cb611-8"><a href="相关性与相似性.html#cb611-8" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y坐标&quot;</span></span>
<span id="cb611-9"><a href="相关性与相似性.html#cb611-9" tabindex="-1"></a>)</span>
<span id="cb611-10"><a href="相关性与相似性.html#cb611-10" tabindex="-1"></a></span>
<span id="cb611-11"><a href="相关性与相似性.html#cb611-11" tabindex="-1"></a><span class="co"># 胸径的空间变异（颜色表示大小）</span></span>
<span id="cb611-12"><a href="相关性与相似性.html#cb611-12" tabindex="-1"></a>dbh_colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>))(<span class="dv">100</span>)</span>
<span id="cb611-13"><a href="相关性与相似性.html#cb611-13" tabindex="-1"></a>dbh_col_idx <span class="ot">&lt;-</span> <span class="fu">cut</span>(tree_dbh, <span class="at">breaks =</span> <span class="dv">100</span>)</span>
<span id="cb611-14"><a href="相关性与相似性.html#cb611-14" tabindex="-1"></a></span>
<span id="cb611-15"><a href="相关性与相似性.html#cb611-15" tabindex="-1"></a><span class="fu">plot</span>(tree_coords,</span>
<span id="cb611-16"><a href="相关性与相似性.html#cb611-16" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> dbh_colors[dbh_col_idx],</span>
<span id="cb611-17"><a href="相关性与相似性.html#cb611-17" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;树木胸径的空间分布&quot;</span>,</span>
<span id="cb611-18"><a href="相关性与相似性.html#cb611-18" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y坐标&quot;</span></span>
<span id="cb611-19"><a href="相关性与相似性.html#cb611-19" tabindex="-1"></a>)</span>
<span id="cb611-20"><a href="相关性与相似性.html#cb611-20" tabindex="-1"></a></span>
<span id="cb611-21"><a href="相关性与相似性.html#cb611-21" tabindex="-1"></a><span class="co"># 添加图例</span></span>
<span id="cb611-22"><a href="相关性与相似性.html#cb611-22" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb611-23"><a href="相关性与相似性.html#cb611-23" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;小胸径&quot;</span>, <span class="st">&quot;大胸径&quot;</span>),</span>
<span id="cb611-24"><a href="相关性与相似性.html#cb611-24" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb611-25"><a href="相关性与相似性.html#cb611-25" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-19-1"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-19-1.png" alt="森林树木分布的空间自相关分析和蒙特卡洛检验" width="672" />
<p class="caption">
图5.15: 森林树木分布的空间自相关分析和蒙特卡洛检验
</p>
</div>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="相关性与相似性.html#cb612-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb612-2"><a href="相关性与相似性.html#cb612-2" tabindex="-1"></a></span>
<span id="cb612-3"><a href="相关性与相似性.html#cb612-3" tabindex="-1"></a><span class="co"># 进行蒙特卡洛模拟检验</span></span>
<span id="cb612-4"><a href="相关性与相似性.html#cb612-4" tabindex="-1"></a>moran_mc <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(tree_dbh, listw_weights, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb612-5"><a href="相关性与相似性.html#cb612-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Moran&#39;s I蒙特卡洛检验：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Moran&#39;s I蒙特卡洛检验：</code></pre>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="相关性与相似性.html#cb614-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(moran_mc<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## p值： 0.001</code></pre>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="相关性与相似性.html#cb616-1" tabindex="-1"></a><span class="co"># 可视化蒙特卡洛检验结果</span></span>
<span id="cb616-2"><a href="相关性与相似性.html#cb616-2" tabindex="-1"></a><span class="fu">hist</span>(moran_mc<span class="sc">$</span>res,</span>
<span id="cb616-3"><a href="相关性与相似性.html#cb616-3" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb616-4"><a href="相关性与相似性.html#cb616-4" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Moran&#39;s I的蒙特卡洛分布&quot;</span>,</span>
<span id="cb616-5"><a href="相关性与相似性.html#cb616-5" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Moran&#39;s I统计量&quot;</span></span>
<span id="cb616-6"><a href="相关性与相似性.html#cb616-6" tabindex="-1"></a>)</span>
<span id="cb616-7"><a href="相关性与相似性.html#cb616-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> moran_test<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb616-8"><a href="相关性与相似性.html#cb616-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="st">&quot;观测值&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-19-2"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-19-2.png" alt="森林树木分布的空间自相关分析和蒙特卡洛检验" width="672" />
<p class="caption">
图5.16: 森林树木分布的空间自相关分析和蒙特卡洛检验
</p>
</div>
<p><strong>生态学意义</strong>：空间自相关指数在生态学中广泛应用于检测空间聚集或分散模式，如物种分布的热点区域、种群的空间格局、环境因子的空间变异等。</p>
</div>
<div id="局部空间自相关空间异质性的识别" class="section level4 hasAnchor" number="5.3.2.3">
<h4><span class="header-section-number">5.3.2.3</span> 局部空间自相关：空间异质性的识别<a href="相关性与相似性.html#局部空间自相关空间异质性的识别" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>在研究城市绿地中鸟类物种丰富度的分布时，我们不仅关心整体的空间模式，还希望识别出具体的局部热点（高值聚集区）和冷点（低值聚集区），这需要使用局部空间自相关分析方法。</p>
<p>局部空间自相关分析是全局空间自相关分析的延伸，它专注于识别空间数据中的局部异质性模式。与全局方法提供整体空间模式不同，局部方法能够揭示空间数据中特定位置的异常值、热点、冷点和其他局部空间模式。最常用的局部空间自相关方法包括LISA（Local Indicators of Spatial Association）和Getis-Ord Gi*统计量。LISA由Luc Anselin于1995年提出，它度量每个空间单元与其邻居之间的局部空间关联程度。对于每个空间单元，LISA计算其值与邻居值的相似性，从而识别四种类型的局部空间关联：高-高聚集（热点）、低-低聚集（冷点）、高-低异常值（高值被低值包围）和低-高异常值（低值被高值包围）。</p>
<p>Getis-Ord Gi<em>统计量是另一种重要的局部空间自相关方法，专门用于识别热点和冷点。与LISA不同，Gi</em>统计量专注于检测高值或低值的空间聚集，而不区分其他类型的空间异常。Gi<em>统计量的正值表示热点（高值聚集），负值表示冷点（低值聚集），统计量的绝对值越大表示聚集程度越强。在生态学应用中，Gi</em>统计量特别适合用于识别生物多样性热点、污染热点、疾病爆发区等。</p>
<p>局部空间自相关分析在生态学中具有重要的应用价值。例如，在保护生物学中，LISA分析可以帮助识别需要优先保护的关键区域；在入侵生态学中，局部空间分析可以揭示入侵种的扩散前沿；在疾病生态学中，这些方法可以识别疾病传播的热点区域。此外，局部空间自相关分析还能帮助理解生态过程的尺度依赖性和空间异质性，为生态管理提供空间明确的决策支持。</p>
<p>进行局部空间自相关分析时，需要注意多重比较问题。由于同时检验多个局部统计量，传统的显著性水平可能需要调整，如使用Bonferroni校正或错误发现率（FDR）控制。此外，局部统计量的解释应该结合具体的研究背景和空间过程的理解，避免过度解读统计显著性。</p>
<p><strong>数学定义</strong>：</p>
<ul>
<li><strong>局部Moran’s I</strong>（LISA）：</li>
</ul>
<p><span class="math display">\[I_i = \frac{(x_i - \bar{x})}{\sum_{j=1}^{n}(x_j - \bar{x})^2/n} \sum_{j=1}^{n}w_{ij}(x_j - \bar{x})\]</span></p>
<ul>
<li><strong>Getis-Ord Gi</strong>*：</li>
</ul>
<p><span class="math display">\[G_i^* = \frac{\sum_{j=1}^{n}w_{ij}x_j}{\sum_{j=1}^{n}x_j}\]</span></p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="相关性与相似性.html#cb617-1" tabindex="-1"></a><span class="co"># 局部空间自相关示例：城市绿地鸟类物种丰富度</span></span>
<span id="cb617-2"><a href="相关性与相似性.html#cb617-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb617-3"><a href="相关性与相似性.html#cb617-3" tabindex="-1"></a></span>
<span id="cb617-4"><a href="相关性与相似性.html#cb617-4" tabindex="-1"></a><span class="co"># 模拟城市绿地数据</span></span>
<span id="cb617-5"><a href="相关性与相似性.html#cb617-5" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb617-6"><a href="相关性与相似性.html#cb617-6" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb617-7"><a href="相关性与相似性.html#cb617-7" tabindex="-1"></a></span>
<span id="cb617-8"><a href="相关性与相似性.html#cb617-8" tabindex="-1"></a>n_parks <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb617-9"><a href="相关性与相似性.html#cb617-9" tabindex="-1"></a></span>
<span id="cb617-10"><a href="相关性与相似性.html#cb617-10" tabindex="-1"></a><span class="co"># 生成公园坐标（模拟城市分布）</span></span>
<span id="cb617-11"><a href="相关性与相似性.html#cb617-11" tabindex="-1"></a>park_coords <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb617-12"><a href="相关性与相似性.html#cb617-12" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">runif</span>(n_parks, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb617-13"><a href="相关性与相似性.html#cb617-13" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">runif</span>(n_parks, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb617-14"><a href="相关性与相似性.html#cb617-14" tabindex="-1"></a>)</span>
<span id="cb617-15"><a href="相关性与相似性.html#cb617-15" tabindex="-1"></a></span>
<span id="cb617-16"><a href="相关性与相似性.html#cb617-16" tabindex="-1"></a><span class="co"># 模拟鸟类物种丰富度（具有空间聚集模式）</span></span>
<span id="cb617-17"><a href="相关性与相似性.html#cb617-17" tabindex="-1"></a><span class="co"># 创建几个热点区域</span></span>
<span id="cb617-18"><a href="相关性与相似性.html#cb617-18" tabindex="-1"></a>hotspot_centers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb617-19"><a href="相关性与相似性.html#cb617-19" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">30</span>),</span>
<span id="cb617-20"><a href="相关性与相似性.html#cb617-20" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="dv">60</span>, <span class="dv">30</span>, <span class="dv">70</span>)</span>
<span id="cb617-21"><a href="相关性与相似性.html#cb617-21" tabindex="-1"></a>)</span>
<span id="cb617-22"><a href="相关性与相似性.html#cb617-22" tabindex="-1"></a></span>
<span id="cb617-23"><a href="相关性与相似性.html#cb617-23" tabindex="-1"></a>bird_richness <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_parks)</span>
<span id="cb617-24"><a href="相关性与相似性.html#cb617-24" tabindex="-1"></a></span>
<span id="cb617-25"><a href="相关性与相似性.html#cb617-25" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_parks) {</span>
<span id="cb617-26"><a href="相关性与相似性.html#cb617-26" tabindex="-1"></a>  <span class="co"># 计算到各个热点的距离</span></span>
<span id="cb617-27"><a href="相关性与相似性.html#cb617-27" tabindex="-1"></a>  distances <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((park_coords<span class="sc">$</span>x[i] <span class="sc">-</span> hotspot_centers<span class="sc">$</span>x)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb617-28"><a href="相关性与相似性.html#cb617-28" tabindex="-1"></a>    (park_coords<span class="sc">$</span>y[i] <span class="sc">-</span> hotspot_centers<span class="sc">$</span>y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb617-29"><a href="相关性与相似性.html#cb617-29" tabindex="-1"></a></span>
<span id="cb617-30"><a href="相关性与相似性.html#cb617-30" tabindex="-1"></a>  <span class="co"># 物种丰富度与到热点的距离负相关</span></span>
<span id="cb617-31"><a href="相关性与相似性.html#cb617-31" tabindex="-1"></a>  richness_base <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="sc">-</span> <span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">min</span>(distances)</span>
<span id="cb617-32"><a href="相关性与相似性.html#cb617-32" tabindex="-1"></a></span>
<span id="cb617-33"><a href="相关性与相似性.html#cb617-33" tabindex="-1"></a>  <span class="co"># 添加随机变异</span></span>
<span id="cb617-34"><a href="相关性与相似性.html#cb617-34" tabindex="-1"></a>  bird_richness[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">5</span>, richness_base <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>))</span>
<span id="cb617-35"><a href="相关性与相似性.html#cb617-35" tabindex="-1"></a>}</span>
<span id="cb617-36"><a href="相关性与相似性.html#cb617-36" tabindex="-1"></a></span>
<span id="cb617-37"><a href="相关性与相似性.html#cb617-37" tabindex="-1"></a><span class="co"># 创建空间数据</span></span>
<span id="cb617-38"><a href="相关性与相似性.html#cb617-38" tabindex="-1"></a><span class="fu">coordinates</span>(park_coords) <span class="ot">&lt;-</span> <span class="er">~</span> x <span class="sc">+</span> y</span>
<span id="cb617-39"><a href="相关性与相似性.html#cb617-39" tabindex="-1"></a></span>
<span id="cb617-40"><a href="相关性与相似性.html#cb617-40" tabindex="-1"></a><span class="co"># 创建空间权重矩阵（基于距离的权重）</span></span>
<span id="cb617-41"><a href="相关性与相似性.html#cb617-41" tabindex="-1"></a><span class="co"># 使用距离阈值定义邻居</span></span>
<span id="cb617-42"><a href="相关性与相似性.html#cb617-42" tabindex="-1"></a>dist_threshold <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># 20单位内的公园视为邻居</span></span>
<span id="cb617-43"><a href="相关性与相似性.html#cb617-43" tabindex="-1"></a></span>
<span id="cb617-44"><a href="相关性与相似性.html#cb617-44" tabindex="-1"></a><span class="co"># 创建基于距离的邻居列表</span></span>
<span id="cb617-45"><a href="相关性与相似性.html#cb617-45" tabindex="-1"></a>nb_dist <span class="ot">&lt;-</span> <span class="fu">dnearneigh</span>(park_coords, <span class="dv">0</span>, dist_threshold)</span>
<span id="cb617-46"><a href="相关性与相似性.html#cb617-46" tabindex="-1"></a><span class="co"># 检查是否有孤立点，如果有则使用k近邻</span></span>
<span id="cb617-47"><a href="相关性与相似性.html#cb617-47" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">card</span>(nb_dist) <span class="sc">==</span> <span class="dv">0</span>)) {</span>
<span id="cb617-48"><a href="相关性与相似性.html#cb617-48" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;检测到孤立点，使用k近邻方法</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb617-49"><a href="相关性与相似性.html#cb617-49" tabindex="-1"></a>  nb_dist <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(park_coords, <span class="at">k =</span> <span class="dv">3</span>))</span>
<span id="cb617-50"><a href="相关性与相似性.html#cb617-50" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 检测到孤立点，使用k近邻方法</code></pre>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="相关性与相似性.html#cb619-1" tabindex="-1"></a>listw_dist <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb_dist, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb619-2"><a href="相关性与相似性.html#cb619-2" tabindex="-1"></a></span>
<span id="cb619-3"><a href="相关性与相似性.html#cb619-3" tabindex="-1"></a><span class="co"># 计算局部Moran&#39;s I（LISA）</span></span>
<span id="cb619-4"><a href="相关性与相似性.html#cb619-4" tabindex="-1"></a>local_moran <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(bird_richness, listw_dist)</span>
<span id="cb619-5"><a href="相关性与相似性.html#cb619-5" tabindex="-1"></a></span>
<span id="cb619-6"><a href="相关性与相似性.html#cb619-6" tabindex="-1"></a><span class="co"># 创建LISA分类</span></span>
<span id="cb619-7"><a href="相关性与相似性.html#cb619-7" tabindex="-1"></a>lisa_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb619-8"><a href="相关性与相似性.html#cb619-8" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">coordinates</span>(park_coords)[, <span class="dv">1</span>],</span>
<span id="cb619-9"><a href="相关性与相似性.html#cb619-9" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">coordinates</span>(park_coords)[, <span class="dv">2</span>],</span>
<span id="cb619-10"><a href="相关性与相似性.html#cb619-10" tabindex="-1"></a>  <span class="at">richness =</span> bird_richness,</span>
<span id="cb619-11"><a href="相关性与相似性.html#cb619-11" tabindex="-1"></a>  <span class="at">local_i =</span> local_moran[, <span class="dv">1</span>],</span>
<span id="cb619-12"><a href="相关性与相似性.html#cb619-12" tabindex="-1"></a>  <span class="at">p_value =</span> local_moran[, <span class="dv">5</span>]</span>
<span id="cb619-13"><a href="相关性与相似性.html#cb619-13" tabindex="-1"></a>)</span>
<span id="cb619-14"><a href="相关性与相似性.html#cb619-14" tabindex="-1"></a></span>
<span id="cb619-15"><a href="相关性与相似性.html#cb619-15" tabindex="-1"></a><span class="co"># 根据LISA值分类</span></span>
<span id="cb619-16"><a href="相关性与相似性.html#cb619-16" tabindex="-1"></a>lisa_results<span class="sc">$</span>lisa_type <span class="ot">&lt;-</span> <span class="st">&quot;不显著&quot;</span></span>
<span id="cb619-17"><a href="相关性与相似性.html#cb619-17" tabindex="-1"></a>lisa_results<span class="sc">$</span>lisa_type[lisa_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span></span>
<span id="cb619-18"><a href="相关性与相似性.html#cb619-18" tabindex="-1"></a>  lisa_results<span class="sc">$</span>local_i <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb619-19"><a href="相关性与相似性.html#cb619-19" tabindex="-1"></a>  lisa_results<span class="sc">$</span>richness <span class="sc">&gt;</span> <span class="fu">mean</span>(bird_richness)] <span class="ot">&lt;-</span> <span class="st">&quot;高-高&quot;</span></span>
<span id="cb619-20"><a href="相关性与相似性.html#cb619-20" tabindex="-1"></a>lisa_results<span class="sc">$</span>lisa_type[lisa_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span></span>
<span id="cb619-21"><a href="相关性与相似性.html#cb619-21" tabindex="-1"></a>  lisa_results<span class="sc">$</span>local_i <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb619-22"><a href="相关性与相似性.html#cb619-22" tabindex="-1"></a>  lisa_results<span class="sc">$</span>richness <span class="sc">&lt;</span> <span class="fu">mean</span>(bird_richness)] <span class="ot">&lt;-</span> <span class="st">&quot;低-低&quot;</span></span>
<span id="cb619-23"><a href="相关性与相似性.html#cb619-23" tabindex="-1"></a>lisa_results<span class="sc">$</span>lisa_type[lisa_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span></span>
<span id="cb619-24"><a href="相关性与相似性.html#cb619-24" tabindex="-1"></a>  lisa_results<span class="sc">$</span>local_i <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb619-25"><a href="相关性与相似性.html#cb619-25" tabindex="-1"></a>  lisa_results<span class="sc">$</span>richness <span class="sc">&gt;</span> <span class="fu">mean</span>(bird_richness)] <span class="ot">&lt;-</span> <span class="st">&quot;高-低&quot;</span></span>
<span id="cb619-26"><a href="相关性与相似性.html#cb619-26" tabindex="-1"></a>lisa_results<span class="sc">$</span>lisa_type[lisa_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span></span>
<span id="cb619-27"><a href="相关性与相似性.html#cb619-27" tabindex="-1"></a>  lisa_results<span class="sc">$</span>local_i <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb619-28"><a href="相关性与相似性.html#cb619-28" tabindex="-1"></a>  lisa_results<span class="sc">$</span>richness <span class="sc">&lt;</span> <span class="fu">mean</span>(bird_richness)] <span class="ot">&lt;-</span> <span class="st">&quot;低-高&quot;</span></span>
<span id="cb619-29"><a href="相关性与相似性.html#cb619-29" tabindex="-1"></a></span>
<span id="cb619-30"><a href="相关性与相似性.html#cb619-30" tabindex="-1"></a><span class="co"># 计算Getis-Ord Gi*</span></span>
<span id="cb619-31"><a href="相关性与相似性.html#cb619-31" tabindex="-1"></a>local_g <span class="ot">&lt;-</span> <span class="fu">localG</span>(bird_richness, listw_dist)</span>
<span id="cb619-32"><a href="相关性与相似性.html#cb619-32" tabindex="-1"></a></span>
<span id="cb619-33"><a href="相关性与相似性.html#cb619-33" tabindex="-1"></a><span class="co"># 添加Gi*结果</span></span>
<span id="cb619-34"><a href="相关性与相似性.html#cb619-34" tabindex="-1"></a>lisa_results<span class="sc">$</span>gi_star <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(local_g)</span>
<span id="cb619-35"><a href="相关性与相似性.html#cb619-35" tabindex="-1"></a>lisa_results<span class="sc">$</span>gi_type <span class="ot">&lt;-</span> <span class="st">&quot;不显著&quot;</span></span>
<span id="cb619-36"><a href="相关性与相似性.html#cb619-36" tabindex="-1"></a>lisa_results<span class="sc">$</span>gi_type[lisa_results<span class="sc">$</span>gi_star <span class="sc">&gt;</span> <span class="fl">1.96</span>] <span class="ot">&lt;-</span> <span class="st">&quot;热点&quot;</span></span>
<span id="cb619-37"><a href="相关性与相似性.html#cb619-37" tabindex="-1"></a>lisa_results<span class="sc">$</span>gi_type[lisa_results<span class="sc">$</span>gi_star <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">1.96</span>] <span class="ot">&lt;-</span> <span class="st">&quot;冷点&quot;</span></span>
<span id="cb619-38"><a href="相关性与相似性.html#cb619-38" tabindex="-1"></a></span>
<span id="cb619-39"><a href="相关性与相似性.html#cb619-39" tabindex="-1"></a><span class="co"># 可视化LISA分析结果</span></span>
<span id="cb619-40"><a href="相关性与相似性.html#cb619-40" tabindex="-1"></a><span class="co"># LISA类型分布</span></span>
<span id="cb619-41"><a href="相关性与相似性.html#cb619-41" tabindex="-1"></a><span class="fu">ggplot</span>(lisa_results, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> lisa_type, <span class="at">size =</span> richness)) <span class="sc">+</span></span>
<span id="cb619-42"><a href="相关性与相似性.html#cb619-42" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb619-43"><a href="相关性与相似性.html#cb619-43" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb619-44"><a href="相关性与相似性.html#cb619-44" tabindex="-1"></a>    <span class="st">&quot;高-高&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;低-低&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb619-45"><a href="相关性与相似性.html#cb619-45" tabindex="-1"></a>    <span class="st">&quot;高-低&quot;</span> <span class="ot">=</span> <span class="st">&quot;pink&quot;</span>, <span class="st">&quot;低-高&quot;</span> <span class="ot">=</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb619-46"><a href="相关性与相似性.html#cb619-46" tabindex="-1"></a>    <span class="st">&quot;不显著&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span></span>
<span id="cb619-47"><a href="相关性与相似性.html#cb619-47" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb619-48"><a href="相关性与相似性.html#cb619-48" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb619-49"><a href="相关性与相似性.html#cb619-49" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;鸟类物种丰富度的LISA分析&quot;</span>,</span>
<span id="cb619-50"><a href="相关性与相似性.html#cb619-50" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y坐标&quot;</span>,</span>
<span id="cb619-51"><a href="相关性与相似性.html#cb619-51" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;LISA类型&quot;</span>, <span class="at">size =</span> <span class="st">&quot;物种数&quot;</span></span>
<span id="cb619-52"><a href="相关性与相似性.html#cb619-52" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb619-53"><a href="相关性与相似性.html#cb619-53" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-20-1"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-20-1.png" alt="鸟类物种丰富度的局部空间自相关分析和热点识别" width="672" />
<p class="caption">
图5.17: 鸟类物种丰富度的局部空间自相关分析和热点识别
</p>
</div>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="相关性与相似性.html#cb620-1" tabindex="-1"></a><span class="co"># Gi*热点分析</span></span>
<span id="cb620-2"><a href="相关性与相似性.html#cb620-2" tabindex="-1"></a><span class="fu">ggplot</span>(lisa_results, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> gi_type, <span class="at">size =</span> <span class="fu">abs</span>(gi_star))) <span class="sc">+</span></span>
<span id="cb620-3"><a href="相关性与相似性.html#cb620-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb620-4"><a href="相关性与相似性.html#cb620-4" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb620-5"><a href="相关性与相似性.html#cb620-5" tabindex="-1"></a>    <span class="st">&quot;热点&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;冷点&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb620-6"><a href="相关性与相似性.html#cb620-6" tabindex="-1"></a>    <span class="st">&quot;不显著&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span></span>
<span id="cb620-7"><a href="相关性与相似性.html#cb620-7" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb620-8"><a href="相关性与相似性.html#cb620-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb620-9"><a href="相关性与相似性.html#cb620-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;鸟类物种丰富度的Getis-Ord Gi*分析&quot;</span>,</span>
<span id="cb620-10"><a href="相关性与相似性.html#cb620-10" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y坐标&quot;</span>,</span>
<span id="cb620-11"><a href="相关性与相似性.html#cb620-11" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;热点类型&quot;</span>, <span class="at">size =</span> <span class="st">&quot;|Gi*|&quot;</span></span>
<span id="cb620-12"><a href="相关性与相似性.html#cb620-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb620-13"><a href="相关性与相似性.html#cb620-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-20-2"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-20-2.png" alt="鸟类物种丰富度的局部空间自相关分析和热点识别" width="672" />
<p class="caption">
图5.18: 鸟类物种丰富度的局部空间自相关分析和热点识别
</p>
</div>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="相关性与相似性.html#cb621-1" tabindex="-1"></a><span class="co"># 统计结果摘要</span></span>
<span id="cb621-2"><a href="相关性与相似性.html#cb621-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;LISA分析结果摘要：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb621-3"><a href="相关性与相似性.html#cb621-3" tabindex="-1"></a>    <span class="st">&quot;总公园数：&quot;</span>, n_parks, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb621-4"><a href="相关性与相似性.html#cb621-4" tabindex="-1"></a>    <span class="st">&quot;显著LISA模式的数量：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb621-5"><a href="相关性与相似性.html#cb621-5" tabindex="-1"></a>    <span class="st">&quot;高-高聚集（热点）：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>lisa_type <span class="sc">==</span> <span class="st">&quot;高-高&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb621-6"><a href="相关性与相似性.html#cb621-6" tabindex="-1"></a>    <span class="st">&quot;低-低聚集（冷点）：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>lisa_type <span class="sc">==</span> <span class="st">&quot;低-低&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb621-7"><a href="相关性与相似性.html#cb621-7" tabindex="-1"></a>    <span class="st">&quot;高-低异常值：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>lisa_type <span class="sc">==</span> <span class="st">&quot;高-低&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb621-8"><a href="相关性与相似性.html#cb621-8" tabindex="-1"></a>    <span class="st">&quot;低-高异常值：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>lisa_type <span class="sc">==</span> <span class="st">&quot;低-高&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb621-9"><a href="相关性与相似性.html#cb621-9" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## LISA分析结果摘要：
## 总公园数：50
## 显著LISA模式的数量：1
## 高-高聚集（热点）：1
## 低-低聚集（冷点）：0
## 高-低异常值：0
## 低-高异常值：0</code></pre>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="相关性与相似性.html#cb623-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Getis-Ord Gi*分析结果摘要：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb623-2"><a href="相关性与相似性.html#cb623-2" tabindex="-1"></a>    <span class="st">&quot;热点数量：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>gi_type <span class="sc">==</span> <span class="st">&quot;热点&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb623-3"><a href="相关性与相似性.html#cb623-3" tabindex="-1"></a>    <span class="st">&quot;冷点数量：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>gi_type <span class="sc">==</span> <span class="st">&quot;冷点&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb623-4"><a href="相关性与相似性.html#cb623-4" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Getis-Ord Gi*分析结果摘要：
## 热点数量：1
## 冷点数量：0</code></pre>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="相关性与相似性.html#cb625-1" tabindex="-1"></a><span class="co"># 多重比较校正</span></span>
<span id="cb625-2"><a href="相关性与相似性.html#cb625-2" tabindex="-1"></a><span class="co"># 使用FDR校正p值</span></span>
<span id="cb625-3"><a href="相关性与相似性.html#cb625-3" tabindex="-1"></a>lisa_results<span class="sc">$</span>p_fdr <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(lisa_results<span class="sc">$</span>p_value, <span class="at">method =</span> <span class="st">&quot;fdr&quot;</span>)</span>
<span id="cb625-4"><a href="相关性与相似性.html#cb625-4" tabindex="-1"></a></span>
<span id="cb625-5"><a href="相关性与相似性.html#cb625-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">经过FDR校正后的显著LISA模式：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb625-6"><a href="相关性与相似性.html#cb625-6" tabindex="-1"></a>    <span class="st">&quot;数量：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>p_fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb625-7"><a href="相关性与相似性.html#cb625-7" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 经过FDR校正后的显著LISA模式：
## 数量：0</code></pre>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="相关性与相似性.html#cb627-1" tabindex="-1"></a><span class="co"># 可视化校正前后的对比</span></span>
<span id="cb627-2"><a href="相关性与相似性.html#cb627-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb627-3"><a href="相关性与相似性.html#cb627-3" tabindex="-1"></a></span>
<span id="cb627-4"><a href="相关性与相似性.html#cb627-4" tabindex="-1"></a><span class="co"># 原始p值</span></span>
<span id="cb627-5"><a href="相关性与相似性.html#cb627-5" tabindex="-1"></a><span class="fu">hist</span>(lisa_results<span class="sc">$</span>p_value,</span>
<span id="cb627-6"><a href="相关性与相似性.html#cb627-6" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb627-7"><a href="相关性与相似性.html#cb627-7" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;原始p值分布&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;p值&quot;</span></span>
<span id="cb627-8"><a href="相关性与相似性.html#cb627-8" tabindex="-1"></a>)</span>
<span id="cb627-9"><a href="相关性与相似性.html#cb627-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.05</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb627-10"><a href="相关性与相似性.html#cb627-10" tabindex="-1"></a></span>
<span id="cb627-11"><a href="相关性与相似性.html#cb627-11" tabindex="-1"></a><span class="co"># FDR校正后p值</span></span>
<span id="cb627-12"><a href="相关性与相似性.html#cb627-12" tabindex="-1"></a><span class="fu">hist</span>(lisa_results<span class="sc">$</span>p_fdr,</span>
<span id="cb627-13"><a href="相关性与相似性.html#cb627-13" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;lightgreen&quot;</span>,</span>
<span id="cb627-14"><a href="相关性与相似性.html#cb627-14" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;FDR校正后p值分布&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;校正后p值&quot;</span></span>
<span id="cb627-15"><a href="相关性与相似性.html#cb627-15" tabindex="-1"></a>)</span>
<span id="cb627-16"><a href="相关性与相似性.html#cb627-16" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.05</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-20-3"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-20-3.png" alt="鸟类物种丰富度的局部空间自相关分析和热点识别" width="672" />
<p class="caption">
图5.19: 鸟类物种丰富度的局部空间自相关分析和热点识别
</p>
</div>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="相关性与相似性.html#cb628-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><strong>生态学意义</strong>：局部空间自相关分析在生态学中广泛应用于识别局部空间模式，如生物多样性热点、物种入侵前沿、疾病爆发区、保护优先区等，为空间明确的生态管理提供科学依据。</p>
</div>
</div>
<div id="系统发育相关性" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> 系统发育相关性<a href="相关性与相似性.html#系统发育相关性" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>系统发育相关性分析是进化生态学和比较生物学中的重要工具，它考虑了物种间的系统发育关系对性状相关性的影响。由于物种共享进化历史，它们之间的性状值往往不是独立的，这种非独立性可能导致传统的统计方法产生偏差。系统发育相关性分析通过整合系统发育信息，帮助我们区分性状间的生态关系和系统发育保守性。</p>
<div id="系统发育信号进化历史的印记" class="section level4 hasAnchor" number="5.3.3.1">
<h4><span class="header-section-number">5.3.3.1</span> 系统发育信号：进化历史的印记<a href="相关性与相似性.html#系统发育信号进化历史的印记" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>在研究不同植物物种的叶片性状时，我们想要了解这些性状在系统发育树上的分布模式，即它们是否表现出系统发育信号——亲缘关系较近的物种是否具有相似的性状值。</p>
<p>系统发育信号是指性状在系统发育树上的分布模式，反映了性状的进化保守性程度。如果亲缘关系较近的物种具有相似的性状值，我们说该性状具有强烈的系统发育信号；如果性状值在系统发育树上随机分布，与亲缘关系无关，则系统发育信号较弱或不存在。系统发育信号的量化对于理解性状的进化动态和生态适应具有重要意义。</p>
<p>最常用的系统发育信号度量方法是Blomberg’s K和Pagel’s λ。Blomberg’s K由Blomberg等人于2003年提出，它比较观测到的性状在系统发育树上的方差与在布朗运动模型下的期望方差。K值等于1表示性状的进化完全符合布朗运动模型（中等系统发育信号）；K值大于1表示性状比布朗运动模型预测的更保守（强系统发育信号）；K值小于1表示性状比布朗运动模型预测的更趋同（弱系统发育信号）。K值的统计显著性通常通过置换检验来评估。</p>
<p>Pagel’s λ是另一个广泛使用的系统发育信号度量，由Pagel于1999年提出。λ参数度量系统发育树在解释性状变异中的相对重要性。λ值在0到1之间变化，其中0表示性状变异与系统发育无关（没有系统发育信号），1表示性状变异完全由系统发育关系解释（强系统发育信号）。λ值可以通过最大似然法估计，其统计显著性可以通过似然比检验来评估。</p>
<p>在生态学研究中，系统发育信号分析具有重要的应用价值。例如，在功能生态学中，系统发育信号分析可以帮助理解功能性状的进化保守性；在群落生态学中，它可以揭示群落构建中的系统发育过程；在保护生物学中，它可以指导基于系统发育多样性的保护策略。此外，系统发育信号分析还为系统发育比较方法提供了基础，确保生态关系的统计检验不受系统发育非独立性的影响。</p>
<p><strong>数学定义</strong>：</p>
<ul>
<li><strong>Blomberg’s K</strong>：</li>
</ul>
<p><span class="math display">\[K = \frac{MS_{obs}}{MS_{random}}\]</span></p>
<p>其中<span class="math inline">\(MS_{obs}\)</span>是观测到的性状在系统发育树上的均方，<span class="math inline">\(MS_{random}\)</span>是在布朗运动模型下的期望均方。</p>
<ul>
<li><strong>Pagel’s λ</strong>：</li>
</ul>
<p>通过最大化似然函数来估计：</p>
<p><span class="math display">\[L(\lambda) = -\frac{1}{2}[(n-1)\ln(2\pi) + \ln|\lambda\mathbf{C} + (1-\lambda)\mathbf{I}| + \mathbf{y}^T(\lambda\mathbf{C} + (1-\lambda)\mathbf{I})^{-1}\mathbf{y}]\]</span></p>
<p>其中<span class="math inline">\(\mathbf{C}\)</span>是系统发育协方差矩阵，<span class="math inline">\(\mathbf{I}\)</span>是单位矩阵，<span class="math inline">\(\mathbf{y}\)</span>是性状向量。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="相关性与相似性.html#cb629-1" tabindex="-1"></a><span class="co"># 系统发育信号分析示例：植物叶片性状的系统发育保守性</span></span>
<span id="cb629-2"><a href="相关性与相似性.html#cb629-2" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb629-3"><a href="相关性与相似性.html#cb629-3" tabindex="-1"></a><span class="fu">library</span>(phytools)</span>
<span id="cb629-4"><a href="相关性与相似性.html#cb629-4" tabindex="-1"></a><span class="fu">library</span>(picante)</span>
<span id="cb629-5"><a href="相关性与相似性.html#cb629-5" tabindex="-1"></a></span>
<span id="cb629-6"><a href="相关性与相似性.html#cb629-6" tabindex="-1"></a><span class="co"># 模拟系统发育树和性状数据</span></span>
<span id="cb629-7"><a href="相关性与相似性.html#cb629-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb629-8"><a href="相关性与相似性.html#cb629-8" tabindex="-1"></a></span>
<span id="cb629-9"><a href="相关性与相似性.html#cb629-9" tabindex="-1"></a><span class="co"># 生成随机系统发育树（50个物种）</span></span>
<span id="cb629-10"><a href="相关性与相似性.html#cb629-10" tabindex="-1"></a>n_species <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb629-11"><a href="相关性与相似性.html#cb629-11" tabindex="-1"></a>phy_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(n_species)</span>
<span id="cb629-12"><a href="相关性与相似性.html#cb629-12" tabindex="-1"></a></span>
<span id="cb629-13"><a href="相关性与相似性.html#cb629-13" tabindex="-1"></a><span class="co"># 模拟具有系统发育信号的性状数据</span></span>
<span id="cb629-14"><a href="相关性与相似性.html#cb629-14" tabindex="-1"></a><span class="co"># 使用布朗运动模型模拟保守性状</span></span>
<span id="cb629-15"><a href="相关性与相似性.html#cb629-15" tabindex="-1"></a>trait_conservative <span class="ot">&lt;-</span> <span class="fu">rTraitCont</span>(phy_tree, <span class="at">model =</span> <span class="st">&quot;BM&quot;</span>, <span class="at">sigma =</span> <span class="dv">1</span>)</span>
<span id="cb629-16"><a href="相关性与相似性.html#cb629-16" tabindex="-1"></a></span>
<span id="cb629-17"><a href="相关性与相似性.html#cb629-17" tabindex="-1"></a><span class="co"># 模拟没有系统发育信号的性状数据（随机性状）</span></span>
<span id="cb629-18"><a href="相关性与相似性.html#cb629-18" tabindex="-1"></a>trait_random <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_species, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb629-19"><a href="相关性与相似性.html#cb629-19" tabindex="-1"></a><span class="fu">names</span>(trait_random) <span class="ot">&lt;-</span> phy_tree<span class="sc">$</span>tip.label</span>
<span id="cb629-20"><a href="相关性与相似性.html#cb629-20" tabindex="-1"></a></span>
<span id="cb629-21"><a href="相关性与相似性.html#cb629-21" tabindex="-1"></a><span class="co"># 计算Blomberg&#39;s K</span></span>
<span id="cb629-22"><a href="相关性与相似性.html#cb629-22" tabindex="-1"></a>K_conservative <span class="ot">&lt;-</span> <span class="fu">Kcalc</span>(trait_conservative, phy_tree)</span>
<span id="cb629-23"><a href="相关性与相似性.html#cb629-23" tabindex="-1"></a>K_random <span class="ot">&lt;-</span> <span class="fu">Kcalc</span>(trait_random, phy_tree)</span>
<span id="cb629-24"><a href="相关性与相似性.html#cb629-24" tabindex="-1"></a></span>
<span id="cb629-25"><a href="相关性与相似性.html#cb629-25" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Blomberg&#39;s K分析结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb629-26"><a href="相关性与相似性.html#cb629-26" tabindex="-1"></a>    <span class="st">&quot;保守性状的K值：&quot;</span>, <span class="fu">round</span>(K_conservative, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb629-27"><a href="相关性与相似性.html#cb629-27" tabindex="-1"></a>    <span class="st">&quot;随机性状的K值：&quot;</span>, <span class="fu">round</span>(K_random, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb629-28"><a href="相关性与相似性.html#cb629-28" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## Blomberg&#39;s K分析结果：
## 保守性状的K值：1.104
## 随机性状的K值：0.168</code></pre>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="相关性与相似性.html#cb631-1" tabindex="-1"></a><span class="co"># 进行置换检验（使用phylosig函数进行置换检验）</span></span>
<span id="cb631-2"><a href="相关性与相似性.html#cb631-2" tabindex="-1"></a>K_perm_conservative <span class="ot">&lt;-</span> <span class="fu">phylosig</span>(phy_tree, trait_conservative, <span class="at">method =</span> <span class="st">&quot;K&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb631-3"><a href="相关性与相似性.html#cb631-3" tabindex="-1"></a>K_perm_random <span class="ot">&lt;-</span> <span class="fu">phylosig</span>(phy_tree, trait_random, <span class="at">method =</span> <span class="st">&quot;K&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb631-4"><a href="相关性与相似性.html#cb631-4" tabindex="-1"></a></span>
<span id="cb631-5"><a href="相关性与相似性.html#cb631-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">置换检验p值：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb631-6"><a href="相关性与相似性.html#cb631-6" tabindex="-1"></a>    <span class="st">&quot;保守性状：&quot;</span>, <span class="fu">format.pval</span>(K_perm_conservative<span class="sc">$</span>P, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb631-7"><a href="相关性与相似性.html#cb631-7" tabindex="-1"></a>    <span class="st">&quot;随机性状：&quot;</span>, <span class="fu">format.pval</span>(K_perm_random<span class="sc">$</span>P, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb631-8"><a href="相关性与相似性.html#cb631-8" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 置换检验p值：
## 保守性状：0.001
## 随机性状：0.83</code></pre>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="相关性与相似性.html#cb633-1" tabindex="-1"></a><span class="co"># 计算Pagel&#39;s λ</span></span>
<span id="cb633-2"><a href="相关性与相似性.html#cb633-2" tabindex="-1"></a>lambda_conservative <span class="ot">&lt;-</span> <span class="fu">phylosig</span>(phy_tree, trait_conservative, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb633-3"><a href="相关性与相似性.html#cb633-3" tabindex="-1"></a>lambda_random <span class="ot">&lt;-</span> <span class="fu">phylosig</span>(phy_tree, trait_random, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb633-4"><a href="相关性与相似性.html#cb633-4" tabindex="-1"></a></span>
<span id="cb633-5"><a href="相关性与相似性.html#cb633-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Pagel&#39;s λ分析结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb633-6"><a href="相关性与相似性.html#cb633-6" tabindex="-1"></a>    <span class="st">&quot;保守性状的λ值：&quot;</span>, <span class="fu">round</span>(lambda_conservative<span class="sc">$</span>lambda, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb633-7"><a href="相关性与相似性.html#cb633-7" tabindex="-1"></a>    <span class="st">&quot;随机性状的λ值：&quot;</span>, <span class="fu">round</span>(lambda_random<span class="sc">$</span>lambda, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb633-8"><a href="相关性与相似性.html#cb633-8" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Pagel&#39;s λ分析结果：
## 保守性状的λ值：1
## 随机性状的λ值：0</code></pre>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="相关性与相似性.html#cb635-1" tabindex="-1"></a><span class="co"># 进行似然比检验</span></span>
<span id="cb635-2"><a href="相关性与相似性.html#cb635-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">似然比检验p值：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb635-3"><a href="相关性与相似性.html#cb635-3" tabindex="-1"></a>    <span class="st">&quot;保守性状：&quot;</span>, <span class="fu">format.pval</span>(lambda_conservative<span class="sc">$</span>P, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb635-4"><a href="相关性与相似性.html#cb635-4" tabindex="-1"></a>    <span class="st">&quot;随机性状：&quot;</span>, <span class="fu">format.pval</span>(lambda_random<span class="sc">$</span>P, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb635-5"><a href="相关性与相似性.html#cb635-5" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 似然比检验p值：
## 保守性状：
## 随机性状：</code></pre>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="相关性与相似性.html#cb637-1" tabindex="-1"></a><span class="co"># 可视化系统发育信号</span></span>
<span id="cb637-2"><a href="相关性与相似性.html#cb637-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb637-3"><a href="相关性与相似性.html#cb637-3" tabindex="-1"></a></span>
<span id="cb637-4"><a href="相关性与相似性.html#cb637-4" tabindex="-1"></a><span class="co"># 保守性状的系统发育树</span></span>
<span id="cb637-5"><a href="相关性与相似性.html#cb637-5" tabindex="-1"></a><span class="fu">plot</span>(phy_tree, <span class="at">show.tip.label =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;系统发育树&quot;</span>)</span>
<span id="cb637-6"><a href="相关性与相似性.html#cb637-6" tabindex="-1"></a></span>
<span id="cb637-7"><a href="相关性与相似性.html#cb637-7" tabindex="-1"></a><span class="co"># 保守性状在系统发育树上的分布</span></span>
<span id="cb637-8"><a href="相关性与相似性.html#cb637-8" tabindex="-1"></a>trait_colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>))(<span class="dv">100</span>)</span>
<span id="cb637-9"><a href="相关性与相似性.html#cb637-9" tabindex="-1"></a>trait_conservative_scaled <span class="ot">&lt;-</span> (trait_conservative <span class="sc">-</span> <span class="fu">min</span>(trait_conservative)) <span class="sc">/</span></span>
<span id="cb637-10"><a href="相关性与相似性.html#cb637-10" tabindex="-1"></a>  (<span class="fu">max</span>(trait_conservative) <span class="sc">-</span> <span class="fu">min</span>(trait_conservative))</span>
<span id="cb637-11"><a href="相关性与相似性.html#cb637-11" tabindex="-1"></a></span>
<span id="cb637-12"><a href="相关性与相似性.html#cb637-12" tabindex="-1"></a><span class="fu">plot</span>(phy_tree,</span>
<span id="cb637-13"><a href="相关性与相似性.html#cb637-13" tabindex="-1"></a>  <span class="at">show.tip.label =</span> <span class="cn">FALSE</span>,</span>
<span id="cb637-14"><a href="相关性与相似性.html#cb637-14" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;保守性状的系统发育信号&quot;</span></span>
<span id="cb637-15"><a href="相关性与相似性.html#cb637-15" tabindex="-1"></a>)</span>
<span id="cb637-16"><a href="相关性与相似性.html#cb637-16" tabindex="-1"></a><span class="fu">tiplabels</span>(<span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> trait_colors[<span class="fu">round</span>(trait_conservative_scaled <span class="sc">*</span> <span class="dv">99</span>) <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb637-17"><a href="相关性与相似性.html#cb637-17" tabindex="-1"></a></span>
<span id="cb637-18"><a href="相关性与相似性.html#cb637-18" tabindex="-1"></a><span class="co"># 随机性状在系统发育树上的分布</span></span>
<span id="cb637-19"><a href="相关性与相似性.html#cb637-19" tabindex="-1"></a>trait_random_scaled <span class="ot">&lt;-</span> (trait_random <span class="sc">-</span> <span class="fu">min</span>(trait_random)) <span class="sc">/</span></span>
<span id="cb637-20"><a href="相关性与相似性.html#cb637-20" tabindex="-1"></a>  (<span class="fu">max</span>(trait_random) <span class="sc">-</span> <span class="fu">min</span>(trait_random))</span>
<span id="cb637-21"><a href="相关性与相似性.html#cb637-21" tabindex="-1"></a></span>
<span id="cb637-22"><a href="相关性与相似性.html#cb637-22" tabindex="-1"></a><span class="fu">plot</span>(phy_tree,</span>
<span id="cb637-23"><a href="相关性与相似性.html#cb637-23" tabindex="-1"></a>  <span class="at">show.tip.label =</span> <span class="cn">FALSE</span>,</span>
<span id="cb637-24"><a href="相关性与相似性.html#cb637-24" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;随机性状的系统发育信号&quot;</span></span>
<span id="cb637-25"><a href="相关性与相似性.html#cb637-25" tabindex="-1"></a>)</span>
<span id="cb637-26"><a href="相关性与相似性.html#cb637-26" tabindex="-1"></a><span class="fu">tiplabels</span>(<span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> trait_colors[<span class="fu">round</span>(trait_random_scaled <span class="sc">*</span> <span class="dv">99</span>) <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb637-27"><a href="相关性与相似性.html#cb637-27" tabindex="-1"></a></span>
<span id="cb637-28"><a href="相关性与相似性.html#cb637-28" tabindex="-1"></a><span class="co"># 性状值与系统发育距离的关系</span></span>
<span id="cb637-29"><a href="相关性与相似性.html#cb637-29" tabindex="-1"></a><span class="co"># 计算系统发育距离矩阵</span></span>
<span id="cb637-30"><a href="相关性与相似性.html#cb637-30" tabindex="-1"></a>phy_dist <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(phy_tree)</span>
<span id="cb637-31"><a href="相关性与相似性.html#cb637-31" tabindex="-1"></a></span>
<span id="cb637-32"><a href="相关性与相似性.html#cb637-32" tabindex="-1"></a><span class="co"># 保守性状的距离相关性</span></span>
<span id="cb637-33"><a href="相关性与相似性.html#cb637-33" tabindex="-1"></a>conservative_dist <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(trait_conservative))</span>
<span id="cb637-34"><a href="相关性与相似性.html#cb637-34" tabindex="-1"></a>conservative_cor <span class="ot">&lt;-</span> <span class="fu">mantel</span>(conservative_dist, phy_dist, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb637-35"><a href="相关性与相似性.html#cb637-35" tabindex="-1"></a></span>
<span id="cb637-36"><a href="相关性与相似性.html#cb637-36" tabindex="-1"></a><span class="co"># 随机性状的距离相关性</span></span>
<span id="cb637-37"><a href="相关性与相似性.html#cb637-37" tabindex="-1"></a>random_dist <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(trait_random))</span>
<span id="cb637-38"><a href="相关性与相似性.html#cb637-38" tabindex="-1"></a>random_cor <span class="ot">&lt;-</span> <span class="fu">mantel</span>(random_dist, phy_dist, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb637-39"><a href="相关性与相似性.html#cb637-39" tabindex="-1"></a></span>
<span id="cb637-40"><a href="相关性与相似性.html#cb637-40" tabindex="-1"></a><span class="fu">plot</span>(phy_dist[<span class="fu">lower.tri</span>(phy_dist)], conservative_dist[<span class="fu">lower.tri</span>(conservative_dist)],</span>
<span id="cb637-41"><a href="相关性与相似性.html#cb637-41" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;blue&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.5</span>),</span>
<span id="cb637-42"><a href="相关性与相似性.html#cb637-42" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;系统发育距离&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;性状距离&quot;</span>,</span>
<span id="cb637-43"><a href="相关性与相似性.html#cb637-43" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;性状距离与系统发育距离的关系&quot;</span></span>
<span id="cb637-44"><a href="相关性与相似性.html#cb637-44" tabindex="-1"></a>)</span>
<span id="cb637-45"><a href="相关性与相似性.html#cb637-45" tabindex="-1"></a><span class="fu">points</span>(phy_dist[<span class="fu">lower.tri</span>(phy_dist)], random_dist[<span class="fu">lower.tri</span>(random_dist)],</span>
<span id="cb637-46"><a href="相关性与相似性.html#cb637-46" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;red&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.5</span>)</span>
<span id="cb637-47"><a href="相关性与相似性.html#cb637-47" tabindex="-1"></a>)</span>
<span id="cb637-48"><a href="相关性与相似性.html#cb637-48" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb637-49"><a href="相关性与相似性.html#cb637-49" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;保守性状&quot;</span>, <span class="st">&quot;随机性状&quot;</span>),</span>
<span id="cb637-50"><a href="相关性与相似性.html#cb637-50" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb637-51"><a href="相关性与相似性.html#cb637-51" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-21"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-21-1.png" alt="植物叶片性状的系统发育信号分析和性状距离关系" width="672" />
<p class="caption">
图2.11: 植物叶片性状的系统发育信号分析和性状距离关系
</p>
</div>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="相关性与相似性.html#cb638-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Mantel检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb638-2"><a href="相关性与相似性.html#cb638-2" tabindex="-1"></a>    <span class="st">&quot;保守性状的Mantel r：&quot;</span>, <span class="fu">round</span>(conservative_cor<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb638-3"><a href="相关性与相似性.html#cb638-3" tabindex="-1"></a>    <span class="st">&quot;保守性状的p值：&quot;</span>, <span class="fu">format.pval</span>(conservative_cor<span class="sc">$</span>signif, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb638-4"><a href="相关性与相似性.html#cb638-4" tabindex="-1"></a>    <span class="st">&quot;随机性状的Mantel r：&quot;</span>, <span class="fu">round</span>(random_cor<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb638-5"><a href="相关性与相似性.html#cb638-5" tabindex="-1"></a>    <span class="st">&quot;随机性状的p值：&quot;</span>, <span class="fu">format.pval</span>(random_cor<span class="sc">$</span>signif, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb638-6"><a href="相关性与相似性.html#cb638-6" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Mantel检验结果：
## 保守性状的Mantel r：0.337
## 保守性状的p值：0.001
## 随机性状的Mantel r：-0.021
## 随机性状的p值：0.659</code></pre>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="相关性与相似性.html#cb640-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb640-2"><a href="相关性与相似性.html#cb640-2" tabindex="-1"></a></span>
<span id="cb640-3"><a href="相关性与相似性.html#cb640-3" tabindex="-1"></a><span class="co"># 比较不同系统发育信号度量方法</span></span>
<span id="cb640-4"><a href="相关性与相似性.html#cb640-4" tabindex="-1"></a>signal_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb640-5"><a href="相关性与相似性.html#cb640-5" tabindex="-1"></a>  性状类型 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;保守性状&quot;</span>, <span class="st">&quot;随机性状&quot;</span>),</span>
<span id="cb640-6"><a href="相关性与相似性.html#cb640-6" tabindex="-1"></a>  <span class="at">Blomberg_K =</span> <span class="fu">c</span>(K_conservative, K_random),</span>
<span id="cb640-7"><a href="相关性与相似性.html#cb640-7" tabindex="-1"></a>  <span class="at">Pagel_lambda =</span> <span class="fu">c</span>(lambda_conservative<span class="sc">$</span>lambda, lambda_random<span class="sc">$</span>lambda),</span>
<span id="cb640-8"><a href="相关性与相似性.html#cb640-8" tabindex="-1"></a>  <span class="at">Mantel_r =</span> <span class="fu">c</span>(conservative_cor<span class="sc">$</span>statistic, random_cor<span class="sc">$</span>statistic)</span>
<span id="cb640-9"><a href="相关性与相似性.html#cb640-9" tabindex="-1"></a>)</span>
<span id="cb640-10"><a href="相关性与相似性.html#cb640-10" tabindex="-1"></a></span>
<span id="cb640-11"><a href="相关性与相似性.html#cb640-11" tabindex="-1"></a><span class="fu">print</span>(signal_comparison)</span></code></pre></div>
<pre><code>##   性状类型 Blomberg_K Pagel_lambda    Mantel_r
## 1 保守性状   1.103624 9.999267e-01  0.33677725
## 2 随机性状   0.168321 7.331374e-05 -0.02144895</code></pre>
<p><strong>生态学意义</strong>：系统发育信号分析在生态学中广泛应用于检验性状的系统发育保守性，理解功能性状的进化动态，以及确保生态关系的统计检验不受系统发育非独立性的影响。</p>
</div>
<div id="系统发育独立对比去除系统发育影响的性状比较" class="section level4 hasAnchor" number="5.3.3.2">
<h4><span class="header-section-number">5.3.3.2</span> 系统发育独立对比：去除系统发育影响的性状比较<a href="相关性与相似性.html#系统发育独立对比去除系统发育影响的性状比较" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>在研究植物叶片氮含量与光合速率的关系时，我们需要考虑物种间的系统发育关系，因为亲缘关系较近的物种可能共享相似的性状值，这种系统发育非独立性可能使传统的相关性分析产生偏差。</p>
<p>系统发育独立对比是由Felsenstein于1985年提出的革命性方法，它通过将系统发育树转化为一组独立的对比来去除系统发育非独立性的影响。PIC方法的核心思想是：在系统发育树的每个节点处，计算从该节点分化的两个支系之间的性状差异，这些差异构成了系统发育独立对比。由于这些对比在统计上是独立的（每个对比代表系统发育树上的一个独立进化事件），它们可以安全地用于传统的统计检验，而不受系统发育非独立性的影响。</p>
<p>PIC的计算过程包括以下几个步骤：首先，从系统发育树的尖端开始，逐步向根部计算每个节点处的性状对比；其次，对每个对比进行标准化，以考虑分支长度的影响；最后，这些标准化的对比可以用于回归分析、相关性分析或其他统计检验。PIC方法的一个重要假设是性状进化符合布朗运动模型，即性状在系统发育树上的变化是随机的、无方向的。</p>
<p>在生态学研究中，PIC方法具有极其重要的应用价值。它使得我们能够在控制系统发育关系的情况下，检验性状间的生态关系、评估环境对性状的影响、以及比较不同类群的进化速率。例如，在使用PIC分析叶片氮含量与光合速率的关系时，如果去除系统发育影响后两者仍然显著相关，说明这种关系具有普遍的生态意义，而不仅仅是系统发育历史的产物。PIC方法还广泛应用于比较生物学、进化生态学和功能生态学的研究中。</p>
<p>然而，PIC方法也有一些局限性和注意事项。它假设性状进化符合布朗运动模型，对于其他进化模型可能不适用；它对于高度不平衡的系统发育树可能表现不佳；此外，PIC方法只能用于连续性状的分析。近年来，随着系统发育比较方法的发展，出现了更多先进的方法（如系统发育广义最小二乘法PGLS），但PIC仍然是理解系统发育非独立性影响的基础工具。</p>
<p><strong>数学原理</strong>：对于系统发育树上的一个节点，其两个子节点<span class="math inline">\(i\)</span>和<span class="math inline">\(j\)</span>的性状对比为：</p>
<p><span class="math display">\[contrast = \frac{x_i - x_j}{\sqrt{v_i + v_j}}\]</span></p>
<p>其中<span class="math inline">\(x_i\)</span>和<span class="math inline">\(x_j\)</span>是性状值，<span class="math inline">\(v_i\)</span>和<span class="math inline">\(v_j\)</span>是分支长度。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="相关性与相似性.html#cb642-1" tabindex="-1"></a><span class="co"># 系统发育独立对比示例：植物叶片性状的生态关系</span></span>
<span id="cb642-2"><a href="相关性与相似性.html#cb642-2" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb642-3"><a href="相关性与相似性.html#cb642-3" tabindex="-1"></a><span class="fu">library</span>(picante)</span>
<span id="cb642-4"><a href="相关性与相似性.html#cb642-4" tabindex="-1"></a></span>
<span id="cb642-5"><a href="相关性与相似性.html#cb642-5" tabindex="-1"></a><span class="co"># 模拟系统发育树和多个性状数据</span></span>
<span id="cb642-6"><a href="相关性与相似性.html#cb642-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb642-7"><a href="相关性与相似性.html#cb642-7" tabindex="-1"></a></span>
<span id="cb642-8"><a href="相关性与相似性.html#cb642-8" tabindex="-1"></a><span class="co"># 生成随机系统发育树（30个物种）</span></span>
<span id="cb642-9"><a href="相关性与相似性.html#cb642-9" tabindex="-1"></a>n_species <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb642-10"><a href="相关性与相似性.html#cb642-10" tabindex="-1"></a>phy_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(n_species)</span>
<span id="cb642-11"><a href="相关性与相似性.html#cb642-11" tabindex="-1"></a></span>
<span id="cb642-12"><a href="相关性与相似性.html#cb642-12" tabindex="-1"></a><span class="co"># 模拟相关的性状数据（具有系统发育信号）</span></span>
<span id="cb642-13"><a href="相关性与相似性.html#cb642-13" tabindex="-1"></a><span class="co"># 性状1：叶片氮含量</span></span>
<span id="cb642-14"><a href="相关性与相似性.html#cb642-14" tabindex="-1"></a>trait_nitrogen <span class="ot">&lt;-</span> <span class="fu">rTraitCont</span>(phy_tree, <span class="at">model =</span> <span class="st">&quot;BM&quot;</span>, <span class="at">sigma =</span> <span class="fl">0.5</span>)</span>
<span id="cb642-15"><a href="相关性与相似性.html#cb642-15" tabindex="-1"></a></span>
<span id="cb642-16"><a href="相关性与相似性.html#cb642-16" tabindex="-1"></a><span class="co"># 性状2：光合速率（与氮含量相关，但也受其他因素影响）</span></span>
<span id="cb642-17"><a href="相关性与相似性.html#cb642-17" tabindex="-1"></a>trait_photosynthesis <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> trait_nitrogen <span class="sc">+</span> <span class="fu">rTraitCont</span>(phy_tree, <span class="at">model =</span> <span class="st">&quot;BM&quot;</span>, <span class="at">sigma =</span> <span class="fl">0.3</span>)</span>
<span id="cb642-18"><a href="相关性与相似性.html#cb642-18" tabindex="-1"></a></span>
<span id="cb642-19"><a href="相关性与相似性.html#cb642-19" tabindex="-1"></a><span class="co"># 性状3：比叶重（与氮含量负相关）</span></span>
<span id="cb642-20"><a href="相关性与相似性.html#cb642-20" tabindex="-1"></a>trait_sla <span class="ot">&lt;-</span> <span class="dv">200</span> <span class="sc">-</span> <span class="dv">15</span> <span class="sc">*</span> trait_nitrogen <span class="sc">+</span> <span class="fu">rTraitCont</span>(phy_tree, <span class="at">model =</span> <span class="st">&quot;BM&quot;</span>, <span class="at">sigma =</span> <span class="dv">2</span>)</span>
<span id="cb642-21"><a href="相关性与相似性.html#cb642-21" tabindex="-1"></a></span>
<span id="cb642-22"><a href="相关性与相似性.html#cb642-22" tabindex="-1"></a><span class="co"># 创建性状数据框</span></span>
<span id="cb642-23"><a href="相关性与相似性.html#cb642-23" tabindex="-1"></a>trait_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb642-24"><a href="相关性与相似性.html#cb642-24" tabindex="-1"></a>  <span class="at">species =</span> phy_tree<span class="sc">$</span>tip.label,</span>
<span id="cb642-25"><a href="相关性与相似性.html#cb642-25" tabindex="-1"></a>  <span class="at">nitrogen =</span> trait_nitrogen,</span>
<span id="cb642-26"><a href="相关性与相似性.html#cb642-26" tabindex="-1"></a>  <span class="at">photosynthesis =</span> trait_photosynthesis,</span>
<span id="cb642-27"><a href="相关性与相似性.html#cb642-27" tabindex="-1"></a>  <span class="at">sla =</span> trait_sla</span>
<span id="cb642-28"><a href="相关性与相似性.html#cb642-28" tabindex="-1"></a>)</span>
<span id="cb642-29"><a href="相关性与相似性.html#cb642-29" tabindex="-1"></a></span>
<span id="cb642-30"><a href="相关性与相似性.html#cb642-30" tabindex="-1"></a><span class="co"># 传统相关性分析（忽略系统发育）</span></span>
<span id="cb642-31"><a href="相关性与相似性.html#cb642-31" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;传统相关性分析（忽略系统发育）：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 传统相关性分析（忽略系统发育）：</code></pre>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="相关性与相似性.html#cb644-1" tabindex="-1"></a>cor_traditional <span class="ot">&lt;-</span> <span class="fu">cor</span>(trait_data[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb644-2"><a href="相关性与相似性.html#cb644-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(cor_traditional, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##                nitrogen photosynthesis    sla
## nitrogen          1.000          0.497 -0.967
## photosynthesis    0.497          1.000 -0.368
## sla              -0.967         -0.368  1.000</code></pre>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="相关性与相似性.html#cb646-1" tabindex="-1"></a><span class="co"># 进行相关性检验</span></span>
<span id="cb646-2"><a href="相关性与相似性.html#cb646-2" tabindex="-1"></a>cor_test_np <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(trait_data<span class="sc">$</span>nitrogen, trait_data<span class="sc">$</span>photosynthesis)</span>
<span id="cb646-3"><a href="相关性与相似性.html#cb646-3" tabindex="-1"></a>cor_test_ns <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(trait_data<span class="sc">$</span>nitrogen, trait_data<span class="sc">$</span>sla)</span>
<span id="cb646-4"><a href="相关性与相似性.html#cb646-4" tabindex="-1"></a></span>
<span id="cb646-5"><a href="相关性与相似性.html#cb646-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">传统相关性检验：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb646-6"><a href="相关性与相似性.html#cb646-6" tabindex="-1"></a>    <span class="st">&quot;氮含量 vs 光合速率：r =&quot;</span>, <span class="fu">round</span>(cor_test_np<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb646-7"><a href="相关性与相似性.html#cb646-7" tabindex="-1"></a>    <span class="st">&quot;, p =&quot;</span>, <span class="fu">format.pval</span>(cor_test_np<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb646-8"><a href="相关性与相似性.html#cb646-8" tabindex="-1"></a>    <span class="st">&quot;氮含量 vs 比叶重：r =&quot;</span>, <span class="fu">round</span>(cor_test_ns<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb646-9"><a href="相关性与相似性.html#cb646-9" tabindex="-1"></a>    <span class="st">&quot;, p =&quot;</span>, <span class="fu">format.pval</span>(cor_test_ns<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb646-10"><a href="相关性与相似性.html#cb646-10" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 传统相关性检验：
## 氮含量 vs 光合速率：r =0.497, p =0.00519
## 氮含量 vs 比叶重：r =-0.967, p =&lt;2e-16</code></pre>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="相关性与相似性.html#cb648-1" tabindex="-1"></a><span class="co"># 系统发育独立对比分析</span></span>
<span id="cb648-2"><a href="相关性与相似性.html#cb648-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">系统发育独立对比分析：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 系统发育独立对比分析：</code></pre>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="相关性与相似性.html#cb650-1" tabindex="-1"></a><span class="co"># 计算PIC</span></span>
<span id="cb650-2"><a href="相关性与相似性.html#cb650-2" tabindex="-1"></a>pic_nitrogen <span class="ot">&lt;-</span> <span class="fu">pic</span>(trait_nitrogen, phy_tree)</span>
<span id="cb650-3"><a href="相关性与相似性.html#cb650-3" tabindex="-1"></a>pic_photosynthesis <span class="ot">&lt;-</span> <span class="fu">pic</span>(trait_photosynthesis, phy_tree)</span>
<span id="cb650-4"><a href="相关性与相似性.html#cb650-4" tabindex="-1"></a>pic_sla <span class="ot">&lt;-</span> <span class="fu">pic</span>(trait_sla, phy_tree)</span>
<span id="cb650-5"><a href="相关性与相似性.html#cb650-5" tabindex="-1"></a></span>
<span id="cb650-6"><a href="相关性与相似性.html#cb650-6" tabindex="-1"></a><span class="co"># PIC相关性分析</span></span>
<span id="cb650-7"><a href="相关性与相似性.html#cb650-7" tabindex="-1"></a>pic_cor_np <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(pic_nitrogen, pic_photosynthesis)</span>
<span id="cb650-8"><a href="相关性与相似性.html#cb650-8" tabindex="-1"></a>pic_cor_ns <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(pic_nitrogen, pic_sla)</span>
<span id="cb650-9"><a href="相关性与相似性.html#cb650-9" tabindex="-1"></a></span>
<span id="cb650-10"><a href="相关性与相似性.html#cb650-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;PIC相关性检验：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb650-11"><a href="相关性与相似性.html#cb650-11" tabindex="-1"></a>    <span class="st">&quot;氮含量 vs 光合速率：r =&quot;</span>, <span class="fu">round</span>(pic_cor_np<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb650-12"><a href="相关性与相似性.html#cb650-12" tabindex="-1"></a>    <span class="st">&quot;, p =&quot;</span>, <span class="fu">format.pval</span>(pic_cor_np<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb650-13"><a href="相关性与相似性.html#cb650-13" tabindex="-1"></a>    <span class="st">&quot;氮含量 vs 比叶重：r =&quot;</span>, <span class="fu">round</span>(pic_cor_ns<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb650-14"><a href="相关性与相似性.html#cb650-14" tabindex="-1"></a>    <span class="st">&quot;, p =&quot;</span>, <span class="fu">format.pval</span>(pic_cor_ns<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb650-15"><a href="相关性与相似性.html#cb650-15" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## PIC相关性检验：
## 氮含量 vs 光合速率：r =0.597, p =0.000635
## 氮含量 vs 比叶重：r =-0.92, p =1.78e-12</code></pre>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="相关性与相似性.html#cb652-1" tabindex="-1"></a><span class="co"># 可视化对比结果</span></span>
<span id="cb652-2"><a href="相关性与相似性.html#cb652-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb652-3"><a href="相关性与相似性.html#cb652-3" tabindex="-1"></a></span>
<span id="cb652-4"><a href="相关性与相似性.html#cb652-4" tabindex="-1"></a><span class="co"># 传统散点图</span></span>
<span id="cb652-5"><a href="相关性与相似性.html#cb652-5" tabindex="-1"></a><span class="fu">plot</span>(trait_data<span class="sc">$</span>nitrogen, trait_data<span class="sc">$</span>photosynthesis,</span>
<span id="cb652-6"><a href="相关性与相似性.html#cb652-6" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb652-7"><a href="相关性与相似性.html#cb652-7" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;叶片氮含量 (%)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;光合速率 (μmol/m²/s)&quot;</span>,</span>
<span id="cb652-8"><a href="相关性与相似性.html#cb652-8" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;传统分析：氮含量 vs 光合速率&quot;</span></span>
<span id="cb652-9"><a href="相关性与相似性.html#cb652-9" tabindex="-1"></a>)</span>
<span id="cb652-10"><a href="相关性与相似性.html#cb652-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(photosynthesis <span class="sc">~</span> nitrogen, <span class="at">data =</span> trait_data),</span>
<span id="cb652-11"><a href="相关性与相似性.html#cb652-11" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb652-12"><a href="相关性与相似性.html#cb652-12" tabindex="-1"></a>)</span>
<span id="cb652-13"><a href="相关性与相似性.html#cb652-13" tabindex="-1"></a></span>
<span id="cb652-14"><a href="相关性与相似性.html#cb652-14" tabindex="-1"></a><span class="co"># PIC散点图</span></span>
<span id="cb652-15"><a href="相关性与相似性.html#cb652-15" tabindex="-1"></a><span class="fu">plot</span>(pic_nitrogen, pic_photosynthesis,</span>
<span id="cb652-16"><a href="相关性与相似性.html#cb652-16" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb652-17"><a href="相关性与相似性.html#cb652-17" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;氮含量PIC&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;光合速率PIC&quot;</span>,</span>
<span id="cb652-18"><a href="相关性与相似性.html#cb652-18" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;PIC分析：氮含量 vs 光合速率&quot;</span></span>
<span id="cb652-19"><a href="相关性与相似性.html#cb652-19" tabindex="-1"></a>)</span>
<span id="cb652-20"><a href="相关性与相似性.html#cb652-20" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(pic_photosynthesis <span class="sc">~</span> pic_nitrogen),</span>
<span id="cb652-21"><a href="相关性与相似性.html#cb652-21" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb652-22"><a href="相关性与相似性.html#cb652-22" tabindex="-1"></a>)</span>
<span id="cb652-23"><a href="相关性与相似性.html#cb652-23" tabindex="-1"></a></span>
<span id="cb652-24"><a href="相关性与相似性.html#cb652-24" tabindex="-1"></a><span class="co"># 传统散点图：氮含量 vs 比叶重</span></span>
<span id="cb652-25"><a href="相关性与相似性.html#cb652-25" tabindex="-1"></a><span class="fu">plot</span>(trait_data<span class="sc">$</span>nitrogen, trait_data<span class="sc">$</span>sla,</span>
<span id="cb652-26"><a href="相关性与相似性.html#cb652-26" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>,</span>
<span id="cb652-27"><a href="相关性与相似性.html#cb652-27" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;叶片氮含量 (%)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;比叶重 (g/m²)&quot;</span>,</span>
<span id="cb652-28"><a href="相关性与相似性.html#cb652-28" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;传统分析：氮含量 vs 比叶重&quot;</span></span>
<span id="cb652-29"><a href="相关性与相似性.html#cb652-29" tabindex="-1"></a>)</span>
<span id="cb652-30"><a href="相关性与相似性.html#cb652-30" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(sla <span class="sc">~</span> nitrogen, <span class="at">data =</span> trait_data),</span>
<span id="cb652-31"><a href="相关性与相似性.html#cb652-31" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb652-32"><a href="相关性与相似性.html#cb652-32" tabindex="-1"></a>)</span>
<span id="cb652-33"><a href="相关性与相似性.html#cb652-33" tabindex="-1"></a></span>
<span id="cb652-34"><a href="相关性与相似性.html#cb652-34" tabindex="-1"></a><span class="co"># PIC散点图：氮含量 vs 比叶重</span></span>
<span id="cb652-35"><a href="相关性与相似性.html#cb652-35" tabindex="-1"></a><span class="fu">plot</span>(pic_nitrogen, pic_sla,</span>
<span id="cb652-36"><a href="相关性与相似性.html#cb652-36" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb652-37"><a href="相关性与相似性.html#cb652-37" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;氮含量PIC&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;比叶重PIC&quot;</span>,</span>
<span id="cb652-38"><a href="相关性与相似性.html#cb652-38" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;PIC分析：氮含量 vs 比叶重&quot;</span></span>
<span id="cb652-39"><a href="相关性与相似性.html#cb652-39" tabindex="-1"></a>)</span>
<span id="cb652-40"><a href="相关性与相似性.html#cb652-40" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(pic_sla <span class="sc">~</span> pic_nitrogen),</span>
<span id="cb652-41"><a href="相关性与相似性.html#cb652-41" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb652-42"><a href="相关性与相似性.html#cb652-42" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-22-1"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-22-1.png" alt="植物叶片性状的系统发育独立对比分析和性状关系" width="672" />
<p class="caption">
图5.20: 植物叶片性状的系统发育独立对比分析和性状关系
</p>
</div>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="相关性与相似性.html#cb653-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb653-2"><a href="相关性与相似性.html#cb653-2" tabindex="-1"></a></span>
<span id="cb653-3"><a href="相关性与相似性.html#cb653-3" tabindex="-1"></a><span class="co"># 比较传统分析和PIC分析的结果</span></span>
<span id="cb653-4"><a href="相关性与相似性.html#cb653-4" tabindex="-1"></a>results_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb653-5"><a href="相关性与相似性.html#cb653-5" tabindex="-1"></a>  关系 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;氮含量-光合速率&quot;</span>, <span class="st">&quot;氮含量-比叶重&quot;</span>),</span>
<span id="cb653-6"><a href="相关性与相似性.html#cb653-6" tabindex="-1"></a>  传统<span class="at">_r =</span> <span class="fu">c</span>(cor_test_np<span class="sc">$</span>estimate, cor_test_ns<span class="sc">$</span>estimate),</span>
<span id="cb653-7"><a href="相关性与相似性.html#cb653-7" tabindex="-1"></a>  传统<span class="at">_p =</span> <span class="fu">c</span>(cor_test_np<span class="sc">$</span>p.value, cor_test_ns<span class="sc">$</span>p.value),</span>
<span id="cb653-8"><a href="相关性与相似性.html#cb653-8" tabindex="-1"></a>  <span class="at">PIC_r =</span> <span class="fu">c</span>(pic_cor_np<span class="sc">$</span>estimate, pic_cor_ns<span class="sc">$</span>estimate),</span>
<span id="cb653-9"><a href="相关性与相似性.html#cb653-9" tabindex="-1"></a>  <span class="at">PIC_p =</span> <span class="fu">c</span>(pic_cor_np<span class="sc">$</span>p.value, pic_cor_ns<span class="sc">$</span>p.value)</span>
<span id="cb653-10"><a href="相关性与相似性.html#cb653-10" tabindex="-1"></a>)</span>
<span id="cb653-11"><a href="相关性与相似性.html#cb653-11" tabindex="-1"></a></span>
<span id="cb653-12"><a href="相关性与相似性.html#cb653-12" tabindex="-1"></a><span class="co"># 只对数值列进行四舍五入</span></span>
<span id="cb653-13"><a href="相关性与相似性.html#cb653-13" tabindex="-1"></a>results_comparison[, <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(results_comparison[, <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">4</span>)</span>
<span id="cb653-14"><a href="相关性与相似性.html#cb653-14" tabindex="-1"></a><span class="fu">print</span>(results_comparison)</span></code></pre></div>
<pre><code>##              关系  传统_r 传统_p   PIC_r PIC_p
## 1 氮含量-光合速率  0.4971 0.0052  0.5966 6e-04
## 2   氮含量-比叶重 -0.9670 0.0000 -0.9197 0e+00</code></pre>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="相关性与相似性.html#cb655-1" tabindex="-1"></a><span class="co"># 注意：PGLS分析需要caper包，这里为了简化暂时跳过</span></span>
<span id="cb655-2"><a href="相关性与相似性.html#cb655-2" tabindex="-1"></a><span class="co"># 有兴趣的读者可以自行安装caper包并运行以下代码：</span></span>
<span id="cb655-3"><a href="相关性与相似性.html#cb655-3" tabindex="-1"></a><span class="co"># library(caper)</span></span>
<span id="cb655-4"><a href="相关性与相似性.html#cb655-4" tabindex="-1"></a><span class="co"># comp_data &lt;- comparative.data(phy_tree, trait_data, names.col = &quot;species&quot;)</span></span>
<span id="cb655-5"><a href="相关性与相似性.html#cb655-5" tabindex="-1"></a><span class="co"># pgls_np &lt;- gls(photosynthesis ~ nitrogen, data = comp_data$data, correlation = corBrownian(phy = comp_data$phy))</span></span>
<span id="cb655-6"><a href="相关性与相似性.html#cb655-6" tabindex="-1"></a><span class="co"># pgls_ns &lt;- gls(sla ~ nitrogen, data = comp_data$data, correlation = corBrownian(phy = comp_data$phy))</span></span>
<span id="cb655-7"><a href="相关性与相似性.html#cb655-7" tabindex="-1"></a><span class="co"># print(summary(pgls_np))</span></span>
<span id="cb655-8"><a href="相关性与相似性.html#cb655-8" tabindex="-1"></a><span class="co"># print(summary(pgls_ns))</span></span>
<span id="cb655-9"><a href="相关性与相似性.html#cb655-9" tabindex="-1"></a></span>
<span id="cb655-10"><a href="相关性与相似性.html#cb655-10" tabindex="-1"></a><span class="co"># 可视化系统发育树和性状</span></span>
<span id="cb655-11"><a href="相关性与相似性.html#cb655-11" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb655-12"><a href="相关性与相似性.html#cb655-12" tabindex="-1"></a></span>
<span id="cb655-13"><a href="相关性与相似性.html#cb655-13" tabindex="-1"></a><span class="co"># 氮含量在系统发育树上的分布</span></span>
<span id="cb655-14"><a href="相关性与相似性.html#cb655-14" tabindex="-1"></a><span class="fu">plot</span>(phy_tree, <span class="at">show.tip.label =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;叶片氮含量的系统发育分布&quot;</span>)</span>
<span id="cb655-15"><a href="相关性与相似性.html#cb655-15" tabindex="-1"></a>nitrogen_colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>))(<span class="dv">100</span>)</span>
<span id="cb655-16"><a href="相关性与相似性.html#cb655-16" tabindex="-1"></a>nitrogen_scaled <span class="ot">&lt;-</span> (trait_nitrogen <span class="sc">-</span> <span class="fu">min</span>(trait_nitrogen)) <span class="sc">/</span></span>
<span id="cb655-17"><a href="相关性与相似性.html#cb655-17" tabindex="-1"></a>  (<span class="fu">max</span>(trait_nitrogen) <span class="sc">-</span> <span class="fu">min</span>(trait_nitrogen))</span>
<span id="cb655-18"><a href="相关性与相似性.html#cb655-18" tabindex="-1"></a><span class="fu">tiplabels</span>(<span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> nitrogen_colors[<span class="fu">round</span>(nitrogen_scaled <span class="sc">*</span> <span class="dv">99</span>) <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb655-19"><a href="相关性与相似性.html#cb655-19" tabindex="-1"></a></span>
<span id="cb655-20"><a href="相关性与相似性.html#cb655-20" tabindex="-1"></a><span class="co"># 光合速率在系统发育树上的分布</span></span>
<span id="cb655-21"><a href="相关性与相似性.html#cb655-21" tabindex="-1"></a><span class="fu">plot</span>(phy_tree, <span class="at">show.tip.label =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;光合速率的系统发育分布&quot;</span>)</span>
<span id="cb655-22"><a href="相关性与相似性.html#cb655-22" tabindex="-1"></a>photosynthesis_colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>))(<span class="dv">100</span>)</span>
<span id="cb655-23"><a href="相关性与相似性.html#cb655-23" tabindex="-1"></a>photosynthesis_scaled <span class="ot">&lt;-</span> (trait_photosynthesis <span class="sc">-</span> <span class="fu">min</span>(trait_photosynthesis)) <span class="sc">/</span></span>
<span id="cb655-24"><a href="相关性与相似性.html#cb655-24" tabindex="-1"></a>  (<span class="fu">max</span>(trait_photosynthesis) <span class="sc">-</span> <span class="fu">min</span>(trait_photosynthesis))</span>
<span id="cb655-25"><a href="相关性与相似性.html#cb655-25" tabindex="-1"></a><span class="fu">tiplabels</span>(<span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> photosynthesis_colors[<span class="fu">round</span>(photosynthesis_scaled <span class="sc">*</span> <span class="dv">99</span>) <span class="sc">+</span> <span class="dv">1</span>])</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-22-2"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-22-2.png" alt="植物叶片性状的系统发育独立对比分析和性状关系" width="672" />
<p class="caption">
图5.21: 植物叶片性状的系统发育独立对比分析和性状关系
</p>
</div>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="相关性与相似性.html#cb656-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><strong>生态学意义</strong>：系统发育独立对比分析在生态学中至关重要，它确保了性状间生态关系的统计检验不受系统发育非独立性的影响，为正确理解性状的进化关系和生态功能提供了可靠的方法。</p>
</div>
</div>
</div>
<div id="相似性与距离" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> 相似性与距离<a href="相关性与相似性.html#相似性与距离" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="常用相似性系数" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> 常用相似性系数<a href="相关性与相似性.html#常用相似性系数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在生态学研究中，群落相似性分析是理解物种分布格局、群落构建机制以及环境梯度影响的关键工具。生态学家经常面临如何量化不同样地或群落之间相似程度的问题，这需要根据数据类型和研究目的选择合适的相似性系数。</p>
<p><strong>二元数据相似性</strong>：当生态数据仅记录物种存在与否时（如植物名录、动物分布记录），二元相似性系数是理想的选择。Jaccard系数是最经典的二元相似性度量，它计算两个群落共享物种数量占所有物种数量的比例，特别适用于比较物种组成相似性。其数学定义为：<span class="math inline">\(J = \frac{a}{a+b+c}\)</span>，其中<span class="math inline">\(a\)</span>为两个群落共有的物种数，<span class="math inline">\(b\)</span>和<span class="math inline">\(c\)</span>分别为各自特有的物种数。Sørensen系数则对物种丰富度更为敏感，其定义为：<span class="math inline">\(S = \frac{2a}{2a+b+c}\)</span>，在生态学调查中广泛用于评估β多样性。这些系数在保护生物学中尤为重要，例如评估不同保护区的物种重叠程度，或者在恢复生态学中监测群落演替过程中的物种组成变化。</p>
<p><strong>数量数据相似性</strong>：当生态数据包含物种多度信息时（如个体数量、生物量、盖度等），数量相似性系数能更准确地反映群落结构差异。Bray-Curtis距离是最常用的数量相似性度量，它考虑了物种的相对多度差异，对稀有物种不敏感而对常见物种变化敏感，非常适合分析群落梯度变化。其数学定义为：<span class="math inline">\(BC = 1 - \frac{2\sum \min(x_i, y_i)}{\sum x_i + \sum y_i}\)</span>，其中<span class="math inline">\(x_i\)</span>和<span class="math inline">\(y_i\)</span>分别表示两个群落中第<span class="math inline">\(i\)</span>个物种的多度。Morisita-Horn指数则对优势物种特别敏感，能有效识别群落中的优势种变化模式，在分析人为干扰或环境压力对群落结构的影响时具有独特优势。这些数量相似性系数在环境监测、污染生态学和全球变化生态学研究中广泛应用。</p>
<p><strong>距离度量</strong>：除了专门的生态学相似性系数，传统的统计距离度量在多元生态数据分析中也发挥重要作用。欧氏距离是最基础的几何距离，计算样本在多维空间中的直线距离，适用于环境因子数据的比较分析。Mahalanobis距离则考虑了变量间的协方差结构，能更准确地反映多元数据的真实差异，在生态位分析和环境梯度研究中特别有用。这些距离度量为生态学家提供了量化样本间差异的数学工具，支持各种多元统计分析方法如聚类分析、排序分析和判别分析的实施。</p>
<p>在R语言中，这些相似性系数的计算非常便捷。对于二元数据，可以使用<code>vegan</code>包中的<code>vegdist</code>函数计算Jaccard和Sørensen系数：</p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="相关性与相似性.html#cb657-1" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb657-2"><a href="相关性与相似性.html#cb657-2" tabindex="-1"></a><span class="co"># 创建示例二元数据</span></span>
<span id="cb657-3"><a href="相关性与相似性.html#cb657-3" tabindex="-1"></a>binary_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb657-4"><a href="相关性与相似性.html#cb657-4" tabindex="-1"></a><span class="fu">rownames</span>(binary_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;样地A&quot;</span>, <span class="st">&quot;样地B&quot;</span>, <span class="st">&quot;样地C&quot;</span>)</span>
<span id="cb657-5"><a href="相关性与相似性.html#cb657-5" tabindex="-1"></a><span class="fu">colnames</span>(binary_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;物种1&quot;</span>, <span class="st">&quot;物种2&quot;</span>, <span class="st">&quot;物种3&quot;</span>, <span class="st">&quot;物种4&quot;</span>)</span>
<span id="cb657-6"><a href="相关性与相似性.html#cb657-6" tabindex="-1"></a></span>
<span id="cb657-7"><a href="相关性与相似性.html#cb657-7" tabindex="-1"></a><span class="co"># 计算Jaccard相似性</span></span>
<span id="cb657-8"><a href="相关性与相似性.html#cb657-8" tabindex="-1"></a>jaccard_dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(binary_data, <span class="at">method =</span> <span class="st">&quot;jaccard&quot;</span>, <span class="at">binary =</span> <span class="cn">TRUE</span>)</span>
<span id="cb657-9"><a href="相关性与相似性.html#cb657-9" tabindex="-1"></a><span class="co"># 计算Sørensen相似性</span></span>
<span id="cb657-10"><a href="相关性与相似性.html#cb657-10" tabindex="-1"></a>sorensen_dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(binary_data, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>, <span class="at">binary =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>对于数量数据，Bray-Curtis距离的计算同样使用<code>vegdist</code>函数：</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="相关性与相似性.html#cb658-1" tabindex="-1"></a><span class="co"># 创建示例数量数据</span></span>
<span id="cb658-2"><a href="相关性与相似性.html#cb658-2" tabindex="-1"></a>abundance_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">15</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">12</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb658-3"><a href="相关性与相似性.html#cb658-3" tabindex="-1"></a><span class="fu">rownames</span>(abundance_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;群落A&quot;</span>, <span class="st">&quot;群落B&quot;</span>, <span class="st">&quot;群落C&quot;</span>)</span>
<span id="cb658-4"><a href="相关性与相似性.html#cb658-4" tabindex="-1"></a><span class="fu">colnames</span>(abundance_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;物种1&quot;</span>, <span class="st">&quot;物种2&quot;</span>, <span class="st">&quot;物种3&quot;</span>, <span class="st">&quot;物种4&quot;</span>)</span>
<span id="cb658-5"><a href="相关性与相似性.html#cb658-5" tabindex="-1"></a></span>
<span id="cb658-6"><a href="相关性与相似性.html#cb658-6" tabindex="-1"></a><span class="co"># 计算Bray-Curtis距离</span></span>
<span id="cb658-7"><a href="相关性与相似性.html#cb658-7" tabindex="-1"></a>bray_curtis_dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(abundance_data, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span></code></pre></div>
<p>传统距离度量的计算可以使用基础R函数：</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="相关性与相似性.html#cb659-1" tabindex="-1"></a><span class="co"># 计算欧氏距离</span></span>
<span id="cb659-2"><a href="相关性与相似性.html#cb659-2" tabindex="-1"></a>euclidean_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(abundance_data, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb659-3"><a href="相关性与相似性.html#cb659-3" tabindex="-1"></a></span>
<span id="cb659-4"><a href="相关性与相似性.html#cb659-4" tabindex="-1"></a><span class="co"># 计算Mahalanobis距离（需要协方差矩阵）</span></span>
<span id="cb659-5"><a href="相关性与相似性.html#cb659-5" tabindex="-1"></a>cov_matrix <span class="ot">&lt;-</span> <span class="fu">cov</span>(abundance_data)</span>
<span id="cb659-6"><a href="相关性与相似性.html#cb659-6" tabindex="-1"></a><span class="co"># Mahalanobis距离计算较为复杂，通常用于多元统计分析</span></span></code></pre></div>
<p><strong>结果解释与生态学意义</strong>：理解相似性系数的数值含义对于正确解释生态学结果至关重要。对于相似性系数（如Jaccard、Sørensen），数值范围在0到1之间，数值越大表示群落间相似性越高。通常认为：<span class="math inline">\(J &gt; 0.75\)</span>表示高度相似，<span class="math inline">\(0.5 &lt; J \leq 0.75\)</span>表示中等相似，<span class="math inline">\(J \leq 0.5\)</span>表示低度相似。对于距离系数（如Bray-Curtis、欧氏距离），数值范围也在0到1之间（Bray-Curtis）或0到无穷大（欧氏距离），但数值越大表示差异越大。Bray-Curtis距离<span class="math inline">\(BC &lt; 0.3\)</span>通常表示群落结构相似，<span class="math inline">\(0.3 \leq BC &lt; 0.6\)</span>表示中等差异，<span class="math inline">\(BC \geq 0.6\)</span>表示显著差异。</p>
<p>在实际生态学研究中，相似性系数的解释需要考虑研究背景和生态学预期。例如，在环境梯度研究中，沿着梯度方向相似性系数的规律性变化可能反映了环境过滤的作用；在岛屿生物地理学中，距离主岛越远的岛屿与主岛的相似性越低，可能反映了扩散限制的影响。这些相似性系数和距离度量为生态学家提供了强大的工具来量化群落间的相似性和差异性，支持后续的聚类分析、排序分析等多元统计方法。</p>
</div>
<div id="功能性状间相关性" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> 功能性状间相关性<a href="相关性与相似性.html#功能性状间相关性" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>功能性状相关性分析是功能生态学的核心内容，旨在揭示植物和其他生物在进化过程中形成的性状组合模式。这些相关模式反映了生物对环境适应的策略性选择，是理解生态位分化、群落构建和生态系统功能的关键。</p>
<p><strong>功能性状相关性</strong>：功能性状间的相关性分析主要关注两个重要方面：性状间的权衡关系和协变模式。性状权衡是指生物在资源有限条件下，对多个功能性状进行权衡取舍的进化策略。例如，植物在叶片构建上需要在光合速率和防御能力之间进行权衡，快速生长的物种通常具有较低的防御投资。这种权衡关系可以用负相关关系来表示，其数学表达为：<span class="math inline">\(r_{xy} = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}}\)</span>，其中<span class="math inline">\(x_i\)</span>和<span class="math inline">\(y_i\)</span>分别表示第<span class="math inline">\(i\)</span>个个体在两个性状上的测量值。</p>
<p>功能性状的协变模式则描述了多个性状如何协同变化，形成特定的功能综合征。例如，在干旱环境中，植物往往同时表现出深根系、厚角质层和小叶面积等性状组合。这些协变模式可以通过主成分分析或多变量回归等方法进行量化。生态学上，这些相关性反映了生物对不同环境压力的适应机制，如资源获取策略、胁迫耐受策略和竞争策略等。在群落生态学中，功能性状相关性分析有助于理解物种共存机制和生态系统稳定性。</p>
<p><strong>经济型谱</strong>：经济型谱理论是功能生态学的重要框架，描述了生物在资源投资和收益之间的权衡关系。叶片经济型谱是最经典的经济型谱，它揭示了叶片性状在全球尺度上的协变规律。具体表现为叶片氮含量、比叶面积与光合速率之间的正相关关系，以及与叶片寿命之间的负相关关系。这种权衡反映了植物在快速资源获取和长期资源保存之间的策略选择，其数学关系可以用线性或非线性回归模型来描述：<span class="math inline">\(y = \beta_0 + \beta_1x + \epsilon\)</span>。</p>
<p>根系经济型谱则描述了根系功能性状的协变模式，涉及细根直径、根组织密度、根寿命等性状。通常，快速资源获取型的根系具有较细的直径、较低的组织密度和较短的寿命，而资源保存型的根系则相反。这些经济型谱的发现为理解植物功能策略的普遍模式提供了理论基础，在全球变化生态学、生物地理学和生态系统管理中具有重要应用价值。它们帮助我们预测植物群落对气候变化和人为干扰的响应，以及生态系统功能的变化趋势。</p>
<p>在R语言中，功能性状相关性分析可以通过多种统计方法实现：</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="相关性与相似性.html#cb660-1" tabindex="-1"></a><span class="co"># 创建示例功能性状数据</span></span>
<span id="cb660-2"><a href="相关性与相似性.html#cb660-2" tabindex="-1"></a>trait_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb660-3"><a href="相关性与相似性.html#cb660-3" tabindex="-1"></a>  物种 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;物种A&quot;</span>, <span class="st">&quot;物种B&quot;</span>, <span class="st">&quot;物种C&quot;</span>, <span class="st">&quot;物种D&quot;</span>, <span class="st">&quot;物种E&quot;</span>),</span>
<span id="cb660-4"><a href="相关性与相似性.html#cb660-4" tabindex="-1"></a>  比叶面积 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">15.2</span>, <span class="fl">8.7</span>, <span class="fl">22.1</span>, <span class="fl">12.5</span>, <span class="fl">18.9</span>),</span>
<span id="cb660-5"><a href="相关性与相似性.html#cb660-5" tabindex="-1"></a>  叶片氮含量 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">1.5</span>, <span class="fl">2.8</span>, <span class="fl">1.9</span>, <span class="fl">2.4</span>),</span>
<span id="cb660-6"><a href="相关性与相似性.html#cb660-6" tabindex="-1"></a>  光合速率 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">12.5</span>, <span class="fl">8.2</span>, <span class="fl">15.3</span>, <span class="fl">10.1</span>, <span class="fl">13.8</span>),</span>
<span id="cb660-7"><a href="相关性与相似性.html#cb660-7" tabindex="-1"></a>  叶片寿命 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">15</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">7</span>)</span>
<span id="cb660-8"><a href="相关性与相似性.html#cb660-8" tabindex="-1"></a>)</span>
<span id="cb660-9"><a href="相关性与相似性.html#cb660-9" tabindex="-1"></a></span>
<span id="cb660-10"><a href="相关性与相似性.html#cb660-10" tabindex="-1"></a><span class="co"># 计算性状间相关性矩阵</span></span>
<span id="cb660-11"><a href="相关性与相似性.html#cb660-11" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(trait_data[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb660-12"><a href="相关性与相似性.html#cb660-12" tabindex="-1"></a><span class="fu">print</span>(cor_matrix)</span></code></pre></div>
<pre><code>##              比叶面积 叶片氮含量   光合速率   叶片寿命
## 比叶面积    1.0000000  0.9964051  0.9906672 -0.9740756
## 叶片氮含量  0.9964051  1.0000000  0.9821403 -0.9647267
## 光合速率    0.9906672  0.9821403  1.0000000 -0.9951811
## 叶片寿命   -0.9740756 -0.9647267 -0.9951811  1.0000000</code></pre>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="相关性与相似性.html#cb662-1" tabindex="-1"></a><span class="co"># 可视化相关性矩阵</span></span>
<span id="cb662-2"><a href="相关性与相似性.html#cb662-2" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb662-3"><a href="相关性与相似性.html#cb662-3" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">&quot;circle&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-26-1"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-26-1.png" alt="功能性状相关性矩阵图和主成分分析双标图" width="672" />
<p class="caption">
图5.22: 功能性状相关性矩阵图和主成分分析双标图
</p>
</div>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="相关性与相似性.html#cb663-1" tabindex="-1"></a><span class="co"># 进行主成分分析探索性状协变模式</span></span>
<span id="cb663-2"><a href="相关性与相似性.html#cb663-2" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(trait_data[, <span class="sc">-</span><span class="dv">1</span>], <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb663-3"><a href="相关性与相似性.html#cb663-3" tabindex="-1"></a><span class="fu">summary</span>(pca_result)</span></code></pre></div>
<pre><code>## Importance of components:
##                           PC1     PC2     PC3     PC4
## Standard deviation     1.9879 0.21125 0.05922 0.01483
## Proportion of Variance 0.9879 0.01116 0.00088 0.00006
## Cumulative Proportion  0.9879 0.99907 0.99994 1.00000</code></pre>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="相关性与相似性.html#cb665-1" tabindex="-1"></a><span class="fu">biplot</span>(pca_result)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-26-2"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-26-2.png" alt="功能性状相关性矩阵图和主成分分析双标图" width="672" />
<p class="caption">
图5.23: 功能性状相关性矩阵图和主成分分析双标图
</p>
</div>
<p>对于经济型谱分析，可以使用线性模型来检验性状间的权衡关系：</p>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="相关性与相似性.html#cb666-1" tabindex="-1"></a><span class="co"># 检验叶片经济型谱关系</span></span>
<span id="cb666-2"><a href="相关性与相似性.html#cb666-2" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(光合速率 <span class="sc">~</span> 比叶面积, <span class="at">data =</span> trait_data)</span>
<span id="cb666-3"><a href="相关性与相似性.html#cb666-3" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = 光合速率 ~ 比叶面积, data = trait_data)
## 
## Residuals:
##        1        2        3        4        5 
##  0.67030 -0.14053 -0.23359 -0.28035 -0.01584 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  3.67040    0.68983   5.321  0.01297 * 
## 比叶面积     0.53680    0.04264  12.589  0.00108 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4481 on 3 degrees of freedom
## Multiple R-squared:  0.9814, Adjusted R-squared:  0.9752 
## F-statistic: 158.5 on 1 and 3 DF,  p-value: 0.001081</code></pre>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="相关性与相似性.html#cb668-1" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(叶片寿命 <span class="sc">~</span> 比叶面积, <span class="at">data =</span> trait_data)</span>
<span id="cb668-2"><a href="相关性与相似性.html#cb668-2" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = 叶片寿命 ~ 比叶面积, data = trait_data)
## 
## Residuals:
##       1       2       3       4       5 
## -1.6096  0.5258  0.5545  0.3697  0.1596 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  20.9853     1.6234  12.926 0.000999 ***
## 比叶面积     -0.7484     0.1004  -7.458 0.004991 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.055 on 3 degrees of freedom
## Multiple R-squared:  0.9488, Adjusted R-squared:  0.9318 
## F-statistic: 55.62 on 1 and 3 DF,  p-value: 0.004991</code></pre>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="相关性与相似性.html#cb670-1" tabindex="-1"></a><span class="co"># 可视化经济型谱关系</span></span>
<span id="cb670-2"><a href="相关性与相似性.html#cb670-2" tabindex="-1"></a><span class="fu">plot</span>(trait_data<span class="sc">$</span>比叶面积, trait_data<span class="sc">$</span>光合速率,</span>
<span id="cb670-3"><a href="相关性与相似性.html#cb670-3" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;比叶面积&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;光合速率&quot;</span>,</span>
<span id="cb670-4"><a href="相关性与相似性.html#cb670-4" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;叶片经济型谱：比叶面积与光合速率关系&quot;</span></span>
<span id="cb670-5"><a href="相关性与相似性.html#cb670-5" tabindex="-1"></a>)</span>
<span id="cb670-6"><a href="相关性与相似性.html#cb670-6" tabindex="-1"></a><span class="fu">abline</span>(model1, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-27"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-27-1.png" alt="叶片经济型谱关系散点图" width="672" />
<p class="caption">
图2.17: 叶片经济型谱关系散点图
</p>
</div>
<p><strong>结果解释与生态学意义</strong>：功能性状相关性分析的结果解释需要结合相关系数的数值大小、显著性水平和生态学背景。相关系数<span class="math inline">\(r\)</span>的绝对值大小反映了性状间关系的强度：<span class="math inline">\(|r| &gt; 0.7\)</span>表示强相关，<span class="math inline">\(0.5 &lt; |r| \leq 0.7\)</span>表示中等相关，<span class="math inline">\(0.3 &lt; |r| \leq 0.5\)</span>表示弱相关，<span class="math inline">\(|r| \leq 0.3\)</span>表示无实质性相关。相关系数的正负号指示了关系的方向：正相关表示性状间协同变化，负相关表示性状间存在权衡关系。</p>
<p>在生态学解释中，显著的正相关可能反映了功能综合征的存在，如快速生长策略相关的性状组合；显著的负相关则可能指示资源分配上的权衡，如在防御和生长之间的投资权衡。主成分分析中，前几个主成分的方差贡献率反映了数据的主要变异方向，通常认为累计方差贡献率超过70%的主成分能够较好地代表原始数据的变异结构。这些分析方法为生态学家提供了强大的工具来量化功能性状间的相关模式，揭示生物适应策略的普遍规律。</p>
</div>
<div id="种内相关性" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> 种内相关性<a href="相关性与相似性.html#种内相关性" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>种内相关性分析关注同一物种个体在空间上的分布模式及其形成机制，是理解种群生态学过程和环境适应策略的重要工具。空间分布模式反映了物种的繁殖特性、扩散能力以及对环境异质性的响应。</p>
<p><strong>空间分布模式</strong>：物种的空间分布主要有三种基本模式：聚集分布、随机分布和均匀分布。聚集分布表现为个体在某些区域集中分布，形成斑块状格局，这通常由有限的种子扩散、克隆生长、环境异质性或社会行为等因素导致。其数学描述可以通过空间点过程模型来表示，如泊松聚类过程。随机分布则表现为个体在空间上无规律地分布，符合完全空间随机性假设，数学上可以用齐次泊松过程来描述：<span class="math inline">\(P(N(A)=k) = \frac{(\lambda|A|)^k e^{-\lambda|A|}}{k!}\)</span>，其中<span class="math inline">\(\lambda\)</span>为强度参数，<span class="math inline">\(|A|\)</span>为区域面积。均匀分布表现为个体在空间上等距分布，通常由强烈的种内竞争或领地行为导致。</p>
<p>这些分布模式的生态学意义在于它们反映了种内相互作用和环境异质性的综合影响。聚集分布常见于依赖母树扩散的植物物种或具有社会行为的动物种群；随机分布通常出现在环境均质且个体间无相互作用的条件下；均匀分布则多见于资源竞争激烈的环境中。</p>
<p><strong>聚集指数</strong>：为了量化空间分布模式，生态学家开发了多种聚集指数。方差均值比是最基础的聚集度检验方法，其定义为：<span class="math inline">\(I = \frac{s^2}{\bar{x}}\)</span>，其中<span class="math inline">\(s^2\)</span>为样本方差，<span class="math inline">\(\bar{x}\)</span>为样本均值。当<span class="math inline">\(I &gt; 1\)</span>时表示聚集分布，<span class="math inline">\(I = 1\)</span>时表示随机分布，<span class="math inline">\(I &lt; 1\)</span>时表示均匀分布。Morisita指数是另一种常用的空间聚集度量，其定义为：<span class="math inline">\(I_\delta = n \frac{\sum x_i(x_i-1)}{N(N-1)}\)</span>，其中<span class="math inline">\(n\)</span>为样方数，<span class="math inline">\(x_i\)</span>为第<span class="math inline">\(i\)</span>个样方中的个体数，<span class="math inline">\(N\)</span>为总个体数。Morisita指数对样本大小不敏感，在生态学调查中应用广泛。</p>
<p>这些聚集指数的生态学意义在于它们能够量化种内空间分布模式，为理解种群动态、资源利用策略和种内竞争提供定量依据。在保护生物学中，聚集指数有助于评估物种的生存状况和制定有效的保护策略。</p>
<p>在R语言中，种内空间分布分析可以通过以下方法实现：</p>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="相关性与相似性.html#cb671-1" tabindex="-1"></a><span class="co"># 创建示例空间分布数据</span></span>
<span id="cb671-2"><a href="相关性与相似性.html#cb671-2" tabindex="-1"></a>spatial_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">5</span>) <span class="co"># 10个样方中的个体数</span></span>
<span id="cb671-3"><a href="相关性与相似性.html#cb671-3" tabindex="-1"></a></span>
<span id="cb671-4"><a href="相关性与相似性.html#cb671-4" tabindex="-1"></a><span class="co"># 计算方差均值比</span></span>
<span id="cb671-5"><a href="相关性与相似性.html#cb671-5" tabindex="-1"></a>mean_count <span class="ot">&lt;-</span> <span class="fu">mean</span>(spatial_data)</span>
<span id="cb671-6"><a href="相关性与相似性.html#cb671-6" tabindex="-1"></a>variance_count <span class="ot">&lt;-</span> <span class="fu">var</span>(spatial_data)</span>
<span id="cb671-7"><a href="相关性与相似性.html#cb671-7" tabindex="-1"></a>variance_mean_ratio <span class="ot">&lt;-</span> variance_count <span class="sc">/</span> mean_count</span>
<span id="cb671-8"><a href="相关性与相似性.html#cb671-8" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;方差均值比:&quot;</span>, variance_mean_ratio))</span></code></pre></div>
<pre><code>## [1] &quot;方差均值比: 1.60992907801418&quot;</code></pre>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="相关性与相似性.html#cb673-1" tabindex="-1"></a><span class="co"># 计算Morisita指数</span></span>
<span id="cb673-2"><a href="相关性与相似性.html#cb673-2" tabindex="-1"></a>n_quadrats <span class="ot">&lt;-</span> <span class="fu">length</span>(spatial_data)</span>
<span id="cb673-3"><a href="相关性与相似性.html#cb673-3" tabindex="-1"></a>total_individuals <span class="ot">&lt;-</span> <span class="fu">sum</span>(spatial_data)</span>
<span id="cb673-4"><a href="相关性与相似性.html#cb673-4" tabindex="-1"></a>numerator <span class="ot">&lt;-</span> n_quadrats <span class="sc">*</span> <span class="fu">sum</span>(spatial_data <span class="sc">*</span> (spatial_data <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb673-5"><a href="相关性与相似性.html#cb673-5" tabindex="-1"></a>denominator <span class="ot">&lt;-</span> total_individuals <span class="sc">*</span> (total_individuals <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb673-6"><a href="相关性与相似性.html#cb673-6" tabindex="-1"></a>morisita_index <span class="ot">&lt;-</span> numerator <span class="sc">/</span> denominator</span>
<span id="cb673-7"><a href="相关性与相似性.html#cb673-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Morisita指数:&quot;</span>, morisita_index))</span></code></pre></div>
<pre><code>## [1] &quot;Morisita指数: 1.11933395004625&quot;</code></pre>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="相关性与相似性.html#cb675-1" tabindex="-1"></a><span class="co"># 判断分布模式</span></span>
<span id="cb675-2"><a href="相关性与相似性.html#cb675-2" tabindex="-1"></a><span class="cf">if</span> (variance_mean_ratio <span class="sc">&gt;</span> <span class="fl">1.2</span>) {</span>
<span id="cb675-3"><a href="相关性与相似性.html#cb675-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;分布模式：聚集分布&quot;</span>)</span>
<span id="cb675-4"><a href="相关性与相似性.html#cb675-4" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (variance_mean_ratio <span class="sc">&lt;</span> <span class="fl">0.8</span>) {</span>
<span id="cb675-5"><a href="相关性与相似性.html#cb675-5" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;分布模式：均匀分布&quot;</span>)</span>
<span id="cb675-6"><a href="相关性与相似性.html#cb675-6" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb675-7"><a href="相关性与相似性.html#cb675-7" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;分布模式：随机分布&quot;</span>)</span>
<span id="cb675-8"><a href="相关性与相似性.html#cb675-8" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;分布模式：聚集分布&quot;</code></pre>
<p><strong>结果解释与生态学意义</strong>：空间分布模式的分析结果需要结合聚集指数的数值和统计显著性来解释。方差均值比<span class="math inline">\(I\)</span>的判断标准为：<span class="math inline">\(I &gt; 1.2\)</span>表示聚集分布，<span class="math inline">\(0.8 \leq I \leq 1.2\)</span>表示随机分布，<span class="math inline">\(I &lt; 0.8\)</span>表示均匀分布。Morisita指数的判断标准类似：<span class="math inline">\(I_\delta &gt; 1\)</span>表示聚集分布，<span class="math inline">\(I_\delta = 1\)</span>表示随机分布，<span class="math inline">\(I_\delta &lt; 1\)</span>表示均匀分布。</p>
<p>在生态学解释中，聚集分布通常指示存在环境异质性、有限的扩散能力或社会行为；随机分布可能出现在环境均质且个体间无相互作用的条件下；均匀分布则通常由强烈的种内竞争导致。这些分布模式的识别对于理解种群动态、设计抽样方案和制定保护策略具有重要意义。例如，对于聚集分布的物种，保护措施需要关注其核心分布区；对于均匀分布的物种，则需要考虑其竞争机制和资源利用策略。这些分析方法为生态学家提供了量化种内空间分布模式的工具，支持种群生态学和保护生物学研究。</p>
</div>
<div id="种间相关性" class="section level3 hasAnchor" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> 种间相关性<a href="相关性与相似性.html#种间相关性" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>种间相关性分析是群落生态学的核心内容，旨在揭示不同物种在空间分布、资源利用和生态功能上的相互关系。这些关系反映了物种间的竞争、互利、捕食等生态过程，是理解群落构建机制和生态系统稳定性的关键。</p>
<p><strong>种间关联</strong>：种间关联主要分为三种类型：正相关、负相关和不相关。正相关表现为两个物种在空间上倾向于共同出现，这可能源于互利共生关系、相似的环境需求或共同的扩散限制。数学上可以用相关系数或关联指数来量化：<span class="math inline">\(\phi = \frac{ad-bc}{\sqrt{(a+b)(c+d)(a+c)(b+d)}}\)</span>，其中<span class="math inline">\(a,b,c,d\)</span>为2×2列联表中的频数。负相关则表现为两个物种在空间上相互排斥，通常由竞争排斥、化感作用或不同的生态位需求导致。不相关则表示两个物种的分布相互独立，没有显著的生态联系。</p>
<p>这些关联模式的生态学意义在于它们反映了物种间相互作用的性质和强度。正相关可能指示物种间的协同进化或生态位重叠，负相关则暗示强烈的竞争或生态位分化。在恢复生态学中，种间关联分析有助于设计合理的物种配置方案；在保护生物学中，它有助于识别关键物种和功能群。</p>
<p><strong>生态网络构建</strong>：基于种间相关性可以构建生态网络，从而可视化物种间相互作用的复杂结构。网络构建通常基于相关性矩阵，通过设定阈值将显著的相关关系转化为网络边。网络拓扑特征分析包括度分布、聚类系数、模块性等指标的计算。度分布描述了物种连接数的分布规律，数学上可以用幂律分布<span class="math inline">\(P(k) \sim k^{-\gamma}\)</span>来拟合。聚类系数衡量了网络中三角形的比例，反映了物种间相互作用的局部聚集性。模块性则量化了网络被划分为相对独立模块的程度。</p>
<p>这些网络特征的生态学意义在于它们揭示了物种间相互作用的结构特性。高度模块化的网络可能反映了生态系统的功能分区，而高聚类系数则暗示了物种间的功能互补。在网络生态学中，这些分析有助于理解生态系统的稳定性和恢复力，预测物种灭绝的级联效应。</p>
<p>在R语言中，种间相关性分析和生态网络构建可以通过以下方法实现：</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="相关性与相似性.html#cb677-1" tabindex="-1"></a><span class="co"># 创建示例种间关联数据</span></span>
<span id="cb677-2"><a href="相关性与相似性.html#cb677-2" tabindex="-1"></a>species_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb677-3"><a href="相关性与相似性.html#cb677-3" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="co"># 物种A在5个样地的分布</span></span>
<span id="cb677-4"><a href="相关性与相似性.html#cb677-4" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="co"># 物种B</span></span>
<span id="cb677-5"><a href="相关性与相似性.html#cb677-5" tabindex="-1"></a>  <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="co"># 物种C</span></span>
<span id="cb677-6"><a href="相关性与相似性.html#cb677-6" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span> <span class="co"># 物种D</span></span>
<span id="cb677-7"><a href="相关性与相似性.html#cb677-7" tabindex="-1"></a>), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb677-8"><a href="相关性与相似性.html#cb677-8" tabindex="-1"></a><span class="fu">rownames</span>(species_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;物种A&quot;</span>, <span class="st">&quot;物种B&quot;</span>, <span class="st">&quot;物种C&quot;</span>, <span class="st">&quot;物种D&quot;</span>)</span>
<span id="cb677-9"><a href="相关性与相似性.html#cb677-9" tabindex="-1"></a></span>
<span id="cb677-10"><a href="相关性与相似性.html#cb677-10" tabindex="-1"></a><span class="co"># 计算种间关联矩阵</span></span>
<span id="cb677-11"><a href="相关性与相似性.html#cb677-11" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb677-12"><a href="相关性与相似性.html#cb677-12" tabindex="-1"></a>association_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">t</span>(species_data))</span>
<span id="cb677-13"><a href="相关性与相似性.html#cb677-13" tabindex="-1"></a><span class="fu">print</span>(association_matrix)</span></code></pre></div>
<pre><code>##            物种A      物种B      物种C      物种D
## 物种A  1.0000000 -0.4082483 -0.6666667  0.6123724
## 物种B -0.4082483  1.0000000 -0.4082483 -0.2500000
## 物种C -0.6666667 -0.4082483  1.0000000 -0.4082483
## 物种D  0.6123724 -0.2500000 -0.4082483  1.0000000</code></pre>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="相关性与相似性.html#cb679-1" tabindex="-1"></a><span class="co"># 构建生态网络</span></span>
<span id="cb679-2"><a href="相关性与相似性.html#cb679-2" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb679-3"><a href="相关性与相似性.html#cb679-3" tabindex="-1"></a><span class="co"># 设定相关性阈值</span></span>
<span id="cb679-4"><a href="相关性与相似性.html#cb679-4" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb679-5"><a href="相关性与相似性.html#cb679-5" tabindex="-1"></a>adj_matrix <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(association_matrix) <span class="sc">&gt;</span> threshold, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb679-6"><a href="相关性与相似性.html#cb679-6" tabindex="-1"></a><span class="fu">diag</span>(adj_matrix) <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># 移除自连接</span></span>
<span id="cb679-7"><a href="相关性与相似性.html#cb679-7" tabindex="-1"></a></span>
<span id="cb679-8"><a href="相关性与相似性.html#cb679-8" tabindex="-1"></a><span class="co"># 创建网络对象</span></span>
<span id="cb679-9"><a href="相关性与相似性.html#cb679-9" tabindex="-1"></a>network <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(adj_matrix, <span class="at">mode =</span> <span class="st">&quot;undirected&quot;</span>)</span>
<span id="cb679-10"><a href="相关性与相似性.html#cb679-10" tabindex="-1"></a></span>
<span id="cb679-11"><a href="相关性与相似性.html#cb679-11" tabindex="-1"></a><span class="co"># 计算网络拓扑特征</span></span>
<span id="cb679-12"><a href="相关性与相似性.html#cb679-12" tabindex="-1"></a>degree_dist <span class="ot">&lt;-</span> <span class="fu">degree</span>(network)</span>
<span id="cb679-13"><a href="相关性与相似性.html#cb679-13" tabindex="-1"></a>clustering_coef <span class="ot">&lt;-</span> <span class="fu">transitivity</span>(network, <span class="at">type =</span> <span class="st">&quot;global&quot;</span>)</span>
<span id="cb679-14"><a href="相关性与相似性.html#cb679-14" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;平均度:&quot;</span>, <span class="fu">mean</span>(degree_dist)))</span></code></pre></div>
<pre><code>## [1] &quot;平均度: 2.5&quot;</code></pre>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="相关性与相似性.html#cb681-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;聚类系数:&quot;</span>, clustering_coef))</span></code></pre></div>
<pre><code>## [1] &quot;聚类系数: 0.75&quot;</code></pre>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="相关性与相似性.html#cb683-1" tabindex="-1"></a><span class="co"># 可视化网络</span></span>
<span id="cb683-2"><a href="相关性与相似性.html#cb683-2" tabindex="-1"></a><span class="fu">plot</span>(network,</span>
<span id="cb683-3"><a href="相关性与相似性.html#cb683-3" tabindex="-1"></a>  <span class="at">vertex.size =</span> <span class="dv">15</span>, <span class="at">vertex.color =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb683-4"><a href="相关性与相似性.html#cb683-4" tabindex="-1"></a>  <span class="at">edge.color =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">main =</span> <span class="st">&quot;种间关联网络&quot;</span></span>
<span id="cb683-5"><a href="相关性与相似性.html#cb683-5" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-29"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-29-1.png" alt="种间关联网络图" width="672" />
<p class="caption">
图2.19: 种间关联网络图
</p>
</div>
<p><strong>结果解释与生态学意义</strong>：种间相关性分析的结果解释需要结合相关系数的数值、显著性水平和生态学机制。对于种间关联系数<span class="math inline">\(\phi\)</span>，通常认为：<span class="math inline">\(|\phi| &gt; 0.3\)</span>表示强关联，<span class="math inline">\(0.2 &lt; |\phi| \leq 0.3\)</span>表示中等关联，<span class="math inline">\(|\phi| \leq 0.2\)</span>表示弱关联。正关联<span class="math inline">\(\phi &gt; 0\)</span>表示物种倾向于共同出现，可能源于互利共生或相似的环境需求；负关联<span class="math inline">\(\phi &lt; 0\)</span>表示物种相互排斥，可能源于竞争或不同的生态位需求。</p>
<p>在网络分析中，度分布的特征反映了物种在群落中的连接性，幂律分布<span class="math inline">\(\gamma &gt; 2\)</span>的网络通常具有较好的稳定性。聚类系数<span class="math inline">\(C &gt; 0.5\)</span>表示网络中三角形结构丰富，可能反映了功能互补的物种组合。模块性<span class="math inline">\(Q &gt; 0.3\)</span>通常被认为是显著的模块结构，反映了生态系统的功能分区。这些网络特征有助于理解生态系统的稳定性和功能组织，为保护关键物种和维持生态系统功能提供科学依据。这些分析方法为生态学家提供了研究种间相互作用的定量工具，支持群落生态学和生态系统管理研究。</p>
</div>
<div id="群落相似性" class="section level3 hasAnchor" number="5.4.5">
<h3><span class="header-section-number">5.4.5</span> 群落相似性<a href="相关性与相似性.html#群落相似性" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>群落相似性分析是生态学中研究群落组成变化和空间格局的核心方法，涉及多种统计技术来量化和可视化群落间的相似性和差异性。这些方法帮助生态学家理解环境梯度、地理距离和历史因素对群落构建的影响。</p>
<p><strong>Mantel检验</strong>：Mantel检验是一种用于检验两个距离矩阵相关性的统计方法，在生态学中常用于检验环境距离与群落距离之间的关系。其基本原理是通过置换检验评估两个矩阵元素间的相关性显著性，数学上计算Mantel统计量：<span class="math inline">\(r_M = \frac{\sum_{i&lt;j}(x_{ij}-\bar{x})(y_{ij}-\bar{y})}{\sqrt{\sum_{i&lt;j}(x_{ij}-\bar{x})^2\sum_{i&lt;j}(y_{ij}-\bar{y})^2}}\)</span>，其中<span class="math inline">\(x_{ij}\)</span>和<span class="math inline">\(y_{ij}\)</span>分别为两个距离矩阵中的元素。生态学意义在于Mantel检验能够识别环境过滤、扩散限制等生态过程对群落构建的相对贡献，是群落生态学中空间分析的重要工具。</p>
<p><strong>排序分析（ordination）</strong>：排序分析是一类降维技术，用于在低维空间中可视化高维的群落数据。主成分分析（PCA）适用于线性响应的环境梯度，通过特征值分解找到数据变异的主要方向，数学上求解协方差矩阵的特征向量：<span class="math inline">\(\Sigma v = \lambda v\)</span>。对应分析（CA）基于卡方距离，更适合物种多度数据，能够同时排序样方和物种。非度量多维标度（NMDS）基于秩次距离，不假设线性关系，对异常值不敏感，通过迭代优化使排序空间中的距离与原始距离矩阵尽可能一致。这些排序方法的生态学意义在于它们能够可视化群落结构和环境梯度，识别主导的生态过程和环境因子。</p>
<p><strong>聚类分析（clustering）</strong>：聚类分析用于识别群落类型和进行生态区划。层次聚类基于距离矩阵构建树状结构，常用方法包括单连接、完全连接和平均连接法，通过逐层合并最相似的样本形成聚类树。k均值聚类是一种划分方法，通过迭代优化将样本划分为k个簇，最小化簇内平方和：<span class="math inline">\(\sum_{i=1}^k\sum_{x\in C_i}||x-\mu_i||^2\)</span>。这些聚类方法的生态学意义在于它们能够识别群落类型和生态区划，为生物多样性保护和生态系统管理提供科学依据。</p>
<p><strong>Beta多样性</strong>：Beta多样性量化了群落组成在空间或时间上的变化，反映了物种周转和嵌套性两个组分。基于距离矩阵的方法如Bray-Curtis距离可以直接计算群落差异，而基于组分分解的方法可以将Beta多样性分解为物种周转（物种替换）和嵌套性（物种丢失）两部分：<span class="math inline">\(\beta_{total} = \beta_{turnover} + \beta_{nestedness}\)</span>。生态学意义在于Beta多样性分析能够揭示生物多样性形成的机制，如环境过滤、扩散限制和生态位过程，是理解生物地理格局和生态系统功能的关键。</p>
<p>在R语言中，群落相似性分析可以通过以下方法实现：</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="相关性与相似性.html#cb684-1" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb684-2"><a href="相关性与相似性.html#cb684-2" tabindex="-1"></a></span>
<span id="cb684-3"><a href="相关性与相似性.html#cb684-3" tabindex="-1"></a><span class="co"># 创建示例群落数据</span></span>
<span id="cb684-4"><a href="相关性与相似性.html#cb684-4" tabindex="-1"></a>community_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb684-5"><a href="相关性与相似性.html#cb684-5" tabindex="-1"></a>  <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">15</span>, <span class="co"># 样地1的物种多度</span></span>
<span id="cb684-6"><a href="相关性与相似性.html#cb684-6" tabindex="-1"></a>  <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="co"># 样地2</span></span>
<span id="cb684-7"><a href="相关性与相似性.html#cb684-7" tabindex="-1"></a>  <span class="dv">15</span>, <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="co"># 样地3</span></span>
<span id="cb684-8"><a href="相关性与相似性.html#cb684-8" tabindex="-1"></a>  <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">18</span>, <span class="co"># 样地4</span></span>
<span id="cb684-9"><a href="相关性与相似性.html#cb684-9" tabindex="-1"></a>  <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="co"># 样地5</span></span>
<span id="cb684-10"><a href="相关性与相似性.html#cb684-10" tabindex="-1"></a>  <span class="dv">12</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">7</span>, <span class="co"># 样地6</span></span>
<span id="cb684-11"><a href="相关性与相似性.html#cb684-11" tabindex="-1"></a>  <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">14</span>, <span class="co"># 样地7</span></span>
<span id="cb684-12"><a href="相关性与相似性.html#cb684-12" tabindex="-1"></a>  <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">11</span>, <span class="dv">7</span>, <span class="dv">9</span> <span class="co"># 样地8</span></span>
<span id="cb684-13"><a href="相关性与相似性.html#cb684-13" tabindex="-1"></a>), <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb684-14"><a href="相关性与相似性.html#cb684-14" tabindex="-1"></a><span class="fu">rownames</span>(community_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb684-15"><a href="相关性与相似性.html#cb684-15" tabindex="-1"></a>  <span class="st">&quot;样地1&quot;</span>, <span class="st">&quot;样地2&quot;</span>, <span class="st">&quot;样地3&quot;</span>,</span>
<span id="cb684-16"><a href="相关性与相似性.html#cb684-16" tabindex="-1"></a>  <span class="st">&quot;样地4&quot;</span>, <span class="st">&quot;样地5&quot;</span>, <span class="st">&quot;样地6&quot;</span>, <span class="st">&quot;样地7&quot;</span>, <span class="st">&quot;样地8&quot;</span></span>
<span id="cb684-17"><a href="相关性与相似性.html#cb684-17" tabindex="-1"></a>)</span>
<span id="cb684-18"><a href="相关性与相似性.html#cb684-18" tabindex="-1"></a></span>
<span id="cb684-19"><a href="相关性与相似性.html#cb684-19" tabindex="-1"></a><span class="co"># 创建环境数据</span></span>
<span id="cb684-20"><a href="相关性与相似性.html#cb684-20" tabindex="-1"></a>env_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb684-21"><a href="相关性与相似性.html#cb684-21" tabindex="-1"></a>  温度 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">12</span>, <span class="dv">20</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">19</span>, <span class="dv">13</span>),</span>
<span id="cb684-22"><a href="相关性与相似性.html#cb684-22" tabindex="-1"></a>  湿度 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">75</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">70</span>, <span class="dv">68</span>, <span class="dv">78</span>, <span class="dv">62</span>),</span>
<span id="cb684-23"><a href="相关性与相似性.html#cb684-23" tabindex="-1"></a>  <span class="at">pH =</span> <span class="fu">c</span>(<span class="fl">6.5</span>, <span class="fl">7.2</span>, <span class="fl">6.8</span>, <span class="fl">7.5</span>, <span class="fl">6.9</span>, <span class="fl">7.0</span>, <span class="fl">7.3</span>, <span class="fl">6.7</span>)</span>
<span id="cb684-24"><a href="相关性与相似性.html#cb684-24" tabindex="-1"></a>)</span>
<span id="cb684-25"><a href="相关性与相似性.html#cb684-25" tabindex="-1"></a></span>
<span id="cb684-26"><a href="相关性与相似性.html#cb684-26" tabindex="-1"></a><span class="co"># Mantel检验</span></span>
<span id="cb684-27"><a href="相关性与相似性.html#cb684-27" tabindex="-1"></a>comm_dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(community_data, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb684-28"><a href="相关性与相似性.html#cb684-28" tabindex="-1"></a>env_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(env_data)</span>
<span id="cb684-29"><a href="相关性与相似性.html#cb684-29" tabindex="-1"></a>mantel_test <span class="ot">&lt;-</span> <span class="fu">mantel</span>(comm_dist, env_dist)</span>
<span id="cb684-30"><a href="相关性与相似性.html#cb684-30" tabindex="-1"></a><span class="fu">print</span>(mantel_test)</span></code></pre></div>
<pre><code>## 
## Mantel statistic based on Pearson&#39;s product-moment correlation 
## 
## Call:
## mantel(xdis = comm_dist, ydis = env_dist) 
## 
## Mantel statistic r: 0.4779 
##       Significance: 0.01 
## 
## Upper quantiles of permutations (null model):
##   90%   95% 97.5%   99% 
## 0.261 0.348 0.420 0.467 
## Permutation: free
## Number of permutations: 999</code></pre>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="相关性与相似性.html#cb686-1" tabindex="-1"></a><span class="co"># 排序分析 - PCA</span></span>
<span id="cb686-2"><a href="相关性与相似性.html#cb686-2" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">rda</span>(community_data, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb686-3"><a href="相关性与相似性.html#cb686-3" tabindex="-1"></a><span class="fu">summary</span>(pca_result)</span></code></pre></div>
<pre><code>## 
## Call:
## rda(X = community_data, scale = TRUE) 
## 
## Partitioning of correlations:
##               Inertia Proportion
## Total               5          1
## Unconstrained       5          1
## 
## Eigenvalues, and their contribution to the correlations 
## 
## Importance of components:
##                          PC1    PC2     PC3     PC4      PC5
## Eigenvalue            2.8025 1.7269 0.35593 0.08572 0.029022
## Proportion Explained  0.5605 0.3454 0.07119 0.01714 0.005804
## Cumulative Proportion 0.5605 0.9059 0.97705 0.99420 1.000000</code></pre>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="相关性与相似性.html#cb688-1" tabindex="-1"></a><span class="fu">plot</span>(pca_result, <span class="at">display =</span> <span class="st">&quot;sites&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-30-1"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-30-1.png" alt="群落相似性分析的排序图和聚类图" width="672" />
<p class="caption">
图5.24: 群落相似性分析的排序图和聚类图
</p>
</div>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="相关性与相似性.html#cb689-1" tabindex="-1"></a><span class="co"># 排序分析 - NMDS</span></span>
<span id="cb689-2"><a href="相关性与相似性.html#cb689-2" tabindex="-1"></a>comm_dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(community_data, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb689-3"><a href="相关性与相似性.html#cb689-3" tabindex="-1"></a>nmds_result <span class="ot">&lt;-</span> <span class="fu">monoMDS</span>(comm_dist)</span>
<span id="cb689-4"><a href="相关性与相似性.html#cb689-4" tabindex="-1"></a><span class="fu">plot</span>(nmds_result, <span class="at">type =</span> <span class="st">&quot;t&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-30-2"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-30-2.png" alt="群落相似性分析的排序图和聚类图" width="672" />
<p class="caption">
图5.25: 群落相似性分析的排序图和聚类图
</p>
</div>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="相关性与相似性.html#cb690-1" tabindex="-1"></a><span class="co"># 聚类分析 - 层次聚类</span></span>
<span id="cb690-2"><a href="相关性与相似性.html#cb690-2" tabindex="-1"></a>hc_result <span class="ot">&lt;-</span> <span class="fu">hclust</span>(comm_dist, <span class="at">method =</span> <span class="st">&quot;average&quot;</span>)</span>
<span id="cb690-3"><a href="相关性与相似性.html#cb690-3" tabindex="-1"></a><span class="fu">plot</span>(hc_result)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-30-3"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-30-3.png" alt="群落相似性分析的排序图和聚类图" width="672" />
<p class="caption">
图5.26: 群落相似性分析的排序图和聚类图
</p>
</div>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="相关性与相似性.html#cb691-1" tabindex="-1"></a><span class="co"># Beta多样性计算</span></span>
<span id="cb691-2"><a href="相关性与相似性.html#cb691-2" tabindex="-1"></a>beta_div <span class="ot">&lt;-</span> <span class="fu">betadiver</span>(community_data, <span class="at">method =</span> <span class="st">&quot;w&quot;</span>)</span>
<span id="cb691-3"><a href="相关性与相似性.html#cb691-3" tabindex="-1"></a><span class="fu">print</span>(beta_div)</span></code></pre></div>
<pre><code>##           样地1     样地2     样地3     样地4     样地5     样地6     样地7
## 样地2 0.1111111                                                            
## 样地3 0.1111111 0.0000000                                                  
## 样地4 0.1111111 0.0000000 0.0000000                                        
## 样地5 0.1111111 0.0000000 0.0000000 0.0000000                              
## 样地6 0.1111111 0.0000000 0.0000000 0.0000000 0.0000000                    
## 样地7 0.1111111 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000          
## 样地8 0.1111111 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</code></pre>
<p><strong>结果解释与生态学意义</strong>：群落相似性分析的结果解释需要结合统计显著性、效应大小和生态学背景。对于Mantel检验，通常认为<span class="math inline">\(p &lt; 0.05\)</span>表示环境距离与群落距离存在显著相关性，而Mantel统计量<span class="math inline">\(r_M\)</span>的大小反映了相关性的强度：<span class="math inline">\(|r_M| &gt; 0.3\)</span>表示强相关，<span class="math inline">\(0.2 &lt; |r_M| \leq 0.3\)</span>表示中等相关，<span class="math inline">\(|r_M| \leq 0.2\)</span>表示弱相关。</p>
<p>在排序分析中，前两个排序轴通常能够解释数据的主要变异，累计解释率超过50%通常被认为是可接受的。排序图中样本点的聚集程度反映了群落的相似性，而环境向量的长度和方向指示了环境因子对群落变异的影响强度。在聚类分析中，树状图的切割高度决定了聚类的粒度，通常选择在树状图分支较长的位置进行切割。Beta多样性的解释需要考虑其组分：高周转率<span class="math inline">\(\beta_{turnover}\)</span>表示物种替换是群落差异的主要机制，而高嵌套性<span class="math inline">\(\beta_{nestedness}\)</span>表示物种丢失是主要机制。</p>
<p>这些分析结果的生态学解释需要结合具体的研究问题。例如，显著的环境-群落相关性可能支持环境过滤假说；高度的Beta多样性可能反映了强烈的生态位分化或扩散限制。这些分析方法为生态学家提供了全面的工具集来研究群落相似性和多样性格局，支持群落生态学和生物地理学研究。</p>
</div>
</div>
<div id="总结-5" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> 总结<a href="相关性与相似性.html#总结-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>本章系统介绍了生态学中相关性与相似性分析的理论基础、方法体系及其在生态学研究中的广泛应用。相关性与相似性分析作为生态统计学的核心内容，为理解生物与环境、物种间以及群落间的复杂关系提供了定量化的工具。</p>
<p>在相关性统计基础部分，我们详细讨论了多种相关性度量方法。Pearson相关系数适用于线性关系的量化，Spearman秩相关和Kendall’s τ则能够处理单调但非线性的关系。偏相关分析通过控制混杂变量的影响，揭示了变量间的直接关系。距离相关和互信息进一步扩展了相关性分析的能力，能够检测复杂的非线性关系和依赖模式。这些方法的选择需要根据数据的分布特征、关系类型以及研究问题的性质来决定。</p>
<p>自相关分析关注数据在时间和空间维度上的依赖性。时间自相关通过自相关函数（ACF）和偏自相关函数（PACF）揭示了时间序列中的周期性、趋势和记忆效应，而平稳性检验则为时间序列分析提供了基础假设验证。空间自相关分析则通过变异函数、全局空间自相关指数（如Moran’s I和Geary’s C）以及局部空间自相关（LISA分析）来量化空间格局，识别空间聚集、离散或随机分布模式。这些分析对于理解种群动态、物种分布和环境梯度的空间结构具有重要意义。</p>
<p>系统发育相关性分析将进化历史纳入生态关系的考量。系统发育信号分析（如Blomberg’s K和Pagel’s λ）评估了性状在系统发育树上的保守性程度，而系统发育独立对比（PIC）和系统发育广义最小二乘法（PGLS）则能够去除系统发育非独立性对性状间关系分析的影响。这些方法为理解性状的进化历史和生态功能提供了进化生态学的视角。</p>
<p>相似性与距离分析构成了群落生态学和功能生态学的核心方法体系。常用相似性系数根据数据类型分为二元数据相似性（Jaccard、Sørensen系数）和数量数据相似性（Bray-Curtis距离、Morisita-Horn指数），而传统距离度量（欧氏距离、Mahalanobis距离）则在多元数据分析中发挥重要作用。功能性状相关性分析揭示了生物在资源分配和生态策略上的权衡关系，经济型谱理论则提供了理解植物功能策略普遍模式的框架。</p>
<p>种内相关性分析通过空间分布模式和聚集指数量化了同一物种个体在空间上的分布特征，反映了种内相互作用和环境异质性的综合影响。种间相关性分析则通过种间关联和生态网络构建揭示了物种间竞争、互利等相互作用的结构特性。群落相似性分析整合了Mantel检验、排序分析、聚类分析和Beta多样性等多种方法，为理解群落构建机制、环境梯度影响以及生物地理格局提供了全面的分析工具。</p>
<p>在结果解释方面，本章为各种统计量提供了明确的数值标准和生态学解释框架。相似性系数的数值范围、相关系数的强度分级、聚集指数的判断标准以及网络拓扑特征的阈值都为生态学家提供了实用的参考依据。这些标准的应用需要结合具体的研究背景和生态学预期，避免机械地套用数值标准而忽视生态学机制的理解。</p>
<p>总之，相关性与相似性分析构成了生态统计学的重要支柱，它们不仅提供了量化生态关系的数学工具，更重要的是为理解生态系统的结构、功能和动态提供了理论框架。随着生态学研究的深入和计算技术的发展，这些方法将继续在生态学理论构建、生态系统管理和生物多样性保护中发挥关键作用。掌握这些分析方法并正确理解其生态学含义，对于开展严谨的生态学研究具有重要意义。</p>
</div>
<div id="综合练习-3" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> 综合练习<a href="相关性与相似性.html#综合练习-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="参数估计.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="基于经典分布的假设检验.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": false,
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["ecological-statistics.pdf", "ecological-statistics.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
