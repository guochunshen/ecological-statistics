<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 相关性与相似性 | 生态统计学</title>
  <meta name="description" content="5 相关性与相似性 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="5 相关性与相似性 | 生态统计学" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="5 相关性与相似性 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 相关性与相似性 | 生态统计学" />
  
  <meta name="twitter:description" content="5 相关性与相似性 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  

<meta name="author" content="沈国春、李勤" />


<meta name="date" content="2025-10-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="参数估计.html"/>
<link rel="next" href="基于经典分布的假设检验.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7cbaf067c715044120ee231397e9ace3";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">生态统计学</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#为什么"><i class="fa fa-check"></i><b>0.1</b> 为什么</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#在不确定的世界中寻找规律"><i class="fa fa-check"></i><b>0.1.1</b> 在不确定的世界中寻找规律</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#ai时代的机遇与陷阱"><i class="fa fa-check"></i><b>0.1.2</b> AI时代的机遇与陷阱</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#本书介绍"><i class="fa fa-check"></i><b>0.2</b> 本书介绍</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#本书特色与教学理念"><i class="fa fa-check"></i><b>0.2.1</b> 本书特色与教学理念</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#课程在线资源"><i class="fa fa-check"></i><b>0.3</b> 课程在线资源</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#学习方式"><i class="fa fa-check"></i><b>0.4</b> 学习方式</a>
<ul>
<li class="chapter" data-level="0.4.1" data-path="index.html"><a href="index.html#持续学习r语言的重要性"><i class="fa fa-check"></i><b>0.4.1</b> 持续学习R语言的重要性</a></li>
<li class="chapter" data-level="0.4.2" data-path="index.html"><a href="index.html#在错误中快速成长"><i class="fa fa-check"></i><b>0.4.2</b> 在错误中快速成长</a></li>
<li class="chapter" data-level="0.4.3" data-path="index.html"><a href="index.html#实践导向的学习策略"><i class="fa fa-check"></i><b>0.4.3</b> 实践导向的学习策略</a></li>
<li class="chapter" data-level="0.4.4" data-path="index.html"><a href="index.html#正确的上课姿势"><i class="fa fa-check"></i><b>0.4.4</b> 正确的上课姿势</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#重复本书例子"><i class="fa fa-check"></i><b>0.5</b> 重复本书例子</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="统计编程基础.html"><a href="统计编程基础.html"><i class="fa fa-check"></i><b>1</b> 统计编程基础</a>
<ul>
<li class="chapter" data-level="1.1" data-path="统计编程基础.html"><a href="统计编程基础.html#引言"><i class="fa fa-check"></i><b>1.1</b> 引言</a></li>
<li class="chapter" data-level="1.2" data-path="统计编程基础.html"><a href="统计编程基础.html#核心能力培养框架"><i class="fa fa-check"></i><b>1.2</b> 核心能力培养框架</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="统计编程基础.html"><a href="统计编程基础.html#高阶思维与问题解决能力"><i class="fa fa-check"></i><b>1.2.1</b> 高阶思维与问题解决能力</a></li>
<li class="chapter" data-level="1.2.2" data-path="统计编程基础.html"><a href="统计编程基础.html#与llm协同工作的能力"><i class="fa fa-check"></i><b>1.2.2</b> 与LLM协同工作的能力</a></li>
<li class="chapter" data-level="1.2.3" data-path="统计编程基础.html"><a href="统计编程基础.html#传统但愈发重要的软技能"><i class="fa fa-check"></i><b>1.2.3</b> 传统但愈发重要的软技能</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="统计编程基础.html"><a href="统计编程基础.html#通用编程思维基础"><i class="fa fa-check"></i><b>1.3</b> 通用编程思维基础</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="统计编程基础.html"><a href="统计编程基础.html#编程核心概念"><i class="fa fa-check"></i><b>1.3.1</b> 编程核心概念</a></li>
<li class="chapter" data-level="1.3.2" data-path="统计编程基础.html"><a href="统计编程基础.html#算法复杂度"><i class="fa fa-check"></i><b>1.3.2</b> 算法复杂度</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="统计编程基础.html"><a href="统计编程基础.html#ai协同编程技能"><i class="fa fa-check"></i><b>1.4</b> AI协同编程技能</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="统计编程基础.html"><a href="统计编程基础.html#ai编程模块安装"><i class="fa fa-check"></i><b>1.4.1</b> AI编程模块安装</a></li>
<li class="chapter" data-level="1.4.2" data-path="统计编程基础.html"><a href="统计编程基础.html#精准提问技巧"><i class="fa fa-check"></i><b>1.4.2</b> 精准提问技巧</a></li>
<li class="chapter" data-level="1.4.3" data-path="统计编程基础.html"><a href="统计编程基础.html#代码审查能力"><i class="fa fa-check"></i><b>1.4.3</b> 代码审查能力</a></li>
<li class="chapter" data-level="1.4.4" data-path="统计编程基础.html"><a href="统计编程基础.html#调试与错误处理"><i class="fa fa-check"></i><b>1.4.4</b> 调试与错误处理</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="统计编程基础.html"><a href="统计编程基础.html#总结"><i class="fa fa-check"></i><b>1.5</b> 总结</a></li>
<li class="chapter" data-level="1.6" data-path="统计编程基础.html"><a href="统计编程基础.html#综合练习"><i class="fa fa-check"></i><b>1.6</b> 综合练习</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="统计编程基础.html"><a href="统计编程基础.html#练习1"><i class="fa fa-check"></i><b>1.6.1</b> 练习1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="概率与分布.html"><a href="概率与分布.html"><i class="fa fa-check"></i><b>2</b> 概率与分布</a>
<ul>
<li class="chapter" data-level="2.1" data-path="概率与分布.html"><a href="概率与分布.html#引言-1"><i class="fa fa-check"></i><b>2.1</b> 引言</a></li>
<li class="chapter" data-level="2.2" data-path="概率与分布.html"><a href="概率与分布.html#蚂蚱午餐与概率"><i class="fa fa-check"></i><b>2.2</b> 蚂蚱午餐与概率</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="概率与分布.html"><a href="概率与分布.html#一只蚱蜢的午餐"><i class="fa fa-check"></i><b>2.2.1</b> 一只蚱蜢的午餐</a></li>
<li class="chapter" data-level="2.2.2" data-path="概率与分布.html"><a href="概率与分布.html#理想的猜测古典概率"><i class="fa fa-check"></i><b>2.2.2</b> 理想的猜测——古典概率</a></li>
<li class="chapter" data-level="2.2.3" data-path="概率与分布.html"><a href="概率与分布.html#数据的语言频率概率"><i class="fa fa-check"></i><b>2.2.3</b> 数据的语言——频率概率</a></li>
<li class="chapter" data-level="2.2.4" data-path="概率与分布.html"><a href="概率与分布.html#动态的更新贝叶斯概率"><i class="fa fa-check"></i><b>2.2.4</b> 动态的更新——贝叶斯概率</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="概率与分布.html"><a href="概率与分布.html#随机变量与分布"><i class="fa fa-check"></i><b>2.3</b> 随机变量与分布</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="概率与分布.html"><a href="概率与分布.html#随机变量"><i class="fa fa-check"></i><b>2.3.1</b> 随机变量</a></li>
<li class="chapter" data-level="2.3.2" data-path="概率与分布.html"><a href="概率与分布.html#概率分布"><i class="fa fa-check"></i><b>2.3.2</b> 概率分布</a></li>
<li class="chapter" data-level="2.3.3" data-path="概率与分布.html"><a href="概率与分布.html#累积概率分布从可能性到确定性"><i class="fa fa-check"></i><b>2.3.3</b> 累积概率分布：从可能性到确定性</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="概率与分布.html"><a href="概率与分布.html#午餐菜单离散随机变量的分布家族"><i class="fa fa-check"></i><b>2.4</b> 午餐菜单：离散随机变量的分布家族</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="概率与分布.html"><a href="概率与分布.html#伯努利分布一个是或否的终极问题"><i class="fa fa-check"></i><b>2.4.1</b> 伯努利分布：一个“是”或“否”的终极问题</a></li>
<li class="chapter" data-level="2.4.2" data-path="概率与分布.html"><a href="概率与分布.html#二项分布重复是非题的计数法则"><i class="fa fa-check"></i><b>2.4.2</b> 二项分布：重复“是非题”的计数法则</a></li>
<li class="chapter" data-level="2.4.3" data-path="概率与分布.html"><a href="概率与分布.html#多项式分布多元选择的全景图"><i class="fa fa-check"></i><b>2.4.3</b> 多项式分布：多元选择的“全景图”</a></li>
<li class="chapter" data-level="2.4.4" data-path="概率与分布.html"><a href="概率与分布.html#泊松分布罕见事件的低语者"><i class="fa fa-check"></i><b>2.4.4</b> 泊松分布：罕见事件的“低语者”</a></li>
<li class="chapter" data-level="2.4.5" data-path="概率与分布.html"><a href="概率与分布.html#几何分布等待第一次成功的耐心"><i class="fa fa-check"></i><b>2.4.5</b> 几何分布：等待“第一次成功”的耐心</a></li>
<li class="chapter" data-level="2.4.6" data-path="概率与分布.html"><a href="概率与分布.html#负二项分布等待最后一次成功的耐心"><i class="fa fa-check"></i><b>2.4.6</b> 负二项分布：等待“最后一次成功”的耐心</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="概率与分布.html"><a href="概率与分布.html#午餐法则连续随机变量的分布家族"><i class="fa fa-check"></i><b>2.5</b> 午餐法则：连续随机变量的分布家族</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="概率与分布.html"><a href="概率与分布.html#均匀分布纯粹的平等"><i class="fa fa-check"></i><b>2.5.1</b> 均匀分布：纯粹的平等</a></li>
<li class="chapter" data-level="2.5.2" data-path="概率与分布.html"><a href="概率与分布.html#指数分布等待的艺术"><i class="fa fa-check"></i><b>2.5.2</b> 指数分布：等待的艺术</a></li>
<li class="chapter" data-level="2.5.3" data-path="概率与分布.html"><a href="概率与分布.html#正态分布高斯分布自然界的钟形法则"><i class="fa fa-check"></i><b>2.5.3</b> 正态分布（高斯分布）：自然界的“钟形”法则</a></li>
<li class="chapter" data-level="2.5.4" data-path="概率与分布.html"><a href="概率与分布.html#威布尔分布生存分析的时间法则"><i class="fa fa-check"></i><b>2.5.4</b> 威布尔分布：生存分析的“时间法则”</a></li>
<li class="chapter" data-level="2.5.5" data-path="概率与分布.html"><a href="概率与分布.html#伽马分布更一般的等待时间模型"><i class="fa fa-check"></i><b>2.5.5</b> 伽马分布：更一般的等待时间模型</a></li>
<li class="chapter" data-level="2.5.6" data-path="概率与分布.html"><a href="概率与分布.html#贝塔分布比例变量的天然选择"><i class="fa fa-check"></i><b>2.5.6</b> 贝塔分布：比例变量的天然选择</a></li>
<li class="chapter" data-level="2.5.7" data-path="概率与分布.html"><a href="概率与分布.html#正态分布的魔力中心极限定理"><i class="fa fa-check"></i><b>2.5.7</b> 正态分布的魔力：中心极限定理</a></li>
<li class="chapter" data-level="2.5.8" data-path="概率与分布.html"><a href="概率与分布.html#生态学应用实例"><i class="fa fa-check"></i><b>2.5.8</b> 生态学应用实例</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="概率与分布.html"><a href="概率与分布.html#混合分布处理异质性数据"><i class="fa fa-check"></i><b>2.6</b> 混合分布：处理异质性数据</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="概率与分布.html"><a href="概率与分布.html#零膨胀分布处理零值过多的数据"><i class="fa fa-check"></i><b>2.6.1</b> 零膨胀分布：处理零值过多的数据</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="概率与分布.html"><a href="概率与分布.html#总结-2"><i class="fa fa-check"></i><b>2.7</b> 总结</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="描述统计.html"><a href="描述统计.html"><i class="fa fa-check"></i><b>3</b> 描述统计</a>
<ul>
<li class="chapter" data-level="3.1" data-path="描述统计.html"><a href="描述统计.html#引言-2"><i class="fa fa-check"></i><b>3.1</b> 引言</a></li>
<li class="chapter" data-level="3.2" data-path="描述统计.html"><a href="描述统计.html#描述统计基础"><i class="fa fa-check"></i><b>3.2</b> 描述统计基础</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="描述统计.html"><a href="描述统计.html#中心趋势测量"><i class="fa fa-check"></i><b>3.2.1</b> 中心趋势测量</a></li>
<li class="chapter" data-level="3.2.2" data-path="描述统计.html"><a href="描述统计.html#离散性测量"><i class="fa fa-check"></i><b>3.2.2</b> 离散性测量</a></li>
<li class="chapter" data-level="3.2.3" data-path="描述统计.html"><a href="描述统计.html#分布形状与矩测量"><i class="fa fa-check"></i><b>3.2.3</b> 分布形状与矩测量</a></li>
<li class="chapter" data-level="3.2.4" data-path="描述统计.html"><a href="描述统计.html#统计概念在概率分布图上的可视化"><i class="fa fa-check"></i><b>3.2.4</b> 统计概念在概率分布图上的可视化</a></li>
<li class="chapter" data-level="3.2.5" data-path="描述统计.html"><a href="描述统计.html#标准误的可视化理解"><i class="fa fa-check"></i><b>3.2.5</b> 标准误的可视化理解</a></li>
<li class="chapter" data-level="3.2.6" data-path="描述统计.html"><a href="描述统计.html#不同参数值的分布形状比较"><i class="fa fa-check"></i><b>3.2.6</b> 不同参数值的分布形状比较</a></li>
<li class="chapter" data-level="3.2.7" data-path="描述统计.html"><a href="描述统计.html#生态学意义总结"><i class="fa fa-check"></i><b>3.2.7</b> 生态学意义总结</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="描述统计.html"><a href="描述统计.html#环境异质性描述"><i class="fa fa-check"></i><b>3.3</b> 环境异质性描述</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="描述统计.html"><a href="描述统计.html#环境异质性的概念"><i class="fa fa-check"></i><b>3.3.1</b> 环境异质性的概念</a></li>
<li class="chapter" data-level="3.3.2" data-path="描述统计.html"><a href="描述统计.html#环境异质性的可视化理解"><i class="fa fa-check"></i><b>3.3.2</b> 环境异质性的可视化理解</a></li>
<li class="chapter" data-level="3.3.3" data-path="描述统计.html"><a href="描述统计.html#环境异质性的量化方法"><i class="fa fa-check"></i><b>3.3.3</b> 环境异质性的量化方法</a></li>
<li class="chapter" data-level="3.3.4" data-path="描述统计.html"><a href="描述统计.html#环境异质性的生态学意义"><i class="fa fa-check"></i><b>3.3.4</b> 环境异质性的生态学意义</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="描述统计.html"><a href="描述统计.html#个体特征描述"><i class="fa fa-check"></i><b>3.4</b> 个体特征描述</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="描述统计.html"><a href="描述统计.html#生存函数survival-function"><i class="fa fa-check"></i><b>3.4.1</b> 生存函数（Survival Function）</a></li>
<li class="chapter" data-level="3.4.2" data-path="描述统计.html"><a href="描述统计.html#瞬时死亡风险函数hazard-function"><i class="fa fa-check"></i><b>3.4.2</b> 瞬时死亡风险函数（Hazard Function）</a></li>
<li class="chapter" data-level="3.4.3" data-path="描述统计.html"><a href="描述统计.html#累积风险函数cumulative-hazard-function"><i class="fa fa-check"></i><b>3.4.3</b> 累积风险函数（Cumulative Hazard Function）</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="描述统计.html"><a href="描述统计.html#种群特征描述"><i class="fa fa-check"></i><b>3.5</b> 种群特征描述</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="描述统计.html"><a href="描述统计.html#gini系数"><i class="fa fa-check"></i><b>3.5.1</b> Gini系数</a></li>
<li class="chapter" data-level="3.5.2" data-path="描述统计.html"><a href="描述统计.html#lorenz曲线"><i class="fa fa-check"></i><b>3.5.2</b> Lorenz曲线</a></li>
<li class="chapter" data-level="3.5.3" data-path="描述统计.html"><a href="描述统计.html#基尼系数的生态学应用"><i class="fa fa-check"></i><b>3.5.3</b> 基尼系数的生态学应用</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="描述统计.html"><a href="描述统计.html#群落特征描述"><i class="fa fa-check"></i><b>3.6</b> 群落特征描述</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="描述统计.html"><a href="描述统计.html#物种多样性描述"><i class="fa fa-check"></i><b>3.6.1</b> 物种多样性描述</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="描述统计.html"><a href="描述统计.html#生态网络特征描述"><i class="fa fa-check"></i><b>3.7</b> 生态网络特征描述</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="描述统计.html"><a href="描述统计.html#网络拓扑指标"><i class="fa fa-check"></i><b>3.7.1</b> 网络拓扑指标</a></li>
<li class="chapter" data-level="3.7.2" data-path="描述统计.html"><a href="描述统计.html#食物网特征"><i class="fa fa-check"></i><b>3.7.2</b> 食物网特征</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="描述统计.html"><a href="描述统计.html#稳定性描述"><i class="fa fa-check"></i><b>3.8</b> 稳定性描述</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="描述统计.html"><a href="描述统计.html#抵抗力resistance"><i class="fa fa-check"></i><b>3.8.1</b> 抵抗力（Resistance）</a></li>
<li class="chapter" data-level="3.8.2" data-path="描述统计.html"><a href="描述统计.html#恢复力resilience"><i class="fa fa-check"></i><b>3.8.2</b> 恢复力（Resilience）</a></li>
<li class="chapter" data-level="3.8.3" data-path="描述统计.html"><a href="描述统计.html#持久性persistence"><i class="fa fa-check"></i><b>3.8.3</b> 持久性（Persistence）</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="描述统计.html"><a href="描述统计.html#总结-3"><i class="fa fa-check"></i><b>3.9</b> 总结</a></li>
<li class="chapter" data-level="3.10" data-path="描述统计.html"><a href="描述统计.html#综合练习-1"><i class="fa fa-check"></i><b>3.10</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="参数估计.html"><a href="参数估计.html"><i class="fa fa-check"></i><b>4</b> 参数估计</a>
<ul>
<li class="chapter" data-level="4.1" data-path="参数估计.html"><a href="参数估计.html#引言-3"><i class="fa fa-check"></i><b>4.1</b> 引言</a></li>
<li class="chapter" data-level="4.2" data-path="参数估计.html"><a href="参数估计.html#样本与总体"><i class="fa fa-check"></i><b>4.2</b> 样本与总体</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="参数估计.html"><a href="参数估计.html#抽样方法及其生态学应用"><i class="fa fa-check"></i><b>4.2.1</b> 抽样方法及其生态学应用</a></li>
<li class="chapter" data-level="4.2.2" data-path="参数估计.html"><a href="参数估计.html#r语言中的抽样实现"><i class="fa fa-check"></i><b>4.2.2</b> R语言中的抽样实现</a></li>
<li class="chapter" data-level="4.2.3" data-path="参数估计.html"><a href="参数估计.html#抽样误差与样本量确定"><i class="fa fa-check"></i><b>4.2.3</b> 抽样误差与样本量确定</a></li>
<li class="chapter" data-level="4.2.4" data-path="参数估计.html"><a href="参数估计.html#生态学抽样设计的实践考虑"><i class="fa fa-check"></i><b>4.2.4</b> 生态学抽样设计的实践考虑</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="参数估计.html"><a href="参数估计.html#参数估计基础"><i class="fa fa-check"></i><b>4.3</b> 参数估计基础</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="参数估计.html"><a href="参数估计.html#点估计"><i class="fa fa-check"></i><b>4.3.1</b> 点估计</a></li>
<li class="chapter" data-level="4.3.2" data-path="参数估计.html"><a href="参数估计.html#区间估计"><i class="fa fa-check"></i><b>4.3.2</b> 区间估计</a></li>
<li class="chapter" data-level="4.3.3" data-path="参数估计.html"><a href="参数估计.html#估计方法"><i class="fa fa-check"></i><b>4.3.3</b> 估计方法</a></li>
<li class="chapter" data-level="4.3.4" data-path="参数估计.html"><a href="参数估计.html#估计量性质如何评价一个估计方法的好坏"><i class="fa fa-check"></i><b>4.3.4</b> 估计量性质：如何评价一个估计方法的好坏？</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="参数估计.html"><a href="参数估计.html#种群大小估计"><i class="fa fa-check"></i><b>4.4</b> 种群大小估计</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="参数估计.html"><a href="参数估计.html#标记重捕法"><i class="fa fa-check"></i><b>4.4.1</b> 标记重捕法</a></li>
<li class="chapter" data-level="4.4.2" data-path="参数估计.html"><a href="参数估计.html#面积取样法"><i class="fa fa-check"></i><b>4.4.2</b> 面积取样法</a></li>
<li class="chapter" data-level="4.4.3" data-path="参数估计.html"><a href="参数估计.html#距离抽样法"><i class="fa fa-check"></i><b>4.4.3</b> 距离抽样法</a></li>
<li class="chapter" data-level="4.4.4" data-path="参数估计.html"><a href="参数估计.html#去除法"><i class="fa fa-check"></i><b>4.4.4</b> 去除法</a></li>
<li class="chapter" data-level="4.4.5" data-path="参数估计.html"><a href="参数估计.html#种群大小估计方法的选择与比较"><i class="fa fa-check"></i><b>4.4.5</b> 种群大小估计方法的选择与比较</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="参数估计.html"><a href="参数估计.html#物种多样性估计"><i class="fa fa-check"></i><b>4.5</b> 物种多样性估计</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="参数估计.html"><a href="参数估计.html#外推和内插方法"><i class="fa fa-check"></i><b>4.5.1</b> 外推和内插方法</a></li>
<li class="chapter" data-level="4.5.2" data-path="参数估计.html"><a href="参数估计.html#多样性估计的抽样偏差"><i class="fa fa-check"></i><b>4.5.2</b> 多样性估计的抽样偏差</a></li>
<li class="chapter" data-level="4.5.3" data-path="参数估计.html"><a href="参数估计.html#多样性估计方法的选择与比较"><i class="fa fa-check"></i><b>4.5.3</b> 多样性估计方法的选择与比较</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="参数估计.html"><a href="参数估计.html#总结-4"><i class="fa fa-check"></i><b>4.6</b> 总结</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="参数估计.html"><a href="参数估计.html#参数估计的生态学意义与理论基础"><i class="fa fa-check"></i><b>4.6.1</b> 参数估计的生态学意义与理论基础</a></li>
<li class="chapter" data-level="4.6.2" data-path="参数估计.html"><a href="参数估计.html#点估计与区间估计从单一数值到可信范围"><i class="fa fa-check"></i><b>4.6.2</b> 点估计与区间估计：从单一数值到可信范围</a></li>
<li class="chapter" data-level="4.6.3" data-path="参数估计.html"><a href="参数估计.html#主要估计方法及其生态学应用"><i class="fa fa-check"></i><b>4.6.3</b> 主要估计方法及其生态学应用</a></li>
<li class="chapter" data-level="4.6.4" data-path="参数估计.html"><a href="参数估计.html#种群大小估计生态学实践的核心任务"><i class="fa fa-check"></i><b>4.6.4</b> 种群大小估计：生态学实践的核心任务</a></li>
<li class="chapter" data-level="4.6.5" data-path="参数估计.html"><a href="参数估计.html#物种多样性估计群落生态学的量化基础"><i class="fa fa-check"></i><b>4.6.5</b> 物种多样性估计：群落生态学的量化基础</a></li>
<li class="chapter" data-level="4.6.6" data-path="参数估计.html"><a href="参数估计.html#参数估计在生态学决策中的重要性"><i class="fa fa-check"></i><b>4.6.6</b> 参数估计在生态学决策中的重要性</a></li>
<li class="chapter" data-level="4.6.7" data-path="参数估计.html"><a href="参数估计.html#未来发展方向与挑战"><i class="fa fa-check"></i><b>4.6.7</b> 未来发展方向与挑战</a></li>
<li class="chapter" data-level="4.6.8" data-path="参数估计.html"><a href="参数估计.html#结语"><i class="fa fa-check"></i><b>4.6.8</b> 结语</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="参数估计.html"><a href="参数估计.html#综合练习-2"><i class="fa fa-check"></i><b>4.7</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="相关性与相似性.html"><a href="相关性与相似性.html"><i class="fa fa-check"></i><b>5</b> 相关性与相似性</a>
<ul>
<li class="chapter" data-level="5.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#引言-4"><i class="fa fa-check"></i><b>5.1</b> 引言</a></li>
<li class="chapter" data-level="5.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#线性相关性"><i class="fa fa-check"></i><b>5.2</b> 线性相关性</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#pearson相关系数线性关系的度量"><i class="fa fa-check"></i><b>5.2.1</b> Pearson相关系数：线性关系的度量</a></li>
<li class="chapter" data-level="5.2.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#spearman秩相关单调关系的度量"><i class="fa fa-check"></i><b>5.2.2</b> Spearman秩相关：单调关系的度量</a></li>
<li class="chapter" data-level="5.2.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#kendalls-τ基于一致对的比例"><i class="fa fa-check"></i><b>5.2.3</b> Kendall’s τ：基于一致对的比例</a></li>
<li class="chapter" data-level="5.2.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#偏相关分析"><i class="fa fa-check"></i><b>5.2.4</b> 偏相关分析</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#非线性相关"><i class="fa fa-check"></i><b>5.3</b> 非线性相关</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#距离相关"><i class="fa fa-check"></i><b>5.3.1</b> 距离相关</a></li>
<li class="chapter" data-level="5.3.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#互信息"><i class="fa fa-check"></i><b>5.3.2</b> 互信息</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#时间自相关"><i class="fa fa-check"></i><b>5.4</b> 时间自相关</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#生态学中的时间自相关实例"><i class="fa fa-check"></i><b>5.4.1</b> 生态学中的时间自相关实例</a></li>
<li class="chapter" data-level="5.4.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#自相关函数acf时间依赖性的量化"><i class="fa fa-check"></i><b>5.4.2</b> 自相关函数（ACF）：时间依赖性的量化</a></li>
<li class="chapter" data-level="5.4.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#偏自相关函数pacf直接时间依赖的识别"><i class="fa fa-check"></i><b>5.4.3</b> 偏自相关函数（PACF）：直接时间依赖的识别</a></li>
<li class="chapter" data-level="5.4.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#时间序列平稳性分析的基础假设"><i class="fa fa-check"></i><b>5.4.4</b> 时间序列平稳性：分析的基础假设</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#空间自相关"><i class="fa fa-check"></i><b>5.5</b> 空间自相关</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#变异函数variogram空间依赖性的量化"><i class="fa fa-check"></i><b>5.5.1</b> 变异函数（Variogram）：空间依赖性的量化</a></li>
<li class="chapter" data-level="5.5.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#克里金插值基于空间自相关的预测方法"><i class="fa fa-check"></i><b>5.5.2</b> 克里金插值：基于空间自相关的预测方法</a></li>
<li class="chapter" data-level="5.5.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#空间自相关指数全局空间模式的检测"><i class="fa fa-check"></i><b>5.5.3</b> 空间自相关指数：全局空间模式的检测</a></li>
<li class="chapter" data-level="5.5.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#局部空间自相关空间异质性的识别"><i class="fa fa-check"></i><b>5.5.4</b> 局部空间自相关：空间异质性的识别</a></li>
<li class="chapter" data-level="5.5.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#空间平稳性空间分析的基础假设"><i class="fa fa-check"></i><b>5.5.5</b> 空间平稳性：空间分析的基础假设</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育相关性"><i class="fa fa-check"></i><b>5.6</b> 系统发育相关性</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育信号进化历史的印记"><i class="fa fa-check"></i><b>5.6.1</b> 系统发育信号：进化历史的印记</a></li>
<li class="chapter" data-level="5.6.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育独立对比去除系统发育影响的性状比较"><i class="fa fa-check"></i><b>5.6.2</b> 系统发育独立对比：去除系统发育影响的性状比较</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="相关性与相似性.html"><a href="相关性与相似性.html#相似性与距离"><i class="fa fa-check"></i><b>5.7</b> 相似性与距离</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#常用相似性系数"><i class="fa fa-check"></i><b>5.7.1</b> 常用相似性系数</a></li>
<li class="chapter" data-level="5.7.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#功能性状间相关性"><i class="fa fa-check"></i><b>5.7.2</b> 功能性状间相关性</a></li>
<li class="chapter" data-level="5.7.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#种内相关性"><i class="fa fa-check"></i><b>5.7.3</b> 种内相关性</a></li>
<li class="chapter" data-level="5.7.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#种间相关性"><i class="fa fa-check"></i><b>5.7.4</b> 种间相关性</a></li>
<li class="chapter" data-level="5.7.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#群落相似性"><i class="fa fa-check"></i><b>5.7.5</b> 群落相似性</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="相关性与相似性.html"><a href="相关性与相似性.html#总结-5"><i class="fa fa-check"></i><b>5.8</b> 总结</a></li>
<li class="chapter" data-level="5.9" data-path="相关性与相似性.html"><a href="相关性与相似性.html#综合练习-3"><i class="fa fa-check"></i><b>5.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html"><i class="fa fa-check"></i><b>6</b> 基于经典分布的假设检验</a>
<ul>
<li class="chapter" data-level="6.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#引言-5"><i class="fa fa-check"></i><b>6.1</b> 引言</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#假设检验基础"><i class="fa fa-check"></i><b>6.1.1</b> 假设检验基础</a></li>
<li class="chapter" data-level="6.1.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#假设检验的基本步骤"><i class="fa fa-check"></i><b>6.1.2</b> 假设检验的基本步骤</a></li>
<li class="chapter" data-level="6.1.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#零假设与备择假设"><i class="fa fa-check"></i><b>6.1.3</b> 零假设与备择假设</a></li>
<li class="chapter" data-level="6.1.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#检验统计量与p值"><i class="fa fa-check"></i><b>6.1.4</b> 检验统计量与p值</a></li>
<li class="chapter" data-level="6.1.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#显著性水平"><i class="fa fa-check"></i><b>6.1.5</b> 显著性水平</a></li>
<li class="chapter" data-level="6.1.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#效应大小与置信区间"><i class="fa fa-check"></i><b>6.1.6</b> 效应大小与置信区间</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本检验"><i class="fa fa-check"></i><b>6.2</b> 单样本检验</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本t检验"><i class="fa fa-check"></i><b>6.2.1</b> 单样本t检验</a></li>
<li class="chapter" data-level="6.2.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本符号检验"><i class="fa fa-check"></i><b>6.2.2</b> 单样本符号检验</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#双样本检验"><i class="fa fa-check"></i><b>6.3</b> 双样本检验</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#独立样本t检验"><i class="fa fa-check"></i><b>6.3.1</b> 独立样本t检验</a></li>
<li class="chapter" data-level="6.3.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#配对样本t检验"><i class="fa fa-check"></i><b>6.3.2</b> 配对样本t检验</a></li>
<li class="chapter" data-level="6.3.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#mann-whitney-u检验"><i class="fa fa-check"></i><b>6.3.3</b> Mann-Whitney U检验</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多样本检验"><i class="fa fa-check"></i><b>6.4</b> 多样本检验</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#方差分析anova"><i class="fa fa-check"></i><b>6.4.1</b> 方差分析（ANOVA）</a></li>
<li class="chapter" data-level="6.4.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#kruskal-wallis检验"><i class="fa fa-check"></i><b>6.4.2</b> Kruskal-Wallis检验</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#非参数检验方法"><i class="fa fa-check"></i><b>6.5</b> 非参数检验方法</a></li>
<li class="chapter" data-level="6.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较校正"><i class="fa fa-check"></i><b>6.6</b> 多重比较校正</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较问题的本质"><i class="fa fa-check"></i><b>6.6.1</b> 多重比较问题的本质</a></li>
<li class="chapter" data-level="6.6.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#bonferroni校正"><i class="fa fa-check"></i><b>6.6.2</b> Bonferroni校正</a></li>
<li class="chapter" data-level="6.6.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#tukey-hsd检验"><i class="fa fa-check"></i><b>6.6.3</b> Tukey HSD检验</a></li>
<li class="chapter" data-level="6.6.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#fdr错误发现率控制"><i class="fa fa-check"></i><b>6.6.4</b> FDR（错误发现率）控制</a></li>
<li class="chapter" data-level="6.6.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#生态学实例森林类型对鸟类多样性的影响"><i class="fa fa-check"></i><b>6.6.5</b> 生态学实例：森林类型对鸟类多样性的影响</a></li>
<li class="chapter" data-level="6.6.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较校正效果的可视化"><i class="fa fa-check"></i><b>6.6.6</b> 多重比较校正效果的可视化</a></li>
<li class="chapter" data-level="6.6.7" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#实用建议与最佳实践"><i class="fa fa-check"></i><b>6.6.7</b> 实用建议与最佳实践</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#功效分析"><i class="fa fa-check"></i><b>6.7</b> 功效分析</a></li>
<li class="chapter" data-level="6.8" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#总结-6"><i class="fa fa-check"></i><b>6.8</b> 总结</a></li>
<li class="chapter" data-level="6.9" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#综合练习-4"><i class="fa fa-check"></i><b>6.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html"><i class="fa fa-check"></i><b>7</b> 基于模拟的假设检验</a>
<ul>
<li class="chapter" data-level="7.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#引言-6"><i class="fa fa-check"></i><b>7.1</b> 引言</a></li>
<li class="chapter" data-level="7.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学层次与演进脉络"><i class="fa fa-check"></i><b>7.2</b> 方法学层次与演进脉络</a></li>
<li class="chapter" data-level="7.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验"><i class="fa fa-check"></i><b>7.3</b> 置换检验</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验的基本原理"><i class="fa fa-check"></i><b>7.3.1</b> 置换检验的基本原理</a></li>
<li class="chapter" data-level="7.3.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验的技术实现过程"><i class="fa fa-check"></i><b>7.3.2</b> 置换检验的技术实现过程</a></li>
<li class="chapter" data-level="7.3.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例"><i class="fa fa-check"></i><b>7.3.3</b> R语言实现示例</a></li>
<li class="chapter" data-level="7.3.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验在生态学中的应用价值与局限"><i class="fa fa-check"></i><b>7.3.4</b> 置换检验在生态学中的应用价值与局限</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验"><i class="fa fa-check"></i><b>7.4</b> 蒙特卡洛检验</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛方法的概念体系"><i class="fa fa-check"></i><b>7.4.1</b> 蒙特卡洛方法的概念体系</a></li>
<li class="chapter" data-level="7.4.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验的基本原理"><i class="fa fa-check"></i><b>7.4.2</b> 蒙特卡洛检验的基本原理</a></li>
<li class="chapter" data-level="7.4.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验的主要类型"><i class="fa fa-check"></i><b>7.4.3</b> 蒙特卡洛检验的主要类型</a></li>
<li class="chapter" data-level="7.4.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例空间分布随机性检验"><i class="fa fa-check"></i><b>7.4.4</b> R语言实现示例：空间分布随机性检验</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法检验"><i class="fa fa-check"></i><b>7.5</b> 自助法检验</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的基本原理"><i class="fa fa-check"></i><b>7.5.1</b> 自助法的基本原理</a></li>
<li class="chapter" data-level="7.5.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的实施步骤"><i class="fa fa-check"></i><b>7.5.2</b> 自助法的实施步骤</a></li>
<li class="chapter" data-level="7.5.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法在生态学中的应用"><i class="fa fa-check"></i><b>7.5.3</b> 自助法在生态学中的应用</a></li>
<li class="chapter" data-level="7.5.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例-1"><i class="fa fa-check"></i><b>7.5.4</b> R语言实现示例</a></li>
<li class="chapter" data-level="7.5.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的优势与局限"><i class="fa fa-check"></i><b>7.5.5</b> 自助法的优势与局限</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#基因型频率检验"><i class="fa fa-check"></i><b>7.6</b> 基因型频率检验</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#hardy-weinberg平衡检验"><i class="fa fa-check"></i><b>7.6.1</b> Hardy-Weinberg平衡检验</a></li>
<li class="chapter" data-level="7.6.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#连锁不平衡检验"><i class="fa fa-check"></i><b>7.6.2</b> 连锁不平衡检验</a></li>
<li class="chapter" data-level="7.6.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与选择建议"><i class="fa fa-check"></i><b>7.6.3</b> 方法学比较与选择建议</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#多样性差异检验"><i class="fa fa-check"></i><b>7.7</b> 多样性差异检验</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#群落多样性比较"><i class="fa fa-check"></i><b>7.7.1</b> 群落多样性比较</a></li>
<li class="chapter" data-level="7.7.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#相似性分析anosim"><i class="fa fa-check"></i><b>7.7.2</b> 相似性分析（ANOSIM）</a></li>
<li class="chapter" data-level="7.7.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与生态学应用建议"><i class="fa fa-check"></i><b>7.7.3</b> 方法学比较与生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#物种空间分布检验"><i class="fa fa-check"></i><b>7.8</b> 物种空间分布检验</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#空间分布模式检验"><i class="fa fa-check"></i><b>7.8.1</b> 空间分布模式检验</a></li>
<li class="chapter" data-level="7.8.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#点过程模型检验"><i class="fa fa-check"></i><b>7.8.2</b> 点过程模型检验</a></li>
<li class="chapter" data-level="7.8.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#空间生态学的统计挑战与解决方案"><i class="fa fa-check"></i><b>7.8.3</b> 空间生态学的统计挑战与解决方案</a></li>
<li class="chapter" data-level="7.8.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学应用与保护意义"><i class="fa fa-check"></i><b>7.8.4</b> 生态学应用与保护意义</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育信号检验"><i class="fa fa-check"></i><b>7.9</b> 系统发育信号检验</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育保守性检验"><i class="fa fa-check"></i><b>7.9.1</b> 系统发育保守性检验</a></li>
<li class="chapter" data-level="7.9.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育独立对比"><i class="fa fa-check"></i><b>7.9.2</b> 系统发育独立对比</a></li>
<li class="chapter" data-level="7.9.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与生态学应用建议-1"><i class="fa fa-check"></i><b>7.9.3</b> 方法学比较与生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学零模型检验"><i class="fa fa-check"></i><b>7.10</b> 生态学零模型检验</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#零模型的基本概念与生态学意义"><i class="fa fa-check"></i><b>7.10.1</b> 零模型的基本概念与生态学意义</a></li>
<li class="chapter" data-level="7.10.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#群落组装零模型检验"><i class="fa fa-check"></i><b>7.10.2</b> 群落组装零模型检验</a></li>
<li class="chapter" data-level="7.10.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态网络零模型检验"><i class="fa fa-check"></i><b>7.10.3</b> 生态网络零模型检验</a></li>
<li class="chapter" data-level="7.10.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#零模型检验的方法学比较与选择"><i class="fa fa-check"></i><b>7.10.4</b> 零模型检验的方法学比较与选择</a></li>
<li class="chapter" data-level="7.10.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学应用与保护意义-1"><i class="fa fa-check"></i><b>7.10.5</b> 生态学应用与保护意义</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#总结-7"><i class="fa fa-check"></i><b>7.11</b> 总结</a></li>
<li class="chapter" data-level="7.12" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#综合练习-5"><i class="fa fa-check"></i><b>7.12</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html"><i class="fa fa-check"></i><b>8</b> 简单线性回归模型</a>
<ul>
<li class="chapter" data-level="8.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#引言-7"><i class="fa fa-check"></i><b>8.1</b> 引言</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#为什么生态学本科生需要学习统计建模与预测"><i class="fa fa-check"></i><b>8.1.1</b> 为什么生态学本科生需要学习统计建模与预测？</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#线性回归模型生态关系的数学表达"><i class="fa fa-check"></i><b>8.2</b> 线性回归模型：生态关系的数学表达</a></li>
<li class="chapter" data-level="8.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#最小二乘估计"><i class="fa fa-check"></i><b>8.3</b> 最小二乘估计</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的lm函数详解"><i class="fa fa-check"></i><b>8.3.1</b> R语言中的lm()函数详解</a></li>
<li class="chapter" data-level="8.3.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#lm函数的基本语法"><i class="fa fa-check"></i><b>8.3.2</b> lm()函数的基本语法</a></li>
<li class="chapter" data-level="8.3.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型公式的详细说明"><i class="fa fa-check"></i><b>8.3.3</b> 模型公式的详细说明</a></li>
<li class="chapter" data-level="8.3.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#lm函数的返回对象"><i class="fa fa-check"></i><b>8.3.4</b> lm()函数的返回对象</a></li>
<li class="chapter" data-level="8.3.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#提取回归结果的常用函数"><i class="fa fa-check"></i><b>8.3.5</b> 提取回归结果的常用函数</a></li>
<li class="chapter" data-level="8.3.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#理解summary函数的输出"><i class="fa fa-check"></i><b>8.3.6</b> 理解summary()函数的输出</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#回归诊断验证模型的生态学合理性"><i class="fa fa-check"></i><b>8.4</b> 回归诊断：验证模型的生态学合理性</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#回归诊断图的系统解读"><i class="fa fa-check"></i><b>8.4.1</b> 回归诊断图的系统解读</a></li>
<li class="chapter" data-level="8.4.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型质量的综合评估"><i class="fa fa-check"></i><b>8.4.2</b> 模型质量的综合评估</a></li>
<li class="chapter" data-level="8.4.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学诊断问题的应对策略"><i class="fa fa-check"></i><b>8.4.3</b> 生态学诊断问题的应对策略</a></li>
<li class="chapter" data-level="8.4.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用实例-1"><i class="fa fa-check"></i><b>8.4.4</b> 生态学应用实例</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归多因子生态关系的综合分析"><i class="fa fa-check"></i><b>8.5</b> 多元线性回归：多因子生态关系的综合分析</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归的模型公式"><i class="fa fa-check"></i><b>8.5.1</b> 多元线性回归的模型公式</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归中的变量选择"><i class="fa fa-check"></i><b>8.6</b> 多元线性回归中的变量选择</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择的重要性"><i class="fa fa-check"></i><b>8.6.1</b> 变量选择的重要性</a></li>
<li class="chapter" data-level="8.6.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择的基本原则"><i class="fa fa-check"></i><b>8.6.2</b> 变量选择的基本原则</a></li>
<li class="chapter" data-level="8.6.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#常用的变量选择方法"><i class="fa fa-check"></i><b>8.6.3</b> 常用的变量选择方法</a></li>
<li class="chapter" data-level="8.6.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的模型选择实现"><i class="fa fa-check"></i><b>8.6.4</b> R语言中的模型选择实现</a></li>
<li class="chapter" data-level="8.6.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学变量选择的实践建议"><i class="fa fa-check"></i><b>8.6.5</b> 生态学变量选择的实践建议</a></li>
<li class="chapter" data-level="8.6.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型选择的注意事项"><i class="fa fa-check"></i><b>8.6.6</b> 模型选择的注意事项</a></li>
<li class="chapter" data-level="8.6.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#完整生态学案例分析鸟类丰富度与环境因子的关系"><i class="fa fa-check"></i><b>8.6.7</b> 完整生态学案例分析：鸟类丰富度与环境因子的关系</a></li>
<li class="chapter" data-level="8.6.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#完整模型拟合"><i class="fa fa-check"></i><b>8.6.8</b> 完整模型拟合</a></li>
<li class="chapter" data-level="8.6.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择过程"><i class="fa fa-check"></i><b>8.6.9</b> 变量选择过程</a></li>
<li class="chapter" data-level="8.6.10" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#最优模型选择与结果解释"><i class="fa fa-check"></i><b>8.6.10</b> 最优模型选择与结果解释</a></li>
<li class="chapter" data-level="8.6.11" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型诊断与假设检验"><i class="fa fa-check"></i><b>8.6.11</b> 模型诊断与假设检验</a></li>
<li class="chapter" data-level="8.6.12" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型预测与应用"><i class="fa fa-check"></i><b>8.6.12</b> 模型预测与应用</a></li>
<li class="chapter" data-level="8.6.13" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型比较与评估"><i class="fa fa-check"></i><b>8.6.13</b> 模型比较与评估</a></li>
<li class="chapter" data-level="8.6.14" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学解释与模型选择价值"><i class="fa fa-check"></i><b>8.6.14</b> 生态学解释与模型选择价值</a></li>
<li class="chapter" data-level="8.6.15" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#案例分析总结"><i class="fa fa-check"></i><b>8.6.15</b> 案例分析总结</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归非线性生态关系的数学描述"><i class="fa fa-check"></i><b>8.7</b> 多项式回归：非线性生态关系的数学描述</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归模型"><i class="fa fa-check"></i><b>8.7.1</b> 多项式回归模型</a></li>
<li class="chapter" data-level="8.7.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的多项式回归实现"><i class="fa fa-check"></i><b>8.7.2</b> R语言中的多项式回归实现</a></li>
<li class="chapter" data-level="8.7.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用实例-2"><i class="fa fa-check"></i><b>8.7.3</b> 生态学应用实例</a></li>
<li class="chapter" data-level="8.7.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归的生态学意义"><i class="fa fa-check"></i><b>8.7.4</b> 多项式回归的生态学意义</a></li>
<li class="chapter" data-level="8.7.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式阶数的选择"><i class="fa fa-check"></i><b>8.7.5</b> 多项式阶数的选择</a></li>
<li class="chapter" data-level="8.7.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归的注意事项"><i class="fa fa-check"></i><b>8.7.6</b> 多项式回归的注意事项</a></li>
<li class="chapter" data-level="8.7.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#过度拟合问题演示"><i class="fa fa-check"></i><b>8.7.7</b> 过度拟合问题演示</a></li>
<li class="chapter" data-level="8.7.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型可视化与比较"><i class="fa fa-check"></i><b>8.7.8</b> 模型可视化与比较</a></li>
<li class="chapter" data-level="8.7.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#统计指标与交叉验证"><i class="fa fa-check"></i><b>8.7.9</b> 统计指标与交叉验证</a></li>
<li class="chapter" data-level="8.7.10" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用建议"><i class="fa fa-check"></i><b>8.7.10</b> 生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#总结从线性到非线性从简单到复杂"><i class="fa fa-check"></i><b>8.8</b> 总结：从线性到非线性，从简单到复杂</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#核心概念回顾"><i class="fa fa-check"></i><b>8.8.1</b> 核心概念回顾</a></li>
<li class="chapter" data-level="8.8.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学建模思维"><i class="fa fa-check"></i><b>8.8.2</b> 生态学建模思维</a></li>
<li class="chapter" data-level="8.8.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#实践应用价值"><i class="fa fa-check"></i><b>8.8.3</b> 实践应用价值</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#综合练习-6"><i class="fa fa-check"></i><b>8.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="模型选择与评估.html"><a href="模型选择与评估.html"><i class="fa fa-check"></i><b>9</b> 模型选择与评估</a>
<ul>
<li class="chapter" data-level="9.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#引言-8"><i class="fa fa-check"></i><b>9.1</b> 引言</a></li>
<li class="chapter" data-level="9.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型选择"><i class="fa fa-check"></i><b>9.2</b> 模型选择</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型选择原则"><i class="fa fa-check"></i><b>9.2.1</b> 模型选择原则</a></li>
<li class="chapter" data-level="9.2.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#信息准则"><i class="fa fa-check"></i><b>9.2.2</b> 信息准则</a></li>
<li class="chapter" data-level="9.2.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#似然比检验"><i class="fa fa-check"></i><b>9.2.3</b> 似然比检验</a></li>
<li class="chapter" data-level="9.2.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型平均"><i class="fa fa-check"></i><b>9.2.4</b> 模型平均</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型评估"><i class="fa fa-check"></i><b>9.3</b> 模型评估</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#交叉验证"><i class="fa fa-check"></i><b>9.3.1</b> 交叉验证</a></li>
<li class="chapter" data-level="9.3.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#外部验证"><i class="fa fa-check"></i><b>9.3.2</b> 外部验证</a></li>
<li class="chapter" data-level="9.3.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型诊断"><i class="fa fa-check"></i><b>9.3.3</b> 模型诊断</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型选择与评估"><i class="fa fa-check"></i><b>9.4</b> 贝叶斯模型选择与评估</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯与频率学派的根本差异"><i class="fa fa-check"></i><b>9.4.1</b> 贝叶斯与频率学派的根本差异</a></li>
<li class="chapter" data-level="9.4.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型选择基本原理"><i class="fa fa-check"></i><b>9.4.2</b> 贝叶斯模型选择基本原理</a></li>
<li class="chapter" data-level="9.4.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯假设检验流程"><i class="fa fa-check"></i><b>9.4.3</b> 贝叶斯假设检验流程</a></li>
<li class="chapter" data-level="9.4.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型比较与选择"><i class="fa fa-check"></i><b>9.4.4</b> 贝叶斯模型比较与选择</a></li>
<li class="chapter" data-level="9.4.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯可信区间"><i class="fa fa-check"></i><b>9.4.5</b> 贝叶斯可信区间</a></li>
<li class="chapter" data-level="9.4.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯因子计算与解释"><i class="fa fa-check"></i><b>9.4.6</b> 贝叶斯因子计算与解释</a></li>
<li class="chapter" data-level="9.4.7" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型平均"><i class="fa fa-check"></i><b>9.4.7</b> 贝叶斯模型平均</a></li>
<li class="chapter" data-level="9.4.8" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯预测评估"><i class="fa fa-check"></i><b>9.4.8</b> 贝叶斯预测评估</a></li>
<li class="chapter" data-level="9.4.9" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯变量选择"><i class="fa fa-check"></i><b>9.4.9</b> 贝叶斯变量选择</a></li>
<li class="chapter" data-level="9.4.10" data-path="模型选择与评估.html"><a href="模型选择与评估.html#生态学应用价值"><i class="fa fa-check"></i><b>9.4.10</b> 生态学应用价值</a></li>
<li class="chapter" data-level="9.4.11" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯检验的生态学应用案例"><i class="fa fa-check"></i><b>9.4.11</b> 贝叶斯检验的生态学应用案例</a></li>
<li class="chapter" data-level="9.4.12" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯方法的局限性"><i class="fa fa-check"></i><b>9.4.12</b> 贝叶斯方法的局限性</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#总结-8"><i class="fa fa-check"></i><b>9.5</b> 总结</a></li>
<li class="chapter" data-level="9.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#综合练习-7"><i class="fa fa-check"></i><b>9.6</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="高级回归模型.html"><a href="高级回归模型.html"><i class="fa fa-check"></i><b>10</b> 高级回归模型</a>
<ul>
<li class="chapter" data-level="10.1" data-path="高级回归模型.html"><a href="高级回归模型.html#引言-9"><i class="fa fa-check"></i><b>10.1</b> 引言</a></li>
<li class="chapter" data-level="10.2" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型"><i class="fa fa-check"></i><b>10.2</b> 可加性模型</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型的基本原理"><i class="fa fa-check"></i><b>10.2.1</b> 可加性模型的基本原理</a></li>
<li class="chapter" data-level="10.2.2" data-path="高级回归模型.html"><a href="高级回归模型.html#与线性模型的比较"><i class="fa fa-check"></i><b>10.2.2</b> 与线性模型的比较</a></li>
<li class="chapter" data-level="10.2.3" data-path="高级回归模型.html"><a href="高级回归模型.html#常见的平滑函数"><i class="fa fa-check"></i><b>10.2.3</b> 常见的平滑函数</a></li>
<li class="chapter" data-level="10.2.4" data-path="高级回归模型.html"><a href="高级回归模型.html#平滑函数选择的生态学考量"><i class="fa fa-check"></i><b>10.2.4</b> 平滑函数选择的生态学考量</a></li>
<li class="chapter" data-level="10.2.5" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型中的系数概念"><i class="fa fa-check"></i><b>10.2.5</b> 可加性模型中的”系数”概念</a></li>
<li class="chapter" data-level="10.2.6" data-path="高级回归模型.html"><a href="高级回归模型.html#在r中的实现"><i class="fa fa-check"></i><b>10.2.6</b> 在R中的实现</a></li>
<li class="chapter" data-level="10.2.7" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学应用示例"><i class="fa fa-check"></i><b>10.2.7</b> 生态学应用示例</a></li>
<li class="chapter" data-level="10.2.8" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型诊断"><i class="fa fa-check"></i><b>10.2.8</b> 可加性模型诊断</a></li>
<li class="chapter" data-level="10.2.9" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型的优势与局限"><i class="fa fa-check"></i><b>10.2.9</b> 可加性模型的优势与局限</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="高级回归模型.html"><a href="高级回归模型.html#广义线性回归"><i class="fa fa-check"></i><b>10.3</b> 广义线性回归</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="高级回归模型.html"><a href="高级回归模型.html#广义线性模型的基本框架"><i class="fa fa-check"></i><b>10.3.1</b> 广义线性模型的基本框架</a></li>
<li class="chapter" data-level="10.3.2" data-path="高级回归模型.html"><a href="高级回归模型.html#与普通线性回归的根本区别"><i class="fa fa-check"></i><b>10.3.2</b> 与普通线性回归的根本区别</a></li>
<li class="chapter" data-level="10.3.3" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的glm实现"><i class="fa fa-check"></i><b>10.3.3</b> R语言中的GLM实现</a></li>
<li class="chapter" data-level="10.3.4" data-path="高级回归模型.html"><a href="高级回归模型.html#常见glm类型及其生态学应用"><i class="fa fa-check"></i><b>10.3.4</b> 常见GLM类型及其生态学应用</a></li>
<li class="chapter" data-level="10.3.5" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与解释"><i class="fa fa-check"></i><b>10.3.5</b> 模型诊断与解释</a></li>
<li class="chapter" data-level="10.3.6" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学意义与注意事项"><i class="fa fa-check"></i><b>10.3.6</b> 生态学意义与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="高级回归模型.html"><a href="高级回归模型.html#广义可加模型"><i class="fa fa-check"></i><b>10.4</b> 广义可加模型</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="高级回归模型.html"><a href="高级回归模型.html#gam的基本原理"><i class="fa fa-check"></i><b>10.4.1</b> GAM的基本原理</a></li>
<li class="chapter" data-level="10.4.2" data-path="高级回归模型.html"><a href="高级回归模型.html#在r中的实现-1"><i class="fa fa-check"></i><b>10.4.2</b> 在R中的实现</a></li>
<li class="chapter" data-level="10.4.3" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学应用示例-1"><i class="fa fa-check"></i><b>10.4.3</b> 生态学应用示例</a></li>
<li class="chapter" data-level="10.4.4" data-path="高级回归模型.html"><a href="高级回归模型.html#gam在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.4.4</b> GAM在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.4.5" data-path="高级回归模型.html"><a href="高级回归模型.html#高级功能"><i class="fa fa-check"></i><b>10.4.5</b> 高级功能</a></li>
<li class="chapter" data-level="10.4.6" data-path="高级回归模型.html"><a href="高级回归模型.html#模型选择与诊断"><i class="fa fa-check"></i><b>10.4.6</b> 模型选择与诊断</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型"><i class="fa fa-check"></i><b>10.5</b> 混合效应模型</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="高级回归模型.html"><a href="高级回归模型.html#固定效应与随机效应的生态学概念"><i class="fa fa-check"></i><b>10.5.1</b> 固定效应与随机效应的生态学概念</a></li>
<li class="chapter" data-level="10.5.2" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型的数学框架"><i class="fa fa-check"></i><b>10.5.2</b> 混合效应模型的数学框架</a></li>
<li class="chapter" data-level="10.5.3" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的混合效应模型实现"><i class="fa fa-check"></i><b>10.5.3</b> R语言中的混合效应模型实现</a></li>
<li class="chapter" data-level="10.5.4" data-path="高级回归模型.html"><a href="高级回归模型.html#固定效应和随机效应的筛选"><i class="fa fa-check"></i><b>10.5.4</b> 固定效应和随机效应的筛选</a></li>
<li class="chapter" data-level="10.5.5" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.5.5</b> 混合效应模型在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.5.6" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项"><i class="fa fa-check"></i><b>10.5.6</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型"><i class="fa fa-check"></i><b>10.6</b> 时空自相关模型</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型与混合效应模型的联系与区别"><i class="fa fa-check"></i><b>10.6.1</b> 时空自相关模型与混合效应模型的联系与区别</a></li>
<li class="chapter" data-level="10.6.2" data-path="高级回归模型.html"><a href="高级回归模型.html#空间自相关与时间自相关的生态学概念"><i class="fa fa-check"></i><b>10.6.2</b> 空间自相关与时间自相关的生态学概念</a></li>
<li class="chapter" data-level="10.6.3" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型的数学框架"><i class="fa fa-check"></i><b>10.6.3</b> 时空自相关模型的数学框架</a></li>
<li class="chapter" data-level="10.6.4" data-path="高级回归模型.html"><a href="高级回归模型.html#时空模型框架的联系与区别"><i class="fa fa-check"></i><b>10.6.4</b> 时空模型框架的联系与区别</a></li>
<li class="chapter" data-level="10.6.5" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的时空自相关模型实现"><i class="fa fa-check"></i><b>10.6.5</b> R语言中的时空自相关模型实现</a></li>
<li class="chapter" data-level="10.6.6" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型的生态学应用"><i class="fa fa-check"></i><b>10.6.6</b> 时空自相关模型的生态学应用</a></li>
<li class="chapter" data-level="10.6.7" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项-1"><i class="fa fa-check"></i><b>10.6.7</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型"><i class="fa fa-check"></i><b>10.7</b> 结构方程模型</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型的基本框架"><i class="fa fa-check"></i><b>10.7.1</b> 结构方程模型的基本框架</a></li>
<li class="chapter" data-level="10.7.2" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的结构方程模型实现"><i class="fa fa-check"></i><b>10.7.2</b> R语言中的结构方程模型实现</a></li>
<li class="chapter" data-level="10.7.3" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.7.3</b> 结构方程模型在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.7.4" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项-2"><i class="fa fa-check"></i><b>10.7.4</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="高级回归模型.html"><a href="高级回归模型.html#总结-9"><i class="fa fa-check"></i><b>10.8</b> 总结</a></li>
<li class="chapter" data-level="10.9" data-path="高级回归模型.html"><a href="高级回归模型.html#综合练习-8"><i class="fa fa-check"></i><b>10.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="机器学习.html"><a href="机器学习.html"><i class="fa fa-check"></i><b>11</b> 机器学习</a>
<ul>
<li class="chapter" data-level="11.1" data-path="机器学习.html"><a href="机器学习.html#引言-10"><i class="fa fa-check"></i><b>11.1</b> 引言</a></li>
<li class="chapter" data-level="11.2" data-path="机器学习.html"><a href="机器学习.html#决策树"><i class="fa fa-check"></i><b>11.2</b> 决策树</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与原理"><i class="fa fa-check"></i><b>11.2.1</b> 基本概念与原理</a></li>
<li class="chapter" data-level="11.2.2" data-path="机器学习.html"><a href="机器学习.html#决策树构建原理"><i class="fa fa-check"></i><b>11.2.2</b> 决策树构建原理</a></li>
<li class="chapter" data-level="11.2.3" data-path="机器学习.html"><a href="机器学习.html#分类树classification-trees"><i class="fa fa-check"></i><b>11.2.3</b> 分类树（Classification Trees）</a></li>
<li class="chapter" data-level="11.2.4" data-path="机器学习.html"><a href="机器学习.html#回归树regression-trees"><i class="fa fa-check"></i><b>11.2.4</b> 回归树（Regression Trees）</a></li>
<li class="chapter" data-level="11.2.5" data-path="机器学习.html"><a href="机器学习.html#分类树与回归树的比较"><i class="fa fa-check"></i><b>11.2.5</b> 分类树与回归树的比较</a></li>
<li class="chapter" data-level="11.2.6" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-3"><i class="fa fa-check"></i><b>11.2.6</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.2.7" data-path="机器学习.html"><a href="机器学习.html#优势与局限"><i class="fa fa-check"></i><b>11.2.7</b> 优势与局限</a></li>
<li class="chapter" data-level="11.2.8" data-path="机器学习.html"><a href="机器学习.html#r代码实现示例"><i class="fa fa-check"></i><b>11.2.8</b> R代码实现示例</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="机器学习.html"><a href="机器学习.html#随机森林"><i class="fa fa-check"></i><b>11.3</b> 随机森林</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="机器学习.html"><a href="机器学习.html#决策树与随机森林的关系"><i class="fa fa-check"></i><b>11.3.1</b> 决策树与随机森林的关系</a></li>
<li class="chapter" data-level="11.3.2" data-path="机器学习.html"><a href="机器学习.html#随机森林的三个随机"><i class="fa fa-check"></i><b>11.3.2</b> 随机森林的三个随机</a></li>
<li class="chapter" data-level="11.3.3" data-path="机器学习.html"><a href="机器学习.html#数学定义与原理"><i class="fa fa-check"></i><b>11.3.3</b> 数学定义与原理</a></li>
<li class="chapter" data-level="11.3.4" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理"><i class="fa fa-check"></i><b>11.3.4</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.3.5" data-path="机器学习.html"><a href="机器学习.html#r代码实现"><i class="fa fa-check"></i><b>11.3.5</b> R代码实现</a></li>
<li class="chapter" data-level="11.3.6" data-path="机器学习.html"><a href="机器学习.html#代码详细说明"><i class="fa fa-check"></i><b>11.3.6</b> 代码详细说明</a></li>
<li class="chapter" data-level="11.3.7" data-path="机器学习.html"><a href="机器学习.html#模型评估与验证"><i class="fa fa-check"></i><b>11.3.7</b> 模型评估与验证</a></li>
<li class="chapter" data-level="11.3.8" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-4"><i class="fa fa-check"></i><b>11.3.8</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.3.9" data-path="机器学习.html"><a href="机器学习.html#生态学应用价值-1"><i class="fa fa-check"></i><b>11.3.9</b> 生态学应用价值</a></li>
<li class="chapter" data-level="11.3.10" data-path="机器学习.html"><a href="机器学习.html#优势与局限的深入分析"><i class="fa fa-check"></i><b>11.3.10</b> 优势与局限的深入分析</a></li>
<li class="chapter" data-level="11.3.11" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望"><i class="fa fa-check"></i><b>11.3.11</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="机器学习.html"><a href="机器学习.html#支持向量机"><i class="fa fa-check"></i><b>11.4</b> 支持向量机</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与几何直觉"><i class="fa fa-check"></i><b>11.4.1</b> 基本概念与几何直觉</a></li>
<li class="chapter" data-level="11.4.2" data-path="机器学习.html"><a href="机器学习.html#数学原理与核心概念"><i class="fa fa-check"></i><b>11.4.2</b> 数学原理与核心概念</a></li>
<li class="chapter" data-level="11.4.3" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理-1"><i class="fa fa-check"></i><b>11.4.3</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.4.4" data-path="机器学习.html"><a href="机器学习.html#r代码实现-1"><i class="fa fa-check"></i><b>11.4.4</b> R代码实现</a></li>
<li class="chapter" data-level="11.4.5" data-path="机器学习.html"><a href="机器学习.html#代码详细说明-1"><i class="fa fa-check"></i><b>11.4.5</b> 代码详细说明</a></li>
<li class="chapter" data-level="11.4.6" data-path="机器学习.html"><a href="机器学习.html#模型评估与验证-1"><i class="fa fa-check"></i><b>11.4.6</b> 模型评估与验证</a></li>
<li class="chapter" data-level="11.4.7" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-5"><i class="fa fa-check"></i><b>11.4.7</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.4.8" data-path="机器学习.html"><a href="机器学习.html#优势与局限-1"><i class="fa fa-check"></i><b>11.4.8</b> 优势与局限</a></li>
<li class="chapter" data-level="11.4.9" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望-1"><i class="fa fa-check"></i><b>11.4.9</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="机器学习.html"><a href="机器学习.html#深度神经网络"><i class="fa fa-check"></i><b>11.5</b> 深度神经网络</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与生物学启发"><i class="fa fa-check"></i><b>11.5.1</b> 基本概念与生物学启发</a></li>
<li class="chapter" data-level="11.5.2" data-path="机器学习.html"><a href="机器学习.html#主要神经网络架构"><i class="fa fa-check"></i><b>11.5.2</b> 主要神经网络架构</a></li>
<li class="chapter" data-level="11.5.3" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理-2"><i class="fa fa-check"></i><b>11.5.3</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.5.4" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-6"><i class="fa fa-check"></i><b>11.5.4</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.5.5" data-path="机器学习.html"><a href="机器学习.html#优势与局限-2"><i class="fa fa-check"></i><b>11.5.5</b> 优势与局限</a></li>
<li class="chapter" data-level="11.5.6" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望-2"><i class="fa fa-check"></i><b>11.5.6</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="机器学习.html"><a href="机器学习.html#总结-10"><i class="fa fa-check"></i><b>11.6</b> 总结</a></li>
<li class="chapter" data-level="11.7" data-path="机器学习.html"><a href="机器学习.html#综合练习-9"><i class="fa fa-check"></i><b>11.7</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html"><i class="fa fa-check"></i><b>12</b> 附录1 R语言编程基础</a>
<ul>
<li class="chapter" data-level="12.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言介绍"><i class="fa fa-check"></i><b>12.1</b> R语言介绍</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#为什么生态学专业需要学习r"><i class="fa fa-check"></i><b>12.1.1</b> 为什么生态学专业需要学习R？</a></li>
<li class="chapter" data-level="12.1.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言简介与趣味应用"><i class="fa fa-check"></i><b>12.1.2</b> R语言简介与趣味应用</a></li>
<li class="chapter" data-level="12.1.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#环境设置和配置"><i class="fa fa-check"></i><b>12.1.3</b> 环境设置和配置</a></li>
<li class="chapter" data-level="12.1.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#项目文件夹结构设置"><i class="fa fa-check"></i><b>12.1.4</b> 项目文件夹结构设置</a></li>
<li class="chapter" data-level="12.1.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#基本包管理"><i class="fa fa-check"></i><b>12.1.5</b> 基本包管理</a></li>
<li class="chapter" data-level="12.1.6" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#工作目录设置"><i class="fa fa-check"></i><b>12.1.6</b> 工作目录设置</a></li>
<li class="chapter" data-level="12.1.7" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课前准备检查清单"><i class="fa fa-check"></i><b>12.1.7</b> 课前准备检查清单</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#数值向量创建与基本统计计算"><i class="fa fa-check"></i><b>12.2</b> 数值向量创建与基本统计计算</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景"><i class="fa fa-check"></i><b>12.2.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.2.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据"><i class="fa fa-check"></i><b>12.2.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.2.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程"><i class="fa fa-check"></i><b>12.2.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.2.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解"><i class="fa fa-check"></i><b>12.2.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.2.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习"><i class="fa fa-check"></i><b>12.2.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#字符型数据处理与向量索引操作"><i class="fa fa-check"></i><b>12.3</b> 字符型数据处理与向量索引操作</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-1"><i class="fa fa-check"></i><b>12.3.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.3.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-1"><i class="fa fa-check"></i><b>12.3.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.3.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-1"><i class="fa fa-check"></i><b>12.3.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.3.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-1"><i class="fa fa-check"></i><b>12.3.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.3.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-1"><i class="fa fa-check"></i><b>12.3.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#数据框结构理解与多类型数据管理"><i class="fa fa-check"></i><b>12.4</b> 数据框结构理解与多类型数据管理</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-2"><i class="fa fa-check"></i><b>12.4.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.4.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-2"><i class="fa fa-check"></i><b>12.4.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.4.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-2"><i class="fa fa-check"></i><b>12.4.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.4.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-2"><i class="fa fa-check"></i><b>12.4.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.4.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-2"><i class="fa fa-check"></i><b>12.4.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#列表数据结构与数据分组管理"><i class="fa fa-check"></i><b>12.5</b> 列表数据结构与数据分组管理</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-3"><i class="fa fa-check"></i><b>12.5.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.5.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-3"><i class="fa fa-check"></i><b>12.5.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.5.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-3"><i class="fa fa-check"></i><b>12.5.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.5.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-3"><i class="fa fa-check"></i><b>12.5.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.5.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-3"><i class="fa fa-check"></i><b>12.5.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#外部数据导入与条件筛选分析"><i class="fa fa-check"></i><b>12.6</b> 外部数据导入与条件筛选分析</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-4"><i class="fa fa-check"></i><b>12.6.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.6.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据文件bird_monitoring.csv"><i class="fa fa-check"></i><b>12.6.2</b> 演示数据文件（bird_monitoring.csv）</a></li>
<li class="chapter" data-level="12.6.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-4"><i class="fa fa-check"></i><b>12.6.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.6.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-4"><i class="fa fa-check"></i><b>12.6.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.6.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-4"><i class="fa fa-check"></i><b>12.6.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#缺失值和异常值的识别处理"><i class="fa fa-check"></i><b>12.7</b> 缺失值和异常值的识别处理</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-5"><i class="fa fa-check"></i><b>12.7.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.7.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-4"><i class="fa fa-check"></i><b>12.7.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.7.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-5"><i class="fa fa-check"></i><b>12.7.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.7.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-5"><i class="fa fa-check"></i><b>12.7.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.7.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-5"><i class="fa fa-check"></i><b>12.7.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#描述性统计分析与基础数据可视化"><i class="fa fa-check"></i><b>12.8</b> 描述性统计分析与基础数据可视化</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-6"><i class="fa fa-check"></i><b>12.8.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.8.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-5"><i class="fa fa-check"></i><b>12.8.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.8.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-6"><i class="fa fa-check"></i><b>12.8.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.8.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-6"><i class="fa fa-check"></i><b>12.8.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.8.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-6"><i class="fa fa-check"></i><b>12.8.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#条件判断循环结构与函数编程"><i class="fa fa-check"></i><b>12.9</b> 条件判断、循环结构与函数编程</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-7"><i class="fa fa-check"></i><b>12.9.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.9.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-6"><i class="fa fa-check"></i><b>12.9.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.9.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-7"><i class="fa fa-check"></i><b>12.9.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.9.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-7"><i class="fa fa-check"></i><b>12.9.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.9.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-7"><i class="fa fa-check"></i><b>12.9.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#现代数据科学工具包应用"><i class="fa fa-check"></i><b>12.10</b> 现代数据科学工具包应用</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-8"><i class="fa fa-check"></i><b>12.10.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.10.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-7"><i class="fa fa-check"></i><b>12.10.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.10.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-8"><i class="fa fa-check"></i><b>12.10.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.10.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-8"><i class="fa fa-check"></i><b>12.10.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.10.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-8"><i class="fa fa-check"></i><b>12.10.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#图形语法与科学绘图"><i class="fa fa-check"></i><b>12.11</b> 图形语法与科学绘图</a>
<ul>
<li class="chapter" data-level="12.11.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-9"><i class="fa fa-check"></i><b>12.11.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.11.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-8"><i class="fa fa-check"></i><b>12.11.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.11.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-9"><i class="fa fa-check"></i><b>12.11.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.11.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-9"><i class="fa fa-check"></i><b>12.11.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.11.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-9"><i class="fa fa-check"></i><b>12.11.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.12" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#综合练习-10"><i class="fa fa-check"></i><b>12.12</b> 综合练习</a>
<ul>
<li class="chapter" data-level="12.12.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习1-1"><i class="fa fa-check"></i><b>12.12.1</b> 练习1</a></li>
<li class="chapter" data-level="12.12.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习2"><i class="fa fa-check"></i><b>12.12.2</b> 练习2</a></li>
<li class="chapter" data-level="12.12.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习3"><i class="fa fa-check"></i><b>12.12.3</b> 练习3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://gitee.com/gcshen/ecological-statistics" target="blank">Gitee</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">生态统计学</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="相关性与相似性" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> 相关性与相似性<a href="相关性与相似性.html#相关性与相似性" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="引言-4" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> 引言<a href="相关性与相似性.html#引言-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>生态学研究的一个核心任务是揭示自然界中各种现象之间的内在联系。在前面的章节中，我们学习了如何描述生态系统的特征，如种群数量、物种多样性等。然而，生态学的真正魅力在于理解这些特征之间的相互关系——环境因子如何影响物种分布？物种之间如何相互作用？群落结构如何响应环境变化？这些问题的答案往往隐藏在变量间的相关性或相似性之中。</p>
<p>相关性与相似性分析是揭示这些生态关系的重要统计工具。本章将带领大家从描述生态系统特征转向理解生态系统关系，这是生态学研究从现象描述到规律发现的关键跨越。对于生态学专业人才生而言，掌握这些分析方法不仅能够提升研究能力，更重要的是培养一种关系思维——学会从相互联系的角度来理解复杂的生态系统。</p>
<p>为什么生态学专业的学生需要学习相关性与相似性？首先，生态系统的本质是一个由无数相互关联的组分构成的复杂网络。从微观的基因表达到宏观的物种分布，从短期的种群动态到长期的气候变化响应，相关性分析为我们提供了量化这些关系的数学语言。例如，通过相关性分析，我们可以确定温度变化与物种丰富度之间的关系强度，或者评估不同环境因子对群落结构的相对重要性。</p>
<p>其次，相似性分析在生态学中具有广泛的应用价值。当我们研究不同群落的物种组成时，需要量化它们之间的相似程度；当我们分析功能性状的协变模式时，需要评估性状间的相似性关系；当我们构建生态网络时，需要基于相似性来识别物种间的相互作用。相似性分析不仅帮助我们理解生态系统的结构特征，还为保护生物学中的优先区识别、生态恢复中的参考系统选择提供了科学依据。</p>
<p>本章的内容安排遵循从基础到应用、从简单到复杂的学习路径。我们将首先介绍相关性统计的基础知识，包括Pearson相关系数、Spearman秩相关、Kendall’s τ等常用方法。随后，我们将深入探讨更复杂的相关性概念，如偏相关分析、距离相关和互信息。</p>
<p>自相关分析是本章的另一个重要组成部分，它专门处理具有时间或空间依赖性的生态数据。时间自相关分析帮助我们理解生态过程的时间动态，空间自相关分析则揭示了生态现象的空间格局。此外，我们还将介绍系统发育相关性分析，帮助我们理解性状的系统发育保守性和生态适应机制。</p>
<p>相似性与距离度量构成了本章的后半部分内容。我们将系统介绍常用的相似性系数和距离度量方法，探讨功能性状间相关性的生态学意义，以及经济型谱理论在理解植物功能策略中的应用。</p>
<p>种内相关性和种间相关性分析将帮助我们理解生物个体和物种间的空间分布模式和相互作用关系。最后，群落相似性分析将整合前面学到的各种方法，全面揭示群落结构的空间格局和环境梯度响应。</p>
<p>学习相关性与相似性分析不仅是为了掌握统计工具，更重要的是培养系统思维的能力。在生态学研究中，很少有现象是孤立存在的，理解它们之间的相互关系往往比理解单个现象本身更为重要。通过本章的学习，希望大家能够建立起从关系角度思考生态问题的习惯，为未来的生态学研究和保护实践奠定坚实的统计基础。</p>
</div>
<div id="线性相关性" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> 线性相关性<a href="相关性与相似性.html#线性相关性" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在生态学研究中，我们经常需要探索不同变量之间的关系。例如，我们可能想知道：森林中树木的胸径与树高之间是否存在某种关系？降水量与植物多样性之间有何联系？这些问题的答案往往需要通过相关性分析来获得。相关性分析为我们提供了一种量化变量间关系强度和方向的统计工具。</p>
<div id="pearson相关系数线性关系的度量" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Pearson相关系数：线性关系的度量<a href="相关性与相似性.html#pearson相关系数线性关系的度量" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>假设我们正在研究一片温带森林中树木的胸径与树高的关系。我们测量了50棵树的胸径（cm）和树高（m），想要了解这两个变量之间是否存在线性关系。</p>
<p>Pearson相关系数是统计学中最经典的线性相关性度量方法，由卡尔·皮尔逊于1895年提出。它专门用于量化两个连续变量之间的线性关系强度和方向。其核心思想是通过计算两个变量的协方差与各自标准差的乘积之比来标准化协方差的大小，从而得到一个无量纲的相关系数。</p>
<p><strong>数学定义</strong>：对于两个变量<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>，Pearson相关系数<span class="math inline">\(r\)</span>定义为：</p>
<p><span class="math display">\[r = \frac{\sum_{i=1}^{n}(X_i - \bar{X})(Y_i - \bar{Y})}{\sqrt{\sum_{i=1}^{n}(X_i - \bar{X})^2}\sqrt{\sum_{i=1}^{n}(Y_i - \bar{Y})^2}}\]</span></p>
<p>其中<span class="math inline">\(n\)</span>是样本量，<span class="math inline">\(\bar{X}\)</span>和<span class="math inline">\(\bar{Y}\)</span>分别是<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>的样本均值。</p>
<p>Pearson相关系数的取值范围在-1到1之间。正值表示正相关关系，即当一个变量增加时另一个变量也倾向于增加；负值表示负相关关系，即当一个变量增加时另一个变量倾向于减少；0值则表示两个变量之间不存在线性相关关系。</p>
<p>值得注意的是，Pearson相关系数只能检测线性关系，对于非线性关系可能会给出接近0的值，即使变量间存在强烈的非线性关联。这种方法对异常值比较敏感，且要求数据大致满足正态分布假设。</p>
<p><strong>R代码实现Pearson相关性计算</strong>：</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="相关性与相似性.html#cb494-1" tabindex="-1"></a><span class="co"># Pearson相关系数示例：树木胸径与树高的关系</span></span>
<span id="cb494-2"><a href="相关性与相似性.html#cb494-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb494-3"><a href="相关性与相似性.html#cb494-3" tabindex="-1"></a></span>
<span id="cb494-4"><a href="相关性与相似性.html#cb494-4" tabindex="-1"></a><span class="co"># 模拟树木数据</span></span>
<span id="cb494-5"><a href="相关性与相似性.html#cb494-5" tabindex="-1"></a>n_trees <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb494-6"><a href="相关性与相似性.html#cb494-6" tabindex="-1"></a>dbh <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_trees, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="dv">5</span>) <span class="co"># 胸径(cm)</span></span>
<span id="cb494-7"><a href="相关性与相似性.html#cb494-7" tabindex="-1"></a>height <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> dbh <span class="sc">+</span> <span class="fu">rnorm</span>(n_trees, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>) <span class="co"># 树高(m)</span></span>
<span id="cb494-8"><a href="相关性与相似性.html#cb494-8" tabindex="-1"></a></span>
<span id="cb494-9"><a href="相关性与相似性.html#cb494-9" tabindex="-1"></a><span class="co"># 计算Pearson相关系数</span></span>
<span id="cb494-10"><a href="相关性与相似性.html#cb494-10" tabindex="-1"></a>pearson_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(dbh, height, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb494-11"><a href="相关性与相似性.html#cb494-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Pearson相关系数：&quot;</span>, <span class="fu">round</span>(pearson_cor, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Pearson相关系数： 0.59</code></pre>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="相关性与相似性.html#cb496-1" tabindex="-1"></a><span class="co"># 可视化散点图</span></span>
<span id="cb496-2"><a href="相关性与相似性.html#cb496-2" tabindex="-1"></a><span class="fu">plot</span>(dbh, height,</span>
<span id="cb496-3"><a href="相关性与相似性.html#cb496-3" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb496-4"><a href="相关性与相似性.html#cb496-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;胸径 (cm)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;树高 (m)&quot;</span>,</span>
<span id="cb496-5"><a href="相关性与相似性.html#cb496-5" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;树木胸径与树高的关系&quot;</span></span>
<span id="cb496-6"><a href="相关性与相似性.html#cb496-6" tabindex="-1"></a>)</span>
<span id="cb496-7"><a href="相关性与相似性.html#cb496-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(height <span class="sc">~</span> dbh), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb496-8"><a href="相关性与相似性.html#cb496-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb496-9"><a href="相关性与相似性.html#cb496-9" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">paste</span>(<span class="st">&quot;r =&quot;</span>, <span class="fu">round</span>(pearson_cor, <span class="dv">3</span>)),</span>
<span id="cb496-10"><a href="相关性与相似性.html#cb496-10" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb496-11"><a href="相关性与相似性.html#cb496-11" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:pearson-figure"></span>
<img src="05-correlation_files/figure-html/pearson-figure-1.png" alt="树木胸径与树高的关系散点图，显示线性相关关系" width="672" />
<p class="caption">
图5.1: 树木胸径与树高的关系散点图，显示线性相关关系
</p>
</div>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="相关性与相似性.html#cb497-1" tabindex="-1"></a><span class="co"># 进行相关性检验</span></span>
<span id="cb497-2"><a href="相关性与相似性.html#cb497-2" tabindex="-1"></a>cor_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(dbh, height, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb497-3"><a href="相关性与相似性.html#cb497-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;相关性检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb497-4"><a href="相关性与相似性.html#cb497-4" tabindex="-1"></a>    <span class="st">&quot;t统计量：&quot;</span>, <span class="fu">round</span>(cor_test<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb497-5"><a href="相关性与相似性.html#cb497-5" tabindex="-1"></a>    <span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(cor_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb497-6"><a href="相关性与相似性.html#cb497-6" tabindex="-1"></a>    <span class="st">&quot;95%置信区间：[&quot;</span>, <span class="fu">round</span>(cor_test<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb497-7"><a href="相关性与相似性.html#cb497-7" tabindex="-1"></a>    <span class="st">&quot;,&quot;</span>, <span class="fu">round</span>(cor_test<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb497-8"><a href="相关性与相似性.html#cb497-8" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 相关性检验结果：
## t统计量：5.068
## p值：6.39e-06
## 95%置信区间：[0.373,0.746]</code></pre>
<p>在生态学研究中，Pearson相关系数常用于分析环境梯度与生物响应之间的线性趋势，如温度与物种丰富度的关系、土壤养分与植物生长的关系等。然而，生态学家需要谨慎使用这种方法，因为许多生态关系本质上是非线性的。此外，Pearson相关系数只能反映变量间的统计关联，不能证明因果关系，这在复杂的生态系统中尤为重要。</p>
</div>
<div id="spearman秩相关单调关系的度量" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Spearman秩相关：单调关系的度量<a href="相关性与相似性.html#spearman秩相关单调关系的度量" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在研究河流水质与底栖动物多样性的关系时，我们发现两者之间的关系可能不是严格的线性关系，但存在明显的单调趋势——水质越好，多样性越高。</p>
<p>Spearman秩相关系数是一种基于秩次的非参数相关性度量方法，由查尔斯·斯皮尔曼于1904年提出。与Pearson相关系数专注于线性关系不同，Spearman相关专门用于检测变量间的单调关系——即当一个变量增加时，另一个变量也倾向于增加（正单调关系）或减少（负单调关系），无论这种关系是线性的还是非线性的。</p>
<p>这种方法的独特之处在于它完全基于变量的秩次信息，而不是原始数值大小，这使得它对异常值具有天然的鲁棒性。在计算Spearman相关系数时，我们首先将每个变量的观测值转换为秩次（即按大小排序后的位置），然后计算这些秩次之间的Pearson相关系数。</p>
<p><strong>数学定义</strong>：对于两个变量<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>，Spearman相关系数<span class="math inline">\(\rho\)</span>定义为：</p>
<p><span class="math display">\[\rho = 1 - \frac{6\sum_{i=1}^{n}d_i^2}{n(n^2-1)}\]</span></p>
<p>其中<span class="math inline">\(d_i\)</span>是第<span class="math inline">\(i\)</span>个观测在<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>上的秩次差，<span class="math inline">\(n\)</span>是样本量。</p>
<p>Spearman相关系数的取值范围在-1到1之间。正值表示正单调关系，负值表示负单调关系，0值表示没有单调关系。值得注意的是，Spearman相关系数度量的是变量间关系的单调性强度，而不是线性强度。这意味着即使两个变量之间存在强烈的非线性单调关系，Spearman相关也能给出接近1或-1的值，而Pearson相关在这种情况下可能给出接近0的值。</p>
<p><strong>R代码实现Spearman相关性</strong>：</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="相关性与相似性.html#cb499-1" tabindex="-1"></a><span class="co"># Spearman秩相关示例：河流水质与底栖动物多样性</span></span>
<span id="cb499-2"><a href="相关性与相似性.html#cb499-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb499-3"><a href="相关性与相似性.html#cb499-3" tabindex="-1"></a></span>
<span id="cb499-4"><a href="相关性与相似性.html#cb499-4" tabindex="-1"></a><span class="co"># 模拟河流数据</span></span>
<span id="cb499-5"><a href="相关性与相似性.html#cb499-5" tabindex="-1"></a>n_rivers <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb499-6"><a href="相关性与相似性.html#cb499-6" tabindex="-1"></a>water_quality <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_rivers, <span class="dv">0</span>, <span class="dv">100</span>) <span class="co"># 水质指数（0-100）</span></span>
<span id="cb499-7"><a href="相关性与相似性.html#cb499-7" tabindex="-1"></a><span class="co"># 模拟单调但非线性的关系</span></span>
<span id="cb499-8"><a href="相关性与相似性.html#cb499-8" tabindex="-1"></a>macroinvertebrate_diversity <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> water_quality <span class="sc">+</span></span>
<span id="cb499-9"><a href="相关性与相似性.html#cb499-9" tabindex="-1"></a>  <span class="fl">0.01</span> <span class="sc">*</span> water_quality<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb499-10"><a href="相关性与相似性.html#cb499-10" tabindex="-1"></a>  <span class="fu">rnorm</span>(n_rivers, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb499-11"><a href="相关性与相似性.html#cb499-11" tabindex="-1"></a></span>
<span id="cb499-12"><a href="相关性与相似性.html#cb499-12" tabindex="-1"></a><span class="co"># 计算Spearman相关系数</span></span>
<span id="cb499-13"><a href="相关性与相似性.html#cb499-13" tabindex="-1"></a>spearman_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(water_quality, macroinvertebrate_diversity, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb499-14"><a href="相关性与相似性.html#cb499-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Spearman相关系数：&quot;</span>, <span class="fu">round</span>(spearman_cor, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Spearman相关系数： 0.991</code></pre>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="相关性与相似性.html#cb501-1" tabindex="-1"></a><span class="co"># 进行相关性检验</span></span>
<span id="cb501-2"><a href="相关性与相似性.html#cb501-2" tabindex="-1"></a>spearman_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(water_quality, macroinvertebrate_diversity, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb501-3"><a href="相关性与相似性.html#cb501-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Spearman检验p值：&quot;</span>, <span class="fu">format.pval</span>(spearman_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Spearman检验p值： &lt;2e-16</code></pre>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="相关性与相似性.html#cb503-1" tabindex="-1"></a><span class="co"># 可视化关系</span></span>
<span id="cb503-2"><a href="相关性与相似性.html#cb503-2" tabindex="-1"></a><span class="fu">plot</span>(water_quality, macroinvertebrate_diversity,</span>
<span id="cb503-3"><a href="相关性与相似性.html#cb503-3" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb503-4"><a href="相关性与相似性.html#cb503-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;水质指数&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;底栖动物多样性&quot;</span>,</span>
<span id="cb503-5"><a href="相关性与相似性.html#cb503-5" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;河流水质与底栖动物多样性的关系&quot;</span></span>
<span id="cb503-6"><a href="相关性与相似性.html#cb503-6" tabindex="-1"></a>)</span>
<span id="cb503-7"><a href="相关性与相似性.html#cb503-7" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(water_quality, macroinvertebrate_diversity), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb503-8"><a href="相关性与相似性.html#cb503-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb503-9"><a href="相关性与相似性.html#cb503-9" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">paste</span>(<span class="st">&quot;ρ =&quot;</span>, <span class="fu">round</span>(spearman_cor, <span class="dv">3</span>)),</span>
<span id="cb503-10"><a href="相关性与相似性.html#cb503-10" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb503-11"><a href="相关性与相似性.html#cb503-11" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:spearman-figure"></span>
<img src="05-correlation_files/figure-html/spearman-figure-1.png" alt="河流水质与底栖动物多样性的关系散点图，显示单调非线性关系" width="672" />
<p class="caption">
图5.2: 河流水质与底栖动物多样性的关系散点图，显示单调非线性关系
</p>
</div>
<p>在生态学研究中，这种特性使得Spearman相关特别适用于分析等级数据、存在异常值的数据、或者分布未知的数据。例如，在分析环境梯度对物种分布的影响时，许多生态响应关系本质上是单调但非线性的，如物种丰富度随海拔或纬度的变化、生物量随养分浓度的变化等。此外，Spearman相关对数据的分布形式没有严格要求，不要求变量满足正态分布假设，这使其在处理生态学中常见的偏态分布数据时具有明显优势。然而，生态学家需要注意，Spearman相关只能检测单调关系，对于非单调的复杂关系（如U型关系、周期性关系）仍然无法有效识别。</p>
</div>
<div id="kendalls-τ基于一致对的比例" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Kendall’s τ：基于一致对的比例<a href="相关性与相似性.html#kendalls-τ基于一致对的比例" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在研究鸟类迁徙时间与气温变化的关系时，我们想要一个对异常值不敏感的相关性度量，因为个别极端天气事件可能影响整体趋势的判断。</p>
<p>Kendall’s τ（tau）是另一种基于秩次的非参数相关性度量方法，由英国统计学家莫里斯·肯德尔于1938年提出。与Spearman相关类似，Kendall’s τ也用于度量变量间的单调关系，但其计算原理和统计性质有所不同。Kendall’s τ的核心思想是基于数据对的一致性来评估变量间的关系强度。具体而言，它考察所有可能的数据对（共<span class="math inline">\(\frac{1}{2}n(n-1)\)</span>对），统计其中一致对和不一致对的数量。一致对是指当<span class="math inline">\(X_i &lt; X_j\)</span>时<span class="math inline">\(Y_i &lt; Y_j\)</span>，或者当<span class="math inline">\(X_i &gt; X_j\)</span>时<span class="math inline">\(Y_i &gt; Y_j\)</span>的数据对，即两个变量在排序上保持一致；不一致对则是指排序相反的数据对。</p>
<p><strong>数学定义</strong>：对于两个变量<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>，Kendall’s τ定义为：</p>
<p><span class="math display">\[\tau = \frac{(一致对的数量) - (不一致对的数量)}{\frac{1}{2}n(n-1)}\]</span></p>
<p>其中一致对是指当<span class="math inline">\(X_i &lt; X_j\)</span>时<span class="math inline">\(Y_i &lt; Y_j\)</span>，或者当<span class="math inline">\(X_i &gt; X_j\)</span>时<span class="math inline">\(Y_i &gt; Y_j\)</span>的数据对。</p>
<p>Kendall’s τ的计算公式反映了这种一致对与不一致对的净比例，其取值范围在-1到1之间，与Pearson和Spearman相关系数相同。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="相关性与相似性.html#cb504-1" tabindex="-1"></a><span class="co"># Kendall&#39;s τ示例：鸟类迁徙时间与气温变化</span></span>
<span id="cb504-2"><a href="相关性与相似性.html#cb504-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb504-3"><a href="相关性与相似性.html#cb504-3" tabindex="-1"></a></span>
<span id="cb504-4"><a href="相关性与相似性.html#cb504-4" tabindex="-1"></a><span class="co"># 模拟迁徙数据</span></span>
<span id="cb504-5"><a href="相关性与相似性.html#cb504-5" tabindex="-1"></a>n_years <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb504-6"><a href="相关性与相似性.html#cb504-6" tabindex="-1"></a>spring_temperature <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_years, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">3</span>) <span class="co"># 春季平均温度</span></span>
<span id="cb504-7"><a href="相关性与相似性.html#cb504-7" tabindex="-1"></a><span class="co"># 添加一个异常值</span></span>
<span id="cb504-8"><a href="相关性与相似性.html#cb504-8" tabindex="-1"></a>spring_temperature[<span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="dv">25</span> <span class="co"># 异常温暖的年份</span></span>
<span id="cb504-9"><a href="相关性与相似性.html#cb504-9" tabindex="-1"></a>arrival_date <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> spring_temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n_years, <span class="dv">0</span>, <span class="dv">5</span>) <span class="co"># 到达日期（儒略日）</span></span>
<span id="cb504-10"><a href="相关性与相似性.html#cb504-10" tabindex="-1"></a></span>
<span id="cb504-11"><a href="相关性与相似性.html#cb504-11" tabindex="-1"></a><span class="co"># 计算Kendall&#39;s τ</span></span>
<span id="cb504-12"><a href="相关性与相似性.html#cb504-12" tabindex="-1"></a>kendall_tau <span class="ot">&lt;-</span> <span class="fu">cor</span>(spring_temperature, arrival_date, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb504-13"><a href="相关性与相似性.html#cb504-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Kendall&#39;s τ：&quot;</span>, <span class="fu">round</span>(kendall_tau, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Kendall&#39;s τ： -0.54</code></pre>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="相关性与相似性.html#cb506-1" tabindex="-1"></a><span class="co"># 比较不同方法的结果</span></span>
<span id="cb506-2"><a href="相关性与相似性.html#cb506-2" tabindex="-1"></a>pearson_comp <span class="ot">&lt;-</span> <span class="fu">cor</span>(spring_temperature, arrival_date, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb506-3"><a href="相关性与相似性.html#cb506-3" tabindex="-1"></a>spearman_comp <span class="ot">&lt;-</span> <span class="fu">cor</span>(spring_temperature, arrival_date, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb506-4"><a href="相关性与相似性.html#cb506-4" tabindex="-1"></a></span>
<span id="cb506-5"><a href="相关性与相似性.html#cb506-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;不同相关性系数的比较：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb506-6"><a href="相关性与相似性.html#cb506-6" tabindex="-1"></a>    <span class="st">&quot;Pearson：&quot;</span>, <span class="fu">round</span>(pearson_comp, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb506-7"><a href="相关性与相似性.html#cb506-7" tabindex="-1"></a>    <span class="st">&quot;Spearman：&quot;</span>, <span class="fu">round</span>(spearman_comp, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb506-8"><a href="相关性与相似性.html#cb506-8" tabindex="-1"></a>    <span class="st">&quot;Kendall&#39;s τ：&quot;</span>, <span class="fu">round</span>(kendall_tau, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb506-9"><a href="相关性与相似性.html#cb506-9" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 不同相关性系数的比较：
## Pearson：-0.79
## Spearman：-0.692
## Kendall&#39;s τ：-0.54</code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="相关性与相似性.html#cb508-1" tabindex="-1"></a><span class="co"># 可视化数据</span></span>
<span id="cb508-2"><a href="相关性与相似性.html#cb508-2" tabindex="-1"></a><span class="fu">plot</span>(spring_temperature, arrival_date,</span>
<span id="cb508-3"><a href="相关性与相似性.html#cb508-3" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>,</span>
<span id="cb508-4"><a href="相关性与相似性.html#cb508-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;春季平均温度 (°C)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;鸟类到达日期（儒略日）&quot;</span>,</span>
<span id="cb508-5"><a href="相关性与相似性.html#cb508-5" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;气温变化与鸟类迁徙时间的关系&quot;</span></span>
<span id="cb508-6"><a href="相关性与相似性.html#cb508-6" tabindex="-1"></a>)</span>
<span id="cb508-7"><a href="相关性与相似性.html#cb508-7" tabindex="-1"></a><span class="fu">points</span>(spring_temperature[<span class="dv">10</span>], arrival_date[<span class="dv">10</span>], <span class="at">pch =</span> <span class="dv">17</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb508-8"><a href="相关性与相似性.html#cb508-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb508-9"><a href="相关性与相似性.html#cb508-9" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;正常数据&quot;</span>, <span class="st">&quot;异常值&quot;</span>),</span>
<span id="cb508-10"><a href="相关性与相似性.html#cb508-10" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">17</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;purple&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb508-11"><a href="相关性与相似性.html#cb508-11" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-5-1.png" alt="鸟类迁徙时间与气温变化的关系散点图，显示对异常值的稳健性" width="672" />
<p class="caption">
图2.3: 鸟类迁徙时间与气温变化的关系散点图，显示对异常值的稳健性
</p>
</div>
<p>Kendall’s τ的一个重要特点是其对异常值的极端稳健性。由于它只关注数据对的相对排序而不关心具体的数值大小，单个异常值对整体估计的影响非常有限。这种特性使得Kendall’s τ特别适用于生态学中常见的小样本研究、存在测量误差的数据、或者包含极端观测值的情况。例如，在气候变化对物候影响的研究中，个别异常温暖的年份可能会显著影响Pearson相关系数的估计，但对Kendall’s τ的影响相对较小。另一个重要优势是Kendall’s τ具有更直观的概率解释：当Kendall’s τ等于0.6时，可以理解为任意随机选择的一对观测值，它们在这两个变量上具有一致排序的概率比不一致排序的概率高60%。这种概率解释在生态学应用中往往比相关系数本身更容易理解和传达。此外，Kendall’s τ的抽样分布在小样本情况下更加稳定，其标准误的计算也比Spearman相关更为精确。然而，Kendall’s τ的计算复杂度较高，对于大样本数据计算时间较长，这是其在实际应用中的一个局限。在生态学研究中，Kendall’s τ特别适用于时间序列分析、物种对环境梯度的响应研究、以及需要处理等级数据或存在大量结（ties）的情况。</p>
</div>
<div id="偏相关分析" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> 偏相关分析<a href="相关性与相似性.html#偏相关分析" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在研究森林生产力与降水量的关系时，我们发现温度可能同时影响这两个变量。为了了解降水量对生产力的直接影响，我们需要控制温度的影响。</p>
<p>偏相关分析是一种重要的统计技术，用于在控制其他变量（称为控制变量或协变量）的影响后，评估两个变量之间的净相关关系。在生态学研究中，变量间的关系往往受到多种环境因子的共同影响，简单的双变量相关分析可能无法揭示变量间的真实关系。偏相关分析通过数学方法”剥离”控制变量的影响，使我们能够更准确地评估目标变量间的直接关系。</p>
<p>这种方法的理论基础可以追溯到20世纪初，但直到多元统计方法的发展才在生态学中得到广泛应用。偏相关分析的核心思想是：如果两个变量<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>都与第三个变量<span class="math inline">\(Z\)</span>相关，那么<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>之间的简单相关可能部分或完全由它们与<span class="math inline">\(Z\)</span>的共同关系所驱动。通过控制<span class="math inline">\(Z\)</span>的影响，我们可以得到<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>之间的”纯净”相关，即排除了<span class="math inline">\(Z\)</span>的混淆效应后的直接关系。</p>
<p>偏相关系数的计算基于残差分析的思想。具体而言，我们首先通过线性回归分别从<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>中去除<span class="math inline">\(Z\)</span>的影响，得到两个残差序列，然后计算这两个残差序列之间的相关系数。这个相关系数就是<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>在控制<span class="math inline">\(Z\)</span>后的偏相关系数。不过目前我们还为涉及回归的知识，因此我们来介绍一种计算上更加简单的方式。</p>
<p><strong>数学定义</strong>：对于变量<span class="math inline">\(X\)</span>、<span class="math inline">\(Y\)</span>和控制变量<span class="math inline">\(Z\)</span>，<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>在控制<span class="math inline">\(Z\)</span>后的偏相关系数为：</p>
<p><span class="math display">\[r_{XY.Z} = \frac{r_{XY} - r_{XZ}r_{YZ}}{\sqrt{(1-r_{XZ}^2)(1-r_{YZ}^2)}}\]</span></p>
<p>其中<span class="math inline">\(r_{XY}\)</span>、<span class="math inline">\(r_{XZ}\)</span>、<span class="math inline">\(r_{YZ}\)</span>分别是相应的Pearson相关系数。</p>
<p>从数学上看，偏相关系数可以理解为在保持<span class="math inline">\(Z\)</span>不变的情况下，<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>之间的条件相关。有兴趣的同学可以自行证明一下，该定义与上述提到的残差定义方法，其实是等价的。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="相关性与相似性.html#cb509-1" tabindex="-1"></a><span class="co"># 偏相关分析示例：森林生产力与降水量的关系</span></span>
<span id="cb509-2"><a href="相关性与相似性.html#cb509-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb509-3"><a href="相关性与相似性.html#cb509-3" tabindex="-1"></a></span>
<span id="cb509-4"><a href="相关性与相似性.html#cb509-4" tabindex="-1"></a><span class="co"># 模拟森林生态系统数据</span></span>
<span id="cb509-5"><a href="相关性与相似性.html#cb509-5" tabindex="-1"></a>n_plots <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb509-6"><a href="相关性与相似性.html#cb509-6" tabindex="-1"></a>precipitation <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_plots, <span class="at">mean =</span> <span class="dv">1000</span>, <span class="at">sd =</span> <span class="dv">200</span>) <span class="co"># 年降水量(mm)</span></span>
<span id="cb509-7"><a href="相关性与相似性.html#cb509-7" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_plots, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">3</span>) <span class="co"># 年平均温度(°C)</span></span>
<span id="cb509-8"><a href="相关性与相似性.html#cb509-8" tabindex="-1"></a><span class="co"># 生产力同时受降水和温度影响</span></span>
<span id="cb509-9"><a href="相关性与相似性.html#cb509-9" tabindex="-1"></a>productivity <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.002</span> <span class="sc">*</span> precipitation <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fu">rnorm</span>(n_plots, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb509-10"><a href="相关性与相似性.html#cb509-10" tabindex="-1"></a></span>
<span id="cb509-11"><a href="相关性与相似性.html#cb509-11" tabindex="-1"></a><span class="co"># 计算简单相关系数</span></span>
<span id="cb509-12"><a href="相关性与相似性.html#cb509-12" tabindex="-1"></a>simple_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(precipitation, productivity)</span>
<span id="cb509-13"><a href="相关性与相似性.html#cb509-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;降水量与生产力的简单相关系数：&quot;</span>, <span class="fu">round</span>(simple_cor, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 降水量与生产力的简单相关系数： 0.33</code></pre>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="相关性与相似性.html#cb511-1" tabindex="-1"></a><span class="co"># 计算偏相关系数（控制温度影响）</span></span>
<span id="cb511-2"><a href="相关性与相似性.html#cb511-2" tabindex="-1"></a><span class="fu">library</span>(ppcor) <span class="co"># 需要安装：install.packages(&quot;ppcor&quot;)</span></span>
<span id="cb511-3"><a href="相关性与相似性.html#cb511-3" tabindex="-1"></a></span>
<span id="cb511-4"><a href="相关性与相似性.html#cb511-4" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb511-5"><a href="相关性与相似性.html#cb511-5" tabindex="-1"></a>eco_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(precipitation, temperature, productivity)</span>
<span id="cb511-6"><a href="相关性与相似性.html#cb511-6" tabindex="-1"></a>partial_cor <span class="ot">&lt;-</span> <span class="fu">pcor</span>(eco_data)<span class="sc">$</span>estimate</span>
<span id="cb511-7"><a href="相关性与相似性.html#cb511-7" tabindex="-1"></a></span>
<span id="cb511-8"><a href="相关性与相似性.html#cb511-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;偏相关系数矩阵：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 偏相关系数矩阵：</code></pre>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="相关性与相似性.html#cb513-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(partial_cor, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##               precipitation temperature productivity
## precipitation         1.000      -0.223        0.389
## temperature          -0.223       1.000        0.666
## productivity          0.389       0.666        1.000</code></pre>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="相关性与相似性.html#cb515-1" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb515-2"><a href="相关性与相似性.html#cb515-2" tabindex="-1"></a>  <span class="st">&quot;</span><span class="sc">\n</span><span class="st">控制温度后，降水量与生产力的偏相关系数：&quot;</span>,</span>
<span id="cb515-3"><a href="相关性与相似性.html#cb515-3" tabindex="-1"></a>  <span class="fu">round</span>(partial_cor[<span class="st">&quot;precipitation&quot;</span>, <span class="st">&quot;productivity&quot;</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb515-4"><a href="相关性与相似性.html#cb515-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 
## 控制温度后，降水量与生产力的偏相关系数： 0.389</code></pre>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="相关性与相似性.html#cb517-1" tabindex="-1"></a><span class="co"># 可视化偏相关关系</span></span>
<span id="cb517-2"><a href="相关性与相似性.html#cb517-2" tabindex="-1"></a><span class="co"># 使用残差法展示偏相关</span></span>
<span id="cb517-3"><a href="相关性与相似性.html#cb517-3" tabindex="-1"></a>resid_precip <span class="ot">&lt;-</span> <span class="fu">resid</span>(<span class="fu">lm</span>(precipitation <span class="sc">~</span> temperature))</span>
<span id="cb517-4"><a href="相关性与相似性.html#cb517-4" tabindex="-1"></a>resid_prod <span class="ot">&lt;-</span> <span class="fu">resid</span>(<span class="fu">lm</span>(productivity <span class="sc">~</span> temperature))</span>
<span id="cb517-5"><a href="相关性与相似性.html#cb517-5" tabindex="-1"></a></span>
<span id="cb517-6"><a href="相关性与相似性.html#cb517-6" tabindex="-1"></a><span class="fu">plot</span>(resid_precip, resid_prod,</span>
<span id="cb517-7"><a href="相关性与相似性.html#cb517-7" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;brown&quot;</span>,</span>
<span id="cb517-8"><a href="相关性与相似性.html#cb517-8" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;降水量残差（控制温度后）&quot;</span>,</span>
<span id="cb517-9"><a href="相关性与相似性.html#cb517-9" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;生产力残差（控制温度后）&quot;</span>,</span>
<span id="cb517-10"><a href="相关性与相似性.html#cb517-10" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;控制温度影响后的降水量与生产力关系&quot;</span></span>
<span id="cb517-11"><a href="相关性与相似性.html#cb517-11" tabindex="-1"></a>)</span>
<span id="cb517-12"><a href="相关性与相似性.html#cb517-12" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(resid_prod <span class="sc">~</span> resid_precip), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb517-13"><a href="相关性与相似性.html#cb517-13" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb517-14"><a href="相关性与相似性.html#cb517-14" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">paste</span>(</span>
<span id="cb517-15"><a href="相关性与相似性.html#cb517-15" tabindex="-1"></a>    <span class="st">&quot;偏相关系数 =&quot;</span>,</span>
<span id="cb517-16"><a href="相关性与相似性.html#cb517-16" tabindex="-1"></a>    <span class="fu">round</span>(partial_cor[<span class="st">&quot;precipitation&quot;</span>, <span class="st">&quot;productivity&quot;</span>], <span class="dv">3</span>)</span>
<span id="cb517-17"><a href="相关性与相似性.html#cb517-17" tabindex="-1"></a>  ),</span>
<span id="cb517-18"><a href="相关性与相似性.html#cb517-18" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb517-19"><a href="相关性与相似性.html#cb517-19" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-8-1.png" alt="控制温度影响后的降水量与生产力关系散点图" width="672" />
<p class="caption">
图2.4: 控制温度影响后的降水量与生产力关系散点图
</p>
</div>
<p>在生态学应用中，偏相关分析具有极其重要的价值。例如，在研究森林生产力与降水量的关系时，温度可能同时影响这两个变量——温度较高时通常降水量也较多，同时温度本身也直接影响植物的光合作用效率。如果不控制温度的影响，我们可能会高估降水量对生产力的直接作用。偏相关分析能够帮助我们识别这种”伪相关”或”间接相关”，从而更准确地理解生态系统的内在机制。此外，偏相关分析在生态网络构建、物种相互作用分析、环境因子筛选等复杂生态学问题中都有广泛应用。然而，生态学家需要注意，偏相关分析仍然基于线性关系的假设，且要求控制变量与目标变量之间的关系大致满足线性模型的前提条件。在高度非线性的生态系统中，偏相关分析的结果需要谨慎解释。</p>
</div>
</div>
<div id="非线性相关" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> 非线性相关<a href="相关性与相似性.html#非线性相关" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>生态系统中许多关系都是非线性的，如物种-面积关系、剂量-响应关系、种群增长模型等。传统的线性相关方法往往无法充分描述这些复杂模式。</p>
<p>非线性关系度量包括后面将要介绍的距离相关、互信息等方法，它们不依赖于线性假设，能够捕捉各种复杂的关系模式。在生态学研究中，非线性关系比线性关系更为普遍，因为生态系统中的许多过程都涉及阈值效应、饱和效应、最优区间和反馈机制等非线性动态。例如，物种-面积关系通常呈现幂律形式，种群增长遵循逻辑斯蒂曲线，功能性状间的权衡关系可能呈现U型或S型模式，物种对环境梯度的响应往往存在最优区间。这些复杂的非线性模式无法用传统的线性相关方法来充分描述，因此需要专门的非线性关系度量方法。</p>
<p>距离相关和互信息是两种主要的非线性关系度量方法，它们各有特点和适用场景。距离相关基于变量在距离空间中的协方差来度量依赖关系，能够检测任何形式的统计依赖，包括线性和非线性关系。它的一个重要性质是当且仅当两个变量相互独立时，距离相关系数等于零，这使其成为检验变量独立性的有力工具。距离相关对变量的分布形式没有要求，适用于连续变量和混合类型的数据，但在计算复杂度上相对较高，特别是对于大样本数据。</p>
<p>互信息则基于信息论的概念，量化两个变量间共享的信息量。它能够检测任何类型的统计依赖关系，包括线性和非线性关系、单调和非单调关系。互信息的一个重要优势是它对变量的数据类型没有限制，可以处理连续变量、离散变量和分类变量，这使其特别适合生态学中常见的混合数据类型分析。此外，互信息具有清晰的信息论解释，能够提供关于变量间信息共享程度的直观理解。</p>
<p>除了距离相关和互信息，还有其他非线性关系度量方法，如基于核的方法、基于图的方法和基于模型的方法。基于核的方法通过将数据映射到高维特征空间来检测非线性关系，基于图的方法通过构建变量间的图结构来识别依赖关系，基于模型的方法则通过拟合非线性模型来量化关系强度。在生态学实践中，选择哪种非线性关系度量方法需要考虑数据的特征、研究的目的和计算资源的限制。通常建议使用多种方法进行比较，以获得对生态关系更全面和稳健的认识。</p>
<div id="距离相关" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> 距离相关<a href="相关性与相似性.html#距离相关" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在研究植物功能性状之间的关系时，我们可能发现某些性状间存在复杂的非线性关系，传统的线性相关方法无法有效捕捉这些模式。</p>
<p>距离相关是一种革命性的非参数相关性度量方法，由统计学家Gábor J. Székely等人于2007年提出，它能够检测任意分布变量间的依赖关系，包括线性和非线性关系。与传统的相关性度量方法不同，距离相关不依赖于变量间的线性或单调关系假设，而是基于变量间距离的协方差来度量相关性。这种方法的独特之处在于它能够检测任何形式的统计依赖关系，只要这种依赖关系在概率意义上是存在的。</p>
<p>距离相关的核心概念是距离协方差和距离方差，这些概念扩展了传统的协方差和方差概念，使其能够捕捉更复杂的依赖模式。距离协方差度量的是两个变量在距离空间中的协同变化程度，而距离方差则度量单个变量在距离空间中的变异程度。</p>
<p><strong>数学定义</strong>：对于两个变量<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>，距离相关系数定义为：</p>
<p><span class="math display">\[dCor(X,Y) = \frac{dCov(X,Y)}{\sqrt{dVar(X)dVar(Y)}}\]</span></p>
<p>其中<span class="math inline">\(dCov\)</span>是距离协方差，<span class="math inline">\(dVar\)</span>是距离方差。距离协方差就是量化这种”距离同步性”的程度。如果两个变量的距离模式高度同步，距离协方差就大；如果它们的距离模式没有关系，距离协方差就接近0。距离方差则衡量单个变量内部的”距离变异”程度。如果一个变量的所有值都很接近，距离方差就小；如果值之间差异很大，距离方差就大。</p>
<p>距离相关的核心思想很简单：<strong>通过比较所有数据点之间的距离模式来检测变量间的依赖关系</strong>。想象你有两个变量，比如植物的叶面积和光合速率。如果这两个变量相关，那么当两个植物的叶面积很接近时，它们的光合速率也应该很接近；当两个植物的叶面积差异很大时，它们的光合速率差异也应该很大。为了更直观地理解距离相关的概念，我们可以通过下面的示意图来展示弱距离相关和强距离相关的区别：</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:distance-correlation-diagram"></span>
<img src="05-correlation_files/figure-html/distance-correlation-diagram-1.png" alt="距离相关强弱对比示意图：左图显示弱距离相关（变量间距离模式不同步），右图显示强距离相关（变量间距离模式高度同步）" width="960" />
<p class="caption">
图5.3: 距离相关强弱对比示意图：左图显示弱距离相关（变量间距离模式不同步），右图显示强距离相关（变量间距离模式高度同步）
</p>
</div>
<p><strong>图解说明</strong>：</p>
<ul>
<li><p><strong>弱距离相关</strong>（左图）：变量X和Y之间没有明显的依赖关系。当两个数据点在X轴上很接近时，它们在Y轴上的值可能相差很大，反之亦然。这种距离模式的不同步导致距离相关系数接近0。</p></li>
<li><p><strong>强距离相关</strong>（右图）：变量X和Y之间存在明显的非线性依赖关系。当两个数据点在X轴上很接近时，它们在Y轴上的值也很接近；当两个数据点在X轴上相距较远时，它们在Y轴上的值也相距较远。这种距离模式的同步性导致距离相关系数接近1。</p></li>
</ul>
<p>距离相关的核心思想正是通过比较所有数据点之间的距离模式来检测变量间的依赖关系。如果两个变量的距离模式高度同步（强相关），那么距离协方差就大；如果它们的距离模式没有关系（弱相关），距离协方差就接近0。</p>
<p>距离相关系数的取值范围在0到1之间，其中0表示变量间完全独立，1表示变量间存在确定的函数关系。值得注意的是，距离相关具有一个非常重要的性质：当且仅当两个变量相互独立时，距离相关系数等于0。这一性质使得距离相关成为检验变量独立性的有力工具。</p>
<p>在生态学研究中，这种特性具有重要的应用价值。许多生态关系本质上是非线性的，如物种-面积关系、功能性状权衡、种群动态模型等，传统的线性相关方法往往无法充分描述这些复杂模式。距离相关能够有效捕捉这些非线性关系，为生态学家提供了更全面的分析工具。例如，在分析植物功能性状间的关系时，我们可能发现叶面积与比叶重之间存在U型关系——中等大小的叶片具有最高的比叶重，而过大或过小的叶片比叶重较低。这种复杂的非线性关系用Pearson或Spearman相关可能无法有效检测，但距离相关能够给出显著的非零值。此外，距离相关对变量的分布形式没有要求，适用于连续变量、离散变量甚至混合类型的数据，这使其在处理生态学中常见的复杂数据类型时具有明显优势。然而，生态学家需要注意，距离相关的计算复杂度较高，对于大样本数据可能需要较长的计算时间，且其统计性质在小样本情况下的表现仍需谨慎评估。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="相关性与相似性.html#cb518-1" tabindex="-1"></a><span class="co"># 距离相关示例：植物功能性状间的关系</span></span>
<span id="cb518-2"><a href="相关性与相似性.html#cb518-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb518-3"><a href="相关性与相似性.html#cb518-3" tabindex="-1"></a></span>
<span id="cb518-4"><a href="相关性与相似性.html#cb518-4" tabindex="-1"></a><span class="co"># 模拟植物功能性状数据</span></span>
<span id="cb518-5"><a href="相关性与相似性.html#cb518-5" tabindex="-1"></a>n_plants <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb518-6"><a href="相关性与相似性.html#cb518-6" tabindex="-1"></a>leaf_area <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_plants, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>) <span class="co"># 叶面积(cm²)</span></span>
<span id="cb518-7"><a href="相关性与相似性.html#cb518-7" tabindex="-1"></a><span class="co"># 模拟非线性关系：比叶重与叶面积的U型关系</span></span>
<span id="cb518-8"><a href="相关性与相似性.html#cb518-8" tabindex="-1"></a>specific_leaf_area <span class="ot">&lt;-</span> <span class="dv">150</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> (leaf_area <span class="sc">-</span> <span class="dv">20</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n_plants, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb518-9"><a href="相关性与相似性.html#cb518-9" tabindex="-1"></a></span>
<span id="cb518-10"><a href="相关性与相似性.html#cb518-10" tabindex="-1"></a><span class="co"># 计算距离相关</span></span>
<span id="cb518-11"><a href="相关性与相似性.html#cb518-11" tabindex="-1"></a><span class="fu">library</span>(energy) <span class="co"># 需要安装：install.packages(&quot;energy&quot;)</span></span>
<span id="cb518-12"><a href="相关性与相似性.html#cb518-12" tabindex="-1"></a></span>
<span id="cb518-13"><a href="相关性与相似性.html#cb518-13" tabindex="-1"></a>dcor_result <span class="ot">&lt;-</span> <span class="fu">dcor</span>(leaf_area, specific_leaf_area)</span>
<span id="cb518-14"><a href="相关性与相似性.html#cb518-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;距离相关系数：&quot;</span>, <span class="fu">round</span>(dcor_result, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 距离相关系数： 0.454</code></pre>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="相关性与相似性.html#cb520-1" tabindex="-1"></a><span class="co"># 比较不同相关性方法</span></span>
<span id="cb520-2"><a href="相关性与相似性.html#cb520-2" tabindex="-1"></a>pearson_dc <span class="ot">&lt;-</span> <span class="fu">cor</span>(leaf_area, specific_leaf_area, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb520-3"><a href="相关性与相似性.html#cb520-3" tabindex="-1"></a>spearman_dc <span class="ot">&lt;-</span> <span class="fu">cor</span>(leaf_area, specific_leaf_area, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb520-4"><a href="相关性与相似性.html#cb520-4" tabindex="-1"></a></span>
<span id="cb520-5"><a href="相关性与相似性.html#cb520-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;不同相关性方法的比较：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb520-6"><a href="相关性与相似性.html#cb520-6" tabindex="-1"></a>    <span class="st">&quot;Pearson相关系数：&quot;</span>, <span class="fu">round</span>(pearson_dc, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb520-7"><a href="相关性与相似性.html#cb520-7" tabindex="-1"></a>    <span class="st">&quot;Spearman相关系数：&quot;</span>, <span class="fu">round</span>(spearman_dc, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb520-8"><a href="相关性与相似性.html#cb520-8" tabindex="-1"></a>    <span class="st">&quot;距离相关系数：&quot;</span>, <span class="fu">round</span>(dcor_result, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb520-9"><a href="相关性与相似性.html#cb520-9" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 不同相关性方法的比较：
## Pearson相关系数：0.133
## Spearman相关系数：0.04
## 距离相关系数：0.454</code></pre>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="相关性与相似性.html#cb522-1" tabindex="-1"></a><span class="co"># 可视化非线性关系</span></span>
<span id="cb522-2"><a href="相关性与相似性.html#cb522-2" tabindex="-1"></a><span class="fu">plot</span>(leaf_area, specific_leaf_area,</span>
<span id="cb522-3"><a href="相关性与相似性.html#cb522-3" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb522-4"><a href="相关性与相似性.html#cb522-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;叶面积 (cm²)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;比叶重 (g/m²)&quot;</span>,</span>
<span id="cb522-5"><a href="相关性与相似性.html#cb522-5" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;植物功能性状间的非线性关系&quot;</span></span>
<span id="cb522-6"><a href="相关性与相似性.html#cb522-6" tabindex="-1"></a>)</span>
<span id="cb522-7"><a href="相关性与相似性.html#cb522-7" tabindex="-1"></a></span>
<span id="cb522-8"><a href="相关性与相似性.html#cb522-8" tabindex="-1"></a><span class="co"># 添加局部回归曲线</span></span>
<span id="cb522-9"><a href="相关性与相似性.html#cb522-9" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(leaf_area, specific_leaf_area), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb522-10"><a href="相关性与相似性.html#cb522-10" tabindex="-1"></a></span>
<span id="cb522-11"><a href="相关性与相似性.html#cb522-11" tabindex="-1"></a><span class="co"># 添加二次拟合曲线</span></span>
<span id="cb522-12"><a href="相关性与相似性.html#cb522-12" tabindex="-1"></a>quad_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(specific_leaf_area <span class="sc">~</span> <span class="fu">poly</span>(leaf_area, <span class="dv">2</span>))</span>
<span id="cb522-13"><a href="相关性与相似性.html#cb522-13" tabindex="-1"></a>leaf_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(leaf_area), <span class="fu">max</span>(leaf_area), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb522-14"><a href="相关性与相似性.html#cb522-14" tabindex="-1"></a>pred_quad <span class="ot">&lt;-</span> <span class="fu">predict</span>(quad_fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">leaf_area =</span> leaf_seq))</span>
<span id="cb522-15"><a href="相关性与相似性.html#cb522-15" tabindex="-1"></a><span class="fu">lines</span>(leaf_seq, pred_quad, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb522-16"><a href="相关性与相似性.html#cb522-16" tabindex="-1"></a></span>
<span id="cb522-17"><a href="相关性与相似性.html#cb522-17" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;top&quot;</span>,</span>
<span id="cb522-18"><a href="相关性与相似性.html#cb522-18" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;观测数据&quot;</span>, <span class="st">&quot;局部回归&quot;</span>, <span class="st">&quot;二次拟合&quot;</span>),</span>
<span id="cb522-19"><a href="相关性与相似性.html#cb522-19" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb522-20"><a href="相关性与相似性.html#cb522-20" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>, <span class="cn">NA</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb522-21"><a href="相关性与相似性.html#cb522-21" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-10-1.png" alt="植物功能性状间的非线性关系散点图，显示U型关系" width="672" />
<p class="caption">
图2.6: 植物功能性状间的非线性关系散点图，显示U型关系
</p>
</div>
</div>
<div id="互信息" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> 互信息<a href="相关性与相似性.html#互信息" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在研究环境因子对物种分布的联合影响时，我们想要量化多个环境变量共同包含的关于物种分布的信息量。</p>
<p>互信息是基于信息论的依赖关系度量，它量化了两个变量间共享的信息量。与传统的相关性不同，互信息能够捕捉任何类型的统计依赖关系。互信息的概念源于信息论，由克劳德·香农在1948年提出，最初用于通信系统中的信息传输研究，后来被广泛应用于统计分析和机器学习领域。</p>
<p>互信息的核心思想是衡量知道一个变量的值能够减少另一个变量不确定性的程度。从信息论的角度来看，如果两个变量完全独立，那么知道其中一个变量的值不会提供关于另一个变量的任何信息，此时互信息为零；如果两个变量存在完全确定的函数关系，那么知道一个变量的值就能完全确定另一个变量，此时互信息达到最大值。</p>
<p><strong>数学定义</strong>：对于两个离散随机变量<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>，互信息定义为：</p>
<p><span class="math display">\[I(X;Y) = \sum_{x\in X}\sum_{y\in Y} p(x,y) \log\left(\frac{p(x,y)}{p(x)p(y)}\right)\]</span></p>
<p>对于连续变量，需要使用积分形式。</p>
<p>互信息的一个重要特性是它对变量间关系的类型没有限制，能够检测线性和非线性关系、单调和非单调关系，甚至是复杂的多模态关系。这种普适性使得互信息在生态学研究中具有独特的优势，因为许多生态关系本质上是非线性和复杂的。例如，在研究环境因子对物种分布的影响时，物种对环境梯度的响应往往不是简单的线性关系，而是存在阈值效应、饱和效应或最优区间等复杂模式。互信息能够有效捕捉这些复杂的依赖关系，而传统的线性相关方法可能会遗漏重要的生态信息。</p>
<p>另一个重要特点是互信息对变量的分布形式没有严格要求，适用于连续变量、离散变量甚至混合类型的数据。在生态学中，我们经常需要处理不同类型的数据，如连续的环境变量（温度、降水）、离散的分类变量（生境类型、土壤类型）和二元变量（物种出现/缺失）。互信息提供了一个统一的框架来处理这些不同类型变量间的依赖关系。</p>
<p>此外，互信息具有对称性，即<span class="math inline">\(I(X;Y) = I(Y;X)\)</span>，这反映了变量间信息共享的相互性。互信息的取值范围从0到正无穷，其中0表示变量间完全独立，正值表示存在信息共享。为了便于解释，有时会将互信息标准化到[0,1]区间，如通过除以变量的熵来得到标准化互信息。在生态学应用中，互信息特别适合用于特征选择、生态网络构建、物种分布建模等需要处理复杂非线性关系的场景。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="相关性与相似性.html#cb523-1" tabindex="-1"></a><span class="co"># 互信息示例：环境因子与物种分布的依赖关系</span></span>
<span id="cb523-2"><a href="相关性与相似性.html#cb523-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb523-3"><a href="相关性与相似性.html#cb523-3" tabindex="-1"></a></span>
<span id="cb523-4"><a href="相关性与相似性.html#cb523-4" tabindex="-1"></a><span class="co"># 模拟环境数据和物种出现数据</span></span>
<span id="cb523-5"><a href="相关性与相似性.html#cb523-5" tabindex="-1"></a>n_sites <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb523-6"><a href="相关性与相似性.html#cb523-6" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_sites, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>) <span class="co"># 温度</span></span>
<span id="cb523-7"><a href="相关性与相似性.html#cb523-7" tabindex="-1"></a>precipitation <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_sites, <span class="at">mean =</span> <span class="dv">800</span>, <span class="at">sd =</span> <span class="dv">200</span>) <span class="co"># 降水量</span></span>
<span id="cb523-8"><a href="相关性与相似性.html#cb523-8" tabindex="-1"></a></span>
<span id="cb523-9"><a href="相关性与相似性.html#cb523-9" tabindex="-1"></a><span class="co"># 物种出现概率与环境因子的复杂关系</span></span>
<span id="cb523-10"><a href="相关性与相似性.html#cb523-10" tabindex="-1"></a><span class="co"># 调整参数使物种出现概率更合理</span></span>
<span id="cb523-11"><a href="相关性与相似性.html#cb523-11" tabindex="-1"></a>species_prob <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="fl">0.1</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fl">0.002</span> <span class="sc">*</span> precipitation <span class="sc">-</span></span>
<span id="cb523-12"><a href="相关性与相似性.html#cb523-12" tabindex="-1"></a>  <span class="fl">0.0001</span> <span class="sc">*</span> temperature <span class="sc">*</span> precipitation <span class="sc">-</span> <span class="dv">5</span>)</span>
<span id="cb523-13"><a href="相关性与相似性.html#cb523-13" tabindex="-1"></a>species_presence <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_sites, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> species_prob)</span>
<span id="cb523-14"><a href="相关性与相似性.html#cb523-14" tabindex="-1"></a></span>
<span id="cb523-15"><a href="相关性与相似性.html#cb523-15" tabindex="-1"></a><span class="co"># 计算互信息</span></span>
<span id="cb523-16"><a href="相关性与相似性.html#cb523-16" tabindex="-1"></a><span class="fu">library</span>(infotheo) <span class="co"># 需要安装：install.packages(&quot;infotheo&quot;)</span></span>
<span id="cb523-17"><a href="相关性与相似性.html#cb523-17" tabindex="-1"></a></span>
<span id="cb523-18"><a href="相关性与相似性.html#cb523-18" tabindex="-1"></a><span class="co"># 离散化连续变量（互信息计算需要离散数据）</span></span>
<span id="cb523-19"><a href="相关性与相似性.html#cb523-19" tabindex="-1"></a>temp_disc <span class="ot">&lt;-</span> <span class="fu">discretize</span>(temperature, <span class="at">disc =</span> <span class="st">&quot;equalfreq&quot;</span>, <span class="at">nbins =</span> <span class="dv">5</span>)</span>
<span id="cb523-20"><a href="相关性与相似性.html#cb523-20" tabindex="-1"></a>precip_disc <span class="ot">&lt;-</span> <span class="fu">discretize</span>(precipitation, <span class="at">disc =</span> <span class="st">&quot;equalfreq&quot;</span>, <span class="at">nbins =</span> <span class="dv">5</span>)</span>
<span id="cb523-21"><a href="相关性与相似性.html#cb523-21" tabindex="-1"></a></span>
<span id="cb523-22"><a href="相关性与相似性.html#cb523-22" tabindex="-1"></a><span class="co"># 计算互信息</span></span>
<span id="cb523-23"><a href="相关性与相似性.html#cb523-23" tabindex="-1"></a>mi_temp <span class="ot">&lt;-</span> <span class="fu">mutinformation</span>(temp_disc, species_presence)</span>
<span id="cb523-24"><a href="相关性与相似性.html#cb523-24" tabindex="-1"></a>mi_precip <span class="ot">&lt;-</span> <span class="fu">mutinformation</span>(precip_disc, species_presence)</span>
<span id="cb523-25"><a href="相关性与相似性.html#cb523-25" tabindex="-1"></a>mi_joint <span class="ot">&lt;-</span> <span class="fu">mutinformation</span>(<span class="fu">cbind</span>(temp_disc, precip_disc), species_presence)</span>
<span id="cb523-26"><a href="相关性与相似性.html#cb523-26" tabindex="-1"></a></span>
<span id="cb523-27"><a href="相关性与相似性.html#cb523-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;互信息分析结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb523-28"><a href="相关性与相似性.html#cb523-28" tabindex="-1"></a>    <span class="st">&quot;温度与物种出现的互信息：&quot;</span>, <span class="fu">round</span>(mi_temp, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb523-29"><a href="相关性与相似性.html#cb523-29" tabindex="-1"></a>    <span class="st">&quot;降水量与物种出现的互信息：&quot;</span>, <span class="fu">round</span>(mi_precip, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb523-30"><a href="相关性与相似性.html#cb523-30" tabindex="-1"></a>    <span class="st">&quot;温度与降水量联合与物种出现的互信息：&quot;</span>, <span class="fu">round</span>(mi_joint, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb523-31"><a href="相关性与相似性.html#cb523-31" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 互信息分析结果：
## 温度与物种出现的互信息：0.038
## 降水量与物种出现的互信息：0.032
## 温度与降水量联合与物种出现的互信息：0.089</code></pre>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="相关性与相似性.html#cb525-1" tabindex="-1"></a><span class="co"># 可视化物种出现与环境因子的关系</span></span>
<span id="cb525-2"><a href="相关性与相似性.html#cb525-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb525-3"><a href="相关性与相似性.html#cb525-3" tabindex="-1"></a></span>
<span id="cb525-4"><a href="相关性与相似性.html#cb525-4" tabindex="-1"></a><span class="co"># 温度与物种出现</span></span>
<span id="cb525-5"><a href="相关性与相似性.html#cb525-5" tabindex="-1"></a><span class="fu">plot</span>(temperature, species_presence,</span>
<span id="cb525-6"><a href="相关性与相似性.html#cb525-6" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;blue&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.6</span>),</span>
<span id="cb525-7"><a href="相关性与相似性.html#cb525-7" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;温度 (°C)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;物种出现 (0/1)&quot;</span>,</span>
<span id="cb525-8"><a href="相关性与相似性.html#cb525-8" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;温度与物种出现的关系&quot;</span></span>
<span id="cb525-9"><a href="相关性与相似性.html#cb525-9" tabindex="-1"></a>)</span>
<span id="cb525-10"><a href="相关性与相似性.html#cb525-10" tabindex="-1"></a><span class="co"># 添加逻辑回归曲线</span></span>
<span id="cb525-11"><a href="相关性与相似性.html#cb525-11" tabindex="-1"></a>temp_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(temperature), <span class="fu">max</span>(temperature), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb525-12"><a href="相关性与相似性.html#cb525-12" tabindex="-1"></a>logit_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(species_presence <span class="sc">~</span> temperature, <span class="at">family =</span> binomial)</span>
<span id="cb525-13"><a href="相关性与相似性.html#cb525-13" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_fit,</span>
<span id="cb525-14"><a href="相关性与相似性.html#cb525-14" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">temperature =</span> temp_seq),</span>
<span id="cb525-15"><a href="相关性与相似性.html#cb525-15" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb525-16"><a href="相关性与相似性.html#cb525-16" tabindex="-1"></a>)</span>
<span id="cb525-17"><a href="相关性与相似性.html#cb525-17" tabindex="-1"></a><span class="fu">lines</span>(temp_seq, pred_prob, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb525-18"><a href="相关性与相似性.html#cb525-18" tabindex="-1"></a></span>
<span id="cb525-19"><a href="相关性与相似性.html#cb525-19" tabindex="-1"></a><span class="co"># 降水量与物种出现</span></span>
<span id="cb525-20"><a href="相关性与相似性.html#cb525-20" tabindex="-1"></a><span class="fu">plot</span>(precipitation, species_presence,</span>
<span id="cb525-21"><a href="相关性与相似性.html#cb525-21" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;green&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.6</span>),</span>
<span id="cb525-22"><a href="相关性与相似性.html#cb525-22" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;降水量 (mm)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;物种出现 (0/1)&quot;</span>,</span>
<span id="cb525-23"><a href="相关性与相似性.html#cb525-23" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;降水量与物种出现的关系&quot;</span></span>
<span id="cb525-24"><a href="相关性与相似性.html#cb525-24" tabindex="-1"></a>)</span>
<span id="cb525-25"><a href="相关性与相似性.html#cb525-25" tabindex="-1"></a><span class="co"># 添加逻辑回归曲线</span></span>
<span id="cb525-26"><a href="相关性与相似性.html#cb525-26" tabindex="-1"></a>precip_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(precipitation), <span class="fu">max</span>(precipitation), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb525-27"><a href="相关性与相似性.html#cb525-27" tabindex="-1"></a>logit_fit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(species_presence <span class="sc">~</span> precipitation, <span class="at">family =</span> binomial)</span>
<span id="cb525-28"><a href="相关性与相似性.html#cb525-28" tabindex="-1"></a>pred_prob2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit_fit2,</span>
<span id="cb525-29"><a href="相关性与相似性.html#cb525-29" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">precipitation =</span> precip_seq),</span>
<span id="cb525-30"><a href="相关性与相似性.html#cb525-30" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;response&quot;</span></span>
<span id="cb525-31"><a href="相关性与相似性.html#cb525-31" tabindex="-1"></a>)</span>
<span id="cb525-32"><a href="相关性与相似性.html#cb525-32" tabindex="-1"></a><span class="fu">lines</span>(precip_seq, pred_prob2, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:mutinformation-figure"></span>
<img src="05-correlation_files/figure-html/mutinformation-figure-1.png" alt="环境因子与物种分布的关系逻辑回归曲线" width="672" />
<p class="caption">
图5.4: 环境因子与物种分布的关系逻辑回归曲线
</p>
</div>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="相关性与相似性.html#cb526-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
</div>
</div>
<div id="时间自相关" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> 时间自相关<a href="相关性与相似性.html#时间自相关" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在前面的章节中，我们讨论了不同变量之间的相关性，如植物的叶面积与光合速率之间的关系。然而，在生态学研究中，许多数据还具有时间或空间依赖性，即同一变量在不同时间点或空间位置上的观测值之间往往存在某种关联。这种”自己与自己”的关联性被称为自相关，它反映了生态过程在时间或空间上的连续性。</p>
<p>与变量间的相关性不同，自相关关注的是同一变量内部的时间或空间依赖模式。理解自相关对于正确分析生态数据至关重要，因为忽略自相关可能导致统计推断的错误。</p>
<p>时间自相关是指同一变量在不同时间点上的观测值之间的相关性。在生态学中，许多过程都具有时间连续性，如种群动态、气候变化、物候变化等。时间自相关分析帮助我们理解这些过程的动态特征和内在规律。</p>
<p><strong>时间自相关的生态学意义</strong>：</p>
<p>时间自相关反映了生态系统的记忆效应和连续性特征。在自然界中，很少有生态过程是完全随机的——今天的种群数量会影响明天的数量，本月的降水量会影响下月的土壤湿度。这种时间依赖性源于多种生态机制：环境条件的持续性（如干旱期或湿润期的延续）、生物种群的繁殖和死亡过程、资源利用的累积效应等。</p>
<p>时间自相关主要分为三种类型：</p>
<ul>
<li><p><strong>正自相关</strong>：高值倾向于跟随高值，低值倾向于跟随低值。这反映了生态过程的惯性特征，如种群增长的持续性、气候变化的趋势性。强正自相关表明系统具有较强的记忆效应。</p></li>
<li><p><strong>负自相关</strong>：高值倾向于跟随低值，低值倾向于跟随高值。这反映了过度补偿或振荡调节机制，如捕食-被捕食系统的周期性波动、资源竞争的反馈调节。</p></li>
<li><p><strong>无自相关</strong>：观测值之间相互独立，没有明显的时间模式。这通常出现在纯粹的随机过程中，如某些环境噪声或短期天气波动。</p></li>
</ul>
<p>理解时间自相关对生态数据分析至关重要。忽略时间自相关会导致统计推断的偏差——低估标准误、增加假阳性风险、错误估计置信区间。在生态学研究中，正确识别和处理时间自相关是获得可靠科学结论的基础。</p>
<div id="生态学中的时间自相关实例" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> 生态学中的时间自相关实例<a href="相关性与相似性.html#生态学中的时间自相关实例" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>为了直观理解不同强度的时间自相关，让我们通过几个典型的生态学实例来观察：</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:time-autocorrelation-examples"></span>
<img src="05-correlation_files/figure-html/time-autocorrelation-examples-1.png" alt="生态学中不同强度时间自相关的实例对比：左图显示强正自相关（多年生植物种群动态），中图显示弱自相关（随机环境波动），右图显示负自相关（捕食-被捕食系统振荡）" width="1152" />
<p class="caption">
图5.5: 生态学中不同强度时间自相关的实例对比：左图显示强正自相关（多年生植物种群动态），中图显示弱自相关（随机环境波动），右图显示负自相关（捕食-被捕食系统振荡）
</p>
</div>
<p><strong>图解说明</strong>：</p>
<ul>
<li><p><strong>强正自相关</strong>（左图）：多年生植物种群动态显示明显的增长趋势，相邻年份的种群数量高度相关。这种模式反映了种群增长的惯性效应——良好的环境条件和繁殖成功会持续影响后续年份的种群规模。</p></li>
<li><p><strong>弱自相关</strong>（中图）：月降雨量的随机波动缺乏明显的连续模式，每个月的降雨量相对独立。这种模式常见于短期环境因素的随机变化，如局部天气系统的快速更替。</p></li>
<li><p><strong>负自相关</strong>（右图）：捕食者（猞猁）和被捕食者（雪兔）种群呈现明显的交替振荡。当一个物种达到高峰时，另一个物种处于低谷，形成了典型的负自相关模式，反映了生态系统中生物相互作用的反馈调节机制。</p></li>
</ul>
<p>这些实例清晰地展示了时间自相关在生态学研究中的普遍性和重要性。正确识别这些模式有助于我们理解生态过程的动态机制，并为建立准确的生态模型提供基础。</p>
</div>
<div id="自相关函数acf时间依赖性的量化" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> 自相关函数（ACF）：时间依赖性的量化<a href="相关性与相似性.html#自相关函数acf时间依赖性的量化" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>假设我们正在研究一个湖泊中浮游植物生物量的季节变化，我们记录了连续36个月的观测数据，想要了解生物量在不同时间滞后下的自相关性模式。</p>
<p>自相关函数是时间序列分析中最基础的工具之一，用于量化时间序列在不同时间滞后下的自相关性强度。ACF的核心思想是计算时间序列与其自身在不同时间滞后下的相关系数，从而揭示时间序列中的周期性、趋势和记忆效应。对于时间滞后<span class="math inline">\(k\)</span>，自相关系数<span class="math inline">\(\rho_k\)</span>定义为时间序列<span class="math inline">\(X_t\)</span>与<span class="math inline">\(X_{t+k}\)</span>之间的相关系数。ACF的取值范围在-1到1之间，正值表示正自相关（即高值倾向于跟随高值，低值倾向于跟随低值），负值表示负自相关（即高值倾向于跟随低值，低值倾向于跟随高值），0值表示没有自相关。</p>
<p>在生态学研究中，ACF具有重要的应用价值。例如，在分析种群动态时，显著的正自相关可能表明种群具有惯性效应或密度依赖性调节；显著的负自相关可能表明存在过度补偿机制；周期性模式可能反映季节性波动或多年周期。ACF还能帮助识别时间序列中的趋势成分——如果ACF缓慢衰减，表明存在趋势；如果ACF快速衰减到零，表明序列是平稳的。此外，ACF在构建时间序列模型（如ARIMA模型）时也起着关键作用，它为选择合适的模型阶数提供了重要依据。</p>
<p><strong>数学定义</strong>：对于时间序列<span class="math inline">\(\{X_t\}\)</span>，滞后<span class="math inline">\(k\)</span>的自相关系数定义为：</p>
<p><span class="math display">\[\rho_k = \frac{\sum_{t=k+1}^{n}(X_t - \bar{X})(X_{t-k} - \bar{X})}{\sum_{t=1}^{n}(X_t - \bar{X})^2}\]</span></p>
<p>其中<span class="math inline">\(n\)</span>是时间序列长度，<span class="math inline">\(\bar{X}\)</span>是序列的样本均值。</p>
<p>接下来就让我们用ACF这个工具，来看看上面的三个例子中的时间自相关模式。</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="相关性与相似性.html#cb527-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb527-2"><a href="相关性与相似性.html#cb527-2" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb527-3"><a href="相关性与相似性.html#cb527-3" tabindex="-1"></a></span>
<span id="cb527-4"><a href="相关性与相似性.html#cb527-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb527-5"><a href="相关性与相似性.html#cb527-5" tabindex="-1"></a></span>
<span id="cb527-6"><a href="相关性与相似性.html#cb527-6" tabindex="-1"></a><span class="co"># 使用与前面时间序列示例相同的数据</span></span>
<span id="cb527-7"><a href="相关性与相似性.html#cb527-7" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb527-8"><a href="相关性与相似性.html#cb527-8" tabindex="-1"></a></span>
<span id="cb527-9"><a href="相关性与相似性.html#cb527-9" tabindex="-1"></a><span class="co"># 1. 强正自相关：多年生植物种群动态（与558-618行相同）</span></span>
<span id="cb527-10"><a href="相关性与相似性.html#cb527-10" tabindex="-1"></a>plant_pop <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">+</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">2</span>, <span class="dv">5</span>))  <span class="co"># 累积随机游走</span></span>
<span id="cb527-11"><a href="相关性与相似性.html#cb527-11" tabindex="-1"></a></span>
<span id="cb527-12"><a href="相关性与相似性.html#cb527-12" tabindex="-1"></a><span class="co"># 2. 弱自相关：随机环境波动（与558-618行相同）</span></span>
<span id="cb527-13"><a href="相关性与相似性.html#cb527-13" tabindex="-1"></a>rainfall <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">15</span>)  <span class="co"># 纯随机过程</span></span>
<span id="cb527-14"><a href="相关性与相似性.html#cb527-14" tabindex="-1"></a></span>
<span id="cb527-15"><a href="相关性与相似性.html#cb527-15" tabindex="-1"></a><span class="co"># 3. 负自相关：捕食-被捕食系统（与558-618行相同）</span></span>
<span id="cb527-16"><a href="相关性与相似性.html#cb527-16" tabindex="-1"></a>predator <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">20</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> years <span class="sc">/</span> <span class="dv">8</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb527-17"><a href="相关性与相似性.html#cb527-17" tabindex="-1"></a>prey <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> <span class="dv">20</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> years <span class="sc">/</span> <span class="dv">8</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb527-18"><a href="相关性与相似性.html#cb527-18" tabindex="-1"></a></span>
<span id="cb527-19"><a href="相关性与相似性.html#cb527-19" tabindex="-1"></a><span class="co"># 计算各序列的自相关函数</span></span>
<span id="cb527-20"><a href="相关性与相似性.html#cb527-20" tabindex="-1"></a>acf_strong <span class="ot">&lt;-</span> <span class="fu">acf</span>(plant_pop, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb527-21"><a href="相关性与相似性.html#cb527-21" tabindex="-1"></a>acf_weak <span class="ot">&lt;-</span> <span class="fu">acf</span>(rainfall, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb527-22"><a href="相关性与相似性.html#cb527-22" tabindex="-1"></a>acf_predator <span class="ot">&lt;-</span> <span class="fu">acf</span>(predator, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb527-23"><a href="相关性与相似性.html#cb527-23" tabindex="-1"></a>acf_prey <span class="ot">&lt;-</span> <span class="fu">acf</span>(prey, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb527-24"><a href="相关性与相似性.html#cb527-24" tabindex="-1"></a></span>
<span id="cb527-25"><a href="相关性与相似性.html#cb527-25" tabindex="-1"></a><span class="co"># 创建ACF数据框用于ggplot绘图</span></span>
<span id="cb527-26"><a href="相关性与相似性.html#cb527-26" tabindex="-1"></a>create_acf_df <span class="ot">&lt;-</span> <span class="cf">function</span>(acf_obj, type_name) {</span>
<span id="cb527-27"><a href="相关性与相似性.html#cb527-27" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb527-28"><a href="相关性与相似性.html#cb527-28" tabindex="-1"></a>    <span class="at">Lag =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb527-29"><a href="相关性与相似性.html#cb527-29" tabindex="-1"></a>    <span class="at">ACF =</span> <span class="fu">as.numeric</span>(acf_obj<span class="sc">$</span>acf),</span>
<span id="cb527-30"><a href="相关性与相似性.html#cb527-30" tabindex="-1"></a>    <span class="at">Type =</span> type_name</span>
<span id="cb527-31"><a href="相关性与相似性.html#cb527-31" tabindex="-1"></a>  )</span>
<span id="cb527-32"><a href="相关性与相似性.html#cb527-32" tabindex="-1"></a>}</span>
<span id="cb527-33"><a href="相关性与相似性.html#cb527-33" tabindex="-1"></a></span>
<span id="cb527-34"><a href="相关性与相似性.html#cb527-34" tabindex="-1"></a>acf_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb527-35"><a href="相关性与相似性.html#cb527-35" tabindex="-1"></a>  <span class="fu">create_acf_df</span>(acf_strong, <span class="st">&quot;强正自相关&quot;</span>),</span>
<span id="cb527-36"><a href="相关性与相似性.html#cb527-36" tabindex="-1"></a>  <span class="fu">create_acf_df</span>(acf_weak, <span class="st">&quot;弱自相关&quot;</span>),</span>
<span id="cb527-37"><a href="相关性与相似性.html#cb527-37" tabindex="-1"></a>  <span class="fu">create_acf_df</span>(acf_predator, <span class="st">&quot;捕食者种群&quot;</span>),</span>
<span id="cb527-38"><a href="相关性与相似性.html#cb527-38" tabindex="-1"></a>  <span class="fu">create_acf_df</span>(acf_prey, <span class="st">&quot;被捕食者种群&quot;</span>)</span>
<span id="cb527-39"><a href="相关性与相似性.html#cb527-39" tabindex="-1"></a>)</span>
<span id="cb527-40"><a href="相关性与相似性.html#cb527-40" tabindex="-1"></a></span>
<span id="cb527-41"><a href="相关性与相似性.html#cb527-41" tabindex="-1"></a><span class="co"># 创建ACF图形</span></span>
<span id="cb527-42"><a href="相关性与相似性.html#cb527-42" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(acf_data[acf_data<span class="sc">$</span>Type <span class="sc">==</span> <span class="st">&quot;强正自相关&quot;</span>, ], <span class="fu">aes</span>(<span class="at">x =</span> Lag, <span class="at">y =</span> ACF)) <span class="sc">+</span></span>
<span id="cb527-43"><a href="相关性与相似性.html#cb527-43" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;#2E86AB&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb527-44"><a href="相关性与相似性.html#cb527-44" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb527-45"><a href="相关性与相似性.html#cb527-45" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;强正自相关：多年生植物种群动态&quot;</span>,</span>
<span id="cb527-46"><a href="相关性与相似性.html#cb527-46" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;ACF缓慢衰减，显示长期记忆效应&quot;</span>,</span>
<span id="cb527-47"><a href="相关性与相似性.html#cb527-47" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;滞后（年）&quot;</span>, <span class="at">y =</span> <span class="st">&quot;自相关系数&quot;</span>) <span class="sc">+</span></span>
<span id="cb527-48"><a href="相关性与相似性.html#cb527-48" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb527-49"><a href="相关性与相似性.html#cb527-49" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb527-50"><a href="相关性与相似性.html#cb527-50" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb527-51"><a href="相关性与相似性.html#cb527-51" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb527-52"><a href="相关性与相似性.html#cb527-52" tabindex="-1"></a></span>
<span id="cb527-53"><a href="相关性与相似性.html#cb527-53" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(acf_data[acf_data<span class="sc">$</span>Type <span class="sc">==</span> <span class="st">&quot;弱自相关&quot;</span>, ], <span class="fu">aes</span>(<span class="at">x =</span> Lag, <span class="at">y =</span> ACF)) <span class="sc">+</span></span>
<span id="cb527-54"><a href="相关性与相似性.html#cb527-54" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;#A23B72&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb527-55"><a href="相关性与相似性.html#cb527-55" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb527-56"><a href="相关性与相似性.html#cb527-56" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;弱自相关：随机环境波动&quot;</span>,</span>
<span id="cb527-57"><a href="相关性与相似性.html#cb527-57" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;ACF快速衰减至零，显示随机性&quot;</span>,</span>
<span id="cb527-58"><a href="相关性与相似性.html#cb527-58" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;滞后（月）&quot;</span>, <span class="at">y =</span> <span class="st">&quot;自相关系数&quot;</span>) <span class="sc">+</span></span>
<span id="cb527-59"><a href="相关性与相似性.html#cb527-59" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb527-60"><a href="相关性与相似性.html#cb527-60" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb527-61"><a href="相关性与相似性.html#cb527-61" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb527-62"><a href="相关性与相似性.html#cb527-62" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb527-63"><a href="相关性与相似性.html#cb527-63" tabindex="-1"></a></span>
<span id="cb527-64"><a href="相关性与相似性.html#cb527-64" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(acf_data[acf_data<span class="sc">$</span>Type <span class="sc">==</span> <span class="st">&quot;捕食者种群&quot;</span>, ], <span class="fu">aes</span>(<span class="at">x =</span> Lag, <span class="at">y =</span> ACF)) <span class="sc">+</span></span>
<span id="cb527-65"><a href="相关性与相似性.html#cb527-65" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;#F18F01&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb527-66"><a href="相关性与相似性.html#cb527-66" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb527-67"><a href="相关性与相似性.html#cb527-67" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;负自相关：捕食者种群振荡&quot;</span>,</span>
<span id="cb527-68"><a href="相关性与相似性.html#cb527-68" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;ACF呈现交替正负值，显示振荡模式&quot;</span>,</span>
<span id="cb527-69"><a href="相关性与相似性.html#cb527-69" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;滞后（年）&quot;</span>, <span class="at">y =</span> <span class="st">&quot;自相关系数&quot;</span>) <span class="sc">+</span></span>
<span id="cb527-70"><a href="相关性与相似性.html#cb527-70" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb527-71"><a href="相关性与相似性.html#cb527-71" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb527-72"><a href="相关性与相似性.html#cb527-72" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb527-73"><a href="相关性与相似性.html#cb527-73" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb527-74"><a href="相关性与相似性.html#cb527-74" tabindex="-1"></a></span>
<span id="cb527-75"><a href="相关性与相似性.html#cb527-75" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(acf_data[acf_data<span class="sc">$</span>Type <span class="sc">==</span> <span class="st">&quot;被捕食者种群&quot;</span>, ], <span class="fu">aes</span>(<span class="at">x =</span> Lag, <span class="at">y =</span> ACF)) <span class="sc">+</span></span>
<span id="cb527-76"><a href="相关性与相似性.html#cb527-76" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;#C73E1D&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb527-77"><a href="相关性与相似性.html#cb527-77" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb527-78"><a href="相关性与相似性.html#cb527-78" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;负自相关：被捕食者种群振荡&quot;</span>,</span>
<span id="cb527-79"><a href="相关性与相似性.html#cb527-79" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;ACF呈现交替正负值，与捕食者相位相反&quot;</span>,</span>
<span id="cb527-80"><a href="相关性与相似性.html#cb527-80" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;滞后（年）&quot;</span>, <span class="at">y =</span> <span class="st">&quot;自相关系数&quot;</span>) <span class="sc">+</span></span>
<span id="cb527-81"><a href="相关性与相似性.html#cb527-81" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb527-82"><a href="相关性与相似性.html#cb527-82" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb527-83"><a href="相关性与相似性.html#cb527-83" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb527-84"><a href="相关性与相似性.html#cb527-84" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb527-85"><a href="相关性与相似性.html#cb527-85" tabindex="-1"></a></span>
<span id="cb527-86"><a href="相关性与相似性.html#cb527-86" tabindex="-1"></a><span class="co"># 组合图形（2x2布局）</span></span>
<span id="cb527-87"><a href="相关性与相似性.html#cb527-87" tabindex="-1"></a>(p1 <span class="sc">|</span> p2) <span class="sc">/</span> (p3 <span class="sc">|</span> p4) <span class="sc">+</span></span>
<span id="cb527-88"><a href="相关性与相似性.html#cb527-88" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb527-89"><a href="相关性与相似性.html#cb527-89" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;四种时间自相关模式的自相关函数特征&quot;</span>,</span>
<span id="cb527-90"><a href="相关性与相似性.html#cb527-90" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;基于不同生态过程的时间连续性模式&quot;</span>,</span>
<span id="cb527-91"><a href="相关性与相似性.html#cb527-91" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;左上：强正自相关（缓慢衰减） | 右上：弱自相关（快速衰减） | 左下：捕食者负自相关 | 右下：被捕食者负自相关&quot;</span></span>
<span id="cb527-92"><a href="相关性与相似性.html#cb527-92" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-11-1.png" alt="四种时间自相关模式的自相关函数对比：左上显示强正自相关的缓慢衰减模式，右上显示弱自相关的快速衰减模式，左下显示捕食者种群的负自相关振荡模式，右下显示被捕食者种群的负自相关振荡模式" width="1152" />
<p class="caption">
图5.6: 四种时间自相关模式的自相关函数对比：左上显示强正自相关的缓慢衰减模式，右上显示弱自相关的快速衰减模式，左下显示捕食者种群的负自相关振荡模式，右下显示被捕食者种群的负自相关振荡模式
</p>
</div>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="相关性与相似性.html#cb528-1" tabindex="-1"></a><span class="co"># 输出关键统计信息</span></span>
<span id="cb528-2"><a href="相关性与相似性.html#cb528-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;强正自相关序列（滞后1）：&quot;</span>, <span class="fu">round</span>(acf_strong<span class="sc">$</span>acf[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 强正自相关序列（滞后1）： 0.823</code></pre>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="相关性与相似性.html#cb530-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;弱自相关序列（滞后1）：&quot;</span>, <span class="fu">round</span>(acf_weak<span class="sc">$</span>acf[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 弱自相关序列（滞后1）： 0.195</code></pre>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="相关性与相似性.html#cb532-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;捕食者序列（滞后1）：&quot;</span>, <span class="fu">round</span>(acf_predator<span class="sc">$</span>acf[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 捕食者序列（滞后1）： 0.593</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="相关性与相似性.html#cb534-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;被捕食者序列（滞后1）：&quot;</span>, <span class="fu">round</span>(acf_prey<span class="sc">$</span>acf[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 被捕食者序列（滞后1）： 0.623</code></pre>
<p><strong>生态学意义</strong>：自相关函数在生态学中广泛应用于检测种群波动的周期性、环境因子的记忆效应、生态过程的持续性等时间动态特征。</p>
</div>
<div id="偏自相关函数pacf直接时间依赖的识别" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> 偏自相关函数（PACF）：直接时间依赖的识别<a href="相关性与相似性.html#偏自相关函数pacf直接时间依赖的识别" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在研究森林年轮宽度的时间序列时，我们想要区分不同时间滞后对当前年轮宽度的直接影响和间接影响。当我们想要了解前年年轮宽度对今年年轮宽度的关系时，需要排除去年年轮宽度这个”中间人”的影响。换句话说，PACF回答的问题是：“在控制了去年年轮宽度的影响后，前年年轮宽度对今年年轮宽度还有没有直接的因果关系？”这种分析帮助我们识别时间序列中真正需要的过去时间点数量，从而为建立准确的自回归模型提供关键依据。</p>
<p>偏自相关函数是时间序列分析中的另一个重要工具，它度量了在控制中间时间滞后影响后，时间序列与其自身在特定滞后下的直接相关性。与自相关函数不同，PACF排除了通过中间滞后传递的间接相关性，只保留直接的相关性。这种特性使得PACF在识别时间序列模型的自回归阶数（我们将在第10章中介绍自回归模型，现在仅知道有这样的分析就行）时特别有用。对于滞后<span class="math inline">\(k\)</span>，偏自相关系数<span class="math inline">\(\phi_{kk}\)</span>可以理解为在回归模型<span class="math inline">\(X_t = \phi_1 X_{t-1} + \phi_2 X_{t-2} + \cdots + \phi_k X_{t-k} + \epsilon_t\)</span>中，系数<span class="math inline">\(\phi_k\)</span>的估计值。</p>
<p>PACF的计算通常基于Yule-Walker方程或通过逐步回归方法实现。在生态学时间序列分析中，PACF的主要作用是帮助确定自回归模型的合适阶数。如果PACF在滞后<span class="math inline">\(p\)</span>之后截尾（即之后的偏自相关系数不再显著），那么<span class="math inline">\(p\)</span>阶自回归模型可能是合适的。这种截尾模式为构建ARIMA模型提供了重要依据。例如，在分析气候时间序列时，PACF可以帮助识别气候系统的记忆长度；在分析种群动态时，PACF可以揭示密度依赖调节的时间尺度。</p>
<p>为了更直观地理解PACF的应用，我们将在下面的森林年轮宽度示例中演示如何计算和解释PACF（见<a href="相关性与相似性.html#fig:pacf-example">5.7</a>），并与ACF进行比较（见<a href="相关性与相似性.html#fig:acf-pacf-comparison">5.8</a>）。</p>
<p>PACF与ACF的结合使用能够提供对时间序列结构的全面理解。ACF反映了总的相关性（包括直接和间接相关性），而PACF只反映直接相关性。这种区别在生态学应用中非常重要，因为它帮助我们区分生态过程中的直接因果联系和通过中间过程传递的间接联系。例如，在食物网动态中，捕食者与猎物的关系可能通过多个营养级传递，PACF可以帮助识别直接的相互作用关系。</p>
<p><strong>数学定义</strong>：偏自相关系数<span class="math inline">\(\phi_{kk}\)</span>可以通过求解Yule-Walker方程得到：</p>
<p><span class="math display">\[\begin{bmatrix}
\rho_0 &amp; \rho_1 &amp; \cdots &amp; \rho_{k-1} \\
\rho_1 &amp; \rho_0 &amp; \cdots &amp; \rho_{k-2} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\rho_{k-1} &amp; \rho_{k-2} &amp; \cdots &amp; \rho_0
\end{bmatrix}
\begin{bmatrix}
\phi_{k1} \\
\phi_{k2} \\
\vdots \\
\phi_{kk}
\end{bmatrix}
=
\begin{bmatrix}
\rho_1 \\
\rho_2 \\
\vdots \\
\rho_k
\end{bmatrix}\]</span></p>
<p>其中：</p>
<ul>
<li><p><span class="math inline">\(\rho_j\)</span>：滞后<span class="math inline">\(j\)</span>的自相关系数，表示时间序列与其自身在<span class="math inline">\(j\)</span>个时间单位后的相关性强度。其中<span class="math inline">\(\rho_0 = 1\)</span>表示时间序列与自身的完全相关。</p></li>
<li><p><span class="math inline">\(\phi_{kj}\)</span>：在<span class="math inline">\(k\)</span>阶偏自相关模型中，滞后<span class="math inline">\(j\)</span>的偏自回归系数。这个系数表示在控制了其他滞后项的影响后，滞后<span class="math inline">\(j\)</span>对当前值的直接影响强度。</p></li>
<li><p><span class="math inline">\(\phi_{kk}\)</span>：滞后<span class="math inline">\(k\)</span>的<strong>偏自相关系数</strong>，这是PACF的核心输出。它表示在排除了滞后1到<span class="math inline">\(k-1\)</span>的所有中间影响后，滞后<span class="math inline">\(k\)</span>对当前值的直接相关性。</p></li>
<li><p>矩阵左侧的Toeplitz矩阵：由自相关系数构成的对称矩阵，反映了时间序列在不同滞后下的相关性结构。</p></li>
<li><p>矩阵右侧的向量：包含从滞后1到滞后<span class="math inline">\(k\)</span>的自相关系数，表示我们想要解释的总相关性模式。</p></li>
</ul>
<p>这个方程组通过求解偏自回归系数<span class="math inline">\(\phi_{kj}\)</span>，最终得到我们关心的偏自相关系数<span class="math inline">\(\phi_{kk}\)</span>。</p>
<p><strong>R代码实现</strong>：</p>
<p>接下来我们通过一个森林年轮宽度的具体案例来演示偏自相关函数的应用。这个例子将展示如何：</p>
<ol style="list-style-type: decimal">
<li>模拟一个具有自回归特性的森林年轮宽度时间序列（见<a href="相关性与相似性.html#fig:tree-ring-time-series">5.9</a>）</li>
<li>计算并可视化偏自相关函数（见<a href="相关性与相似性.html#fig:pacf-example">5.7</a>）</li>
<li>比较ACF和PACF的差异（见<a href="相关性与相似性.html#fig:acf-pacf-comparison">5.8</a>）</li>
<li>使用统计方法确定最优的自回归模型阶数</li>
</ol>
<p>首先，我们生成模拟数据并计算PACF：</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="相关性与相似性.html#cb536-1" tabindex="-1"></a><span class="co"># 偏自相关函数示例：森林年轮宽度的时间序列</span></span>
<span id="cb536-2"><a href="相关性与相似性.html#cb536-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb536-3"><a href="相关性与相似性.html#cb536-3" tabindex="-1"></a></span>
<span id="cb536-4"><a href="相关性与相似性.html#cb536-4" tabindex="-1"></a><span class="co"># 模拟森林年轮宽度数据（100年）</span></span>
<span id="cb536-5"><a href="相关性与相似性.html#cb536-5" tabindex="-1"></a>n_years <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb536-6"><a href="相关性与相似性.html#cb536-6" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n_years</span>
<span id="cb536-7"><a href="相关性与相似性.html#cb536-7" tabindex="-1"></a></span>
<span id="cb536-8"><a href="相关性与相似性.html#cb536-8" tabindex="-1"></a><span class="co"># 模拟自回归过程：当前年轮宽度受前2年影响</span></span>
<span id="cb536-9"><a href="相关性与相似性.html#cb536-9" tabindex="-1"></a><span class="co"># AR(2)过程：X_t = 0.6*X_{t-1} - 0.3*X_{t-2} + ε_t</span></span>
<span id="cb536-10"><a href="相关性与相似性.html#cb536-10" tabindex="-1"></a>tree_ring_width <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_years)</span>
<span id="cb536-11"><a href="相关性与相似性.html#cb536-11" tabindex="-1"></a>tree_ring_width[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>)</span>
<span id="cb536-12"><a href="相关性与相似性.html#cb536-12" tabindex="-1"></a>tree_ring_width[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>)</span>
<span id="cb536-13"><a href="相关性与相似性.html#cb536-13" tabindex="-1"></a></span>
<span id="cb536-14"><a href="相关性与相似性.html#cb536-14" tabindex="-1"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span>n_years) {</span>
<span id="cb536-15"><a href="相关性与相似性.html#cb536-15" tabindex="-1"></a>  tree_ring_width[t] <span class="ot">&lt;-</span> <span class="fl">0.6</span> <span class="sc">*</span> tree_ring_width[t <span class="sc">-</span> <span class="dv">1</span>] <span class="sc">-</span> <span class="fl">0.3</span> <span class="sc">*</span> tree_ring_width[t <span class="sc">-</span> <span class="dv">2</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb536-16"><a href="相关性与相似性.html#cb536-16" tabindex="-1"></a>}</span>
<span id="cb536-17"><a href="相关性与相似性.html#cb536-17" tabindex="-1"></a></span>
<span id="cb536-18"><a href="相关性与相似性.html#cb536-18" tabindex="-1"></a><span class="co"># 添加趋势和季节性（年际变化）</span></span>
<span id="cb536-19"><a href="相关性与相似性.html#cb536-19" tabindex="-1"></a>tree_ring_width <span class="ot">&lt;-</span> tree_ring_width <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> years <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> years <span class="sc">/</span> <span class="dv">30</span>)</span>
<span id="cb536-20"><a href="相关性与相似性.html#cb536-20" tabindex="-1"></a></span>
<span id="cb536-21"><a href="相关性与相似性.html#cb536-21" tabindex="-1"></a><span class="co"># 计算偏自相关函数</span></span>
<span id="cb536-22"><a href="相关性与相似性.html#cb536-22" tabindex="-1"></a>pacf_result <span class="ot">&lt;-</span> <span class="fu">pacf</span>(tree_ring_width, <span class="at">lag.max =</span> <span class="dv">15</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb536-23"><a href="相关性与相似性.html#cb536-23" tabindex="-1"></a></span>
<span id="cb536-24"><a href="相关性与相似性.html#cb536-24" tabindex="-1"></a><span class="co"># 可视化偏自相关函数</span></span>
<span id="cb536-25"><a href="相关性与相似性.html#cb536-25" tabindex="-1"></a><span class="fu">plot</span>(pacf_result,</span>
<span id="cb536-26"><a href="相关性与相似性.html#cb536-26" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;森林年轮宽度的偏自相关函数&quot;</span>,</span>
<span id="cb536-27"><a href="相关性与相似性.html#cb536-27" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;滞后（年）&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;偏自相关系数&quot;</span></span>
<span id="cb536-28"><a href="相关性与相似性.html#cb536-28" tabindex="-1"></a>)</span>
<span id="cb536-29"><a href="相关性与相似性.html#cb536-29" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:pacf-example"></span>
<img src="05-correlation_files/figure-html/pacf-example-1.png" alt="森林年轮宽度的偏自相关函数" width="672" />
<p class="caption">
图5.7: 森林年轮宽度的偏自相关函数
</p>
</div>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="相关性与相似性.html#cb537-1" tabindex="-1"></a><span class="co"># 提取关键的偏自相关系数</span></span>
<span id="cb537-2"><a href="相关性与相似性.html#cb537-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;关键滞后下的偏自相关系数：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb537-3"><a href="相关性与相似性.html#cb537-3" tabindex="-1"></a>    <span class="st">&quot;滞后1年：&quot;</span>, <span class="fu">round</span>(pacf_result<span class="sc">$</span>acf[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb537-4"><a href="相关性与相似性.html#cb537-4" tabindex="-1"></a>    <span class="st">&quot;滞后2年：&quot;</span>, <span class="fu">round</span>(pacf_result<span class="sc">$</span>acf[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb537-5"><a href="相关性与相似性.html#cb537-5" tabindex="-1"></a>    <span class="st">&quot;滞后3年：&quot;</span>, <span class="fu">round</span>(pacf_result<span class="sc">$</span>acf[<span class="dv">3</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb537-6"><a href="相关性与相似性.html#cb537-6" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 关键滞后下的偏自相关系数：
## 滞后1年：0.782
## 滞后2年：-0.252
## 滞后3年：0.254</code></pre>
<p>现在我们来比较ACF和PACF的差异，这有助于理解两种函数在识别时间序列结构时的不同作用：</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="相关性与相似性.html#cb539-1" tabindex="-1"></a><span class="co"># 比较ACF和PACF</span></span>
<span id="cb539-2"><a href="相关性与相似性.html#cb539-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb539-3"><a href="相关性与相似性.html#cb539-3" tabindex="-1"></a></span>
<span id="cb539-4"><a href="相关性与相似性.html#cb539-4" tabindex="-1"></a><span class="co"># ACF图</span></span>
<span id="cb539-5"><a href="相关性与相似性.html#cb539-5" tabindex="-1"></a><span class="fu">acf</span>(tree_ring_width, <span class="at">lag.max =</span> <span class="dv">15</span>, <span class="at">main =</span> <span class="st">&quot;自相关函数&quot;</span>)</span>
<span id="cb539-6"><a href="相关性与相似性.html#cb539-6" tabindex="-1"></a></span>
<span id="cb539-7"><a href="相关性与相似性.html#cb539-7" tabindex="-1"></a><span class="co"># PACF图</span></span>
<span id="cb539-8"><a href="相关性与相似性.html#cb539-8" tabindex="-1"></a><span class="fu">pacf</span>(tree_ring_width, <span class="at">lag.max =</span> <span class="dv">15</span>, <span class="at">main =</span> <span class="st">&quot;偏自相关函数&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:acf-pacf-comparison"></span>
<img src="05-correlation_files/figure-html/acf-pacf-comparison-1.png" alt="森林年轮宽度的自相关函数与偏自相关函数对比" width="672" />
<p class="caption">
图5.8: 森林年轮宽度的自相关函数与偏自相关函数对比
</p>
</div>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="相关性与相似性.html#cb540-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>接下来，我们使用统计方法来确定最优的自回归模型阶数。这在实际生态学研究中非常重要，可以帮助我们选择最合适的模型来描述生态过程：</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="相关性与相似性.html#cb541-1" tabindex="-1"></a><span class="co"># 拟合AR模型并确定最优阶数</span></span>
<span id="cb541-2"><a href="相关性与相似性.html#cb541-2" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb541-3"><a href="相关性与相似性.html#cb541-3" tabindex="-1"></a></span>
<span id="cb541-4"><a href="相关性与相似性.html#cb541-4" tabindex="-1"></a><span class="co"># 使用AIC准则选择最优AR模型阶数</span></span>
<span id="cb541-5"><a href="相关性与相似性.html#cb541-5" tabindex="-1"></a>best_ar <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(tree_ring_width,</span>
<span id="cb541-6"><a href="相关性与相似性.html#cb541-6" tabindex="-1"></a>  <span class="at">max.p =</span> <span class="dv">10</span>, <span class="at">max.q =</span> <span class="dv">0</span>, <span class="at">max.d =</span> <span class="dv">0</span>,</span>
<span id="cb541-7"><a href="相关性与相似性.html#cb541-7" tabindex="-1"></a>  <span class="at">seasonal =</span> <span class="cn">FALSE</span>, <span class="at">stepwise =</span> <span class="cn">FALSE</span>, <span class="at">approximation =</span> <span class="cn">FALSE</span></span>
<span id="cb541-8"><a href="相关性与相似性.html#cb541-8" tabindex="-1"></a>)</span>
<span id="cb541-9"><a href="相关性与相似性.html#cb541-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">最优AR模型阶数：&quot;</span>, best_ar<span class="sc">$</span>arma[<span class="dv">1</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb541-10"><a href="相关性与相似性.html#cb541-10" tabindex="-1"></a>  <span class="st">&quot;模型系数：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 最优AR模型阶数： 3 
##  模型系数：</code></pre>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="相关性与相似性.html#cb543-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(best_ar))</span></code></pre></div>
<pre><code>##        ar1        ar2        ar3  intercept 
##  1.1139434 -0.5072173  0.2773914  2.0968099</code></pre>
<p>最后，我们可视化原始的时间序列数据，这有助于直观理解数据的动态特征：</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="相关性与相似性.html#cb545-1" tabindex="-1"></a><span class="co"># 可视化原始时间序列</span></span>
<span id="cb545-2"><a href="相关性与相似性.html#cb545-2" tabindex="-1"></a><span class="fu">plot</span>(years, tree_ring_width,</span>
<span id="cb545-3"><a href="相关性与相似性.html#cb545-3" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb545-4"><a href="相关性与相似性.html#cb545-4" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;年份&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;年轮宽度 (mm)&quot;</span>,</span>
<span id="cb545-5"><a href="相关性与相似性.html#cb545-5" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;森林年轮宽度的时间序列&quot;</span></span>
<span id="cb545-6"><a href="相关性与相似性.html#cb545-6" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tree-ring-time-series"></span>
<img src="05-correlation_files/figure-html/tree-ring-time-series-1.png" alt="森林年轮宽度的时间序列图" width="672" />
<p class="caption">
图5.9: 森林年轮宽度的时间序列图
</p>
</div>
<p><strong>生态学意义</strong>：偏自相关函数在生态学中主要用于识别时间序列模型的自回归阶数，帮助理解生态过程的直接时间依赖关系和内在动态机制。通过上面的森林年轮宽度示例（见<a href="相关性与相似性.html#fig:pacf-example">5.7</a>和<a href="相关性与相似性.html#fig:acf-pacf-comparison">5.8</a>），我们可以看到PACF如何帮助识别生态时间序列中的直接时间依赖关系，为构建准确的生态模型提供重要依据。</p>
</div>
<div id="时间序列平稳性分析的基础假设" class="section level3 hasAnchor" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> 时间序列平稳性：分析的基础假设<a href="相关性与相似性.html#时间序列平稳性分析的基础假设" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在分析鸟类种群数量的长期监测数据时，我们需要首先检验时间序列的平稳性，因为非平稳时间序列可能导致伪相关和错误的统计推断。</p>
<p>时间序列平稳性是时间序列分析的基本假设，指的是时间序列的统计特性（如均值、方差和自相关结构）不随时间变化。具体而言，严格平稳要求时间序列的任意有限维联合分布都不随时间平移而改变，而弱平稳（也称为二阶平稳）只要求均值恒定、方差有限且自协方差只依赖于时间差而不依赖于具体时间点。在生态学实践中，我们通常关注弱平稳性，因为它更容易检验且对于大多数时间序列分析方法已经足够。</p>
<p><strong>数学定义</strong>：弱平稳时间序列满足：</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(E[X_t] = \mu\)</span>（常数均值）</li>
<li><span class="math inline">\(Var[X_t] = \sigma^2 &lt; \infty\)</span>（有限常数方差）</li>
<li><span class="math inline">\(Cov[X_t, X_{t+k}] = \gamma_k\)</span>（自协方差只依赖于滞后<span class="math inline">\(k\)</span>，不依赖于<span class="math inline">\(t\)</span>）</li>
</ol>
<p>为了直观理解时间序列平稳性的概念，让我们对比一下平稳和非平稳时间序列的典型特征。</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:time-series-stationarity-comparison"></span>
<img src="05-correlation_files/figure-html/time-series-stationarity-comparison-1.png" alt="时间序列平稳性对比示意图：左图显示平稳时间序列（恒定统计特性），右图显示非平稳时间序列（具有趋势和季节性变化）" width="672" />
<p class="caption">
图5.10: 时间序列平稳性对比示意图：左图显示平稳时间序列（恒定统计特性），右图显示非平稳时间序列（具有趋势和季节性变化）
</p>
</div>
<p>上面的对比图（见<a href="相关性与相似性.html#fig:time-series-stationarity-comparison">5.10</a>）清晰地展示了平稳时间序列和非平稳时间序列在统计特性上的根本差异，这对于理解时间序列分析的基本假设至关重要。</p>
<p>在平稳时间序列的左侧部分，我们可以看到随机环境波动（如月降雨量）显示典型的平稳特征。时间序列图显示序列围绕一个固定的水平线（约50个单位）波动，既没有明显的上升或下降趋势，也没有系统性模式，观测值之间相互独立。这种恒定均值和恒定方差的特性正是平稳序列的核心特征。自相关函数图进一步证实了平稳性，自相关系数在滞后1之后迅速衰减到接近零，表明除了自身相关外，其他滞后的相关系数都不显著，序列缺乏持续性，当前观测值对未来的预测价值有限。</p>
<p>相比之下，非平稳时间序列的右侧部分展现了完全不同的特征。气候变化影响下的鸟类种群动态显示明显的非平稳性，时间序列图中可见明显的下降趋势，从约100单位下降到约60单位，反映了种群数量的长期变化。同时序列还表现出周期性的波动模式，显示了年际变化的规律性，随机游走成分更增加了序列的不可预测性和持续性。自相关函数图呈现出缓慢衰减的模式，自相关系数在多个滞后上保持显著正值，显示强烈的持续性和长期记忆效应，当前观测值对未来具有较强的预测价值。然而，这种高自相关主要源于序列中的趋势成分，而非真正的统计依赖。</p>
<p>在生态学研究中，正确识别时间序列的平稳性具有重要的实践意义。对于平稳序列，如随机环境波动，由于其统计特性稳定，适合直接应用经典的时间序列方法，统计推断相对可靠。而对于非平稳序列，如受气候变化影响的种群动态，则需要先进行平稳化处理，如差分、变换等方法，否则可能导致严重的统计问题。趋势相似的序列可能显示虚假的相关关系，模型可能错误地拟合趋势而非真实的生态关系，置信区间和假设检验也可能严重偏离真实情况。通过图示法识别平稳性是最直观的检验方法，为后续的统计分析和生态解释提供基础保障。</p>
<p>平稳性检验在生态学时间序列分析中具有至关重要的意义。许多经典的时间序列方法，如自回归模型、移动平均模型和谱分析，都建立在平稳性假设的基础上。如果时间序列是非平稳的，直接应用这些方法可能导致严重的统计问题，如伪回归（spurious regression）和无效的假设检验。生态学中的许多时间序列都表现出非平稳特征，如长期趋势（气候变化导致的温度上升）、季节性变化（物候的季节性波动）、结构性断点（生态系统突变事件）等。</p>
<p>检验时间序列平稳性的常用方法包括图示法、自相关函数分析、单位根检验（如ADF检验、KPSS检验）等。图示法通过观察时间序列图来识别明显的趋势或季节性模式；自相关函数分析通过检查ACF的衰减模式来判断平稳性——平稳时间序列的ACF应该快速衰减到零，而非平稳时间序列的ACF通常衰减缓慢；单位根检验则提供统计检验来正式判断时间序列是否具有单位根（非平稳的标志）。</p>
<p><strong>ADF检验（Augmented Dickey-Fuller Test）</strong>是应用最广泛的单位根检验方法，由David Dickey和Wayne Fuller于1979年提出。ADF检验的核心思想是通过检验时间序列是否具有单位根来判断其平稳性。如果时间序列存在单位根，则说明该序列是非平稳的；如果不存在单位根，则序列是平稳的。</p>
<p>ADF检验的数学基础基于以下回归方程：</p>
<p><span class="math display">\[\Delta y_t = \alpha + \beta t + \gamma y_{t-1} + \sum_{i=1}^{p}\delta_i\Delta y_{t-i} + \epsilon_t\]</span></p>
<p>其中<span class="math inline">\(\Delta y_t = y_t - y_{t-1}\)</span>表示一阶差分，<span class="math inline">\(\alpha\)</span>是常数项，<span class="math inline">\(\beta t\)</span>是趋势项，<span class="math inline">\(\gamma y_{t-1}\)</span>是滞后项，<span class="math inline">\(\sum_{i=1}^{p}\delta_i\Delta y_{t-i}\)</span>是差分滞后项（用于消除自相关），<span class="math inline">\(\epsilon_t\)</span>是误差项。</p>
<p>ADF检验的原假设<span class="math inline">\(H_0\)</span>是：<span class="math inline">\(\gamma = 0\)</span>，即时间序列存在单位根（非平稳）；备择假设<span class="math inline">\(H_1\)</span>是：<span class="math inline">\(\gamma &lt; 0\)</span>，即时间序列不存在单位根（平稳）。检验统计量是<span class="math inline">\(\gamma\)</span>的t统计量，但其分布不是标准的t分布，而是Dickey-Fuller分布。</p>
<p>在实际应用中，ADF检验有三种形式： 1. <strong>无常数项无趋势项</strong>：<span class="math inline">\(\Delta y_t = \gamma y_{t-1} + \sum_{i=1}^{p}\delta_i\Delta y_{t-i} + \epsilon_t\)</span> 2. <strong>有常数项无趋势项</strong>：<span class="math inline">\(\Delta y_t = \alpha + \gamma y_{t-1} + \sum_{i=1}^{p}\delta_i\Delta y_{t-i} + \epsilon_t\)</span> 3. <strong>有常数项有趋势项</strong>：<span class="math inline">\(\Delta y_t = \alpha + \beta t + \gamma y_{t-1} + \sum_{i=1}^{p}\delta_i\Delta y_{t-i} + \epsilon_t\)</span></p>
<p>选择哪种形式取决于时间序列的特征。通常建议从最复杂的模型（有常数项有趋势项）开始，如果趋势项不显著，则使用较简单的模型。</p>
<p>在生态学研究中，ADF检验具有重要的应用价值。例如，在分析气候变化对种群动态的影响时，ADF检验可以帮助判断种群数量是否具有长期趋势；在研究物候变化时，ADF检验可以检验温度或降水序列的平稳性；在生态系统监测中，ADF检验为构建准确的时间序列模型提供了基础。</p>
<p>需要注意的是，ADF检验对滞后阶数<span class="math inline">\(p\)</span>的选择比较敏感。滞后阶数过小可能导致残差自相关，滞后阶数过大则会降低检验功效。常用的选择方法包括信息准则（AIC、BIC）或基于自相关函数的经验法则。此外，ADF检验的功效相对较低，特别是对于接近单位根但实际平稳的时间序列，容易犯第二类错误。</p>
<p>接下来我们就用一个简单的例子来演示时间序列平稳性的检验和处理。我们将使用鸟类种群数量监测数据（50年）来演示时间序列平稳性的检验和处理。</p>
<p>首先，我们模拟了一个具有趋势、季节性和随机成分的非平稳时间序列（图<a href="相关性与相似性.html#fig:bird-population-ts">5.11</a>），该序列模拟了鸟类种群在50年间的动态变化。</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="相关性与相似性.html#cb546-1" tabindex="-1"></a><span class="co"># 时间序列平稳性检验示例：鸟类种群数量监测</span></span>
<span id="cb546-2"><a href="相关性与相似性.html#cb546-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb546-3"><a href="相关性与相似性.html#cb546-3" tabindex="-1"></a></span>
<span id="cb546-4"><a href="相关性与相似性.html#cb546-4" tabindex="-1"></a><span class="co"># 模拟鸟类种群数量数据（50年）</span></span>
<span id="cb546-5"><a href="相关性与相似性.html#cb546-5" tabindex="-1"></a>n_years <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb546-6"><a href="相关性与相似性.html#cb546-6" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n_years</span>
<span id="cb546-7"><a href="相关性与相似性.html#cb546-7" tabindex="-1"></a></span>
<span id="cb546-8"><a href="相关性与相似性.html#cb546-8" tabindex="-1"></a><span class="co"># 模拟非平稳时间序列：具有趋势和季节性的种群动态</span></span>
<span id="cb546-9"><a href="相关性与相似性.html#cb546-9" tabindex="-1"></a><span class="co"># 趋势成分：种群总体下降趋势</span></span>
<span id="cb546-10"><a href="相关性与相似性.html#cb546-10" tabindex="-1"></a>trend <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> <span class="fl">0.8</span> <span class="sc">*</span> years</span>
<span id="cb546-11"><a href="相关性与相似性.html#cb546-11" tabindex="-1"></a><span class="co"># 季节性成分：年际波动</span></span>
<span id="cb546-12"><a href="相关性与相似性.html#cb546-12" tabindex="-1"></a>seasonal <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> years <span class="sc">/</span> <span class="dv">5</span>)</span>
<span id="cb546-13"><a href="相关性与相似性.html#cb546-13" tabindex="-1"></a><span class="co"># 随机成分</span></span>
<span id="cb546-14"><a href="相关性与相似性.html#cb546-14" tabindex="-1"></a>random <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="fu">rnorm</span>(n_years, <span class="dv">0</span>, <span class="dv">2</span>)) <span class="co"># 随机游走，增加非平稳性</span></span>
<span id="cb546-15"><a href="相关性与相似性.html#cb546-15" tabindex="-1"></a></span>
<span id="cb546-16"><a href="相关性与相似性.html#cb546-16" tabindex="-1"></a>bird_population <span class="ot">&lt;-</span> trend <span class="sc">+</span> seasonal <span class="sc">+</span> random <span class="sc">+</span> <span class="fu">rnorm</span>(n_years, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb546-17"><a href="相关性与相似性.html#cb546-17" tabindex="-1"></a></span>
<span id="cb546-18"><a href="相关性与相似性.html#cb546-18" tabindex="-1"></a><span class="co"># 可视化原始时间序列</span></span>
<span id="cb546-19"><a href="相关性与相似性.html#cb546-19" tabindex="-1"></a><span class="fu">plot</span>(years, bird_population,</span>
<span id="cb546-20"><a href="相关性与相似性.html#cb546-20" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;brown&quot;</span>,</span>
<span id="cb546-21"><a href="相关性与相似性.html#cb546-21" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;年份&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;鸟类种群数量&quot;</span>,</span>
<span id="cb546-22"><a href="相关性与相似性.html#cb546-22" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;鸟类种群数量的时间序列&quot;</span></span>
<span id="cb546-23"><a href="相关性与相似性.html#cb546-23" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:bird-population-ts"></span>
<img src="05-correlation_files/figure-html/bird-population-ts-1.png" alt="鸟类种群数量的时间序列图，展示了具有趋势、季节性和随机成分的非平稳时间序列" width="672" />
<p class="caption">
图5.11: 鸟类种群数量的时间序列图，展示了具有趋势、季节性和随机成分的非平稳时间序列
</p>
</div>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="相关性与相似性.html#cb547-1" tabindex="-1"></a><span class="co"># 检验平稳性：ADF检验（Augmented Dickey-Fuller Test）</span></span>
<span id="cb547-2"><a href="相关性与相似性.html#cb547-2" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb547-3"><a href="相关性与相似性.html#cb547-3" tabindex="-1"></a></span>
<span id="cb547-4"><a href="相关性与相似性.html#cb547-4" tabindex="-1"></a>adf_test <span class="ot">&lt;-</span> <span class="fu">adf.test</span>(bird_population)</span>
<span id="cb547-5"><a href="相关性与相似性.html#cb547-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;ADF单位根检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb547-6"><a href="相关性与相似性.html#cb547-6" tabindex="-1"></a>    <span class="st">&quot;检验统计量：&quot;</span>, <span class="fu">round</span>(adf_test<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb547-7"><a href="相关性与相似性.html#cb547-7" tabindex="-1"></a>    <span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(adf_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb547-8"><a href="相关性与相似性.html#cb547-8" tabindex="-1"></a>    <span class="st">&quot;原假设：时间序列有单位根（非平稳）</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb547-9"><a href="相关性与相似性.html#cb547-9" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## ADF单位根检验结果：
## 检验统计量：-2.818
## p值：0.246
## 原假设：时间序列有单位根（非平稳）</code></pre>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="相关性与相似性.html#cb549-1" tabindex="-1"></a><span class="cf">if</span> (adf_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb549-2"><a href="相关性与相似性.html#cb549-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;结论：拒绝原假设，时间序列是平稳的</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb549-3"><a href="相关性与相似性.html#cb549-3" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb549-4"><a href="相关性与相似性.html#cb549-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;结论：不能拒绝原假设，时间序列可能是非平稳的</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb549-5"><a href="相关性与相似性.html#cb549-5" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 结论：不能拒绝原假设，时间序列可能是非平稳的</code></pre>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="相关性与相似性.html#cb551-1" tabindex="-1"></a><span class="co"># KPSS检验（另一种平稳性检验）</span></span>
<span id="cb551-2"><a href="相关性与相似性.html#cb551-2" tabindex="-1"></a>kpss_test <span class="ot">&lt;-</span> <span class="fu">kpss.test</span>(bird_population)</span>
<span id="cb551-3"><a href="相关性与相似性.html#cb551-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">KPSS平稳性检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb551-4"><a href="相关性与相似性.html#cb551-4" tabindex="-1"></a>    <span class="st">&quot;检验统计量：&quot;</span>, <span class="fu">round</span>(kpss_test<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb551-5"><a href="相关性与相似性.html#cb551-5" tabindex="-1"></a>    <span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(kpss_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb551-6"><a href="相关性与相似性.html#cb551-6" tabindex="-1"></a>    <span class="st">&quot;原假设：时间序列是平稳的</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb551-7"><a href="相关性与相似性.html#cb551-7" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## KPSS平稳性检验结果：
## 检验统计量：1.201
## p值：0.01
## 原假设：时间序列是平稳的</code></pre>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="相关性与相似性.html#cb553-1" tabindex="-1"></a><span class="cf">if</span> (kpss_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb553-2"><a href="相关性与相似性.html#cb553-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;结论：拒绝原假设，时间序列是非平稳的</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb553-3"><a href="相关性与相似性.html#cb553-3" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb553-4"><a href="相关性与相似性.html#cb553-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;结论：不能拒绝原假设，时间序列可能是平稳的</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb553-5"><a href="相关性与相似性.html#cb553-5" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 结论：拒绝原假设，时间序列是非平稳的</code></pre>
<p>当发现时间序列非平稳时，通常需要进行差分或变换来使其平稳化。一阶差分可以去除线性趋势，季节性差分可以去除季节性模式，而对数变换或Box-Cox变换可以稳定方差。经过这些处理后的平稳时间序列就可以安全地应用各种时间序列分析方法了。在生态学应用中，理解时间序列的平稳性不仅关系到统计方法的正确使用，也帮助我们识别生态系统的长期变化模式和动态特征。</p>
<p>一阶差分是处理非平稳时间序列最常用的方法之一，其数学原理非常简单：对于时间序列 <span class="math inline">\(X_t\)</span>，一阶差分定义为相邻两个时间点的差值，即 <span class="math inline">\(\nabla X_t = X_t - X_{t-1}\)</span>。这种操作能够有效去除时间序列中的线性趋势，因为线性趋势在差分后会变为常数项。例如，如果一个时间序列包含线性增长趋势 <span class="math inline">\(X_t = \alpha + \beta t + \epsilon_t\)</span>，那么一阶差分后得到 <span class="math inline">\(\nabla X_t = \beta + (\epsilon_t - \epsilon_{t-1})\)</span>，其中 <span class="math inline">\(\beta\)</span> 是常数，而 <span class="math inline">\(\epsilon_t - \epsilon_{t-1}\)</span> 通常是平稳的随机扰动项。</p>
<p>在生态学时间序列分析中，一阶差分具有重要的应用价值。许多生态过程，如种群数量变化、气候变化响应、生态系统演替等，往往表现出明显的趋势性特征。通过一阶差分，我们可以将这些趋势从原始数据中分离出来，从而更好地分析数据中的随机波动成分。例如，在研究鸟类种群年际变化时，一阶差分能够帮助我们识别种群增长或下降的速率变化，而不是仅仅关注绝对数量的变化。</p>
<p>需要注意的是，一阶差分虽然能够去除线性趋势，但可能会引入新的问题。差分操作会减少序列的长度（从 <span class="math inline">\(n\)</span> 个观测值变为 <span class="math inline">\(n-1\)</span> 个差分值），同时可能放大数据中的噪声成分。此外，如果原始序列包含季节性模式，一阶差分可能不足以完全消除季节性影响，此时需要结合季节性差分或其他方法。在实际应用中，通常需要结合统计检验（如ADF检验）来验证差分后序列的平稳性，确保差分处理达到了预期效果。</p>
<p>接下来我们就用一阶差分来处理上面例子中时间非平稳问题。通过一阶差分处理，我们可以将原始的非平稳序列转换为平稳序列，从而满足时间序列分析的基本假设。</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="相关性与相似性.html#cb555-1" tabindex="-1"></a><span class="co"># 如果非平稳，进行差分处理</span></span>
<span id="cb555-2"><a href="相关性与相似性.html#cb555-2" tabindex="-1"></a><span class="cf">if</span> (adf_test<span class="sc">$</span>p.value <span class="sc">&gt;=</span> <span class="fl">0.05</span>) {</span>
<span id="cb555-3"><a href="相关性与相似性.html#cb555-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">进行一阶差分处理...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb555-4"><a href="相关性与相似性.html#cb555-4" tabindex="-1"></a>  bird_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(bird_population)</span>
<span id="cb555-5"><a href="相关性与相似性.html#cb555-5" tabindex="-1"></a></span>
<span id="cb555-6"><a href="相关性与相似性.html#cb555-6" tabindex="-1"></a>  <span class="co"># 检验差分后序列的平稳性</span></span>
<span id="cb555-7"><a href="相关性与相似性.html#cb555-7" tabindex="-1"></a>  adf_diff <span class="ot">&lt;-</span> <span class="fu">adf.test</span>(bird_diff)</span>
<span id="cb555-8"><a href="相关性与相似性.html#cb555-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;差分后序列的ADF检验：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb555-9"><a href="相关性与相似性.html#cb555-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(adf_diff<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb555-10"><a href="相关性与相似性.html#cb555-10" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## 进行一阶差分处理...</code></pre>
<pre><code>## 差分后序列的ADF检验：
## p值： 0.01</code></pre>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="相关性与相似性.html#cb558-1" tabindex="-1"></a><span class="co"># 原始序列可视化</span></span>
<span id="cb558-2"><a href="相关性与相似性.html#cb558-2" tabindex="-1"></a><span class="cf">if</span> (adf_test<span class="sc">$</span>p.value <span class="sc">&gt;=</span> <span class="fl">0.05</span>) {</span>
<span id="cb558-3"><a href="相关性与相似性.html#cb558-3" tabindex="-1"></a>  <span class="fu">plot</span>(years, bird_population,</span>
<span id="cb558-4"><a href="相关性与相似性.html#cb558-4" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;brown&quot;</span>,</span>
<span id="cb558-5"><a href="相关性与相似性.html#cb558-5" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;原始序列&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;年份&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;种群数量&quot;</span></span>
<span id="cb558-6"><a href="相关性与相似性.html#cb558-6" tabindex="-1"></a>  )</span>
<span id="cb558-7"><a href="相关性与相似性.html#cb558-7" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:original-ts-plot"></span>
<img src="05-correlation_files/figure-html/original-ts-plot-1.png" alt="原始鸟类种群数量时间序列，显示明显的下降趋势和周期性波动" width="672" />
<p class="caption">
图5.12: 原始鸟类种群数量时间序列，显示明显的下降趋势和周期性波动
</p>
</div>
<p>图<a href="相关性与相似性.html#fig:original-ts-plot">5.12</a>展示了原始鸟类种群数量时间序列，可以观察到明显的下降趋势和周期性波动，这是典型的非平稳时间序列特征。</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="相关性与相似性.html#cb559-1" tabindex="-1"></a><span class="co"># 差分后序列可视化</span></span>
<span id="cb559-2"><a href="相关性与相似性.html#cb559-2" tabindex="-1"></a><span class="cf">if</span> (adf_test<span class="sc">$</span>p.value <span class="sc">&gt;=</span> <span class="fl">0.05</span>) {</span>
<span id="cb559-3"><a href="相关性与相似性.html#cb559-3" tabindex="-1"></a>  <span class="fu">plot</span>(years[<span class="sc">-</span><span class="dv">1</span>], bird_diff,</span>
<span id="cb559-4"><a href="相关性与相似性.html#cb559-4" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb559-5"><a href="相关性与相似性.html#cb559-5" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;一阶差分后序列&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;年份&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;差分值&quot;</span></span>
<span id="cb559-6"><a href="相关性与相似性.html#cb559-6" tabindex="-1"></a>  )</span>
<span id="cb559-7"><a href="相关性与相似性.html#cb559-7" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:diff-ts-plot"></span>
<img src="05-correlation_files/figure-html/diff-ts-plot-1.png" alt="一阶差分后的鸟类种群序列，趋势成分已被去除，主要保留随机波动" width="672" />
<p class="caption">
图5.13: 一阶差分后的鸟类种群序列，趋势成分已被去除，主要保留随机波动
</p>
</div>
<p>经过一阶差分处理后，序列的趋势成分被有效去除，如图<a href="相关性与相似性.html#fig:diff-ts-plot">5.13</a>所示，差分后的序列主要保留了随机波动成分。</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="相关性与相似性.html#cb560-1" tabindex="-1"></a><span class="co"># 原始序列ACF</span></span>
<span id="cb560-2"><a href="相关性与相似性.html#cb560-2" tabindex="-1"></a><span class="cf">if</span> (adf_test<span class="sc">$</span>p.value <span class="sc">&gt;=</span> <span class="fl">0.05</span>) {</span>
<span id="cb560-3"><a href="相关性与相似性.html#cb560-3" tabindex="-1"></a>  <span class="fu">acf</span>(bird_population, <span class="at">main =</span> <span class="st">&quot;原始序列的ACF&quot;</span>)</span>
<span id="cb560-4"><a href="相关性与相似性.html#cb560-4" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:original-acf"></span>
<img src="05-correlation_files/figure-html/original-acf-1.png" alt="原始序列的自相关函数，显示缓慢衰减的非平稳特征" width="672" />
<p class="caption">
图5.14: 原始序列的自相关函数，显示缓慢衰减的非平稳特征
</p>
</div>
<p>原始序列的自相关函数（图<a href="相关性与相似性.html#fig:original-acf">5.14</a>）显示缓慢衰减的特征，这是非平稳时间序列的典型表现。</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="相关性与相似性.html#cb561-1" tabindex="-1"></a><span class="co"># 差分后序列ACF</span></span>
<span id="cb561-2"><a href="相关性与相似性.html#cb561-2" tabindex="-1"></a><span class="cf">if</span> (adf_test<span class="sc">$</span>p.value <span class="sc">&gt;=</span> <span class="fl">0.05</span>) {</span>
<span id="cb561-3"><a href="相关性与相似性.html#cb561-3" tabindex="-1"></a>  <span class="fu">acf</span>(bird_diff, <span class="at">main =</span> <span class="st">&quot;差分后序列的ACF&quot;</span>)</span>
<span id="cb561-4"><a href="相关性与相似性.html#cb561-4" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:diff-acf"></span>
<img src="05-correlation_files/figure-html/diff-acf-1.png" alt="差分后序列的自相关函数，显示快速衰减的平稳特征" width="672" />
<p class="caption">
图5.15: 差分后序列的自相关函数，显示快速衰减的平稳特征
</p>
</div>
<p>差分后序列的自相关函数（图<a href="相关性与相似性.html#fig:diff-acf">5.15</a>）显示快速衰减的特征，表明序列已经达到平稳状态。</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="相关性与相似性.html#cb562-1" tabindex="-1"></a><span class="co"># 分解时间序列（趋势、季节、随机成分）</span></span>
<span id="cb562-2"><a href="相关性与相似性.html#cb562-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(bird_population) <span class="sc">&gt;=</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">12</span>) { <span class="co"># 需要足够的数据点进行季节性分解</span></span>
<span id="cb562-3"><a href="相关性与相似性.html#cb562-3" tabindex="-1"></a>  ts_data <span class="ot">&lt;-</span> <span class="fu">ts</span>(bird_population, <span class="at">frequency =</span> <span class="dv">5</span>) <span class="co"># 假设5年周期</span></span>
<span id="cb562-4"><a href="相关性与相似性.html#cb562-4" tabindex="-1"></a>  decompose_result <span class="ot">&lt;-</span> <span class="fu">decompose</span>(ts_data)</span>
<span id="cb562-5"><a href="相关性与相似性.html#cb562-5" tabindex="-1"></a>  <span class="fu">plot</span>(decompose_result)</span>
<span id="cb562-6"><a href="相关性与相似性.html#cb562-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ts-decomposition"></span>
<img src="05-correlation_files/figure-html/ts-decomposition-1.png" alt="时间序列分解结果，展示趋势、季节性和随机成分的分离" width="672" />
<p class="caption">
图5.16: 时间序列分解结果，展示趋势、季节性和随机成分的分离
</p>
</div>
<p>图<a href="相关性与相似性.html#fig:ts-decomposition">5.16</a>展示了时间序列分解的结果，将原始序列分离为趋势、季节性和随机成分，帮助我们更好地理解时间序列的内在结构。</p>
</div>
</div>
<div id="空间自相关" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> 空间自相关<a href="相关性与相似性.html#空间自相关" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>空间自相关是生态统计学中一个富有诗意而又严谨的概念，它描述的是地理空间中相邻位置上的观测值之间那种微妙的相互关联性。这种关联性如同大自然留下的生态指纹，记录着生态过程在空间维度上的记忆和痕迹。在生态学研究中，我们常常发现许多现象都具有显著的空间依赖性：物种分布呈现出的聚集或扩散格局，环境因子如温度、降水、土壤养分在空间上的梯度变化，种群在栖息地中的空间分布模式等，所有这些都蕴含着空间自相关的密码。</p>
<p>图<a href="相关性与相似性.html#fig:spatial-patterns">5.17</a>和<a href="相关性与相似性.html#fig:spatial-heatmaps">5.18</a>直观地展示了空间自相关的不同类型和强度。当我们通过图形来直观展示空间自相关时，就如同打开了一扇观察生态空间格局的窗户。有空间自相关的图形呈现出一种”聚集之美”——在空间分布图上，我们能看到相似的值在空间上聚集在一起，形成明显的斑块、梯度或带状分布。比如在物种丰富度的热力图中，高值区域往往聚集在一起，低值区域也形成自己的群落，这种空间上的有序排列正是空间自相关的直观体现。相反，无空间自相关的图形则展现出”随机之舞”的特征——观测值在空间上呈现出完全随机的分布，没有任何明显的空间模式或聚集趋势，就像在空间中随机撒下的种子，彼此之间没有任何空间上的关联性。</p>
<p>空间自相关的强度也能够在图形中直观地展现出来。强空间自相关在图形上表现为清晰的空间格局——斑块边界分明，梯度变化平滑而连续，空间上的相似性表现得十分明显。例如，在图<a href="相关性与相似性.html#fig:spatial-patterns">5.17</a>的左下角，我们可以看到强空间自相关的典型表现：清晰的梯度变化和明确的边界。在一片森林中，如果某种树木的分布呈现出强烈的空间自相关，我们在分布图上就能看到明显的聚集中心，周围逐渐过渡到其他物种的分布区域，这种强烈的空间依赖性往往反映了重要的生态过程，如种子传播的限制、环境梯度的强烈影响或种间竞争的显著作用。</p>
<p>而弱空间自相关则呈现出较为模糊的空间趋势——虽然能够观察到一定的空间模式，但这种模式不够清晰，聚集程度较低，空间上的相似性表现得相对微弱。这种情形在生态学中同样具有重要意义，它可能反映了多种生态过程的复杂交织，或者表明所研究的生态现象受到多种因素的共同影响，没有单一的主导空间过程。图<a href="相关性与相似性.html#fig:spatial-heatmaps">5.18</a>中的热力图通过插值方法进一步清晰地展示了这些空间格局的细节。</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="相关性与相似性.html#cb563-1" tabindex="-1"></a><span class="co"># 绘制四种空间自相关模式的对比图</span></span>
<span id="cb563-2"><a href="相关性与相似性.html#cb563-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cluster_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> value, <span class="at">size =</span> value)) <span class="sc">+</span></span>
<span id="cb563-3"><a href="相关性与相似性.html#cb563-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb563-4"><a href="相关性与相似性.html#cb563-4" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb563-5"><a href="相关性与相似性.html#cb563-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;有空间自相关：聚集之美&quot;</span>,</span>
<span id="cb563-6"><a href="相关性与相似性.html#cb563-6" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;相似值在空间上聚集形成明显斑块&quot;</span>) <span class="sc">+</span></span>
<span id="cb563-7"><a href="相关性与相似性.html#cb563-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb563-8"><a href="相关性与相似性.html#cb563-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb563-9"><a href="相关性与相似性.html#cb563-9" tabindex="-1"></a></span>
<span id="cb563-10"><a href="相关性与相似性.html#cb563-10" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(random_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> value, <span class="at">size =</span> value)) <span class="sc">+</span></span>
<span id="cb563-11"><a href="相关性与相似性.html#cb563-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb563-12"><a href="相关性与相似性.html#cb563-12" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb563-13"><a href="相关性与相似性.html#cb563-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;无空间自相关：随机之舞&quot;</span>,</span>
<span id="cb563-14"><a href="相关性与相似性.html#cb563-14" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;观测值在空间上完全随机分布&quot;</span>) <span class="sc">+</span></span>
<span id="cb563-15"><a href="相关性与相似性.html#cb563-15" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb563-16"><a href="相关性与相似性.html#cb563-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb563-17"><a href="相关性与相似性.html#cb563-17" tabindex="-1"></a></span>
<span id="cb563-18"><a href="相关性与相似性.html#cb563-18" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(strong_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> value, <span class="at">size =</span> value)) <span class="sc">+</span></span>
<span id="cb563-19"><a href="相关性与相似性.html#cb563-19" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb563-20"><a href="相关性与相似性.html#cb563-20" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb563-21"><a href="相关性与相似性.html#cb563-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;强空间自相关：清晰格局&quot;</span>,</span>
<span id="cb563-22"><a href="相关性与相似性.html#cb563-22" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;边界分明，梯度变化平滑连续&quot;</span>) <span class="sc">+</span></span>
<span id="cb563-23"><a href="相关性与相似性.html#cb563-23" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb563-24"><a href="相关性与相似性.html#cb563-24" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb563-25"><a href="相关性与相似性.html#cb563-25" tabindex="-1"></a></span>
<span id="cb563-26"><a href="相关性与相似性.html#cb563-26" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(weak_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> value, <span class="at">size =</span> value)) <span class="sc">+</span></span>
<span id="cb563-27"><a href="相关性与相似性.html#cb563-27" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb563-28"><a href="相关性与相似性.html#cb563-28" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb563-29"><a href="相关性与相似性.html#cb563-29" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;弱空间自相关：模糊趋势&quot;</span>,</span>
<span id="cb563-30"><a href="相关性与相似性.html#cb563-30" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;空间模式不够清晰，聚集程度较低&quot;</span>) <span class="sc">+</span></span>
<span id="cb563-31"><a href="相关性与相似性.html#cb563-31" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb563-32"><a href="相关性与相似性.html#cb563-32" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb563-33"><a href="相关性与相似性.html#cb563-33" tabindex="-1"></a></span>
<span id="cb563-34"><a href="相关性与相似性.html#cb563-34" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:spatial-patterns"></span>
<img src="05-correlation_files/figure-html/spatial-patterns-1.png" alt="空间自相关模式的直观展示：有空间自相关（左上）、无空间自相关（右上）、强空间自相关（左下）、弱空间自相关（右下）" width="768" />
<p class="caption">
图5.17: 空间自相关模式的直观展示：有空间自相关（左上）、无空间自相关（右上）、强空间自相关（左下）、弱空间自相关（右下）
</p>
</div>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="相关性与相似性.html#cb564-1" tabindex="-1"></a><span class="co"># 创建热力图展示空间自相关</span></span>
<span id="cb564-2"><a href="相关性与相似性.html#cb564-2" tabindex="-1"></a>create_heatmap <span class="ot">&lt;-</span> <span class="cf">function</span>(data, title) {</span>
<span id="cb564-3"><a href="相关性与相似性.html#cb564-3" tabindex="-1"></a>  <span class="co"># 使用插值方法创建平滑的热力图</span></span>
<span id="cb564-4"><a href="相关性与相似性.html#cb564-4" tabindex="-1"></a>  interp_data <span class="ot">&lt;-</span> <span class="fu">with</span>(data, <span class="fu">interp</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">z =</span> value,</span>
<span id="cb564-5"><a href="相关性与相似性.html#cb564-5" tabindex="-1"></a>                                   <span class="at">xo =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length =</span> <span class="dv">50</span>),</span>
<span id="cb564-6"><a href="相关性与相似性.html#cb564-6" tabindex="-1"></a>                                   <span class="at">yo =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length =</span> <span class="dv">50</span>)))</span>
<span id="cb564-7"><a href="相关性与相似性.html#cb564-7" tabindex="-1"></a></span>
<span id="cb564-8"><a href="相关性与相似性.html#cb564-8" tabindex="-1"></a>  <span class="co"># 转换为数据框用于ggplot</span></span>
<span id="cb564-9"><a href="相关性与相似性.html#cb564-9" tabindex="-1"></a>  heatmap_df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x =</span> interp_data<span class="sc">$</span>x, <span class="at">y =</span> interp_data<span class="sc">$</span>y)</span>
<span id="cb564-10"><a href="相关性与相似性.html#cb564-10" tabindex="-1"></a>  heatmap_df<span class="sc">$</span>z <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(interp_data<span class="sc">$</span>z)</span>
<span id="cb564-11"><a href="相关性与相似性.html#cb564-11" tabindex="-1"></a></span>
<span id="cb564-12"><a href="相关性与相似性.html#cb564-12" tabindex="-1"></a>  <span class="fu">ggplot</span>(heatmap_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> z)) <span class="sc">+</span></span>
<span id="cb564-13"><a href="相关性与相似性.html#cb564-13" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb564-14"><a href="相关性与相似性.html#cb564-14" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb564-15"><a href="相关性与相似性.html#cb564-15" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title, <span class="at">fill =</span> <span class="st">&quot;值&quot;</span>) <span class="sc">+</span></span>
<span id="cb564-16"><a href="相关性与相似性.html#cb564-16" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb564-17"><a href="相关性与相似性.html#cb564-17" tabindex="-1"></a>    <span class="fu">coord_fixed</span>()</span>
<span id="cb564-18"><a href="相关性与相似性.html#cb564-18" tabindex="-1"></a>}</span>
<span id="cb564-19"><a href="相关性与相似性.html#cb564-19" tabindex="-1"></a></span>
<span id="cb564-20"><a href="相关性与相似性.html#cb564-20" tabindex="-1"></a>heatmap1 <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(cluster_data, <span class="st">&quot;有空间自相关的热力图：明显的聚集中心&quot;</span>)</span>
<span id="cb564-21"><a href="相关性与相似性.html#cb564-21" tabindex="-1"></a>heatmap2 <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(random_data, <span class="st">&quot;无空间自相关的热力图：随机分布模式&quot;</span>)</span>
<span id="cb564-22"><a href="相关性与相似性.html#cb564-22" tabindex="-1"></a>heatmap3 <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(strong_data, <span class="st">&quot;强空间自相关的热力图：清晰的梯度变化&quot;</span>)</span>
<span id="cb564-23"><a href="相关性与相似性.html#cb564-23" tabindex="-1"></a>heatmap4 <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(weak_data, <span class="st">&quot;弱空间自相关的热力图：模糊的空间趋势&quot;</span>)</span>
<span id="cb564-24"><a href="相关性与相似性.html#cb564-24" tabindex="-1"></a></span>
<span id="cb564-25"><a href="相关性与相似性.html#cb564-25" tabindex="-1"></a><span class="fu">grid.arrange</span>(heatmap1, heatmap2, heatmap3, heatmap4, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:spatial-heatmaps"></span>
<img src="05-correlation_files/figure-html/spatial-heatmaps-1.png" alt="空间自相关的热力图展示：通过插值方法生成的热力图能够更清晰地显示空间格局" width="960" />
<p class="caption">
图5.18: 空间自相关的热力图展示：通过插值方法生成的热力图能够更清晰地显示空间格局
</p>
</div>
<p>通过空间分布图、热力图和等值线图等直观的图形工具，我们能够直接”看到”空间自相关的存在与否及其强度。这些图形就像生态系统的空间肖像，记录着生态过程在空间维度上的印记。当我们观察一片草原的植被覆盖度分布图时，那些绿色的斑块和过渡带不仅美化了图形，更重要的是它们揭示了植被生长的空间依赖性；当我们研究河流水质参数的空间分布时，那些沿着河流流向逐渐变化的色彩梯度，正是空间自相关在水环境中的生动体现。</p>
<p>空间自相关分析因此成为我们理解生态现象空间结构和空间过程的重要工具。它帮助我们解读生态系统的空间语言，识别生态过程的作用尺度，为生态保护、资源管理和环境监测提供科学依据。在这个充满联系和依赖的生态世界中，空间自相关就像一把钥匙，帮助我们打开理解生态空间格局的大门。</p>
<div id="变异函数variogram空间依赖性的量化" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> 变异函数（Variogram）：空间依赖性的量化<a href="相关性与相似性.html#变异函数variogram空间依赖性的量化" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>假设我们正在研究一片草原上植物物种丰富度的空间分布，我们在100个样点上测量了物种数，想要了解物种丰富度在空间上的依赖关系如何随距离变化。</p>
<p>变异函数是地统计学中的核心工具，用于量化空间自相关随距离的变化模式。变异函数描述的是空间变量在特定距离下的半方差，即相同距离的观测点对之间差异的期望值的一半。变异函数的核心思想是：在空间上相近的观测值往往比相距较远的观测值更相似，这种相似性随着距离的增加而逐渐减弱，直到达到某个距离后相似性不再随距离变化。变异函数通常通过三个关键参数来描述空间依赖结构：块金值（nugget）、基台值（sill）和变程（range）。块金值代表距离为零时的半方差，反映了测量误差或小尺度变异；基台值代表半方差达到稳定时的值，反映了变量的总空间变异；变程代表空间自相关存在的最大距离，反映了空间依赖性的尺度。</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:variogram-parameters-explanation"></span>
<img src="05-correlation_files/figure-html/variogram-parameters-explanation-1.png" alt="变异函数三个关键参数的技术解释：块金值（nugget）、基台值（sill）和变程（range）的直观展示" width="672" />
<p class="caption">
图5.19: 变异函数三个关键参数的技术解释：块金值（nugget）、基台值（sill）和变程（range）的直观展示
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:variogram-parameters-comparison"></span>
<img src="05-correlation_files/figure-html/variogram-parameters-comparison-1.png" alt="不同变异函数参数组合的对比：展示块金值、基台值和变程对空间依赖结构的影响" width="672" />
<p class="caption">
图5.20: 不同变异函数参数组合的对比：展示块金值、基台值和变程对空间依赖结构的影响
</p>
</div>
<p>图<a href="相关性与相似性.html#fig:variogram-parameters-explanation">5.19</a>和<a href="相关性与相似性.html#fig:variogram-parameters-comparison">5.20</a>通过R代码技术性地解释了变异函数的三个关键参数。这些图形清晰地展示了块金值、基台值和变程在变异函数曲线中的位置和意义，帮助我们直观理解空间依赖结构的不同方面。</p>
<p>在生态学研究中，变异函数具有广泛的应用价值。例如，在分析物种分布时，变异函数可以帮助识别物种聚集的尺度；在研究环境异质性时，变异函数可以揭示环境因子的空间结构；在生态监测设计中，变异函数可以为确定合适的采样间距提供依据。变异函数的形状也提供了关于空间过程的重要信息：如果变异函数快速上升并达到基台值，表明空间依赖性在较小尺度上存在；如果变异函数缓慢上升，表明空间依赖性在较大尺度上存在；如果变异函数呈现周期性波动，可能反映重复的空间格局。此外，拟合的理论变异函数模型（如球状模型、指数模型、高斯模型等）可以用于空间插值（克里金法）和空间预测。</p>
<p><strong>数学定义</strong>：对于空间变量<span class="math inline">\(Z(\mathbf{s})\)</span>，其中<span class="math inline">\(\mathbf{s}\)</span>表示空间位置，变异函数定义为：</p>
<p><span class="math display">\[\gamma(\mathbf{h}) = \frac{1}{2}E[(Z(\mathbf{s} + \mathbf{h}) - Z(\mathbf{s}))^2]\]</span></p>
<p>其中<span class="math inline">\(\mathbf{h}\)</span>是空间滞后向量，<span class="math inline">\(E[\cdot]\)</span>表示期望值。</p>
<p><strong>R代码实现</strong>：</p>
<p>首先，我们通过图<a href="相关性与相似性.html#fig:soil-ph-sampling">5.21</a>展示土壤pH值的空间取样分布，这有助于我们直观理解数据的空间格局。然后，通过图<a href="#fig:soil-ph-variogram"><strong>??</strong></a>展示如何用变异函数来捕捉其中的空间自相关。</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="相关性与相似性.html#cb565-1" tabindex="-1"></a><span class="co"># 变异函数示例：土壤pH值的空间分布</span></span>
<span id="cb565-2"><a href="相关性与相似性.html#cb565-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb565-3"><a href="相关性与相似性.html#cb565-3" tabindex="-1"></a></span>
<span id="cb565-4"><a href="相关性与相似性.html#cb565-4" tabindex="-1"></a><span class="co"># 模拟空间数据：100个样点的坐标和土壤pH值</span></span>
<span id="cb565-5"><a href="相关性与相似性.html#cb565-5" tabindex="-1"></a><span class="fu">library</span>(gstat)</span>
<span id="cb565-6"><a href="相关性与相似性.html#cb565-6" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb565-7"><a href="相关性与相似性.html#cb565-7" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb565-8"><a href="相关性与相似性.html#cb565-8" tabindex="-1"></a></span>
<span id="cb565-9"><a href="相关性与相似性.html#cb565-9" tabindex="-1"></a>n_sites <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb565-10"><a href="相关性与相似性.html#cb565-10" tabindex="-1"></a></span>
<span id="cb565-11"><a href="相关性与相似性.html#cb565-11" tabindex="-1"></a><span class="co"># 生成随机空间坐标</span></span>
<span id="cb565-12"><a href="相关性与相似性.html#cb565-12" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb565-13"><a href="相关性与相似性.html#cb565-13" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">runif</span>(n_sites, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb565-14"><a href="相关性与相似性.html#cb565-14" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">runif</span>(n_sites, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb565-15"><a href="相关性与相似性.html#cb565-15" tabindex="-1"></a>)</span>
<span id="cb565-16"><a href="相关性与相似性.html#cb565-16" tabindex="-1"></a></span>
<span id="cb565-17"><a href="相关性与相似性.html#cb565-17" tabindex="-1"></a><span class="co"># 模拟具有空间自相关的土壤pH值数据</span></span>
<span id="cb565-18"><a href="相关性与相似性.html#cb565-18" tabindex="-1"></a><span class="co"># 使用高斯随机场模拟空间相关性</span></span>
<span id="cb565-19"><a href="相关性与相似性.html#cb565-19" tabindex="-1"></a><span class="fu">library</span>(geoR)</span>
<span id="cb565-20"><a href="相关性与相似性.html#cb565-20" tabindex="-1"></a></span>
<span id="cb565-21"><a href="相关性与相似性.html#cb565-21" tabindex="-1"></a><span class="co"># 设置空间相关参数</span></span>
<span id="cb565-22"><a href="相关性与相似性.html#cb565-22" tabindex="-1"></a>mean_pH <span class="ot">&lt;-</span> <span class="fl">6.5</span> <span class="co"># 平均土壤pH值</span></span>
<span id="cb565-23"><a href="相关性与相似性.html#cb565-23" tabindex="-1"></a>spatial_range <span class="ot">&lt;-</span> <span class="dv">30</span> <span class="co"># 空间相关范围</span></span>
<span id="cb565-24"><a href="相关性与相似性.html#cb565-24" tabindex="-1"></a>spatial_variance <span class="ot">&lt;-</span> <span class="fl">0.8</span> <span class="co"># 空间方差</span></span>
<span id="cb565-25"><a href="相关性与相似性.html#cb565-25" tabindex="-1"></a></span>
<span id="cb565-26"><a href="相关性与相似性.html#cb565-26" tabindex="-1"></a><span class="co"># 生成高斯随机场</span></span>
<span id="cb565-27"><a href="相关性与相似性.html#cb565-27" tabindex="-1"></a>grf_model <span class="ot">&lt;-</span> <span class="fu">grf</span>(</span>
<span id="cb565-28"><a href="相关性与相似性.html#cb565-28" tabindex="-1"></a>  <span class="at">n =</span> n_sites,</span>
<span id="cb565-29"><a href="相关性与相似性.html#cb565-29" tabindex="-1"></a>  <span class="at">grid =</span> <span class="st">&quot;irreg&quot;</span>,</span>
<span id="cb565-30"><a href="相关性与相似性.html#cb565-30" tabindex="-1"></a>  <span class="at">xlims =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb565-31"><a href="相关性与相似性.html#cb565-31" tabindex="-1"></a>  <span class="at">ylims =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb565-32"><a href="相关性与相似性.html#cb565-32" tabindex="-1"></a>  <span class="at">cov.pars =</span> <span class="fu">c</span>(spatial_variance, spatial_range),</span>
<span id="cb565-33"><a href="相关性与相似性.html#cb565-33" tabindex="-1"></a>  <span class="at">cov.model =</span> <span class="st">&quot;exponential&quot;</span></span>
<span id="cb565-34"><a href="相关性与相似性.html#cb565-34" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## grf: simulation(s) on randomly chosen locations with  100  points
## grf: process with  1  covariance structure(s)
## grf: nugget effect is: tausq= 0 
## grf: covariance model 1 is: exponential(sigmasq=0.8, phi=30)
## grf: decomposition algorithm used is:  cholesky 
## grf: End of simulation procedure. Number of realizations: 1</code></pre>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="相关性与相似性.html#cb567-1" tabindex="-1"></a>soil_pH <span class="ot">&lt;-</span> mean_pH <span class="sc">+</span> grf_model<span class="sc">$</span>data</span>
<span id="cb567-2"><a href="相关性与相似性.html#cb567-2" tabindex="-1"></a></span>
<span id="cb567-3"><a href="相关性与相似性.html#cb567-3" tabindex="-1"></a><span class="co"># 创建空间数据框</span></span>
<span id="cb567-4"><a href="相关性与相似性.html#cb567-4" tabindex="-1"></a>spatial_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb567-5"><a href="相关性与相似性.html#cb567-5" tabindex="-1"></a>  <span class="at">x =</span> grf_model<span class="sc">$</span>coords[, <span class="dv">1</span>],</span>
<span id="cb567-6"><a href="相关性与相似性.html#cb567-6" tabindex="-1"></a>  <span class="at">y =</span> grf_model<span class="sc">$</span>coords[, <span class="dv">2</span>],</span>
<span id="cb567-7"><a href="相关性与相似性.html#cb567-7" tabindex="-1"></a>  <span class="at">pH =</span> soil_pH</span>
<span id="cb567-8"><a href="相关性与相似性.html#cb567-8" tabindex="-1"></a>)</span>
<span id="cb567-9"><a href="相关性与相似性.html#cb567-9" tabindex="-1"></a><span class="fu">coordinates</span>(spatial_data) <span class="ot">&lt;-</span> <span class="er">~</span> x <span class="sc">+</span> y</span>
<span id="cb567-10"><a href="相关性与相似性.html#cb567-10" tabindex="-1"></a></span>
<span id="cb567-11"><a href="相关性与相似性.html#cb567-11" tabindex="-1"></a><span class="co"># 可视化空间取样分布</span></span>
<span id="cb567-12"><a href="相关性与相似性.html#cb567-12" tabindex="-1"></a>spatial_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(spatial_data)</span>
<span id="cb567-13"><a href="相关性与相似性.html#cb567-13" tabindex="-1"></a></span>
<span id="cb567-14"><a href="相关性与相似性.html#cb567-14" tabindex="-1"></a><span class="fu">ggplot</span>(spatial_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> pH)) <span class="sc">+</span></span>
<span id="cb567-15"><a href="相关性与相似性.html#cb567-15" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb567-16"><a href="相关性与相似性.html#cb567-16" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">&quot;red&quot;</span>, <span class="at">high =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb567-17"><a href="相关性与相似性.html#cb567-17" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb567-18"><a href="相关性与相似性.html#cb567-18" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;土壤pH值的空间取样分布&quot;</span>,</span>
<span id="cb567-19"><a href="相关性与相似性.html#cb567-19" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y坐标&quot;</span>, <span class="at">color =</span> <span class="st">&quot;pH值&quot;</span></span>
<span id="cb567-20"><a href="相关性与相似性.html#cb567-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb567-21"><a href="相关性与相似性.html#cb567-21" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:soil-ph-sampling"></span>
<img src="05-correlation_files/figure-html/soil-ph-sampling-1.png" alt="土壤pH值的空间取样分布图" width="672" />
<p class="caption">
图5.21: 土壤pH值的空间取样分布图
</p>
</div>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="相关性与相似性.html#cb568-1" tabindex="-1"></a><span class="co"># 计算经验变异函数</span></span>
<span id="cb568-2"><a href="相关性与相似性.html#cb568-2" tabindex="-1"></a>variogram_emp <span class="ot">&lt;-</span> <span class="fu">variogram</span>(pH <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> spatial_data)</span>
<span id="cb568-3"><a href="相关性与相似性.html#cb568-3" tabindex="-1"></a></span>
<span id="cb568-4"><a href="相关性与相似性.html#cb568-4" tabindex="-1"></a><span class="co"># 可视化经验变异函数</span></span>
<span id="cb568-5"><a href="相关性与相似性.html#cb568-5" tabindex="-1"></a><span class="fu">plot</span>(variogram_emp,</span>
<span id="cb568-6"><a href="相关性与相似性.html#cb568-6" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;土壤pH值的经验变异函数&quot;</span>,</span>
<span id="cb568-7"><a href="相关性与相似性.html#cb568-7" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;距离&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;半方差&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb568-8"><a href="相关性与相似性.html#cb568-8" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:soil-ph-variogram-1"></span>
<img src="05-correlation_files/figure-html/soil-ph-variogram-1.png" alt="土壤pH值的经验变异函数和空间分布图" width="672" />
<p class="caption">
图5.22: 土壤pH值的经验变异函数和空间分布图
</p>
</div>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="相关性与相似性.html#cb569-1" tabindex="-1"></a><span class="co"># 拟合理论变异函数模型（指数模型）</span></span>
<span id="cb569-2"><a href="相关性与相似性.html#cb569-2" tabindex="-1"></a>variogram_fit <span class="ot">&lt;-</span> <span class="fu">fit.variogram</span>(variogram_emp, <span class="at">model =</span> <span class="fu">vgm</span>(<span class="fl">0.8</span>, <span class="st">&quot;Exp&quot;</span>, <span class="dv">30</span>, <span class="fl">0.1</span>))</span>
<span id="cb569-3"><a href="相关性与相似性.html#cb569-3" tabindex="-1"></a></span>
<span id="cb569-4"><a href="相关性与相似性.html#cb569-4" tabindex="-1"></a><span class="co"># 可视化拟合结果</span></span>
<span id="cb569-5"><a href="相关性与相似性.html#cb569-5" tabindex="-1"></a><span class="fu">plot</span>(variogram_emp, variogram_fit,</span>
<span id="cb569-6"><a href="相关性与相似性.html#cb569-6" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;变异函数拟合&quot;</span>,</span>
<span id="cb569-7"><a href="相关性与相似性.html#cb569-7" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;距离&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;半方差&quot;</span></span>
<span id="cb569-8"><a href="相关性与相似性.html#cb569-8" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:soil-ph-variogram-2"></span>
<img src="05-correlation_files/figure-html/soil-ph-variogram-2.png" alt="土壤pH值的经验变异函数和空间分布图" width="672" />
<p class="caption">
图5.23: 土壤pH值的经验变异函数和空间分布图
</p>
</div>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="相关性与相似性.html#cb570-1" tabindex="-1"></a><span class="co"># 提取变异函数参数</span></span>
<span id="cb570-2"><a href="相关性与相似性.html#cb570-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;变异函数参数：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb570-3"><a href="相关性与相似性.html#cb570-3" tabindex="-1"></a>    <span class="st">&quot;块金值 (nugget)：&quot;</span>, variogram_fit<span class="sc">$</span>psill[<span class="dv">1</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb570-4"><a href="相关性与相似性.html#cb570-4" tabindex="-1"></a>    <span class="st">&quot;偏基台值 (partial sill)：&quot;</span>, variogram_fit<span class="sc">$</span>psill[<span class="dv">2</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb570-5"><a href="相关性与相似性.html#cb570-5" tabindex="-1"></a>    <span class="st">&quot;基台值 (sill)：&quot;</span>, <span class="fu">sum</span>(variogram_fit<span class="sc">$</span>psill), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb570-6"><a href="相关性与相似性.html#cb570-6" tabindex="-1"></a>    <span class="st">&quot;变程 (range)：&quot;</span>, variogram_fit<span class="sc">$</span>range[<span class="dv">2</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb570-7"><a href="相关性与相似性.html#cb570-7" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 变异函数参数：
## 块金值 (nugget)：0
## 偏基台值 (partial sill)：8.068916
## 基台值 (sill)：8.068916
## 变程 (range)：411.6761</code></pre>
</div>
<div id="克里金插值基于空间自相关的预测方法" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> 克里金插值：基于空间自相关的预测方法<a href="相关性与相似性.html#克里金插值基于空间自相关的预测方法" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>克里金插值是一种基于变异函数理论的空间预测方法，由南非矿业工程师丹尼尔·克里金于20世纪50年代提出，最初用于金矿储量的估计，后来被广泛应用于地质学、环境科学和生态学等领域。克里金插值的核心思想是利用已知观测点之间的空间相关性来预测未知位置的属性值，其理论基础是区域化变量理论和最优无偏估计原则。</p>
<p>克里金插值的数学原理基于以下几个关键假设：首先，空间变量被认为是区域化变量，即在空间上具有连续性和相关性；其次，空间变量的变异结构可以通过变异函数来量化；最后，克里金插值寻求的是最优线性无偏估计，即在所有线性无偏估计中方差最小的估计。克里金插值的基本形式可以表示为：</p>
<p><span class="math display">\[\hat{Z}(s_0) = \sum_{i=1}^{n} \lambda_i Z(s_i)\]</span></p>
<p>其中<span class="math inline">\(\hat{Z}(s_0)\)</span>是未知位置<span class="math inline">\(s_0\)</span>的预测值，<span class="math inline">\(Z(s_i)\)</span>是已知位置<span class="math inline">\(s_i\)</span>的观测值，<span class="math inline">\(\lambda_i\)</span>是权重系数。权重系数的确定需要满足两个条件：无偏性条件<span class="math inline">\(\sum_{i=1}^{n} \lambda_i = 1\)</span>和最小方差条件。通过求解克里金方程组可以得到最优权重系数：</p>
<p><span class="math display">\[\begin{cases}
\sum_{j=1}^{n} \lambda_j \gamma(s_i, s_j) + \mu = \gamma(s_i, s_0) &amp; i = 1,2,\ldots,n \\
\sum_{j=1}^{n} \lambda_j = 1
\end{cases}\]</span></p>
<p>其中<span class="math inline">\(\gamma(s_i, s_j)\)</span>是位置<span class="math inline">\(s_i\)</span>和<span class="math inline">\(s_j\)</span>之间的半方差，<span class="math inline">\(\mu\)</span>是拉格朗日乘子。</p>
<p>克里金插值有多种类型，每种类型适用于不同的空间过程和假设条件。普通克里金是最常用的形式，适用于具有恒定均值的平稳空间过程。其假设空间变量的均值在整个研究区域内是常数，但未知。普通克里金通过局部邻域内的观测值来估计未知点的值，权重取决于观测点与预测点之间的空间相关性。普通克里金的预测方差可以表示为：</p>
<p><span class="math display">\[\sigma^2_{OK} = \sum_{i=1}^{n} \lambda_i \gamma(s_i, s_0) + \mu\]</span></p>
<p>这种预测方差提供了克里金预测的不确定性度量，在生态学应用中具有重要价值。</p>
<p>除了普通克里金，还有其他类型的克里金方法适用于更复杂的空间过程。简单克里金假设空间变量的均值已知且恒定，适用于有充分先验知识的场景。泛克里金适用于具有趋势的非平稳空间过程，通过引入趋势面函数来建模空间变量的系统性变化。协同克里金则利用辅助变量来提高主要变量的预测精度，特别适用于当辅助变量更容易获取或测量精度更高时。指示克里金用于处理分类变量或存在阈值的连续变量，通过将连续变量转换为指示变量来进行空间预测。</p>
<p>在生态学研究中，克里金插值具有广泛的应用价值。首先，它可以用于生成连续的空间分布图，如物种丰富度、环境因子、土壤属性等的空间分布。这些分布图为生态学家提供了直观的空间格局可视化，有助于识别热点区域、环境梯度和空间异质性。其次，克里金插值可以用于填补缺失数据，特别是在野外调查中由于各种原因无法到达所有位置时。通过基于已有观测点的空间相关性，可以合理估计缺失位置的值。第三，克里金预测方差提供了空间预测的不确定性信息，这对于生态风险评估和决策制定具有重要意义。例如，在保护生物学中，高预测方差的区域可能需要更密集的采样来降低不确定性。</p>
<p>克里金插值的实施通常包括以下几个步骤：数据探索和预处理、经验变异函数计算、理论变异函数拟合、克里金方程组求解、空间预测和不确定性评估。在数据探索阶段，需要检查数据的空间分布、异常值和趋势性。经验变异函数的计算需要考虑方向性，以检测各向异性。理论变异函数的拟合需要选择合适的模型（如球状模型、指数模型、高斯模型）和参数。克里金预测的质量取决于变异函数模型的准确性和空间采样设计的合理性。</p>
<p>尽管克里金插值在生态学中应用广泛，但也存在一些局限性和注意事项。首先，克里金插值对变异函数模型的选择比较敏感，不合适的模型可能导致有偏的预测。其次，克里金插值假设空间过程是平稳的或准平稳的，对于高度非平稳的过程可能需要使用泛克里金或其他方法。第三，克里金插值的预测精度受到采样密度和空间分布的影响，在采样稀疏的区域预测不确定性较高。第四，克里金插值对异常值比较敏感，需要在预处理阶段进行适当处理。</p>
<p>在生态学实践中，克里金插值通常与其他空间分析方法结合使用。例如，与地理信息系统（GIS）结合可以实现空间数据的可视化和分析；与遥感数据结合可以提供大尺度的环境背景；与统计模型结合可以分析空间格局与环境因子的关系。随着计算技术的发展，克里金插值也在不断演进，出现了如贝叶斯克里金、机器学习结合克里金等新方法，为生态学研究提供了更强大的空间分析工具。</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="相关性与相似性.html#cb572-1" tabindex="-1"></a><span class="co"># 进行空间插值（普通克里金法）</span></span>
<span id="cb572-2"><a href="相关性与相似性.html#cb572-2" tabindex="-1"></a><span class="fu">library</span>(automap)</span>
<span id="cb572-3"><a href="相关性与相似性.html#cb572-3" tabindex="-1"></a></span>
<span id="cb572-4"><a href="相关性与相似性.html#cb572-4" tabindex="-1"></a><span class="co"># 创建插值网格</span></span>
<span id="cb572-5"><a href="相关性与相似性.html#cb572-5" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb572-6"><a href="相关性与相似性.html#cb572-6" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">50</span>),</span>
<span id="cb572-7"><a href="相关性与相似性.html#cb572-7" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">length.out =</span> <span class="dv">50</span>)</span>
<span id="cb572-8"><a href="相关性与相似性.html#cb572-8" tabindex="-1"></a>)</span>
<span id="cb572-9"><a href="相关性与相似性.html#cb572-9" tabindex="-1"></a><span class="fu">coordinates</span>(grid) <span class="ot">&lt;-</span> <span class="er">~</span> x <span class="sc">+</span> y</span>
<span id="cb572-10"><a href="相关性与相似性.html#cb572-10" tabindex="-1"></a><span class="fu">gridded</span>(grid) <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb572-11"><a href="相关性与相似性.html#cb572-11" tabindex="-1"></a></span>
<span id="cb572-12"><a href="相关性与相似性.html#cb572-12" tabindex="-1"></a><span class="co"># 执行克里金插值</span></span>
<span id="cb572-13"><a href="相关性与相似性.html#cb572-13" tabindex="-1"></a>kriging_result <span class="ot">&lt;-</span> <span class="fu">autoKrige</span>(pH <span class="sc">~</span> <span class="dv">1</span>, spatial_data, grid)</span></code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="相关性与相似性.html#cb574-1" tabindex="-1"></a><span class="co"># 可视化插值结果</span></span>
<span id="cb574-2"><a href="相关性与相似性.html#cb574-2" tabindex="-1"></a><span class="fu">plot</span>(kriging_result)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kriging-result"></span>
<img src="05-correlation_files/figure-html/kriging-result-1.png" alt="土壤pH值的克里金插值结果" width="672" />
<p class="caption">
图5.24: 土壤pH值的克里金插值结果
</p>
</div>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="相关性与相似性.html#cb575-1" tabindex="-1"></a><span class="co"># 提取克里金预测统计信息</span></span>
<span id="cb575-2"><a href="相关性与相似性.html#cb575-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;克里金插值统计信息：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 克里金插值统计信息：</code></pre>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="相关性与相似性.html#cb577-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;预测值的范围：&quot;</span>, <span class="fu">round</span>(<span class="fu">range</span>(kriging_result<span class="sc">$</span>krige_output<span class="sc">$</span>var1.pred), <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 预测值的范围： 5.5 8.72</code></pre>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="相关性与相似性.html#cb579-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;预测方差的范围：&quot;</span>, <span class="fu">round</span>(<span class="fu">range</span>(kriging_result<span class="sc">$</span>krige_output<span class="sc">$</span>var1.var), <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 预测方差的范围： 0.0287 0.4863</code></pre>
<p><strong>生态学意义</strong>：变异函数在生态学中广泛应用于量化空间依赖性的尺度，如物种分布的空间格局、环境异质性的空间结构、种群聚集的空间范围等。通过图<a href="相关性与相似性.html#fig:kriging-result">5.24</a>展示的克里金插值结果，我们可以看到基于空间自相关的预测方法如何生成连续的空间分布图，为生态学研究和环境管理提供重要的空间信息。</p>
</div>
<div id="空间自相关指数全局空间模式的检测" class="section level3 hasAnchor" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> 空间自相关指数：全局空间模式的检测<a href="相关性与相似性.html#空间自相关指数全局空间模式的检测" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在研究森林中树木分布的空间格局时，我们想要了解整个研究区域内树木分布是随机分布、聚集分布还是均匀分布，这需要使用全局空间自相关指数来量化。</p>
<p>空间自相关指数是量化空间数据中自相关程度的统计量，其中最著名的是Moran’s I和Geary’s C。这些指数提供了对全局空间模式的整体度量，帮助我们判断空间数据是否表现出显著的空间自相关。Moran’s I是最常用的全局空间自相关指数，其计算原理类似于Pearson相关系数，但应用于空间邻接关系。Moran’s I的取值范围通常在-1到1之间，正值表示正空间自相关（即相似的值在空间上聚集），负值表示负空间自相关（即相异的值在空间上聚集），0值表示没有空间自相关（即随机分布）。</p>
<p>Geary’s C是另一个重要的全局空间自相关指数，其计算基于相邻观测值之间的差异。与Moran’s I不同，Geary’s C的取值范围在0到2之间，其中0表示完全正空间自相关，1表示没有空间自相关，大于1的值表示负空间自相关。Geary’s C对局部差异更加敏感，而Moran’s I对全局模式更加敏感。在生态学应用中，这两种指数往往结合使用，以提供对空间模式的全面理解。</p>
<p>数可以量化种群的聚集程度。此外，空间自相关检验还为许多空间统计方法提供了基础，如空间回归模型、空间方差分析等。</p>
<p><strong>数学定义</strong>：</p>
<ul>
<li><strong>Moran’s I</strong>：</li>
</ul>
<p><span class="math display">\[I = \frac{n}{\sum_{i=1}^{n}\sum_{j=1}^{n}w_{ij}} \cdot \frac{\sum_{i=1}^{n}\sum_{j=1}^{n}w_{ij}(x_i - \bar{x})(x_j - \bar{x})}{\sum_{i=1}^{n}(x_i - \bar{x})^2}\]</span></p>
<p>其中<span class="math inline">\(n\)</span>是观测点数，<span class="math inline">\(x_i\)</span>是第<span class="math inline">\(i\)</span>个观测值，<span class="math inline">\(\bar{x}\)</span>是样本均值，<span class="math inline">\(w_{ij}\)</span>是空间权重。</p>
<ul>
<li><strong>Geary’s C</strong>：</li>
</ul>
<p><span class="math display">\[C = \frac{(n-1)}{2\sum_{i=1}^{n}\sum_{j=1}^{n}w_{ij}} \cdot \frac{\sum_{i=1}^{n}\sum_{j=1}^{n}w_{ij}(x_i - x_j)^2}{\sum_{i=1}^{n}(x_i - \bar{x})^2}\]</span></p>
<p>空间自相关指数的计算需要定义空间权重矩阵，该矩阵量化了不同空间位置之间的邻接关系或空间影响。常见的权重定义方法包括基于距离的权重（如反距离权重）、基于邻接的权重（如queen邻接、rook邻接）和基于核函数的权重。权重矩阵的选择对空间自相关分析的结果有重要影响，需要根据研究的具体背景和空间过程的性质来合理选择。</p>
<p>在生态学研究中，空间自相关指数具有重要的应用价值。例如，在保护生物学中，Moran’s I可以帮助识别物种的热点区域；在景观生态学中，空间自相关分析可以揭示生境破碎化的空间模式；在种群生态学中，这些指</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="相关性与相似性.html#cb581-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb581-2"><a href="相关性与相似性.html#cb581-2" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb581-3"><a href="相关性与相似性.html#cb581-3" tabindex="-1"></a></span>
<span id="cb581-4"><a href="相关性与相似性.html#cb581-4" tabindex="-1"></a><span class="co"># 设置随机种子确保结果可重现</span></span>
<span id="cb581-5"><a href="相关性与相似性.html#cb581-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span></code></pre></div>
<p>接下来，我们模拟森林树木的空间分布。我们假设树木在空间上呈现聚集分布模式，这在真实的森林中很常见：</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="相关性与相似性.html#cb582-1" tabindex="-1"></a><span class="co"># 模拟森林树木数据</span></span>
<span id="cb582-2"><a href="相关性与相似性.html#cb582-2" tabindex="-1"></a>n_trees <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb582-3"><a href="相关性与相似性.html#cb582-3" tabindex="-1"></a></span>
<span id="cb582-4"><a href="相关性与相似性.html#cb582-4" tabindex="-1"></a><span class="co"># 生成树木坐标（模拟聚集分布）</span></span>
<span id="cb582-5"><a href="相关性与相似性.html#cb582-5" tabindex="-1"></a><span class="co"># 使用聚类过程生成聚集分布的坐标</span></span>
<span id="cb582-6"><a href="相关性与相似性.html#cb582-6" tabindex="-1"></a>cluster_centers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb582-7"><a href="相关性与相似性.html#cb582-7" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb582-8"><a href="相关性与相似性.html#cb582-8" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb582-9"><a href="相关性与相似性.html#cb582-9" tabindex="-1"></a>)</span>
<span id="cb582-10"><a href="相关性与相似性.html#cb582-10" tabindex="-1"></a></span>
<span id="cb582-11"><a href="相关性与相似性.html#cb582-11" tabindex="-1"></a>tree_coords <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">numeric</span>(<span class="dv">0</span>), <span class="at">y =</span> <span class="fu">numeric</span>(<span class="dv">0</span>))</span>
<span id="cb582-12"><a href="相关性与相似性.html#cb582-12" tabindex="-1"></a></span>
<span id="cb582-13"><a href="相关性与相似性.html#cb582-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cluster_centers)) {</span>
<span id="cb582-14"><a href="相关性与相似性.html#cb582-14" tabindex="-1"></a>  n_cluster <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">15</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">1</span>) <span class="co"># 每个簇的树木数量</span></span>
<span id="cb582-15"><a href="相关性与相似性.html#cb582-15" tabindex="-1"></a>  cluster_trees <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb582-16"><a href="相关性与相似性.html#cb582-16" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(n_cluster, cluster_centers<span class="sc">$</span>x[i], <span class="dv">8</span>),</span>
<span id="cb582-17"><a href="相关性与相似性.html#cb582-17" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">rnorm</span>(n_cluster, cluster_centers<span class="sc">$</span>y[i], <span class="dv">8</span>)</span>
<span id="cb582-18"><a href="相关性与相似性.html#cb582-18" tabindex="-1"></a>  )</span>
<span id="cb582-19"><a href="相关性与相似性.html#cb582-19" tabindex="-1"></a>  tree_coords <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tree_coords, cluster_trees)</span>
<span id="cb582-20"><a href="相关性与相似性.html#cb582-20" tabindex="-1"></a>}</span>
<span id="cb582-21"><a href="相关性与相似性.html#cb582-21" tabindex="-1"></a></span>
<span id="cb582-22"><a href="相关性与相似性.html#cb582-22" tabindex="-1"></a><span class="co"># 确保总数为n_trees</span></span>
<span id="cb582-23"><a href="相关性与相似性.html#cb582-23" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(tree_coords) <span class="sc">&gt;</span> n_trees) {</span>
<span id="cb582-24"><a href="相关性与相似性.html#cb582-24" tabindex="-1"></a>  tree_coords <span class="ot">&lt;-</span> tree_coords[<span class="dv">1</span><span class="sc">:</span>n_trees, ]</span>
<span id="cb582-25"><a href="相关性与相似性.html#cb582-25" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb582-26"><a href="相关性与相似性.html#cb582-26" tabindex="-1"></a>  <span class="co"># 添加一些随机分布的树木</span></span>
<span id="cb582-27"><a href="相关性与相似性.html#cb582-27" tabindex="-1"></a>  n_extra <span class="ot">&lt;-</span> n_trees <span class="sc">-</span> <span class="fu">nrow</span>(tree_coords)</span>
<span id="cb582-28"><a href="相关性与相似性.html#cb582-28" tabindex="-1"></a>  extra_trees <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb582-29"><a href="相关性与相似性.html#cb582-29" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">runif</span>(n_extra, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb582-30"><a href="相关性与相似性.html#cb582-30" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">runif</span>(n_extra, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb582-31"><a href="相关性与相似性.html#cb582-31" tabindex="-1"></a>  )</span>
<span id="cb582-32"><a href="相关性与相似性.html#cb582-32" tabindex="-1"></a>  tree_coords <span class="ot">&lt;-</span> <span class="fu">rbind</span>(tree_coords, extra_trees)</span>
<span id="cb582-33"><a href="相关性与相似性.html#cb582-33" tabindex="-1"></a>}</span></code></pre></div>
<p>现在，我们模拟树木的胸径数据。在真实的生态系统中，相邻树木的胸径往往具有相似性，即存在空间自相关：</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="相关性与相似性.html#cb583-1" tabindex="-1"></a><span class="co"># 模拟树木胸径（具有空间自相关）</span></span>
<span id="cb583-2"><a href="相关性与相似性.html#cb583-2" tabindex="-1"></a><span class="co"># 使用空间平滑过程</span></span>
<span id="cb583-3"><a href="相关性与相似性.html#cb583-3" tabindex="-1"></a><span class="fu">coordinates</span>(tree_coords) <span class="ot">&lt;-</span> <span class="er">~</span> x <span class="sc">+</span> y</span>
<span id="cb583-4"><a href="相关性与相似性.html#cb583-4" tabindex="-1"></a></span>
<span id="cb583-5"><a href="相关性与相似性.html#cb583-5" tabindex="-1"></a><span class="co"># 创建空间权重矩阵（基于k近邻）</span></span>
<span id="cb583-6"><a href="相关性与相似性.html#cb583-6" tabindex="-1"></a>knn_weights <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(tree_coords, <span class="at">k =</span> <span class="dv">5</span>))</span>
<span id="cb583-7"><a href="相关性与相似性.html#cb583-7" tabindex="-1"></a>listw_weights <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(knn_weights, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb583-8"><a href="相关性与相似性.html#cb583-8" tabindex="-1"></a></span>
<span id="cb583-9"><a href="相关性与相似性.html#cb583-9" tabindex="-1"></a><span class="co"># 模拟具有空间自相关的胸径数据</span></span>
<span id="cb583-10"><a href="相关性与相似性.html#cb583-10" tabindex="-1"></a><span class="co"># 使用空间自回归过程</span></span>
<span id="cb583-11"><a href="相关性与相似性.html#cb583-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb583-12"><a href="相关性与相似性.html#cb583-12" tabindex="-1"></a>spatial_autocorr <span class="ot">&lt;-</span> <span class="fl">0.7</span> <span class="co"># 空间自相关强度</span></span>
<span id="cb583-13"><a href="相关性与相似性.html#cb583-13" tabindex="-1"></a></span>
<span id="cb583-14"><a href="相关性与相似性.html#cb583-14" tabindex="-1"></a><span class="co"># 生成空间自相关数据</span></span>
<span id="cb583-15"><a href="相关性与相似性.html#cb583-15" tabindex="-1"></a>n <span class="ot">&lt;-</span> n_trees</span>
<span id="cb583-16"><a href="相关性与相似性.html#cb583-16" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">listw2mat</span>(listw_weights)</span>
<span id="cb583-17"><a href="相关性与相似性.html#cb583-17" tabindex="-1"></a>I_minus_rhoW <span class="ot">&lt;-</span> <span class="fu">diag</span>(n) <span class="sc">-</span> spatial_autocorr <span class="sc">*</span> W</span>
<span id="cb583-18"><a href="相关性与相似性.html#cb583-18" tabindex="-1"></a></span>
<span id="cb583-19"><a href="相关性与相似性.html#cb583-19" tabindex="-1"></a><span class="co"># 确保矩阵可逆</span></span>
<span id="cb583-20"><a href="相关性与相似性.html#cb583-20" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">rcond</span>(I_minus_rhoW) <span class="sc">&gt;</span> <span class="fl">1e-10</span>) {</span>
<span id="cb583-21"><a href="相关性与相似性.html#cb583-21" tabindex="-1"></a>  tree_dbh <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">solve</span>(I_minus_rhoW) <span class="sc">%*%</span> <span class="fu">rnorm</span>(n, <span class="dv">25</span>, <span class="dv">5</span>))</span>
<span id="cb583-22"><a href="相关性与相似性.html#cb583-22" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb583-23"><a href="相关性与相似性.html#cb583-23" tabindex="-1"></a>  <span class="co"># 如果矩阵不可逆，使用近似方法</span></span>
<span id="cb583-24"><a href="相关性与相似性.html#cb583-24" tabindex="-1"></a>  tree_dbh <span class="ot">&lt;-</span> <span class="dv">25</span> <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb583-25"><a href="相关性与相似性.html#cb583-25" tabindex="-1"></a>}</span></code></pre></div>
<p>现在让我们先查看模拟数据的基本特征，并可视化树木的空间分布：</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="相关性与相似性.html#cb584-1" tabindex="-1"></a><span class="co"># 首先可视化空间分布特征</span></span>
<span id="cb584-2"><a href="相关性与相似性.html#cb584-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 空间分布特征分析 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 空间分布特征分析 ===</code></pre>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="相关性与相似性.html#cb586-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;树木总数：&quot;</span>, n_trees, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 树木总数： 100</code></pre>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="相关性与相似性.html#cb588-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;胸径统计：均值 =&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(tree_dbh), <span class="dv">2</span>),</span>
<span id="cb588-2"><a href="相关性与相似性.html#cb588-2" tabindex="-1"></a>    <span class="st">&quot;, 标准差 =&quot;</span>, <span class="fu">round</span>(<span class="fu">sd</span>(tree_dbh), <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 胸径统计：均值 = 85.16 , 标准差 = 5.79</code></pre>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="相关性与相似性.html#cb590-1" tabindex="-1"></a><span class="co"># 可视化空间分布和自相关</span></span>
<span id="cb590-2"><a href="相关性与相似性.html#cb590-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb590-3"><a href="相关性与相似性.html#cb590-3" tabindex="-1"></a></span>
<span id="cb590-4"><a href="相关性与相似性.html#cb590-4" tabindex="-1"></a><span class="co"># 树木坐标分布</span></span>
<span id="cb590-5"><a href="相关性与相似性.html#cb590-5" tabindex="-1"></a><span class="fu">plot</span>(tree_coords,</span>
<span id="cb590-6"><a href="相关性与相似性.html#cb590-6" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb590-7"><a href="相关性与相似性.html#cb590-7" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;树木空间分布&quot;</span>,</span>
<span id="cb590-8"><a href="相关性与相似性.html#cb590-8" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y坐标&quot;</span></span>
<span id="cb590-9"><a href="相关性与相似性.html#cb590-9" tabindex="-1"></a>)</span>
<span id="cb590-10"><a href="相关性与相似性.html#cb590-10" tabindex="-1"></a></span>
<span id="cb590-11"><a href="相关性与相似性.html#cb590-11" tabindex="-1"></a><span class="co"># 胸径的空间变异（颜色表示大小）</span></span>
<span id="cb590-12"><a href="相关性与相似性.html#cb590-12" tabindex="-1"></a>dbh_colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>))(<span class="dv">100</span>)</span>
<span id="cb590-13"><a href="相关性与相似性.html#cb590-13" tabindex="-1"></a>dbh_col_idx <span class="ot">&lt;-</span> <span class="fu">cut</span>(tree_dbh, <span class="at">breaks =</span> <span class="dv">100</span>)</span>
<span id="cb590-14"><a href="相关性与相似性.html#cb590-14" tabindex="-1"></a></span>
<span id="cb590-15"><a href="相关性与相似性.html#cb590-15" tabindex="-1"></a><span class="fu">plot</span>(tree_coords,</span>
<span id="cb590-16"><a href="相关性与相似性.html#cb590-16" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> dbh_colors[dbh_col_idx],</span>
<span id="cb590-17"><a href="相关性与相似性.html#cb590-17" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;树木胸径的空间分布&quot;</span>,</span>
<span id="cb590-18"><a href="相关性与相似性.html#cb590-18" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y坐标&quot;</span></span>
<span id="cb590-19"><a href="相关性与相似性.html#cb590-19" tabindex="-1"></a>)</span>
<span id="cb590-20"><a href="相关性与相似性.html#cb590-20" tabindex="-1"></a></span>
<span id="cb590-21"><a href="相关性与相似性.html#cb590-21" tabindex="-1"></a><span class="co"># 添加图例</span></span>
<span id="cb590-22"><a href="相关性与相似性.html#cb590-22" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb590-23"><a href="相关性与相似性.html#cb590-23" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;小胸径&quot;</span>, <span class="st">&quot;大胸径&quot;</span>),</span>
<span id="cb590-24"><a href="相关性与相似性.html#cb590-24" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb590-25"><a href="相关性与相似性.html#cb590-25" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:forest-spatial-distribution"></span>
<img src="05-correlation_files/figure-html/forest-spatial-distribution-1.png" alt="森林树木的空间分布和胸径变异" width="672" />
<p class="caption">
图5.25: 森林树木的空间分布和胸径变异
</p>
</div>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="相关性与相似性.html#cb591-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>从图<a href="相关性与相似性.html#fig:forest-spatial-distribution">5.25</a>中我们可以观察到：左图显示了树木在空间中的分布模式，可以看到明显的聚集现象；右图用颜色表示胸径大小，蓝色表示小胸径，红色表示大胸径，我们可以初步观察到胸径在空间上可能存在一定的聚集模式。</p>
<p>现在，我们使用空间自相关指数来量化这种空间模式：</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="相关性与相似性.html#cb592-1" tabindex="-1"></a><span class="co"># 进行空间自相关分析</span></span>
<span id="cb592-2"><a href="相关性与相似性.html#cb592-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 空间自相关分析 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 空间自相关分析 ===</code></pre>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="相关性与相似性.html#cb594-1" tabindex="-1"></a><span class="co"># 计算Moran&#39;s I</span></span>
<span id="cb594-2"><a href="相关性与相似性.html#cb594-2" tabindex="-1"></a>moran_test <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(tree_dbh, listw_weights)</span>
<span id="cb594-3"><a href="相关性与相似性.html#cb594-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Moran&#39;s I检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb594-4"><a href="相关性与相似性.html#cb594-4" tabindex="-1"></a>    <span class="st">&quot;Moran&#39;s I统计量：&quot;</span>, <span class="fu">round</span>(moran_test<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb594-5"><a href="相关性与相似性.html#cb594-5" tabindex="-1"></a>    <span class="st">&quot;期望值：&quot;</span>, <span class="fu">round</span>(moran_test<span class="sc">$</span>estimate[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb594-6"><a href="相关性与相似性.html#cb594-6" tabindex="-1"></a>    <span class="st">&quot;方差：&quot;</span>, <span class="fu">round</span>(moran_test<span class="sc">$</span>estimate[<span class="dv">3</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb594-7"><a href="相关性与相似性.html#cb594-7" tabindex="-1"></a>    <span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(moran_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb594-8"><a href="相关性与相似性.html#cb594-8" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## Moran&#39;s I检验结果：
## Moran&#39;s I统计量：0.425
## 期望值：-0.01
## 方差：0.003
## p值：4.48e-15</code></pre>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="相关性与相似性.html#cb596-1" tabindex="-1"></a><span class="co"># 计算Geary&#39;s C</span></span>
<span id="cb596-2"><a href="相关性与相似性.html#cb596-2" tabindex="-1"></a>geary_test <span class="ot">&lt;-</span> <span class="fu">geary.test</span>(tree_dbh, listw_weights)</span>
<span id="cb596-3"><a href="相关性与相似性.html#cb596-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Geary&#39;s C检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb596-4"><a href="相关性与相似性.html#cb596-4" tabindex="-1"></a>    <span class="st">&quot;Geary&#39;s C统计量：&quot;</span>, <span class="fu">round</span>(geary_test<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb596-5"><a href="相关性与相似性.html#cb596-5" tabindex="-1"></a>    <span class="st">&quot;期望值：&quot;</span>, <span class="fu">round</span>(geary_test<span class="sc">$</span>estimate[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb596-6"><a href="相关性与相似性.html#cb596-6" tabindex="-1"></a>    <span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(geary_test<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb596-7"><a href="相关性与相似性.html#cb596-7" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Geary&#39;s C检验结果：
## Geary&#39;s C统计量：0.568
## 期望值：1
## p值：7.06e-11</code></pre>
<p>为了验证空间自相关结果的统计显著性，我们进行蒙特卡洛模拟检验（结果见图<a href="相关性与相似性.html#fig:moran-monte-carlo">5.26</a>）：</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="相关性与相似性.html#cb598-1" tabindex="-1"></a><span class="co"># 进行蒙特卡洛模拟检验</span></span>
<span id="cb598-2"><a href="相关性与相似性.html#cb598-2" tabindex="-1"></a>moran_mc <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(tree_dbh, listw_weights, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb598-3"><a href="相关性与相似性.html#cb598-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Moran&#39;s I蒙特卡洛检验：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Moran&#39;s I蒙特卡洛检验：</code></pre>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="相关性与相似性.html#cb600-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值：&quot;</span>, <span class="fu">format.pval</span>(moran_mc<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## p值： 0.001</code></pre>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="相关性与相似性.html#cb602-1" tabindex="-1"></a><span class="co"># 可视化蒙特卡洛检验结果</span></span>
<span id="cb602-2"><a href="相关性与相似性.html#cb602-2" tabindex="-1"></a><span class="fu">hist</span>(moran_mc<span class="sc">$</span>res,</span>
<span id="cb602-3"><a href="相关性与相似性.html#cb602-3" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb602-4"><a href="相关性与相似性.html#cb602-4" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Moran&#39;s I的蒙特卡洛分布&quot;</span>,</span>
<span id="cb602-5"><a href="相关性与相似性.html#cb602-5" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Moran&#39;s I统计量&quot;</span></span>
<span id="cb602-6"><a href="相关性与相似性.html#cb602-6" tabindex="-1"></a>)</span>
<span id="cb602-7"><a href="相关性与相似性.html#cb602-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> moran_test<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb602-8"><a href="相关性与相似性.html#cb602-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="st">&quot;观测值&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:moran-monte-carlo"></span>
<img src="05-correlation_files/figure-html/moran-monte-carlo-1.png" alt="Moran's I的蒙特卡洛检验结果" width="672" />
<p class="caption">
图5.26: Moran’s I的蒙特卡洛检验结果
</p>
</div>
<p>通过这个完整的分析流程，我们能够深入理解森林生态系统的空间结构特征及其统计意义。首先，从空间分布特征来看，模拟的森林树木呈现出明显的聚集分布模式，这种分布特征在真实的森林生态系统中十分常见，反映了种子传播、微环境适宜性等生态过程的空间异质性。树木胸径数据也显示出显著的空间变异模式，相邻树木的胸径值往往相近，这种空间依赖性暗示着可能存在某种生态机制在驱动胸径的空间分布格局。</p>
<p>进一步的空间自相关分析为我们提供了量化这种空间模式的统计证据。Moran’s I统计量显著大于其期望值，这一结果表明树木胸径在空间上存在正的空间自相关，即相似大小的树木倾向于在空间上聚集分布。Geary’s C统计量小于1的发现进一步支持了这一结论，因为Geary’s C对局部空间差异更为敏感，其值小于1同样表明空间单元之间存在正的空间自相关。这两种空间自相关指数的相互印证，增强了我们对空间模式判断的可靠性。</p>
<p>为了验证这种空间自相关模式的统计显著性，我们进行了蒙特卡洛模拟检验（图<a href="相关性与相似性.html#fig:moran-monte-carlo">5.26</a>）。检验结果显示观测到的Moran’s I统计量在随机分布假设下的概率极低，这表明我们观测到的空间自相关模式不太可能是随机产生的，而是具有统计显著性的真实空间模式。这种显著性检验为我们的生态学解释提供了坚实的统计基础。</p>
<p>这个完整的分析流程从数据模拟、可视化到统计检验，展示了空间自相关分析在生态学研究中的系统应用方法。它不仅帮助我们识别和量化空间模式，更重要的是为理解这些模式背后的生态过程提供了统计依据。这种分析方法为生态学家研究物种分布、种群动态、环境因子变异等空间生态学问题提供了实用的技术框架。</p>
</div>
<div id="局部空间自相关空间异质性的识别" class="section level3 hasAnchor" number="5.5.4">
<h3><span class="header-section-number">5.5.4</span> 局部空间自相关：空间异质性的识别<a href="相关性与相似性.html#局部空间自相关空间异质性的识别" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在研究城市绿地中鸟类物种丰富度的分布时，我们不仅关心整体的空间模式，还希望识别出具体的局部热点（高值聚集区）和冷点（低值聚集区），这需要使用局部空间自相关分析方法。</p>
<p>局部空间自相关分析是全局空间自相关分析的延伸，它专注于识别空间数据中的局部异质性模式。最常用的局部空间自相关方法包括LISA（Local Indicators of Spatial Association）和Getis-Ord Gi*统计量。LISA由Luc Anselin于1995年提出，它度量每个空间单元与其邻居之间的局部空间关联程度，能够识别四种类型的局部空间关联：高-高聚集（热点）、低-低聚集（冷点）、高-低异常值（高值被低值包围）和低-高异常值（低值被高值包围）。</p>
<p>Getis-Ord Gi<em>统计量是另一种重要的局部空间自相关方法，专门用于识别热点和冷点。与LISA不同，Gi</em>统计量专注于检测高值或低值的空间聚集，而不区分其他类型的空间异常。Gi*统计量的正值表示热点（高值聚集），负值表示冷点（低值聚集），统计量的绝对值越大表示聚集程度越强。</p>
<p><strong>数学定义</strong>：</p>
<ul>
<li><strong>局部Moran’s I</strong>（LISA）：</li>
</ul>
<p><span class="math display">\[I_i = \frac{(x_i - \bar{x})}{\sum_{j=1}^{n}(x_j - \bar{x})^2/n} \sum_{j=1}^{n}w_{ij}(x_j - \bar{x})\]</span></p>
<ul>
<li><strong>Getis-Ord Gi</strong>*：</li>
</ul>
<p><span class="math display">\[G_i^* = \frac{\sum_{j=1}^{n}w_{ij}x_j}{\sum_{j=1}^{n}x_j}\]</span></p>
<p>现在，我们通过一个城市绿地鸟类物种丰富度的案例来演示局部空间自相关分析的具体应用：</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="相关性与相似性.html#cb603-1" tabindex="-1"></a><span class="co"># 局部空间自相关示例：城市绿地鸟类物种丰富度</span></span>
<span id="cb603-2"><a href="相关性与相似性.html#cb603-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb603-3"><a href="相关性与相似性.html#cb603-3" tabindex="-1"></a></span>
<span id="cb603-4"><a href="相关性与相似性.html#cb603-4" tabindex="-1"></a><span class="co"># 模拟城市绿地数据</span></span>
<span id="cb603-5"><a href="相关性与相似性.html#cb603-5" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb603-6"><a href="相关性与相似性.html#cb603-6" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb603-7"><a href="相关性与相似性.html#cb603-7" tabindex="-1"></a></span>
<span id="cb603-8"><a href="相关性与相似性.html#cb603-8" tabindex="-1"></a>n_parks <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb603-9"><a href="相关性与相似性.html#cb603-9" tabindex="-1"></a></span>
<span id="cb603-10"><a href="相关性与相似性.html#cb603-10" tabindex="-1"></a><span class="co"># 生成公园坐标（模拟城市分布）</span></span>
<span id="cb603-11"><a href="相关性与相似性.html#cb603-11" tabindex="-1"></a>park_coords <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb603-12"><a href="相关性与相似性.html#cb603-12" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">runif</span>(n_parks, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb603-13"><a href="相关性与相似性.html#cb603-13" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">runif</span>(n_parks, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb603-14"><a href="相关性与相似性.html#cb603-14" tabindex="-1"></a>)</span></code></pre></div>
<p>现在让我们模拟具有空间聚集模式的鸟类物种丰富度数据：</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="相关性与相似性.html#cb604-1" tabindex="-1"></a><span class="co"># 模拟鸟类物种丰富度（具有空间聚集模式）</span></span>
<span id="cb604-2"><a href="相关性与相似性.html#cb604-2" tabindex="-1"></a><span class="co"># 创建几个热点区域</span></span>
<span id="cb604-3"><a href="相关性与相似性.html#cb604-3" tabindex="-1"></a>hotspot_centers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb604-4"><a href="相关性与相似性.html#cb604-4" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">30</span>),</span>
<span id="cb604-5"><a href="相关性与相似性.html#cb604-5" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">80</span>, <span class="dv">60</span>, <span class="dv">30</span>, <span class="dv">70</span>)</span>
<span id="cb604-6"><a href="相关性与相似性.html#cb604-6" tabindex="-1"></a>)</span>
<span id="cb604-7"><a href="相关性与相似性.html#cb604-7" tabindex="-1"></a></span>
<span id="cb604-8"><a href="相关性与相似性.html#cb604-8" tabindex="-1"></a>bird_richness <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_parks)</span>
<span id="cb604-9"><a href="相关性与相似性.html#cb604-9" tabindex="-1"></a></span>
<span id="cb604-10"><a href="相关性与相似性.html#cb604-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_parks) {</span>
<span id="cb604-11"><a href="相关性与相似性.html#cb604-11" tabindex="-1"></a>  <span class="co"># 计算到各个热点的距离</span></span>
<span id="cb604-12"><a href="相关性与相似性.html#cb604-12" tabindex="-1"></a>  distances <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((park_coords<span class="sc">$</span>x[i] <span class="sc">-</span> hotspot_centers<span class="sc">$</span>x)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb604-13"><a href="相关性与相似性.html#cb604-13" tabindex="-1"></a>    (park_coords<span class="sc">$</span>y[i] <span class="sc">-</span> hotspot_centers<span class="sc">$</span>y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb604-14"><a href="相关性与相似性.html#cb604-14" tabindex="-1"></a></span>
<span id="cb604-15"><a href="相关性与相似性.html#cb604-15" tabindex="-1"></a>  <span class="co"># 物种丰富度与到热点的距离负相关</span></span>
<span id="cb604-16"><a href="相关性与相似性.html#cb604-16" tabindex="-1"></a>  richness_base <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="sc">-</span> <span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">min</span>(distances)</span>
<span id="cb604-17"><a href="相关性与相似性.html#cb604-17" tabindex="-1"></a></span>
<span id="cb604-18"><a href="相关性与相似性.html#cb604-18" tabindex="-1"></a>  <span class="co"># 添加随机变异</span></span>
<span id="cb604-19"><a href="相关性与相似性.html#cb604-19" tabindex="-1"></a>  bird_richness[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">5</span>, richness_base <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>))</span>
<span id="cb604-20"><a href="相关性与相似性.html#cb604-20" tabindex="-1"></a>}</span>
<span id="cb604-21"><a href="相关性与相似性.html#cb604-21" tabindex="-1"></a></span>
<span id="cb604-22"><a href="相关性与相似性.html#cb604-22" tabindex="-1"></a><span class="co"># 创建空间数据</span></span>
<span id="cb604-23"><a href="相关性与相似性.html#cb604-23" tabindex="-1"></a><span class="fu">coordinates</span>(park_coords) <span class="ot">&lt;-</span> <span class="er">~</span> x <span class="sc">+</span> y</span>
<span id="cb604-24"><a href="相关性与相似性.html#cb604-24" tabindex="-1"></a></span>
<span id="cb604-25"><a href="相关性与相似性.html#cb604-25" tabindex="-1"></a><span class="co"># 创建空间权重矩阵（基于距离的权重）</span></span>
<span id="cb604-26"><a href="相关性与相似性.html#cb604-26" tabindex="-1"></a><span class="co"># 使用距离阈值定义邻居</span></span>
<span id="cb604-27"><a href="相关性与相似性.html#cb604-27" tabindex="-1"></a>dist_threshold <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># 20单位内的公园视为邻居</span></span>
<span id="cb604-28"><a href="相关性与相似性.html#cb604-28" tabindex="-1"></a></span>
<span id="cb604-29"><a href="相关性与相似性.html#cb604-29" tabindex="-1"></a><span class="co"># 创建基于距离的邻居列表</span></span>
<span id="cb604-30"><a href="相关性与相似性.html#cb604-30" tabindex="-1"></a>nb_dist <span class="ot">&lt;-</span> <span class="fu">dnearneigh</span>(park_coords, <span class="dv">0</span>, dist_threshold)</span>
<span id="cb604-31"><a href="相关性与相似性.html#cb604-31" tabindex="-1"></a><span class="co"># 检查是否有孤立点，如果有则使用k近邻</span></span>
<span id="cb604-32"><a href="相关性与相似性.html#cb604-32" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">card</span>(nb_dist) <span class="sc">==</span> <span class="dv">0</span>)) {</span>
<span id="cb604-33"><a href="相关性与相似性.html#cb604-33" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;检测到孤立点，使用k近邻方法</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb604-34"><a href="相关性与相似性.html#cb604-34" tabindex="-1"></a>  nb_dist <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(park_coords, <span class="at">k =</span> <span class="dv">3</span>))</span>
<span id="cb604-35"><a href="相关性与相似性.html#cb604-35" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 检测到孤立点，使用k近邻方法</code></pre>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="相关性与相似性.html#cb606-1" tabindex="-1"></a>listw_dist <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb_dist, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span></code></pre></div>
<p>首先查看模拟数据的基本特征：</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="相关性与相似性.html#cb607-1" tabindex="-1"></a><span class="co"># 首先查看数据基本特征</span></span>
<span id="cb607-2"><a href="相关性与相似性.html#cb607-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 城市绿地鸟类物种丰富度分析 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 城市绿地鸟类物种丰富度分析 ===</code></pre>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="相关性与相似性.html#cb609-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;公园总数：&quot;</span>, n_parks, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 公园总数： 50</code></pre>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="相关性与相似性.html#cb611-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;物种丰富度统计：均值 =&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(bird_richness), <span class="dv">2</span>),</span>
<span id="cb611-2"><a href="相关性与相似性.html#cb611-2" tabindex="-1"></a>    <span class="st">&quot;, 标准差 =&quot;</span>, <span class="fu">round</span>(<span class="fu">sd</span>(bird_richness), <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 物种丰富度统计：均值 = 13.62 , 标准差 = 2.93</code></pre>
<p>现在，我们进行局部空间自相关分析来识别局部热点和冷点：</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="相关性与相似性.html#cb613-1" tabindex="-1"></a><span class="co"># 计算局部Moran&#39;s I（LISA）</span></span>
<span id="cb613-2"><a href="相关性与相似性.html#cb613-2" tabindex="-1"></a>local_moran <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(bird_richness, listw_dist)</span>
<span id="cb613-3"><a href="相关性与相似性.html#cb613-3" tabindex="-1"></a></span>
<span id="cb613-4"><a href="相关性与相似性.html#cb613-4" tabindex="-1"></a><span class="co"># 创建LISA分类</span></span>
<span id="cb613-5"><a href="相关性与相似性.html#cb613-5" tabindex="-1"></a>lisa_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb613-6"><a href="相关性与相似性.html#cb613-6" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">coordinates</span>(park_coords)[, <span class="dv">1</span>],</span>
<span id="cb613-7"><a href="相关性与相似性.html#cb613-7" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">coordinates</span>(park_coords)[, <span class="dv">2</span>],</span>
<span id="cb613-8"><a href="相关性与相似性.html#cb613-8" tabindex="-1"></a>  <span class="at">richness =</span> bird_richness,</span>
<span id="cb613-9"><a href="相关性与相似性.html#cb613-9" tabindex="-1"></a>  <span class="at">local_i =</span> local_moran[, <span class="dv">1</span>],</span>
<span id="cb613-10"><a href="相关性与相似性.html#cb613-10" tabindex="-1"></a>  <span class="at">p_value =</span> local_moran[, <span class="dv">5</span>]</span>
<span id="cb613-11"><a href="相关性与相似性.html#cb613-11" tabindex="-1"></a>)</span>
<span id="cb613-12"><a href="相关性与相似性.html#cb613-12" tabindex="-1"></a></span>
<span id="cb613-13"><a href="相关性与相似性.html#cb613-13" tabindex="-1"></a><span class="co"># 根据LISA值分类</span></span>
<span id="cb613-14"><a href="相关性与相似性.html#cb613-14" tabindex="-1"></a>lisa_results<span class="sc">$</span>lisa_type <span class="ot">&lt;-</span> <span class="st">&quot;不显著&quot;</span></span>
<span id="cb613-15"><a href="相关性与相似性.html#cb613-15" tabindex="-1"></a>lisa_results<span class="sc">$</span>lisa_type[lisa_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span></span>
<span id="cb613-16"><a href="相关性与相似性.html#cb613-16" tabindex="-1"></a>  lisa_results<span class="sc">$</span>local_i <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb613-17"><a href="相关性与相似性.html#cb613-17" tabindex="-1"></a>  lisa_results<span class="sc">$</span>richness <span class="sc">&gt;</span> <span class="fu">mean</span>(bird_richness)] <span class="ot">&lt;-</span> <span class="st">&quot;高-高&quot;</span></span>
<span id="cb613-18"><a href="相关性与相似性.html#cb613-18" tabindex="-1"></a>lisa_results<span class="sc">$</span>lisa_type[lisa_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span></span>
<span id="cb613-19"><a href="相关性与相似性.html#cb613-19" tabindex="-1"></a>  lisa_results<span class="sc">$</span>local_i <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb613-20"><a href="相关性与相似性.html#cb613-20" tabindex="-1"></a>  lisa_results<span class="sc">$</span>richness <span class="sc">&lt;</span> <span class="fu">mean</span>(bird_richness)] <span class="ot">&lt;-</span> <span class="st">&quot;低-低&quot;</span></span>
<span id="cb613-21"><a href="相关性与相似性.html#cb613-21" tabindex="-1"></a>lisa_results<span class="sc">$</span>lisa_type[lisa_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span></span>
<span id="cb613-22"><a href="相关性与相似性.html#cb613-22" tabindex="-1"></a>  lisa_results<span class="sc">$</span>local_i <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb613-23"><a href="相关性与相似性.html#cb613-23" tabindex="-1"></a>  lisa_results<span class="sc">$</span>richness <span class="sc">&gt;</span> <span class="fu">mean</span>(bird_richness)] <span class="ot">&lt;-</span> <span class="st">&quot;高-低&quot;</span></span>
<span id="cb613-24"><a href="相关性与相似性.html#cb613-24" tabindex="-1"></a>lisa_results<span class="sc">$</span>lisa_type[lisa_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">&amp;</span></span>
<span id="cb613-25"><a href="相关性与相似性.html#cb613-25" tabindex="-1"></a>  lisa_results<span class="sc">$</span>local_i <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb613-26"><a href="相关性与相似性.html#cb613-26" tabindex="-1"></a>  lisa_results<span class="sc">$</span>richness <span class="sc">&lt;</span> <span class="fu">mean</span>(bird_richness)] <span class="ot">&lt;-</span> <span class="st">&quot;低-高&quot;</span></span>
<span id="cb613-27"><a href="相关性与相似性.html#cb613-27" tabindex="-1"></a></span>
<span id="cb613-28"><a href="相关性与相似性.html#cb613-28" tabindex="-1"></a><span class="co"># 计算Getis-Ord Gi*</span></span>
<span id="cb613-29"><a href="相关性与相似性.html#cb613-29" tabindex="-1"></a>local_g <span class="ot">&lt;-</span> <span class="fu">localG</span>(bird_richness, listw_dist)</span>
<span id="cb613-30"><a href="相关性与相似性.html#cb613-30" tabindex="-1"></a></span>
<span id="cb613-31"><a href="相关性与相似性.html#cb613-31" tabindex="-1"></a><span class="co"># 添加Gi*结果</span></span>
<span id="cb613-32"><a href="相关性与相似性.html#cb613-32" tabindex="-1"></a>lisa_results<span class="sc">$</span>gi_star <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(local_g)</span>
<span id="cb613-33"><a href="相关性与相似性.html#cb613-33" tabindex="-1"></a>lisa_results<span class="sc">$</span>gi_type <span class="ot">&lt;-</span> <span class="st">&quot;不显著&quot;</span></span>
<span id="cb613-34"><a href="相关性与相似性.html#cb613-34" tabindex="-1"></a>lisa_results<span class="sc">$</span>gi_type[lisa_results<span class="sc">$</span>gi_star <span class="sc">&gt;</span> <span class="fl">1.96</span>] <span class="ot">&lt;-</span> <span class="st">&quot;热点&quot;</span></span>
<span id="cb613-35"><a href="相关性与相似性.html#cb613-35" tabindex="-1"></a>lisa_results<span class="sc">$</span>gi_type[lisa_results<span class="sc">$</span>gi_star <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">1.96</span>] <span class="ot">&lt;-</span> <span class="st">&quot;冷点&quot;</span></span></code></pre></div>
<p>现在让我们可视化局部空间自相关分析的结果：</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="相关性与相似性.html#cb614-1" tabindex="-1"></a><span class="co"># 可视化LISA分析结果</span></span>
<span id="cb614-2"><a href="相关性与相似性.html#cb614-2" tabindex="-1"></a><span class="co"># LISA类型分布</span></span>
<span id="cb614-3"><a href="相关性与相似性.html#cb614-3" tabindex="-1"></a><span class="fu">ggplot</span>(lisa_results, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> lisa_type, <span class="at">size =</span> richness)) <span class="sc">+</span></span>
<span id="cb614-4"><a href="相关性与相似性.html#cb614-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb614-5"><a href="相关性与相似性.html#cb614-5" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb614-6"><a href="相关性与相似性.html#cb614-6" tabindex="-1"></a>    <span class="st">&quot;高-高&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;低-低&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb614-7"><a href="相关性与相似性.html#cb614-7" tabindex="-1"></a>    <span class="st">&quot;高-低&quot;</span> <span class="ot">=</span> <span class="st">&quot;pink&quot;</span>, <span class="st">&quot;低-高&quot;</span> <span class="ot">=</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb614-8"><a href="相关性与相似性.html#cb614-8" tabindex="-1"></a>    <span class="st">&quot;不显著&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span></span>
<span id="cb614-9"><a href="相关性与相似性.html#cb614-9" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb614-10"><a href="相关性与相似性.html#cb614-10" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb614-11"><a href="相关性与相似性.html#cb614-11" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;鸟类物种丰富度的LISA分析&quot;</span>,</span>
<span id="cb614-12"><a href="相关性与相似性.html#cb614-12" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y坐标&quot;</span>,</span>
<span id="cb614-13"><a href="相关性与相似性.html#cb614-13" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;LISA类型&quot;</span>, <span class="at">size =</span> <span class="st">&quot;物种数&quot;</span></span>
<span id="cb614-14"><a href="相关性与相似性.html#cb614-14" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb614-15"><a href="相关性与相似性.html#cb614-15" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:lisa-analysis"></span>
<img src="05-correlation_files/figure-html/lisa-analysis-1.png" alt="鸟类物种丰富度的LISA分析结果" width="672" />
<p class="caption">
图5.27: 鸟类物种丰富度的LISA分析结果
</p>
</div>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="相关性与相似性.html#cb615-1" tabindex="-1"></a><span class="co"># Gi*热点分析</span></span>
<span id="cb615-2"><a href="相关性与相似性.html#cb615-2" tabindex="-1"></a><span class="fu">ggplot</span>(lisa_results, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> gi_type, <span class="at">size =</span> <span class="fu">abs</span>(gi_star))) <span class="sc">+</span></span>
<span id="cb615-3"><a href="相关性与相似性.html#cb615-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb615-4"><a href="相关性与相似性.html#cb615-4" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb615-5"><a href="相关性与相似性.html#cb615-5" tabindex="-1"></a>    <span class="st">&quot;热点&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;冷点&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb615-6"><a href="相关性与相似性.html#cb615-6" tabindex="-1"></a>    <span class="st">&quot;不显著&quot;</span> <span class="ot">=</span> <span class="st">&quot;gray&quot;</span></span>
<span id="cb615-7"><a href="相关性与相似性.html#cb615-7" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb615-8"><a href="相关性与相似性.html#cb615-8" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb615-9"><a href="相关性与相似性.html#cb615-9" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;鸟类物种丰富度的Getis-Ord Gi*分析&quot;</span>,</span>
<span id="cb615-10"><a href="相关性与相似性.html#cb615-10" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y坐标&quot;</span>,</span>
<span id="cb615-11"><a href="相关性与相似性.html#cb615-11" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;热点类型&quot;</span>, <span class="at">size =</span> <span class="st">&quot;|Gi*|&quot;</span></span>
<span id="cb615-12"><a href="相关性与相似性.html#cb615-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb615-13"><a href="相关性与相似性.html#cb615-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:gi-analysis"></span>
<img src="05-correlation_files/figure-html/gi-analysis-1.png" alt="鸟类物种丰富度的Getis-Ord Gi*分析结果" width="672" />
<p class="caption">
图5.28: 鸟类物种丰富度的Getis-Ord Gi*分析结果
</p>
</div>
<p>现在让我们查看局部空间自相关分析的统计结果：</p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="相关性与相似性.html#cb616-1" tabindex="-1"></a><span class="co"># 统计结果摘要</span></span>
<span id="cb616-2"><a href="相关性与相似性.html#cb616-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;LISA分析结果摘要：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb616-3"><a href="相关性与相似性.html#cb616-3" tabindex="-1"></a>    <span class="st">&quot;总公园数：&quot;</span>, n_parks, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb616-4"><a href="相关性与相似性.html#cb616-4" tabindex="-1"></a>    <span class="st">&quot;显著LISA模式的数量：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb616-5"><a href="相关性与相似性.html#cb616-5" tabindex="-1"></a>    <span class="st">&quot;高-高聚集（热点）：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>lisa_type <span class="sc">==</span> <span class="st">&quot;高-高&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb616-6"><a href="相关性与相似性.html#cb616-6" tabindex="-1"></a>    <span class="st">&quot;低-低聚集（冷点）：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>lisa_type <span class="sc">==</span> <span class="st">&quot;低-低&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb616-7"><a href="相关性与相似性.html#cb616-7" tabindex="-1"></a>    <span class="st">&quot;高-低异常值：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>lisa_type <span class="sc">==</span> <span class="st">&quot;高-低&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb616-8"><a href="相关性与相似性.html#cb616-8" tabindex="-1"></a>    <span class="st">&quot;低-高异常值：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>lisa_type <span class="sc">==</span> <span class="st">&quot;低-高&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb616-9"><a href="相关性与相似性.html#cb616-9" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## LISA分析结果摘要：
## 总公园数：50
## 显著LISA模式的数量：1
## 高-高聚集（热点）：1
## 低-低聚集（冷点）：0
## 高-低异常值：0
## 低-高异常值：0</code></pre>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="相关性与相似性.html#cb618-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Getis-Ord Gi*分析结果摘要：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb618-2"><a href="相关性与相似性.html#cb618-2" tabindex="-1"></a>    <span class="st">&quot;热点数量：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>gi_type <span class="sc">==</span> <span class="st">&quot;热点&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb618-3"><a href="相关性与相似性.html#cb618-3" tabindex="-1"></a>    <span class="st">&quot;冷点数量：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>gi_type <span class="sc">==</span> <span class="st">&quot;冷点&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb618-4"><a href="相关性与相似性.html#cb618-4" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Getis-Ord Gi*分析结果摘要：
## 热点数量：1
## 冷点数量：0</code></pre>
<p>进行局部空间自相关分析时，需要注意多重比较问题。由于同时检验多个局部统计量，传统的显著性水平可能需要调整，如使用错误发现率（FDR）控制：</p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="相关性与相似性.html#cb620-1" tabindex="-1"></a><span class="co"># 多重比较校正</span></span>
<span id="cb620-2"><a href="相关性与相似性.html#cb620-2" tabindex="-1"></a><span class="co"># 使用FDR校正p值</span></span>
<span id="cb620-3"><a href="相关性与相似性.html#cb620-3" tabindex="-1"></a>lisa_results<span class="sc">$</span>p_fdr <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(lisa_results<span class="sc">$</span>p_value, <span class="at">method =</span> <span class="st">&quot;fdr&quot;</span>)</span>
<span id="cb620-4"><a href="相关性与相似性.html#cb620-4" tabindex="-1"></a></span>
<span id="cb620-5"><a href="相关性与相似性.html#cb620-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;经过FDR校正后的显著LISA模式：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb620-6"><a href="相关性与相似性.html#cb620-6" tabindex="-1"></a>    <span class="st">&quot;数量：&quot;</span>, <span class="fu">sum</span>(lisa_results<span class="sc">$</span>p_fdr <span class="sc">&lt;</span> <span class="fl">0.05</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb620-7"><a href="相关性与相似性.html#cb620-7" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 经过FDR校正后的显著LISA模式：
## 数量：0</code></pre>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb622-1"><a href="相关性与相似性.html#cb622-1" tabindex="-1"></a><span class="co"># 可视化校正前后的对比</span></span>
<span id="cb622-2"><a href="相关性与相似性.html#cb622-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb622-3"><a href="相关性与相似性.html#cb622-3" tabindex="-1"></a></span>
<span id="cb622-4"><a href="相关性与相似性.html#cb622-4" tabindex="-1"></a><span class="co"># 原始p值</span></span>
<span id="cb622-5"><a href="相关性与相似性.html#cb622-5" tabindex="-1"></a><span class="fu">hist</span>(lisa_results<span class="sc">$</span>p_value,</span>
<span id="cb622-6"><a href="相关性与相似性.html#cb622-6" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb622-7"><a href="相关性与相似性.html#cb622-7" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;原始p值分布&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;p值&quot;</span></span>
<span id="cb622-8"><a href="相关性与相似性.html#cb622-8" tabindex="-1"></a>)</span>
<span id="cb622-9"><a href="相关性与相似性.html#cb622-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.05</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb622-10"><a href="相关性与相似性.html#cb622-10" tabindex="-1"></a></span>
<span id="cb622-11"><a href="相关性与相似性.html#cb622-11" tabindex="-1"></a><span class="co"># FDR校正后p值</span></span>
<span id="cb622-12"><a href="相关性与相似性.html#cb622-12" tabindex="-1"></a><span class="fu">hist</span>(lisa_results<span class="sc">$</span>p_fdr,</span>
<span id="cb622-13"><a href="相关性与相似性.html#cb622-13" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;lightgreen&quot;</span>,</span>
<span id="cb622-14"><a href="相关性与相似性.html#cb622-14" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;FDR校正后p值分布&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;校正后p值&quot;</span></span>
<span id="cb622-15"><a href="相关性与相似性.html#cb622-15" tabindex="-1"></a>)</span>
<span id="cb622-16"><a href="相关性与相似性.html#cb622-16" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fl">0.05</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:multiple-comparison"></span>
<img src="05-correlation_files/figure-html/multiple-comparison-1.png" alt="多重比较校正前后的p值分布对比" width="672" />
<p class="caption">
图5.29: 多重比较校正前后的p值分布对比
</p>
</div>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="相关性与相似性.html#cb623-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>通过这个完整的局部空间自相关分析流程，我们能够深入理解城市绿地鸟类物种丰富度的空间异质性特征及其生态学意义。首先，从模拟的城市绿地分布来看，我们创建了多个鸟类物种丰富度热点区域，这些热点模拟了现实中由于栖息地质量、食物资源、植被结构等因素形成的生物多样性聚集区。</p>
<p>LISA分析为我们提供了对局部空间模式的详细分类。高-高聚集区（热点）代表了物种丰富度高的绿地聚集在一起，这些区域可能是城市中生态条件最优越、保护价值最高的区域；低-低聚集区（冷点）则代表了物种丰富度低的绿地聚集，可能反映了城市环境压力较大或生态条件较差的区域。高-低异常值和低-高异常值则揭示了空间异质性的复杂模式，高值被低值包围可能表示孤立的优质栖息地，而低值被高值包围可能表示受到局部干扰的区域。</p>
<p>Getis-Ord Gi<em>分析进一步验证了热点和冷点的存在，其专注于识别高值或低值的空间聚集，而不考虑其他类型的空间异常。Gi</em>分析的结果与LISA分析相互印证，增强了我们对空间模式判断的可靠性。两种方法的结合使用提供了对局部空间异质性的全面理解。</p>
<p>多重比较校正的重要性在这个分析中得到了体现。由于同时检验多个局部统计量，传统的显著性水平可能导致假阳性结果的增加。FDR校正帮助我们控制错误发现率，确保我们识别的显著模式具有更高的可靠性。校正前后显著模式数量的变化提醒我们在解释局部空间自相关结果时需要谨慎。</p>
<p>这个完整的分析流程从数据模拟、空间权重构建、局部统计量计算到多重比较校正，展示了局部空间自相关分析在城市生态学研究中的系统应用方法。它不仅帮助我们识别和量化局部空间模式，更重要的是为理解这些模式背后的生态过程提供了统计依据，为城市生态规划、生物多样性保护和栖息地管理提供了实用的技术框架。</p>
</div>
<div id="空间平稳性空间分析的基础假设" class="section level3 hasAnchor" number="5.5.5">
<h3><span class="header-section-number">5.5.5</span> 空间平稳性：空间分析的基础假设<a href="相关性与相似性.html#空间平稳性空间分析的基础假设" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在研究森林生物量的空间分布时，我们需要首先检验空间数据的平稳性，因为非平稳空间过程可能导致有偏的空间预测和错误的统计推断。</p>
<p>空间平稳性是空间统计学的基本假设，指的是空间过程的统计特性（如均值、方差和协方差结构）在空间上保持恒定。与时间序列平稳性类似，空间平稳性也分为严格平稳和弱平稳（二阶平稳）。严格平稳要求空间过程的任意有限维联合分布不随空间平移而改变，而弱平稳只要求均值恒定、方差有限且协方差只依赖于空间位置差而不依赖于具体位置。在生态学实践中，我们通常关注弱平稳性，因为它更容易检验且对于大多数空间分析方法已经足够。</p>
<p><strong>数学定义</strong>：弱平稳空间过程满足：</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(E[Z(\mathbf{s})] = \mu\)</span>（常数均值）</li>
<li><span class="math inline">\(Var[Z(\mathbf{s})] = \sigma^2 &lt; \infty\)</span>（有限常数方差）</li>
<li><span class="math inline">\(Cov[Z(\mathbf{s}), Z(\mathbf{s}+\mathbf{h})] = C(\mathbf{h})\)</span>（协方差只依赖于空间滞后<span class="math inline">\(\mathbf{h}\)</span>，不依赖于具体位置<span class="math inline">\(\mathbf{s}\)</span>）</li>
</ol>
<p>为了直观理解空间平稳性的概念，让我们对比一下平稳和非平稳空间过程的典型特征。</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:spatial-stationarity-comparison"></span>
<img src="05-correlation_files/figure-html/spatial-stationarity-comparison-1.png" alt="空间平稳性对比示意图：左图显示平稳空间过程（恒定统计特性），右图显示非平稳空间过程（具有趋势和空间异质性）" width="672" />
<p class="caption">
图5.30: 空间平稳性对比示意图：左图显示平稳空间过程（恒定统计特性），右图显示非平稳空间过程（具有趋势和空间异质性）
</p>
</div>
<p>上面的对比图（见<a href="相关性与相似性.html#fig:spatial-stationarity-comparison">5.30</a>）清晰地展示了平稳空间过程和非平稳空间过程在统计特性上的根本差异，这对于理解空间分析的基本假设至关重要。</p>
<p>在平稳空间过程的左侧部分，我们可以看到随机空间变异显示典型的平稳特征。空间分布图显示观测值在整个研究区域内随机分布，既没有明显的空间趋势，也没有系统性的空间模式，观测值之间表现出恒定的均值和方差。这种恒定的统计特性正是空间平稳性的核心特征。变异函数图进一步证实了平稳性，半方差随着距离增加而稳定收敛到基台值，表明空间依赖性在特定距离范围内存在且稳定。</p>
<p>相比之下，非平稳空间过程的右侧部分展现了完全不同的特征。具有趋势和异质性的空间过程显示明显的非平稳性，空间分布图中可见从西北到东南的明显梯度变化，反映了空间变量的系统性趋势。同时观测值的变异程度也随空间位置变化，显示了空间异质性特征。变异函数图呈现出持续上升的模式，半方差随着距离增加而不断增大，无法稳定收敛到基台值，显示强烈的非平稳性特征。这种持续上升的变异函数主要源于空间过程中的趋势成分，而非真正的空间依赖性。</p>
<p>在生态学研究中，正确识别空间过程的平稳性具有重要的实践意义。对于平稳空间过程，由于其统计特性在空间上稳定，适合直接应用经典的空间统计方法，如普通克里金插值、空间自相关分析等，统计推断相对可靠。而对于非平稳空间过程，如具有环境梯度的生态变量分布，则需要先进行平稳化处理，如趋势去除、空间变换等方法，否则可能导致严重的统计问题。空间趋势可能导致虚假的空间相关性，模型可能错误地拟合趋势而非真实的生态关系，置信区间和空间预测也可能严重偏离真实情况。通过图示法和变异函数分析识别空间平稳性是最直观的检验方法，为后续的空间统计分析和生态解释提供基础保障。</p>
<p>空间平稳性检验在生态学空间分析中具有至关重要的意义。许多经典的空间统计方法，如克里金插值、空间自回归模型和地统计分析，都建立在平稳性假设的基础上。如果空间过程是非平稳的，直接应用这些方法可能导致严重的统计问题，如有偏估计和无效的假设检验。生态学中的许多空间数据都表现出非平稳特征，如环境梯度（海拔、纬度梯度）、人为影响的空间模式（城市化梯度、污染扩散）和生态系统演替的空间趋势等。</p>
<p>检验空间平稳性的常用方法包括图示法、变异函数分析、趋势面检验和方向性变异函数分析等。图示法通过观察空间分布图来识别明显的趋势或空间模式；变异函数分析通过检查变异函数的收敛模式来判断平稳性——平稳空间过程的变异函数应该收敛到基台值，而非平稳空间过程的变异函数通常持续上升；趋势面检验通过拟合空间趋势模型来检验趋势的显著性；方向性变异函数分析则通过比较不同方向上的变异函数来检测各向异性。</p>
<p><strong>趋势面检验</strong>是检验空间平稳性的重要方法，它通过拟合多项式趋势面来量化空间趋势的显著性。趋势面模型的一般形式为：</p>
<p><span class="math display">\[Z(\mathbf{s}) = \beta_0 + \beta_1x + \beta_2y + \beta_3x^2 + \beta_4xy + \beta_5y^2 + \cdots + \epsilon(\mathbf{s})\]</span></p>
<p>其中<span class="math inline">\(\mathbf{s} = (x,y)\)</span>表示空间坐标，<span class="math inline">\(\beta_i\)</span>是趋势系数，<span class="math inline">\(\epsilon(\mathbf{s})\)</span>是平稳的残差过程。</p>
<p>趋势面检验的原假设<span class="math inline">\(H_0\)</span>是：所有趋势系数<span class="math inline">\(\beta_i = 0\)</span>（即没有空间趋势，过程是平稳的）；备择假设<span class="math inline">\(H_1\)</span>是：至少有一个趋势系数<span class="math inline">\(\beta_i \neq 0\)</span>（即存在空间趋势，过程是非平稳的）。检验统计量通常使用F统计量：</p>
<p><span class="math display">\[F = \frac{(SSE_r - SSE_f)/(df_r - df_f)}{SSE_f/df_f}\]</span></p>
<p>其中<span class="math inline">\(SSE_r\)</span>是简化模型（无趋势）的残差平方和，<span class="math inline">\(SSE_f\)</span>是完整模型（有趋势）的残差平方和，<span class="math inline">\(df_r\)</span>和<span class="math inline">\(df_f\)</span>分别是相应的自由度。</p>
<p>在生态学研究中，趋势面检验具有重要的应用价值。例如，在分析物种丰富度的空间分布时，趋势面检验可以帮助判断是否存在环境梯度的影响；在研究污染物扩散时，趋势面检验可以识别污染源的空间影响模式；在生态系统监测中，趋势面检验为构建准确的空间模型提供了基础。</p>
<p>需要注意的是，趋势面检验对趋势函数形式的选择比较敏感。多项式趋势面可能无法充分捕捉复杂的空间模式，有时需要使用更灵活的趋势函数或基于样条的方法。此外，趋势面检验需要足够的空间采样点来可靠估计趋势系数，在采样稀疏的区域检验功效可能较低。</p>
<p>接下来我们就用一个简单的例子来演示空间平稳性的检验和处理。我们将使用森林生物量的空间分布数据来演示空间平稳性的检验和处理。</p>
<p>首先，我们模拟了一个具有空间趋势和异质性的非平稳空间过程（图<a href="相关性与相似性.html#fig:forest-biomass-spatial">5.31</a>），该过程模拟了森林生物量在100公顷样地内的空间分布。</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="相关性与相似性.html#cb624-1" tabindex="-1"></a><span class="co"># 空间平稳性检验示例：森林生物量的空间分布</span></span>
<span id="cb624-2"><a href="相关性与相似性.html#cb624-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb624-3"><a href="相关性与相似性.html#cb624-3" tabindex="-1"></a></span>
<span id="cb624-4"><a href="相关性与相似性.html#cb624-4" tabindex="-1"></a><span class="co"># 模拟森林生物量数据（100个样点）</span></span>
<span id="cb624-5"><a href="相关性与相似性.html#cb624-5" tabindex="-1"></a>n_sites <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb624-6"><a href="相关性与相似性.html#cb624-6" tabindex="-1"></a></span>
<span id="cb624-7"><a href="相关性与相似性.html#cb624-7" tabindex="-1"></a><span class="co"># 生成空间坐标</span></span>
<span id="cb624-8"><a href="相关性与相似性.html#cb624-8" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb624-9"><a href="相关性与相似性.html#cb624-9" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">runif</span>(n_sites, <span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb624-10"><a href="相关性与相似性.html#cb624-10" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">runif</span>(n_sites, <span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb624-11"><a href="相关性与相似性.html#cb624-11" tabindex="-1"></a>)</span>
<span id="cb624-12"><a href="相关性与相似性.html#cb624-12" tabindex="-1"></a></span>
<span id="cb624-13"><a href="相关性与相似性.html#cb624-13" tabindex="-1"></a><span class="co"># 模拟非平稳空间过程：具有趋势和异质性的生物量分布</span></span>
<span id="cb624-14"><a href="相关性与相似性.html#cb624-14" tabindex="-1"></a><span class="co"># 趋势成分：从西北到东南的生物量梯度</span></span>
<span id="cb624-15"><a href="相关性与相似性.html#cb624-15" tabindex="-1"></a>trend <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> coords<span class="sc">$</span>x <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> coords<span class="sc">$</span>y</span>
<span id="cb624-16"><a href="相关性与相似性.html#cb624-16" tabindex="-1"></a><span class="co"># 空间异质性：方差随位置变化</span></span>
<span id="cb624-17"><a href="相关性与相似性.html#cb624-17" tabindex="-1"></a>heterogeneity <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_sites, <span class="dv">0</span>, <span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.03</span> <span class="sc">*</span> coords<span class="sc">$</span>x)</span>
<span id="cb624-18"><a href="相关性与相似性.html#cb624-18" tabindex="-1"></a><span class="co"># 空间相关性：使用高斯随机场</span></span>
<span id="cb624-19"><a href="相关性与相似性.html#cb624-19" tabindex="-1"></a><span class="fu">library</span>(geoR)</span>
<span id="cb624-20"><a href="相关性与相似性.html#cb624-20" tabindex="-1"></a>grf_model <span class="ot">&lt;-</span> <span class="fu">grf</span>(</span>
<span id="cb624-21"><a href="相关性与相似性.html#cb624-21" tabindex="-1"></a>  <span class="at">n =</span> n_sites,</span>
<span id="cb624-22"><a href="相关性与相似性.html#cb624-22" tabindex="-1"></a>  <span class="at">grid =</span> <span class="st">&quot;irreg&quot;</span>,</span>
<span id="cb624-23"><a href="相关性与相似性.html#cb624-23" tabindex="-1"></a>  <span class="at">xlims =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb624-24"><a href="相关性与相似性.html#cb624-24" tabindex="-1"></a>  <span class="at">ylims =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb624-25"><a href="相关性与相似性.html#cb624-25" tabindex="-1"></a>  <span class="at">cov.pars =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>), <span class="co"># 方差=10，变程=20</span></span>
<span id="cb624-26"><a href="相关性与相似性.html#cb624-26" tabindex="-1"></a>  <span class="at">cov.model =</span> <span class="st">&quot;exponential&quot;</span></span>
<span id="cb624-27"><a href="相关性与相似性.html#cb624-27" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## grf: simulation(s) on randomly chosen locations with  100  points
## grf: process with  1  covariance structure(s)
## grf: nugget effect is: tausq= 0 
## grf: covariance model 1 is: exponential(sigmasq=10, phi=20)
## grf: decomposition algorithm used is:  cholesky 
## grf: End of simulation procedure. Number of realizations: 1</code></pre>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="相关性与相似性.html#cb626-1" tabindex="-1"></a><span class="co"># 使用grf生成的坐标和空间数据</span></span>
<span id="cb626-2"><a href="相关性与相似性.html#cb626-2" tabindex="-1"></a>grf_coords <span class="ot">&lt;-</span> grf_model<span class="sc">$</span>coords</span>
<span id="cb626-3"><a href="相关性与相似性.html#cb626-3" tabindex="-1"></a>forest_biomass <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> grf_coords[,<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> grf_coords[,<span class="dv">2</span>] <span class="sc">+</span></span>
<span id="cb626-4"><a href="相关性与相似性.html#cb626-4" tabindex="-1"></a>  <span class="fu">rnorm</span>(n_sites, <span class="dv">0</span>, <span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.03</span> <span class="sc">*</span> grf_coords[,<span class="dv">1</span>]) <span class="sc">+</span> grf_model<span class="sc">$</span>data</span>
<span id="cb626-5"><a href="相关性与相似性.html#cb626-5" tabindex="-1"></a></span>
<span id="cb626-6"><a href="相关性与相似性.html#cb626-6" tabindex="-1"></a><span class="co"># 创建空间数据</span></span>
<span id="cb626-7"><a href="相关性与相似性.html#cb626-7" tabindex="-1"></a>spatial_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb626-8"><a href="相关性与相似性.html#cb626-8" tabindex="-1"></a>  <span class="at">x =</span> grf_coords[,<span class="dv">1</span>],</span>
<span id="cb626-9"><a href="相关性与相似性.html#cb626-9" tabindex="-1"></a>  <span class="at">y =</span> grf_coords[,<span class="dv">2</span>],</span>
<span id="cb626-10"><a href="相关性与相似性.html#cb626-10" tabindex="-1"></a>  <span class="at">biomass =</span> forest_biomass</span>
<span id="cb626-11"><a href="相关性与相似性.html#cb626-11" tabindex="-1"></a>)</span>
<span id="cb626-12"><a href="相关性与相似性.html#cb626-12" tabindex="-1"></a><span class="fu">coordinates</span>(spatial_data) <span class="ot">&lt;-</span> <span class="er">~</span> x <span class="sc">+</span> y</span>
<span id="cb626-13"><a href="相关性与相似性.html#cb626-13" tabindex="-1"></a></span>
<span id="cb626-14"><a href="相关性与相似性.html#cb626-14" tabindex="-1"></a><span class="co"># 可视化空间分布</span></span>
<span id="cb626-15"><a href="相关性与相似性.html#cb626-15" tabindex="-1"></a>spatial_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(spatial_data)</span>
<span id="cb626-16"><a href="相关性与相似性.html#cb626-16" tabindex="-1"></a></span>
<span id="cb626-17"><a href="相关性与相似性.html#cb626-17" tabindex="-1"></a><span class="fu">ggplot</span>(spatial_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> biomass)) <span class="sc">+</span></span>
<span id="cb626-18"><a href="相关性与相似性.html#cb626-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb626-19"><a href="相关性与相似性.html#cb626-19" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb626-20"><a href="相关性与相似性.html#cb626-20" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb626-21"><a href="相关性与相似性.html#cb626-21" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;森林生物量的空间分布&quot;</span>,</span>
<span id="cb626-22"><a href="相关性与相似性.html#cb626-22" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;X坐标 (m)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y坐标 (m)&quot;</span>, <span class="at">color =</span> <span class="st">&quot;生物量 (t/ha)&quot;</span></span>
<span id="cb626-23"><a href="相关性与相似性.html#cb626-23" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb626-24"><a href="相关性与相似性.html#cb626-24" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:forest-biomass-spatial"></span>
<img src="05-correlation_files/figure-html/forest-biomass-spatial-1.png" alt="森林生物量的空间分布图，展示了具有趋势和空间异质性的非平稳空间过程" width="672" />
<p class="caption">
图5.31: 森林生物量的空间分布图，展示了具有趋势和空间异质性的非平稳空间过程
</p>
</div>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="相关性与相似性.html#cb627-1" tabindex="-1"></a><span class="co"># 检验空间平稳性：趋势面检验</span></span>
<span id="cb627-2"><a href="相关性与相似性.html#cb627-2" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb627-3"><a href="相关性与相似性.html#cb627-3" tabindex="-1"></a></span>
<span id="cb627-4"><a href="相关性与相似性.html#cb627-4" tabindex="-1"></a><span class="co"># 拟合趋势面模型</span></span>
<span id="cb627-5"><a href="相关性与相似性.html#cb627-5" tabindex="-1"></a><span class="co"># 一阶趋势面（线性趋势）</span></span>
<span id="cb627-6"><a href="相关性与相似性.html#cb627-6" tabindex="-1"></a>trend_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(biomass <span class="sc">~</span> x <span class="sc">+</span> y, <span class="at">data =</span> spatial_df)</span>
<span id="cb627-7"><a href="相关性与相似性.html#cb627-7" tabindex="-1"></a></span>
<span id="cb627-8"><a href="相关性与相似性.html#cb627-8" tabindex="-1"></a><span class="co"># 二阶趋势面（二次趋势）</span></span>
<span id="cb627-9"><a href="相关性与相似性.html#cb627-9" tabindex="-1"></a>trend_quadratic <span class="ot">&lt;-</span> <span class="fu">lm</span>(biomass <span class="sc">~</span> x <span class="sc">+</span> y <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(y<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">*</span>y), <span class="at">data =</span> spatial_df)</span>
<span id="cb627-10"><a href="相关性与相似性.html#cb627-10" tabindex="-1"></a></span>
<span id="cb627-11"><a href="相关性与相似性.html#cb627-11" tabindex="-1"></a><span class="co"># 进行趋势面检验</span></span>
<span id="cb627-12"><a href="相关性与相似性.html#cb627-12" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;趋势面检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 趋势面检验结果：</code></pre>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="相关性与相似性.html#cb629-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;一阶趋势面F检验：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 一阶趋势面F检验：</code></pre>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="相关性与相似性.html#cb631-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">anova</span>(trend_linear))</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: biomass
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## x          1 5978.5  5978.5 118.647 &lt; 2.2e-16 ***
## y          1 3789.1  3789.1  75.197 9.842e-14 ***
## Residuals 97 4887.7    50.4                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="相关性与相似性.html#cb633-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">二阶趋势面F检验：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 二阶趋势面F检验：</code></pre>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="相关性与相似性.html#cb635-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">anova</span>(trend_quadratic))</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: biomass
##           Df Sum Sq Mean Sq  F value    Pr(&gt;F)    
## x          1 5978.5  5978.5 130.9930 &lt; 2.2e-16 ***
## y          1 3789.1  3789.1  83.0214 1.424e-14 ***
## I(x^2)     1    0.0     0.0   0.0005 0.9821071    
## I(y^2)     1  597.5   597.5  13.0917 0.0004799 ***
## I(x * y)   1    0.1     0.1   0.0014 0.9706721    
## Residuals 94 4290.1    45.6                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="相关性与相似性.html#cb637-1" tabindex="-1"></a><span class="co"># 比较模型拟合</span></span>
<span id="cb637-2"><a href="相关性与相似性.html#cb637-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">模型比较：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 模型比较：</code></pre>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="相关性与相似性.html#cb639-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;无趋势模型（仅截距）AIC：&quot;</span>, <span class="fu">AIC</span>(<span class="fu">lm</span>(biomass <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> spatial_df)), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 无趋势模型（仅截距）AIC： 786.5264</code></pre>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="相关性与相似性.html#cb641-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;一阶趋势面AIC：&quot;</span>, <span class="fu">AIC</span>(trend_linear), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 一阶趋势面AIC： 680.719</code></pre>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="相关性与相似性.html#cb643-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;二阶趋势面AIC：&quot;</span>, <span class="fu">AIC</span>(trend_quadratic), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 二阶趋势面AIC： 673.6782</code></pre>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="相关性与相似性.html#cb645-1" tabindex="-1"></a><span class="co"># 检查残差的平稳性</span></span>
<span id="cb645-2"><a href="相关性与相似性.html#cb645-2" tabindex="-1"></a>residuals_linear <span class="ot">&lt;-</span> <span class="fu">residuals</span>(trend_linear)</span>
<span id="cb645-3"><a href="相关性与相似性.html#cb645-3" tabindex="-1"></a>residuals_quadratic <span class="ot">&lt;-</span> <span class="fu">residuals</span>(trend_quadratic)</span>
<span id="cb645-4"><a href="相关性与相似性.html#cb645-4" tabindex="-1"></a></span>
<span id="cb645-5"><a href="相关性与相似性.html#cb645-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">残差统计：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 残差统计：</code></pre>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="相关性与相似性.html#cb647-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;原始数据方差：&quot;</span>, <span class="fu">round</span>(<span class="fu">var</span>(spatial_df<span class="sc">$</span>biomass), <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 原始数据方差： 148.03</code></pre>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="相关性与相似性.html#cb649-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;一阶趋势面残差方差：&quot;</span>, <span class="fu">round</span>(<span class="fu">var</span>(residuals_linear), <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 一阶趋势面残差方差： 49.37</code></pre>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="相关性与相似性.html#cb651-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;二阶趋势面残差方差：&quot;</span>, <span class="fu">round</span>(<span class="fu">var</span>(residuals_quadratic), <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 二阶趋势面残差方差： 43.33</code></pre>
<p>当发现空间过程非平稳时，通常需要进行趋势去除或变换来使其平稳化。趋势去除可以通过拟合趋势面并计算残差来实现，空间变换（如对数变换）可以稳定方差。经过这些处理后的平稳空间过程就可以安全地应用各种空间统计分析方法了。在生态学应用中，理解空间过程的平稳性不仅关系到统计方法的正确使用，也帮助我们识别生态系统的空间变化模式和动态特征。</p>
<p>趋势去除是处理非平稳空间过程最常用的方法之一，其数学原理基于空间过程的分解：<span class="math inline">\(Z(\mathbf{s}) = m(\mathbf{s}) + \epsilon(\mathbf{s})\)</span>，其中<span class="math inline">\(m(\mathbf{s})\)</span>是确定性趋势成分，<span class="math inline">\(\epsilon(\mathbf{s})\)</span>是平稳的随机残差。通过估计趋势函数<span class="math inline">\(\hat{m}(\mathbf{s})\)</span>，我们可以得到平稳的残差过程<span class="math inline">\(\hat{\epsilon}(\mathbf{s}) = Z(\mathbf{s}) - \hat{m}(\mathbf{s})\)</span>。</p>
<p>在生态学空间分析中，趋势去除具有重要的应用价值。许多生态过程，如物种分布、环境因子变异、生态系统生产力等，往往表现出明显的空间趋势特征。通过趋势去除，我们可以将这些趋势从原始数据中分离出来，从而更好地分析数据中的空间随机变异成分。例如，在研究森林生物量的空间分布时，趋势去除能够帮助我们识别局部的空间聚集模式，而不是仅仅关注整体的空间梯度。</p>
<p>需要注意的是，趋势去除虽然能够分离趋势成分，但可能会引入新的问题。趋势函数的选择对结果有重要影响，不合适的趋势函数可能导致过度拟合或欠拟合。此外，趋势去除后的残差过程可能仍然存在空间异质性，需要进一步检验。在实际应用中，通常需要结合统计检验（如变异函数分析）来验证去趋势后过程的平稳性，确保趋势去除达到了预期效果。</p>
<p>接下来我们就用趋势去除来处理上面例子中空间非平稳问题。通过趋势去除处理，我们可以将原始的非平稳空间过程转换为平稳过程，从而满足空间分析的基本假设。</p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="相关性与相似性.html#cb653-1" tabindex="-1"></a><span class="co"># 如果非平稳，进行趋势去除处理</span></span>
<span id="cb653-2"><a href="相关性与相似性.html#cb653-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">AIC</span>(trend_linear) <span class="sc">&lt;</span> <span class="fu">AIC</span>(<span class="fu">lm</span>(biomass <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> spatial_df))) {</span>
<span id="cb653-3"><a href="相关性与相似性.html#cb653-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">进行趋势去除处理...</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb653-4"><a href="相关性与相似性.html#cb653-4" tabindex="-1"></a></span>
<span id="cb653-5"><a href="相关性与相似性.html#cb653-5" tabindex="-1"></a>  <span class="co"># 使用最优趋势模型进行趋势去除</span></span>
<span id="cb653-6"><a href="相关性与相似性.html#cb653-6" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">AIC</span>(trend_quadratic) <span class="sc">&lt;</span> <span class="fu">AIC</span>(trend_linear)) {</span>
<span id="cb653-7"><a href="相关性与相似性.html#cb653-7" tabindex="-1"></a>    best_trend <span class="ot">&lt;-</span> trend_quadratic</span>
<span id="cb653-8"><a href="相关性与相似性.html#cb653-8" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;使用二阶趋势面进行趋势去除</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb653-9"><a href="相关性与相似性.html#cb653-9" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb653-10"><a href="相关性与相似性.html#cb653-10" tabindex="-1"></a>    best_trend <span class="ot">&lt;-</span> trend_linear</span>
<span id="cb653-11"><a href="相关性与相似性.html#cb653-11" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;使用一阶趋势面进行趋势去除</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb653-12"><a href="相关性与相似性.html#cb653-12" tabindex="-1"></a>  }</span>
<span id="cb653-13"><a href="相关性与相似性.html#cb653-13" tabindex="-1"></a></span>
<span id="cb653-14"><a href="相关性与相似性.html#cb653-14" tabindex="-1"></a>  <span class="co"># 计算去趋势后的残差</span></span>
<span id="cb653-15"><a href="相关性与相似性.html#cb653-15" tabindex="-1"></a>  detrended_biomass <span class="ot">&lt;-</span> <span class="fu">residuals</span>(best_trend)</span>
<span id="cb653-16"><a href="相关性与相似性.html#cb653-16" tabindex="-1"></a></span>
<span id="cb653-17"><a href="相关性与相似性.html#cb653-17" tabindex="-1"></a>  <span class="co"># 检验去趋势后过程的平稳性</span></span>
<span id="cb653-18"><a href="相关性与相似性.html#cb653-18" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;去趋势后过程的统计特性：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb653-19"><a href="相关性与相似性.html#cb653-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;均值：&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(detrended_biomass), <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb653-20"><a href="相关性与相似性.html#cb653-20" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;方差：&quot;</span>, <span class="fu">round</span>(<span class="fu">var</span>(detrended_biomass), <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb653-21"><a href="相关性与相似性.html#cb653-21" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## 进行趋势去除处理...
## 使用二阶趋势面进行趋势去除
## 去趋势后过程的统计特性：
## 均值： 0 
## 方差： 43.335</code></pre>
<p>图<a href="相关性与相似性.html#fig:original-spatial-plot">5.32</a>展示了原始森林生物量的空间分布，可以观察到明显的空间趋势和异质性，这是典型的非平稳空间过程特征。</p>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="相关性与相似性.html#cb655-1" tabindex="-1"></a><span class="co"># 原始空间过程可视化</span></span>
<span id="cb655-2"><a href="相关性与相似性.html#cb655-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">AIC</span>(trend_linear) <span class="sc">&lt;</span> <span class="fu">AIC</span>(<span class="fu">lm</span>(biomass <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> spatial_df))) {</span>
<span id="cb655-3"><a href="相关性与相似性.html#cb655-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(spatial_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> biomass)) <span class="sc">+</span></span>
<span id="cb655-4"><a href="相关性与相似性.html#cb655-4" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb655-5"><a href="相关性与相似性.html#cb655-5" tabindex="-1"></a>    <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb655-6"><a href="相关性与相似性.html#cb655-6" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb655-7"><a href="相关性与相似性.html#cb655-7" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;原始空间过程&quot;</span>,</span>
<span id="cb655-8"><a href="相关性与相似性.html#cb655-8" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y坐标&quot;</span>, <span class="at">color =</span> <span class="st">&quot;生物量&quot;</span></span>
<span id="cb655-9"><a href="相关性与相似性.html#cb655-9" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb655-10"><a href="相关性与相似性.html#cb655-10" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb655-11"><a href="相关性与相似性.html#cb655-11" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:original-spatial-plot"></span>
<img src="05-correlation_files/figure-html/original-spatial-plot-1.png" alt="原始森林生物量空间分布，显示明显的空间趋势和异质性" width="672" />
<p class="caption">
图5.32: 原始森林生物量空间分布，显示明显的空间趋势和异质性
</p>
</div>
<p>经过趋势去除处理后，空间过程的趋势成分被有效去除，如图<a href="相关性与相似性.html#fig:detrended-spatial-plot">5.33</a>所示，去趋势后的过程主要保留了空间随机变异成分。</p>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="相关性与相似性.html#cb656-1" tabindex="-1"></a><span class="co"># 去趋势后空间过程可视化</span></span>
<span id="cb656-2"><a href="相关性与相似性.html#cb656-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">AIC</span>(trend_linear) <span class="sc">&lt;</span> <span class="fu">AIC</span>(<span class="fu">lm</span>(biomass <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> spatial_df))) {</span>
<span id="cb656-3"><a href="相关性与相似性.html#cb656-3" tabindex="-1"></a>  detrended_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb656-4"><a href="相关性与相似性.html#cb656-4" tabindex="-1"></a>    <span class="at">x =</span> spatial_df<span class="sc">$</span>x,</span>
<span id="cb656-5"><a href="相关性与相似性.html#cb656-5" tabindex="-1"></a>    <span class="at">y =</span> spatial_df<span class="sc">$</span>y,</span>
<span id="cb656-6"><a href="相关性与相似性.html#cb656-6" tabindex="-1"></a>    <span class="at">residual =</span> detrended_biomass</span>
<span id="cb656-7"><a href="相关性与相似性.html#cb656-7" tabindex="-1"></a>  )</span>
<span id="cb656-8"><a href="相关性与相似性.html#cb656-8" tabindex="-1"></a></span>
<span id="cb656-9"><a href="相关性与相似性.html#cb656-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(detrended_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> residual)) <span class="sc">+</span></span>
<span id="cb656-10"><a href="相关性与相似性.html#cb656-10" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb656-11"><a href="相关性与相似性.html#cb656-11" tabindex="-1"></a>    <span class="fu">scale_color_gradient2</span>(<span class="at">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb656-12"><a href="相关性与相似性.html#cb656-12" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb656-13"><a href="相关性与相似性.html#cb656-13" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;去趋势后空间过程&quot;</span>,</span>
<span id="cb656-14"><a href="相关性与相似性.html#cb656-14" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y坐标&quot;</span>, <span class="at">color =</span> <span class="st">&quot;残差&quot;</span></span>
<span id="cb656-15"><a href="相关性与相似性.html#cb656-15" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb656-16"><a href="相关性与相似性.html#cb656-16" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb656-17"><a href="相关性与相似性.html#cb656-17" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:detrended-spatial-plot"></span>
<img src="05-correlation_files/figure-html/detrended-spatial-plot-1.png" alt="去趋势后的森林生物量空间分布，趋势成分已被去除" width="672" />
<p class="caption">
图5.33: 去趋势后的森林生物量空间分布，趋势成分已被去除
</p>
</div>
<p>原始空间过程的变异函数（图<a href="相关性与相似性.html#fig:original-variogram">5.34</a>）显示持续上升的特征，这是非平稳空间过程的典型表现。</p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="相关性与相似性.html#cb657-1" tabindex="-1"></a><span class="co"># 原始空间过程变异函数</span></span>
<span id="cb657-2"><a href="相关性与相似性.html#cb657-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">AIC</span>(trend_linear) <span class="sc">&lt;</span> <span class="fu">AIC</span>(<span class="fu">lm</span>(biomass <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> spatial_df))) {</span>
<span id="cb657-3"><a href="相关性与相似性.html#cb657-3" tabindex="-1"></a>  vario_original <span class="ot">&lt;-</span> <span class="fu">variogram</span>(biomass <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> spatial_data)</span>
<span id="cb657-4"><a href="相关性与相似性.html#cb657-4" tabindex="-1"></a>  <span class="fu">plot</span>(vario_original,</span>
<span id="cb657-5"><a href="相关性与相似性.html#cb657-5" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;原始空间过程的变异函数&quot;</span>,</span>
<span id="cb657-6"><a href="相关性与相似性.html#cb657-6" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;距离&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;半方差&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb657-7"><a href="相关性与相似性.html#cb657-7" tabindex="-1"></a>  )</span>
<span id="cb657-8"><a href="相关性与相似性.html#cb657-8" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:original-variogram"></span>
<img src="05-correlation_files/figure-html/original-variogram-1.png" alt="原始空间过程的变异函数，显示持续上升的非平稳特征" width="672" />
<p class="caption">
图5.34: 原始空间过程的变异函数，显示持续上升的非平稳特征
</p>
</div>
<p>去趋势后空间过程的变异函数（图<a href="相关性与相似性.html#fig:detrended-variogram">5.35</a>）显示收敛到基台值的特征，表明过程已经达到平稳状态。</p>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="相关性与相似性.html#cb658-1" tabindex="-1"></a><span class="co"># 去趋势后空间过程变异函数</span></span>
<span id="cb658-2"><a href="相关性与相似性.html#cb658-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">AIC</span>(trend_linear) <span class="sc">&lt;</span> <span class="fu">AIC</span>(<span class="fu">lm</span>(biomass <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> spatial_df))) {</span>
<span id="cb658-3"><a href="相关性与相似性.html#cb658-3" tabindex="-1"></a>  detrended_data <span class="ot">&lt;-</span> spatial_data</span>
<span id="cb658-4"><a href="相关性与相似性.html#cb658-4" tabindex="-1"></a>  detrended_data<span class="sc">$</span>biomass <span class="ot">&lt;-</span> detrended_biomass</span>
<span id="cb658-5"><a href="相关性与相似性.html#cb658-5" tabindex="-1"></a>  vario_detrended <span class="ot">&lt;-</span> <span class="fu">variogram</span>(biomass <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> detrended_data)</span>
<span id="cb658-6"><a href="相关性与相似性.html#cb658-6" tabindex="-1"></a>  <span class="fu">plot</span>(vario_detrended,</span>
<span id="cb658-7"><a href="相关性与相似性.html#cb658-7" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;去趋势后空间过程的变异函数&quot;</span>,</span>
<span id="cb658-8"><a href="相关性与相似性.html#cb658-8" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;距离&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;半方差&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span></span>
<span id="cb658-9"><a href="相关性与相似性.html#cb658-9" tabindex="-1"></a>  )</span>
<span id="cb658-10"><a href="相关性与相似性.html#cb658-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:detrended-variogram"></span>
<img src="05-correlation_files/figure-html/detrended-variogram-1.png" alt="去趋势后空间过程的变异函数，显示收敛的平稳特征" width="672" />
<p class="caption">
图5.35: 去趋势后空间过程的变异函数，显示收敛的平稳特征
</p>
</div>
<p>图<a href="相关性与相似性.html#fig:spatial-decomposition">5.36</a>展示了空间过程分解的结果，将原始过程分离为趋势成分和随机成分，帮助我们更好地理解空间过程的内在结构。</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="相关性与相似性.html#cb659-1" tabindex="-1"></a><span class="co"># 空间过程分解可视化</span></span>
<span id="cb659-2"><a href="相关性与相似性.html#cb659-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">AIC</span>(trend_linear) <span class="sc">&lt;</span> <span class="fu">AIC</span>(<span class="fu">lm</span>(biomass <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> spatial_df))) {</span>
<span id="cb659-3"><a href="相关性与相似性.html#cb659-3" tabindex="-1"></a>  <span class="co"># 创建趋势面预测</span></span>
<span id="cb659-4"><a href="相关性与相似性.html#cb659-4" tabindex="-1"></a>  trend_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_trend, <span class="at">newdata =</span> spatial_df)</span>
<span id="cb659-5"><a href="相关性与相似性.html#cb659-5" tabindex="-1"></a></span>
<span id="cb659-6"><a href="相关性与相似性.html#cb659-6" tabindex="-1"></a>  decomposition_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb659-7"><a href="相关性与相似性.html#cb659-7" tabindex="-1"></a>    <span class="at">x =</span> spatial_df<span class="sc">$</span>x,</span>
<span id="cb659-8"><a href="相关性与相似性.html#cb659-8" tabindex="-1"></a>    <span class="at">y =</span> spatial_df<span class="sc">$</span>y,</span>
<span id="cb659-9"><a href="相关性与相似性.html#cb659-9" tabindex="-1"></a>    <span class="at">original =</span> spatial_df<span class="sc">$</span>biomass,</span>
<span id="cb659-10"><a href="相关性与相似性.html#cb659-10" tabindex="-1"></a>    <span class="at">trend =</span> trend_pred,</span>
<span id="cb659-11"><a href="相关性与相似性.html#cb659-11" tabindex="-1"></a>    <span class="at">residual =</span> detrended_biomass</span>
<span id="cb659-12"><a href="相关性与相似性.html#cb659-12" tabindex="-1"></a>  )</span>
<span id="cb659-13"><a href="相关性与相似性.html#cb659-13" tabindex="-1"></a></span>
<span id="cb659-14"><a href="相关性与相似性.html#cb659-14" tabindex="-1"></a>  <span class="co"># 创建分解图</span></span>
<span id="cb659-15"><a href="相关性与相似性.html#cb659-15" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(decomposition_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> original)) <span class="sc">+</span></span>
<span id="cb659-16"><a href="相关性与相似性.html#cb659-16" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb659-17"><a href="相关性与相似性.html#cb659-17" tabindex="-1"></a>    <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb659-18"><a href="相关性与相似性.html#cb659-18" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;原始过程&quot;</span>, <span class="at">x =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y坐标&quot;</span>) <span class="sc">+</span></span>
<span id="cb659-19"><a href="相关性与相似性.html#cb659-19" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb659-20"><a href="相关性与相似性.html#cb659-20" tabindex="-1"></a></span>
<span id="cb659-21"><a href="相关性与相似性.html#cb659-21" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(decomposition_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> trend)) <span class="sc">+</span></span>
<span id="cb659-22"><a href="相关性与相似性.html#cb659-22" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb659-23"><a href="相关性与相似性.html#cb659-23" tabindex="-1"></a>    <span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb659-24"><a href="相关性与相似性.html#cb659-24" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;趋势成分&quot;</span>, <span class="at">x =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y坐标&quot;</span>) <span class="sc">+</span></span>
<span id="cb659-25"><a href="相关性与相似性.html#cb659-25" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb659-26"><a href="相关性与相似性.html#cb659-26" tabindex="-1"></a></span>
<span id="cb659-27"><a href="相关性与相似性.html#cb659-27" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(decomposition_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> residual)) <span class="sc">+</span></span>
<span id="cb659-28"><a href="相关性与相似性.html#cb659-28" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb659-29"><a href="相关性与相似性.html#cb659-29" tabindex="-1"></a>    <span class="fu">scale_color_gradient2</span>(<span class="at">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">mid =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb659-30"><a href="相关性与相似性.html#cb659-30" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;随机成分&quot;</span>, <span class="at">x =</span> <span class="st">&quot;X坐标&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y坐标&quot;</span>) <span class="sc">+</span></span>
<span id="cb659-31"><a href="相关性与相似性.html#cb659-31" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb659-32"><a href="相关性与相似性.html#cb659-32" tabindex="-1"></a></span>
<span id="cb659-33"><a href="相关性与相似性.html#cb659-33" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb659-34"><a href="相关性与相似性.html#cb659-34" tabindex="-1"></a>  p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span></span>
<span id="cb659-35"><a href="相关性与相似性.html#cb659-35" tabindex="-1"></a>    <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;空间过程分解：原始过程 = 趋势成分 + 随机成分&quot;</span>)</span>
<span id="cb659-36"><a href="相关性与相似性.html#cb659-36" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:spatial-decomposition"></span>
<img src="05-correlation_files/figure-html/spatial-decomposition-1.png" alt="空间过程分解结果，展示趋势成分和随机成分的分离" width="672" />
<p class="caption">
图5.36: 空间过程分解结果，展示趋势成分和随机成分的分离
</p>
</div>
</div>
</div>
<div id="系统发育相关性" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> 系统发育相关性<a href="相关性与相似性.html#系统发育相关性" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>系统发育相关性分析是进化生态学和比较生物学中的重要工具，它考虑了物种间的系统发育关系对性状相关性的影响。由于物种共享进化历史，它们之间的性状值往往不是独立的，这种非独立性可能导致传统的统计方法产生偏差。系统发育相关性分析通过整合系统发育信息，帮助我们区分性状间的生态关系和系统发育保守性。</p>
<div id="系统发育信号进化历史的印记" class="section level3 hasAnchor" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> 系统发育信号：进化历史的印记<a href="相关性与相似性.html#系统发育信号进化历史的印记" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在研究不同植物物种的叶片性状时，我们想要了解这些性状在系统发育树上的分布模式，即它们是否表现出系统发育信号——亲缘关系较近的物种是否具有相似的性状值。</p>
<p>系统发育信号是指性状在系统发育树上的分布模式，反映了性状的进化保守性程度。如果亲缘关系较近的物种具有相似的性状值，我们说该性状具有强烈的系统发育信号；如果性状值在系统发育树上随机分布，与亲缘关系无关，则系统发育信号较弱或不存在。系统发育信号的量化对于理解性状的进化动态和生态适应具有重要意义。</p>
<p>最常用的系统发育信号度量方法是Blomberg’s K和Pagel’s λ。Blomberg’s K由Blomberg等人于2003年提出，它比较观测到的性状在系统发育树上的方差与在布朗运动模型下的期望方差。K值等于1表示性状的进化完全符合布朗运动模型（中等系统发育信号）；K值大于1表示性状比布朗运动模型预测的更保守（强系统发育信号）；K值小于1表示性状比布朗运动模型预测的更趋同（弱系统发育信号）。K值的统计显著性通常通过置换检验来评估。</p>
<p>Pagel’s λ是另一个广泛使用的系统发育信号度量，由Pagel于1999年提出。λ参数度量系统发育树在解释性状变异中的相对重要性。λ值在0到1之间变化，其中0表示性状变异与系统发育无关（没有系统发育信号），1表示性状变异完全由系统发育关系解释（强系统发育信号）。λ值可以通过最大似然法估计，其统计显著性可以通过似然比检验来评估。</p>
<p>在生态学研究中，系统发育信号分析具有重要的应用价值。例如，在功能生态学中，系统发育信号分析可以帮助理解功能性状的进化保守性；在群落生态学中，它可以揭示群落构建中的系统发育过程；在保护生物学中，它可以指导基于系统发育多样性的保护策略。此外，系统发育信号分析还为系统发育比较方法提供了基础，确保生态关系的统计检验不受系统发育非独立性的影响。</p>
<p><strong>数学定义</strong>：</p>
<ul>
<li><strong>Blomberg’s K</strong>：</li>
</ul>
<p><span class="math display">\[K = \frac{MS_{obs}}{MS_{random}}\]</span></p>
<p>其中<span class="math inline">\(MS_{obs}\)</span>是观测到的性状在系统发育树上的均方，<span class="math inline">\(MS_{random}\)</span>是在布朗运动模型下的期望均方。</p>
<ul>
<li><strong>Pagel’s λ</strong>：</li>
</ul>
<p>通过最大化似然函数来估计：</p>
<p><span class="math display">\[L(\lambda) = -\frac{1}{2}[(n-1)\ln(2\pi) + \ln|\lambda\mathbf{C} + (1-\lambda)\mathbf{I}| + \mathbf{y}^T(\lambda\mathbf{C} + (1-\lambda)\mathbf{I})^{-1}\mathbf{y}]\]</span></p>
<p>其中<span class="math inline">\(\mathbf{C}\)</span>是系统发育协方差矩阵，<span class="math inline">\(\mathbf{I}\)</span>是单位矩阵，<span class="math inline">\(\mathbf{y}\)</span>是性状向量。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="相关性与相似性.html#cb660-1" tabindex="-1"></a><span class="co"># 系统发育信号分析示例：植物叶片性状的系统发育保守性</span></span>
<span id="cb660-2"><a href="相关性与相似性.html#cb660-2" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb660-3"><a href="相关性与相似性.html#cb660-3" tabindex="-1"></a><span class="fu">library</span>(phytools)</span>
<span id="cb660-4"><a href="相关性与相似性.html#cb660-4" tabindex="-1"></a><span class="fu">library</span>(picante)</span>
<span id="cb660-5"><a href="相关性与相似性.html#cb660-5" tabindex="-1"></a></span>
<span id="cb660-6"><a href="相关性与相似性.html#cb660-6" tabindex="-1"></a><span class="co"># 模拟系统发育树和性状数据</span></span>
<span id="cb660-7"><a href="相关性与相似性.html#cb660-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb660-8"><a href="相关性与相似性.html#cb660-8" tabindex="-1"></a></span>
<span id="cb660-9"><a href="相关性与相似性.html#cb660-9" tabindex="-1"></a><span class="co"># 生成随机系统发育树（50个物种）</span></span>
<span id="cb660-10"><a href="相关性与相似性.html#cb660-10" tabindex="-1"></a>n_species <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb660-11"><a href="相关性与相似性.html#cb660-11" tabindex="-1"></a>phy_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(n_species)</span>
<span id="cb660-12"><a href="相关性与相似性.html#cb660-12" tabindex="-1"></a></span>
<span id="cb660-13"><a href="相关性与相似性.html#cb660-13" tabindex="-1"></a><span class="co"># 模拟具有系统发育信号的性状数据</span></span>
<span id="cb660-14"><a href="相关性与相似性.html#cb660-14" tabindex="-1"></a><span class="co"># 使用布朗运动模型模拟保守性状</span></span>
<span id="cb660-15"><a href="相关性与相似性.html#cb660-15" tabindex="-1"></a>trait_conservative <span class="ot">&lt;-</span> <span class="fu">rTraitCont</span>(phy_tree, <span class="at">model =</span> <span class="st">&quot;BM&quot;</span>, <span class="at">sigma =</span> <span class="dv">1</span>)</span>
<span id="cb660-16"><a href="相关性与相似性.html#cb660-16" tabindex="-1"></a></span>
<span id="cb660-17"><a href="相关性与相似性.html#cb660-17" tabindex="-1"></a><span class="co"># 模拟没有系统发育信号的性状数据（随机性状）</span></span>
<span id="cb660-18"><a href="相关性与相似性.html#cb660-18" tabindex="-1"></a>trait_random <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_species, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb660-19"><a href="相关性与相似性.html#cb660-19" tabindex="-1"></a><span class="fu">names</span>(trait_random) <span class="ot">&lt;-</span> phy_tree<span class="sc">$</span>tip.label</span>
<span id="cb660-20"><a href="相关性与相似性.html#cb660-20" tabindex="-1"></a></span>
<span id="cb660-21"><a href="相关性与相似性.html#cb660-21" tabindex="-1"></a><span class="co"># 计算Blomberg&#39;s K</span></span>
<span id="cb660-22"><a href="相关性与相似性.html#cb660-22" tabindex="-1"></a>K_conservative <span class="ot">&lt;-</span> <span class="fu">Kcalc</span>(trait_conservative, phy_tree)</span>
<span id="cb660-23"><a href="相关性与相似性.html#cb660-23" tabindex="-1"></a>K_random <span class="ot">&lt;-</span> <span class="fu">Kcalc</span>(trait_random, phy_tree)</span>
<span id="cb660-24"><a href="相关性与相似性.html#cb660-24" tabindex="-1"></a></span>
<span id="cb660-25"><a href="相关性与相似性.html#cb660-25" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Blomberg&#39;s K分析结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb660-26"><a href="相关性与相似性.html#cb660-26" tabindex="-1"></a>    <span class="st">&quot;保守性状的K值：&quot;</span>, <span class="fu">round</span>(K_conservative, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb660-27"><a href="相关性与相似性.html#cb660-27" tabindex="-1"></a>    <span class="st">&quot;随机性状的K值：&quot;</span>, <span class="fu">round</span>(K_random, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb660-28"><a href="相关性与相似性.html#cb660-28" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## Blomberg&#39;s K分析结果：
## 保守性状的K值：1.104
## 随机性状的K值：0.168</code></pre>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="相关性与相似性.html#cb662-1" tabindex="-1"></a><span class="co"># 进行置换检验（使用phylosig函数进行置换检验）</span></span>
<span id="cb662-2"><a href="相关性与相似性.html#cb662-2" tabindex="-1"></a>K_perm_conservative <span class="ot">&lt;-</span> <span class="fu">phylosig</span>(phy_tree, trait_conservative, <span class="at">method =</span> <span class="st">&quot;K&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb662-3"><a href="相关性与相似性.html#cb662-3" tabindex="-1"></a>K_perm_random <span class="ot">&lt;-</span> <span class="fu">phylosig</span>(phy_tree, trait_random, <span class="at">method =</span> <span class="st">&quot;K&quot;</span>, <span class="at">test =</span> <span class="cn">TRUE</span>, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb662-4"><a href="相关性与相似性.html#cb662-4" tabindex="-1"></a></span>
<span id="cb662-5"><a href="相关性与相似性.html#cb662-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">置换检验p值：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb662-6"><a href="相关性与相似性.html#cb662-6" tabindex="-1"></a>    <span class="st">&quot;保守性状：&quot;</span>, <span class="fu">format.pval</span>(K_perm_conservative<span class="sc">$</span>P, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb662-7"><a href="相关性与相似性.html#cb662-7" tabindex="-1"></a>    <span class="st">&quot;随机性状：&quot;</span>, <span class="fu">format.pval</span>(K_perm_random<span class="sc">$</span>P, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb662-8"><a href="相关性与相似性.html#cb662-8" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 置换检验p值：
## 保守性状：0.001
## 随机性状：0.83</code></pre>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="相关性与相似性.html#cb664-1" tabindex="-1"></a><span class="co"># 计算Pagel&#39;s λ</span></span>
<span id="cb664-2"><a href="相关性与相似性.html#cb664-2" tabindex="-1"></a>lambda_conservative <span class="ot">&lt;-</span> <span class="fu">phylosig</span>(phy_tree, trait_conservative, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb664-3"><a href="相关性与相似性.html#cb664-3" tabindex="-1"></a>lambda_random <span class="ot">&lt;-</span> <span class="fu">phylosig</span>(phy_tree, trait_random, <span class="at">method =</span> <span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb664-4"><a href="相关性与相似性.html#cb664-4" tabindex="-1"></a></span>
<span id="cb664-5"><a href="相关性与相似性.html#cb664-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Pagel&#39;s λ分析结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb664-6"><a href="相关性与相似性.html#cb664-6" tabindex="-1"></a>    <span class="st">&quot;保守性状的λ值：&quot;</span>, <span class="fu">round</span>(lambda_conservative<span class="sc">$</span>lambda, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb664-7"><a href="相关性与相似性.html#cb664-7" tabindex="-1"></a>    <span class="st">&quot;随机性状的λ值：&quot;</span>, <span class="fu">round</span>(lambda_random<span class="sc">$</span>lambda, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb664-8"><a href="相关性与相似性.html#cb664-8" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Pagel&#39;s λ分析结果：
## 保守性状的λ值：1
## 随机性状的λ值：0</code></pre>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="相关性与相似性.html#cb666-1" tabindex="-1"></a><span class="co"># 进行似然比检验</span></span>
<span id="cb666-2"><a href="相关性与相似性.html#cb666-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">似然比检验p值：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb666-3"><a href="相关性与相似性.html#cb666-3" tabindex="-1"></a>    <span class="st">&quot;保守性状：&quot;</span>, <span class="fu">format.pval</span>(lambda_conservative<span class="sc">$</span>P, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb666-4"><a href="相关性与相似性.html#cb666-4" tabindex="-1"></a>    <span class="st">&quot;随机性状：&quot;</span>, <span class="fu">format.pval</span>(lambda_random<span class="sc">$</span>P, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb666-5"><a href="相关性与相似性.html#cb666-5" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 似然比检验p值：
## 保守性状：
## 随机性状：</code></pre>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="相关性与相似性.html#cb668-1" tabindex="-1"></a><span class="co"># 可视化系统发育信号</span></span>
<span id="cb668-2"><a href="相关性与相似性.html#cb668-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb668-3"><a href="相关性与相似性.html#cb668-3" tabindex="-1"></a></span>
<span id="cb668-4"><a href="相关性与相似性.html#cb668-4" tabindex="-1"></a><span class="co"># 保守性状的系统发育树</span></span>
<span id="cb668-5"><a href="相关性与相似性.html#cb668-5" tabindex="-1"></a><span class="fu">plot</span>(phy_tree, <span class="at">show.tip.label =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;系统发育树&quot;</span>)</span>
<span id="cb668-6"><a href="相关性与相似性.html#cb668-6" tabindex="-1"></a></span>
<span id="cb668-7"><a href="相关性与相似性.html#cb668-7" tabindex="-1"></a><span class="co"># 保守性状在系统发育树上的分布</span></span>
<span id="cb668-8"><a href="相关性与相似性.html#cb668-8" tabindex="-1"></a>trait_colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>))(<span class="dv">100</span>)</span>
<span id="cb668-9"><a href="相关性与相似性.html#cb668-9" tabindex="-1"></a>trait_conservative_scaled <span class="ot">&lt;-</span> (trait_conservative <span class="sc">-</span> <span class="fu">min</span>(trait_conservative)) <span class="sc">/</span></span>
<span id="cb668-10"><a href="相关性与相似性.html#cb668-10" tabindex="-1"></a>  (<span class="fu">max</span>(trait_conservative) <span class="sc">-</span> <span class="fu">min</span>(trait_conservative))</span>
<span id="cb668-11"><a href="相关性与相似性.html#cb668-11" tabindex="-1"></a></span>
<span id="cb668-12"><a href="相关性与相似性.html#cb668-12" tabindex="-1"></a><span class="fu">plot</span>(phy_tree,</span>
<span id="cb668-13"><a href="相关性与相似性.html#cb668-13" tabindex="-1"></a>  <span class="at">show.tip.label =</span> <span class="cn">FALSE</span>,</span>
<span id="cb668-14"><a href="相关性与相似性.html#cb668-14" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;保守性状的系统发育信号&quot;</span></span>
<span id="cb668-15"><a href="相关性与相似性.html#cb668-15" tabindex="-1"></a>)</span>
<span id="cb668-16"><a href="相关性与相似性.html#cb668-16" tabindex="-1"></a><span class="fu">tiplabels</span>(<span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> trait_colors[<span class="fu">round</span>(trait_conservative_scaled <span class="sc">*</span> <span class="dv">99</span>) <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb668-17"><a href="相关性与相似性.html#cb668-17" tabindex="-1"></a></span>
<span id="cb668-18"><a href="相关性与相似性.html#cb668-18" tabindex="-1"></a><span class="co"># 随机性状在系统发育树上的分布</span></span>
<span id="cb668-19"><a href="相关性与相似性.html#cb668-19" tabindex="-1"></a>trait_random_scaled <span class="ot">&lt;-</span> (trait_random <span class="sc">-</span> <span class="fu">min</span>(trait_random)) <span class="sc">/</span></span>
<span id="cb668-20"><a href="相关性与相似性.html#cb668-20" tabindex="-1"></a>  (<span class="fu">max</span>(trait_random) <span class="sc">-</span> <span class="fu">min</span>(trait_random))</span>
<span id="cb668-21"><a href="相关性与相似性.html#cb668-21" tabindex="-1"></a></span>
<span id="cb668-22"><a href="相关性与相似性.html#cb668-22" tabindex="-1"></a><span class="fu">plot</span>(phy_tree,</span>
<span id="cb668-23"><a href="相关性与相似性.html#cb668-23" tabindex="-1"></a>  <span class="at">show.tip.label =</span> <span class="cn">FALSE</span>,</span>
<span id="cb668-24"><a href="相关性与相似性.html#cb668-24" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;随机性状的系统发育信号&quot;</span></span>
<span id="cb668-25"><a href="相关性与相似性.html#cb668-25" tabindex="-1"></a>)</span>
<span id="cb668-26"><a href="相关性与相似性.html#cb668-26" tabindex="-1"></a><span class="fu">tiplabels</span>(<span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> trait_colors[<span class="fu">round</span>(trait_random_scaled <span class="sc">*</span> <span class="dv">99</span>) <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb668-27"><a href="相关性与相似性.html#cb668-27" tabindex="-1"></a></span>
<span id="cb668-28"><a href="相关性与相似性.html#cb668-28" tabindex="-1"></a><span class="co"># 性状值与系统发育距离的关系</span></span>
<span id="cb668-29"><a href="相关性与相似性.html#cb668-29" tabindex="-1"></a><span class="co"># 计算系统发育距离矩阵</span></span>
<span id="cb668-30"><a href="相关性与相似性.html#cb668-30" tabindex="-1"></a>phy_dist <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(phy_tree)</span>
<span id="cb668-31"><a href="相关性与相似性.html#cb668-31" tabindex="-1"></a></span>
<span id="cb668-32"><a href="相关性与相似性.html#cb668-32" tabindex="-1"></a><span class="co"># 保守性状的距离相关性</span></span>
<span id="cb668-33"><a href="相关性与相似性.html#cb668-33" tabindex="-1"></a>conservative_dist <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(trait_conservative))</span>
<span id="cb668-34"><a href="相关性与相似性.html#cb668-34" tabindex="-1"></a>conservative_cor <span class="ot">&lt;-</span> <span class="fu">mantel</span>(conservative_dist, phy_dist, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb668-35"><a href="相关性与相似性.html#cb668-35" tabindex="-1"></a></span>
<span id="cb668-36"><a href="相关性与相似性.html#cb668-36" tabindex="-1"></a><span class="co"># 随机性状的距离相关性</span></span>
<span id="cb668-37"><a href="相关性与相似性.html#cb668-37" tabindex="-1"></a>random_dist <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(trait_random))</span>
<span id="cb668-38"><a href="相关性与相似性.html#cb668-38" tabindex="-1"></a>random_cor <span class="ot">&lt;-</span> <span class="fu">mantel</span>(random_dist, phy_dist, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb668-39"><a href="相关性与相似性.html#cb668-39" tabindex="-1"></a></span>
<span id="cb668-40"><a href="相关性与相似性.html#cb668-40" tabindex="-1"></a><span class="fu">plot</span>(phy_dist[<span class="fu">lower.tri</span>(phy_dist)], conservative_dist[<span class="fu">lower.tri</span>(conservative_dist)],</span>
<span id="cb668-41"><a href="相关性与相似性.html#cb668-41" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;blue&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.5</span>),</span>
<span id="cb668-42"><a href="相关性与相似性.html#cb668-42" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;系统发育距离&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;性状距离&quot;</span>,</span>
<span id="cb668-43"><a href="相关性与相似性.html#cb668-43" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;性状距离与系统发育距离的关系&quot;</span></span>
<span id="cb668-44"><a href="相关性与相似性.html#cb668-44" tabindex="-1"></a>)</span>
<span id="cb668-45"><a href="相关性与相似性.html#cb668-45" tabindex="-1"></a><span class="fu">points</span>(phy_dist[<span class="fu">lower.tri</span>(phy_dist)], random_dist[<span class="fu">lower.tri</span>(random_dist)],</span>
<span id="cb668-46"><a href="相关性与相似性.html#cb668-46" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;red&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.5</span>)</span>
<span id="cb668-47"><a href="相关性与相似性.html#cb668-47" tabindex="-1"></a>)</span>
<span id="cb668-48"><a href="相关性与相似性.html#cb668-48" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb668-49"><a href="相关性与相似性.html#cb668-49" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;保守性状&quot;</span>, <span class="st">&quot;随机性状&quot;</span>),</span>
<span id="cb668-50"><a href="相关性与相似性.html#cb668-50" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb668-51"><a href="相关性与相似性.html#cb668-51" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-27"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-27-1.png" alt="植物叶片性状的系统发育信号分析和性状距离关系" width="672" />
<p class="caption">
图2.17: 植物叶片性状的系统发育信号分析和性状距离关系
</p>
</div>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="相关性与相似性.html#cb669-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Mantel检验结果：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb669-2"><a href="相关性与相似性.html#cb669-2" tabindex="-1"></a>    <span class="st">&quot;保守性状的Mantel r：&quot;</span>, <span class="fu">round</span>(conservative_cor<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb669-3"><a href="相关性与相似性.html#cb669-3" tabindex="-1"></a>    <span class="st">&quot;保守性状的p值：&quot;</span>, <span class="fu">format.pval</span>(conservative_cor<span class="sc">$</span>signif, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb669-4"><a href="相关性与相似性.html#cb669-4" tabindex="-1"></a>    <span class="st">&quot;随机性状的Mantel r：&quot;</span>, <span class="fu">round</span>(random_cor<span class="sc">$</span>statistic, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb669-5"><a href="相关性与相似性.html#cb669-5" tabindex="-1"></a>    <span class="st">&quot;随机性状的p值：&quot;</span>, <span class="fu">format.pval</span>(random_cor<span class="sc">$</span>signif, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb669-6"><a href="相关性与相似性.html#cb669-6" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Mantel检验结果：
## 保守性状的Mantel r：0.337
## 保守性状的p值：0.001
## 随机性状的Mantel r：-0.021
## 随机性状的p值：0.659</code></pre>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="相关性与相似性.html#cb671-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb671-2"><a href="相关性与相似性.html#cb671-2" tabindex="-1"></a></span>
<span id="cb671-3"><a href="相关性与相似性.html#cb671-3" tabindex="-1"></a><span class="co"># 比较不同系统发育信号度量方法</span></span>
<span id="cb671-4"><a href="相关性与相似性.html#cb671-4" tabindex="-1"></a>signal_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb671-5"><a href="相关性与相似性.html#cb671-5" tabindex="-1"></a>  性状类型 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;保守性状&quot;</span>, <span class="st">&quot;随机性状&quot;</span>),</span>
<span id="cb671-6"><a href="相关性与相似性.html#cb671-6" tabindex="-1"></a>  <span class="at">Blomberg_K =</span> <span class="fu">c</span>(K_conservative, K_random),</span>
<span id="cb671-7"><a href="相关性与相似性.html#cb671-7" tabindex="-1"></a>  <span class="at">Pagel_lambda =</span> <span class="fu">c</span>(lambda_conservative<span class="sc">$</span>lambda, lambda_random<span class="sc">$</span>lambda),</span>
<span id="cb671-8"><a href="相关性与相似性.html#cb671-8" tabindex="-1"></a>  <span class="at">Mantel_r =</span> <span class="fu">c</span>(conservative_cor<span class="sc">$</span>statistic, random_cor<span class="sc">$</span>statistic)</span>
<span id="cb671-9"><a href="相关性与相似性.html#cb671-9" tabindex="-1"></a>)</span>
<span id="cb671-10"><a href="相关性与相似性.html#cb671-10" tabindex="-1"></a></span>
<span id="cb671-11"><a href="相关性与相似性.html#cb671-11" tabindex="-1"></a><span class="fu">print</span>(signal_comparison)</span></code></pre></div>
<pre><code>##   性状类型 Blomberg_K Pagel_lambda    Mantel_r
## 1 保守性状   1.103624 9.999267e-01  0.33677725
## 2 随机性状   0.168321 7.331374e-05 -0.02144895</code></pre>
<p><strong>生态学意义</strong>：系统发育信号分析在生态学中广泛应用于检验性状的系统发育保守性，理解功能性状的进化动态，以及确保生态关系的统计检验不受系统发育非独立性的影响。</p>
</div>
<div id="系统发育独立对比去除系统发育影响的性状比较" class="section level3 hasAnchor" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> 系统发育独立对比：去除系统发育影响的性状比较<a href="相关性与相似性.html#系统发育独立对比去除系统发育影响的性状比较" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在研究植物叶片氮含量与光合速率的关系时，我们需要考虑物种间的系统发育关系，因为亲缘关系较近的物种可能共享相似的性状值，这种系统发育非独立性可能使传统的相关性分析产生偏差。</p>
<p>系统发育独立对比是由Felsenstein于1985年提出的革命性方法，它通过将系统发育树转化为一组独立的对比来去除系统发育非独立性的影响。PIC方法的核心思想是：在系统发育树的每个节点处，计算从该节点分化的两个支系之间的性状差异，这些差异构成了系统发育独立对比。由于这些对比在统计上是独立的（每个对比代表系统发育树上的一个独立进化事件），它们可以安全地用于传统的统计检验，而不受系统发育非独立性的影响。</p>
<p>PIC的计算过程包括以下几个步骤：首先，从系统发育树的尖端开始，逐步向根部计算每个节点处的性状对比；其次，对每个对比进行标准化，以考虑分支长度的影响；最后，这些标准化的对比可以用于回归分析、相关性分析或其他统计检验。PIC方法的一个重要假设是性状进化符合布朗运动模型，即性状在系统发育树上的变化是随机的、无方向的。</p>
<p>在生态学研究中，PIC方法具有极其重要的应用价值。它使得我们能够在控制系统发育关系的情况下，检验性状间的生态关系、评估环境对性状的影响、以及比较不同类群的进化速率。例如，在使用PIC分析叶片氮含量与光合速率的关系时，如果去除系统发育影响后两者仍然显著相关，说明这种关系具有普遍的生态意义，而不仅仅是系统发育历史的产物。PIC方法还广泛应用于比较生物学、进化生态学和功能生态学的研究中。</p>
<p>然而，PIC方法也有一些局限性和注意事项。它假设性状进化符合布朗运动模型，对于其他进化模型可能不适用；它对于高度不平衡的系统发育树可能表现不佳；此外，PIC方法只能用于连续性状的分析。近年来，随着系统发育比较方法的发展，出现了更多先进的方法（如系统发育广义最小二乘法PGLS），但PIC仍然是理解系统发育非独立性影响的基础工具。</p>
<p><strong>数学原理</strong>：对于系统发育树上的一个节点，其两个子节点<span class="math inline">\(i\)</span>和<span class="math inline">\(j\)</span>的性状对比为：</p>
<p><span class="math display">\[contrast = \frac{x_i - x_j}{\sqrt{v_i + v_j}}\]</span></p>
<p>其中<span class="math inline">\(x_i\)</span>和<span class="math inline">\(x_j\)</span>是性状值，<span class="math inline">\(v_i\)</span>和<span class="math inline">\(v_j\)</span>是分支长度。</p>
<p><strong>R代码实现</strong>：</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="相关性与相似性.html#cb673-1" tabindex="-1"></a><span class="co"># 系统发育独立对比示例：植物叶片性状的生态关系</span></span>
<span id="cb673-2"><a href="相关性与相似性.html#cb673-2" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb673-3"><a href="相关性与相似性.html#cb673-3" tabindex="-1"></a><span class="fu">library</span>(picante)</span>
<span id="cb673-4"><a href="相关性与相似性.html#cb673-4" tabindex="-1"></a></span>
<span id="cb673-5"><a href="相关性与相似性.html#cb673-5" tabindex="-1"></a><span class="co"># 模拟系统发育树和多个性状数据</span></span>
<span id="cb673-6"><a href="相关性与相似性.html#cb673-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb673-7"><a href="相关性与相似性.html#cb673-7" tabindex="-1"></a></span>
<span id="cb673-8"><a href="相关性与相似性.html#cb673-8" tabindex="-1"></a><span class="co"># 生成随机系统发育树（30个物种）</span></span>
<span id="cb673-9"><a href="相关性与相似性.html#cb673-9" tabindex="-1"></a>n_species <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb673-10"><a href="相关性与相似性.html#cb673-10" tabindex="-1"></a>phy_tree <span class="ot">&lt;-</span> <span class="fu">rtree</span>(n_species)</span>
<span id="cb673-11"><a href="相关性与相似性.html#cb673-11" tabindex="-1"></a></span>
<span id="cb673-12"><a href="相关性与相似性.html#cb673-12" tabindex="-1"></a><span class="co"># 模拟相关的性状数据（具有系统发育信号）</span></span>
<span id="cb673-13"><a href="相关性与相似性.html#cb673-13" tabindex="-1"></a><span class="co"># 性状1：叶片氮含量</span></span>
<span id="cb673-14"><a href="相关性与相似性.html#cb673-14" tabindex="-1"></a>trait_nitrogen <span class="ot">&lt;-</span> <span class="fu">rTraitCont</span>(phy_tree, <span class="at">model =</span> <span class="st">&quot;BM&quot;</span>, <span class="at">sigma =</span> <span class="fl">0.5</span>)</span>
<span id="cb673-15"><a href="相关性与相似性.html#cb673-15" tabindex="-1"></a></span>
<span id="cb673-16"><a href="相关性与相似性.html#cb673-16" tabindex="-1"></a><span class="co"># 性状2：光合速率（与氮含量相关，但也受其他因素影响）</span></span>
<span id="cb673-17"><a href="相关性与相似性.html#cb673-17" tabindex="-1"></a>trait_photosynthesis <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> trait_nitrogen <span class="sc">+</span> <span class="fu">rTraitCont</span>(phy_tree, <span class="at">model =</span> <span class="st">&quot;BM&quot;</span>, <span class="at">sigma =</span> <span class="fl">0.3</span>)</span>
<span id="cb673-18"><a href="相关性与相似性.html#cb673-18" tabindex="-1"></a></span>
<span id="cb673-19"><a href="相关性与相似性.html#cb673-19" tabindex="-1"></a><span class="co"># 性状3：比叶重（与氮含量负相关）</span></span>
<span id="cb673-20"><a href="相关性与相似性.html#cb673-20" tabindex="-1"></a>trait_sla <span class="ot">&lt;-</span> <span class="dv">200</span> <span class="sc">-</span> <span class="dv">15</span> <span class="sc">*</span> trait_nitrogen <span class="sc">+</span> <span class="fu">rTraitCont</span>(phy_tree, <span class="at">model =</span> <span class="st">&quot;BM&quot;</span>, <span class="at">sigma =</span> <span class="dv">2</span>)</span>
<span id="cb673-21"><a href="相关性与相似性.html#cb673-21" tabindex="-1"></a></span>
<span id="cb673-22"><a href="相关性与相似性.html#cb673-22" tabindex="-1"></a><span class="co"># 创建性状数据框</span></span>
<span id="cb673-23"><a href="相关性与相似性.html#cb673-23" tabindex="-1"></a>trait_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb673-24"><a href="相关性与相似性.html#cb673-24" tabindex="-1"></a>  <span class="at">species =</span> phy_tree<span class="sc">$</span>tip.label,</span>
<span id="cb673-25"><a href="相关性与相似性.html#cb673-25" tabindex="-1"></a>  <span class="at">nitrogen =</span> trait_nitrogen,</span>
<span id="cb673-26"><a href="相关性与相似性.html#cb673-26" tabindex="-1"></a>  <span class="at">photosynthesis =</span> trait_photosynthesis,</span>
<span id="cb673-27"><a href="相关性与相似性.html#cb673-27" tabindex="-1"></a>  <span class="at">sla =</span> trait_sla</span>
<span id="cb673-28"><a href="相关性与相似性.html#cb673-28" tabindex="-1"></a>)</span>
<span id="cb673-29"><a href="相关性与相似性.html#cb673-29" tabindex="-1"></a></span>
<span id="cb673-30"><a href="相关性与相似性.html#cb673-30" tabindex="-1"></a><span class="co"># 传统相关性分析（忽略系统发育）</span></span>
<span id="cb673-31"><a href="相关性与相似性.html#cb673-31" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;传统相关性分析（忽略系统发育）：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 传统相关性分析（忽略系统发育）：</code></pre>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="相关性与相似性.html#cb675-1" tabindex="-1"></a>cor_traditional <span class="ot">&lt;-</span> <span class="fu">cor</span>(trait_data[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb675-2"><a href="相关性与相似性.html#cb675-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(cor_traditional, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##                nitrogen photosynthesis    sla
## nitrogen          1.000          0.497 -0.967
## photosynthesis    0.497          1.000 -0.368
## sla              -0.967         -0.368  1.000</code></pre>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="相关性与相似性.html#cb677-1" tabindex="-1"></a><span class="co"># 进行相关性检验</span></span>
<span id="cb677-2"><a href="相关性与相似性.html#cb677-2" tabindex="-1"></a>cor_test_np <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(trait_data<span class="sc">$</span>nitrogen, trait_data<span class="sc">$</span>photosynthesis)</span>
<span id="cb677-3"><a href="相关性与相似性.html#cb677-3" tabindex="-1"></a>cor_test_ns <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(trait_data<span class="sc">$</span>nitrogen, trait_data<span class="sc">$</span>sla)</span>
<span id="cb677-4"><a href="相关性与相似性.html#cb677-4" tabindex="-1"></a></span>
<span id="cb677-5"><a href="相关性与相似性.html#cb677-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">传统相关性检验：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb677-6"><a href="相关性与相似性.html#cb677-6" tabindex="-1"></a>    <span class="st">&quot;氮含量 vs 光合速率：r =&quot;</span>, <span class="fu">round</span>(cor_test_np<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb677-7"><a href="相关性与相似性.html#cb677-7" tabindex="-1"></a>    <span class="st">&quot;, p =&quot;</span>, <span class="fu">format.pval</span>(cor_test_np<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb677-8"><a href="相关性与相似性.html#cb677-8" tabindex="-1"></a>    <span class="st">&quot;氮含量 vs 比叶重：r =&quot;</span>, <span class="fu">round</span>(cor_test_ns<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb677-9"><a href="相关性与相似性.html#cb677-9" tabindex="-1"></a>    <span class="st">&quot;, p =&quot;</span>, <span class="fu">format.pval</span>(cor_test_ns<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb677-10"><a href="相关性与相似性.html#cb677-10" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 传统相关性检验：
## 氮含量 vs 光合速率：r =0.497, p =0.00519
## 氮含量 vs 比叶重：r =-0.967, p =&lt;2e-16</code></pre>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="相关性与相似性.html#cb679-1" tabindex="-1"></a><span class="co"># 系统发育独立对比分析</span></span>
<span id="cb679-2"><a href="相关性与相似性.html#cb679-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">系统发育独立对比分析：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 系统发育独立对比分析：</code></pre>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="相关性与相似性.html#cb681-1" tabindex="-1"></a><span class="co"># 计算PIC</span></span>
<span id="cb681-2"><a href="相关性与相似性.html#cb681-2" tabindex="-1"></a>pic_nitrogen <span class="ot">&lt;-</span> <span class="fu">pic</span>(trait_nitrogen, phy_tree)</span>
<span id="cb681-3"><a href="相关性与相似性.html#cb681-3" tabindex="-1"></a>pic_photosynthesis <span class="ot">&lt;-</span> <span class="fu">pic</span>(trait_photosynthesis, phy_tree)</span>
<span id="cb681-4"><a href="相关性与相似性.html#cb681-4" tabindex="-1"></a>pic_sla <span class="ot">&lt;-</span> <span class="fu">pic</span>(trait_sla, phy_tree)</span>
<span id="cb681-5"><a href="相关性与相似性.html#cb681-5" tabindex="-1"></a></span>
<span id="cb681-6"><a href="相关性与相似性.html#cb681-6" tabindex="-1"></a><span class="co"># PIC相关性分析</span></span>
<span id="cb681-7"><a href="相关性与相似性.html#cb681-7" tabindex="-1"></a>pic_cor_np <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(pic_nitrogen, pic_photosynthesis)</span>
<span id="cb681-8"><a href="相关性与相似性.html#cb681-8" tabindex="-1"></a>pic_cor_ns <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(pic_nitrogen, pic_sla)</span>
<span id="cb681-9"><a href="相关性与相似性.html#cb681-9" tabindex="-1"></a></span>
<span id="cb681-10"><a href="相关性与相似性.html#cb681-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;PIC相关性检验：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb681-11"><a href="相关性与相似性.html#cb681-11" tabindex="-1"></a>    <span class="st">&quot;氮含量 vs 光合速率：r =&quot;</span>, <span class="fu">round</span>(pic_cor_np<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb681-12"><a href="相关性与相似性.html#cb681-12" tabindex="-1"></a>    <span class="st">&quot;, p =&quot;</span>, <span class="fu">format.pval</span>(pic_cor_np<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb681-13"><a href="相关性与相似性.html#cb681-13" tabindex="-1"></a>    <span class="st">&quot;氮含量 vs 比叶重：r =&quot;</span>, <span class="fu">round</span>(pic_cor_ns<span class="sc">$</span>estimate, <span class="dv">3</span>),</span>
<span id="cb681-14"><a href="相关性与相似性.html#cb681-14" tabindex="-1"></a>    <span class="st">&quot;, p =&quot;</span>, <span class="fu">format.pval</span>(pic_cor_ns<span class="sc">$</span>p.value, <span class="at">digits =</span> <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb681-15"><a href="相关性与相似性.html#cb681-15" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## PIC相关性检验：
## 氮含量 vs 光合速率：r =0.597, p =0.000635
## 氮含量 vs 比叶重：r =-0.92, p =1.78e-12</code></pre>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="相关性与相似性.html#cb683-1" tabindex="-1"></a><span class="co"># 可视化对比结果</span></span>
<span id="cb683-2"><a href="相关性与相似性.html#cb683-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb683-3"><a href="相关性与相似性.html#cb683-3" tabindex="-1"></a></span>
<span id="cb683-4"><a href="相关性与相似性.html#cb683-4" tabindex="-1"></a><span class="co"># 传统散点图</span></span>
<span id="cb683-5"><a href="相关性与相似性.html#cb683-5" tabindex="-1"></a><span class="fu">plot</span>(trait_data<span class="sc">$</span>nitrogen, trait_data<span class="sc">$</span>photosynthesis,</span>
<span id="cb683-6"><a href="相关性与相似性.html#cb683-6" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb683-7"><a href="相关性与相似性.html#cb683-7" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;叶片氮含量 (%)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;光合速率 (μmol/m²/s)&quot;</span>,</span>
<span id="cb683-8"><a href="相关性与相似性.html#cb683-8" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;传统分析：氮含量 vs 光合速率&quot;</span></span>
<span id="cb683-9"><a href="相关性与相似性.html#cb683-9" tabindex="-1"></a>)</span>
<span id="cb683-10"><a href="相关性与相似性.html#cb683-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(photosynthesis <span class="sc">~</span> nitrogen, <span class="at">data =</span> trait_data),</span>
<span id="cb683-11"><a href="相关性与相似性.html#cb683-11" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb683-12"><a href="相关性与相似性.html#cb683-12" tabindex="-1"></a>)</span>
<span id="cb683-13"><a href="相关性与相似性.html#cb683-13" tabindex="-1"></a></span>
<span id="cb683-14"><a href="相关性与相似性.html#cb683-14" tabindex="-1"></a><span class="co"># PIC散点图</span></span>
<span id="cb683-15"><a href="相关性与相似性.html#cb683-15" tabindex="-1"></a><span class="fu">plot</span>(pic_nitrogen, pic_photosynthesis,</span>
<span id="cb683-16"><a href="相关性与相似性.html#cb683-16" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>,</span>
<span id="cb683-17"><a href="相关性与相似性.html#cb683-17" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;氮含量PIC&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;光合速率PIC&quot;</span>,</span>
<span id="cb683-18"><a href="相关性与相似性.html#cb683-18" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;PIC分析：氮含量 vs 光合速率&quot;</span></span>
<span id="cb683-19"><a href="相关性与相似性.html#cb683-19" tabindex="-1"></a>)</span>
<span id="cb683-20"><a href="相关性与相似性.html#cb683-20" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(pic_photosynthesis <span class="sc">~</span> pic_nitrogen),</span>
<span id="cb683-21"><a href="相关性与相似性.html#cb683-21" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb683-22"><a href="相关性与相似性.html#cb683-22" tabindex="-1"></a>)</span>
<span id="cb683-23"><a href="相关性与相似性.html#cb683-23" tabindex="-1"></a></span>
<span id="cb683-24"><a href="相关性与相似性.html#cb683-24" tabindex="-1"></a><span class="co"># 传统散点图：氮含量 vs 比叶重</span></span>
<span id="cb683-25"><a href="相关性与相似性.html#cb683-25" tabindex="-1"></a><span class="fu">plot</span>(trait_data<span class="sc">$</span>nitrogen, trait_data<span class="sc">$</span>sla,</span>
<span id="cb683-26"><a href="相关性与相似性.html#cb683-26" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>,</span>
<span id="cb683-27"><a href="相关性与相似性.html#cb683-27" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;叶片氮含量 (%)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;比叶重 (g/m²)&quot;</span>,</span>
<span id="cb683-28"><a href="相关性与相似性.html#cb683-28" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;传统分析：氮含量 vs 比叶重&quot;</span></span>
<span id="cb683-29"><a href="相关性与相似性.html#cb683-29" tabindex="-1"></a>)</span>
<span id="cb683-30"><a href="相关性与相似性.html#cb683-30" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(sla <span class="sc">~</span> nitrogen, <span class="at">data =</span> trait_data),</span>
<span id="cb683-31"><a href="相关性与相似性.html#cb683-31" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb683-32"><a href="相关性与相似性.html#cb683-32" tabindex="-1"></a>)</span>
<span id="cb683-33"><a href="相关性与相似性.html#cb683-33" tabindex="-1"></a></span>
<span id="cb683-34"><a href="相关性与相似性.html#cb683-34" tabindex="-1"></a><span class="co"># PIC散点图：氮含量 vs 比叶重</span></span>
<span id="cb683-35"><a href="相关性与相似性.html#cb683-35" tabindex="-1"></a><span class="fu">plot</span>(pic_nitrogen, pic_sla,</span>
<span id="cb683-36"><a href="相关性与相似性.html#cb683-36" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb683-37"><a href="相关性与相似性.html#cb683-37" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;氮含量PIC&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;比叶重PIC&quot;</span>,</span>
<span id="cb683-38"><a href="相关性与相似性.html#cb683-38" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;PIC分析：氮含量 vs 比叶重&quot;</span></span>
<span id="cb683-39"><a href="相关性与相似性.html#cb683-39" tabindex="-1"></a>)</span>
<span id="cb683-40"><a href="相关性与相似性.html#cb683-40" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(pic_sla <span class="sc">~</span> pic_nitrogen),</span>
<span id="cb683-41"><a href="相关性与相似性.html#cb683-41" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb683-42"><a href="相关性与相似性.html#cb683-42" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-28-1"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-28-1.png" alt="植物叶片性状的系统发育独立对比分析和性状关系" width="672" />
<p class="caption">
图5.37: 植物叶片性状的系统发育独立对比分析和性状关系
</p>
</div>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="相关性与相似性.html#cb684-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb684-2"><a href="相关性与相似性.html#cb684-2" tabindex="-1"></a></span>
<span id="cb684-3"><a href="相关性与相似性.html#cb684-3" tabindex="-1"></a><span class="co"># 比较传统分析和PIC分析的结果</span></span>
<span id="cb684-4"><a href="相关性与相似性.html#cb684-4" tabindex="-1"></a>results_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb684-5"><a href="相关性与相似性.html#cb684-5" tabindex="-1"></a>  关系 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;氮含量-光合速率&quot;</span>, <span class="st">&quot;氮含量-比叶重&quot;</span>),</span>
<span id="cb684-6"><a href="相关性与相似性.html#cb684-6" tabindex="-1"></a>  传统<span class="at">_r =</span> <span class="fu">c</span>(cor_test_np<span class="sc">$</span>estimate, cor_test_ns<span class="sc">$</span>estimate),</span>
<span id="cb684-7"><a href="相关性与相似性.html#cb684-7" tabindex="-1"></a>  传统<span class="at">_p =</span> <span class="fu">c</span>(cor_test_np<span class="sc">$</span>p.value, cor_test_ns<span class="sc">$</span>p.value),</span>
<span id="cb684-8"><a href="相关性与相似性.html#cb684-8" tabindex="-1"></a>  <span class="at">PIC_r =</span> <span class="fu">c</span>(pic_cor_np<span class="sc">$</span>estimate, pic_cor_ns<span class="sc">$</span>estimate),</span>
<span id="cb684-9"><a href="相关性与相似性.html#cb684-9" tabindex="-1"></a>  <span class="at">PIC_p =</span> <span class="fu">c</span>(pic_cor_np<span class="sc">$</span>p.value, pic_cor_ns<span class="sc">$</span>p.value)</span>
<span id="cb684-10"><a href="相关性与相似性.html#cb684-10" tabindex="-1"></a>)</span>
<span id="cb684-11"><a href="相关性与相似性.html#cb684-11" tabindex="-1"></a></span>
<span id="cb684-12"><a href="相关性与相似性.html#cb684-12" tabindex="-1"></a><span class="co"># 只对数值列进行四舍五入</span></span>
<span id="cb684-13"><a href="相关性与相似性.html#cb684-13" tabindex="-1"></a>results_comparison[, <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">round</span>(results_comparison[, <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">4</span>)</span>
<span id="cb684-14"><a href="相关性与相似性.html#cb684-14" tabindex="-1"></a><span class="fu">print</span>(results_comparison)</span></code></pre></div>
<pre><code>##              关系  传统_r 传统_p   PIC_r PIC_p
## 1 氮含量-光合速率  0.4971 0.0052  0.5966 6e-04
## 2   氮含量-比叶重 -0.9670 0.0000 -0.9197 0e+00</code></pre>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="相关性与相似性.html#cb686-1" tabindex="-1"></a><span class="co"># 注意：PGLS分析需要caper包，这里为了简化暂时跳过</span></span>
<span id="cb686-2"><a href="相关性与相似性.html#cb686-2" tabindex="-1"></a><span class="co"># 有兴趣的读者可以自行安装caper包并运行以下代码：</span></span>
<span id="cb686-3"><a href="相关性与相似性.html#cb686-3" tabindex="-1"></a><span class="co"># library(caper)</span></span>
<span id="cb686-4"><a href="相关性与相似性.html#cb686-4" tabindex="-1"></a><span class="co"># comp_data &lt;- comparative.data(phy_tree, trait_data, names.col = &quot;species&quot;)</span></span>
<span id="cb686-5"><a href="相关性与相似性.html#cb686-5" tabindex="-1"></a><span class="co"># pgls_np &lt;- gls(photosynthesis ~ nitrogen, data = comp_data$data, correlation = corBrownian(phy = comp_data$phy))</span></span>
<span id="cb686-6"><a href="相关性与相似性.html#cb686-6" tabindex="-1"></a><span class="co"># pgls_ns &lt;- gls(sla ~ nitrogen, data = comp_data$data, correlation = corBrownian(phy = comp_data$phy))</span></span>
<span id="cb686-7"><a href="相关性与相似性.html#cb686-7" tabindex="-1"></a><span class="co"># print(summary(pgls_np))</span></span>
<span id="cb686-8"><a href="相关性与相似性.html#cb686-8" tabindex="-1"></a><span class="co"># print(summary(pgls_ns))</span></span>
<span id="cb686-9"><a href="相关性与相似性.html#cb686-9" tabindex="-1"></a></span>
<span id="cb686-10"><a href="相关性与相似性.html#cb686-10" tabindex="-1"></a><span class="co"># 可视化系统发育树和性状</span></span>
<span id="cb686-11"><a href="相关性与相似性.html#cb686-11" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb686-12"><a href="相关性与相似性.html#cb686-12" tabindex="-1"></a></span>
<span id="cb686-13"><a href="相关性与相似性.html#cb686-13" tabindex="-1"></a><span class="co"># 氮含量在系统发育树上的分布</span></span>
<span id="cb686-14"><a href="相关性与相似性.html#cb686-14" tabindex="-1"></a><span class="fu">plot</span>(phy_tree, <span class="at">show.tip.label =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;叶片氮含量的系统发育分布&quot;</span>)</span>
<span id="cb686-15"><a href="相关性与相似性.html#cb686-15" tabindex="-1"></a>nitrogen_colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>))(<span class="dv">100</span>)</span>
<span id="cb686-16"><a href="相关性与相似性.html#cb686-16" tabindex="-1"></a>nitrogen_scaled <span class="ot">&lt;-</span> (trait_nitrogen <span class="sc">-</span> <span class="fu">min</span>(trait_nitrogen)) <span class="sc">/</span></span>
<span id="cb686-17"><a href="相关性与相似性.html#cb686-17" tabindex="-1"></a>  (<span class="fu">max</span>(trait_nitrogen) <span class="sc">-</span> <span class="fu">min</span>(trait_nitrogen))</span>
<span id="cb686-18"><a href="相关性与相似性.html#cb686-18" tabindex="-1"></a><span class="fu">tiplabels</span>(<span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> nitrogen_colors[<span class="fu">round</span>(nitrogen_scaled <span class="sc">*</span> <span class="dv">99</span>) <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb686-19"><a href="相关性与相似性.html#cb686-19" tabindex="-1"></a></span>
<span id="cb686-20"><a href="相关性与相似性.html#cb686-20" tabindex="-1"></a><span class="co"># 光合速率在系统发育树上的分布</span></span>
<span id="cb686-21"><a href="相关性与相似性.html#cb686-21" tabindex="-1"></a><span class="fu">plot</span>(phy_tree, <span class="at">show.tip.label =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;光合速率的系统发育分布&quot;</span>)</span>
<span id="cb686-22"><a href="相关性与相似性.html#cb686-22" tabindex="-1"></a>photosynthesis_colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>))(<span class="dv">100</span>)</span>
<span id="cb686-23"><a href="相关性与相似性.html#cb686-23" tabindex="-1"></a>photosynthesis_scaled <span class="ot">&lt;-</span> (trait_photosynthesis <span class="sc">-</span> <span class="fu">min</span>(trait_photosynthesis)) <span class="sc">/</span></span>
<span id="cb686-24"><a href="相关性与相似性.html#cb686-24" tabindex="-1"></a>  (<span class="fu">max</span>(trait_photosynthesis) <span class="sc">-</span> <span class="fu">min</span>(trait_photosynthesis))</span>
<span id="cb686-25"><a href="相关性与相似性.html#cb686-25" tabindex="-1"></a><span class="fu">tiplabels</span>(<span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> photosynthesis_colors[<span class="fu">round</span>(photosynthesis_scaled <span class="sc">*</span> <span class="dv">99</span>) <span class="sc">+</span> <span class="dv">1</span>])</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-28-2"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-28-2.png" alt="植物叶片性状的系统发育独立对比分析和性状关系" width="672" />
<p class="caption">
图5.38: 植物叶片性状的系统发育独立对比分析和性状关系
</p>
</div>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="相关性与相似性.html#cb687-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><strong>生态学意义</strong>：系统发育独立对比分析在生态学中至关重要，它确保了性状间生态关系的统计检验不受系统发育非独立性的影响，为正确理解性状的进化关系和生态功能提供了可靠的方法。</p>
</div>
</div>
<div id="相似性与距离" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> 相似性与距离<a href="相关性与相似性.html#相似性与距离" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="常用相似性系数" class="section level3 hasAnchor" number="5.7.1">
<h3><span class="header-section-number">5.7.1</span> 常用相似性系数<a href="相关性与相似性.html#常用相似性系数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在生态学研究中，群落相似性分析是理解物种分布格局、群落构建机制以及环境梯度影响的关键工具。生态学家经常面临如何量化不同样地或群落之间相似程度的问题，这需要根据数据类型和研究目的选择合适的相似性系数。</p>
<p><strong>二元数据相似性</strong>：当生态数据仅记录物种存在与否时（如植物名录、动物分布记录），二元相似性系数是理想的选择。Jaccard系数是最经典的二元相似性度量，它计算两个群落共享物种数量占所有物种数量的比例，特别适用于比较物种组成相似性。其数学定义为：<span class="math inline">\(J = \frac{a}{a+b+c}\)</span>，其中<span class="math inline">\(a\)</span>为两个群落共有的物种数，<span class="math inline">\(b\)</span>和<span class="math inline">\(c\)</span>分别为各自特有的物种数。Sørensen系数则对物种丰富度更为敏感，其定义为：<span class="math inline">\(S = \frac{2a}{2a+b+c}\)</span>，在生态学调查中广泛用于评估β多样性。这些系数在保护生物学中尤为重要，例如评估不同保护区的物种重叠程度，或者在恢复生态学中监测群落演替过程中的物种组成变化。</p>
<p><strong>数量数据相似性</strong>：当生态数据包含物种多度信息时（如个体数量、生物量、盖度等），数量相似性系数能更准确地反映群落结构差异。Bray-Curtis距离是最常用的数量相似性度量，它考虑了物种的相对多度差异，对稀有物种不敏感而对常见物种变化敏感，非常适合分析群落梯度变化。其数学定义为：<span class="math inline">\(BC = 1 - \frac{2\sum \min(x_i, y_i)}{\sum x_i + \sum y_i}\)</span>，其中<span class="math inline">\(x_i\)</span>和<span class="math inline">\(y_i\)</span>分别表示两个群落中第<span class="math inline">\(i\)</span>个物种的多度。Morisita-Horn指数则对优势物种特别敏感，能有效识别群落中的优势种变化模式，在分析人为干扰或环境压力对群落结构的影响时具有独特优势。这些数量相似性系数在环境监测、污染生态学和全球变化生态学研究中广泛应用。</p>
<p><strong>距离度量</strong>：除了专门的生态学相似性系数，传统的统计距离度量在多元生态数据分析中也发挥重要作用。欧氏距离是最基础的几何距离，计算样本在多维空间中的直线距离，适用于环境因子数据的比较分析。Mahalanobis距离则考虑了变量间的协方差结构，能更准确地反映多元数据的真实差异，在生态位分析和环境梯度研究中特别有用。这些距离度量为生态学家提供了量化样本间差异的数学工具，支持各种多元统计分析方法如聚类分析、排序分析和判别分析的实施。</p>
<p>在R语言中，这些相似性系数的计算非常便捷。对于二元数据，可以使用<code>vegan</code>包中的<code>vegdist</code>函数计算Jaccard和Sørensen系数：</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="相关性与相似性.html#cb688-1" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb688-2"><a href="相关性与相似性.html#cb688-2" tabindex="-1"></a><span class="co"># 创建示例二元数据</span></span>
<span id="cb688-3"><a href="相关性与相似性.html#cb688-3" tabindex="-1"></a>binary_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb688-4"><a href="相关性与相似性.html#cb688-4" tabindex="-1"></a><span class="fu">rownames</span>(binary_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;样地A&quot;</span>, <span class="st">&quot;样地B&quot;</span>, <span class="st">&quot;样地C&quot;</span>)</span>
<span id="cb688-5"><a href="相关性与相似性.html#cb688-5" tabindex="-1"></a><span class="fu">colnames</span>(binary_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;物种1&quot;</span>, <span class="st">&quot;物种2&quot;</span>, <span class="st">&quot;物种3&quot;</span>, <span class="st">&quot;物种4&quot;</span>)</span>
<span id="cb688-6"><a href="相关性与相似性.html#cb688-6" tabindex="-1"></a></span>
<span id="cb688-7"><a href="相关性与相似性.html#cb688-7" tabindex="-1"></a><span class="co"># 计算Jaccard相似性</span></span>
<span id="cb688-8"><a href="相关性与相似性.html#cb688-8" tabindex="-1"></a>jaccard_dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(binary_data, <span class="at">method =</span> <span class="st">&quot;jaccard&quot;</span>, <span class="at">binary =</span> <span class="cn">TRUE</span>)</span>
<span id="cb688-9"><a href="相关性与相似性.html#cb688-9" tabindex="-1"></a><span class="co"># 计算Sørensen相似性</span></span>
<span id="cb688-10"><a href="相关性与相似性.html#cb688-10" tabindex="-1"></a>sorensen_dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(binary_data, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>, <span class="at">binary =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>对于数量数据，Bray-Curtis距离的计算同样使用<code>vegdist</code>函数：</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="相关性与相似性.html#cb689-1" tabindex="-1"></a><span class="co"># 创建示例数量数据</span></span>
<span id="cb689-2"><a href="相关性与相似性.html#cb689-2" tabindex="-1"></a>abundance_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">15</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">12</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb689-3"><a href="相关性与相似性.html#cb689-3" tabindex="-1"></a><span class="fu">rownames</span>(abundance_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;群落A&quot;</span>, <span class="st">&quot;群落B&quot;</span>, <span class="st">&quot;群落C&quot;</span>)</span>
<span id="cb689-4"><a href="相关性与相似性.html#cb689-4" tabindex="-1"></a><span class="fu">colnames</span>(abundance_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;物种1&quot;</span>, <span class="st">&quot;物种2&quot;</span>, <span class="st">&quot;物种3&quot;</span>, <span class="st">&quot;物种4&quot;</span>)</span>
<span id="cb689-5"><a href="相关性与相似性.html#cb689-5" tabindex="-1"></a></span>
<span id="cb689-6"><a href="相关性与相似性.html#cb689-6" tabindex="-1"></a><span class="co"># 计算Bray-Curtis距离</span></span>
<span id="cb689-7"><a href="相关性与相似性.html#cb689-7" tabindex="-1"></a>bray_curtis_dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(abundance_data, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span></code></pre></div>
<p>传统距离度量的计算可以使用基础R函数：</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="相关性与相似性.html#cb690-1" tabindex="-1"></a><span class="co"># 计算欧氏距离</span></span>
<span id="cb690-2"><a href="相关性与相似性.html#cb690-2" tabindex="-1"></a>euclidean_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(abundance_data, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb690-3"><a href="相关性与相似性.html#cb690-3" tabindex="-1"></a></span>
<span id="cb690-4"><a href="相关性与相似性.html#cb690-4" tabindex="-1"></a><span class="co"># 计算Mahalanobis距离（需要协方差矩阵）</span></span>
<span id="cb690-5"><a href="相关性与相似性.html#cb690-5" tabindex="-1"></a>cov_matrix <span class="ot">&lt;-</span> <span class="fu">cov</span>(abundance_data)</span>
<span id="cb690-6"><a href="相关性与相似性.html#cb690-6" tabindex="-1"></a><span class="co"># Mahalanobis距离计算较为复杂，通常用于多元统计分析</span></span></code></pre></div>
<p><strong>结果解释与生态学意义</strong>：理解相似性系数的数值含义对于正确解释生态学结果至关重要。对于相似性系数（如Jaccard、Sørensen），数值范围在0到1之间，数值越大表示群落间相似性越高。通常认为：<span class="math inline">\(J &gt; 0.75\)</span>表示高度相似，<span class="math inline">\(0.5 &lt; J \leq 0.75\)</span>表示中等相似，<span class="math inline">\(J \leq 0.5\)</span>表示低度相似。对于距离系数（如Bray-Curtis、欧氏距离），数值范围也在0到1之间（Bray-Curtis）或0到无穷大（欧氏距离），但数值越大表示差异越大。Bray-Curtis距离<span class="math inline">\(BC &lt; 0.3\)</span>通常表示群落结构相似，<span class="math inline">\(0.3 \leq BC &lt; 0.6\)</span>表示中等差异，<span class="math inline">\(BC \geq 0.6\)</span>表示显著差异。</p>
<p>在实际生态学研究中，相似性系数的解释需要考虑研究背景和生态学预期。例如，在环境梯度研究中，沿着梯度方向相似性系数的规律性变化可能反映了环境过滤的作用；在岛屿生物地理学中，距离主岛越远的岛屿与主岛的相似性越低，可能反映了扩散限制的影响。这些相似性系数和距离度量为生态学家提供了强大的工具来量化群落间的相似性和差异性，支持后续的聚类分析、排序分析等多元统计方法。</p>
</div>
<div id="功能性状间相关性" class="section level3 hasAnchor" number="5.7.2">
<h3><span class="header-section-number">5.7.2</span> 功能性状间相关性<a href="相关性与相似性.html#功能性状间相关性" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>功能性状相关性分析是功能生态学的核心内容，旨在揭示植物和其他生物在进化过程中形成的性状组合模式。这些相关模式反映了生物对环境适应的策略性选择，是理解生态位分化、群落构建和生态系统功能的关键。</p>
<p><strong>功能性状相关性</strong>：功能性状间的相关性分析主要关注两个重要方面：性状间的权衡关系和协变模式。性状权衡是指生物在资源有限条件下，对多个功能性状进行权衡取舍的进化策略。例如，植物在叶片构建上需要在光合速率和防御能力之间进行权衡，快速生长的物种通常具有较低的防御投资。这种权衡关系可以用负相关关系来表示，其数学表达为：<span class="math inline">\(r_{xy} = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2 \sum (y_i - \bar{y})^2}}\)</span>，其中<span class="math inline">\(x_i\)</span>和<span class="math inline">\(y_i\)</span>分别表示第<span class="math inline">\(i\)</span>个个体在两个性状上的测量值。</p>
<p>功能性状的协变模式则描述了多个性状如何协同变化，形成特定的功能综合征。例如，在干旱环境中，植物往往同时表现出深根系、厚角质层和小叶面积等性状组合。这些协变模式可以通过主成分分析或多变量回归等方法进行量化。生态学上，这些相关性反映了生物对不同环境压力的适应机制，如资源获取策略、胁迫耐受策略和竞争策略等。在群落生态学中，功能性状相关性分析有助于理解物种共存机制和生态系统稳定性。</p>
<p><strong>经济型谱</strong>：经济型谱理论是功能生态学的重要框架，描述了生物在资源投资和收益之间的权衡关系。叶片经济型谱是最经典的经济型谱，它揭示了叶片性状在全球尺度上的协变规律。具体表现为叶片氮含量、比叶面积与光合速率之间的正相关关系，以及与叶片寿命之间的负相关关系。这种权衡反映了植物在快速资源获取和长期资源保存之间的策略选择，其数学关系可以用线性或非线性回归模型来描述：<span class="math inline">\(y = \beta_0 + \beta_1x + \epsilon\)</span>。</p>
<p>根系经济型谱则描述了根系功能性状的协变模式，涉及细根直径、根组织密度、根寿命等性状。通常，快速资源获取型的根系具有较细的直径、较低的组织密度和较短的寿命，而资源保存型的根系则相反。这些经济型谱的发现为理解植物功能策略的普遍模式提供了理论基础，在全球变化生态学、生物地理学和生态系统管理中具有重要应用价值。它们帮助我们预测植物群落对气候变化和人为干扰的响应，以及生态系统功能的变化趋势。</p>
<p>在R语言中，功能性状相关性分析可以通过多种统计方法实现：</p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="相关性与相似性.html#cb691-1" tabindex="-1"></a><span class="co"># 创建示例功能性状数据</span></span>
<span id="cb691-2"><a href="相关性与相似性.html#cb691-2" tabindex="-1"></a>trait_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb691-3"><a href="相关性与相似性.html#cb691-3" tabindex="-1"></a>  物种 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;物种A&quot;</span>, <span class="st">&quot;物种B&quot;</span>, <span class="st">&quot;物种C&quot;</span>, <span class="st">&quot;物种D&quot;</span>, <span class="st">&quot;物种E&quot;</span>),</span>
<span id="cb691-4"><a href="相关性与相似性.html#cb691-4" tabindex="-1"></a>  比叶面积 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">15.2</span>, <span class="fl">8.7</span>, <span class="fl">22.1</span>, <span class="fl">12.5</span>, <span class="fl">18.9</span>),</span>
<span id="cb691-5"><a href="相关性与相似性.html#cb691-5" tabindex="-1"></a>  叶片氮含量 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">2.1</span>, <span class="fl">1.5</span>, <span class="fl">2.8</span>, <span class="fl">1.9</span>, <span class="fl">2.4</span>),</span>
<span id="cb691-6"><a href="相关性与相似性.html#cb691-6" tabindex="-1"></a>  光合速率 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">12.5</span>, <span class="fl">8.2</span>, <span class="fl">15.3</span>, <span class="fl">10.1</span>, <span class="fl">13.8</span>),</span>
<span id="cb691-7"><a href="相关性与相似性.html#cb691-7" tabindex="-1"></a>  叶片寿命 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">15</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">7</span>)</span>
<span id="cb691-8"><a href="相关性与相似性.html#cb691-8" tabindex="-1"></a>)</span>
<span id="cb691-9"><a href="相关性与相似性.html#cb691-9" tabindex="-1"></a></span>
<span id="cb691-10"><a href="相关性与相似性.html#cb691-10" tabindex="-1"></a><span class="co"># 计算性状间相关性矩阵</span></span>
<span id="cb691-11"><a href="相关性与相似性.html#cb691-11" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(trait_data[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb691-12"><a href="相关性与相似性.html#cb691-12" tabindex="-1"></a><span class="fu">print</span>(cor_matrix)</span></code></pre></div>
<pre><code>##              比叶面积 叶片氮含量   光合速率   叶片寿命
## 比叶面积    1.0000000  0.9964051  0.9906672 -0.9740756
## 叶片氮含量  0.9964051  1.0000000  0.9821403 -0.9647267
## 光合速率    0.9906672  0.9821403  1.0000000 -0.9951811
## 叶片寿命   -0.9740756 -0.9647267 -0.9951811  1.0000000</code></pre>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="相关性与相似性.html#cb693-1" tabindex="-1"></a><span class="co"># 可视化相关性矩阵</span></span>
<span id="cb693-2"><a href="相关性与相似性.html#cb693-2" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb693-3"><a href="相关性与相似性.html#cb693-3" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">&quot;circle&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-32-1"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-32-1.png" alt="功能性状相关性矩阵图和主成分分析双标图" width="672" />
<p class="caption">
图5.39: 功能性状相关性矩阵图和主成分分析双标图
</p>
</div>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="相关性与相似性.html#cb694-1" tabindex="-1"></a><span class="co"># 进行主成分分析探索性状协变模式</span></span>
<span id="cb694-2"><a href="相关性与相似性.html#cb694-2" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(trait_data[, <span class="sc">-</span><span class="dv">1</span>], <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb694-3"><a href="相关性与相似性.html#cb694-3" tabindex="-1"></a><span class="fu">summary</span>(pca_result)</span></code></pre></div>
<pre><code>## Importance of components:
##                           PC1     PC2     PC3     PC4
## Standard deviation     1.9879 0.21125 0.05922 0.01483
## Proportion of Variance 0.9879 0.01116 0.00088 0.00006
## Cumulative Proportion  0.9879 0.99907 0.99994 1.00000</code></pre>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="相关性与相似性.html#cb696-1" tabindex="-1"></a><span class="fu">biplot</span>(pca_result)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-32-2"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-32-2.png" alt="功能性状相关性矩阵图和主成分分析双标图" width="672" />
<p class="caption">
图5.40: 功能性状相关性矩阵图和主成分分析双标图
</p>
</div>
<p>对于经济型谱分析，可以使用线性模型来检验性状间的权衡关系：</p>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="相关性与相似性.html#cb697-1" tabindex="-1"></a><span class="co"># 检验叶片经济型谱关系</span></span>
<span id="cb697-2"><a href="相关性与相似性.html#cb697-2" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(光合速率 <span class="sc">~</span> 比叶面积, <span class="at">data =</span> trait_data)</span>
<span id="cb697-3"><a href="相关性与相似性.html#cb697-3" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = 光合速率 ~ 比叶面积, data = trait_data)
## 
## Residuals:
##        1        2        3        4        5 
##  0.67030 -0.14053 -0.23359 -0.28035 -0.01584 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  3.67040    0.68983   5.321  0.01297 * 
## 比叶面积     0.53680    0.04264  12.589  0.00108 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4481 on 3 degrees of freedom
## Multiple R-squared:  0.9814, Adjusted R-squared:  0.9752 
## F-statistic: 158.5 on 1 and 3 DF,  p-value: 0.001081</code></pre>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="相关性与相似性.html#cb699-1" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(叶片寿命 <span class="sc">~</span> 比叶面积, <span class="at">data =</span> trait_data)</span>
<span id="cb699-2"><a href="相关性与相似性.html#cb699-2" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = 叶片寿命 ~ 比叶面积, data = trait_data)
## 
## Residuals:
##       1       2       3       4       5 
## -1.6096  0.5258  0.5545  0.3697  0.1596 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  20.9853     1.6234  12.926 0.000999 ***
## 比叶面积     -0.7484     0.1004  -7.458 0.004991 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.055 on 3 degrees of freedom
## Multiple R-squared:  0.9488, Adjusted R-squared:  0.9318 
## F-statistic: 55.62 on 1 and 3 DF,  p-value: 0.004991</code></pre>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="相关性与相似性.html#cb701-1" tabindex="-1"></a><span class="co"># 可视化经济型谱关系</span></span>
<span id="cb701-2"><a href="相关性与相似性.html#cb701-2" tabindex="-1"></a><span class="fu">plot</span>(trait_data<span class="sc">$</span>比叶面积, trait_data<span class="sc">$</span>光合速率,</span>
<span id="cb701-3"><a href="相关性与相似性.html#cb701-3" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;比叶面积&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;光合速率&quot;</span>,</span>
<span id="cb701-4"><a href="相关性与相似性.html#cb701-4" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;叶片经济型谱：比叶面积与光合速率关系&quot;</span></span>
<span id="cb701-5"><a href="相关性与相似性.html#cb701-5" tabindex="-1"></a>)</span>
<span id="cb701-6"><a href="相关性与相似性.html#cb701-6" tabindex="-1"></a><span class="fu">abline</span>(model1, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-33"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-33-1.png" alt="叶片经济型谱关系散点图" width="672" />
<p class="caption">
图5.41: 叶片经济型谱关系散点图
</p>
</div>
<p><strong>结果解释与生态学意义</strong>：功能性状相关性分析的结果解释需要结合相关系数的数值大小、显著性水平和生态学背景。相关系数<span class="math inline">\(r\)</span>的绝对值大小反映了性状间关系的强度：<span class="math inline">\(|r| &gt; 0.7\)</span>表示强相关，<span class="math inline">\(0.5 &lt; |r| \leq 0.7\)</span>表示中等相关，<span class="math inline">\(0.3 &lt; |r| \leq 0.5\)</span>表示弱相关，<span class="math inline">\(|r| \leq 0.3\)</span>表示无实质性相关。相关系数的正负号指示了关系的方向：正相关表示性状间协同变化，负相关表示性状间存在权衡关系。</p>
<p>在生态学解释中，显著的正相关可能反映了功能综合征的存在，如快速生长策略相关的性状组合；显著的负相关则可能指示资源分配上的权衡，如在防御和生长之间的投资权衡。主成分分析中，前几个主成分的方差贡献率反映了数据的主要变异方向，通常认为累计方差贡献率超过70%的主成分能够较好地代表原始数据的变异结构。这些分析方法为生态学家提供了强大的工具来量化功能性状间的相关模式，揭示生物适应策略的普遍规律。</p>
</div>
<div id="种内相关性" class="section level3 hasAnchor" number="5.7.3">
<h3><span class="header-section-number">5.7.3</span> 种内相关性<a href="相关性与相似性.html#种内相关性" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>种内相关性分析关注同一物种个体在空间上的分布模式及其形成机制，是理解种群生态学过程和环境适应策略的重要工具。空间分布模式反映了物种的繁殖特性、扩散能力以及对环境异质性的响应。</p>
<p><strong>空间分布模式</strong>：物种的空间分布主要有三种基本模式：聚集分布、随机分布和均匀分布。聚集分布表现为个体在某些区域集中分布，形成斑块状格局，这通常由有限的种子扩散、克隆生长、环境异质性或社会行为等因素导致。其数学描述可以通过空间点过程模型来表示，如泊松聚类过程。随机分布则表现为个体在空间上无规律地分布，符合完全空间随机性假设，数学上可以用齐次泊松过程来描述：<span class="math inline">\(P(N(A)=k) = \frac{(\lambda|A|)^k e^{-\lambda|A|}}{k!}\)</span>，其中<span class="math inline">\(\lambda\)</span>为强度参数，<span class="math inline">\(|A|\)</span>为区域面积。均匀分布表现为个体在空间上等距分布，通常由强烈的种内竞争或领地行为导致。</p>
<p>这些分布模式的生态学意义在于它们反映了种内相互作用和环境异质性的综合影响。聚集分布常见于依赖母树扩散的植物物种或具有社会行为的动物种群；随机分布通常出现在环境均质且个体间无相互作用的条件下；均匀分布则多见于资源竞争激烈的环境中。</p>
<p><strong>聚集指数</strong>：为了量化空间分布模式，生态学家开发了多种聚集指数。方差均值比是最基础的聚集度检验方法，其定义为：<span class="math inline">\(I = \frac{s^2}{\bar{x}}\)</span>，其中<span class="math inline">\(s^2\)</span>为样本方差，<span class="math inline">\(\bar{x}\)</span>为样本均值。当<span class="math inline">\(I &gt; 1\)</span>时表示聚集分布，<span class="math inline">\(I = 1\)</span>时表示随机分布，<span class="math inline">\(I &lt; 1\)</span>时表示均匀分布。Morisita指数是另一种常用的空间聚集度量，其定义为：<span class="math inline">\(I_\delta = n \frac{\sum x_i(x_i-1)}{N(N-1)}\)</span>，其中<span class="math inline">\(n\)</span>为样方数，<span class="math inline">\(x_i\)</span>为第<span class="math inline">\(i\)</span>个样方中的个体数，<span class="math inline">\(N\)</span>为总个体数。Morisita指数对样本大小不敏感，在生态学调查中应用广泛。</p>
<p>这些聚集指数的生态学意义在于它们能够量化种内空间分布模式，为理解种群动态、资源利用策略和种内竞争提供定量依据。在保护生物学中，聚集指数有助于评估物种的生存状况和制定有效的保护策略。</p>
<p>在R语言中，种内空间分布分析可以通过以下方法实现：</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="相关性与相似性.html#cb702-1" tabindex="-1"></a><span class="co"># 创建示例空间分布数据</span></span>
<span id="cb702-2"><a href="相关性与相似性.html#cb702-2" tabindex="-1"></a>spatial_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">5</span>) <span class="co"># 10个样方中的个体数</span></span>
<span id="cb702-3"><a href="相关性与相似性.html#cb702-3" tabindex="-1"></a></span>
<span id="cb702-4"><a href="相关性与相似性.html#cb702-4" tabindex="-1"></a><span class="co"># 计算方差均值比</span></span>
<span id="cb702-5"><a href="相关性与相似性.html#cb702-5" tabindex="-1"></a>mean_count <span class="ot">&lt;-</span> <span class="fu">mean</span>(spatial_data)</span>
<span id="cb702-6"><a href="相关性与相似性.html#cb702-6" tabindex="-1"></a>variance_count <span class="ot">&lt;-</span> <span class="fu">var</span>(spatial_data)</span>
<span id="cb702-7"><a href="相关性与相似性.html#cb702-7" tabindex="-1"></a>variance_mean_ratio <span class="ot">&lt;-</span> variance_count <span class="sc">/</span> mean_count</span>
<span id="cb702-8"><a href="相关性与相似性.html#cb702-8" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;方差均值比:&quot;</span>, variance_mean_ratio))</span></code></pre></div>
<pre><code>## [1] &quot;方差均值比: 1.60992907801418&quot;</code></pre>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="相关性与相似性.html#cb704-1" tabindex="-1"></a><span class="co"># 计算Morisita指数</span></span>
<span id="cb704-2"><a href="相关性与相似性.html#cb704-2" tabindex="-1"></a>n_quadrats <span class="ot">&lt;-</span> <span class="fu">length</span>(spatial_data)</span>
<span id="cb704-3"><a href="相关性与相似性.html#cb704-3" tabindex="-1"></a>total_individuals <span class="ot">&lt;-</span> <span class="fu">sum</span>(spatial_data)</span>
<span id="cb704-4"><a href="相关性与相似性.html#cb704-4" tabindex="-1"></a>numerator <span class="ot">&lt;-</span> n_quadrats <span class="sc">*</span> <span class="fu">sum</span>(spatial_data <span class="sc">*</span> (spatial_data <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb704-5"><a href="相关性与相似性.html#cb704-5" tabindex="-1"></a>denominator <span class="ot">&lt;-</span> total_individuals <span class="sc">*</span> (total_individuals <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb704-6"><a href="相关性与相似性.html#cb704-6" tabindex="-1"></a>morisita_index <span class="ot">&lt;-</span> numerator <span class="sc">/</span> denominator</span>
<span id="cb704-7"><a href="相关性与相似性.html#cb704-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Morisita指数:&quot;</span>, morisita_index))</span></code></pre></div>
<pre><code>## [1] &quot;Morisita指数: 1.11933395004625&quot;</code></pre>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="相关性与相似性.html#cb706-1" tabindex="-1"></a><span class="co"># 判断分布模式</span></span>
<span id="cb706-2"><a href="相关性与相似性.html#cb706-2" tabindex="-1"></a><span class="cf">if</span> (variance_mean_ratio <span class="sc">&gt;</span> <span class="fl">1.2</span>) {</span>
<span id="cb706-3"><a href="相关性与相似性.html#cb706-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;分布模式：聚集分布&quot;</span>)</span>
<span id="cb706-4"><a href="相关性与相似性.html#cb706-4" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (variance_mean_ratio <span class="sc">&lt;</span> <span class="fl">0.8</span>) {</span>
<span id="cb706-5"><a href="相关性与相似性.html#cb706-5" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;分布模式：均匀分布&quot;</span>)</span>
<span id="cb706-6"><a href="相关性与相似性.html#cb706-6" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb706-7"><a href="相关性与相似性.html#cb706-7" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;分布模式：随机分布&quot;</span>)</span>
<span id="cb706-8"><a href="相关性与相似性.html#cb706-8" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;分布模式：聚集分布&quot;</code></pre>
<p><strong>结果解释与生态学意义</strong>：空间分布模式的分析结果需要结合聚集指数的数值和统计显著性来解释。方差均值比<span class="math inline">\(I\)</span>的判断标准为：<span class="math inline">\(I &gt; 1.2\)</span>表示聚集分布，<span class="math inline">\(0.8 \leq I \leq 1.2\)</span>表示随机分布，<span class="math inline">\(I &lt; 0.8\)</span>表示均匀分布。Morisita指数的判断标准类似：<span class="math inline">\(I_\delta &gt; 1\)</span>表示聚集分布，<span class="math inline">\(I_\delta = 1\)</span>表示随机分布，<span class="math inline">\(I_\delta &lt; 1\)</span>表示均匀分布。</p>
<p>在生态学解释中，聚集分布通常指示存在环境异质性、有限的扩散能力或社会行为；随机分布可能出现在环境均质且个体间无相互作用的条件下；均匀分布则通常由强烈的种内竞争导致。这些分布模式的识别对于理解种群动态、设计抽样方案和制定保护策略具有重要意义。例如，对于聚集分布的物种，保护措施需要关注其核心分布区；对于均匀分布的物种，则需要考虑其竞争机制和资源利用策略。这些分析方法为生态学家提供了量化种内空间分布模式的工具，支持种群生态学和保护生物学研究。</p>
</div>
<div id="种间相关性" class="section level3 hasAnchor" number="5.7.4">
<h3><span class="header-section-number">5.7.4</span> 种间相关性<a href="相关性与相似性.html#种间相关性" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>种间相关性分析是群落生态学的核心内容，旨在揭示不同物种在空间分布、资源利用和生态功能上的相互关系。这些关系反映了物种间的竞争、互利、捕食等生态过程，是理解群落构建机制和生态系统稳定性的关键。</p>
<p><strong>种间关联</strong>：种间关联主要分为三种类型：正相关、负相关和不相关。正相关表现为两个物种在空间上倾向于共同出现，这可能源于互利共生关系、相似的环境需求或共同的扩散限制。数学上可以用相关系数或关联指数来量化：<span class="math inline">\(\phi = \frac{ad-bc}{\sqrt{(a+b)(c+d)(a+c)(b+d)}}\)</span>，其中<span class="math inline">\(a,b,c,d\)</span>为2×2列联表中的频数。负相关则表现为两个物种在空间上相互排斥，通常由竞争排斥、化感作用或不同的生态位需求导致。不相关则表示两个物种的分布相互独立，没有显著的生态联系。</p>
<p>这些关联模式的生态学意义在于它们反映了物种间相互作用的性质和强度。正相关可能指示物种间的协同进化或生态位重叠，负相关则暗示强烈的竞争或生态位分化。在恢复生态学中，种间关联分析有助于设计合理的物种配置方案；在保护生物学中，它有助于识别关键物种和功能群。</p>
<p><strong>生态网络构建</strong>：基于种间相关性可以构建生态网络，从而可视化物种间相互作用的复杂结构。网络构建通常基于相关性矩阵，通过设定阈值将显著的相关关系转化为网络边。网络拓扑特征分析包括度分布、聚类系数、模块性等指标的计算。度分布描述了物种连接数的分布规律，数学上可以用幂律分布<span class="math inline">\(P(k) \sim k^{-\gamma}\)</span>来拟合。聚类系数衡量了网络中三角形的比例，反映了物种间相互作用的局部聚集性。模块性则量化了网络被划分为相对独立模块的程度。</p>
<p>这些网络特征的生态学意义在于它们揭示了物种间相互作用的结构特性。高度模块化的网络可能反映了生态系统的功能分区，而高聚类系数则暗示了物种间的功能互补。在网络生态学中，这些分析有助于理解生态系统的稳定性和恢复力，预测物种灭绝的级联效应。</p>
<p>在R语言中，种间相关性分析和生态网络构建可以通过以下方法实现：</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="相关性与相似性.html#cb708-1" tabindex="-1"></a><span class="co"># 创建示例种间关联数据</span></span>
<span id="cb708-2"><a href="相关性与相似性.html#cb708-2" tabindex="-1"></a>species_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb708-3"><a href="相关性与相似性.html#cb708-3" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="co"># 物种A在5个样地的分布</span></span>
<span id="cb708-4"><a href="相关性与相似性.html#cb708-4" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="co"># 物种B</span></span>
<span id="cb708-5"><a href="相关性与相似性.html#cb708-5" tabindex="-1"></a>  <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="co"># 物种C</span></span>
<span id="cb708-6"><a href="相关性与相似性.html#cb708-6" tabindex="-1"></a>  <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span> <span class="co"># 物种D</span></span>
<span id="cb708-7"><a href="相关性与相似性.html#cb708-7" tabindex="-1"></a>), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb708-8"><a href="相关性与相似性.html#cb708-8" tabindex="-1"></a><span class="fu">rownames</span>(species_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;物种A&quot;</span>, <span class="st">&quot;物种B&quot;</span>, <span class="st">&quot;物种C&quot;</span>, <span class="st">&quot;物种D&quot;</span>)</span>
<span id="cb708-9"><a href="相关性与相似性.html#cb708-9" tabindex="-1"></a></span>
<span id="cb708-10"><a href="相关性与相似性.html#cb708-10" tabindex="-1"></a><span class="co"># 计算种间关联矩阵</span></span>
<span id="cb708-11"><a href="相关性与相似性.html#cb708-11" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb708-12"><a href="相关性与相似性.html#cb708-12" tabindex="-1"></a>association_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">t</span>(species_data))</span>
<span id="cb708-13"><a href="相关性与相似性.html#cb708-13" tabindex="-1"></a><span class="fu">print</span>(association_matrix)</span></code></pre></div>
<pre><code>##            物种A      物种B      物种C      物种D
## 物种A  1.0000000 -0.4082483 -0.6666667  0.6123724
## 物种B -0.4082483  1.0000000 -0.4082483 -0.2500000
## 物种C -0.6666667 -0.4082483  1.0000000 -0.4082483
## 物种D  0.6123724 -0.2500000 -0.4082483  1.0000000</code></pre>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="相关性与相似性.html#cb710-1" tabindex="-1"></a><span class="co"># 构建生态网络</span></span>
<span id="cb710-2"><a href="相关性与相似性.html#cb710-2" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb710-3"><a href="相关性与相似性.html#cb710-3" tabindex="-1"></a><span class="co"># 设定相关性阈值</span></span>
<span id="cb710-4"><a href="相关性与相似性.html#cb710-4" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb710-5"><a href="相关性与相似性.html#cb710-5" tabindex="-1"></a>adj_matrix <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(association_matrix) <span class="sc">&gt;</span> threshold, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb710-6"><a href="相关性与相似性.html#cb710-6" tabindex="-1"></a><span class="fu">diag</span>(adj_matrix) <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># 移除自连接</span></span>
<span id="cb710-7"><a href="相关性与相似性.html#cb710-7" tabindex="-1"></a></span>
<span id="cb710-8"><a href="相关性与相似性.html#cb710-8" tabindex="-1"></a><span class="co"># 创建网络对象</span></span>
<span id="cb710-9"><a href="相关性与相似性.html#cb710-9" tabindex="-1"></a>network <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(adj_matrix, <span class="at">mode =</span> <span class="st">&quot;undirected&quot;</span>)</span>
<span id="cb710-10"><a href="相关性与相似性.html#cb710-10" tabindex="-1"></a></span>
<span id="cb710-11"><a href="相关性与相似性.html#cb710-11" tabindex="-1"></a><span class="co"># 计算网络拓扑特征</span></span>
<span id="cb710-12"><a href="相关性与相似性.html#cb710-12" tabindex="-1"></a>degree_dist <span class="ot">&lt;-</span> <span class="fu">degree</span>(network)</span>
<span id="cb710-13"><a href="相关性与相似性.html#cb710-13" tabindex="-1"></a>clustering_coef <span class="ot">&lt;-</span> <span class="fu">transitivity</span>(network, <span class="at">type =</span> <span class="st">&quot;global&quot;</span>)</span>
<span id="cb710-14"><a href="相关性与相似性.html#cb710-14" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;平均度:&quot;</span>, <span class="fu">mean</span>(degree_dist)))</span></code></pre></div>
<pre><code>## [1] &quot;平均度: 2.5&quot;</code></pre>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="相关性与相似性.html#cb712-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;聚类系数:&quot;</span>, clustering_coef))</span></code></pre></div>
<pre><code>## [1] &quot;聚类系数: 0.75&quot;</code></pre>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="相关性与相似性.html#cb714-1" tabindex="-1"></a><span class="co"># 可视化网络</span></span>
<span id="cb714-2"><a href="相关性与相似性.html#cb714-2" tabindex="-1"></a><span class="fu">plot</span>(network,</span>
<span id="cb714-3"><a href="相关性与相似性.html#cb714-3" tabindex="-1"></a>  <span class="at">vertex.size =</span> <span class="dv">15</span>, <span class="at">vertex.color =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb714-4"><a href="相关性与相似性.html#cb714-4" tabindex="-1"></a>  <span class="at">edge.color =</span> <span class="st">&quot;gray&quot;</span>, <span class="at">main =</span> <span class="st">&quot;种间关联网络&quot;</span></span>
<span id="cb714-5"><a href="相关性与相似性.html#cb714-5" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-35"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-35-1.png" alt="种间关联网络图" width="672" />
<p class="caption">
图3.7: 种间关联网络图
</p>
</div>
<p><strong>结果解释与生态学意义</strong>：种间相关性分析的结果解释需要结合相关系数的数值、显著性水平和生态学机制。对于种间关联系数<span class="math inline">\(\phi\)</span>，通常认为：<span class="math inline">\(|\phi| &gt; 0.3\)</span>表示强关联，<span class="math inline">\(0.2 &lt; |\phi| \leq 0.3\)</span>表示中等关联，<span class="math inline">\(|\phi| \leq 0.2\)</span>表示弱关联。正关联<span class="math inline">\(\phi &gt; 0\)</span>表示物种倾向于共同出现，可能源于互利共生或相似的环境需求；负关联<span class="math inline">\(\phi &lt; 0\)</span>表示物种相互排斥，可能源于竞争或不同的生态位需求。</p>
<p>在网络分析中，度分布的特征反映了物种在群落中的连接性，幂律分布<span class="math inline">\(\gamma &gt; 2\)</span>的网络通常具有较好的稳定性。聚类系数<span class="math inline">\(C &gt; 0.5\)</span>表示网络中三角形结构丰富，可能反映了功能互补的物种组合。模块性<span class="math inline">\(Q &gt; 0.3\)</span>通常被认为是显著的模块结构，反映了生态系统的功能分区。这些网络特征有助于理解生态系统的稳定性和功能组织，为保护关键物种和维持生态系统功能提供科学依据。这些分析方法为生态学家提供了研究种间相互作用的定量工具，支持群落生态学和生态系统管理研究。</p>
</div>
<div id="群落相似性" class="section level3 hasAnchor" number="5.7.5">
<h3><span class="header-section-number">5.7.5</span> 群落相似性<a href="相关性与相似性.html#群落相似性" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>群落相似性分析是生态学中研究群落组成变化和空间格局的核心方法，涉及多种统计技术来量化和可视化群落间的相似性和差异性。这些方法帮助生态学家理解环境梯度、地理距离和历史因素对群落构建的影响。</p>
<p><strong>Mantel检验</strong>：Mantel检验是一种用于检验两个距离矩阵相关性的统计方法，在生态学中常用于检验环境距离与群落距离之间的关系。其基本原理是通过置换检验评估两个矩阵元素间的相关性显著性，数学上计算Mantel统计量：<span class="math inline">\(r_M = \frac{\sum_{i&lt;j}(x_{ij}-\bar{x})(y_{ij}-\bar{y})}{\sqrt{\sum_{i&lt;j}(x_{ij}-\bar{x})^2\sum_{i&lt;j}(y_{ij}-\bar{y})^2}}\)</span>，其中<span class="math inline">\(x_{ij}\)</span>和<span class="math inline">\(y_{ij}\)</span>分别为两个距离矩阵中的元素。生态学意义在于Mantel检验能够识别环境过滤、扩散限制等生态过程对群落构建的相对贡献，是群落生态学中空间分析的重要工具。</p>
<p><strong>排序分析（ordination）</strong>：排序分析是一类降维技术，用于在低维空间中可视化高维的群落数据。主成分分析（PCA）适用于线性响应的环境梯度，通过特征值分解找到数据变异的主要方向，数学上求解协方差矩阵的特征向量：<span class="math inline">\(\Sigma v = \lambda v\)</span>。对应分析（CA）基于卡方距离，更适合物种多度数据，能够同时排序样方和物种。非度量多维标度（NMDS）基于秩次距离，不假设线性关系，对异常值不敏感，通过迭代优化使排序空间中的距离与原始距离矩阵尽可能一致。这些排序方法的生态学意义在于它们能够可视化群落结构和环境梯度，识别主导的生态过程和环境因子。</p>
<p><strong>聚类分析（clustering）</strong>：聚类分析用于识别群落类型和进行生态区划。层次聚类基于距离矩阵构建树状结构，常用方法包括单连接、完全连接和平均连接法，通过逐层合并最相似的样本形成聚类树。k均值聚类是一种划分方法，通过迭代优化将样本划分为k个簇，最小化簇内平方和：<span class="math inline">\(\sum_{i=1}^k\sum_{x\in C_i}||x-\mu_i||^2\)</span>。这些聚类方法的生态学意义在于它们能够识别群落类型和生态区划，为生物多样性保护和生态系统管理提供科学依据。</p>
<p><strong>Beta多样性</strong>：Beta多样性量化了群落组成在空间或时间上的变化，反映了物种周转和嵌套性两个组分。基于距离矩阵的方法如Bray-Curtis距离可以直接计算群落差异，而基于组分分解的方法可以将Beta多样性分解为物种周转（物种替换）和嵌套性（物种丢失）两部分：<span class="math inline">\(\beta_{total} = \beta_{turnover} + \beta_{nestedness}\)</span>。生态学意义在于Beta多样性分析能够揭示生物多样性形成的机制，如环境过滤、扩散限制和生态位过程，是理解生物地理格局和生态系统功能的关键。</p>
<p>在R语言中，群落相似性分析可以通过以下方法实现：</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="相关性与相似性.html#cb715-1" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb715-2"><a href="相关性与相似性.html#cb715-2" tabindex="-1"></a></span>
<span id="cb715-3"><a href="相关性与相似性.html#cb715-3" tabindex="-1"></a><span class="co"># 创建示例群落数据</span></span>
<span id="cb715-4"><a href="相关性与相似性.html#cb715-4" tabindex="-1"></a>community_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb715-5"><a href="相关性与相似性.html#cb715-5" tabindex="-1"></a>  <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">15</span>, <span class="co"># 样地1的物种多度</span></span>
<span id="cb715-6"><a href="相关性与相似性.html#cb715-6" tabindex="-1"></a>  <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="co"># 样地2</span></span>
<span id="cb715-7"><a href="相关性与相似性.html#cb715-7" tabindex="-1"></a>  <span class="dv">15</span>, <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="co"># 样地3</span></span>
<span id="cb715-8"><a href="相关性与相似性.html#cb715-8" tabindex="-1"></a>  <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">18</span>, <span class="co"># 样地4</span></span>
<span id="cb715-9"><a href="相关性与相似性.html#cb715-9" tabindex="-1"></a>  <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="co"># 样地5</span></span>
<span id="cb715-10"><a href="相关性与相似性.html#cb715-10" tabindex="-1"></a>  <span class="dv">12</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">7</span>, <span class="co"># 样地6</span></span>
<span id="cb715-11"><a href="相关性与相似性.html#cb715-11" tabindex="-1"></a>  <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">14</span>, <span class="co"># 样地7</span></span>
<span id="cb715-12"><a href="相关性与相似性.html#cb715-12" tabindex="-1"></a>  <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">11</span>, <span class="dv">7</span>, <span class="dv">9</span> <span class="co"># 样地8</span></span>
<span id="cb715-13"><a href="相关性与相似性.html#cb715-13" tabindex="-1"></a>), <span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb715-14"><a href="相关性与相似性.html#cb715-14" tabindex="-1"></a><span class="fu">rownames</span>(community_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb715-15"><a href="相关性与相似性.html#cb715-15" tabindex="-1"></a>  <span class="st">&quot;样地1&quot;</span>, <span class="st">&quot;样地2&quot;</span>, <span class="st">&quot;样地3&quot;</span>,</span>
<span id="cb715-16"><a href="相关性与相似性.html#cb715-16" tabindex="-1"></a>  <span class="st">&quot;样地4&quot;</span>, <span class="st">&quot;样地5&quot;</span>, <span class="st">&quot;样地6&quot;</span>, <span class="st">&quot;样地7&quot;</span>, <span class="st">&quot;样地8&quot;</span></span>
<span id="cb715-17"><a href="相关性与相似性.html#cb715-17" tabindex="-1"></a>)</span>
<span id="cb715-18"><a href="相关性与相似性.html#cb715-18" tabindex="-1"></a></span>
<span id="cb715-19"><a href="相关性与相似性.html#cb715-19" tabindex="-1"></a><span class="co"># 创建环境数据</span></span>
<span id="cb715-20"><a href="相关性与相似性.html#cb715-20" tabindex="-1"></a>env_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb715-21"><a href="相关性与相似性.html#cb715-21" tabindex="-1"></a>  温度 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">12</span>, <span class="dv">20</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">19</span>, <span class="dv">13</span>),</span>
<span id="cb715-22"><a href="相关性与相似性.html#cb715-22" tabindex="-1"></a>  湿度 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">75</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">70</span>, <span class="dv">68</span>, <span class="dv">78</span>, <span class="dv">62</span>),</span>
<span id="cb715-23"><a href="相关性与相似性.html#cb715-23" tabindex="-1"></a>  <span class="at">pH =</span> <span class="fu">c</span>(<span class="fl">6.5</span>, <span class="fl">7.2</span>, <span class="fl">6.8</span>, <span class="fl">7.5</span>, <span class="fl">6.9</span>, <span class="fl">7.0</span>, <span class="fl">7.3</span>, <span class="fl">6.7</span>)</span>
<span id="cb715-24"><a href="相关性与相似性.html#cb715-24" tabindex="-1"></a>)</span>
<span id="cb715-25"><a href="相关性与相似性.html#cb715-25" tabindex="-1"></a></span>
<span id="cb715-26"><a href="相关性与相似性.html#cb715-26" tabindex="-1"></a><span class="co"># Mantel检验</span></span>
<span id="cb715-27"><a href="相关性与相似性.html#cb715-27" tabindex="-1"></a>comm_dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(community_data, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb715-28"><a href="相关性与相似性.html#cb715-28" tabindex="-1"></a>env_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(env_data)</span>
<span id="cb715-29"><a href="相关性与相似性.html#cb715-29" tabindex="-1"></a>mantel_test <span class="ot">&lt;-</span> <span class="fu">mantel</span>(comm_dist, env_dist)</span>
<span id="cb715-30"><a href="相关性与相似性.html#cb715-30" tabindex="-1"></a><span class="fu">print</span>(mantel_test)</span></code></pre></div>
<pre><code>## 
## Mantel statistic based on Pearson&#39;s product-moment correlation 
## 
## Call:
## mantel(xdis = comm_dist, ydis = env_dist) 
## 
## Mantel statistic r: 0.4779 
##       Significance: 0.01 
## 
## Upper quantiles of permutations (null model):
##   90%   95% 97.5%   99% 
## 0.261 0.348 0.420 0.467 
## Permutation: free
## Number of permutations: 999</code></pre>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="相关性与相似性.html#cb717-1" tabindex="-1"></a><span class="co"># 排序分析 - PCA</span></span>
<span id="cb717-2"><a href="相关性与相似性.html#cb717-2" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">rda</span>(community_data, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb717-3"><a href="相关性与相似性.html#cb717-3" tabindex="-1"></a><span class="fu">summary</span>(pca_result)</span></code></pre></div>
<pre><code>## 
## Call:
## rda(X = community_data, scale = TRUE) 
## 
## Partitioning of correlations:
##               Inertia Proportion
## Total               5          1
## Unconstrained       5          1
## 
## Eigenvalues, and their contribution to the correlations 
## 
## Importance of components:
##                          PC1    PC2     PC3     PC4      PC5
## Eigenvalue            2.8025 1.7269 0.35593 0.08572 0.029022
## Proportion Explained  0.5605 0.3454 0.07119 0.01714 0.005804
## Cumulative Proportion 0.5605 0.9059 0.97705 0.99420 1.000000</code></pre>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="相关性与相似性.html#cb719-1" tabindex="-1"></a><span class="fu">plot</span>(pca_result, <span class="at">display =</span> <span class="st">&quot;sites&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-36-1"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-36-1.png" alt="群落相似性分析的排序图和聚类图" width="672" />
<p class="caption">
图5.42: 群落相似性分析的排序图和聚类图
</p>
</div>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="相关性与相似性.html#cb720-1" tabindex="-1"></a><span class="co"># 排序分析 - NMDS</span></span>
<span id="cb720-2"><a href="相关性与相似性.html#cb720-2" tabindex="-1"></a>comm_dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(community_data, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb720-3"><a href="相关性与相似性.html#cb720-3" tabindex="-1"></a>nmds_result <span class="ot">&lt;-</span> <span class="fu">monoMDS</span>(comm_dist)</span>
<span id="cb720-4"><a href="相关性与相似性.html#cb720-4" tabindex="-1"></a><span class="fu">plot</span>(nmds_result, <span class="at">type =</span> <span class="st">&quot;t&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-36-2"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-36-2.png" alt="群落相似性分析的排序图和聚类图" width="672" />
<p class="caption">
图5.43: 群落相似性分析的排序图和聚类图
</p>
</div>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="相关性与相似性.html#cb721-1" tabindex="-1"></a><span class="co"># 聚类分析 - 层次聚类</span></span>
<span id="cb721-2"><a href="相关性与相似性.html#cb721-2" tabindex="-1"></a>hc_result <span class="ot">&lt;-</span> <span class="fu">hclust</span>(comm_dist, <span class="at">method =</span> <span class="st">&quot;average&quot;</span>)</span>
<span id="cb721-3"><a href="相关性与相似性.html#cb721-3" tabindex="-1"></a><span class="fu">plot</span>(hc_result)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-36-3"></span>
<img src="05-correlation_files/figure-html/unnamed-chunk-36-3.png" alt="群落相似性分析的排序图和聚类图" width="672" />
<p class="caption">
图5.44: 群落相似性分析的排序图和聚类图
</p>
</div>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="相关性与相似性.html#cb722-1" tabindex="-1"></a><span class="co"># Beta多样性计算</span></span>
<span id="cb722-2"><a href="相关性与相似性.html#cb722-2" tabindex="-1"></a>beta_div <span class="ot">&lt;-</span> <span class="fu">betadiver</span>(community_data, <span class="at">method =</span> <span class="st">&quot;w&quot;</span>)</span>
<span id="cb722-3"><a href="相关性与相似性.html#cb722-3" tabindex="-1"></a><span class="fu">print</span>(beta_div)</span></code></pre></div>
<pre><code>##           样地1     样地2     样地3     样地4     样地5     样地6     样地7
## 样地2 0.1111111                                                            
## 样地3 0.1111111 0.0000000                                                  
## 样地4 0.1111111 0.0000000 0.0000000                                        
## 样地5 0.1111111 0.0000000 0.0000000 0.0000000                              
## 样地6 0.1111111 0.0000000 0.0000000 0.0000000 0.0000000                    
## 样地7 0.1111111 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000          
## 样地8 0.1111111 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</code></pre>
<p><strong>结果解释与生态学意义</strong>：群落相似性分析的结果解释需要结合统计显著性、效应大小和生态学背景。对于Mantel检验，通常认为<span class="math inline">\(p &lt; 0.05\)</span>表示环境距离与群落距离存在显著相关性，而Mantel统计量<span class="math inline">\(r_M\)</span>的大小反映了相关性的强度：<span class="math inline">\(|r_M| &gt; 0.3\)</span>表示强相关，<span class="math inline">\(0.2 &lt; |r_M| \leq 0.3\)</span>表示中等相关，<span class="math inline">\(|r_M| \leq 0.2\)</span>表示弱相关。</p>
<p>在排序分析中，前两个排序轴通常能够解释数据的主要变异，累计解释率超过50%通常被认为是可接受的。排序图中样本点的聚集程度反映了群落的相似性，而环境向量的长度和方向指示了环境因子对群落变异的影响强度。在聚类分析中，树状图的切割高度决定了聚类的粒度，通常选择在树状图分支较长的位置进行切割。Beta多样性的解释需要考虑其组分：高周转率<span class="math inline">\(\beta_{turnover}\)</span>表示物种替换是群落差异的主要机制，而高嵌套性<span class="math inline">\(\beta_{nestedness}\)</span>表示物种丢失是主要机制。</p>
<p>这些分析结果的生态学解释需要结合具体的研究问题。例如，显著的环境-群落相关性可能支持环境过滤假说；高度的Beta多样性可能反映了强烈的生态位分化或扩散限制。这些分析方法为生态学家提供了全面的工具集来研究群落相似性和多样性格局，支持群落生态学和生物地理学研究。</p>
</div>
</div>
<div id="总结-5" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> 总结<a href="相关性与相似性.html#总结-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>本章系统介绍了生态学中相关性与相似性分析的理论基础、方法体系及其在生态学研究中的广泛应用。相关性与相似性分析作为生态统计学的核心内容，为理解生物与环境、物种间以及群落间的复杂关系提供了定量化的工具。</p>
<p>在相关性统计基础部分，我们详细讨论了多种相关性度量方法。Pearson相关系数适用于线性关系的量化，Spearman秩相关和Kendall’s τ则能够处理单调但非线性的关系。偏相关分析通过控制混杂变量的影响，揭示了变量间的直接关系。距离相关和互信息进一步扩展了相关性分析的能力，能够检测复杂的非线性关系和依赖模式。这些方法的选择需要根据数据的分布特征、关系类型以及研究问题的性质来决定。</p>
<p>自相关分析关注数据在时间和空间维度上的依赖性。时间自相关通过自相关函数（ACF）和偏自相关函数（PACF）揭示了时间序列中的周期性、趋势和记忆效应，而平稳性检验则为时间序列分析提供了基础假设验证。空间自相关分析则通过变异函数、全局空间自相关指数（如Moran’s I和Geary’s C）以及局部空间自相关（LISA分析）来量化空间格局，识别空间聚集、离散或随机分布模式。这些分析对于理解种群动态、物种分布和环境梯度的空间结构具有重要意义。</p>
<p>系统发育相关性分析将进化历史纳入生态关系的考量。系统发育信号分析（如Blomberg’s K和Pagel’s λ）评估了性状在系统发育树上的保守性程度，而系统发育独立对比（PIC）和系统发育广义最小二乘法（PGLS）则能够去除系统发育非独立性对性状间关系分析的影响。这些方法为理解性状的进化历史和生态功能提供了进化生态学的视角。</p>
<p>相似性与距离分析构成了群落生态学和功能生态学的核心方法体系。常用相似性系数根据数据类型分为二元数据相似性（Jaccard、Sørensen系数）和数量数据相似性（Bray-Curtis距离、Morisita-Horn指数），而传统距离度量（欧氏距离、Mahalanobis距离）则在多元数据分析中发挥重要作用。功能性状相关性分析揭示了生物在资源分配和生态策略上的权衡关系，经济型谱理论则提供了理解植物功能策略普遍模式的框架。</p>
<p>种内相关性分析通过空间分布模式和聚集指数量化了同一物种个体在空间上的分布特征，反映了种内相互作用和环境异质性的综合影响。种间相关性分析则通过种间关联和生态网络构建揭示了物种间竞争、互利等相互作用的结构特性。群落相似性分析整合了Mantel检验、排序分析、聚类分析和Beta多样性等多种方法，为理解群落构建机制、环境梯度影响以及生物地理格局提供了全面的分析工具。</p>
<p>在结果解释方面，本章为各种统计量提供了明确的数值标准和生态学解释框架。相似性系数的数值范围、相关系数的强度分级、聚集指数的判断标准以及网络拓扑特征的阈值都为生态学家提供了实用的参考依据。这些标准的应用需要结合具体的研究背景和生态学预期，避免机械地套用数值标准而忽视生态学机制的理解。</p>
<p>总之，相关性与相似性分析构成了生态统计学的重要支柱，它们不仅提供了量化生态关系的数学工具，更重要的是为理解生态系统的结构、功能和动态提供了理论框架。随着生态学研究的深入和计算技术的发展，这些方法将继续在生态学理论构建、生态系统管理和生物多样性保护中发挥关键作用。掌握这些分析方法并正确理解其生态学含义，对于开展严谨的生态学研究具有重要意义。</p>
</div>
<div id="综合练习-3" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> 综合练习<a href="相关性与相似性.html#综合练习-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="参数估计.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="基于经典分布的假设检验.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": false,
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["ecological-statistics.pdf", "ecological-statistics.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
