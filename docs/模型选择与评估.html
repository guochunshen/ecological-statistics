<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 模型选择与评估 | 生态统计学</title>
  <meta name="description" content="9 模型选择与评估 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="9 模型选择与评估 | 生态统计学" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="9 模型选择与评估 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 模型选择与评估 | 生态统计学" />
  
  <meta name="twitter:description" content="9 模型选择与评估 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  

<meta name="author" content="沈国春、李勤" />


<meta name="date" content="2025-10-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="简单线性回归模型.html"/>
<link rel="next" href="高级回归模型.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7cbaf067c715044120ee231397e9ace3";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">生态统计学</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#为什么要学生态统计"><i class="fa fa-check"></i><b>0.1</b> 为什么要学生态统计</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#在不确定的世界中寻找规律"><i class="fa fa-check"></i><b>0.1.1</b> 在不确定的世界中寻找规律</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#ai时代的机遇与陷阱"><i class="fa fa-check"></i><b>0.1.2</b> AI时代的机遇与陷阱</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#本书介绍"><i class="fa fa-check"></i><b>0.2</b> 本书介绍</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#课程在线资源"><i class="fa fa-check"></i><b>0.3</b> 课程在线资源</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#学习方式"><i class="fa fa-check"></i><b>0.4</b> 学习方式</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="统计编程基础.html"><a href="统计编程基础.html"><i class="fa fa-check"></i><b>1</b> 统计编程基础</a>
<ul>
<li class="chapter" data-level="1.1" data-path="统计编程基础.html"><a href="统计编程基础.html#引言"><i class="fa fa-check"></i><b>1.1</b> 引言</a></li>
<li class="chapter" data-level="1.2" data-path="统计编程基础.html"><a href="统计编程基础.html#核心能力培养框架"><i class="fa fa-check"></i><b>1.2</b> 核心能力培养框架</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="统计编程基础.html"><a href="统计编程基础.html#高阶思维与问题解决能力"><i class="fa fa-check"></i><b>1.2.1</b> 高阶思维与问题解决能力</a></li>
<li class="chapter" data-level="1.2.2" data-path="统计编程基础.html"><a href="统计编程基础.html#与llm协同工作的能力"><i class="fa fa-check"></i><b>1.2.2</b> 与LLM协同工作的能力</a></li>
<li class="chapter" data-level="1.2.3" data-path="统计编程基础.html"><a href="统计编程基础.html#传统但愈发重要的软技能"><i class="fa fa-check"></i><b>1.2.3</b> 传统但愈发重要的软技能</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="统计编程基础.html"><a href="统计编程基础.html#通用编程思维基础"><i class="fa fa-check"></i><b>1.3</b> 通用编程思维基础</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="统计编程基础.html"><a href="统计编程基础.html#编程核心概念"><i class="fa fa-check"></i><b>1.3.1</b> 编程核心概念</a></li>
<li class="chapter" data-level="1.3.2" data-path="统计编程基础.html"><a href="统计编程基础.html#算法复杂度"><i class="fa fa-check"></i><b>1.3.2</b> 算法复杂度</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="统计编程基础.html"><a href="统计编程基础.html#ai协同编程技能"><i class="fa fa-check"></i><b>1.4</b> AI协同编程技能</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="统计编程基础.html"><a href="统计编程基础.html#ai编程模块安装"><i class="fa fa-check"></i><b>1.4.1</b> AI编程模块安装</a></li>
<li class="chapter" data-level="1.4.2" data-path="统计编程基础.html"><a href="统计编程基础.html#精准提问技巧"><i class="fa fa-check"></i><b>1.4.2</b> 精准提问技巧</a></li>
<li class="chapter" data-level="1.4.3" data-path="统计编程基础.html"><a href="统计编程基础.html#代码审查能力"><i class="fa fa-check"></i><b>1.4.3</b> 代码审查能力</a></li>
<li class="chapter" data-level="1.4.4" data-path="统计编程基础.html"><a href="统计编程基础.html#调试与错误处理"><i class="fa fa-check"></i><b>1.4.4</b> 调试与错误处理</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="统计编程基础.html"><a href="统计编程基础.html#总结"><i class="fa fa-check"></i><b>1.5</b> 总结</a></li>
<li class="chapter" data-level="1.6" data-path="统计编程基础.html"><a href="统计编程基础.html#综合练习"><i class="fa fa-check"></i><b>1.6</b> 综合练习</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="统计编程基础.html"><a href="统计编程基础.html#练习1"><i class="fa fa-check"></i><b>1.6.1</b> 练习1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="概率与分布.html"><a href="概率与分布.html"><i class="fa fa-check"></i><b>2</b> 概率与分布</a>
<ul>
<li class="chapter" data-level="2.1" data-path="概率与分布.html"><a href="概率与分布.html#引言-1"><i class="fa fa-check"></i><b>2.1</b> 引言</a></li>
<li class="chapter" data-level="2.2" data-path="概率与分布.html"><a href="概率与分布.html#蚂蚱午餐与概率"><i class="fa fa-check"></i><b>2.2</b> 蚂蚱午餐与概率</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="概率与分布.html"><a href="概率与分布.html#一只蚱蜢的午餐"><i class="fa fa-check"></i><b>2.2.1</b> 一只蚱蜢的午餐</a></li>
<li class="chapter" data-level="2.2.2" data-path="概率与分布.html"><a href="概率与分布.html#理想的猜测古典概率"><i class="fa fa-check"></i><b>2.2.2</b> 理想的猜测——古典概率</a></li>
<li class="chapter" data-level="2.2.3" data-path="概率与分布.html"><a href="概率与分布.html#数据的语言频率概率"><i class="fa fa-check"></i><b>2.2.3</b> 数据的语言——频率概率</a></li>
<li class="chapter" data-level="2.2.4" data-path="概率与分布.html"><a href="概率与分布.html#动态的更新贝叶斯概率"><i class="fa fa-check"></i><b>2.2.4</b> 动态的更新——贝叶斯概率</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="概率与分布.html"><a href="概率与分布.html#随机变量与分布"><i class="fa fa-check"></i><b>2.3</b> 随机变量与分布</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="概率与分布.html"><a href="概率与分布.html#概率分布"><i class="fa fa-check"></i><b>2.3.1</b> 概率分布</a></li>
<li class="chapter" data-level="2.3.2" data-path="概率与分布.html"><a href="概率与分布.html#累积概率分布从可能性到确定性"><i class="fa fa-check"></i><b>2.3.2</b> 累积概率分布：从可能性到确定性</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="概率与分布.html"><a href="概率与分布.html#午餐菜单离散随机变量的分布家族"><i class="fa fa-check"></i><b>2.4</b> 午餐菜单：离散随机变量的分布家族</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="概率与分布.html"><a href="概率与分布.html#伯努利分布一个是或否的终极问题"><i class="fa fa-check"></i><b>2.4.1</b> 伯努利分布：一个”是”或”否”的终极问题</a></li>
<li class="chapter" data-level="2.4.2" data-path="概率与分布.html"><a href="概率与分布.html#二项分布重复是非题的计数法则"><i class="fa fa-check"></i><b>2.4.2</b> 二项分布：重复”是非题”的计数法则</a></li>
<li class="chapter" data-level="2.4.3" data-path="概率与分布.html"><a href="概率与分布.html#多项式分布多元选择的全景图"><i class="fa fa-check"></i><b>2.4.3</b> 多项式分布：多元选择的”全景图”</a></li>
<li class="chapter" data-level="2.4.4" data-path="概率与分布.html"><a href="概率与分布.html#泊松分布罕见事件的低语者"><i class="fa fa-check"></i><b>2.4.4</b> 泊松分布：罕见事件的”低语者”</a></li>
<li class="chapter" data-level="2.4.5" data-path="概率与分布.html"><a href="概率与分布.html#几何分布等待第一次成功的耐心"><i class="fa fa-check"></i><b>2.4.5</b> 几何分布：等待”第一次成功”的耐心</a></li>
<li class="chapter" data-level="2.4.6" data-path="概率与分布.html"><a href="概率与分布.html#负二项分布等待最后一次成功的耐心"><i class="fa fa-check"></i><b>2.4.6</b> 负二项分布：等待”最后一次成功”的耐心</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="概率与分布.html"><a href="概率与分布.html#午餐法则连续随机变量的分布家族"><i class="fa fa-check"></i><b>2.5</b> 午餐法则：连续随机变量的分布家族</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="概率与分布.html"><a href="概率与分布.html#均匀分布纯粹的平等"><i class="fa fa-check"></i><b>2.5.1</b> 均匀分布：纯粹的平等</a></li>
<li class="chapter" data-level="2.5.2" data-path="概率与分布.html"><a href="概率与分布.html#指数分布等待的艺术"><i class="fa fa-check"></i><b>2.5.2</b> 指数分布：等待的艺术</a></li>
<li class="chapter" data-level="2.5.3" data-path="概率与分布.html"><a href="概率与分布.html#正态分布高斯分布自然界的钟形法则"><i class="fa fa-check"></i><b>2.5.3</b> 正态分布（高斯分布）：自然界的”钟形”法则</a></li>
<li class="chapter" data-level="2.5.4" data-path="概率与分布.html"><a href="概率与分布.html#威布尔分布生存分析的时间法则"><i class="fa fa-check"></i><b>2.5.4</b> 威布尔分布：生存分析的”时间法则”</a></li>
<li class="chapter" data-level="2.5.5" data-path="概率与分布.html"><a href="概率与分布.html#伽马分布更一般的等待时间模型"><i class="fa fa-check"></i><b>2.5.5</b> 伽马分布：更一般的等待时间模型</a></li>
<li class="chapter" data-level="2.5.6" data-path="概率与分布.html"><a href="概率与分布.html#贝塔分布比例变量的天然选择"><i class="fa fa-check"></i><b>2.5.6</b> 贝塔分布：比例变量的天然选择</a></li>
<li class="chapter" data-level="2.5.7" data-path="概率与分布.html"><a href="概率与分布.html#正态的魔力中心极限定理"><i class="fa fa-check"></i><b>2.5.7</b> 正态的魔力：中心极限定理</a></li>
<li class="chapter" data-level="2.5.8" data-path="概率与分布.html"><a href="概率与分布.html#生态学应用实例"><i class="fa fa-check"></i><b>2.5.8</b> 生态学应用实例</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="概率与分布.html"><a href="概率与分布.html#混合分布处理异质性数据"><i class="fa fa-check"></i><b>2.6</b> 混合分布：处理异质性数据</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="概率与分布.html"><a href="概率与分布.html#零膨胀分布处理零值过多的数据"><i class="fa fa-check"></i><b>2.6.1</b> 零膨胀分布：处理零值过多的数据</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="概率与分布.html"><a href="概率与分布.html#总结-2"><i class="fa fa-check"></i><b>2.7</b> 总结</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="描述统计.html"><a href="描述统计.html"><i class="fa fa-check"></i><b>3</b> 描述统计</a>
<ul>
<li class="chapter" data-level="3.1" data-path="描述统计.html"><a href="描述统计.html#引言-2"><i class="fa fa-check"></i><b>3.1</b> 引言</a></li>
<li class="chapter" data-level="3.2" data-path="描述统计.html"><a href="描述统计.html#描述统计基础"><i class="fa fa-check"></i><b>3.2</b> 描述统计基础</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="描述统计.html"><a href="描述统计.html#中心趋势测量"><i class="fa fa-check"></i><b>3.2.1</b> 中心趋势测量</a></li>
<li class="chapter" data-level="3.2.2" data-path="描述统计.html"><a href="描述统计.html#离散性测量"><i class="fa fa-check"></i><b>3.2.2</b> 离散性测量</a></li>
<li class="chapter" data-level="3.2.3" data-path="描述统计.html"><a href="描述统计.html#分布形状与矩测量"><i class="fa fa-check"></i><b>3.2.3</b> 分布形状与矩测量</a></li>
<li class="chapter" data-level="3.2.4" data-path="描述统计.html"><a href="描述统计.html#统计概念在概率分布图上的可视化"><i class="fa fa-check"></i><b>3.2.4</b> 统计概念在概率分布图上的可视化</a></li>
<li class="chapter" data-level="3.2.5" data-path="描述统计.html"><a href="描述统计.html#标准误的可视化理解"><i class="fa fa-check"></i><b>3.2.5</b> 标准误的可视化理解</a></li>
<li class="chapter" data-level="3.2.6" data-path="描述统计.html"><a href="描述统计.html#不同参数值的分布形状比较"><i class="fa fa-check"></i><b>3.2.6</b> 不同参数值的分布形状比较</a></li>
<li class="chapter" data-level="3.2.7" data-path="描述统计.html"><a href="描述统计.html#生态学意义总结"><i class="fa fa-check"></i><b>3.2.7</b> 生态学意义总结</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="描述统计.html"><a href="描述统计.html#环境异质性描述"><i class="fa fa-check"></i><b>3.3</b> 环境异质性描述</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="描述统计.html"><a href="描述统计.html#环境异质性的概念"><i class="fa fa-check"></i><b>3.3.1</b> 环境异质性的概念</a></li>
<li class="chapter" data-level="3.3.2" data-path="描述统计.html"><a href="描述统计.html#环境异质性的可视化理解"><i class="fa fa-check"></i><b>3.3.2</b> 环境异质性的可视化理解</a></li>
<li class="chapter" data-level="3.3.3" data-path="描述统计.html"><a href="描述统计.html#环境异质性的量化方法"><i class="fa fa-check"></i><b>3.3.3</b> 环境异质性的量化方法</a></li>
<li class="chapter" data-level="3.3.4" data-path="描述统计.html"><a href="描述统计.html#环境异质性的生态学意义"><i class="fa fa-check"></i><b>3.3.4</b> 环境异质性的生态学意义</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="描述统计.html"><a href="描述统计.html#个体特征描述"><i class="fa fa-check"></i><b>3.4</b> 个体特征描述</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="描述统计.html"><a href="描述统计.html#生存函数survival-function"><i class="fa fa-check"></i><b>3.4.1</b> 生存函数（Survival Function）</a></li>
<li class="chapter" data-level="3.4.2" data-path="描述统计.html"><a href="描述统计.html#瞬时死亡风险函数hazard-function"><i class="fa fa-check"></i><b>3.4.2</b> 瞬时死亡风险函数（Hazard Function）</a></li>
<li class="chapter" data-level="3.4.3" data-path="描述统计.html"><a href="描述统计.html#累积风险函数cumulative-hazard-function"><i class="fa fa-check"></i><b>3.4.3</b> 累积风险函数（Cumulative Hazard Function）</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="描述统计.html"><a href="描述统计.html#种群特征描述"><i class="fa fa-check"></i><b>3.5</b> 种群特征描述</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="描述统计.html"><a href="描述统计.html#gini系数"><i class="fa fa-check"></i><b>3.5.1</b> Gini系数</a></li>
<li class="chapter" data-level="3.5.2" data-path="描述统计.html"><a href="描述统计.html#lorenz曲线"><i class="fa fa-check"></i><b>3.5.2</b> Lorenz曲线</a></li>
<li class="chapter" data-level="3.5.3" data-path="描述统计.html"><a href="描述统计.html#基尼系数的生态学应用"><i class="fa fa-check"></i><b>3.5.3</b> 基尼系数的生态学应用</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="描述统计.html"><a href="描述统计.html#群落特征描述"><i class="fa fa-check"></i><b>3.6</b> 群落特征描述</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="描述统计.html"><a href="描述统计.html#物种多样性描述"><i class="fa fa-check"></i><b>3.6.1</b> 物种多样性描述</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="描述统计.html"><a href="描述统计.html#生态网络特征描述"><i class="fa fa-check"></i><b>3.7</b> 生态网络特征描述</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="描述统计.html"><a href="描述统计.html#网络拓扑指标"><i class="fa fa-check"></i><b>3.7.1</b> 网络拓扑指标</a></li>
<li class="chapter" data-level="3.7.2" data-path="描述统计.html"><a href="描述统计.html#食物网特征"><i class="fa fa-check"></i><b>3.7.2</b> 食物网特征</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="描述统计.html"><a href="描述统计.html#稳定性描述"><i class="fa fa-check"></i><b>3.8</b> 稳定性描述</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="描述统计.html"><a href="描述统计.html#抵抗力resistance"><i class="fa fa-check"></i><b>3.8.1</b> 抵抗力（Resistance）</a></li>
<li class="chapter" data-level="3.8.2" data-path="描述统计.html"><a href="描述统计.html#恢复力resilience"><i class="fa fa-check"></i><b>3.8.2</b> 恢复力（Resilience）</a></li>
<li class="chapter" data-level="3.8.3" data-path="描述统计.html"><a href="描述统计.html#持久性persistence"><i class="fa fa-check"></i><b>3.8.3</b> 持久性（Persistence）</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="描述统计.html"><a href="描述统计.html#总结-3"><i class="fa fa-check"></i><b>3.9</b> 总结</a></li>
<li class="chapter" data-level="3.10" data-path="描述统计.html"><a href="描述统计.html#综合练习-1"><i class="fa fa-check"></i><b>3.10</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="参数估计.html"><a href="参数估计.html"><i class="fa fa-check"></i><b>4</b> 参数估计</a>
<ul>
<li class="chapter" data-level="4.1" data-path="参数估计.html"><a href="参数估计.html#引言-3"><i class="fa fa-check"></i><b>4.1</b> 引言</a></li>
<li class="chapter" data-level="4.2" data-path="参数估计.html"><a href="参数估计.html#样本与总体"><i class="fa fa-check"></i><b>4.2</b> 样本与总体</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="参数估计.html"><a href="参数估计.html#抽样方法及其生态学应用"><i class="fa fa-check"></i><b>4.2.1</b> 抽样方法及其生态学应用</a></li>
<li class="chapter" data-level="4.2.2" data-path="参数估计.html"><a href="参数估计.html#r语言中的抽样实现"><i class="fa fa-check"></i><b>4.2.2</b> R语言中的抽样实现</a></li>
<li class="chapter" data-level="4.2.3" data-path="参数估计.html"><a href="参数估计.html#抽样误差与样本量确定"><i class="fa fa-check"></i><b>4.2.3</b> 抽样误差与样本量确定</a></li>
<li class="chapter" data-level="4.2.4" data-path="参数估计.html"><a href="参数估计.html#生态学抽样设计的实践考虑"><i class="fa fa-check"></i><b>4.2.4</b> 生态学抽样设计的实践考虑</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="参数估计.html"><a href="参数估计.html#参数估计基础"><i class="fa fa-check"></i><b>4.3</b> 参数估计基础</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="参数估计.html"><a href="参数估计.html#点估计"><i class="fa fa-check"></i><b>4.3.1</b> 点估计</a></li>
<li class="chapter" data-level="4.3.2" data-path="参数估计.html"><a href="参数估计.html#区间估计"><i class="fa fa-check"></i><b>4.3.2</b> 区间估计</a></li>
<li class="chapter" data-level="4.3.3" data-path="参数估计.html"><a href="参数估计.html#估计方法"><i class="fa fa-check"></i><b>4.3.3</b> 估计方法</a></li>
<li class="chapter" data-level="4.3.4" data-path="参数估计.html"><a href="参数估计.html#估计量性质如何评价一个估计方法的好坏"><i class="fa fa-check"></i><b>4.3.4</b> 估计量性质：如何评价一个估计方法的好坏？</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="参数估计.html"><a href="参数估计.html#种群大小估计"><i class="fa fa-check"></i><b>4.4</b> 种群大小估计</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="参数估计.html"><a href="参数估计.html#标记重捕法"><i class="fa fa-check"></i><b>4.4.1</b> 标记重捕法</a></li>
<li class="chapter" data-level="4.4.2" data-path="参数估计.html"><a href="参数估计.html#面积取样法"><i class="fa fa-check"></i><b>4.4.2</b> 面积取样法</a></li>
<li class="chapter" data-level="4.4.3" data-path="参数估计.html"><a href="参数估计.html#距离抽样法"><i class="fa fa-check"></i><b>4.4.3</b> 距离抽样法</a></li>
<li class="chapter" data-level="4.4.4" data-path="参数估计.html"><a href="参数估计.html#去除法"><i class="fa fa-check"></i><b>4.4.4</b> 去除法</a></li>
<li class="chapter" data-level="4.4.5" data-path="参数估计.html"><a href="参数估计.html#种群大小估计方法的选择与比较"><i class="fa fa-check"></i><b>4.4.5</b> 种群大小估计方法的选择与比较</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="参数估计.html"><a href="参数估计.html#稀有种估计"><i class="fa fa-check"></i><b>4.5</b> 稀有种估计</a></li>
<li class="chapter" data-level="4.6" data-path="参数估计.html"><a href="参数估计.html#物种多样性估计"><i class="fa fa-check"></i><b>4.6</b> 物种多样性估计</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="参数估计.html"><a href="参数估计.html#外推和内插方法"><i class="fa fa-check"></i><b>4.6.1</b> 外推和内插方法</a></li>
<li class="chapter" data-level="4.6.2" data-path="参数估计.html"><a href="参数估计.html#多样性估计的抽样偏差"><i class="fa fa-check"></i><b>4.6.2</b> 多样性估计的抽样偏差</a></li>
<li class="chapter" data-level="4.6.3" data-path="参数估计.html"><a href="参数估计.html#多样性估计方法的选择与比较"><i class="fa fa-check"></i><b>4.6.3</b> 多样性估计方法的选择与比较</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="参数估计.html"><a href="参数估计.html#总结-4"><i class="fa fa-check"></i><b>4.7</b> 总结</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="参数估计.html"><a href="参数估计.html#参数估计的生态学意义与理论基础"><i class="fa fa-check"></i><b>4.7.1</b> 参数估计的生态学意义与理论基础</a></li>
<li class="chapter" data-level="4.7.2" data-path="参数估计.html"><a href="参数估计.html#点估计与区间估计从单一数值到可信范围"><i class="fa fa-check"></i><b>4.7.2</b> 点估计与区间估计：从单一数值到可信范围</a></li>
<li class="chapter" data-level="4.7.3" data-path="参数估计.html"><a href="参数估计.html#主要估计方法及其生态学应用"><i class="fa fa-check"></i><b>4.7.3</b> 主要估计方法及其生态学应用</a></li>
<li class="chapter" data-level="4.7.4" data-path="参数估计.html"><a href="参数估计.html#种群大小估计生态学实践的核心任务"><i class="fa fa-check"></i><b>4.7.4</b> 种群大小估计：生态学实践的核心任务</a></li>
<li class="chapter" data-level="4.7.5" data-path="参数估计.html"><a href="参数估计.html#物种多样性估计群落生态学的量化基础"><i class="fa fa-check"></i><b>4.7.5</b> 物种多样性估计：群落生态学的量化基础</a></li>
<li class="chapter" data-level="4.7.6" data-path="参数估计.html"><a href="参数估计.html#参数估计在生态学决策中的重要性"><i class="fa fa-check"></i><b>4.7.6</b> 参数估计在生态学决策中的重要性</a></li>
<li class="chapter" data-level="4.7.7" data-path="参数估计.html"><a href="参数估计.html#未来发展方向与挑战"><i class="fa fa-check"></i><b>4.7.7</b> 未来发展方向与挑战</a></li>
<li class="chapter" data-level="4.7.8" data-path="参数估计.html"><a href="参数估计.html#结语"><i class="fa fa-check"></i><b>4.7.8</b> 结语</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="参数估计.html"><a href="参数估计.html#综合练习-2"><i class="fa fa-check"></i><b>4.8</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="相关性与相似性.html"><a href="相关性与相似性.html"><i class="fa fa-check"></i><b>5</b> 相关性与相似性</a>
<ul>
<li class="chapter" data-level="5.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#引言-4"><i class="fa fa-check"></i><b>5.1</b> 引言</a></li>
<li class="chapter" data-level="5.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#相关性统计基础"><i class="fa fa-check"></i><b>5.2</b> 相关性统计基础</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#相关分析"><i class="fa fa-check"></i><b>5.2.1</b> 相关分析</a></li>
<li class="chapter" data-level="5.2.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#偏相关分析"><i class="fa fa-check"></i><b>5.2.2</b> 偏相关分析</a></li>
<li class="chapter" data-level="5.2.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#距离相关"><i class="fa fa-check"></i><b>5.2.3</b> 距离相关</a></li>
<li class="chapter" data-level="5.2.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#互信息"><i class="fa fa-check"></i><b>5.2.4</b> 互信息</a></li>
<li class="chapter" data-level="5.2.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#非线性关系度量"><i class="fa fa-check"></i><b>5.2.5</b> 非线性关系度量</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#自相关"><i class="fa fa-check"></i><b>5.3</b> 自相关</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#时间自相关"><i class="fa fa-check"></i><b>5.3.1</b> 时间自相关</a></li>
<li class="chapter" data-level="5.3.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#空间自相关"><i class="fa fa-check"></i><b>5.3.2</b> 空间自相关</a></li>
<li class="chapter" data-level="5.3.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育相关性"><i class="fa fa-check"></i><b>5.3.3</b> 系统发育相关性</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#相似性与距离"><i class="fa fa-check"></i><b>5.4</b> 相似性与距离</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#常用相似性系数"><i class="fa fa-check"></i><b>5.4.1</b> 常用相似性系数</a></li>
<li class="chapter" data-level="5.4.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#功能性状间相关性"><i class="fa fa-check"></i><b>5.4.2</b> 功能性状间相关性</a></li>
<li class="chapter" data-level="5.4.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#种内相关性"><i class="fa fa-check"></i><b>5.4.3</b> 种内相关性</a></li>
<li class="chapter" data-level="5.4.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#种间相关性"><i class="fa fa-check"></i><b>5.4.4</b> 种间相关性</a></li>
<li class="chapter" data-level="5.4.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#群落相似性"><i class="fa fa-check"></i><b>5.4.5</b> 群落相似性</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#总结-5"><i class="fa fa-check"></i><b>5.5</b> 总结</a></li>
<li class="chapter" data-level="5.6" data-path="相关性与相似性.html"><a href="相关性与相似性.html#综合练习-3"><i class="fa fa-check"></i><b>5.6</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html"><i class="fa fa-check"></i><b>6</b> 基于经典分布的假设检验</a>
<ul>
<li class="chapter" data-level="6.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#引言-5"><i class="fa fa-check"></i><b>6.1</b> 引言</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#假设检验基础"><i class="fa fa-check"></i><b>6.1.1</b> 假设检验基础</a></li>
<li class="chapter" data-level="6.1.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#假设检验的基本步骤"><i class="fa fa-check"></i><b>6.1.2</b> 假设检验的基本步骤</a></li>
<li class="chapter" data-level="6.1.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#零假设与备择假设"><i class="fa fa-check"></i><b>6.1.3</b> 零假设与备择假设</a></li>
<li class="chapter" data-level="6.1.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#检验统计量与p值"><i class="fa fa-check"></i><b>6.1.4</b> 检验统计量与p值</a></li>
<li class="chapter" data-level="6.1.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#显著性水平"><i class="fa fa-check"></i><b>6.1.5</b> 显著性水平</a></li>
<li class="chapter" data-level="6.1.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#效应大小与置信区间"><i class="fa fa-check"></i><b>6.1.6</b> 效应大小与置信区间</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本检验"><i class="fa fa-check"></i><b>6.2</b> 单样本检验</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本t检验"><i class="fa fa-check"></i><b>6.2.1</b> 单样本t检验</a></li>
<li class="chapter" data-level="6.2.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本符号检验"><i class="fa fa-check"></i><b>6.2.2</b> 单样本符号检验</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#双样本检验"><i class="fa fa-check"></i><b>6.3</b> 双样本检验</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#独立样本t检验"><i class="fa fa-check"></i><b>6.3.1</b> 独立样本t检验</a></li>
<li class="chapter" data-level="6.3.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#配对样本t检验"><i class="fa fa-check"></i><b>6.3.2</b> 配对样本t检验</a></li>
<li class="chapter" data-level="6.3.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#mann-whitney-u检验"><i class="fa fa-check"></i><b>6.3.3</b> Mann-Whitney U检验</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多样本检验"><i class="fa fa-check"></i><b>6.4</b> 多样本检验</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#方差分析anova"><i class="fa fa-check"></i><b>6.4.1</b> 方差分析（ANOVA）</a></li>
<li class="chapter" data-level="6.4.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#kruskal-wallis检验"><i class="fa fa-check"></i><b>6.4.2</b> Kruskal-Wallis检验</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#非参数检验方法"><i class="fa fa-check"></i><b>6.5</b> 非参数检验方法</a></li>
<li class="chapter" data-level="6.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较校正"><i class="fa fa-check"></i><b>6.6</b> 多重比较校正</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较问题的本质"><i class="fa fa-check"></i><b>6.6.1</b> 多重比较问题的本质</a></li>
<li class="chapter" data-level="6.6.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#bonferroni校正"><i class="fa fa-check"></i><b>6.6.2</b> Bonferroni校正</a></li>
<li class="chapter" data-level="6.6.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#tukey-hsd检验"><i class="fa fa-check"></i><b>6.6.3</b> Tukey HSD检验</a></li>
<li class="chapter" data-level="6.6.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#fdr错误发现率控制"><i class="fa fa-check"></i><b>6.6.4</b> FDR（错误发现率）控制</a></li>
<li class="chapter" data-level="6.6.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#生态学实例森林类型对鸟类多样性的影响"><i class="fa fa-check"></i><b>6.6.5</b> 生态学实例：森林类型对鸟类多样性的影响</a></li>
<li class="chapter" data-level="6.6.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较校正效果的可视化"><i class="fa fa-check"></i><b>6.6.6</b> 多重比较校正效果的可视化</a></li>
<li class="chapter" data-level="6.6.7" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#实用建议与最佳实践"><i class="fa fa-check"></i><b>6.6.7</b> 实用建议与最佳实践</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#功效分析"><i class="fa fa-check"></i><b>6.7</b> 功效分析</a></li>
<li class="chapter" data-level="6.8" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#总结-6"><i class="fa fa-check"></i><b>6.8</b> 总结</a></li>
<li class="chapter" data-level="6.9" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#综合练习-4"><i class="fa fa-check"></i><b>6.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html"><i class="fa fa-check"></i><b>7</b> 基于模拟的假设检验</a>
<ul>
<li class="chapter" data-level="7.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#引言-6"><i class="fa fa-check"></i><b>7.1</b> 引言</a></li>
<li class="chapter" data-level="7.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学层次与演进脉络"><i class="fa fa-check"></i><b>7.2</b> 方法学层次与演进脉络</a></li>
<li class="chapter" data-level="7.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验"><i class="fa fa-check"></i><b>7.3</b> 置换检验</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验的基本原理"><i class="fa fa-check"></i><b>7.3.1</b> 置换检验的基本原理</a></li>
<li class="chapter" data-level="7.3.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验的技术实现过程"><i class="fa fa-check"></i><b>7.3.2</b> 置换检验的技术实现过程</a></li>
<li class="chapter" data-level="7.3.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例"><i class="fa fa-check"></i><b>7.3.3</b> R语言实现示例</a></li>
<li class="chapter" data-level="7.3.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验在生态学中的应用价值与局限"><i class="fa fa-check"></i><b>7.3.4</b> 置换检验在生态学中的应用价值与局限</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验"><i class="fa fa-check"></i><b>7.4</b> 蒙特卡洛检验</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛方法的概念体系"><i class="fa fa-check"></i><b>7.4.1</b> 蒙特卡洛方法的概念体系</a></li>
<li class="chapter" data-level="7.4.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验的基本原理"><i class="fa fa-check"></i><b>7.4.2</b> 蒙特卡洛检验的基本原理</a></li>
<li class="chapter" data-level="7.4.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验的主要类型"><i class="fa fa-check"></i><b>7.4.3</b> 蒙特卡洛检验的主要类型</a></li>
<li class="chapter" data-level="7.4.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例空间分布随机性检验"><i class="fa fa-check"></i><b>7.4.4</b> R语言实现示例：空间分布随机性检验</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法检验"><i class="fa fa-check"></i><b>7.5</b> 自助法检验</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的基本原理"><i class="fa fa-check"></i><b>7.5.1</b> 自助法的基本原理</a></li>
<li class="chapter" data-level="7.5.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的实施步骤"><i class="fa fa-check"></i><b>7.5.2</b> 自助法的实施步骤</a></li>
<li class="chapter" data-level="7.5.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法在生态学中的应用"><i class="fa fa-check"></i><b>7.5.3</b> 自助法在生态学中的应用</a></li>
<li class="chapter" data-level="7.5.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例-1"><i class="fa fa-check"></i><b>7.5.4</b> R语言实现示例</a></li>
<li class="chapter" data-level="7.5.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的优势与局限"><i class="fa fa-check"></i><b>7.5.5</b> 自助法的优势与局限</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#基因型频率检验"><i class="fa fa-check"></i><b>7.6</b> 基因型频率检验</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#hardy-weinberg平衡检验"><i class="fa fa-check"></i><b>7.6.1</b> Hardy-Weinberg平衡检验</a></li>
<li class="chapter" data-level="7.6.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#连锁不平衡检验"><i class="fa fa-check"></i><b>7.6.2</b> 连锁不平衡检验</a></li>
<li class="chapter" data-level="7.6.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与选择建议"><i class="fa fa-check"></i><b>7.6.3</b> 方法学比较与选择建议</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#多样性差异检验"><i class="fa fa-check"></i><b>7.7</b> 多样性差异检验</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#群落多样性比较"><i class="fa fa-check"></i><b>7.7.1</b> 群落多样性比较</a></li>
<li class="chapter" data-level="7.7.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#相似性分析anosim"><i class="fa fa-check"></i><b>7.7.2</b> 相似性分析（ANOSIM）</a></li>
<li class="chapter" data-level="7.7.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与生态学应用建议"><i class="fa fa-check"></i><b>7.7.3</b> 方法学比较与生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#物种空间分布检验"><i class="fa fa-check"></i><b>7.8</b> 物种空间分布检验</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#空间分布模式检验"><i class="fa fa-check"></i><b>7.8.1</b> 空间分布模式检验</a></li>
<li class="chapter" data-level="7.8.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#点过程模型检验"><i class="fa fa-check"></i><b>7.8.2</b> 点过程模型检验</a></li>
<li class="chapter" data-level="7.8.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#空间生态学的统计挑战与解决方案"><i class="fa fa-check"></i><b>7.8.3</b> 空间生态学的统计挑战与解决方案</a></li>
<li class="chapter" data-level="7.8.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学应用与保护意义"><i class="fa fa-check"></i><b>7.8.4</b> 生态学应用与保护意义</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育信号检验"><i class="fa fa-check"></i><b>7.9</b> 系统发育信号检验</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育保守性检验"><i class="fa fa-check"></i><b>7.9.1</b> 系统发育保守性检验</a></li>
<li class="chapter" data-level="7.9.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育独立对比"><i class="fa fa-check"></i><b>7.9.2</b> 系统发育独立对比</a></li>
<li class="chapter" data-level="7.9.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与生态学应用建议-1"><i class="fa fa-check"></i><b>7.9.3</b> 方法学比较与生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学零模型检验"><i class="fa fa-check"></i><b>7.10</b> 生态学零模型检验</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#零模型的基本概念与生态学意义"><i class="fa fa-check"></i><b>7.10.1</b> 零模型的基本概念与生态学意义</a></li>
<li class="chapter" data-level="7.10.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#群落组装零模型检验"><i class="fa fa-check"></i><b>7.10.2</b> 群落组装零模型检验</a></li>
<li class="chapter" data-level="7.10.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态网络零模型检验"><i class="fa fa-check"></i><b>7.10.3</b> 生态网络零模型检验</a></li>
<li class="chapter" data-level="7.10.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#零模型检验的方法学比较与选择"><i class="fa fa-check"></i><b>7.10.4</b> 零模型检验的方法学比较与选择</a></li>
<li class="chapter" data-level="7.10.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学应用与保护意义-1"><i class="fa fa-check"></i><b>7.10.5</b> 生态学应用与保护意义</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#总结-7"><i class="fa fa-check"></i><b>7.11</b> 总结</a></li>
<li class="chapter" data-level="7.12" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#综合练习-5"><i class="fa fa-check"></i><b>7.12</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html"><i class="fa fa-check"></i><b>8</b> 简单线性回归模型</a>
<ul>
<li class="chapter" data-level="8.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#引言-7"><i class="fa fa-check"></i><b>8.1</b> 引言</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#为什么生态学本科生需要学习统计建模与预测"><i class="fa fa-check"></i><b>8.1.1</b> 为什么生态学本科生需要学习统计建模与预测？</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#线性回归模型生态关系的数学表达"><i class="fa fa-check"></i><b>8.2</b> 线性回归模型：生态关系的数学表达</a></li>
<li class="chapter" data-level="8.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#最小二乘估计"><i class="fa fa-check"></i><b>8.3</b> 最小二乘估计</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的lm函数详解"><i class="fa fa-check"></i><b>8.3.1</b> R语言中的lm()函数详解</a></li>
<li class="chapter" data-level="8.3.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#lm函数的基本语法"><i class="fa fa-check"></i><b>8.3.2</b> lm()函数的基本语法</a></li>
<li class="chapter" data-level="8.3.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型公式的详细说明"><i class="fa fa-check"></i><b>8.3.3</b> 模型公式的详细说明</a></li>
<li class="chapter" data-level="8.3.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#lm函数的返回对象"><i class="fa fa-check"></i><b>8.3.4</b> lm()函数的返回对象</a></li>
<li class="chapter" data-level="8.3.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#提取回归结果的常用函数"><i class="fa fa-check"></i><b>8.3.5</b> 提取回归结果的常用函数</a></li>
<li class="chapter" data-level="8.3.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#理解summary函数的输出"><i class="fa fa-check"></i><b>8.3.6</b> 理解summary()函数的输出</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#回归诊断验证模型的生态学合理性"><i class="fa fa-check"></i><b>8.4</b> 回归诊断：验证模型的生态学合理性</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#回归诊断图的系统解读"><i class="fa fa-check"></i><b>8.4.1</b> 回归诊断图的系统解读</a></li>
<li class="chapter" data-level="8.4.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型质量的综合评估"><i class="fa fa-check"></i><b>8.4.2</b> 模型质量的综合评估</a></li>
<li class="chapter" data-level="8.4.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学诊断问题的应对策略"><i class="fa fa-check"></i><b>8.4.3</b> 生态学诊断问题的应对策略</a></li>
<li class="chapter" data-level="8.4.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用实例-1"><i class="fa fa-check"></i><b>8.4.4</b> 生态学应用实例</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归多因子生态关系的综合分析"><i class="fa fa-check"></i><b>8.5</b> 多元线性回归：多因子生态关系的综合分析</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归的模型公式"><i class="fa fa-check"></i><b>8.5.1</b> 多元线性回归的模型公式</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多元线性回归中的变量选择"><i class="fa fa-check"></i><b>8.6</b> 多元线性回归中的变量选择</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择的重要性"><i class="fa fa-check"></i><b>8.6.1</b> 变量选择的重要性</a></li>
<li class="chapter" data-level="8.6.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择的基本原则"><i class="fa fa-check"></i><b>8.6.2</b> 变量选择的基本原则</a></li>
<li class="chapter" data-level="8.6.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#常用的变量选择方法"><i class="fa fa-check"></i><b>8.6.3</b> 常用的变量选择方法</a></li>
<li class="chapter" data-level="8.6.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的模型选择实现"><i class="fa fa-check"></i><b>8.6.4</b> R语言中的模型选择实现</a></li>
<li class="chapter" data-level="8.6.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学变量选择的实践建议"><i class="fa fa-check"></i><b>8.6.5</b> 生态学变量选择的实践建议</a></li>
<li class="chapter" data-level="8.6.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型选择的注意事项"><i class="fa fa-check"></i><b>8.6.6</b> 模型选择的注意事项</a></li>
<li class="chapter" data-level="8.6.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#完整生态学案例分析鸟类丰富度与环境因子的关系"><i class="fa fa-check"></i><b>8.6.7</b> 完整生态学案例分析：鸟类丰富度与环境因子的关系</a></li>
<li class="chapter" data-level="8.6.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#完整模型拟合"><i class="fa fa-check"></i><b>8.6.8</b> 完整模型拟合</a></li>
<li class="chapter" data-level="8.6.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#变量选择过程"><i class="fa fa-check"></i><b>8.6.9</b> 变量选择过程</a></li>
<li class="chapter" data-level="8.6.10" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#最优模型选择与结果解释"><i class="fa fa-check"></i><b>8.6.10</b> 最优模型选择与结果解释</a></li>
<li class="chapter" data-level="8.6.11" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型诊断与假设检验"><i class="fa fa-check"></i><b>8.6.11</b> 模型诊断与假设检验</a></li>
<li class="chapter" data-level="8.6.12" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型预测与应用"><i class="fa fa-check"></i><b>8.6.12</b> 模型预测与应用</a></li>
<li class="chapter" data-level="8.6.13" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型比较与评估"><i class="fa fa-check"></i><b>8.6.13</b> 模型比较与评估</a></li>
<li class="chapter" data-level="8.6.14" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学解释与模型选择价值"><i class="fa fa-check"></i><b>8.6.14</b> 生态学解释与模型选择价值</a></li>
<li class="chapter" data-level="8.6.15" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#案例分析总结"><i class="fa fa-check"></i><b>8.6.15</b> 案例分析总结</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归非线性生态关系的数学描述"><i class="fa fa-check"></i><b>8.7</b> 多项式回归：非线性生态关系的数学描述</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归模型"><i class="fa fa-check"></i><b>8.7.1</b> 多项式回归模型</a></li>
<li class="chapter" data-level="8.7.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#r语言中的多项式回归实现"><i class="fa fa-check"></i><b>8.7.2</b> R语言中的多项式回归实现</a></li>
<li class="chapter" data-level="8.7.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用实例-2"><i class="fa fa-check"></i><b>8.7.3</b> 生态学应用实例</a></li>
<li class="chapter" data-level="8.7.4" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归的生态学意义"><i class="fa fa-check"></i><b>8.7.4</b> 多项式回归的生态学意义</a></li>
<li class="chapter" data-level="8.7.5" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式阶数的选择"><i class="fa fa-check"></i><b>8.7.5</b> 多项式阶数的选择</a></li>
<li class="chapter" data-level="8.7.6" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#多项式回归的注意事项"><i class="fa fa-check"></i><b>8.7.6</b> 多项式回归的注意事项</a></li>
<li class="chapter" data-level="8.7.7" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#过度拟合问题演示"><i class="fa fa-check"></i><b>8.7.7</b> 过度拟合问题演示</a></li>
<li class="chapter" data-level="8.7.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#模型可视化与比较"><i class="fa fa-check"></i><b>8.7.8</b> 模型可视化与比较</a></li>
<li class="chapter" data-level="8.7.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#统计指标与交叉验证"><i class="fa fa-check"></i><b>8.7.9</b> 统计指标与交叉验证</a></li>
<li class="chapter" data-level="8.7.10" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学应用建议"><i class="fa fa-check"></i><b>8.7.10</b> 生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#总结从线性到非线性从简单到复杂"><i class="fa fa-check"></i><b>8.8</b> 总结：从线性到非线性，从简单到复杂</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#核心概念回顾"><i class="fa fa-check"></i><b>8.8.1</b> 核心概念回顾</a></li>
<li class="chapter" data-level="8.8.2" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#生态学建模思维"><i class="fa fa-check"></i><b>8.8.2</b> 生态学建模思维</a></li>
<li class="chapter" data-level="8.8.3" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#实践应用价值"><i class="fa fa-check"></i><b>8.8.3</b> 实践应用价值</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="简单线性回归模型.html"><a href="简单线性回归模型.html#综合练习-6"><i class="fa fa-check"></i><b>8.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="模型选择与评估.html"><a href="模型选择与评估.html"><i class="fa fa-check"></i><b>9</b> 模型选择与评估</a>
<ul>
<li class="chapter" data-level="9.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#引言-8"><i class="fa fa-check"></i><b>9.1</b> 引言</a></li>
<li class="chapter" data-level="9.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型选择"><i class="fa fa-check"></i><b>9.2</b> 模型选择</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型选择原则"><i class="fa fa-check"></i><b>9.2.1</b> 模型选择原则</a></li>
<li class="chapter" data-level="9.2.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#信息准则"><i class="fa fa-check"></i><b>9.2.2</b> 信息准则</a></li>
<li class="chapter" data-level="9.2.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#似然比检验"><i class="fa fa-check"></i><b>9.2.3</b> 似然比检验</a></li>
<li class="chapter" data-level="9.2.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型平均"><i class="fa fa-check"></i><b>9.2.4</b> 模型平均</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型评估"><i class="fa fa-check"></i><b>9.3</b> 模型评估</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#交叉验证"><i class="fa fa-check"></i><b>9.3.1</b> 交叉验证</a></li>
<li class="chapter" data-level="9.3.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#外部验证"><i class="fa fa-check"></i><b>9.3.2</b> 外部验证</a></li>
<li class="chapter" data-level="9.3.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型诊断"><i class="fa fa-check"></i><b>9.3.3</b> 模型诊断</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型选择与评估"><i class="fa fa-check"></i><b>9.4</b> 贝叶斯模型选择与评估</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯与频率学派的根本差异"><i class="fa fa-check"></i><b>9.4.1</b> 贝叶斯与频率学派的根本差异</a></li>
<li class="chapter" data-level="9.4.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型选择基本原理"><i class="fa fa-check"></i><b>9.4.2</b> 贝叶斯模型选择基本原理</a></li>
<li class="chapter" data-level="9.4.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯假设检验流程"><i class="fa fa-check"></i><b>9.4.3</b> 贝叶斯假设检验流程</a></li>
<li class="chapter" data-level="9.4.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型比较与选择"><i class="fa fa-check"></i><b>9.4.4</b> 贝叶斯模型比较与选择</a></li>
<li class="chapter" data-level="9.4.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯可信区间"><i class="fa fa-check"></i><b>9.4.5</b> 贝叶斯可信区间</a></li>
<li class="chapter" data-level="9.4.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯因子计算与解释"><i class="fa fa-check"></i><b>9.4.6</b> 贝叶斯因子计算与解释</a></li>
<li class="chapter" data-level="9.4.7" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型平均"><i class="fa fa-check"></i><b>9.4.7</b> 贝叶斯模型平均</a></li>
<li class="chapter" data-level="9.4.8" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯预测评估"><i class="fa fa-check"></i><b>9.4.8</b> 贝叶斯预测评估</a></li>
<li class="chapter" data-level="9.4.9" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯变量选择"><i class="fa fa-check"></i><b>9.4.9</b> 贝叶斯变量选择</a></li>
<li class="chapter" data-level="9.4.10" data-path="模型选择与评估.html"><a href="模型选择与评估.html#生态学应用价值"><i class="fa fa-check"></i><b>9.4.10</b> 生态学应用价值</a></li>
<li class="chapter" data-level="9.4.11" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯检验的生态学应用案例"><i class="fa fa-check"></i><b>9.4.11</b> 贝叶斯检验的生态学应用案例</a></li>
<li class="chapter" data-level="9.4.12" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯方法的局限性"><i class="fa fa-check"></i><b>9.4.12</b> 贝叶斯方法的局限性</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#总结-8"><i class="fa fa-check"></i><b>9.5</b> 总结</a></li>
<li class="chapter" data-level="9.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#综合练习-7"><i class="fa fa-check"></i><b>9.6</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="高级回归模型.html"><a href="高级回归模型.html"><i class="fa fa-check"></i><b>10</b> 高级回归模型</a>
<ul>
<li class="chapter" data-level="10.1" data-path="高级回归模型.html"><a href="高级回归模型.html#引言-9"><i class="fa fa-check"></i><b>10.1</b> 引言</a></li>
<li class="chapter" data-level="10.2" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型"><i class="fa fa-check"></i><b>10.2</b> 可加性模型</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型的基本原理"><i class="fa fa-check"></i><b>10.2.1</b> 可加性模型的基本原理</a></li>
<li class="chapter" data-level="10.2.2" data-path="高级回归模型.html"><a href="高级回归模型.html#与线性模型的比较"><i class="fa fa-check"></i><b>10.2.2</b> 与线性模型的比较</a></li>
<li class="chapter" data-level="10.2.3" data-path="高级回归模型.html"><a href="高级回归模型.html#常见的平滑函数"><i class="fa fa-check"></i><b>10.2.3</b> 常见的平滑函数</a></li>
<li class="chapter" data-level="10.2.4" data-path="高级回归模型.html"><a href="高级回归模型.html#平滑函数选择的生态学考量"><i class="fa fa-check"></i><b>10.2.4</b> 平滑函数选择的生态学考量</a></li>
<li class="chapter" data-level="10.2.5" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型中的系数概念"><i class="fa fa-check"></i><b>10.2.5</b> 可加性模型中的”系数”概念</a></li>
<li class="chapter" data-level="10.2.6" data-path="高级回归模型.html"><a href="高级回归模型.html#在r中的实现"><i class="fa fa-check"></i><b>10.2.6</b> 在R中的实现</a></li>
<li class="chapter" data-level="10.2.7" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学应用示例"><i class="fa fa-check"></i><b>10.2.7</b> 生态学应用示例</a></li>
<li class="chapter" data-level="10.2.8" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型诊断"><i class="fa fa-check"></i><b>10.2.8</b> 可加性模型诊断</a></li>
<li class="chapter" data-level="10.2.9" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型的优势与局限"><i class="fa fa-check"></i><b>10.2.9</b> 可加性模型的优势与局限</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="高级回归模型.html"><a href="高级回归模型.html#广义线性回归"><i class="fa fa-check"></i><b>10.3</b> 广义线性回归</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="高级回归模型.html"><a href="高级回归模型.html#广义线性模型的基本框架"><i class="fa fa-check"></i><b>10.3.1</b> 广义线性模型的基本框架</a></li>
<li class="chapter" data-level="10.3.2" data-path="高级回归模型.html"><a href="高级回归模型.html#与普通线性回归的根本区别"><i class="fa fa-check"></i><b>10.3.2</b> 与普通线性回归的根本区别</a></li>
<li class="chapter" data-level="10.3.3" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的glm实现"><i class="fa fa-check"></i><b>10.3.3</b> R语言中的GLM实现</a></li>
<li class="chapter" data-level="10.3.4" data-path="高级回归模型.html"><a href="高级回归模型.html#常见glm类型及其生态学应用"><i class="fa fa-check"></i><b>10.3.4</b> 常见GLM类型及其生态学应用</a></li>
<li class="chapter" data-level="10.3.5" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与解释"><i class="fa fa-check"></i><b>10.3.5</b> 模型诊断与解释</a></li>
<li class="chapter" data-level="10.3.6" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学意义与注意事项"><i class="fa fa-check"></i><b>10.3.6</b> 生态学意义与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="高级回归模型.html"><a href="高级回归模型.html#广义可加模型"><i class="fa fa-check"></i><b>10.4</b> 广义可加模型</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="高级回归模型.html"><a href="高级回归模型.html#gam的基本原理"><i class="fa fa-check"></i><b>10.4.1</b> GAM的基本原理</a></li>
<li class="chapter" data-level="10.4.2" data-path="高级回归模型.html"><a href="高级回归模型.html#在r中的实现-1"><i class="fa fa-check"></i><b>10.4.2</b> 在R中的实现</a></li>
<li class="chapter" data-level="10.4.3" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学应用示例-1"><i class="fa fa-check"></i><b>10.4.3</b> 生态学应用示例</a></li>
<li class="chapter" data-level="10.4.4" data-path="高级回归模型.html"><a href="高级回归模型.html#gam在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.4.4</b> GAM在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.4.5" data-path="高级回归模型.html"><a href="高级回归模型.html#高级功能"><i class="fa fa-check"></i><b>10.4.5</b> 高级功能</a></li>
<li class="chapter" data-level="10.4.6" data-path="高级回归模型.html"><a href="高级回归模型.html#模型选择与诊断"><i class="fa fa-check"></i><b>10.4.6</b> 模型选择与诊断</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型"><i class="fa fa-check"></i><b>10.5</b> 混合效应模型</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="高级回归模型.html"><a href="高级回归模型.html#固定效应与随机效应的生态学概念"><i class="fa fa-check"></i><b>10.5.1</b> 固定效应与随机效应的生态学概念</a></li>
<li class="chapter" data-level="10.5.2" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型的数学框架"><i class="fa fa-check"></i><b>10.5.2</b> 混合效应模型的数学框架</a></li>
<li class="chapter" data-level="10.5.3" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的混合效应模型实现"><i class="fa fa-check"></i><b>10.5.3</b> R语言中的混合效应模型实现</a></li>
<li class="chapter" data-level="10.5.4" data-path="高级回归模型.html"><a href="高级回归模型.html#固定效应和随机效应的筛选"><i class="fa fa-check"></i><b>10.5.4</b> 固定效应和随机效应的筛选</a></li>
<li class="chapter" data-level="10.5.5" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.5.5</b> 混合效应模型在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.5.6" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项"><i class="fa fa-check"></i><b>10.5.6</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型"><i class="fa fa-check"></i><b>10.6</b> 时空自相关模型</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型与混合效应模型的联系与区别"><i class="fa fa-check"></i><b>10.6.1</b> 时空自相关模型与混合效应模型的联系与区别</a></li>
<li class="chapter" data-level="10.6.2" data-path="高级回归模型.html"><a href="高级回归模型.html#空间自相关与时间自相关的生态学概念"><i class="fa fa-check"></i><b>10.6.2</b> 空间自相关与时间自相关的生态学概念</a></li>
<li class="chapter" data-level="10.6.3" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型的数学框架"><i class="fa fa-check"></i><b>10.6.3</b> 时空自相关模型的数学框架</a></li>
<li class="chapter" data-level="10.6.4" data-path="高级回归模型.html"><a href="高级回归模型.html#时空模型框架的联系与区别"><i class="fa fa-check"></i><b>10.6.4</b> 时空模型框架的联系与区别</a></li>
<li class="chapter" data-level="10.6.5" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的时空自相关模型实现"><i class="fa fa-check"></i><b>10.6.5</b> R语言中的时空自相关模型实现</a></li>
<li class="chapter" data-level="10.6.6" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型的生态学应用"><i class="fa fa-check"></i><b>10.6.6</b> 时空自相关模型的生态学应用</a></li>
<li class="chapter" data-level="10.6.7" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项-1"><i class="fa fa-check"></i><b>10.6.7</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型"><i class="fa fa-check"></i><b>10.7</b> 结构方程模型</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型的基本框架"><i class="fa fa-check"></i><b>10.7.1</b> 结构方程模型的基本框架</a></li>
<li class="chapter" data-level="10.7.2" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的结构方程模型实现"><i class="fa fa-check"></i><b>10.7.2</b> R语言中的结构方程模型实现</a></li>
<li class="chapter" data-level="10.7.3" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.7.3</b> 结构方程模型在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.7.4" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项-2"><i class="fa fa-check"></i><b>10.7.4</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="高级回归模型.html"><a href="高级回归模型.html#总结-9"><i class="fa fa-check"></i><b>10.8</b> 总结</a></li>
<li class="chapter" data-level="10.9" data-path="高级回归模型.html"><a href="高级回归模型.html#综合练习-8"><i class="fa fa-check"></i><b>10.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="机器学习.html"><a href="机器学习.html"><i class="fa fa-check"></i><b>11</b> 机器学习</a>
<ul>
<li class="chapter" data-level="11.1" data-path="机器学习.html"><a href="机器学习.html#引言-10"><i class="fa fa-check"></i><b>11.1</b> 引言</a></li>
<li class="chapter" data-level="11.2" data-path="机器学习.html"><a href="机器学习.html#决策树"><i class="fa fa-check"></i><b>11.2</b> 决策树</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与原理"><i class="fa fa-check"></i><b>11.2.1</b> 基本概念与原理</a></li>
<li class="chapter" data-level="11.2.2" data-path="机器学习.html"><a href="机器学习.html#决策树构建原理"><i class="fa fa-check"></i><b>11.2.2</b> 决策树构建原理</a></li>
<li class="chapter" data-level="11.2.3" data-path="机器学习.html"><a href="机器学习.html#分类树classification-trees"><i class="fa fa-check"></i><b>11.2.3</b> 分类树（Classification Trees）</a></li>
<li class="chapter" data-level="11.2.4" data-path="机器学习.html"><a href="机器学习.html#回归树regression-trees"><i class="fa fa-check"></i><b>11.2.4</b> 回归树（Regression Trees）</a></li>
<li class="chapter" data-level="11.2.5" data-path="机器学习.html"><a href="机器学习.html#分类树与回归树的比较"><i class="fa fa-check"></i><b>11.2.5</b> 分类树与回归树的比较</a></li>
<li class="chapter" data-level="11.2.6" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-3"><i class="fa fa-check"></i><b>11.2.6</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.2.7" data-path="机器学习.html"><a href="机器学习.html#优势与局限"><i class="fa fa-check"></i><b>11.2.7</b> 优势与局限</a></li>
<li class="chapter" data-level="11.2.8" data-path="机器学习.html"><a href="机器学习.html#r代码实现示例"><i class="fa fa-check"></i><b>11.2.8</b> R代码实现示例</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="机器学习.html"><a href="机器学习.html#随机森林"><i class="fa fa-check"></i><b>11.3</b> 随机森林</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="机器学习.html"><a href="机器学习.html#决策树与随机森林的关系"><i class="fa fa-check"></i><b>11.3.1</b> 决策树与随机森林的关系</a></li>
<li class="chapter" data-level="11.3.2" data-path="机器学习.html"><a href="机器学习.html#随机森林的三个随机"><i class="fa fa-check"></i><b>11.3.2</b> 随机森林的三个随机</a></li>
<li class="chapter" data-level="11.3.3" data-path="机器学习.html"><a href="机器学习.html#数学定义与原理"><i class="fa fa-check"></i><b>11.3.3</b> 数学定义与原理</a></li>
<li class="chapter" data-level="11.3.4" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理"><i class="fa fa-check"></i><b>11.3.4</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.3.5" data-path="机器学习.html"><a href="机器学习.html#r代码实现"><i class="fa fa-check"></i><b>11.3.5</b> R代码实现</a></li>
<li class="chapter" data-level="11.3.6" data-path="机器学习.html"><a href="机器学习.html#代码详细说明"><i class="fa fa-check"></i><b>11.3.6</b> 代码详细说明</a></li>
<li class="chapter" data-level="11.3.7" data-path="机器学习.html"><a href="机器学习.html#模型评估与验证"><i class="fa fa-check"></i><b>11.3.7</b> 模型评估与验证</a></li>
<li class="chapter" data-level="11.3.8" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-4"><i class="fa fa-check"></i><b>11.3.8</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.3.9" data-path="机器学习.html"><a href="机器学习.html#生态学应用价值-1"><i class="fa fa-check"></i><b>11.3.9</b> 生态学应用价值</a></li>
<li class="chapter" data-level="11.3.10" data-path="机器学习.html"><a href="机器学习.html#优势与局限的深入分析"><i class="fa fa-check"></i><b>11.3.10</b> 优势与局限的深入分析</a></li>
<li class="chapter" data-level="11.3.11" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望"><i class="fa fa-check"></i><b>11.3.11</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="机器学习.html"><a href="机器学习.html#支持向量机"><i class="fa fa-check"></i><b>11.4</b> 支持向量机</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与几何直觉"><i class="fa fa-check"></i><b>11.4.1</b> 基本概念与几何直觉</a></li>
<li class="chapter" data-level="11.4.2" data-path="机器学习.html"><a href="机器学习.html#数学原理与核心概念"><i class="fa fa-check"></i><b>11.4.2</b> 数学原理与核心概念</a></li>
<li class="chapter" data-level="11.4.3" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理-1"><i class="fa fa-check"></i><b>11.4.3</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.4.4" data-path="机器学习.html"><a href="机器学习.html#r代码实现-1"><i class="fa fa-check"></i><b>11.4.4</b> R代码实现</a></li>
<li class="chapter" data-level="11.4.5" data-path="机器学习.html"><a href="机器学习.html#代码详细说明-1"><i class="fa fa-check"></i><b>11.4.5</b> 代码详细说明</a></li>
<li class="chapter" data-level="11.4.6" data-path="机器学习.html"><a href="机器学习.html#模型评估与验证-1"><i class="fa fa-check"></i><b>11.4.6</b> 模型评估与验证</a></li>
<li class="chapter" data-level="11.4.7" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-5"><i class="fa fa-check"></i><b>11.4.7</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.4.8" data-path="机器学习.html"><a href="机器学习.html#优势与局限-1"><i class="fa fa-check"></i><b>11.4.8</b> 优势与局限</a></li>
<li class="chapter" data-level="11.4.9" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望-1"><i class="fa fa-check"></i><b>11.4.9</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="机器学习.html"><a href="机器学习.html#深度神经网络"><i class="fa fa-check"></i><b>11.5</b> 深度神经网络</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与生物学启发"><i class="fa fa-check"></i><b>11.5.1</b> 基本概念与生物学启发</a></li>
<li class="chapter" data-level="11.5.2" data-path="机器学习.html"><a href="机器学习.html#主要神经网络架构"><i class="fa fa-check"></i><b>11.5.2</b> 主要神经网络架构</a></li>
<li class="chapter" data-level="11.5.3" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理-2"><i class="fa fa-check"></i><b>11.5.3</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.5.4" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-6"><i class="fa fa-check"></i><b>11.5.4</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.5.5" data-path="机器学习.html"><a href="机器学习.html#优势与局限-2"><i class="fa fa-check"></i><b>11.5.5</b> 优势与局限</a></li>
<li class="chapter" data-level="11.5.6" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望-2"><i class="fa fa-check"></i><b>11.5.6</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="机器学习.html"><a href="机器学习.html#总结-10"><i class="fa fa-check"></i><b>11.6</b> 总结</a></li>
<li class="chapter" data-level="11.7" data-path="机器学习.html"><a href="机器学习.html#综合练习-9"><i class="fa fa-check"></i><b>11.7</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html"><i class="fa fa-check"></i><b>12</b> 附录1 R语言编程基础</a>
<ul>
<li class="chapter" data-level="12.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言介绍"><i class="fa fa-check"></i><b>12.1</b> R语言介绍</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#为什么生态学专业需要学习r"><i class="fa fa-check"></i><b>12.1.1</b> 为什么生态学专业需要学习R？</a></li>
<li class="chapter" data-level="12.1.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言简介与趣味应用"><i class="fa fa-check"></i><b>12.1.2</b> R语言简介与趣味应用</a></li>
<li class="chapter" data-level="12.1.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#环境设置和配置"><i class="fa fa-check"></i><b>12.1.3</b> 环境设置和配置</a></li>
<li class="chapter" data-level="12.1.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#项目文件夹结构设置"><i class="fa fa-check"></i><b>12.1.4</b> 项目文件夹结构设置</a></li>
<li class="chapter" data-level="12.1.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#基本包管理"><i class="fa fa-check"></i><b>12.1.5</b> 基本包管理</a></li>
<li class="chapter" data-level="12.1.6" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#工作目录设置"><i class="fa fa-check"></i><b>12.1.6</b> 工作目录设置</a></li>
<li class="chapter" data-level="12.1.7" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课前准备检查清单"><i class="fa fa-check"></i><b>12.1.7</b> 课前准备检查清单</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#数值向量创建与基本统计计算"><i class="fa fa-check"></i><b>12.2</b> 数值向量创建与基本统计计算</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景"><i class="fa fa-check"></i><b>12.2.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.2.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据"><i class="fa fa-check"></i><b>12.2.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.2.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程"><i class="fa fa-check"></i><b>12.2.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.2.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解"><i class="fa fa-check"></i><b>12.2.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.2.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习"><i class="fa fa-check"></i><b>12.2.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#字符型数据处理与向量索引操作"><i class="fa fa-check"></i><b>12.3</b> 字符型数据处理与向量索引操作</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-1"><i class="fa fa-check"></i><b>12.3.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.3.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-1"><i class="fa fa-check"></i><b>12.3.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.3.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-1"><i class="fa fa-check"></i><b>12.3.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.3.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-1"><i class="fa fa-check"></i><b>12.3.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.3.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-1"><i class="fa fa-check"></i><b>12.3.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#数据框结构理解与多类型数据管理"><i class="fa fa-check"></i><b>12.4</b> 数据框结构理解与多类型数据管理</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-2"><i class="fa fa-check"></i><b>12.4.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.4.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-2"><i class="fa fa-check"></i><b>12.4.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.4.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-2"><i class="fa fa-check"></i><b>12.4.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.4.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-2"><i class="fa fa-check"></i><b>12.4.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.4.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-2"><i class="fa fa-check"></i><b>12.4.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#列表数据结构与数据分组管理"><i class="fa fa-check"></i><b>12.5</b> 列表数据结构与数据分组管理</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-3"><i class="fa fa-check"></i><b>12.5.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.5.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-3"><i class="fa fa-check"></i><b>12.5.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.5.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-3"><i class="fa fa-check"></i><b>12.5.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.5.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-3"><i class="fa fa-check"></i><b>12.5.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.5.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-3"><i class="fa fa-check"></i><b>12.5.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#外部数据导入与条件筛选分析"><i class="fa fa-check"></i><b>12.6</b> 外部数据导入与条件筛选分析</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-4"><i class="fa fa-check"></i><b>12.6.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.6.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据文件bird_monitoring.csv"><i class="fa fa-check"></i><b>12.6.2</b> 演示数据文件（bird_monitoring.csv）</a></li>
<li class="chapter" data-level="12.6.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-4"><i class="fa fa-check"></i><b>12.6.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.6.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-4"><i class="fa fa-check"></i><b>12.6.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.6.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-4"><i class="fa fa-check"></i><b>12.6.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#缺失值和异常值的识别处理"><i class="fa fa-check"></i><b>12.7</b> 缺失值和异常值的识别处理</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-5"><i class="fa fa-check"></i><b>12.7.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.7.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-4"><i class="fa fa-check"></i><b>12.7.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.7.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-5"><i class="fa fa-check"></i><b>12.7.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.7.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-5"><i class="fa fa-check"></i><b>12.7.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.7.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-5"><i class="fa fa-check"></i><b>12.7.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#描述性统计分析与基础数据可视化"><i class="fa fa-check"></i><b>12.8</b> 描述性统计分析与基础数据可视化</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-6"><i class="fa fa-check"></i><b>12.8.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.8.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-5"><i class="fa fa-check"></i><b>12.8.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.8.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-6"><i class="fa fa-check"></i><b>12.8.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.8.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-6"><i class="fa fa-check"></i><b>12.8.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.8.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-6"><i class="fa fa-check"></i><b>12.8.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#条件判断循环结构与函数编程"><i class="fa fa-check"></i><b>12.9</b> 条件判断、循环结构与函数编程</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-7"><i class="fa fa-check"></i><b>12.9.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.9.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-6"><i class="fa fa-check"></i><b>12.9.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.9.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-7"><i class="fa fa-check"></i><b>12.9.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.9.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-7"><i class="fa fa-check"></i><b>12.9.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.9.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-7"><i class="fa fa-check"></i><b>12.9.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#现代数据科学工具包应用"><i class="fa fa-check"></i><b>12.10</b> 现代数据科学工具包应用</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-8"><i class="fa fa-check"></i><b>12.10.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.10.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-7"><i class="fa fa-check"></i><b>12.10.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.10.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-8"><i class="fa fa-check"></i><b>12.10.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.10.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-8"><i class="fa fa-check"></i><b>12.10.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.10.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-8"><i class="fa fa-check"></i><b>12.10.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#图形语法与科学绘图"><i class="fa fa-check"></i><b>12.11</b> 图形语法与科学绘图</a>
<ul>
<li class="chapter" data-level="12.11.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#生态学背景-9"><i class="fa fa-check"></i><b>12.11.1</b> 生态学背景</a></li>
<li class="chapter" data-level="12.11.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#演示数据-8"><i class="fa fa-check"></i><b>12.11.2</b> 演示数据</a></li>
<li class="chapter" data-level="12.11.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课堂演示过程-9"><i class="fa fa-check"></i><b>12.11.3</b> 课堂演示过程</a></li>
<li class="chapter" data-level="12.11.4" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#r语言知识点详解-9"><i class="fa fa-check"></i><b>12.11.4</b> R语言知识点详解</a></li>
<li class="chapter" data-level="12.11.5" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#课后练习-9"><i class="fa fa-check"></i><b>12.11.5</b> 课后练习</a></li>
</ul></li>
<li class="chapter" data-level="12.12" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#综合练习-10"><i class="fa fa-check"></i><b>12.12</b> 综合练习</a>
<ul>
<li class="chapter" data-level="12.12.1" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习1-1"><i class="fa fa-check"></i><b>12.12.1</b> 练习1</a></li>
<li class="chapter" data-level="12.12.2" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习2"><i class="fa fa-check"></i><b>12.12.2</b> 练习2</a></li>
<li class="chapter" data-level="12.12.3" data-path="附录1-r语言编程基础.html"><a href="附录1-r语言编程基础.html#练习3"><i class="fa fa-check"></i><b>12.12.3</b> 练习3</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://gitee.com/gcshen/ecological-statistics" target="blank">Gitee</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">生态统计学</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="模型选择与评估" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> 模型选择与评估<a href="模型选择与评估.html#模型选择与评估" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="引言-8" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> 引言<a href="模型选择与评估.html#引言-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在前面的章节中，我们已经学习了多种回归模型——从简单的线性回归到复杂的多元和多项式回归。面对如此丰富的建模工具，生态学研究者自然会面临一个重要问题：对于特定的生态学数据，我们应该选择哪种模型？为什么同一套数据可以构建多种不同的模型？这些问题的答案引出了本章的核心主题——模型选择与评估。</p>
<p>模型选择与评估是生态统计建模中至关重要的环节，它不仅仅是技术性的统计操作，更是连接数据、模型与生态学解释的关键桥梁。在生态学研究中，我们追求的不是数学上最完美的模型，而是最能反映生态过程本质、最具预测能力和解释力的模型。</p>
<p>生态系统的复杂性决定了单一模型很难捕捉所有生态关系。当我们面对一套生态调查数据时，比如研究鸟类丰富度与环境因子的关系，我们可以构建线性回归模型、多项式回归模型、广义线性模型等多种统计模型。每种模型都基于不同的假设，捕捉数据中不同层面的信息。模型选择的过程就是系统性地比较这些候选模型，找出最适合当前研究问题的那个模型。</p>
<p>模型选择的必要性源于生态学研究的几个核心特征。首先，生态数据通常包含多个潜在的解释变量，但并非所有变量都对生态响应有同等重要的影响。盲目地将所有变量纳入模型不仅会增加计算负担，更可能导致过度拟合——模型过度适应训练数据的随机噪声，而丧失了预测新数据的能力。其次，生态关系往往具有复杂的非线性特征，简单的线性模型可能无法充分描述物种对环境梯度的响应模式。模型选择帮助我们确定是否需要更复杂的函数形式来捕捉这些非线性关系。</p>
<p>更重要的是，模型选择体现了生态学研究的简约性原则。在科学哲学中，奥卡姆剃刀原理告诉我们：在同等解释力的模型中，应该选择最简单的那个。在生态学中，简约模型不仅计算效率更高，更重要的是它们通常具有更好的生态学解释性。一个包含过多参数的复杂模型可能能够完美拟合训练数据，但其生态学意义往往难以理解，也难以推广到其他生态系统。</p>
<p>模型评估是模型选择的必要补充，它回答了一个更根本的问题：我们选择的模型是否真的可靠？在生态学研究中，模型的可靠性体现在两个方面：统计可靠性和生态学可靠性。</p>
<p>统计可靠性关注模型是否满足基本的统计假设，参数估计是否准确，预测是否稳定。通过残差分析、影响分析等诊断工具，我们可以检查模型是否正确地捕捉了数据中的模式，是否存在异常观测对结果产生过度影响，以及模型的预测误差是否在可接受范围内。这些诊断不仅帮助我们识别技术问题，更重要的是揭示了数据中可能存在的生态学异常——比如特殊的生境条件或异常的物种行为。</p>
<p>生态学可靠性则关注模型结果是否具有生态学意义，是否能够为生态学理论提供支持，是否能够指导生态保护实践。一个统计上完美的模型如果缺乏生态学解释性，其价值就会大打折扣。例如，一个预测物种分布的模型如果包含了生态学上不合理的环境因子组合，即使其预测精度很高，也难以被生态学家接受。</p>
<p>在生态学研究中，模型选择与评估不仅仅是统计技术，它们反映了我们对生态系统的理解深度。当我们系统地比较不同模型时，实际上是在检验不同的生态学假说。每个候选模型都代表了对生态过程的一种可能解释，模型选择过程就是通过数据来评估这些解释的相对合理性。</p>
<p>以物种分布模型为例，我们可以构建基于不同环境因子的多个模型：一个模型可能强调气候因子的主导作用，另一个可能突出地形因子的重要性，第三个可能关注人类干扰的影响。通过模型比较，我们不仅能够确定哪个模型拟合最好，更重要的是能够量化不同生态因子对物种分布的相对贡献。这种量化分析为生态保护决策提供了科学依据——如果气候因子被证明是最重要的预测变量，那么气候变化对物种的影响就应该成为保护规划的核心考虑。</p>
<p>模型评估还帮助我们理解模型的局限性。在生态学中，没有完美的模型，只有在一定条件下适用的模型。通过交叉验证、外部验证等方法，我们可以评估模型在不同时空尺度上的表现，识别模型的适用范围和边界条件。这种对模型局限性的清醒认识是科学严谨性的体现，也提醒我们在应用模型结果时需要保持适当的谨慎。</p>
<p>在实际的生态学研究中，模型选择应该结合统计准则和生态学知识。统计准则如<span class="math inline">\(\text{AIC}\)</span>、<span class="math inline">\(\text{BIC}\)</span>提供了客观的模型比较标准，但它们不应该成为唯一的决策依据。生态学家的专业判断在模型选择中同样重要——即使某个变量在统计上不显著，如果它具有重要的生态学意义，也应该考虑在模型中保留。</p>
<p>模型选择的过程应该是迭代的、探索性的。我们通常从简单的模型开始，逐步增加复杂性，同时密切关注模型性能的变化。当增加模型复杂度不再显著改善模型性能时，我们就找到了最优的平衡点。这种渐进式的建模策略不仅计算效率高，更重要的是它帮助我们理解每个变量对模型贡献的边际效应。</p>
<p>最后，模型选择与评估应该服务于研究目标。如果研究目标是机制探索，我们可能更关注模型的解释性和生态学合理性；如果研究目标是预测应用，我们可能更关注模型的预测精度和稳定性。明确的研究目标为模型选择提供了方向，也帮助我们确定评估模型成功与否的标准。</p>
<p>通过系统的模型选择与评估，生态学研究者能够构建既统计可靠又生态学有意义的模型，为理解生态过程、预测生态变化、指导生态保护提供坚实的科学基础。这个过程不仅提升了研究的科学质量，更重要的是培养了研究者对生态统计建模的深刻理解——认识到模型是工具而不是真理，是帮助我们理解复杂生态系统的有力手段。</p>
</div>
<div id="模型选择" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> 模型选择<a href="模型选择与评估.html#模型选择" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="模型选择原则" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> 模型选择原则<a href="模型选择与评估.html#模型选择原则" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>模型选择的核心原则是在模型复杂度和拟合优度之间寻找最优平衡点。这个原则在生态学研究中具有深远的意义，因为它直接关系到我们对生态系统的理解深度和预测能力。</p>
<p><strong>平衡模型复杂度和拟合优度</strong>是模型选择的根本挑战。模型复杂度通常用参数数量来衡量，而拟合优度则通过模型对数据的解释能力来评估。在生态学中，我们面临着两难选择：过于简单的模型可能无法充分捕捉生态关系的复杂性，导致欠拟合；而过于复杂的模型则可能过度适应训练数据的随机噪声，导致过拟合。</p>
<p>欠拟合在生态学研究中表现为模型无法捕捉重要的生态模式。例如，在研究植物生长与温度的关系时，如果只使用线性模型而忽略了物种对温度的最适响应，模型就会低估高温或低温条件下的生长速率。这种欠拟合不仅降低了模型的预测精度，更重要的是可能掩盖了关键的生态机制。</p>
<p>过拟合则是生态建模中更为常见的问题。当模型包含过多参数时，它会完美地拟合训练数据中的随机变异，包括测量误差和偶然的生态现象。这种过度拟合的模型在训练数据上表现优异，但在预测新数据时往往表现糟糕。在生态学中，过拟合的典型表现是模型包含了大量统计显著但生态学意义不明确的变量，或者使用了过于复杂的函数形式来描述本质上简单的生态关系。</p>
<p><strong>奥卡姆剃刀原理</strong>在生态模型选择中具有重要的指导意义。这个源自14世纪哲学家的原则告诉我们：“如无必要，勿增实体”。在模型选择的语境下，这意味着在同等解释力的模型中，我们应该选择最简单的那个。简约模型不仅计算效率更高，更重要的是它们通常具有更好的泛化能力和生态学解释性。</p>
<p>生态学中的简约性原则体现在多个层面。在变量选择层面，我们应该只包含那些对生态响应有实质性影响的变量；在函数形式层面，我们应该选择最能反映生态机制的函数关系；在模型结构层面，我们应该避免不必要的复杂交互项和随机效应。</p>
<p><strong>生态学意义</strong>是模型选择的最终评判标准。一个统计上完美的模型如果缺乏生态学解释性，其价值就会大打折扣。在生态学研究中，模型选择不仅要考虑统计指标，更要考虑模型的生态学合理性。例如，一个预测物种分布的模型如果包含了生态学上不合理的环境因子组合，即使其预测精度很高，也难以被生态学家接受。</p>
<p>模型选择的生态学意义还体现在对生态机制的理解上。通过系统比较不同复杂度的模型，我们可以识别哪些生态过程是必要的，哪些是冗余的。这种识别过程本身就是对生态系统运作机制的深入探索。</p>
<div class="sourceCode" id="cb1015"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1015-1"><a href="模型选择与评估.html#cb1015-1" tabindex="-1"></a><span class="co"># 演示模型复杂度与拟合优度的平衡</span></span>
<span id="cb1015-2"><a href="模型选择与评估.html#cb1015-2" tabindex="-1"></a><span class="co"># 设置随机种子确保结果可重现</span></span>
<span id="cb1015-3"><a href="模型选择与评估.html#cb1015-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1015-4"><a href="模型选择与评估.html#cb1015-4" tabindex="-1"></a></span>
<span id="cb1015-5"><a href="模型选择与评估.html#cb1015-5" tabindex="-1"></a><span class="co"># 生成生态学数据：植物生物量与土壤养分的关系</span></span>
<span id="cb1015-6"><a href="模型选择与评估.html#cb1015-6" tabindex="-1"></a><span class="co"># 样本量设置为100个观测</span></span>
<span id="cb1015-7"><a href="模型选择与评估.html#cb1015-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1015-8"><a href="模型选择与评估.html#cb1015-8" tabindex="-1"></a><span class="co"># 创建土壤养分梯度，从10到100均匀分布</span></span>
<span id="cb1015-9"><a href="模型选择与评估.html#cb1015-9" tabindex="-1"></a>soil_nutrient <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="at">length.out =</span> n)</span>
<span id="cb1015-10"><a href="模型选择与评估.html#cb1015-10" tabindex="-1"></a></span>
<span id="cb1015-11"><a href="模型选择与评估.html#cb1015-11" tabindex="-1"></a><span class="co"># 真实关系：二次关系（存在最适养分范围）</span></span>
<span id="cb1015-12"><a href="模型选择与评估.html#cb1015-12" tabindex="-1"></a><span class="co"># 基础生物量为50，线性项系数为0.8，二次项系数为-0.005</span></span>
<span id="cb1015-13"><a href="模型选择与评估.html#cb1015-13" tabindex="-1"></a>biomass_true <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> soil_nutrient <span class="sc">-</span> <span class="fl">0.005</span> <span class="sc">*</span> soil_nutrient<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1015-14"><a href="模型选择与评估.html#cb1015-14" tabindex="-1"></a><span class="co"># 添加随机噪声模拟观测误差，标准差为10</span></span>
<span id="cb1015-15"><a href="模型选择与评估.html#cb1015-15" tabindex="-1"></a>biomass_observed <span class="ot">&lt;-</span> biomass_true <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb1015-16"><a href="模型选择与评估.html#cb1015-16" tabindex="-1"></a></span>
<span id="cb1015-17"><a href="模型选择与评估.html#cb1015-17" tabindex="-1"></a><span class="co"># 创建数据框用于存储生态数据</span></span>
<span id="cb1015-18"><a href="模型选择与评估.html#cb1015-18" tabindex="-1"></a><span class="co"># 包含养分浓度和观测生物量两个变量</span></span>
<span id="cb1015-19"><a href="模型选择与评估.html#cb1015-19" tabindex="-1"></a>eco_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1015-20"><a href="模型选择与评估.html#cb1015-20" tabindex="-1"></a>  <span class="at">nutrient =</span> soil_nutrient,</span>
<span id="cb1015-21"><a href="模型选择与评估.html#cb1015-21" tabindex="-1"></a>  <span class="at">biomass =</span> biomass_observed</span>
<span id="cb1015-22"><a href="模型选择与评估.html#cb1015-22" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1016"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1016-1"><a href="模型选择与评估.html#cb1016-1" tabindex="-1"></a><span class="co"># 拟合不同复杂度的模型</span></span>
<span id="cb1016-2"><a href="模型选择与评估.html#cb1016-2" tabindex="-1"></a><span class="co"># 线性模型：最简单的模型，假设线性关系</span></span>
<span id="cb1016-3"><a href="模型选择与评估.html#cb1016-3" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(biomass <span class="sc">~</span> nutrient, <span class="at">data =</span> eco_data)</span>
<span id="cb1016-4"><a href="模型选择与评估.html#cb1016-4" tabindex="-1"></a><span class="co"># 二次模型：包含线性项和二次项，适合描述最适响应</span></span>
<span id="cb1016-5"><a href="模型选择与评估.html#cb1016-5" tabindex="-1"></a>model_quadratic <span class="ot">&lt;-</span> <span class="fu">lm</span>(biomass <span class="sc">~</span> <span class="fu">poly</span>(nutrient, <span class="dv">2</span>), <span class="at">data =</span> eco_data)</span>
<span id="cb1016-6"><a href="模型选择与评估.html#cb1016-6" tabindex="-1"></a><span class="co"># 三次模型：包含三次项，可能过度参数化</span></span>
<span id="cb1016-7"><a href="模型选择与评估.html#cb1016-7" tabindex="-1"></a>model_cubic <span class="ot">&lt;-</span> <span class="fu">lm</span>(biomass <span class="sc">~</span> <span class="fu">poly</span>(nutrient, <span class="dv">3</span>), <span class="at">data =</span> eco_data)</span>
<span id="cb1016-8"><a href="模型选择与评估.html#cb1016-8" tabindex="-1"></a><span class="co"># 10次多项式：严重过度拟合，完美拟合训练数据噪声</span></span>
<span id="cb1016-9"><a href="模型选择与评估.html#cb1016-9" tabindex="-1"></a>model_overfit <span class="ot">&lt;-</span> <span class="fu">lm</span>(biomass <span class="sc">~</span> <span class="fu">poly</span>(nutrient, <span class="dv">10</span>), <span class="at">data =</span> eco_data)</span>
<span id="cb1016-10"><a href="模型选择与评估.html#cb1016-10" tabindex="-1"></a></span>
<span id="cb1016-11"><a href="模型选择与评估.html#cb1016-11" tabindex="-1"></a><span class="co"># 计算拟合优度（$R^2$）</span></span>
<span id="cb1016-12"><a href="模型选择与评估.html#cb1016-12" tabindex="-1"></a><span class="co"># R²衡量模型解释的方差比例</span></span>
<span id="cb1016-13"><a href="模型选择与评估.html#cb1016-13" tabindex="-1"></a>r2_linear <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_linear)<span class="sc">$</span>r.squared</span>
<span id="cb1016-14"><a href="模型选择与评估.html#cb1016-14" tabindex="-1"></a>r2_quadratic <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_quadratic)<span class="sc">$</span>r.squared</span>
<span id="cb1016-15"><a href="模型选择与评估.html#cb1016-15" tabindex="-1"></a>r2_cubic <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_cubic)<span class="sc">$</span>r.squared</span>
<span id="cb1016-16"><a href="模型选择与评估.html#cb1016-16" tabindex="-1"></a>r2_overfit <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_overfit)<span class="sc">$</span>r.squared</span>
<span id="cb1016-17"><a href="模型选择与评估.html#cb1016-17" tabindex="-1"></a></span>
<span id="cb1016-18"><a href="模型选择与评估.html#cb1016-18" tabindex="-1"></a><span class="co"># 计算$\text{AIC}$值</span></span>
<span id="cb1016-19"><a href="模型选择与评估.html#cb1016-19" tabindex="-1"></a><span class="co"># AIC平衡模型拟合优度和复杂度，值越小越好</span></span>
<span id="cb1016-20"><a href="模型选择与评估.html#cb1016-20" tabindex="-1"></a>aic_linear <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model_linear)</span>
<span id="cb1016-21"><a href="模型选择与评估.html#cb1016-21" tabindex="-1"></a>aic_quadratic <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model_quadratic)</span>
<span id="cb1016-22"><a href="模型选择与评估.html#cb1016-22" tabindex="-1"></a>aic_cubic <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model_cubic)</span>
<span id="cb1016-23"><a href="模型选择与评估.html#cb1016-23" tabindex="-1"></a>aic_overfit <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model_overfit)</span></code></pre></div>
<div class="sourceCode" id="cb1017"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1017-1"><a href="模型选择与评估.html#cb1017-1" tabindex="-1"></a><span class="co"># 绘制比较图</span></span>
<span id="cb1017-2"><a href="模型选择与评估.html#cb1017-2" tabindex="-1"></a><span class="co"># 设置图形布局为2行2列，便于比较四个模型</span></span>
<span id="cb1017-3"><a href="模型选择与评估.html#cb1017-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb1017-4"><a href="模型选择与评估.html#cb1017-4" tabindex="-1"></a></span>
<span id="cb1017-5"><a href="模型选择与评估.html#cb1017-5" tabindex="-1"></a><span class="co"># 线性模型图</span></span>
<span id="cb1017-6"><a href="模型选择与评估.html#cb1017-6" tabindex="-1"></a><span class="co"># 绘制散点图显示观测数据</span></span>
<span id="cb1017-7"><a href="模型选择与评估.html#cb1017-7" tabindex="-1"></a><span class="fu">plot</span>(biomass <span class="sc">~</span> nutrient,</span>
<span id="cb1017-8"><a href="模型选择与评估.html#cb1017-8" tabindex="-1"></a>  <span class="at">data =</span> eco_data,</span>
<span id="cb1017-9"><a href="模型选择与评估.html#cb1017-9" tabindex="-1"></a>  <span class="co"># 标题包含R²和AIC值用于模型比较</span></span>
<span id="cb1017-10"><a href="模型选择与评估.html#cb1017-10" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;线性模型</span><span class="sc">\n</span><span class="st">$R^2$ =&quot;</span>, <span class="fu">round</span>(r2_linear, <span class="dv">3</span>), <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">text{AIC}$ =&quot;</span>, <span class="fu">round</span>(aic_linear, <span class="dv">1</span>)),</span>
<span id="cb1017-11"><a href="模型选择与评估.html#cb1017-11" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;土壤养分&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;植物生物量&quot;</span>,</span>
<span id="cb1017-12"><a href="模型选择与评估.html#cb1017-12" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>  <span class="co"># 蓝色实心点</span></span>
<span id="cb1017-13"><a href="模型选择与评估.html#cb1017-13" tabindex="-1"></a>)</span>
<span id="cb1017-14"><a href="模型选择与评估.html#cb1017-14" tabindex="-1"></a><span class="co"># 添加模型拟合线</span></span>
<span id="cb1017-15"><a href="模型选择与评估.html#cb1017-15" tabindex="-1"></a><span class="fu">lines</span>(soil_nutrient, <span class="fu">predict</span>(model_linear), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1017-16"><a href="模型选择与评估.html#cb1017-16" tabindex="-1"></a></span>
<span id="cb1017-17"><a href="模型选择与评估.html#cb1017-17" tabindex="-1"></a><span class="co"># 二次模型图</span></span>
<span id="cb1017-18"><a href="模型选择与评估.html#cb1017-18" tabindex="-1"></a><span class="fu">plot</span>(biomass <span class="sc">~</span> nutrient,</span>
<span id="cb1017-19"><a href="模型选择与评估.html#cb1017-19" tabindex="-1"></a>  <span class="at">data =</span> eco_data,</span>
<span id="cb1017-20"><a href="模型选择与评估.html#cb1017-20" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;二次模型</span><span class="sc">\n</span><span class="st">$R^2$ =&quot;</span>, <span class="fu">round</span>(r2_quadratic, <span class="dv">3</span>), <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">text{AIC}$ =&quot;</span>, <span class="fu">round</span>(aic_quadratic, <span class="dv">1</span>)),</span>
<span id="cb1017-21"><a href="模型选择与评估.html#cb1017-21" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;土壤养分&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;植物生物量&quot;</span>,</span>
<span id="cb1017-22"><a href="模型选择与评估.html#cb1017-22" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb1017-23"><a href="模型选择与评估.html#cb1017-23" tabindex="-1"></a>)</span>
<span id="cb1017-24"><a href="模型选择与评估.html#cb1017-24" tabindex="-1"></a><span class="fu">lines</span>(soil_nutrient, <span class="fu">predict</span>(model_quadratic), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1017-25"><a href="模型选择与评估.html#cb1017-25" tabindex="-1"></a></span>
<span id="cb1017-26"><a href="模型选择与评估.html#cb1017-26" tabindex="-1"></a><span class="co"># 三次模型图</span></span>
<span id="cb1017-27"><a href="模型选择与评估.html#cb1017-27" tabindex="-1"></a><span class="fu">plot</span>(biomass <span class="sc">~</span> nutrient,</span>
<span id="cb1017-28"><a href="模型选择与评估.html#cb1017-28" tabindex="-1"></a>  <span class="at">data =</span> eco_data,</span>
<span id="cb1017-29"><a href="模型选择与评估.html#cb1017-29" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;三次模型</span><span class="sc">\n</span><span class="st">$R^2$ =&quot;</span>, <span class="fu">round</span>(r2_cubic, <span class="dv">3</span>), <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">text{AIC}$ =&quot;</span>, <span class="fu">round</span>(aic_cubic, <span class="dv">1</span>)),</span>
<span id="cb1017-30"><a href="模型选择与评估.html#cb1017-30" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;土壤养分&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;植物生物量&quot;</span>,</span>
<span id="cb1017-31"><a href="模型选择与评估.html#cb1017-31" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb1017-32"><a href="模型选择与评估.html#cb1017-32" tabindex="-1"></a>)</span>
<span id="cb1017-33"><a href="模型选择与评估.html#cb1017-33" tabindex="-1"></a><span class="fu">lines</span>(soil_nutrient, <span class="fu">predict</span>(model_cubic), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1017-34"><a href="模型选择与评估.html#cb1017-34" tabindex="-1"></a></span>
<span id="cb1017-35"><a href="模型选择与评估.html#cb1017-35" tabindex="-1"></a><span class="co"># 过度拟合模型图</span></span>
<span id="cb1017-36"><a href="模型选择与评估.html#cb1017-36" tabindex="-1"></a><span class="fu">plot</span>(biomass <span class="sc">~</span> nutrient,</span>
<span id="cb1017-37"><a href="模型选择与评估.html#cb1017-37" tabindex="-1"></a>  <span class="at">data =</span> eco_data,</span>
<span id="cb1017-38"><a href="模型选择与评估.html#cb1017-38" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;10次多项式</span><span class="sc">\n</span><span class="st">$R^2$ =&quot;</span>, <span class="fu">round</span>(r2_overfit, <span class="dv">3</span>), <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">text{AIC}$ =&quot;</span>, <span class="fu">round</span>(aic_overfit, <span class="dv">1</span>)),</span>
<span id="cb1017-39"><a href="模型选择与评估.html#cb1017-39" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;土壤养分&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;植物生物量&quot;</span>,</span>
<span id="cb1017-40"><a href="模型选择与评估.html#cb1017-40" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb1017-41"><a href="模型选择与评估.html#cb1017-41" tabindex="-1"></a>)</span>
<span id="cb1017-42"><a href="模型选择与评估.html#cb1017-42" tabindex="-1"></a><span class="fu">lines</span>(soil_nutrient, <span class="fu">predict</span>(model_overfit), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-4-1.png" alt="模型复杂度与拟合优度平衡：线性、二次、三次和10次多项式模型对植物生物量与土壤养分关系的拟合效果比较" width="672" />
<p class="caption">
图2.2: 模型复杂度与拟合优度平衡：线性、二次、三次和10次多项式模型对植物生物量与土壤养分关系的拟合效果比较
</p>
</div>
<div class="sourceCode" id="cb1018"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1018-1"><a href="模型选择与评估.html#cb1018-1" tabindex="-1"></a><span class="co"># 恢复单图布局</span></span>
<span id="cb1018-2"><a href="模型选择与评估.html#cb1018-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb1019"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1019-1"><a href="模型选择与评估.html#cb1019-1" tabindex="-1"></a><span class="co"># 输出模型比较结果</span></span>
<span id="cb1019-2"><a href="模型选择与评估.html#cb1019-2" tabindex="-1"></a><span class="co"># 输出标题和模型性能比较</span></span>
<span id="cb1019-3"><a href="模型选择与评估.html#cb1019-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 模型复杂度与拟合优度平衡演示 ===</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 模型复杂度与拟合优度平衡演示 ===</code></pre>
<div class="sourceCode" id="cb1021"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1021-1"><a href="模型选择与评估.html#cb1021-1" tabindex="-1"></a><span class="co"># 线性模型结果：欠拟合情况</span></span>
<span id="cb1021-2"><a href="模型选择与评估.html#cb1021-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;线性模型 (欠拟合):</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1021-3"><a href="模型选择与评估.html#cb1021-3" tabindex="-1"></a>    <span class="st">&quot;- $R^2$ =&quot;</span>, <span class="fu">round</span>(r2_linear, <span class="dv">3</span>), <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">text{AIC}$ =&quot;</span>, <span class="fu">round</span>(aic_linear, <span class="dv">1</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1021-4"><a href="模型选择与评估.html#cb1021-4" tabindex="-1"></a>    <span class="st">&quot;- 问题：无法捕捉最适养分范围</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 线性模型 (欠拟合):
##  - $R^2$ = 0.383 $\text{AIC}$ = 734.8 
##  - 问题：无法捕捉最适养分范围</code></pre>
<div class="sourceCode" id="cb1023"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1023-1"><a href="模型选择与评估.html#cb1023-1" tabindex="-1"></a><span class="co"># 二次模型结果：最优模型</span></span>
<span id="cb1023-2"><a href="模型选择与评估.html#cb1023-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;二次模型 (最优):</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1023-3"><a href="模型选择与评估.html#cb1023-3" tabindex="-1"></a>    <span class="st">&quot;- $R^2$ =&quot;</span>, <span class="fu">round</span>(r2_quadratic, <span class="dv">3</span>), <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">text{AIC}$ =&quot;</span>, <span class="fu">round</span>(aic_quadratic, <span class="dv">1</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1023-4"><a href="模型选择与评估.html#cb1023-4" tabindex="-1"></a>    <span class="st">&quot;- 优势：正确反映了真实生态关系</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 二次模型 (最优):
##  - $R^2$ = 0.416 $\text{AIC}$ = 731.3 
##  - 优势：正确反映了真实生态关系</code></pre>
<div class="sourceCode" id="cb1025"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1025-1"><a href="模型选择与评估.html#cb1025-1" tabindex="-1"></a><span class="co"># 三次模型结果：过度参数化</span></span>
<span id="cb1025-2"><a href="模型选择与评估.html#cb1025-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;三次模型 (过度参数化):</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1025-3"><a href="模型选择与评估.html#cb1025-3" tabindex="-1"></a>    <span class="st">&quot;- $R^2$ =&quot;</span>, <span class="fu">round</span>(r2_cubic, <span class="dv">3</span>), <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">text{AIC}$ =&quot;</span>, <span class="fu">round</span>(aic_cubic, <span class="dv">1</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1025-4"><a href="模型选择与评估.html#cb1025-4" tabindex="-1"></a>    <span class="st">&quot;- 问题：不必要的复杂度</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 三次模型 (过度参数化):
##  - $R^2$ = 0.416 $\text{AIC}$ = 733.3 
##  - 问题：不必要的复杂度</code></pre>
<div class="sourceCode" id="cb1027"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1027-1"><a href="模型选择与评估.html#cb1027-1" tabindex="-1"></a><span class="co"># 10次多项式结果：严重过拟合</span></span>
<span id="cb1027-2"><a href="模型选择与评估.html#cb1027-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;10次多项式 (严重过拟合):</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1027-3"><a href="模型选择与评估.html#cb1027-3" tabindex="-1"></a>    <span class="st">&quot;- $R^2$ =&quot;</span>, <span class="fu">round</span>(r2_overfit, <span class="dv">3</span>), <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">text{AIC}$ =&quot;</span>, <span class="fu">round</span>(aic_overfit, <span class="dv">1</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1027-4"><a href="模型选择与评估.html#cb1027-4" tabindex="-1"></a>    <span class="st">&quot;- 问题：过度适应随机噪声，预测能力差</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 10次多项式 (严重过拟合):
##  - $R^2$ = 0.455 $\text{AIC}$ = 740.4 
##  - 问题：过度适应随机噪声，预测能力差</code></pre>
<div class="sourceCode" id="cb1029"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1029-1"><a href="模型选择与评估.html#cb1029-1" tabindex="-1"></a><span class="co"># 生态学解释</span></span>
<span id="cb1029-2"><a href="模型选择与评估.html#cb1029-2" tabindex="-1"></a><span class="co"># 总结生态学意义和模型选择启示</span></span>
<span id="cb1029-3"><a href="模型选择与评估.html#cb1029-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模型比较结果已生成，请查看图表和性能指标。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 模型比较结果已生成，请查看图表和性能指标。</code></pre>
<p>通过模型复杂度与拟合优度平衡的演示，我们可以得出重要的生态学启示。在这个植物生物量与土壤养分的例子中，真实生态关系是二次的，反映了物种对养分的最适响应模式。线性模型虽然简单，但过于简化，无法捕捉这种生态学模式；而二次模型既充分捕捉了生态关系，又保持了简约性。高次多项式虽然<span class="math inline">\(R^2\)</span>更高，但生态学意义不明确，<span class="math inline">\(\text{AIC}\)</span>值也确认了二次模型的最优性。</p>
</div>
<div id="信息准则" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> 信息准则<a href="模型选择与评估.html#信息准则" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>信息准则是模型选择中最重要的统计工具，它们通过数学方法量化了模型复杂度和拟合优度之间的权衡。在生态学研究中，信息准则为我们提供了客观的模型比较标准，帮助我们避免主观偏见对模型选择的影响。</p>
<p><strong>AIC（赤池信息准则）</strong>是由日本统计学家赤池弘次在1974年提出的，其核心思想是基于信息论来衡量模型的相对质量。AIC的计算公式为：<span class="math display">\[\text{AIC} = -2 \ln(L) + 2k\]</span>，其中<span class="math inline">\(L\)</span>是模型的最大似然值，<span class="math inline">\(k\)</span>是模型参数的数量。这个公式体现了信息准则的基本哲学：第一项惩罚模型对数据的拟合不足，第二项惩罚模型的复杂度。</p>
<p><span class="math inline">\(\text{AIC}\)</span>的生态学意义在于它量化了模型的信息损失。当我们用模型来描述生态数据时，总会丢失一些信息。<span class="math inline">\(\text{AIC}\)</span>估计了这种信息损失的大小，<span class="math inline">\(\text{AIC}\)</span>值越小的模型，信息损失越小，模型质量越高。在生态学应用中，<span class="math inline">\(\text{AIC}\)</span>特别适合用于比较非嵌套模型，即那些具有不同变量组合或不同函数形式的模型。</p>
<p><span class="math inline">\(\text{AIC}\)</span>的一个关键特性是它的相对性。<span class="math inline">\(\text{AIC}\)</span>值本身没有绝对意义，只有不同模型之间的<span class="math inline">\(\text{AIC}\)</span>差异<span class="math inline">\(\Delta\text{AIC}\)</span>才有意义。通常认为，<span class="math inline">\(\Delta\text{AIC} &lt; 2\)</span>的模型在统计上难以区分，<span class="math inline">\(2 \leq \Delta\text{AIC} \leq 7\)</span>的模型有实质性差异，<span class="math inline">\(\Delta\text{AIC} &gt; 10\)</span>的模型则明显优劣分明。这种相对比较的特性使得<span class="math inline">\(\text{AIC}\)</span>特别适合生态学研究，因为生态学中很少存在”完美”的模型。</p>
<p><strong>BIC（贝叶斯信息准则）</strong>是AIC的改进版本，由Gideon Schwarz在1978年提出。BIC的计算公式为：<span class="math display">\[\text{BIC} = -2 \ln(L) + k \ln(n)\]</span>，其中<span class="math inline">\(n\)</span>是样本量。与AIC相比，BIC对模型复杂度的惩罚更强，特别是当样本量较大时。</p>
<p><span class="math inline">\(\text{BIC}\)</span>的数学基础是贝叶斯因子，它估计了模型的后验概率。在生态学研究中，<span class="math inline">\(\text{BIC}\)</span>特别适合用于比较具有明确理论基础的模型，因为它倾向于选择那些在贝叶斯框架下更有可能的模型。<span class="math inline">\(\text{BIC}\)</span>的另一个优势是它的一致性特性：当样本量趋于无穷大时，<span class="math inline">\(\text{BIC}\)</span>会选择真实的模型（如果真实模型在候选模型中）。</p>
<p>在生态学实践中，<span class="math inline">\(\text{AIC}\)</span>和<span class="math inline">\(\text{BIC}\)</span>的选择取决于研究目标。如果研究目标是预测，<span class="math inline">\(\text{AIC}\)</span>通常更合适，因为它倾向于选择预测能力更强的模型。如果研究目标是机制探索和模型识别，<span class="math inline">\(\text{BIC}\)</span>可能更合适，因为它倾向于选择更简约的模型。对于小样本情况，推荐使用<span class="math inline">\(\text{AIC}\)</span>的修正版本<span class="math inline">\(\text{AIC}_c\)</span>。</p>
<p>信息准则在生态学中的应用需要谨慎。首先，信息准则只能比较基于相同数据的模型。其次，信息准则假设候选模型已经包含了真实模型，这在生态学中往往不成立。第三，信息准则对样本量敏感，小样本情况下可能需要使用修正版本如<span class="math inline">\(\text{AIC}_c\)</span>。</p>
<div class="sourceCode" id="cb1031"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1031-1"><a href="模型选择与评估.html#cb1031-1" tabindex="-1"></a><span class="co"># 信息准则在生态学中的应用演示</span></span>
<span id="cb1031-2"><a href="模型选择与评估.html#cb1031-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb1031-3"><a href="模型选择与评估.html#cb1031-3" tabindex="-1"></a></span>
<span id="cb1031-4"><a href="模型选择与评估.html#cb1031-4" tabindex="-1"></a><span class="co"># 生成生态学数据：鸟类丰富度与多个环境因子的关系</span></span>
<span id="cb1031-5"><a href="模型选择与评估.html#cb1031-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1031-6"><a href="模型选择与评估.html#cb1031-6" tabindex="-1"></a></span>
<span id="cb1031-7"><a href="模型选择与评估.html#cb1031-7" tabindex="-1"></a><span class="co"># 真实环境因子</span></span>
<span id="cb1031-8"><a href="模型选择与评估.html#cb1031-8" tabindex="-1"></a>habitat_area <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">100</span>) <span class="co"># 栖息地面积</span></span>
<span id="cb1031-9"><a href="模型选择与评估.html#cb1031-9" tabindex="-1"></a>vegetation_density <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="fl">0.1</span>, <span class="fl">0.9</span>) <span class="co"># 植被密度</span></span>
<span id="cb1031-10"><a href="模型选择与评估.html#cb1031-10" tabindex="-1"></a>distance_to_water <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="fl">0.1</span>, <span class="dv">5</span>) <span class="co"># 距水源距离</span></span>
<span id="cb1031-11"><a href="模型选择与评估.html#cb1031-11" tabindex="-1"></a>soil_ph <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="fl">4.5</span>, <span class="fl">8.5</span>) <span class="co"># 土壤pH值</span></span>
<span id="cb1031-12"><a href="模型选择与评估.html#cb1031-12" tabindex="-1"></a></span>
<span id="cb1031-13"><a href="模型选择与评估.html#cb1031-13" tabindex="-1"></a><span class="co"># 生成鸟类丰富度（只有部分变量有真实影响）</span></span>
<span id="cb1031-14"><a href="模型选择与评估.html#cb1031-14" tabindex="-1"></a><span class="co"># 真实关系：丰富度 ~ 面积 + 植被密度 + 距水源距离</span></span>
<span id="cb1031-15"><a href="模型选择与评估.html#cb1031-15" tabindex="-1"></a>bird_richness <span class="ot">&lt;-</span> <span class="fu">rpois</span>(</span>
<span id="cb1031-16"><a href="模型选择与评估.html#cb1031-16" tabindex="-1"></a>  n,</span>
<span id="cb1031-17"><a href="模型选择与评估.html#cb1031-17" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fl">1.5</span> <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> habitat_area <span class="sc">+</span></span>
<span id="cb1031-18"><a href="模型选择与评估.html#cb1031-18" tabindex="-1"></a>    <span class="fl">1.2</span> <span class="sc">*</span> vegetation_density <span class="sc">-</span> <span class="fl">0.3</span> <span class="sc">*</span> distance_to_water <span class="sc">+</span></span>
<span id="cb1031-19"><a href="模型选择与评估.html#cb1031-19" tabindex="-1"></a>    <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.3</span>))</span>
<span id="cb1031-20"><a href="模型选择与评估.html#cb1031-20" tabindex="-1"></a>)</span>
<span id="cb1031-21"><a href="模型选择与评估.html#cb1031-21" tabindex="-1"></a></span>
<span id="cb1031-22"><a href="模型选择与评估.html#cb1031-22" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb1031-23"><a href="模型选择与评估.html#cb1031-23" tabindex="-1"></a>bird_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1031-24"><a href="模型选择与评估.html#cb1031-24" tabindex="-1"></a>  <span class="at">richness =</span> bird_richness,</span>
<span id="cb1031-25"><a href="模型选择与评估.html#cb1031-25" tabindex="-1"></a>  <span class="at">area =</span> habitat_area,</span>
<span id="cb1031-26"><a href="模型选择与评估.html#cb1031-26" tabindex="-1"></a>  <span class="at">vegetation =</span> vegetation_density,</span>
<span id="cb1031-27"><a href="模型选择与评估.html#cb1031-27" tabindex="-1"></a>  <span class="at">water_distance =</span> distance_to_water,</span>
<span id="cb1031-28"><a href="模型选择与评估.html#cb1031-28" tabindex="-1"></a>  <span class="at">soil_ph =</span> soil_ph</span>
<span id="cb1031-29"><a href="模型选择与评估.html#cb1031-29" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1032"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1032-1"><a href="模型选择与评估.html#cb1032-1" tabindex="-1"></a><span class="co"># 构建多个候选模型</span></span>
<span id="cb1032-2"><a href="模型选择与评估.html#cb1032-2" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1032-3"><a href="模型选择与评估.html#cb1032-3" tabindex="-1"></a></span>
<span id="cb1032-4"><a href="模型选择与评估.html#cb1032-4" tabindex="-1"></a><span class="co"># 简单模型</span></span>
<span id="cb1032-5"><a href="模型选择与评估.html#cb1032-5" tabindex="-1"></a>models[[<span class="st">&quot;area_only&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(richness <span class="sc">~</span> area, <span class="at">data =</span> bird_data)</span>
<span id="cb1032-6"><a href="模型选择与评估.html#cb1032-6" tabindex="-1"></a>models[[<span class="st">&quot;vegetation_only&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(richness <span class="sc">~</span> vegetation, <span class="at">data =</span> bird_data)</span>
<span id="cb1032-7"><a href="模型选择与评估.html#cb1032-7" tabindex="-1"></a></span>
<span id="cb1032-8"><a href="模型选择与评估.html#cb1032-8" tabindex="-1"></a><span class="co"># 中等复杂度模型</span></span>
<span id="cb1032-9"><a href="模型选择与评估.html#cb1032-9" tabindex="-1"></a>models[[<span class="st">&quot;area_vegetation&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(richness <span class="sc">~</span> area <span class="sc">+</span> vegetation,</span>
<span id="cb1032-10"><a href="模型选择与评估.html#cb1032-10" tabindex="-1"></a>  <span class="at">data =</span> bird_data)</span>
<span id="cb1032-11"><a href="模型选择与评估.html#cb1032-11" tabindex="-1"></a>models[[<span class="st">&quot;area_water&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(richness <span class="sc">~</span> area <span class="sc">+</span> water_distance,</span>
<span id="cb1032-12"><a href="模型选择与评估.html#cb1032-12" tabindex="-1"></a>  <span class="at">data =</span> bird_data)</span>
<span id="cb1032-13"><a href="模型选择与评估.html#cb1032-13" tabindex="-1"></a></span>
<span id="cb1032-14"><a href="模型选择与评估.html#cb1032-14" tabindex="-1"></a><span class="co"># 复杂模型</span></span>
<span id="cb1032-15"><a href="模型选择与评估.html#cb1032-15" tabindex="-1"></a>models[[<span class="st">&quot;full_model&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(richness <span class="sc">~</span> area <span class="sc">+</span> vegetation <span class="sc">+</span></span>
<span id="cb1032-16"><a href="模型选择与评估.html#cb1032-16" tabindex="-1"></a>  water_distance <span class="sc">+</span> soil_ph, <span class="at">data =</span> bird_data)</span>
<span id="cb1032-17"><a href="模型选择与评估.html#cb1032-17" tabindex="-1"></a>models[[<span class="st">&quot;overfit_model&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(richness <span class="sc">~</span> area <span class="sc">+</span> vegetation <span class="sc">+</span></span>
<span id="cb1032-18"><a href="模型选择与评估.html#cb1032-18" tabindex="-1"></a>  water_distance <span class="sc">+</span> soil_ph <span class="sc">+</span> <span class="fu">I</span>(area<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(vegetation<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb1032-19"><a href="模型选择与评估.html#cb1032-19" tabindex="-1"></a>  <span class="at">data =</span> bird_data)</span></code></pre></div>
<div class="sourceCode" id="cb1033"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1033-1"><a href="模型选择与评估.html#cb1033-1" tabindex="-1"></a><span class="co"># 计算信息准则</span></span>
<span id="cb1033-2"><a href="模型选择与评估.html#cb1033-2" tabindex="-1"></a>model_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1033-3"><a href="模型选择与评估.html#cb1033-3" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">names</span>(models),</span>
<span id="cb1033-4"><a href="模型选择与评估.html#cb1033-4" tabindex="-1"></a>  <span class="at">R2 =</span> <span class="fu">sapply</span>(models, <span class="cf">function</span>(m) <span class="fu">summary</span>(m)<span class="sc">$</span>r.squared),</span>
<span id="cb1033-5"><a href="模型选择与评估.html#cb1033-5" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">sapply</span>(models, AIC),</span>
<span id="cb1033-6"><a href="模型选择与评估.html#cb1033-6" tabindex="-1"></a>  <span class="at">BIC =</span> <span class="fu">sapply</span>(models, BIC),</span>
<span id="cb1033-7"><a href="模型选择与评估.html#cb1033-7" tabindex="-1"></a>  <span class="at">Parameters =</span> <span class="fu">sapply</span>(models, <span class="cf">function</span>(m) <span class="fu">length</span>(<span class="fu">coef</span>(m)))</span>
<span id="cb1033-8"><a href="模型选择与评估.html#cb1033-8" tabindex="-1"></a>)</span>
<span id="cb1033-9"><a href="模型选择与评估.html#cb1033-9" tabindex="-1"></a></span>
<span id="cb1033-10"><a href="模型选择与评估.html#cb1033-10" tabindex="-1"></a><span class="co"># 计算$\\text{AIC}$和$\\text{BIC}$差异</span></span>
<span id="cb1033-11"><a href="模型选择与评估.html#cb1033-11" tabindex="-1"></a>model_comparison<span class="sc">$</span>delta_AIC <span class="ot">&lt;-</span> model_comparison<span class="sc">$</span>AIC <span class="sc">-</span> <span class="fu">min</span>(model_comparison<span class="sc">$</span>AIC)</span>
<span id="cb1033-12"><a href="模型选择与评估.html#cb1033-12" tabindex="-1"></a>model_comparison<span class="sc">$</span>delta_BIC <span class="ot">&lt;-</span> model_comparison<span class="sc">$</span>BIC <span class="sc">-</span> <span class="fu">min</span>(model_comparison<span class="sc">$</span>BIC)</span>
<span id="cb1033-13"><a href="模型选择与评估.html#cb1033-13" tabindex="-1"></a></span>
<span id="cb1033-14"><a href="模型选择与评估.html#cb1033-14" tabindex="-1"></a><span class="co"># 计算$\\text{AIC}$权重</span></span>
<span id="cb1033-15"><a href="模型选择与评估.html#cb1033-15" tabindex="-1"></a>model_comparison<span class="sc">$</span>AIC_weight <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> model_comparison<span class="sc">$</span>delta_AIC) <span class="sc">/</span></span>
<span id="cb1033-16"><a href="模型选择与评估.html#cb1033-16" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> model_comparison<span class="sc">$</span>delta_AIC))</span>
<span id="cb1033-17"><a href="模型选择与评估.html#cb1033-17" tabindex="-1"></a></span>
<span id="cb1033-18"><a href="模型选择与评估.html#cb1033-18" tabindex="-1"></a><span class="co"># 排序</span></span>
<span id="cb1033-19"><a href="模型选择与评估.html#cb1033-19" tabindex="-1"></a>model_comparison <span class="ot">&lt;-</span> model_comparison[<span class="fu">order</span>(model_comparison<span class="sc">$</span>AIC), ]</span>
<span id="cb1033-20"><a href="模型选择与评估.html#cb1033-20" tabindex="-1"></a></span>
<span id="cb1033-21"><a href="模型选择与评估.html#cb1033-21" tabindex="-1"></a><span class="co"># 确定最优模型</span></span>
<span id="cb1033-22"><a href="模型选择与评估.html#cb1033-22" tabindex="-1"></a>best_aic <span class="ot">&lt;-</span> model_comparison<span class="sc">$</span>Model[<span class="dv">1</span>]</span>
<span id="cb1033-23"><a href="模型选择与评估.html#cb1033-23" tabindex="-1"></a>best_bic <span class="ot">&lt;-</span> model_comparison<span class="sc">$</span>Model[<span class="fu">which.min</span>(model_comparison<span class="sc">$</span>BIC)]</span></code></pre></div>
<div class="sourceCode" id="cb1034"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1034-1"><a href="模型选择与评估.html#cb1034-1" tabindex="-1"></a><span class="co"># 输出模型比较结果</span></span>
<span id="cb1034-2"><a href="模型选择与评估.html#cb1034-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;信息准则模型比较结果已生成，请查看表格和可视化图表。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 信息准则模型比较结果已生成，请查看表格和可视化图表。</code></pre>
<div class="sourceCode" id="cb1036"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1036-1"><a href="模型选择与评估.html#cb1036-1" tabindex="-1"></a><span class="fu">print</span>(model_comparison, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>##            Model        R2      AIC      BIC Parameters delta_AIC delta_BIC
##       full_model 0.6061475 737.9981 753.6291          5  0.000000  0.000000
##    overfit_model 0.6127788 740.3000 761.1414          7  2.301941  7.512282
##       area_water 0.5108839 755.6604 766.0811          3 17.662332 12.451992
##  area_vegetation 0.4191497 772.8497 783.2704          3 34.851646 29.641305
##        area_only 0.3416164 783.3792 791.1947          2 45.381119 37.565609
##  vegetation_only 0.1191910 812.4845 820.3000          2 74.486428 66.670918
##    AIC_weight
##  7.596039e-01
##  2.402851e-01
##  1.109840e-04
##  2.054227e-08
##  1.062190e-10
##  5.082352e-17</code></pre>
<div class="sourceCode" id="cb1038"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1038-1"><a href="模型选择与评估.html#cb1038-1" tabindex="-1"></a><span class="co"># 可视化信息准则比较</span></span>
<span id="cb1038-2"><a href="模型选择与评估.html#cb1038-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1038-3"><a href="模型选择与评估.html#cb1038-3" tabindex="-1"></a></span>
<span id="cb1038-4"><a href="模型选择与评估.html#cb1038-4" tabindex="-1"></a><span class="co"># AIC比较</span></span>
<span id="cb1038-5"><a href="模型选择与评估.html#cb1038-5" tabindex="-1"></a><span class="fu">barplot</span>(model_comparison<span class="sc">$</span>delta_AIC,</span>
<span id="cb1038-6"><a href="模型选择与评估.html#cb1038-6" tabindex="-1"></a>  <span class="at">names.arg =</span> model_comparison<span class="sc">$</span>Model,</span>
<span id="cb1038-7"><a href="模型选择与评估.html#cb1038-7" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(Delta, <span class="st">&quot;AIC差异比较&quot;</span>)),</span>
<span id="cb1038-8"><a href="模型选择与评估.html#cb1038-8" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;模型&quot;</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(Delta, <span class="st">&quot;AIC&quot;</span>)),</span>
<span id="cb1038-9"><a href="模型选择与评估.html#cb1038-9" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">ifelse</span>(model_comparison<span class="sc">$</span>delta_AIC <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="st">&quot;green&quot;</span>,</span>
<span id="cb1038-10"><a href="模型选择与评估.html#cb1038-10" tabindex="-1"></a>    <span class="fu">ifelse</span>(model_comparison<span class="sc">$</span>delta_AIC <span class="sc">&lt;</span> <span class="dv">7</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb1038-11"><a href="模型选择与评估.html#cb1038-11" tabindex="-1"></a>  ),</span>
<span id="cb1038-12"><a href="模型选择与评估.html#cb1038-12" tabindex="-1"></a>  <span class="at">las =</span> <span class="dv">2</span>, <span class="at">cex.names =</span> <span class="fl">0.7</span></span>
<span id="cb1038-13"><a href="模型选择与评估.html#cb1038-13" tabindex="-1"></a>)</span>
<span id="cb1038-14"><a href="模型选择与评估.html#cb1038-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb1038-15"><a href="模型选择与评估.html#cb1038-15" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">7</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb1038-16"><a href="模型选择与评估.html#cb1038-16" tabindex="-1"></a></span>
<span id="cb1038-17"><a href="模型选择与评估.html#cb1038-17" tabindex="-1"></a><span class="co"># BIC比较</span></span>
<span id="cb1038-18"><a href="模型选择与评估.html#cb1038-18" tabindex="-1"></a><span class="fu">barplot</span>(model_comparison<span class="sc">$</span>delta_BIC,</span>
<span id="cb1038-19"><a href="模型选择与评估.html#cb1038-19" tabindex="-1"></a>  <span class="at">names.arg =</span> model_comparison<span class="sc">$</span>Model,</span>
<span id="cb1038-20"><a href="模型选择与评估.html#cb1038-20" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(Delta, <span class="st">&quot;BIC差异比较&quot;</span>)),</span>
<span id="cb1038-21"><a href="模型选择与评估.html#cb1038-21" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;模型&quot;</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(Delta, <span class="st">&quot;BIC&quot;</span>)),</span>
<span id="cb1038-22"><a href="模型选择与评估.html#cb1038-22" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">ifelse</span>(model_comparison<span class="sc">$</span>delta_BIC <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="st">&quot;green&quot;</span>,</span>
<span id="cb1038-23"><a href="模型选择与评估.html#cb1038-23" tabindex="-1"></a>    <span class="fu">ifelse</span>(model_comparison<span class="sc">$</span>delta_BIC <span class="sc">&lt;</span> <span class="dv">7</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb1038-24"><a href="模型选择与评估.html#cb1038-24" tabindex="-1"></a>  ),</span>
<span id="cb1038-25"><a href="模型选择与评估.html#cb1038-25" tabindex="-1"></a>  <span class="at">las =</span> <span class="dv">2</span>, <span class="at">cex.names =</span> <span class="fl">0.7</span></span>
<span id="cb1038-26"><a href="模型选择与评估.html#cb1038-26" tabindex="-1"></a>)</span>
<span id="cb1038-27"><a href="模型选择与评估.html#cb1038-27" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb1038-28"><a href="模型选择与评估.html#cb1038-28" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">7</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-10-1.png" alt="信息准则可视化：ΔAIC和ΔBIC差异比较" width="672" />
<p class="caption">
图2.6: 信息准则可视化：ΔAIC和ΔBIC差异比较
</p>
</div>
<div class="sourceCode" id="cb1039"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1039-1"><a href="模型选择与评估.html#cb1039-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>根据信息准则的分析结果，我们可以得出重要的模型选择启示。根据<span class="math inline">\(\text{AIC}\)</span>准则，最优模型是full_model，其<span class="math inline">\(\text{AIC}\)</span>权重为0.76，表明这个模型在候选模型中最有可能。根据<span class="math inline">\(\text{BIC}\)</span>准则，最优模型是full_model，<span class="math inline">\(\text{BIC}\)</span>倾向于选择更简约的模型。模型选择启示表明，full_model模型在<span class="math inline">\(\text{AIC}\)</span>和<span class="math inline">\(\text{BIC}\)</span>下都表现良好，这个模型包含了真实关系中的关键变量，而过度拟合模型虽然R²更高，但信息准则惩罚了其复杂度。</p>
<p>在这个鸟类丰富度的例子中，栖息地面积和植被密度是影响鸟类丰富度的关键因子，信息准则帮助我们识别了这些关键因子，避免了过度拟合。最优模型既统计可靠又具有明确的生态学意义。</p>
</div>
<div id="似然比检验" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> 似然比检验<a href="模型选择与评估.html#似然比检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>似然比检验是模型选择中用于比较嵌套模型的经典统计方法。在生态学研究中，嵌套模型是指一个模型是另一个模型的特殊情形，通常通过约束某些参数为零或相等来实现。似然比检验通过比较两个嵌套模型的拟合差异，来判断增加模型复杂度是否带来了统计上显著的改善。</p>
<p><strong>基本原理</strong>：似然比检验基于两个嵌套模型的最大似然值比较。设<span class="math inline">\(L_0\)</span>为简单模型（零模型）的最大似然值，<span class="math inline">\(L_1\)</span>为复杂模型（备择模型）的最大似然值。似然比统计量<span class="math display">\[\text{LR} = -2 \ln\left(\frac{L_0}{L_1}\right) = 2(\ln L_1 - \ln L_0)\]</span>。在零假设（简单模型足够好）下，LR统计量近似服从卡方分布，自由度为两个模型参数数量的差异。</p>
<p>似然比检验的生态学意义在于它提供了统计显著性检验，帮助我们判断增加模型复杂度是否值得。例如，在研究物种分布与环境因子的关系时，我们可能想知道是否需要考虑环境因子之间的交互作用。通过比较包含交互项的模型和不包含交互项的模型，似然比检验可以告诉我们交互作用是否统计显著。</p>
<p><strong>应用场景</strong>：似然比检验在生态学中有广泛的应用。在广义线性模型中，它可以用于比较不同的连接函数；在混合效应模型中，它可以用于检验随机效应的显著性；在物种分布模型中，它可以用于比较不同的环境变量组合。</p>
<p><strong>局限性</strong>：似然比检验只能用于比较嵌套模型，对于非嵌套模型的比较无能为力。此外，似然比检验对样本量敏感，大样本情况下即使很小的改善也可能统计显著，但这不一定具有生态学意义。</p>
<div class="sourceCode" id="cb1040"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1040-1"><a href="模型选择与评估.html#cb1040-1" tabindex="-1"></a><span class="co"># 似然比检验数据生成：植物生长与温度、光照的关系</span></span>
<span id="cb1040-2"><a href="模型选择与评估.html#cb1040-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb1040-3"><a href="模型选择与评估.html#cb1040-3" tabindex="-1"></a></span>
<span id="cb1040-4"><a href="模型选择与评估.html#cb1040-4" tabindex="-1"></a><span class="co"># 生成生态学数据：植物生长与温度、光照的关系</span></span>
<span id="cb1040-5"><a href="模型选择与评估.html#cb1040-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb1040-6"><a href="模型选择与评估.html#cb1040-6" tabindex="-1"></a></span>
<span id="cb1040-7"><a href="模型选择与评估.html#cb1040-7" tabindex="-1"></a>temperature <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">15</span>, <span class="dv">30</span>) <span class="co"># 温度(°C)</span></span>
<span id="cb1040-8"><a href="模型选择与评估.html#cb1040-8" tabindex="-1"></a>light_intensity <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">100</span>, <span class="dv">1000</span>) <span class="co"># 光照强度(lux)</span></span>
<span id="cb1040-9"><a href="模型选择与评估.html#cb1040-9" tabindex="-1"></a></span>
<span id="cb1040-10"><a href="模型选择与评估.html#cb1040-10" tabindex="-1"></a><span class="co"># 生成植物生长数据（存在温度-光照交互作用）</span></span>
<span id="cb1040-11"><a href="模型选择与评估.html#cb1040-11" tabindex="-1"></a>growth_rate <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fl">0.002</span> <span class="sc">*</span> light_intensity <span class="sc">+</span></span>
<span id="cb1040-12"><a href="模型选择与评估.html#cb1040-12" tabindex="-1"></a>  <span class="fl">0.0001</span> <span class="sc">*</span> temperature <span class="sc">*</span> light_intensity <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb1040-13"><a href="模型选择与评估.html#cb1040-13" tabindex="-1"></a></span>
<span id="cb1040-14"><a href="模型选择与评估.html#cb1040-14" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb1040-15"><a href="模型选择与评估.html#cb1040-15" tabindex="-1"></a>plant_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1040-16"><a href="模型选择与评估.html#cb1040-16" tabindex="-1"></a>  <span class="at">growth =</span> growth_rate,</span>
<span id="cb1040-17"><a href="模型选择与评估.html#cb1040-17" tabindex="-1"></a>  <span class="at">temp =</span> temperature,</span>
<span id="cb1040-18"><a href="模型选择与评估.html#cb1040-18" tabindex="-1"></a>  <span class="at">light =</span> light_intensity</span>
<span id="cb1040-19"><a href="模型选择与评估.html#cb1040-19" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb1041"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1041-1"><a href="模型选择与评估.html#cb1041-1" tabindex="-1"></a><span class="co"># 构建嵌套模型进行比较</span></span>
<span id="cb1041-2"><a href="模型选择与评估.html#cb1041-2" tabindex="-1"></a><span class="co"># 简单模型：只有主效应</span></span>
<span id="cb1041-3"><a href="模型选择与评估.html#cb1041-3" tabindex="-1"></a>model_simple <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> temp <span class="sc">+</span> light, <span class="at">data =</span> plant_data)</span>
<span id="cb1041-4"><a href="模型选择与评估.html#cb1041-4" tabindex="-1"></a></span>
<span id="cb1041-5"><a href="模型选择与评估.html#cb1041-5" tabindex="-1"></a><span class="co"># 复杂模型：包含交互项</span></span>
<span id="cb1041-6"><a href="模型选择与评估.html#cb1041-6" tabindex="-1"></a>model_complex <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> temp <span class="sc">*</span> light, <span class="at">data =</span> plant_data)</span>
<span id="cb1041-7"><a href="模型选择与评估.html#cb1041-7" tabindex="-1"></a></span>
<span id="cb1041-8"><a href="模型选择与评估.html#cb1041-8" tabindex="-1"></a><span class="co"># 执行似然比检验</span></span>
<span id="cb1041-9"><a href="模型选择与评估.html#cb1041-9" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb1041-10"><a href="模型选择与评估.html#cb1041-10" tabindex="-1"></a>lrt_result <span class="ot">&lt;-</span> <span class="fu">lrtest</span>(model_simple, model_complex)</span>
<span id="cb1041-11"><a href="模型选择与评估.html#cb1041-11" tabindex="-1"></a></span>
<span id="cb1041-12"><a href="模型选择与评估.html#cb1041-12" tabindex="-1"></a><span class="co"># 提取似然比检验的p值</span></span>
<span id="cb1041-13"><a href="模型选择与评估.html#cb1041-13" tabindex="-1"></a>lrt_p_value <span class="ot">&lt;-</span> lrt_result<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>]</span></code></pre></div>
<div class="sourceCode" id="cb1042"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1042-1"><a href="模型选择与评估.html#cb1042-1" tabindex="-1"></a><span class="co"># 输出似然比检验结果</span></span>
<span id="cb1042-2"><a href="模型选择与评估.html#cb1042-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 似然比检验结果 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 似然比检验结果 ===</code></pre>
<div class="sourceCode" id="cb1044"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1044-1"><a href="模型选择与评估.html#cb1044-1" tabindex="-1"></a><span class="fu">print</span>(lrt_result)</span></code></pre></div>
<pre><code>## Likelihood ratio test
## 
## Model 1: growth ~ temp + light
## Model 2: growth ~ temp * light
##   #Df  LogLik Df Chisq Pr(&gt;Chisq)  
## 1   4 -58.869                      
## 2   5 -56.401  1 4.936     0.0263 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb1046"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1046-1"><a href="模型选择与评估.html#cb1046-1" tabindex="-1"></a><span class="co"># 模型摘要比较</span></span>
<span id="cb1046-2"><a href="模型选择与评估.html#cb1046-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 模型摘要比较 ===</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1046-3"><a href="模型选择与评估.html#cb1046-3" tabindex="-1"></a>    <span class="st">&quot;简单模型 (只有主效应):</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 模型摘要比较 ===
##  简单模型 (只有主效应):</code></pre>
<div class="sourceCode" id="cb1048"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1048-1"><a href="模型选择与评估.html#cb1048-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(model_simple))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = growth ~ temp + light, data = plant_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.24188 -0.39315  0.08864  0.32660  1.46123 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.9522163  0.3475783    2.74  0.00764 ** 
## temp        0.1589956  0.0149805   10.61  &lt; 2e-16 ***
## light       0.0037280  0.0002189   17.03  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5148 on 77 degrees of freedom
## Multiple R-squared:  0.8452, Adjusted R-squared:  0.8412 
## F-statistic: 210.2 on 2 and 77 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb1050"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1050-1"><a href="模型选择与评估.html#cb1050-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">复杂模型 (包含交互项):</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 复杂模型 (包含交互项):</code></pre>
<div class="sourceCode" id="cb1052"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1052-1"><a href="模型选择与评估.html#cb1052-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(model_complex))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = growth ~ temp * light, data = plant_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.3498 -0.2968  0.0838  0.3428  1.3353 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 2.622e+00  8.315e-01   3.153  0.00231 **
## temp        8.192e-02  3.797e-02   2.157  0.03416 * 
## light       9.325e-04  1.289e-03   0.723  0.47164   
## temp:light  1.286e-04  5.847e-05   2.199  0.03090 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5024 on 76 degrees of freedom
## Multiple R-squared:  0.8545, Adjusted R-squared:  0.8487 
## F-statistic: 148.7 on 3 and 76 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb1054"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1054-1"><a href="模型选择与评估.html#cb1054-1" tabindex="-1"></a><span class="co"># 计算模型改善程度</span></span>
<span id="cb1054-2"><a href="模型选择与评估.html#cb1054-2" tabindex="-1"></a>r2_simple <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_simple)<span class="sc">$</span>r.squared</span>
<span id="cb1054-3"><a href="模型选择与评估.html#cb1054-3" tabindex="-1"></a>r2_complex <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_complex)<span class="sc">$</span>r.squared</span>
<span id="cb1054-4"><a href="模型选择与评估.html#cb1054-4" tabindex="-1"></a>r2_improvement <span class="ot">&lt;-</span> r2_complex <span class="sc">-</span> r2_simple</span>
<span id="cb1054-5"><a href="模型选择与评估.html#cb1054-5" tabindex="-1"></a></span>
<span id="cb1054-6"><a href="模型选择与评估.html#cb1054-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 模型改善分析 ===</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1054-7"><a href="模型选择与评估.html#cb1054-7" tabindex="-1"></a>    <span class="st">&quot;R²改善:&quot;</span>, <span class="fu">round</span>(r2_improvement, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1054-8"><a href="模型选择与评估.html#cb1054-8" tabindex="-1"></a>    <span class="st">&quot;参数增加: 1个 (交互项)</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1054-9"><a href="模型选择与评估.html#cb1054-9" tabindex="-1"></a>    <span class="st">&quot;似然比检验p值:&quot;</span>, <span class="fu">round</span>(lrt_result<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>], <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 模型改善分析 ===
##  R²改善: 0.0093 
##  参数增加: 1个 (交互项)
##  似然比检验p值: 0.0263</code></pre>
<div class="sourceCode" id="cb1056"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1056-1"><a href="模型选择与评估.html#cb1056-1" tabindex="-1"></a><span class="co"># 解释似然比检验结果</span></span>
<span id="cb1056-2"><a href="模型选择与评估.html#cb1056-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;似然比检验结果已计算，请查看后续生态学解释。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 似然比检验结果已计算，请查看后续生态学解释。</code></pre>
<div class="sourceCode" id="cb1058"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1058-1"><a href="模型选择与评估.html#cb1058-1" tabindex="-1"></a><span class="co"># 可视化交互作用</span></span>
<span id="cb1058-2"><a href="模型选择与评估.html#cb1058-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 交互作用可视化 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 交互作用可视化 ===</code></pre>
<div class="sourceCode" id="cb1060"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1060-1"><a href="模型选择与评估.html#cb1060-1" tabindex="-1"></a><span class="co"># 创建预测网格</span></span>
<span id="cb1060-2"><a href="模型选择与评估.html#cb1060-2" tabindex="-1"></a>pred_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb1060-3"><a href="模型选择与评估.html#cb1060-3" tabindex="-1"></a>  <span class="at">temp =</span> <span class="fu">seq</span>(<span class="dv">15</span>, <span class="dv">30</span>, <span class="at">length.out =</span> <span class="dv">20</span>),</span>
<span id="cb1060-4"><a href="模型选择与评估.html#cb1060-4" tabindex="-1"></a>  <span class="at">light =</span> <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">600</span>, <span class="dv">900</span>) <span class="co"># 低、中、高光照</span></span>
<span id="cb1060-5"><a href="模型选择与评估.html#cb1060-5" tabindex="-1"></a>)</span>
<span id="cb1060-6"><a href="模型选择与评估.html#cb1060-6" tabindex="-1"></a></span>
<span id="cb1060-7"><a href="模型选择与评估.html#cb1060-7" tabindex="-1"></a><span class="co"># 使用复杂模型进行预测</span></span>
<span id="cb1060-8"><a href="模型选择与评估.html#cb1060-8" tabindex="-1"></a>pred_grid<span class="sc">$</span>pred_growth <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_complex, <span class="at">newdata =</span> pred_grid)</span>
<span id="cb1060-9"><a href="模型选择与评估.html#cb1060-9" tabindex="-1"></a></span>
<span id="cb1060-10"><a href="模型选择与评估.html#cb1060-10" tabindex="-1"></a><span class="co"># 绘制交互作用图</span></span>
<span id="cb1060-11"><a href="模型选择与评估.html#cb1060-11" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1060-12"><a href="模型选择与评估.html#cb1060-12" tabindex="-1"></a><span class="fu">ggplot</span>(pred_grid, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> pred_growth, <span class="at">color =</span> <span class="fu">factor</span>(light))) <span class="sc">+</span></span>
<span id="cb1060-13"><a href="模型选择与评估.html#cb1060-13" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1060-14"><a href="模型选择与评估.html#cb1060-14" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1060-15"><a href="模型选择与评估.html#cb1060-15" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;温度与光照对植物生长的交互作用&quot;</span>,</span>
<span id="cb1060-16"><a href="模型选择与评估.html#cb1060-16" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;温度 (°C)&quot;</span>,</span>
<span id="cb1060-17"><a href="模型选择与评估.html#cb1060-17" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;预测生长速率&quot;</span>,</span>
<span id="cb1060-18"><a href="模型选择与评估.html#cb1060-18" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;光照强度 (lux)&quot;</span></span>
<span id="cb1060-19"><a href="模型选择与评估.html#cb1060-19" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1060-20"><a href="模型选择与评估.html#cb1060-20" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1060-21"><a href="模型选择与评估.html#cb1060-21" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;300&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;600&quot;</span> <span class="ot">=</span> <span class="st">&quot;green&quot;</span>, <span class="st">&quot;900&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-15-1.png" alt="温度与光照对植物生长的交互作用：在不同光照强度下温度对植物生长速率的影响" width="672" />
<p class="caption">
图2.7: 温度与光照对植物生长的交互作用：在不同光照强度下温度对植物生长速率的影响
</p>
</div>
<p>根据似然比检验的结果（p值 = 0.0263），我们可以得出重要的生态学解释。似然比检验显著 (p &lt; 0.05)，表明温度与光照的交互作用对植物生长有显著影响，复杂模型显著改善了模型拟合，应该选择包含交互项的模型。</p>
<div class="sourceCode" id="cb1061"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1061-1"><a href="模型选择与评估.html#cb1061-1" tabindex="-1"></a><span class="co"># 生态学机制解释</span></span>
<span id="cb1061-2"><a href="模型选择与评估.html#cb1061-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;生态学机制分析结果已生成，请查看相关解释。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 生态学机制分析结果已生成，请查看相关解释。</code></pre>
</div>
<div id="模型平均" class="section level3 hasAnchor" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> 模型平均<a href="模型选择与评估.html#模型平均" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>模型平均是现代生态统计建模中的重要方法，它通过组合多个候选模型的预测来减少模型选择的不确定性。在生态学研究中，我们经常面临多个看似合理的模型，每个模型都基于不同的生态学假设。模型平均承认这种不确定性，并通过加权平均的方式利用所有候选模型的信息。</p>
<p><strong>基本原理</strong>：模型平均的核心思想是，没有一个模型是绝对正确的，但每个模型都可能包含部分真理。通过给不同的模型分配权重，然后组合它们的预测，我们可以获得更稳健、更准确的估计。模型权重通常基于信息准则（如<span class="math inline">\(\text{AIC}\)</span>权重）计算，权重反映了每个模型相对其他模型的证据强度。</p>
<p><strong><span class="math inline">\(\text{AIC}\)</span>权重</strong>是最常用的模型权重计算方法。对于每个模型<span class="math inline">\(i\)</span>，其<span class="math inline">\(\text{AIC}\)</span>权重<span class="math display">\[w_i = \frac{\exp(-0.5 \Delta\text{AIC}_i)}{\sum_j \exp(-0.5 \Delta\text{AIC}_j)}\]</span>，其中<span class="math inline">\(\Delta\text{AIC}_i\)</span>是模型<span class="math inline">\(i\)</span>与最优模型的<span class="math inline">\(\text{AIC}\)</span>差异。<span class="math inline">\(\text{AIC}\)</span>权重可以解释为模型<span class="math inline">\(i\)</span>是真实模型的相对概率。</p>
<p><strong>模型平均的类型</strong>：模型平均主要分为两种类型。参数平均是对不同模型的参数估计进行加权平均，适用于模型具有相同参数结构的情况。预测平均是对不同模型的预测值进行加权平均，适用于模型结构不同的情况。在生态学中，预测平均更为常用，因为它可以处理具有不同变量组合的模型。</p>
<p><strong>生态学意义</strong>：模型平均在生态学中具有重要的应用价值。首先，它减少了模型选择的不确定性，避免了”赢者通吃”的问题。其次，它提供了更稳健的参数估计和预测，特别是在小样本情况下。第三，它允许我们量化不同生态学假设的相对支持程度。</p>
<p><strong>局限性</strong>：模型平均需要谨慎使用。首先，它假设候选模型已经包含了真实模型，这在生态学中往往不成立。其次，模型平均可能稀释强信号，如果有一个明显优于其他模型的候选模型，模型平均可能不如直接选择这个最优模型。第三，模型平均的计算复杂度较高，特别是当候选模型数量很多时。</p>
<p>模型平均是现代生态统计建模中的重要方法，它通过组合多个候选模型的预测来减少模型选择的不确定性。在生态学研究中，我们经常面临多个看似合理的模型，每个模型都基于不同的生态学假设。模型平均承认这种不确定性，并通过加权平均的方式利用所有候选模型的信息。</p>
<div class="sourceCode" id="cb1063"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1063-1"><a href="模型选择与评估.html#cb1063-1" tabindex="-1"></a><span class="co"># 模型平均在生态学中的应用 - 数据生成</span></span>
<span id="cb1063-2"><a href="模型选择与评估.html#cb1063-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb1063-3"><a href="模型选择与评估.html#cb1063-3" tabindex="-1"></a></span>
<span id="cb1063-4"><a href="模型选择与评估.html#cb1063-4" tabindex="-1"></a><span class="co"># 生成生态学数据：鱼类丰度与水体环境因子的关系</span></span>
<span id="cb1063-5"><a href="模型选择与评估.html#cb1063-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb1063-6"><a href="模型选择与评估.html#cb1063-6" tabindex="-1"></a></span>
<span id="cb1063-7"><a href="模型选择与评估.html#cb1063-7" tabindex="-1"></a><span class="co"># 环境因子</span></span>
<span id="cb1063-8"><a href="模型选择与评估.html#cb1063-8" tabindex="-1"></a>water_temp <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">10</span>, <span class="dv">25</span>) <span class="co"># 水温(°C)</span></span>
<span id="cb1063-9"><a href="模型选择与评估.html#cb1063-9" tabindex="-1"></a>dissolved_oxygen <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">2</span>, <span class="dv">10</span>) <span class="co"># 溶解氧(mg/L)</span></span>
<span id="cb1063-10"><a href="模型选择与评估.html#cb1063-10" tabindex="-1"></a>ph_level <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="fl">6.5</span>, <span class="fl">8.5</span>) <span class="co"># pH值</span></span>
<span id="cb1063-11"><a href="模型选择与评估.html#cb1063-11" tabindex="-1"></a>turbidity <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">50</span>) <span class="co"># 浊度(NTU)</span></span>
<span id="cb1063-12"><a href="模型选择与评估.html#cb1063-12" tabindex="-1"></a></span>
<span id="cb1063-13"><a href="模型选择与评估.html#cb1063-13" tabindex="-1"></a><span class="co"># 生成鱼类丰度数据</span></span>
<span id="cb1063-14"><a href="模型选择与评估.html#cb1063-14" tabindex="-1"></a><span class="co"># 真实关系：丰度 ~ 水温 + 溶解氧 + pH</span></span>
<span id="cb1063-15"><a href="模型选择与评估.html#cb1063-15" tabindex="-1"></a>fish_abundance <span class="ot">&lt;-</span> <span class="fu">rpois</span>(</span>
<span id="cb1063-16"><a href="模型选择与评估.html#cb1063-16" tabindex="-1"></a>  n,</span>
<span id="cb1063-17"><a href="模型选择与评估.html#cb1063-17" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fl">2.0</span> <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> water_temp <span class="sc">+</span></span>
<span id="cb1063-18"><a href="模型选择与评估.html#cb1063-18" tabindex="-1"></a>    <span class="fl">0.15</span> <span class="sc">*</span> dissolved_oxygen <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> ph_level <span class="sc">+</span></span>
<span id="cb1063-19"><a href="模型选择与评估.html#cb1063-19" tabindex="-1"></a>    <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.2</span>))</span>
<span id="cb1063-20"><a href="模型选择与评估.html#cb1063-20" tabindex="-1"></a>)</span>
<span id="cb1063-21"><a href="模型选择与评估.html#cb1063-21" tabindex="-1"></a></span>
<span id="cb1063-22"><a href="模型选择与评估.html#cb1063-22" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb1063-23"><a href="模型选择与评估.html#cb1063-23" tabindex="-1"></a>fish_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1063-24"><a href="模型选择与评估.html#cb1063-24" tabindex="-1"></a>  <span class="at">abundance =</span> fish_abundance,</span>
<span id="cb1063-25"><a href="模型选择与评估.html#cb1063-25" tabindex="-1"></a>  <span class="at">temp =</span> water_temp,</span>
<span id="cb1063-26"><a href="模型选择与评估.html#cb1063-26" tabindex="-1"></a>  <span class="at">oxygen =</span> dissolved_oxygen,</span>
<span id="cb1063-27"><a href="模型选择与评估.html#cb1063-27" tabindex="-1"></a>  <span class="at">ph =</span> ph_level,</span>
<span id="cb1063-28"><a href="模型选择与评估.html#cb1063-28" tabindex="-1"></a>  <span class="at">turbidity =</span> turbidity</span>
<span id="cb1063-29"><a href="模型选择与评估.html#cb1063-29" tabindex="-1"></a>)</span></code></pre></div>
<p>构建基于不同生态学假设的候选模型是模型平均的第一步。每个模型代表了对生态过程的一种可能解释，模型平均通过AIC权重量化这些解释的相对合理性。</p>
<div class="sourceCode" id="cb1064"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1064-1"><a href="模型选择与评估.html#cb1064-1" tabindex="-1"></a><span class="co"># 构建多个候选模型（基于不同的生态学假设）</span></span>
<span id="cb1064-2"><a href="模型选择与评估.html#cb1064-2" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1064-3"><a href="模型选择与评估.html#cb1064-3" tabindex="-1"></a></span>
<span id="cb1064-4"><a href="模型选择与评估.html#cb1064-4" tabindex="-1"></a><span class="co"># 模型1：温度主导假说</span></span>
<span id="cb1064-5"><a href="模型选择与评估.html#cb1064-5" tabindex="-1"></a>models[[<span class="st">&quot;temp_model&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(abundance <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> temp, <span class="at">data =</span> fish_data)</span>
<span id="cb1064-6"><a href="模型选择与评估.html#cb1064-6" tabindex="-1"></a></span>
<span id="cb1064-7"><a href="模型选择与评估.html#cb1064-7" tabindex="-1"></a><span class="co"># 模型2：水质综合假说</span></span>
<span id="cb1064-8"><a href="模型选择与评估.html#cb1064-8" tabindex="-1"></a>models[[<span class="st">&quot;water_quality&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(abundance <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> temp <span class="sc">+</span> oxygen <span class="sc">+</span> ph, <span class="at">data =</span> fish_data)</span>
<span id="cb1064-9"><a href="模型选择与评估.html#cb1064-9" tabindex="-1"></a></span>
<span id="cb1064-10"><a href="模型选择与评估.html#cb1064-10" tabindex="-1"></a><span class="co"># 模型3：物理环境假说</span></span>
<span id="cb1064-11"><a href="模型选择与评估.html#cb1064-11" tabindex="-1"></a>models[[<span class="st">&quot;physical_env&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(abundance <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> temp <span class="sc">+</span> turbidity, <span class="at">data =</span> fish_data)</span>
<span id="cb1064-12"><a href="模型选择与评估.html#cb1064-12" tabindex="-1"></a></span>
<span id="cb1064-13"><a href="模型选择与评估.html#cb1064-13" tabindex="-1"></a><span class="co"># 模型4：全模型</span></span>
<span id="cb1064-14"><a href="模型选择与评估.html#cb1064-14" tabindex="-1"></a>models[[<span class="st">&quot;full_model&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(abundance <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> temp <span class="sc">+</span> oxygen <span class="sc">+</span> ph <span class="sc">+</span> turbidity, <span class="at">data =</span> fish_data)</span>
<span id="cb1064-15"><a href="模型选择与评估.html#cb1064-15" tabindex="-1"></a></span>
<span id="cb1064-16"><a href="模型选择与评估.html#cb1064-16" tabindex="-1"></a><span class="co"># 计算$\\text{AIC}$和权重</span></span>
<span id="cb1064-17"><a href="模型选择与评估.html#cb1064-17" tabindex="-1"></a>aic_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models, AIC)</span>
<span id="cb1064-18"><a href="模型选择与评估.html#cb1064-18" tabindex="-1"></a>delta_aic <span class="ot">&lt;-</span> aic_values <span class="sc">-</span> <span class="fu">min</span>(aic_values)</span>
<span id="cb1064-19"><a href="模型选择与评估.html#cb1064-19" tabindex="-1"></a>aic_weights <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> delta_aic) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> delta_aic))</span>
<span id="cb1064-20"><a href="模型选择与评估.html#cb1064-20" tabindex="-1"></a></span>
<span id="cb1064-21"><a href="模型选择与评估.html#cb1064-21" tabindex="-1"></a><span class="co"># 创建模型比较表</span></span>
<span id="cb1064-22"><a href="模型选择与评估.html#cb1064-22" tabindex="-1"></a>model_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1064-23"><a href="模型选择与评估.html#cb1064-23" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">names</span>(models),</span>
<span id="cb1064-24"><a href="模型选择与评估.html#cb1064-24" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">round</span>(aic_values, <span class="dv">2</span>),</span>
<span id="cb1064-25"><a href="模型选择与评估.html#cb1064-25" tabindex="-1"></a>  <span class="at">Delta_AIC =</span> <span class="fu">round</span>(delta_aic, <span class="dv">2</span>),</span>
<span id="cb1064-26"><a href="模型选择与评估.html#cb1064-26" tabindex="-1"></a>  <span class="at">AIC_Weight =</span> <span class="fu">round</span>(aic_weights, <span class="dv">3</span>),</span>
<span id="cb1064-27"><a href="模型选择与评估.html#cb1064-27" tabindex="-1"></a>  <span class="at">R2 =</span> <span class="fu">round</span>(<span class="fu">sapply</span>(models, <span class="cf">function</span>(m) <span class="fu">summary</span>(m)<span class="sc">$</span>r.squared), <span class="dv">3</span>)</span>
<span id="cb1064-28"><a href="模型选择与评估.html#cb1064-28" tabindex="-1"></a>)</span>
<span id="cb1064-29"><a href="模型选择与评估.html#cb1064-29" tabindex="-1"></a></span>
<span id="cb1064-30"><a href="模型选择与评估.html#cb1064-30" tabindex="-1"></a>model_comparison <span class="ot">&lt;-</span> model_comparison[<span class="fu">order</span>(model_comparison<span class="sc">$</span>AIC), ]</span></code></pre></div>
<p>MuMIn包提供了自动化的模型平均工具。dredge函数生成所有可能的模型组合，model.avg函数执行模型平均，sw函数计算变量重要性。这些工具大大简化了模型平均的实施过程。</p>
<div class="sourceCode" id="cb1065"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1065-1"><a href="模型选择与评估.html#cb1065-1" tabindex="-1"></a><span class="co"># 执行模型平均</span></span>
<span id="cb1065-2"><a href="模型选择与评估.html#cb1065-2" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb1065-3"><a href="模型选择与评估.html#cb1065-3" tabindex="-1"></a></span>
<span id="cb1065-4"><a href="模型选择与评估.html#cb1065-4" tabindex="-1"></a><span class="co"># 使用dredge函数自动生成所有可能的模型组合</span></span>
<span id="cb1065-5"><a href="模型选择与评估.html#cb1065-5" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(abundance <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> temp <span class="sc">+</span> oxygen <span class="sc">+</span> ph <span class="sc">+</span> turbidity,</span>
<span id="cb1065-6"><a href="模型选择与评估.html#cb1065-6" tabindex="-1"></a>  <span class="at">data =</span> fish_data, <span class="at">na.action =</span> <span class="st">&quot;na.fail&quot;</span></span>
<span id="cb1065-7"><a href="模型选择与评估.html#cb1065-7" tabindex="-1"></a>)</span>
<span id="cb1065-8"><a href="模型选择与评估.html#cb1065-8" tabindex="-1"></a></span>
<span id="cb1065-9"><a href="模型选择与评估.html#cb1065-9" tabindex="-1"></a><span class="co"># 生成所有子模型</span></span>
<span id="cb1065-10"><a href="模型选择与评估.html#cb1065-10" tabindex="-1"></a>all_models <span class="ot">&lt;-</span> <span class="fu">dredge</span>(full_model)</span>
<span id="cb1065-11"><a href="模型选择与评估.html#cb1065-11" tabindex="-1"></a></span>
<span id="cb1065-12"><a href="模型选择与评估.html#cb1065-12" tabindex="-1"></a><span class="co"># 执行模型平均</span></span>
<span id="cb1065-13"><a href="模型选择与评估.html#cb1065-13" tabindex="-1"></a>avg_model <span class="ot">&lt;-</span> <span class="fu">model.avg</span>(all_models, <span class="at">fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1065-14"><a href="模型选择与评估.html#cb1065-14" tabindex="-1"></a></span>
<span id="cb1065-15"><a href="模型选择与评估.html#cb1065-15" tabindex="-1"></a><span class="co"># 输出模型平均结果</span></span>
<span id="cb1065-16"><a href="模型选择与评估.html#cb1065-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 模型平均结果 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 模型平均结果 ===</code></pre>
<div class="sourceCode" id="cb1067"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1067-1"><a href="模型选择与评估.html#cb1067-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(avg_model))</span></code></pre></div>
<pre><code>## 
## Call:
## model.avg(object = get.models(object = all_models, subset = NA))
## 
## Component model call: 
## lm(formula = log(abundance + 1) ~ &lt;16 unique rhs&gt;, data = fish_data, 
##      na.action = na.fail)
## 
## Component models: 
##        df  logLik   AICc  delta weight
## 123     5   34.11 -57.70   0.00   0.73
## 1234    6   34.21 -55.67   2.03   0.27
## 12      4  -26.73  61.80 119.50   0.00
## 124     5  -26.68  63.88 121.58   0.00
## 23      4  -66.90 142.15 199.85   0.00
## 234     5  -66.87 144.26 201.96   0.00
## 2       3  -82.20 170.60 228.30   0.00
## 24      4  -82.19 172.73 230.43   0.00
## 13      4  -89.21 186.77 244.47   0.00
## 134     5  -89.15 188.82 246.52   0.00
## 1       3 -106.67 219.54 277.24   0.00
## 14      4 -106.67 221.68 279.38   0.00
## 3       3 -110.44 227.08 284.78   0.00
## 34      4 -110.38 229.11 286.81   0.00
## (Null)  2 -121.99 248.08 305.78   0.00
## 4       3 -121.99 250.19 307.89   0.00
## 
## Term codes: 
##    oxygen        ph      temp turbidity 
##         1         2         3         4 
## 
## Model-averaged coefficients:  
## (full average) 
##               Estimate Std. Error Adjusted SE z value Pr(&gt;|z|)    
## (Intercept)  1.6226421  0.2324172   0.2348710   6.909   &lt;2e-16 ***
## oxygen       0.1702822  0.0075580   0.0076378  22.295   &lt;2e-16 ***
## ph           0.8242705  0.0293587   0.0296689  27.782   &lt;2e-16 ***
## temp         0.0531857  0.0037299   0.0037693  14.110   &lt;2e-16 ***
## turbidity   -0.0001485  0.0007176   0.0007243   0.205    0.838    
##  
## (conditional average) 
##               Estimate Std. Error Adjusted SE z value Pr(&gt;|z|)    
## (Intercept)  1.6226421  0.2324172   0.2348710   6.909   &lt;2e-16 ***
## oxygen       0.1702822  0.0075580   0.0076378  22.295   &lt;2e-16 ***
## ph           0.8242705  0.0293587   0.0296689  27.782   &lt;2e-16 ***
## temp         0.0531857  0.0037299   0.0037693  14.110   &lt;2e-16 ***
## turbidity   -0.0005576  0.0013060   0.0013199   0.422    0.673    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb1069"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1069-1"><a href="模型选择与评估.html#cb1069-1" tabindex="-1"></a><span class="co"># 提取平均模型的系数</span></span>
<span id="cb1069-2"><a href="模型选择与评估.html#cb1069-2" tabindex="-1"></a>avg_coef <span class="ot">&lt;-</span> <span class="fu">summary</span>(avg_model)<span class="sc">$</span>coefmat.full</span>
<span id="cb1069-3"><a href="模型选择与评估.html#cb1069-3" tabindex="-1"></a></span>
<span id="cb1069-4"><a href="模型选择与评估.html#cb1069-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 平均模型系数 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 平均模型系数 ===</code></pre>
<div class="sourceCode" id="cb1071"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1071-1"><a href="模型选择与评估.html#cb1071-1" tabindex="-1"></a><span class="fu">print</span>(avg_coef)</span></code></pre></div>
<pre><code>##                  Estimate   Std. Error  Adjusted SE    z value  Pr(&gt;|z|)
## (Intercept)  1.6226421120 0.2324171588 0.2348710183  6.9086519 0.0000000
## oxygen       0.1702821857 0.0075579564 0.0076378199 22.2946060 0.0000000
## ph           0.8242705305 0.0293586568 0.0296688807 27.7823265 0.0000000
## temp         0.0531856637 0.0037298612 0.0037692682 14.1103420 0.0000000
## turbidity   -0.0001484903 0.0007175974 0.0007243327  0.2050028 0.8375699</code></pre>
<div class="sourceCode" id="cb1073"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1073-1"><a href="模型选择与评估.html#cb1073-1" tabindex="-1"></a><span class="co"># 计算变量重要性</span></span>
<span id="cb1073-2"><a href="模型选择与评估.html#cb1073-2" tabindex="-1"></a>var_importance <span class="ot">&lt;-</span> <span class="fu">sw</span>(all_models)</span>
<span id="cb1073-3"><a href="模型选择与评估.html#cb1073-3" tabindex="-1"></a></span>
<span id="cb1073-4"><a href="模型选择与评估.html#cb1073-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 变量重要性 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 变量重要性 ===</code></pre>
<div class="sourceCode" id="cb1075"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1075-1"><a href="模型选择与评估.html#cb1075-1" tabindex="-1"></a><span class="fu">print</span>(var_importance)</span></code></pre></div>
<pre><code>##                      oxygen ph   temp turbidity
## Sum of weights:      1.00   1.00 1.00 0.27     
## N containing models:    8      8    8    8</code></pre>
<p>可视化是理解模型平均结果的重要工具。变量重要性图显示各环境因子的相对重要性，模型权重分布图展示不同候选模型的相对支持度。</p>
<div class="sourceCode" id="cb1077"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1077-1"><a href="模型选择与评估.html#cb1077-1" tabindex="-1"></a><span class="co"># 可视化模型平均结果</span></span>
<span id="cb1077-2"><a href="模型选择与评估.html#cb1077-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1077-3"><a href="模型选择与评估.html#cb1077-3" tabindex="-1"></a></span>
<span id="cb1077-4"><a href="模型选择与评估.html#cb1077-4" tabindex="-1"></a><span class="co"># 变量重要性图</span></span>
<span id="cb1077-5"><a href="模型选择与评估.html#cb1077-5" tabindex="-1"></a><span class="fu">barplot</span>(var_importance[<span class="fu">order</span>(var_importance, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)],</span>
<span id="cb1077-6"><a href="模型选择与评估.html#cb1077-6" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;变量重要性&quot;</span>,</span>
<span id="cb1077-7"><a href="模型选择与评估.html#cb1077-7" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;环境因子&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;重要性&quot;</span>,</span>
<span id="cb1077-8"><a href="模型选择与评估.html#cb1077-8" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">las =</span> <span class="dv">2</span></span>
<span id="cb1077-9"><a href="模型选择与评估.html#cb1077-9" tabindex="-1"></a>)</span>
<span id="cb1077-10"><a href="模型选择与评估.html#cb1077-10" tabindex="-1"></a></span>
<span id="cb1077-11"><a href="模型选择与评估.html#cb1077-11" tabindex="-1"></a><span class="co"># 模型权重分布</span></span>
<span id="cb1077-12"><a href="模型选择与评估.html#cb1077-12" tabindex="-1"></a><span class="fu">barplot</span>(model_comparison<span class="sc">$</span>AIC_Weight,</span>
<span id="cb1077-13"><a href="模型选择与评估.html#cb1077-13" tabindex="-1"></a>  <span class="at">names.arg =</span> model_comparison<span class="sc">$</span>Model,</span>
<span id="cb1077-14"><a href="模型选择与评估.html#cb1077-14" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;模型权重分布&quot;</span>,</span>
<span id="cb1077-15"><a href="模型选择与评估.html#cb1077-15" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;模型&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">text{AIC}$权重&quot;</span>,</span>
<span id="cb1077-16"><a href="模型选择与评估.html#cb1077-16" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="at">las =</span> <span class="dv">2</span></span>
<span id="cb1077-17"><a href="模型选择与评估.html#cb1077-17" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-20"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-20-1.png" alt="模型平均结果：变量重要性和模型权重分布" width="672" />
<p class="caption">
图2.10: 模型平均结果：变量重要性和模型权重分布
</p>
</div>
<div class="sourceCode" id="cb1078"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1078-1"><a href="模型选择与评估.html#cb1078-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>模型平均预测通常比单一模型预测更稳健。通过比较单一模型与模型平均的预测结果，我们可以评估模型平均在减少预测不确定性方面的价值。</p>
<div class="sourceCode" id="cb1079"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1079-1"><a href="模型选择与评估.html#cb1079-1" tabindex="-1"></a><span class="co"># 比较单一模型与模型平均的预测</span></span>
<span id="cb1079-2"><a href="模型选择与评估.html#cb1079-2" tabindex="-1"></a><span class="co"># 生成测试数据</span></span>
<span id="cb1079-3"><a href="模型选择与评估.html#cb1079-3" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1079-4"><a href="模型选择与评估.html#cb1079-4" tabindex="-1"></a>  <span class="at">temp =</span> <span class="dv">18</span>,</span>
<span id="cb1079-5"><a href="模型选择与评估.html#cb1079-5" tabindex="-1"></a>  <span class="at">oxygen =</span> <span class="dv">6</span>,</span>
<span id="cb1079-6"><a href="模型选择与评估.html#cb1079-6" tabindex="-1"></a>  <span class="at">ph =</span> <span class="fl">7.5</span>,</span>
<span id="cb1079-7"><a href="模型选择与评估.html#cb1079-7" tabindex="-1"></a>  <span class="at">turbidity =</span> <span class="dv">20</span></span>
<span id="cb1079-8"><a href="模型选择与评估.html#cb1079-8" tabindex="-1"></a>)</span>
<span id="cb1079-9"><a href="模型选择与评估.html#cb1079-9" tabindex="-1"></a></span>
<span id="cb1079-10"><a href="模型选择与评估.html#cb1079-10" tabindex="-1"></a><span class="co"># 单一模型预测</span></span>
<span id="cb1079-11"><a href="模型选择与评估.html#cb1079-11" tabindex="-1"></a>single_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(models[[<span class="st">&quot;water_quality&quot;</span>]], <span class="at">newdata =</span> test_data)</span>
<span id="cb1079-12"><a href="模型选择与评估.html#cb1079-12" tabindex="-1"></a></span>
<span id="cb1079-13"><a href="模型选择与评估.html#cb1079-13" tabindex="-1"></a><span class="co"># 模型平均预测</span></span>
<span id="cb1079-14"><a href="模型选择与评估.html#cb1079-14" tabindex="-1"></a>avg_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(avg_model, <span class="at">newdata =</span> test_data)</span>
<span id="cb1079-15"><a href="模型选择与评估.html#cb1079-15" tabindex="-1"></a></span>
<span id="cb1079-16"><a href="模型选择与评估.html#cb1079-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;测试条件：水温18°C, 溶解氧6mg/L, pH7.5, 浊度20NTU</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 测试条件：水温18°C, 溶解氧6mg/L, pH7.5, 浊度20NTU</code></pre>
<div class="sourceCode" id="cb1081"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1081-1"><a href="模型选择与评估.html#cb1081-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;单一模型预测:&quot;</span>, <span class="fu">round</span>(<span class="fu">exp</span>(single_pred) <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">1</span>), <span class="st">&quot;条鱼</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 单一模型预测: 17668.2 条鱼</code></pre>
<div class="sourceCode" id="cb1083"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1083-1"><a href="模型选择与评估.html#cb1083-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模型平均预测:&quot;</span>, <span class="fu">round</span>(<span class="fu">exp</span>(avg_pred) <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">1</span>), <span class="st">&quot;条鱼</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 模型平均预测: 17688.7 条鱼</code></pre>
<p>Bootstrap方法能够量化预测的不确定性，包括参数估计误差、模型选择不确定性和生态系统的自然变异性。</p>
<div class="sourceCode" id="cb1085"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1085-1"><a href="模型选择与评估.html#cb1085-1" tabindex="-1"></a><span class="co"># 计算预测区间</span></span>
<span id="cb1085-2"><a href="模型选择与评估.html#cb1085-2" tabindex="-1"></a><span class="co"># 使用bootstrap计算预测区间</span></span>
<span id="cb1085-3"><a href="模型选择与评估.html#cb1085-3" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb1085-4"><a href="模型选择与评估.html#cb1085-4" tabindex="-1"></a></span>
<span id="cb1085-5"><a href="模型选择与评估.html#cb1085-5" tabindex="-1"></a><span class="co"># 定义预测函数</span></span>
<span id="cb1085-6"><a href="模型选择与评估.html#cb1085-6" tabindex="-1"></a>predict_function <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb1085-7"><a href="模型选择与评估.html#cb1085-7" tabindex="-1"></a>  boot_data <span class="ot">&lt;-</span> data[indices, ]</span>
<span id="cb1085-8"><a href="模型选择与评估.html#cb1085-8" tabindex="-1"></a></span>
<span id="cb1085-9"><a href="模型选择与评估.html#cb1085-9" tabindex="-1"></a>  <span class="co"># 拟合模型并预测</span></span>
<span id="cb1085-10"><a href="模型选择与评估.html#cb1085-10" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(abundance <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> temp <span class="sc">+</span> oxygen <span class="sc">+</span> ph, <span class="at">data =</span> boot_data)</span>
<span id="cb1085-11"><a href="模型选择与评估.html#cb1085-11" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> test_data)</span>
<span id="cb1085-12"><a href="模型选择与评估.html#cb1085-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(pred) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb1085-13"><a href="模型选择与评估.html#cb1085-13" tabindex="-1"></a>}</span>
<span id="cb1085-14"><a href="模型选择与评估.html#cb1085-14" tabindex="-1"></a></span>
<span id="cb1085-15"><a href="模型选择与评估.html#cb1085-15" tabindex="-1"></a><span class="co"># 执行bootstrap</span></span>
<span id="cb1085-16"><a href="模型选择与评估.html#cb1085-16" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb1085-17"><a href="模型选择与评估.html#cb1085-17" tabindex="-1"></a>boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(fish_data, predict_function, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb1085-18"><a href="模型选择与评估.html#cb1085-18" tabindex="-1"></a></span>
<span id="cb1085-19"><a href="模型选择与评估.html#cb1085-19" tabindex="-1"></a><span class="co"># 计算置信区间</span></span>
<span id="cb1085-20"><a href="模型选择与评估.html#cb1085-20" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot_results, <span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb1085-21"><a href="模型选择与评估.html#cb1085-21" tabindex="-1"></a></span>
<span id="cb1085-22"><a href="模型选择与评估.html#cb1085-22" tabindex="-1"></a><span class="fu">cat</span>(</span>
<span id="cb1085-23"><a href="模型选择与评估.html#cb1085-23" tabindex="-1"></a>  <span class="st">&quot;Bootstrap 95% 预测区间: [&quot;</span>,</span>
<span id="cb1085-24"><a href="模型选择与评估.html#cb1085-24" tabindex="-1"></a>  <span class="fu">round</span>(ci<span class="sc">$</span>percent[<span class="dv">4</span>], <span class="dv">1</span>), <span class="st">&quot;, &quot;</span>,</span>
<span id="cb1085-25"><a href="模型选择与评估.html#cb1085-25" tabindex="-1"></a>  <span class="fu">round</span>(ci<span class="sc">$</span>percent[<span class="dv">5</span>], <span class="dv">1</span>), <span class="st">&quot;] 条鱼</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb1085-26"><a href="模型选择与评估.html#cb1085-26" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Bootstrap 95% 预测区间: [ 17104.5 ,  18267.4 ] 条鱼</code></pre>
<p>Bootstrap预测区间反映了模型预测中的多种不确定性来源：参数估计的不确定性、模型选择的不确定性以及生态系统的自然变异性。这种全面的不确定性量化使得模型预测更加可靠，为生态决策提供了更科学的依据。</p>
<p>模型平均在生态学中具有重要的应用价值。它减少了模型选择的不确定性，提供了更稳健的参数估计，量化了不同生态学假说的相对支持程度，并通过变量重要性分析揭示了关键环境因子。</p>
</div>
</div>
<div id="模型评估" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> 模型评估<a href="模型选择与评估.html#模型评估" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>模型评估是生态统计建模中至关重要的环节，它回答了一个根本问题：我们选择的模型是否真的可靠？在生态学研究中，模型的可靠性体现在两个方面：统计可靠性和生态学可靠性。通过系统的模型评估，我们能够确保模型不仅统计上合理，更重要的是具有生态学意义和实际应用价值。</p>
<div id="交叉验证" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> 交叉验证<a href="模型选择与评估.html#交叉验证" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>交叉验证是现代生态统计中评估模型泛化能力的核心方法。它的基本思想是通过重复分割数据集来模拟模型在未知数据上的表现，从而评估模型的预测稳定性。在生态学研究中，交叉验证特别重要，因为生态数据通常具有时空依赖性，模型在不同时间或空间尺度上的表现可能存在显著差异。</p>
<p><strong>k折交叉验证</strong>是最常用的交叉验证方法。它将原始数据随机分割为k个大小相似的子集，然后进行k轮训练和测试。在每一轮中，使用k-1个子集作为训练数据来拟合模型，剩下的1个子集作为测试数据来评估模型性能。最后，将k轮测试结果的平均值作为模型泛化能力的估计。</p>
<p>k折交叉验证在生态学中具有重要的应用价值。例如，在研究鸟类分布与环境因子的关系时，我们可以使用k折交叉验证来评估物种分布模型的预测精度。如果模型在不同数据子集上的表现差异很大，说明模型可能过度适应了特定区域的生态特征，其泛化能力有限。</p>
<p><strong>留一交叉验证</strong>是k折交叉验证的特殊情况，其中k等于样本量。每次只留一个观测作为测试集，其余所有观测作为训练集。这种方法特别适合小样本生态学研究，但计算成本较高。</p>
<p>交叉验证的生态学意义在于它帮助我们理解模型在不同生态条件下的表现。例如，一个预测森林碳储量的模型可能在湿润地区表现良好，但在干旱地区表现较差。通过交叉验证，我们可以识别模型的适用范围和局限性，为生态管理决策提供更可靠的科学依据。</p>
<p>交叉验证是评估模型泛化能力的重要方法。在生态学研究中，由于数据收集成本高且生态系统具有时空变异性，交叉验证能够模拟模型在未知数据上的表现，帮助我们识别过度拟合问题。k折交叉验证将数据随机分割为k个子集，通过k轮训练和测试来评估模型的稳定性。</p>
<div class="sourceCode" id="cb1087"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1087-1"><a href="模型选择与评估.html#cb1087-1" tabindex="-1"></a><span class="co"># 交叉验证在生态学中的应用演示 - 数据生成</span></span>
<span id="cb1087-2"><a href="模型选择与评估.html#cb1087-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb1087-3"><a href="模型选择与评估.html#cb1087-3" tabindex="-1"></a></span>
<span id="cb1087-4"><a href="模型选择与评估.html#cb1087-4" tabindex="-1"></a><span class="co"># 生成生态学数据：湖泊鱼类丰富度与环境因子的关系</span></span>
<span id="cb1087-5"><a href="模型选择与评估.html#cb1087-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb1087-6"><a href="模型选择与评估.html#cb1087-6" tabindex="-1"></a></span>
<span id="cb1087-7"><a href="模型选择与评估.html#cb1087-7" tabindex="-1"></a><span class="co"># 环境因子</span></span>
<span id="cb1087-8"><a href="模型选择与评估.html#cb1087-8" tabindex="-1"></a>lake_area <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">100</span>) <span class="co"># 湖泊面积(公顷)</span></span>
<span id="cb1087-9"><a href="模型选择与评估.html#cb1087-9" tabindex="-1"></a>water_depth <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">20</span>) <span class="co"># 平均水深(米)</span></span>
<span id="cb1087-10"><a href="模型选择与评估.html#cb1087-10" tabindex="-1"></a>water_temp <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">10</span>, <span class="dv">25</span>) <span class="co"># 水温(°C)</span></span>
<span id="cb1087-11"><a href="模型选择与评估.html#cb1087-11" tabindex="-1"></a>ph_level <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="fl">6.0</span>, <span class="fl">8.5</span>) <span class="co"># pH值</span></span>
<span id="cb1087-12"><a href="模型选择与评估.html#cb1087-12" tabindex="-1"></a></span>
<span id="cb1087-13"><a href="模型选择与评估.html#cb1087-13" tabindex="-1"></a><span class="co"># 生成鱼类丰富度数据</span></span>
<span id="cb1087-14"><a href="模型选择与评估.html#cb1087-14" tabindex="-1"></a>fish_richness <span class="ot">&lt;-</span> <span class="fu">rpois</span>(</span>
<span id="cb1087-15"><a href="模型选择与评估.html#cb1087-15" tabindex="-1"></a>  n,</span>
<span id="cb1087-16"><a href="模型选择与评估.html#cb1087-16" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fl">1.2</span> <span class="sc">+</span> <span class="fl">0.015</span> <span class="sc">*</span> lake_area <span class="sc">+</span></span>
<span id="cb1087-17"><a href="模型选择与评估.html#cb1087-17" tabindex="-1"></a>    <span class="fl">0.08</span> <span class="sc">*</span> water_depth <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> water_temp <span class="sc">+</span></span>
<span id="cb1087-18"><a href="模型选择与评估.html#cb1087-18" tabindex="-1"></a>    <span class="fl">0.3</span> <span class="sc">*</span> ph_level <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.2</span>))</span>
<span id="cb1087-19"><a href="模型选择与评估.html#cb1087-19" tabindex="-1"></a>)</span>
<span id="cb1087-20"><a href="模型选择与评估.html#cb1087-20" tabindex="-1"></a></span>
<span id="cb1087-21"><a href="模型选择与评估.html#cb1087-21" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb1087-22"><a href="模型选择与评估.html#cb1087-22" tabindex="-1"></a>lake_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1087-23"><a href="模型选择与评估.html#cb1087-23" tabindex="-1"></a>  <span class="at">richness =</span> fish_richness,</span>
<span id="cb1087-24"><a href="模型选择与评估.html#cb1087-24" tabindex="-1"></a>  <span class="at">area =</span> lake_area,</span>
<span id="cb1087-25"><a href="模型选择与评估.html#cb1087-25" tabindex="-1"></a>  <span class="at">depth =</span> water_depth,</span>
<span id="cb1087-26"><a href="模型选择与评估.html#cb1087-26" tabindex="-1"></a>  <span class="at">temp =</span> water_temp,</span>
<span id="cb1087-27"><a href="模型选择与评估.html#cb1087-27" tabindex="-1"></a>  <span class="at">ph =</span> ph_level</span>
<span id="cb1087-28"><a href="模型选择与评估.html#cb1087-28" tabindex="-1"></a>)</span></code></pre></div>
<p>caret包提供了统一的接口来执行各种机器学习算法和交叉验证。通过trainControl函数设置交叉验证参数，我们可以控制验证过程的细节，如折数、重复次数等。</p>
<div class="sourceCode" id="cb1088"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1088-1"><a href="模型选择与评估.html#cb1088-1" tabindex="-1"></a><span class="co"># 执行k折交叉验证</span></span>
<span id="cb1088-2"><a href="模型选择与评估.html#cb1088-2" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb1088-3"><a href="模型选择与评估.html#cb1088-3" tabindex="-1"></a></span>
<span id="cb1088-4"><a href="模型选择与评估.html#cb1088-4" tabindex="-1"></a><span class="co"># 设置交叉验证参数</span></span>
<span id="cb1088-5"><a href="模型选择与评估.html#cb1088-5" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb1088-6"><a href="模型选择与评估.html#cb1088-6" tabindex="-1"></a></span>
<span id="cb1088-7"><a href="模型选择与评估.html#cb1088-7" tabindex="-1"></a><span class="co"># 训练线性回归模型</span></span>
<span id="cb1088-8"><a href="模型选择与评估.html#cb1088-8" tabindex="-1"></a>cv_model <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="fu">log</span>(richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> area <span class="sc">+</span> depth <span class="sc">+</span> temp <span class="sc">+</span> ph,</span>
<span id="cb1088-9"><a href="模型选择与评估.html#cb1088-9" tabindex="-1"></a>  <span class="at">data =</span> lake_data,</span>
<span id="cb1088-10"><a href="模型选择与评估.html#cb1088-10" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb1088-11"><a href="模型选择与评估.html#cb1088-11" tabindex="-1"></a>  <span class="at">trControl =</span> ctrl</span>
<span id="cb1088-12"><a href="模型选择与评估.html#cb1088-12" tabindex="-1"></a>)</span>
<span id="cb1088-13"><a href="模型选择与评估.html#cb1088-13" tabindex="-1"></a></span>
<span id="cb1088-14"><a href="模型选择与评估.html#cb1088-14" tabindex="-1"></a><span class="co"># 输出交叉验证结果</span></span>
<span id="cb1088-15"><a href="模型选择与评估.html#cb1088-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 10折交叉验证结果 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 10折交叉验证结果 ===</code></pre>
<div class="sourceCode" id="cb1090"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1090-1"><a href="模型选择与评估.html#cb1090-1" tabindex="-1"></a><span class="fu">print</span>(cv_model)</span></code></pre></div>
<pre><code>## Linear Regression 
## 
## 150 samples
##   4 predictor
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold) 
## Summary of sample sizes: 135, 136, 135, 134, 137, 134, ... 
## Resampling results:
## 
##   RMSE       Rsquared   MAE     
##   0.2139466  0.9101237  0.172627
## 
## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE</code></pre>
<div class="sourceCode" id="cb1092"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1092-1"><a href="模型选择与评估.html#cb1092-1" tabindex="-1"></a><span class="co"># 提取交叉验证统计量</span></span>
<span id="cb1092-2"><a href="模型选择与评估.html#cb1092-2" tabindex="-1"></a>cv_results <span class="ot">&lt;-</span> cv_model<span class="sc">$</span>results</span>
<span id="cb1092-3"><a href="模型选择与评估.html#cb1092-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">交叉验证性能指标：</span><span class="sc">\n</span><span class="st">平均$R^2$:&quot;</span>,</span>
<span id="cb1092-4"><a href="模型选择与评估.html#cb1092-4" tabindex="-1"></a>    <span class="fu">round</span>(cv_results<span class="sc">$</span>Rsquared, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">平均RMSE:&quot;</span>,</span>
<span id="cb1092-5"><a href="模型选择与评估.html#cb1092-5" tabindex="-1"></a>    <span class="fu">round</span>(cv_results<span class="sc">$</span>RMSE, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">平均MAE:&quot;</span>,</span>
<span id="cb1092-6"><a href="模型选择与评估.html#cb1092-6" tabindex="-1"></a>    <span class="fu">round</span>(cv_results<span class="sc">$</span>MAE, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 交叉验证性能指标：
## 平均$R^2$: 0.91 
## 平均RMSE: 0.214 
## 平均MAE: 0.173</code></pre>
<p>交叉验证性能的可视化能够直观展示模型在不同数据子集上的稳定性。如果RMSE在不同折之间波动很大，说明模型可能过度拟合训练数据的特定特征。</p>
<div class="sourceCode" id="cb1094"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1094-1"><a href="模型选择与评估.html#cb1094-1" tabindex="-1"></a><span class="co"># 可视化交叉验证结果</span></span>
<span id="cb1094-2"><a href="模型选择与评估.html#cb1094-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1094-3"><a href="模型选择与评估.html#cb1094-3" tabindex="-1"></a></span>
<span id="cb1094-4"><a href="模型选择与评估.html#cb1094-4" tabindex="-1"></a><span class="co"># 创建交叉验证性能图</span></span>
<span id="cb1094-5"><a href="模型选择与评估.html#cb1094-5" tabindex="-1"></a>cv_performance <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1094-6"><a href="模型选择与评估.html#cb1094-6" tabindex="-1"></a>  <span class="at">Fold =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb1094-7"><a href="模型选择与评估.html#cb1094-7" tabindex="-1"></a>  <span class="at">RMSE =</span> cv_model<span class="sc">$</span>resample<span class="sc">$</span>RMSE,</span>
<span id="cb1094-8"><a href="模型选择与评估.html#cb1094-8" tabindex="-1"></a>  <span class="at">Rsquared =</span> cv_model<span class="sc">$</span>resample<span class="sc">$</span>Rsquared</span>
<span id="cb1094-9"><a href="模型选择与评估.html#cb1094-9" tabindex="-1"></a>)</span>
<span id="cb1094-10"><a href="模型选择与评估.html#cb1094-10" tabindex="-1"></a></span>
<span id="cb1094-11"><a href="模型选择与评估.html#cb1094-11" tabindex="-1"></a><span class="fu">ggplot</span>(cv_performance, <span class="fu">aes</span>(<span class="at">x =</span> Fold, <span class="at">y =</span> RMSE)) <span class="sc">+</span></span>
<span id="cb1094-12"><a href="模型选择与评估.html#cb1094-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1094-13"><a href="模型选择与评估.html#cb1094-13" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb1094-14"><a href="模型选择与评估.html#cb1094-14" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1094-15"><a href="模型选择与评估.html#cb1094-15" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;10折交叉验证：RMSE变化&quot;</span>,</span>
<span id="cb1094-16"><a href="模型选择与评估.html#cb1094-16" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;折数&quot;</span>, <span class="at">y =</span> <span class="st">&quot;RMSE&quot;</span></span>
<span id="cb1094-17"><a href="模型选择与评估.html#cb1094-17" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1094-18"><a href="模型选择与评估.html#cb1094-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1094-19"><a href="模型选择与评估.html#cb1094-19" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb1094-20"><a href="模型选择与评估.html#cb1094-20" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="fu">mean</span>(cv_performance<span class="sc">$</span>RMSE),</span>
<span id="cb1094-21"><a href="模型选择与评估.html#cb1094-21" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb1094-22"><a href="模型选择与评估.html#cb1094-22" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-25"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-25-1.png" alt="10折交叉验证：RMSE在不同数据子集上的变化" width="672" />
<p class="caption">
图2.15: 10折交叉验证：RMSE在不同数据子集上的变化
</p>
</div>
<p>训练集和测试集性能的比较是检测过度拟合的直接方法。如果测试集性能明显差于训练集，说明模型可能过度适应训练数据的噪声。</p>
<div class="sourceCode" id="cb1095"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1095-1"><a href="模型选择与评估.html#cb1095-1" tabindex="-1"></a><span class="co"># 比较训练集和测试集性能</span></span>
<span id="cb1095-2"><a href="模型选择与评估.html#cb1095-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb1095-3"><a href="模型选择与评估.html#cb1095-3" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(lake_data<span class="sc">$</span>richness, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1095-4"><a href="模型选择与评估.html#cb1095-4" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> lake_data[train_index, ]</span>
<span id="cb1095-5"><a href="模型选择与评估.html#cb1095-5" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> lake_data[<span class="sc">-</span>train_index, ]</span>
<span id="cb1095-6"><a href="模型选择与评估.html#cb1095-6" tabindex="-1"></a></span>
<span id="cb1095-7"><a href="模型选择与评估.html#cb1095-7" tabindex="-1"></a><span class="co"># 在训练集上拟合模型</span></span>
<span id="cb1095-8"><a href="模型选择与评估.html#cb1095-8" tabindex="-1"></a>train_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> area <span class="sc">+</span> depth <span class="sc">+</span> temp <span class="sc">+</span> ph, <span class="at">data =</span> train_data)</span>
<span id="cb1095-9"><a href="模型选择与评估.html#cb1095-9" tabindex="-1"></a></span>
<span id="cb1095-10"><a href="模型选择与评估.html#cb1095-10" tabindex="-1"></a><span class="co"># 在训练集和测试集上评估模型</span></span>
<span id="cb1095-11"><a href="模型选择与评估.html#cb1095-11" tabindex="-1"></a>train_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(train_model)</span>
<span id="cb1095-12"><a href="模型选择与评估.html#cb1095-12" tabindex="-1"></a>test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(train_model, <span class="at">newdata =</span> test_data)</span>
<span id="cb1095-13"><a href="模型选择与评估.html#cb1095-13" tabindex="-1"></a></span>
<span id="cb1095-14"><a href="模型选择与评估.html#cb1095-14" tabindex="-1"></a>train_rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((<span class="fu">log</span>(train_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> train_pred)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb1095-15"><a href="模型选择与评估.html#cb1095-15" tabindex="-1"></a>test_rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((<span class="fu">log</span>(test_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> test_pred)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb1095-16"><a href="模型选择与评估.html#cb1095-16" tabindex="-1"></a></span>
<span id="cb1095-17"><a href="模型选择与评估.html#cb1095-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 训练集 vs 测试集性能 ===</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1095-18"><a href="模型选择与评估.html#cb1095-18" tabindex="-1"></a>  <span class="st">&quot;训练集RMSE:&quot;</span>, <span class="fu">round</span>(train_rmse, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1095-19"><a href="模型选择与评估.html#cb1095-19" tabindex="-1"></a>  <span class="st">&quot;测试集RMSE:&quot;</span>, <span class="fu">round</span>(test_rmse, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 训练集 vs 测试集性能 ===
##  训练集RMSE: 0.189 
##  测试集RMSE: 0.262</code></pre>
<div class="sourceCode" id="cb1097"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1097-1"><a href="模型选择与评估.html#cb1097-1" tabindex="-1"></a><span class="cf">if</span> (test_rmse <span class="sc">&gt;</span> train_rmse <span class="sc">*</span> <span class="fl">1.2</span>) {</span>
<span id="cb1097-2"><a href="模型选择与评估.html#cb1097-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;警告：测试集性能明显差于训练集，可能存在过度拟合</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1097-3"><a href="模型选择与评估.html#cb1097-3" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1097-4"><a href="模型选择与评估.html#cb1097-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;模型在训练集和测试集上表现一致，泛化能力良好</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1097-5"><a href="模型选择与评估.html#cb1097-5" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 警告：测试集性能明显差于训练集，可能存在过度拟合</code></pre>
<p>交叉验证在生态学中的价值在于它能够评估模型在不同时空条件下的表现。稳定的交叉验证结果增强了模型在实际生态应用中的可靠性，为生态保护决策提供了更可信的科学依据。</p>
</div>
<div id="外部验证" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> 外部验证<a href="模型选择与评估.html#外部验证" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>外部验证是评估模型可靠性的黄金标准，它使用完全独立的数据集来检验模型的预测能力。在生态学研究中，外部验证具有特殊的重要性，因为生态系统的复杂性和时空变异性使得基于单一数据集构建的模型往往难以推广到其他情境。</p>
<p>外部验证的基本原理是将模型应用于与训练数据完全独立的观测数据，评估模型在这些新数据上的表现。这种验证方式能够真实反映模型在实际应用中的可靠性，特别是在生态保护规划、物种分布预测和生态系统管理等领域。</p>
<p>在生态学中，外部验证可以通过多种方式实现。时间验证使用不同时间收集的数据来验证模型，例如用过去十年的鸟类调查数据构建模型，然后用最近一年的数据验证模型预测。空间验证使用不同地理区域的数据，例如用某个流域的数据构建水质模型，然后用相邻流域的数据验证模型。情境验证则使用不同生态条件的数据，例如用自然保护区数据构建的模型应用于受干扰区域。</p>
<p>外部验证的生态学意义在于它检验了模型的生态学普适性。一个真正有价值的生态模型应该能够适应不同的时空尺度和生态条件。例如，一个基于温带森林数据构建的碳储量预测模型，如果能够准确预测热带森林的碳储量，就说明该模型具有很好的生态学普适性。</p>
<p>外部验证还帮助我们识别模型的边界条件。在生态学中，很少有模型能够适用于所有情境。通过外部验证，我们可以明确模型的适用范围，避免在不适当的条件下应用模型导致错误的生态学结论。</p>
<div class="sourceCode" id="cb1099"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1099-1"><a href="模型选择与评估.html#cb1099-1" tabindex="-1"></a><span class="co"># 外部验证在生态学中的应用演示</span></span>
<span id="cb1099-2"><a href="模型选择与评估.html#cb1099-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3030</span>)</span>
<span id="cb1099-3"><a href="模型选择与评估.html#cb1099-3" tabindex="-1"></a></span>
<span id="cb1099-4"><a href="模型选择与评估.html#cb1099-4" tabindex="-1"></a><span class="co"># 生成训练数据集（模拟某个地区的植物调查）</span></span>
<span id="cb1099-5"><a href="模型选择与评估.html#cb1099-5" tabindex="-1"></a>n_train <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1099-6"><a href="模型选择与评估.html#cb1099-6" tabindex="-1"></a></span>
<span id="cb1099-7"><a href="模型选择与评估.html#cb1099-7" tabindex="-1"></a>elevation_train <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_train, <span class="dv">100</span>, <span class="dv">2000</span>) <span class="co"># 海拔(m)</span></span>
<span id="cb1099-8"><a href="模型选择与评估.html#cb1099-8" tabindex="-1"></a>precipitation_train <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_train, <span class="dv">500</span>, <span class="dv">2000</span>) <span class="co"># 年降水量(mm)</span></span>
<span id="cb1099-9"><a href="模型选择与评估.html#cb1099-9" tabindex="-1"></a>soil_n_train <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_train, <span class="fl">0.1</span>, <span class="fl">0.5</span>) <span class="co"># 土壤氮含量(%)</span></span>
<span id="cb1099-10"><a href="模型选择与评估.html#cb1099-10" tabindex="-1"></a></span>
<span id="cb1099-11"><a href="模型选择与评估.html#cb1099-11" tabindex="-1"></a><span class="co"># 生成植物物种丰富度（训练集）</span></span>
<span id="cb1099-12"><a href="模型选择与评估.html#cb1099-12" tabindex="-1"></a>plant_richness_train <span class="ot">&lt;-</span> <span class="fu">rpois</span>(</span>
<span id="cb1099-13"><a href="模型选择与评估.html#cb1099-13" tabindex="-1"></a>  n_train,</span>
<span id="cb1099-14"><a href="模型选择与评估.html#cb1099-14" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fl">2.0</span> <span class="sc">+</span> <span class="fl">0.001</span> <span class="sc">*</span> elevation_train <span class="sc">+</span></span>
<span id="cb1099-15"><a href="模型选择与评估.html#cb1099-15" tabindex="-1"></a>    <span class="fl">0.0008</span> <span class="sc">*</span> precipitation_train <span class="sc">+</span></span>
<span id="cb1099-16"><a href="模型选择与评估.html#cb1099-16" tabindex="-1"></a>    <span class="fl">2.5</span> <span class="sc">*</span> soil_n_train <span class="sc">+</span> <span class="fu">rnorm</span>(n_train, <span class="dv">0</span>, <span class="fl">0.3</span>))</span>
<span id="cb1099-17"><a href="模型选择与评估.html#cb1099-17" tabindex="-1"></a>)</span>
<span id="cb1099-18"><a href="模型选择与评估.html#cb1099-18" tabindex="-1"></a></span>
<span id="cb1099-19"><a href="模型选择与评估.html#cb1099-19" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1099-20"><a href="模型选择与评估.html#cb1099-20" tabindex="-1"></a>  <span class="at">richness =</span> plant_richness_train,</span>
<span id="cb1099-21"><a href="模型选择与评估.html#cb1099-21" tabindex="-1"></a>  <span class="at">elevation =</span> elevation_train,</span>
<span id="cb1099-22"><a href="模型选择与评估.html#cb1099-22" tabindex="-1"></a>  <span class="at">precipitation =</span> precipitation_train,</span>
<span id="cb1099-23"><a href="模型选择与评估.html#cb1099-23" tabindex="-1"></a>  <span class="at">soil_n =</span> soil_n_train</span>
<span id="cb1099-24"><a href="模型选择与评估.html#cb1099-24" tabindex="-1"></a>)</span>
<span id="cb1099-25"><a href="模型选择与评估.html#cb1099-25" tabindex="-1"></a></span>
<span id="cb1099-26"><a href="模型选择与评估.html#cb1099-26" tabindex="-1"></a><span class="co"># 生成测试数据集（模拟另一个地区的植物调查）</span></span>
<span id="cb1099-27"><a href="模型选择与评估.html#cb1099-27" tabindex="-1"></a>n_test <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb1099-28"><a href="模型选择与评估.html#cb1099-28" tabindex="-1"></a></span>
<span id="cb1099-29"><a href="模型选择与评估.html#cb1099-29" tabindex="-1"></a>elevation_test <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_test, <span class="dv">800</span>, <span class="dv">2500</span>) <span class="co"># 海拔范围略有不同</span></span>
<span id="cb1099-30"><a href="模型选择与评估.html#cb1099-30" tabindex="-1"></a>precipitation_test <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_test, <span class="dv">600</span>, <span class="dv">1800</span>) <span class="co"># 降水量范围不同</span></span>
<span id="cb1099-31"><a href="模型选择与评估.html#cb1099-31" tabindex="-1"></a>soil_n_test <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_test, <span class="fl">0.05</span>, <span class="fl">0.4</span>) <span class="co"># 土壤氮含量范围不同</span></span>
<span id="cb1099-32"><a href="模型选择与评估.html#cb1099-32" tabindex="-1"></a></span>
<span id="cb1099-33"><a href="模型选择与评估.html#cb1099-33" tabindex="-1"></a><span class="co"># 生成植物物种丰富度（测试集）</span></span>
<span id="cb1099-34"><a href="模型选择与评估.html#cb1099-34" tabindex="-1"></a>plant_richness_test <span class="ot">&lt;-</span> <span class="fu">rpois</span>(</span>
<span id="cb1099-35"><a href="模型选择与评估.html#cb1099-35" tabindex="-1"></a>  n_test,</span>
<span id="cb1099-36"><a href="模型选择与评估.html#cb1099-36" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fl">1.8</span> <span class="sc">+</span> <span class="fl">0.0012</span> <span class="sc">*</span> elevation_test <span class="sc">+</span></span>
<span id="cb1099-37"><a href="模型选择与评估.html#cb1099-37" tabindex="-1"></a>    <span class="fl">0.0009</span> <span class="sc">*</span> precipitation_test <span class="sc">+</span></span>
<span id="cb1099-38"><a href="模型选择与评估.html#cb1099-38" tabindex="-1"></a>    <span class="fl">2.8</span> <span class="sc">*</span> soil_n_test <span class="sc">+</span> <span class="fu">rnorm</span>(n_test, <span class="dv">0</span>, <span class="fl">0.4</span>))</span>
<span id="cb1099-39"><a href="模型选择与评估.html#cb1099-39" tabindex="-1"></a>)</span>
<span id="cb1099-40"><a href="模型选择与评估.html#cb1099-40" tabindex="-1"></a></span>
<span id="cb1099-41"><a href="模型选择与评估.html#cb1099-41" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1099-42"><a href="模型选择与评估.html#cb1099-42" tabindex="-1"></a>  <span class="at">richness =</span> plant_richness_test,</span>
<span id="cb1099-43"><a href="模型选择与评估.html#cb1099-43" tabindex="-1"></a>  <span class="at">elevation =</span> elevation_test,</span>
<span id="cb1099-44"><a href="模型选择与评估.html#cb1099-44" tabindex="-1"></a>  <span class="at">precipitation =</span> precipitation_test,</span>
<span id="cb1099-45"><a href="模型选择与评估.html#cb1099-45" tabindex="-1"></a>  <span class="at">soil_n =</span> soil_n_test</span>
<span id="cb1099-46"><a href="模型选择与评估.html#cb1099-46" tabindex="-1"></a>)</span>
<span id="cb1099-47"><a href="模型选择与评估.html#cb1099-47" tabindex="-1"></a></span>
<span id="cb1099-48"><a href="模型选择与评估.html#cb1099-48" tabindex="-1"></a><span class="co"># 在训练集上构建模型</span></span>
<span id="cb1099-49"><a href="模型选择与评估.html#cb1099-49" tabindex="-1"></a>model_external <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> elevation <span class="sc">+</span> precipitation <span class="sc">+</span> soil_n,</span>
<span id="cb1099-50"><a href="模型选择与评估.html#cb1099-50" tabindex="-1"></a>  <span class="at">data =</span> train_data</span>
<span id="cb1099-51"><a href="模型选择与评估.html#cb1099-51" tabindex="-1"></a>)</span>
<span id="cb1099-52"><a href="模型选择与评估.html#cb1099-52" tabindex="-1"></a></span>
<span id="cb1099-53"><a href="模型选择与评估.html#cb1099-53" tabindex="-1"></a><span class="co"># 在训练集上评估模型</span></span>
<span id="cb1099-54"><a href="模型选择与评估.html#cb1099-54" tabindex="-1"></a>train_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_external)</span>
<span id="cb1099-55"><a href="模型选择与评估.html#cb1099-55" tabindex="-1"></a>train_r2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">log</span>(train_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>), train_pred)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1099-56"><a href="模型选择与评估.html#cb1099-56" tabindex="-1"></a>train_rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((<span class="fu">log</span>(train_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> train_pred)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb1099-57"><a href="模型选择与评估.html#cb1099-57" tabindex="-1"></a></span>
<span id="cb1099-58"><a href="模型选择与评估.html#cb1099-58" tabindex="-1"></a><span class="co"># 在测试集上评估模型（外部验证）</span></span>
<span id="cb1099-59"><a href="模型选择与评估.html#cb1099-59" tabindex="-1"></a>test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_external, <span class="at">newdata =</span> test_data)</span>
<span id="cb1099-60"><a href="模型选择与评估.html#cb1099-60" tabindex="-1"></a>test_r2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">log</span>(test_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>), test_pred)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1099-61"><a href="模型选择与评估.html#cb1099-61" tabindex="-1"></a>test_rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((<span class="fu">log</span>(test_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> test_pred)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb1099-62"><a href="模型选择与评估.html#cb1099-62" tabindex="-1"></a></span>
<span id="cb1099-63"><a href="模型选择与评估.html#cb1099-63" tabindex="-1"></a><span class="co"># 输出外部验证结果</span></span>
<span id="cb1099-64"><a href="模型选择与评估.html#cb1099-64" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 外部验证结果 ===</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1099-65"><a href="模型选择与评估.html#cb1099-65" tabindex="-1"></a>  <span class="st">&quot;训练集性能：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1099-66"><a href="模型选择与评估.html#cb1099-66" tabindex="-1"></a>  <span class="st">&quot;- $R^2$:&quot;</span>, <span class="fu">round</span>(train_r2, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1099-67"><a href="模型选择与评估.html#cb1099-67" tabindex="-1"></a>  <span class="st">&quot;- RMSE:&quot;</span>, <span class="fu">round</span>(train_rmse, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 外部验证结果 ===
##  训练集性能：
##  - $R^2$: 0.862 
##  - RMSE: 0.31</code></pre>
<div class="sourceCode" id="cb1101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1101-1"><a href="模型选择与评估.html#cb1101-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;测试集性能（外部验证）：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1101-2"><a href="模型选择与评估.html#cb1101-2" tabindex="-1"></a>  <span class="st">&quot;- $R^2$:&quot;</span>, <span class="fu">round</span>(test_r2, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1101-3"><a href="模型选择与评估.html#cb1101-3" tabindex="-1"></a>  <span class="st">&quot;- RMSE:&quot;</span>, <span class="fu">round</span>(test_rmse, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 测试集性能（外部验证）：
##  - $R^2$: 0.772 
##  - RMSE: 0.576</code></pre>
<div class="sourceCode" id="cb1103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1103-1"><a href="模型选择与评估.html#cb1103-1" tabindex="-1"></a><span class="co"># 计算性能下降程度</span></span>
<span id="cb1103-2"><a href="模型选择与评估.html#cb1103-2" tabindex="-1"></a>r2_decline <span class="ot">&lt;-</span> (train_r2 <span class="sc">-</span> test_r2) <span class="sc">/</span> train_r2 <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1103-3"><a href="模型选择与评估.html#cb1103-3" tabindex="-1"></a>rmse_increase <span class="ot">&lt;-</span> (test_rmse <span class="sc">-</span> train_rmse) <span class="sc">/</span> train_rmse <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1103-4"><a href="模型选择与评估.html#cb1103-4" tabindex="-1"></a></span>
<span id="cb1103-5"><a href="模型选择与评估.html#cb1103-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;性能变化分析：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1103-6"><a href="模型选择与评估.html#cb1103-6" tabindex="-1"></a>  <span class="st">&quot;$R^2$下降:&quot;</span>, <span class="fu">round</span>(r2_decline, <span class="dv">1</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1103-7"><a href="模型选择与评估.html#cb1103-7" tabindex="-1"></a>  <span class="st">&quot;RMSE增加:&quot;</span>, <span class="fu">round</span>(rmse_increase, <span class="dv">1</span>), <span class="st">&quot;%</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 性能变化分析：
##  $R^2$下降: 10.4 %
##  RMSE增加: 85.5 %</code></pre>
<div class="sourceCode" id="cb1105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1105-1"><a href="模型选择与评估.html#cb1105-1" tabindex="-1"></a><span class="co"># 评估外部验证结果</span></span>
<span id="cb1105-2"><a href="模型选择与评估.html#cb1105-2" tabindex="-1"></a><span class="cf">if</span> (test_r2 <span class="sc">&gt;</span> <span class="fl">0.6</span>) {</span>
<span id="cb1105-3"><a href="模型选择与评估.html#cb1105-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;外部验证结果优秀：模型在新地区表现良好</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1105-4"><a href="模型选择与评估.html#cb1105-4" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (test_r2 <span class="sc">&gt;</span> <span class="fl">0.4</span>) {</span>
<span id="cb1105-5"><a href="模型选择与评估.html#cb1105-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;外部验证结果可接受：模型在新地区表现尚可</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1105-6"><a href="模型选择与评估.html#cb1105-6" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1105-7"><a href="模型选择与评估.html#cb1105-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;外部验证结果较差：模型在新地区表现不佳</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1105-8"><a href="模型选择与评估.html#cb1105-8" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 外部验证结果优秀：模型在新地区表现良好</code></pre>
<div class="sourceCode" id="cb1107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1107-1"><a href="模型选择与评估.html#cb1107-1" tabindex="-1"></a><span class="co"># 可视化外部验证结果</span></span>
<span id="cb1107-2"><a href="模型选择与评估.html#cb1107-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1107-3"><a href="模型选择与评估.html#cb1107-3" tabindex="-1"></a></span>
<span id="cb1107-4"><a href="模型选择与评估.html#cb1107-4" tabindex="-1"></a><span class="co"># 创建预测 vs 观测图</span></span>
<span id="cb1107-5"><a href="模型选择与评估.html#cb1107-5" tabindex="-1"></a>validation_plot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb1107-6"><a href="模型选择与评估.html#cb1107-6" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb1107-7"><a href="模型选择与评估.html#cb1107-7" tabindex="-1"></a>    <span class="at">Type =</span> <span class="st">&quot;训练集&quot;</span>,</span>
<span id="cb1107-8"><a href="模型选择与评估.html#cb1107-8" tabindex="-1"></a>    <span class="at">Observed =</span> <span class="fu">log</span>(train_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb1107-9"><a href="模型选择与评估.html#cb1107-9" tabindex="-1"></a>    <span class="at">Predicted =</span> train_pred</span>
<span id="cb1107-10"><a href="模型选择与评估.html#cb1107-10" tabindex="-1"></a>  ),</span>
<span id="cb1107-11"><a href="模型选择与评估.html#cb1107-11" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb1107-12"><a href="模型选择与评估.html#cb1107-12" tabindex="-1"></a>    <span class="at">Type =</span> <span class="st">&quot;测试集&quot;</span>,</span>
<span id="cb1107-13"><a href="模型选择与评估.html#cb1107-13" tabindex="-1"></a>    <span class="at">Observed =</span> <span class="fu">log</span>(test_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb1107-14"><a href="模型选择与评估.html#cb1107-14" tabindex="-1"></a>    <span class="at">Predicted =</span> test_pred</span>
<span id="cb1107-15"><a href="模型选择与评估.html#cb1107-15" tabindex="-1"></a>  )</span>
<span id="cb1107-16"><a href="模型选择与评估.html#cb1107-16" tabindex="-1"></a>)</span>
<span id="cb1107-17"><a href="模型选择与评估.html#cb1107-17" tabindex="-1"></a></span>
<span id="cb1107-18"><a href="模型选择与评估.html#cb1107-18" tabindex="-1"></a><span class="fu">ggplot</span>(validation_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Observed, <span class="at">y =</span> Predicted, <span class="at">color =</span> Type)) <span class="sc">+</span></span>
<span id="cb1107-19"><a href="模型选择与评估.html#cb1107-19" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb1107-20"><a href="模型选择与评估.html#cb1107-20" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb1107-21"><a href="模型选择与评估.html#cb1107-21" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1107-22"><a href="模型选择与评估.html#cb1107-22" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;外部验证：预测 vs 观测&quot;</span>,</span>
<span id="cb1107-23"><a href="模型选择与评估.html#cb1107-23" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;观测值（对数丰富度）&quot;</span>,</span>
<span id="cb1107-24"><a href="模型选择与评估.html#cb1107-24" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;预测值（对数丰富度）&quot;</span></span>
<span id="cb1107-25"><a href="模型选择与评估.html#cb1107-25" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1107-26"><a href="模型选择与评估.html#cb1107-26" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1107-27"><a href="模型选择与评估.html#cb1107-27" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;训练集&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;测试集&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1107-28"><a href="模型选择与评估.html#cb1107-28" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Type)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-27"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-27-1.png" alt="外部验证：训练集和测试集上植物物种丰富度模型的预测性能比较" width="672" />
<p class="caption">
图2.17: 外部验证：训练集和测试集上植物物种丰富度模型的预测性能比较
</p>
</div>
<p>在这个植物物种丰富度的例子中，训练集基于某个地区的调查数据构建模型，测试集代表另一个生态条件略有不同的地区。外部验证检验了模型的空间普适性，如果模型在测试集上表现良好，说明其生态学适用性较广；如果性能显著下降，可能需要考虑地区特异性因素。</p>
<div class="sourceCode" id="cb1108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1108-1"><a href="模型选择与评估.html#cb1108-1" tabindex="-1"></a><span class="co"># 计算预测偏差</span></span>
<span id="cb1108-2"><a href="模型选择与评估.html#cb1108-2" tabindex="-1"></a>bias_train <span class="ot">&lt;-</span> <span class="fu">mean</span>(train_pred <span class="sc">-</span> <span class="fu">log</span>(train_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb1108-3"><a href="模型选择与评估.html#cb1108-3" tabindex="-1"></a>bias_test <span class="ot">&lt;-</span> <span class="fu">mean</span>(test_pred <span class="sc">-</span> <span class="fu">log</span>(test_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb1108-4"><a href="模型选择与评估.html#cb1108-4" tabindex="-1"></a></span>
<span id="cb1108-5"><a href="模型选择与评估.html#cb1108-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 预测偏差分析 ===</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1108-6"><a href="模型选择与评估.html#cb1108-6" tabindex="-1"></a>  <span class="st">&quot;训练集平均偏差:&quot;</span>, <span class="fu">round</span>(bias_train, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1108-7"><a href="模型选择与评估.html#cb1108-7" tabindex="-1"></a>  <span class="st">&quot;测试集平均偏差:&quot;</span>, <span class="fu">round</span>(bias_test, <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 预测偏差分析 ===
##  训练集平均偏差: 0 
##  测试集平均偏差: -0.343</code></pre>
<div class="sourceCode" id="cb1110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1110-1"><a href="模型选择与评估.html#cb1110-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">abs</span>(bias_test) <span class="sc">&gt;</span> <span class="fl">0.1</span>) {</span>
<span id="cb1110-2"><a href="模型选择与评估.html#cb1110-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;注意：模型在新地区存在系统性预测偏差</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1110-3"><a href="模型选择与评估.html#cb1110-3" tabindex="-1"></a>      <span class="st">&quot;可能原因：环境因子与物种丰富度的关系存在地区差异</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1110-4"><a href="模型选择与评估.html#cb1110-4" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 注意：模型在新地区存在系统性预测偏差
##  可能原因：环境因子与物种丰富度的关系存在地区差异</code></pre>
</div>
<div id="模型诊断" class="section level3 hasAnchor" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> 模型诊断<a href="模型选择与评估.html#模型诊断" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>模型诊断是确保统计模型可靠性的基础工作，它通过系统检查模型的残差、影响点和假设条件来识别潜在问题。在生态学研究中，模型诊断不仅具有统计意义，更重要的是它能够揭示数据中可能存在的生态学异常和特殊模式。</p>
<p><strong>残差分析</strong>是模型诊断的核心内容。残差是观测值与模型预测值之间的差异，理想的残差应该随机分布，没有明显的模式。通过残差分析，我们可以检验模型是否充分捕捉了数据中的生态关系，是否存在未被解释的系统性变异。</p>
<p>在生态学中，残差分析可以帮助我们发现重要的生态现象。例如，如果残差显示出明显的空间聚集模式，可能意味着存在未被考虑的空间自相关效应；如果残差与某个环境因子相关，可能意味着该因子对生态响应的影响被低估或高估。</p>
<p><strong>影响分析</strong>关注个别观测对模型结果的过度影响。在生态数据中，某些异常观测可能对模型参数估计产生不成比例的影响。这些异常观测可能代表特殊的生态情境，如罕见的生境类型、极端的气候事件或特殊的物种行为。通过识别这些影响点，我们不仅能够确保模型的统计稳健性，还能够发现值得深入研究的生态学现象。</p>
<p>模型诊断的生态学意义在于它连接了统计技术与生态学理解。一个统计上完美的模型如果无法通过生态学合理性检验，其价值就会大打折扣。例如，一个预测物种分布的模型如果残差显示出明显的生态梯度模式，可能意味着模型忽略了重要的环境驱动因子。</p>
<p>模型诊断是确保统计模型可靠性的基础工作，它通过系统检查模型的残差、影响点和假设条件来识别潜在问题。在生态学研究中，模型诊断不仅具有统计意义，更重要的是它能够揭示数据中可能存在的生态学异常和特殊模式。</p>
<div class="sourceCode" id="cb1112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1112-1"><a href="模型选择与评估.html#cb1112-1" tabindex="-1"></a><span class="co"># 模型诊断在生态学中的应用演示 - 数据生成</span></span>
<span id="cb1112-2"><a href="模型选择与评估.html#cb1112-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4040</span>)</span>
<span id="cb1112-3"><a href="模型选择与评估.html#cb1112-3" tabindex="-1"></a></span>
<span id="cb1112-4"><a href="模型选择与评估.html#cb1112-4" tabindex="-1"></a><span class="co"># 生成生态学数据：河流无脊椎动物多样性与水质的关系</span></span>
<span id="cb1112-5"><a href="模型选择与评估.html#cb1112-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb1112-6"><a href="模型选择与评估.html#cb1112-6" tabindex="-1"></a></span>
<span id="cb1112-7"><a href="模型选择与评估.html#cb1112-7" tabindex="-1"></a>water_temp <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">8</span>, <span class="dv">22</span>) <span class="co"># 水温(°C)</span></span>
<span id="cb1112-8"><a href="模型选择与评估.html#cb1112-8" tabindex="-1"></a>dissolved_oxygen <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">4</span>, <span class="dv">12</span>) <span class="co"># 溶解氧(mg/L)</span></span>
<span id="cb1112-9"><a href="模型选择与评估.html#cb1112-9" tabindex="-1"></a>conductivity <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">50</span>, <span class="dv">800</span>) <span class="co"># 电导率(μS/cm)</span></span>
<span id="cb1112-10"><a href="模型选择与评估.html#cb1112-10" tabindex="-1"></a>flow_velocity <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="fl">0.1</span>, <span class="fl">1.5</span>) <span class="co"># 流速(m/s)</span></span>
<span id="cb1112-11"><a href="模型选择与评估.html#cb1112-11" tabindex="-1"></a></span>
<span id="cb1112-12"><a href="模型选择与评估.html#cb1112-12" tabindex="-1"></a><span class="co"># 生成无脊椎动物多样性数据（包含一些异常观测）</span></span>
<span id="cb1112-13"><a href="模型选择与评估.html#cb1112-13" tabindex="-1"></a>invert_diversity <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> water_temp <span class="sc">+</span> <span class="fl">1.2</span> <span class="sc">*</span> dissolved_oxygen <span class="sc">-</span></span>
<span id="cb1112-14"><a href="模型选择与评估.html#cb1112-14" tabindex="-1"></a>  <span class="fl">0.005</span> <span class="sc">*</span> conductivity <span class="sc">+</span> <span class="dv">8</span> <span class="sc">*</span> flow_velocity <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb1112-15"><a href="模型选择与评估.html#cb1112-15" tabindex="-1"></a></span>
<span id="cb1112-16"><a href="模型选择与评估.html#cb1112-16" tabindex="-1"></a><span class="co"># 人为添加一些异常观测</span></span>
<span id="cb1112-17"><a href="模型选择与评估.html#cb1112-17" tabindex="-1"></a><span class="co"># 异常点1：极端高多样性（可能代表特殊生境）</span></span>
<span id="cb1112-18"><a href="模型选择与评估.html#cb1112-18" tabindex="-1"></a>invert_diversity[<span class="dv">25</span>] <span class="ot">&lt;-</span> <span class="dv">45</span></span>
<span id="cb1112-19"><a href="模型选择与评估.html#cb1112-19" tabindex="-1"></a><span class="co"># 异常点2：极端低多样性（可能代表污染事件）</span></span>
<span id="cb1112-20"><a href="模型选择与评估.html#cb1112-20" tabindex="-1"></a>invert_diversity[<span class="dv">60</span>] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb1112-21"><a href="模型选择与评估.html#cb1112-21" tabindex="-1"></a><span class="co"># 异常点3：高杠杆点（极端环境条件）</span></span>
<span id="cb1112-22"><a href="模型选择与评估.html#cb1112-22" tabindex="-1"></a>water_temp[<span class="dv">85</span>] <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb1112-23"><a href="模型选择与评估.html#cb1112-23" tabindex="-1"></a>dissolved_oxygen[<span class="dv">85</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb1112-24"><a href="模型选择与评估.html#cb1112-24" tabindex="-1"></a></span>
<span id="cb1112-25"><a href="模型选择与评估.html#cb1112-25" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb1112-26"><a href="模型选择与评估.html#cb1112-26" tabindex="-1"></a>river_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1112-27"><a href="模型选择与评估.html#cb1112-27" tabindex="-1"></a>  <span class="at">diversity =</span> invert_diversity,</span>
<span id="cb1112-28"><a href="模型选择与评估.html#cb1112-28" tabindex="-1"></a>  <span class="at">temp =</span> water_temp,</span>
<span id="cb1112-29"><a href="模型选择与评估.html#cb1112-29" tabindex="-1"></a>  <span class="at">oxygen =</span> dissolved_oxygen,</span>
<span id="cb1112-30"><a href="模型选择与评估.html#cb1112-30" tabindex="-1"></a>  <span class="at">conductivity =</span> conductivity,</span>
<span id="cb1112-31"><a href="模型选择与评估.html#cb1112-31" tabindex="-1"></a>  <span class="at">flow =</span> flow_velocity</span>
<span id="cb1112-32"><a href="模型选择与评估.html#cb1112-32" tabindex="-1"></a>)</span>
<span id="cb1112-33"><a href="模型选择与评估.html#cb1112-33" tabindex="-1"></a></span>
<span id="cb1112-34"><a href="模型选择与评估.html#cb1112-34" tabindex="-1"></a><span class="co"># 构建线性回归模型</span></span>
<span id="cb1112-35"><a href="模型选择与评估.html#cb1112-35" tabindex="-1"></a>model_diagnostic <span class="ot">&lt;-</span> <span class="fu">lm</span>(diversity <span class="sc">~</span> temp <span class="sc">+</span> oxygen <span class="sc">+</span> conductivity <span class="sc">+</span> flow,</span>
<span id="cb1112-36"><a href="模型选择与评估.html#cb1112-36" tabindex="-1"></a>  <span class="at">data =</span> river_data</span>
<span id="cb1112-37"><a href="模型选择与评估.html#cb1112-37" tabindex="-1"></a>)</span></code></pre></div>
<p>残差分析是模型诊断的核心内容。残差是观测值与模型预测值之间的差异，理想的残差应该随机分布，没有明显的模式。通过残差分析，我们可以检验模型是否充分捕捉了数据中的生态关系，是否存在未被解释的系统性变异。</p>
<div class="sourceCode" id="cb1113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1113-1"><a href="模型选择与评估.html#cb1113-1" tabindex="-1"></a><span class="co"># 执行全面的模型诊断</span></span>
<span id="cb1113-2"><a href="模型选择与评估.html#cb1113-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 模型诊断结果 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 模型诊断结果 ===</code></pre>
<div class="sourceCode" id="cb1115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1115-1"><a href="模型选择与评估.html#cb1115-1" tabindex="-1"></a><span class="co"># 1. 残差分析</span></span>
<span id="cb1115-2"><a href="模型选择与评估.html#cb1115-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">1. 残差分析</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 1. 残差分析</code></pre>
<div class="sourceCode" id="cb1117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1117-1"><a href="模型选择与评估.html#cb1117-1" tabindex="-1"></a><span class="co"># 绘制残差诊断图</span></span>
<span id="cb1117-2"><a href="模型选择与评估.html#cb1117-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb1117-3"><a href="模型选择与评估.html#cb1117-3" tabindex="-1"></a><span class="fu">plot</span>(model_diagnostic)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-30"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-30-1.png" alt="模型残差诊断图：残差vs拟合值、Q-Q图、尺度-位置图和残差vs杠杆图" width="672" />
<p class="caption">
图9.1: 模型残差诊断图：残差vs拟合值、Q-Q图、尺度-位置图和残差vs杠杆图
</p>
</div>
<div class="sourceCode" id="cb1118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1118-1"><a href="模型选择与评估.html#cb1118-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1118-2"><a href="模型选择与评估.html#cb1118-2" tabindex="-1"></a></span>
<span id="cb1118-3"><a href="模型选择与评估.html#cb1118-3" tabindex="-1"></a><span class="co"># 计算残差统计量</span></span>
<span id="cb1118-4"><a href="模型选择与评估.html#cb1118-4" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">resid</span>(model_diagnostic)</span>
<span id="cb1118-5"><a href="模型选择与评估.html#cb1118-5" tabindex="-1"></a>fitted <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model_diagnostic)</span>
<span id="cb1118-6"><a href="模型选择与评估.html#cb1118-6" tabindex="-1"></a></span>
<span id="cb1118-7"><a href="模型选择与评估.html#cb1118-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;残差统计量：</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1118-8"><a href="模型选择与评估.html#cb1118-8" tabindex="-1"></a>  <span class="st">&quot;均值:&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(residuals), <span class="dv">3</span>), <span class="st">&quot;(理想值: 0)</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1118-9"><a href="模型选择与评估.html#cb1118-9" tabindex="-1"></a>  <span class="st">&quot;标准差:&quot;</span>, <span class="fu">round</span>(<span class="fu">sd</span>(residuals), <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1118-10"><a href="模型选择与评估.html#cb1118-10" tabindex="-1"></a>  <span class="st">&quot;偏度:&quot;</span>, <span class="fu">round</span>(moments<span class="sc">::</span><span class="fu">skewness</span>(residuals), <span class="dv">3</span>), <span class="st">&quot;(理想值: 0)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 残差统计量：
##  均值: 0 (理想值: 0)
##  标准差: 4.452 
##  偏度: -2.854 (理想值: 0)</code></pre>
<div class="sourceCode" id="cb1120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1120-1"><a href="模型选择与评估.html#cb1120-1" tabindex="-1"></a><span class="co"># 检验残差正态性</span></span>
<span id="cb1120-2"><a href="模型选择与评估.html#cb1120-2" tabindex="-1"></a>shapiro_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(residuals)</span>
<span id="cb1120-3"><a href="模型选择与评估.html#cb1120-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Shapiro-Wilk正态性检验p值:&quot;</span>, <span class="fu">round</span>(shapiro_test<span class="sc">$</span>p.value, <span class="dv">4</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Shapiro-Wilk正态性检验p值: 0</code></pre>
<div class="sourceCode" id="cb1122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1122-1"><a href="模型选择与评估.html#cb1122-1" tabindex="-1"></a><span class="cf">if</span> (shapiro_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb1122-2"><a href="模型选择与评估.html#cb1122-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;警告：残差可能不服从正态分布</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1122-3"><a href="模型选择与评估.html#cb1122-3" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 警告：残差可能不服从正态分布</code></pre>
<p>影响分析关注个别观测对模型结果的过度影响。在生态数据中，某些异常观测可能对模型参数估计产生不成比例的影响。这些异常观测可能代表特殊的生态情境，如罕见的生境类型、极端的气候事件或特殊的物种行为。</p>
<div class="sourceCode" id="cb1124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1124-1"><a href="模型选择与评估.html#cb1124-1" tabindex="-1"></a><span class="co"># 2. 影响分析</span></span>
<span id="cb1124-2"><a href="模型选择与评估.html#cb1124-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">2. 影响分析</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 2. 影响分析</code></pre>
<div class="sourceCode" id="cb1126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1126-1"><a href="模型选择与评估.html#cb1126-1" tabindex="-1"></a><span class="co"># 计算影响统计量</span></span>
<span id="cb1126-2"><a href="模型选择与评估.html#cb1126-2" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1126-3"><a href="模型选择与评估.html#cb1126-3" tabindex="-1"></a>influence_measures <span class="ot">&lt;-</span> <span class="fu">influence.measures</span>(model_diagnostic)</span>
<span id="cb1126-4"><a href="模型选择与评估.html#cb1126-4" tabindex="-1"></a></span>
<span id="cb1126-5"><a href="模型选择与评估.html#cb1126-5" tabindex="-1"></a><span class="co"># 识别高杠杆点（hat values &gt; 2p/n）</span></span>
<span id="cb1126-6"><a href="模型选择与评估.html#cb1126-6" tabindex="-1"></a>hat_values <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(model_diagnostic)</span>
<span id="cb1126-7"><a href="模型选择与评估.html#cb1126-7" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(model_diagnostic))</span>
<span id="cb1126-8"><a href="模型选择与评估.html#cb1126-8" tabindex="-1"></a>high_leverage <span class="ot">&lt;-</span> <span class="fu">which</span>(hat_values <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">*</span> p <span class="sc">/</span> n)</span>
<span id="cb1126-9"><a href="模型选择与评估.html#cb1126-9" tabindex="-1"></a></span>
<span id="cb1126-10"><a href="模型选择与评估.html#cb1126-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;高杠杆点（可能对模型有过度影响）：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 高杠杆点（可能对模型有过度影响）：</code></pre>
<div class="sourceCode" id="cb1128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1128-1"><a href="模型选择与评估.html#cb1128-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(high_leverage) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1128-2"><a href="模型选择与评估.html#cb1128-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;观测编号:&quot;</span>, high_leverage, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1128-3"><a href="模型选择与评估.html#cb1128-3" tabindex="-1"></a>    <span class="st">&quot;对应的hat值:&quot;</span>, <span class="fu">round</span>(hat_values[high_leverage], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1128-4"><a href="模型选择与评估.html#cb1128-4" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1128-5"><a href="模型选择与评估.html#cb1128-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;未发现高杠杆点</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1128-6"><a href="模型选择与评估.html#cb1128-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 观测编号: 85 
##  对应的hat值: 0.112</code></pre>
<div class="sourceCode" id="cb1130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1130-1"><a href="模型选择与评估.html#cb1130-1" tabindex="-1"></a><span class="co"># 识别异常残差（标准化残差 &gt; 2）</span></span>
<span id="cb1130-2"><a href="模型选择与评估.html#cb1130-2" tabindex="-1"></a>std_residuals <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(model_diagnostic)</span>
<span id="cb1130-3"><a href="模型选择与评估.html#cb1130-3" tabindex="-1"></a>outlier_residuals <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(std_residuals) <span class="sc">&gt;</span> <span class="dv">2</span>)</span>
<span id="cb1130-4"><a href="模型选择与评估.html#cb1130-4" tabindex="-1"></a></span>
<span id="cb1130-5"><a href="模型选择与评估.html#cb1130-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">异常残差点（|标准化残差| &gt; 2）：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 异常残差点（|标准化残差| &gt; 2）：</code></pre>
<div class="sourceCode" id="cb1132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1132-1"><a href="模型选择与评估.html#cb1132-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(outlier_residuals) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1132-2"><a href="模型选择与评估.html#cb1132-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;观测编号:&quot;</span>, outlier_residuals, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1132-3"><a href="模型选择与评估.html#cb1132-3" tabindex="-1"></a>    <span class="st">&quot;对应的标准化残差:&quot;</span>, <span class="fu">round</span>(std_residuals[outlier_residuals], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1132-4"><a href="模型选择与评估.html#cb1132-4" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1132-5"><a href="模型选择与评估.html#cb1132-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;未发现异常残差点</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1132-6"><a href="模型选择与评估.html#cb1132-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 观测编号: 25 60 63 85 
##  对应的标准化残差: 2.638 -7.267 2.154 2.92</code></pre>
<div class="sourceCode" id="cb1134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1134-1"><a href="模型选择与评估.html#cb1134-1" tabindex="-1"></a><span class="co"># 识别强影响点（Cook&#39;s distance &gt; 4/(n-p)）</span></span>
<span id="cb1134-2"><a href="模型选择与评估.html#cb1134-2" tabindex="-1"></a>cooks_d <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(model_diagnostic)</span>
<span id="cb1134-3"><a href="模型选择与评估.html#cb1134-3" tabindex="-1"></a>influential_points <span class="ot">&lt;-</span> <span class="fu">which</span>(cooks_d <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">/</span> (n <span class="sc">-</span> p))</span>
<span id="cb1134-4"><a href="模型选择与评估.html#cb1134-4" tabindex="-1"></a></span>
<span id="cb1134-5"><a href="模型选择与评估.html#cb1134-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">强影响点（Cook&#39;s distance较大）：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 强影响点（Cook&#39;s distance较大）：</code></pre>
<div class="sourceCode" id="cb1136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1136-1"><a href="模型选择与评估.html#cb1136-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(influential_points) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1136-2"><a href="模型选择与评估.html#cb1136-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;观测编号:&quot;</span>, influential_points, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1136-3"><a href="模型选择与评估.html#cb1136-3" tabindex="-1"></a>    <span class="st">&quot;对应的Cook&#39;s distance:&quot;</span>, <span class="fu">round</span>(cooks_d[influential_points], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1136-4"><a href="模型选择与评估.html#cb1136-4" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1136-5"><a href="模型选择与评估.html#cb1136-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;未发现强影响点</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1136-6"><a href="模型选择与评估.html#cb1136-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 观测编号: 25 29 60 63 85 
##  对应的Cook&#39;s distance: 0.077 0.036 0.357 0.037 0.215</code></pre>
<p>多重共线性会影响参数估计的稳定性。当解释变量之间存在高度相关性时，单个变量的独立效应难以准确估计。方差膨胀因子(VIF)是诊断多重共线性的常用指标。</p>
<div class="sourceCode" id="cb1138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1138-1"><a href="模型选择与评估.html#cb1138-1" tabindex="-1"></a><span class="co"># 3. 多重共线性诊断</span></span>
<span id="cb1138-2"><a href="模型选择与评估.html#cb1138-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">3. 多重共线性诊断</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 3. 多重共线性诊断</code></pre>
<div class="sourceCode" id="cb1140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1140-1"><a href="模型选择与评估.html#cb1140-1" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_diagnostic)</span>
<span id="cb1140-2"><a href="模型选择与评估.html#cb1140-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;方差膨胀因子(VIF)：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 方差膨胀因子(VIF)：</code></pre>
<div class="sourceCode" id="cb1142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1142-1"><a href="模型选择与评估.html#cb1142-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(vif_values)) {</span>
<span id="cb1142-2"><a href="模型选择与评估.html#cb1142-2" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">names</span>(vif_values)[i], <span class="st">&quot;:&quot;</span>, <span class="fu">round</span>(vif_values[i], <span class="dv">2</span>))</span>
<span id="cb1142-3"><a href="模型选择与评估.html#cb1142-3" tabindex="-1"></a>  <span class="cf">if</span> (vif_values[i] <span class="sc">&gt;</span> <span class="dv">5</span>) {</span>
<span id="cb1142-4"><a href="模型选择与评估.html#cb1142-4" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot; (可能存在多重共线性)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1142-5"><a href="模型选择与评估.html#cb1142-5" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (vif_values[i] <span class="sc">&gt;</span> <span class="dv">10</span>) {</span>
<span id="cb1142-6"><a href="模型选择与评估.html#cb1142-6" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot; (严重多重共线性)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1142-7"><a href="模型选择与评估.html#cb1142-7" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1142-8"><a href="模型选择与评估.html#cb1142-8" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1142-9"><a href="模型选择与评估.html#cb1142-9" tabindex="-1"></a>  }</span>
<span id="cb1142-10"><a href="模型选择与评估.html#cb1142-10" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## temp : 1.01
## oxygen : 1.03
## conductivity : 1.01
## flow : 1.02</code></pre>
<p>可视化是理解影响分析结果的重要工具。Cook’s distance图能够直观展示各观测点对模型的影响程度，帮助我们识别需要特别关注的异常观测。</p>
<div class="sourceCode" id="cb1144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1144-1"><a href="模型选择与评估.html#cb1144-1" tabindex="-1"></a><span class="co"># 可视化影响分析</span></span>
<span id="cb1144-2"><a href="模型选择与评估.html#cb1144-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1144-3"><a href="模型选择与评估.html#cb1144-3" tabindex="-1"></a></span>
<span id="cb1144-4"><a href="模型选择与评估.html#cb1144-4" tabindex="-1"></a><span class="co"># Cook&#39;s distance图</span></span>
<span id="cb1144-5"><a href="模型选择与评估.html#cb1144-5" tabindex="-1"></a>cook_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Observation =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">CooksD =</span> cooks_d)</span>
<span id="cb1144-6"><a href="模型选择与评估.html#cb1144-6" tabindex="-1"></a><span class="fu">ggplot</span>(cook_data, <span class="fu">aes</span>(<span class="at">x =</span> Observation, <span class="at">y =</span> CooksD)) <span class="sc">+</span></span>
<span id="cb1144-7"><a href="模型选择与评估.html#cb1144-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1144-8"><a href="模型选择与评估.html#cb1144-8" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span> <span class="sc">/</span> (n <span class="sc">-</span> p), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb1144-9"><a href="模型选择与评估.html#cb1144-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1144-10"><a href="模型选择与评估.html#cb1144-10" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Cook&#39;s Distance影响分析&quot;</span>,</span>
<span id="cb1144-11"><a href="模型选择与评估.html#cb1144-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;观测编号&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Cook&#39;s Distance&quot;</span></span>
<span id="cb1144-12"><a href="模型选择与评估.html#cb1144-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1144-13"><a href="模型选择与评估.html#cb1144-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1144-14"><a href="模型选择与评估.html#cb1144-14" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb1144-15"><a href="模型选择与评估.html#cb1144-15" tabindex="-1"></a>    <span class="at">data =</span> cook_data[influential_points, ],</span>
<span id="cb1144-16"><a href="模型选择与评估.html#cb1144-16" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> Observation), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb1144-17"><a href="模型选择与评估.html#cb1144-17" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-33"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-33-1.png" alt="Cook's Distance影响分析：识别对模型参数估计有过度影响的观测点" width="672" />
<p class="caption">
图9.2: Cook’s Distance影响分析：识别对模型参数估计有过度影响的观测点
</p>
</div>
<p>在生态学中，异常观测往往具有重要的生态学意义。高杠杆点可能代表极端环境条件，异常残差点可能反映特殊的生态情境。通过识别这些点，我们不仅能够确保模型的统计稳健性，还能够发现值得深入研究的生态学现象。</p>
<p>在这个河流无脊椎动物多样性的例子中：</p>
<ul>
<li><p>高杠杆点可能代表极端环境条件（如极高水温、极低溶解氧）</p></li>
<li><p>这些观测对模型参数估计有不成比例的影响</p></li>
<li><p>异常残差点可能代表特殊的生态情境</p></li>
<li><p>例如，异常高多样性可能出现在保护良好的河段</p></li>
<li><p>异常低多样性可能出现在受污染的河段</p></li>
<li><p>强影响点可能显著改变模型的生态学结论</p></li>
<li><p>需要仔细检查这些观测的生态学合理性</p></li>
</ul>
<p>稳健性检查通过比较移除异常观测前后的模型结果，评估模型对异常观测的敏感性。如果系数变化显著，说明模型对特定观测过度依赖，需要谨慎解释结果。</p>
<div class="sourceCode" id="cb1145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1145-1"><a href="模型选择与评估.html#cb1145-1" tabindex="-1"></a><span class="co"># 稳健性检查：移除强影响点后的模型</span></span>
<span id="cb1145-2"><a href="模型选择与评估.html#cb1145-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(influential_points) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1145-3"><a href="模型选择与评估.html#cb1145-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 稳健性检查 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1145-4"><a href="模型选择与评估.html#cb1145-4" tabindex="-1"></a></span>
<span id="cb1145-5"><a href="模型选择与评估.html#cb1145-5" tabindex="-1"></a>  robust_data <span class="ot">&lt;-</span> river_data[<span class="sc">-</span>influential_points, ]</span>
<span id="cb1145-6"><a href="模型选择与评估.html#cb1145-6" tabindex="-1"></a>  robust_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(diversity <span class="sc">~</span> temp <span class="sc">+</span> oxygen <span class="sc">+</span> conductivity <span class="sc">+</span> flow,</span>
<span id="cb1145-7"><a href="模型选择与评估.html#cb1145-7" tabindex="-1"></a>    <span class="at">data =</span> robust_data</span>
<span id="cb1145-8"><a href="模型选择与评估.html#cb1145-8" tabindex="-1"></a>  )</span>
<span id="cb1145-9"><a href="模型选择与评估.html#cb1145-9" tabindex="-1"></a></span>
<span id="cb1145-10"><a href="模型选择与评估.html#cb1145-10" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;原始模型系数：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1145-11"><a href="模型选择与评估.html#cb1145-11" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">coef</span>(model_diagnostic), <span class="dv">3</span>))</span>
<span id="cb1145-12"><a href="模型选择与评估.html#cb1145-12" tabindex="-1"></a></span>
<span id="cb1145-13"><a href="模型选择与评估.html#cb1145-13" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">稳健模型系数（移除强影响点）：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1145-14"><a href="模型选择与评估.html#cb1145-14" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">coef</span>(robust_model), <span class="dv">3</span>))</span>
<span id="cb1145-15"><a href="模型选择与评估.html#cb1145-15" tabindex="-1"></a></span>
<span id="cb1145-16"><a href="模型选择与评估.html#cb1145-16" tabindex="-1"></a>  <span class="co"># 计算系数变化</span></span>
<span id="cb1145-17"><a href="模型选择与评估.html#cb1145-17" tabindex="-1"></a>  coef_change <span class="ot">&lt;-</span> <span class="fu">abs</span>((<span class="fu">coef</span>(robust_model) <span class="sc">-</span> <span class="fu">coef</span>(model_diagnostic)) <span class="sc">/</span> <span class="fu">coef</span>(model_diagnostic)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1145-18"><a href="模型选择与评估.html#cb1145-18" tabindex="-1"></a></span>
<span id="cb1145-19"><a href="模型选择与评估.html#cb1145-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">系数变化百分比：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1145-20"><a href="模型选择与评估.html#cb1145-20" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(coef_change)) {</span>
<span id="cb1145-21"><a href="模型选择与评估.html#cb1145-21" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">names</span>(coef_change)[i], <span class="st">&quot;:&quot;</span>, <span class="fu">round</span>(coef_change[i], <span class="dv">1</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1145-22"><a href="模型选择与评估.html#cb1145-22" tabindex="-1"></a>  }</span>
<span id="cb1145-23"><a href="模型选择与评估.html#cb1145-23" tabindex="-1"></a></span>
<span id="cb1145-24"><a href="模型选择与评估.html#cb1145-24" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(coef_change <span class="sc">&gt;</span> <span class="dv">20</span>)) {</span>
<span id="cb1145-25"><a href="模型选择与评估.html#cb1145-25" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">警告：某些系数变化超过20%，模型对异常观测敏感</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1145-26"><a href="模型选择与评估.html#cb1145-26" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1145-27"><a href="模型选择与评估.html#cb1145-27" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">模型对异常观测相对稳健</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1145-28"><a href="模型选择与评估.html#cb1145-28" tabindex="-1"></a>  }</span>
<span id="cb1145-29"><a href="模型选择与评估.html#cb1145-29" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## === 稳健性检查 ===
## 原始模型系数：
##  (Intercept)         temp       oxygen conductivity         flow 
##       15.053        0.216        1.209       -0.003        8.500 
## 
## 稳健模型系数（移除强影响点）：
##  (Intercept)         temp       oxygen conductivity         flow 
##       12.840        0.301        1.317       -0.003        8.705 
## 
## 系数变化百分比：
## (Intercept) : 14.7 %
## temp : 39.5 %
## oxygen : 8.9 %
## conductivity : 13.9 %
## flow : 2.4 %
## 
## 警告：某些系数变化超过20%，模型对异常观测敏感</code></pre>
<p>模型诊断的最终目的是确保研究结论的可靠性。通过系统的诊断分析，我们能够识别潜在问题，采取适当措施，并在生态学解释中考虑模型的局限性。</p>
<p>模型诊断建议：检查异常观测的生态学合理性，考虑是否需要变换变量或使用稳健回归方法，确保模型假设得到满足，并在生态学解释中考虑模型的局限性。</p>
<p>模型诊断连接了统计技术与生态学理解。一个统计上完美的模型如果无法通过生态学合理性检验，其价值就会大打折扣。通过系统的模型诊断，我们能够构建既统计可靠又生态学有意义的模型。</p>
</div>
</div>
<div id="贝叶斯模型选择与评估" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> 贝叶斯模型选择与评估<a href="模型选择与评估.html#贝叶斯模型选择与评估" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在前面的章节中，我们主要介绍了基于频率学派的模型选择与评估方法。现在让我们转向一个完全不同的统计范式——贝叶斯方法。贝叶斯模型选择与评估在哲学基础、方法论和生态学解释上都与频率学派方法存在根本差异。</p>
<div id="贝叶斯与频率学派的根本差异" class="section level3 hasAnchor" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> 贝叶斯与频率学派的根本差异<a href="模型选择与评估.html#贝叶斯与频率学派的根本差异" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>理解贝叶斯方法的第一步是认识到它与频率学派方法的本质区别：</p>
<p><strong>1. 哲学基础不同</strong><br />
- <strong>频率学派</strong>：基于重复抽样思想，关注长期频率性质<br />
- <strong>贝叶斯方法</strong>：基于主观概率解释，将参数视为随机变量</p>
<p><strong>2. 不确定性处理方式不同</strong><br />
- <strong>频率学派</strong>：参数不确定性通过置信区间表示<br />
- <strong>贝叶斯方法</strong>：参数不确定性通过后验分布完全量化</p>
<p><strong>3. 先验信息的使用</strong><br />
- <strong>频率学派</strong>：通常不使用先验信息<br />
- <strong>贝叶斯方法</strong>：明确使用先验分布整合领域知识</p>
<p><strong>4. 模型选择标准不同</strong><br />
- <strong>频率学派</strong>：基于AIC/BIC等信息准则<br />
- <strong>贝叶斯方法</strong>：基于贝叶斯因子和后验模型概率</p>
<p><strong>5. 预测评估方法不同</strong><br />
- <strong>频率学派</strong>：基于点估计的预测<br />
- <strong>贝叶斯方法</strong>：基于后验预测分布的完整预测</p>
<p><strong>6. 变量选择方法不同</strong><br />
- <strong>频率学派</strong>：逐步回归、LASSO等惩罚方法<br />
- <strong>贝叶斯方法</strong>：贝叶斯变量选择、稀疏先验</p>
<p><strong>7. 生态学解释差异</strong><br />
- <strong>频率学派</strong>：“我们有95%置信度参数在区间内”<br />
- <strong>贝叶斯方法</strong>：“参数有95%概率落在区间内”</p>
<p>这些根本差异使得贝叶斯方法在生态学中特别有价值，特别是在处理小样本数据、整合先验知识、量化不确定性等方面具有独特优势。</p>
</div>
<div id="贝叶斯模型选择基本原理" class="section level3 hasAnchor" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> 贝叶斯模型选择基本原理<a href="模型选择与评估.html#贝叶斯模型选择基本原理" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯模型选择的核心是<strong>贝叶斯因子</strong>和<strong>后验模型概率</strong>。</p>
<p><strong>贝叶斯因子</strong>比较两个模型的相对证据强度： <span class="math display">\[BF_{12} = \frac{P(D|M_1)}{P(D|M_2)}\]</span></p>
<p>其中<span class="math inline">\(P(D|M_k)\)</span>是模型<span class="math inline">\(M_k\)</span>的边际似然，表示数据<span class="math inline">\(D\)</span>在模型<span class="math inline">\(M_k\)</span>下的平均拟合程度。</p>
<p><strong>后验模型概率</strong>基于贝叶斯定理： <span class="math display">\[P(M_k|D) = \frac{P(D|M_k)P(M_k)}{\sum_j P(D|M_j)P(M_j)}\]</span></p>
<p>其中<span class="math inline">\(P(M_k)\)</span>是先验模型概率，反映了我们对不同模型的先验偏好。</p>
</div>
<div id="贝叶斯假设检验流程" class="section level3 hasAnchor" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> 贝叶斯假设检验流程<a href="模型选择与评估.html#贝叶斯假设检验流程" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯假设检验提供了一个完整的框架来评估科学假说，其流程与频率统计方法有本质区别。</p>
<p><strong>基本步骤</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>定义先验分布</strong>
<ul>
<li>基于已有知识或专家意见设定参数先验</li>
<li>常用先验：无信息先验、弱信息先验、共轭先验</li>
</ul></li>
<li><strong>构建似然函数</strong>
<ul>
<li>基于观测数据建立概率模型</li>
<li>描述数据在给定参数下的生成过程</li>
</ul></li>
<li><strong>计算后验分布</strong>
<ul>
<li>使用贝叶斯定理结合先验和似然</li>
<li>通常通过MCMC方法进行抽样</li>
</ul></li>
<li><strong>进行假设检验</strong>
<ul>
<li>基于后验分布计算假设的概率</li>
<li>使用贝叶斯因子或后验概率进行决策</li>
</ul></li>
</ol>
<p><strong>生态学应用示例</strong>：检验保护措施对物种丰富度的影响</p>
</div>
<div id="贝叶斯模型比较与选择" class="section level3 hasAnchor" number="9.4.4">
<h3><span class="header-section-number">9.4.4</span> 贝叶斯模型比较与选择<a href="模型选择与评估.html#贝叶斯模型比较与选择" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在生态学研究中，我们经常面临多个竞争模型的比较问题。贝叶斯方法提供了系统化的框架来处理模型不确定性。</p>
<p><strong>模型证据与边际似然</strong></p>
<p><strong>边际似然</strong>（Marginal Likelihood）是模型比较的核心指标，定义为： <span class="math display">\[P(D|M) = \int P(D|\theta, M)P(\theta|M)d\theta\]</span></p>
<p>边际似然衡量了模型对数据的平均拟合程度，同时考虑了参数不确定性。</p>
<p><strong>贝叶斯模型平均（BMA）</strong></p>
<p>当存在多个竞争模型时，贝叶斯模型平均通过加权平均的方式整合不同模型的预测： <span class="math display">\[P(\theta|D) = \sum_{k=1}^K P(\theta|D, M_k)P(M_k|D)\]</span></p>
<p>其中模型权重<span class="math inline">\(P(M_k|D)\)</span>基于边际似然计算： <span class="math display">\[P(M_k|D) = \frac{P(D|M_k)P(M_k)}{\sum_{j=1}^K P(D|M_j)P(M_j)}\]</span></p>
<p><strong>生态学应用</strong>：处理生态模型的不确定性，如： - 物种分布模型的比较 - 种群动态模型的选择 - 群落构建机制的识别</p>
</div>
<div id="贝叶斯可信区间" class="section level3 hasAnchor" number="9.4.5">
<h3><span class="header-section-number">9.4.5</span> 贝叶斯可信区间<a href="模型选择与评估.html#贝叶斯可信区间" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯可信区间（Credible Interval）是贝叶斯统计中参数不确定性的量化工具，与频率统计中的置信区间有本质区别。</p>
<p><strong>定义与解释</strong>：</p>
<p><strong>贝叶斯可信区间</strong>：对于给定的置信水平<span class="math inline">\(1-\alpha\)</span>，可信区间<span class="math inline">\([L, U]\)</span>满足： <span class="math display">\[P(L \leq \theta \leq U | D) = 1 - \alpha\]</span></p>
<p>这意味着在给定观测数据<span class="math inline">\(D\)</span>的条件下，参数<span class="math inline">\(\theta\)</span>落在区间<span class="math inline">\([L, U]\)</span>内的概率为<span class="math inline">\(1-\alpha\)</span>。</p>
<p><strong>与频率置信区间的区别</strong>： - <strong>贝叶斯可信区间</strong>：参数在区间内的概率 - <strong>频率置信区间</strong>：重复抽样时区间包含参数的概率</p>
<p><strong>计算方法</strong>： 1. <strong>最高后验密度区间（HPDI）</strong>：包含后验分布最高密度区域的区间 2. <strong>等尾区间</strong>：基于后验分布分位数的对称区间</p>
<p><strong>生态学意义</strong>： - 提供参数不确定性的直观解释 - 直接回答”参数在某个范围内的概率是多少” - 特别适合风险评估和决策支持</p>
<div class="sourceCode" id="cb1147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1147-1"><a href="模型选择与评估.html#cb1147-1" tabindex="-1"></a><span class="co"># 贝叶斯模型选择演示 - 数据生成</span></span>
<span id="cb1147-2"><a href="模型选择与评估.html#cb1147-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5050</span>)</span>
<span id="cb1147-3"><a href="模型选择与评估.html#cb1147-3" tabindex="-1"></a></span>
<span id="cb1147-4"><a href="模型选择与评估.html#cb1147-4" tabindex="-1"></a><span class="co"># 生成生态学数据：鸟类丰富度与环境因子的关系</span></span>
<span id="cb1147-5"><a href="模型选择与评估.html#cb1147-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb1147-6"><a href="模型选择与评估.html#cb1147-6" tabindex="-1"></a></span>
<span id="cb1147-7"><a href="模型选择与评估.html#cb1147-7" tabindex="-1"></a><span class="co"># 环境因子</span></span>
<span id="cb1147-8"><a href="模型选择与评估.html#cb1147-8" tabindex="-1"></a>habitat_area <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">1</span>, <span class="dv">100</span>) <span class="co"># 栖息地面积</span></span>
<span id="cb1147-9"><a href="模型选择与评估.html#cb1147-9" tabindex="-1"></a>vegetation_density <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="fl">0.1</span>, <span class="fl">0.9</span>) <span class="co"># 植被密度</span></span>
<span id="cb1147-10"><a href="模型选择与评估.html#cb1147-10" tabindex="-1"></a>distance_to_water <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="fl">0.1</span>, <span class="dv">5</span>) <span class="co"># 距水源距离</span></span>
<span id="cb1147-11"><a href="模型选择与评估.html#cb1147-11" tabindex="-1"></a></span>
<span id="cb1147-12"><a href="模型选择与评估.html#cb1147-12" tabindex="-1"></a><span class="co"># 生成鸟类丰富度数据</span></span>
<span id="cb1147-13"><a href="模型选择与评估.html#cb1147-13" tabindex="-1"></a>bird_richness <span class="ot">&lt;-</span> <span class="fu">rpois</span>(</span>
<span id="cb1147-14"><a href="模型选择与评估.html#cb1147-14" tabindex="-1"></a>  n,</span>
<span id="cb1147-15"><a href="模型选择与评估.html#cb1147-15" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fl">1.5</span> <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> habitat_area <span class="sc">+</span></span>
<span id="cb1147-16"><a href="模型选择与评估.html#cb1147-16" tabindex="-1"></a>    <span class="fl">1.2</span> <span class="sc">*</span> vegetation_density <span class="sc">-</span> <span class="fl">0.3</span> <span class="sc">*</span> distance_to_water <span class="sc">+</span></span>
<span id="cb1147-17"><a href="模型选择与评估.html#cb1147-17" tabindex="-1"></a>    <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="fl">0.3</span>))</span>
<span id="cb1147-18"><a href="模型选择与评估.html#cb1147-18" tabindex="-1"></a>)</span>
<span id="cb1147-19"><a href="模型选择与评估.html#cb1147-19" tabindex="-1"></a></span>
<span id="cb1147-20"><a href="模型选择与评估.html#cb1147-20" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb1147-21"><a href="模型选择与评估.html#cb1147-21" tabindex="-1"></a>bird_data_bayes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1147-22"><a href="模型选择与评估.html#cb1147-22" tabindex="-1"></a>  <span class="at">richness =</span> bird_richness,</span>
<span id="cb1147-23"><a href="模型选择与评估.html#cb1147-23" tabindex="-1"></a>  <span class="at">area =</span> habitat_area,</span>
<span id="cb1147-24"><a href="模型选择与评估.html#cb1147-24" tabindex="-1"></a>  <span class="at">vegetation =</span> vegetation_density,</span>
<span id="cb1147-25"><a href="模型选择与评估.html#cb1147-25" tabindex="-1"></a>  <span class="at">water_distance =</span> distance_to_water</span>
<span id="cb1147-26"><a href="模型选择与评估.html#cb1147-26" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="贝叶斯因子计算与解释" class="section level3 hasAnchor" number="9.4.6">
<h3><span class="header-section-number">9.4.6</span> 贝叶斯因子计算与解释<a href="模型选择与评估.html#贝叶斯因子计算与解释" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在R中，我们可以使用<code>BayesFactor</code>包来计算贝叶斯因子：</p>
<div class="sourceCode" id="cb1148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1148-1"><a href="模型选择与评估.html#cb1148-1" tabindex="-1"></a><span class="co"># 贝叶斯因子计算</span></span>
<span id="cb1148-2"><a href="模型选择与评估.html#cb1148-2" tabindex="-1"></a><span class="fu">library</span>(BayesFactor)</span>
<span id="cb1148-3"><a href="模型选择与评估.html#cb1148-3" tabindex="-1"></a></span>
<span id="cb1148-4"><a href="模型选择与评估.html#cb1148-4" tabindex="-1"></a><span class="co"># 构建候选模型</span></span>
<span id="cb1148-5"><a href="模型选择与评估.html#cb1148-5" tabindex="-1"></a><span class="co"># 模型1：只有栖息地面积</span></span>
<span id="cb1148-6"><a href="模型选择与评估.html#cb1148-6" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(richness <span class="sc">~</span> area, <span class="at">data =</span> bird_data_bayes)</span>
<span id="cb1148-7"><a href="模型选择与评估.html#cb1148-7" tabindex="-1"></a></span>
<span id="cb1148-8"><a href="模型选择与评估.html#cb1148-8" tabindex="-1"></a><span class="co"># 模型2：栖息地面积 + 植被密度</span></span>
<span id="cb1148-9"><a href="模型选择与评估.html#cb1148-9" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(richness <span class="sc">~</span> area <span class="sc">+</span> vegetation, <span class="at">data =</span> bird_data_bayes)</span>
<span id="cb1148-10"><a href="模型选择与评估.html#cb1148-10" tabindex="-1"></a></span>
<span id="cb1148-11"><a href="模型选择与评估.html#cb1148-11" tabindex="-1"></a><span class="co"># 模型3：栖息地面积 + 植被密度 + 距水源距离</span></span>
<span id="cb1148-12"><a href="模型选择与评估.html#cb1148-12" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(richness <span class="sc">~</span> area <span class="sc">+</span> vegetation <span class="sc">+</span> water_distance,</span>
<span id="cb1148-13"><a href="模型选择与评估.html#cb1148-13" tabindex="-1"></a>  <span class="at">data =</span> bird_data_bayes</span>
<span id="cb1148-14"><a href="模型选择与评估.html#cb1148-14" tabindex="-1"></a>)</span>
<span id="cb1148-15"><a href="模型选择与评估.html#cb1148-15" tabindex="-1"></a></span>
<span id="cb1148-16"><a href="模型选择与评估.html#cb1148-16" tabindex="-1"></a><span class="co"># 计算贝叶斯因子</span></span>
<span id="cb1148-17"><a href="模型选择与评估.html#cb1148-17" tabindex="-1"></a>bf_12 <span class="ot">&lt;-</span> model2 <span class="sc">/</span> model1</span>
<span id="cb1148-18"><a href="模型选择与评估.html#cb1148-18" tabindex="-1"></a>bf_23 <span class="ot">&lt;-</span> model3 <span class="sc">/</span> model2</span></code></pre></div>
<p>贝叶斯因子比较结果显示，模型2相对于模型1的贝叶斯因子为 1.28，模型3相对于模型2的贝叶斯因子为 2.1013994^{5}。</p>
<p>根据Jeffreys标准，贝叶斯因子的解释标准为：1-3表示微弱证据，3-10表示实质性证据，10-30表示强证据，30-100表示很强证据，大于100表示决定性证据。</p>
<div class="sourceCode" id="cb1149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1149-1"><a href="模型选择与评估.html#cb1149-1" tabindex="-1"></a><span class="co"># 计算后验模型概率</span></span>
<span id="cb1149-2"><a href="模型选择与评估.html#cb1149-2" tabindex="-1"></a><span class="co"># 假设等先验概率</span></span>
<span id="cb1149-3"><a href="模型选择与评估.html#cb1149-3" tabindex="-1"></a>prior_prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>)</span>
<span id="cb1149-4"><a href="模型选择与评估.html#cb1149-4" tabindex="-1"></a>bf_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1149-5"><a href="模型选择与评估.html#cb1149-5" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fu">exp</span>(bf_12<span class="sc">@</span>bayesFactor<span class="sc">$</span>bf),</span>
<span id="cb1149-6"><a href="模型选择与评估.html#cb1149-6" tabindex="-1"></a>  <span class="fu">exp</span>(bf_23<span class="sc">@</span>bayesFactor<span class="sc">$</span>bf) <span class="sc">*</span> <span class="fu">exp</span>(bf_12<span class="sc">@</span>bayesFactor<span class="sc">$</span>bf)</span>
<span id="cb1149-7"><a href="模型选择与评估.html#cb1149-7" tabindex="-1"></a>)</span>
<span id="cb1149-8"><a href="模型选择与评估.html#cb1149-8" tabindex="-1"></a>posterior_prob <span class="ot">&lt;-</span> bf_vector <span class="sc">*</span> prior_prob <span class="sc">/</span> <span class="fu">sum</span>(bf_vector <span class="sc">*</span> prior_prob)</span>
<span id="cb1149-9"><a href="模型选择与评估.html#cb1149-9" tabindex="-1"></a></span>
<span id="cb1149-10"><a href="模型选择与评估.html#cb1149-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 后验模型概率 ===</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1149-11"><a href="模型选择与评估.html#cb1149-11" tabindex="-1"></a>  <span class="st">&quot;模型1 (只有面积):&quot;</span>, <span class="fu">round</span>(posterior_prob[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1149-12"><a href="模型选择与评估.html#cb1149-12" tabindex="-1"></a>  <span class="st">&quot;模型2 (面积+植被):&quot;</span>, <span class="fu">round</span>(posterior_prob[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1149-13"><a href="模型选择与评估.html#cb1149-13" tabindex="-1"></a>  <span class="st">&quot;模型3 (面积+植被+水源):&quot;</span>, <span class="fu">round</span>(posterior_prob[<span class="dv">3</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 后验模型概率 ===
##  模型1 (只有面积): 0 
##  模型2 (面积+植被): 0 
##  模型3 (面积+植被+水源): 1</code></pre>
</div>
<div id="贝叶斯模型平均" class="section level3 hasAnchor" number="9.4.7">
<h3><span class="header-section-number">9.4.7</span> 贝叶斯模型平均<a href="模型选择与评估.html#贝叶斯模型平均" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯模型平均通过后验模型概率对多个候选模型的预测进行加权平均，从而整合模型不确定性：</p>
<div class="sourceCode" id="cb1151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1151-1"><a href="模型选择与评估.html#cb1151-1" tabindex="-1"></a><span class="co"># 贝叶斯模型平均演示</span></span>
<span id="cb1151-2"><a href="模型选择与评估.html#cb1151-2" tabindex="-1"></a><span class="fu">library</span>(BMS)</span>
<span id="cb1151-3"><a href="模型选择与评估.html#cb1151-3" tabindex="-1"></a></span>
<span id="cb1151-4"><a href="模型选择与评估.html#cb1151-4" tabindex="-1"></a><span class="co"># 使用BMS包进行贝叶斯模型平均</span></span>
<span id="cb1151-5"><a href="模型选择与评估.html#cb1151-5" tabindex="-1"></a><span class="co"># 注意：这里使用线性回归的贝叶斯模型平均</span></span>
<span id="cb1151-6"><a href="模型选择与评估.html#cb1151-6" tabindex="-1"></a><span class="co"># 在实际应用中，对于计数数据应该使用泊松回归</span></span>
<span id="cb1151-7"><a href="模型选择与评估.html#cb1151-7" tabindex="-1"></a></span>
<span id="cb1151-8"><a href="模型选择与评估.html#cb1151-8" tabindex="-1"></a><span class="co"># 创建设计矩阵</span></span>
<span id="cb1151-9"><a href="模型选择与评估.html#cb1151-9" tabindex="-1"></a>design_matrix <span class="ot">&lt;-</span> bird_data_bayes[, <span class="fu">c</span>(<span class="st">&quot;area&quot;</span>, <span class="st">&quot;vegetation&quot;</span>, <span class="st">&quot;water_distance&quot;</span>)]</span>
<span id="cb1151-10"><a href="模型选择与评估.html#cb1151-10" tabindex="-1"></a>response_var <span class="ot">&lt;-</span> bird_data_bayes<span class="sc">$</span>richness</span>
<span id="cb1151-11"><a href="模型选择与评估.html#cb1151-11" tabindex="-1"></a></span>
<span id="cb1151-12"><a href="模型选择与评估.html#cb1151-12" tabindex="-1"></a><span class="co"># 执行贝叶斯模型平均</span></span>
<span id="cb1151-13"><a href="模型选择与评估.html#cb1151-13" tabindex="-1"></a>bma_result <span class="ot">&lt;-</span> <span class="fu">bms</span>(<span class="fu">cbind</span>(response_var, design_matrix), <span class="at">burn =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">g =</span> <span class="st">&quot;UIP&quot;</span>)</span></code></pre></div>
<pre><code>##                      PIP  Post Mean    Post SD Cond.Pos.Sign Idx
## area           1.0000000  0.2638852 0.02977124             1   1
## water_distance 0.9999979 -3.4862236 0.59152078             0   3
## vegetation     0.9444822  9.8845073 4.31007528             1   2
## 
## Mean no. regressors               Draws             Burnins                Time 
##            &quot;2.9445&quot;                 &quot;8&quot;                 &quot;0&quot;  &quot;0.009158134 secs&quot; 
##  No. models visited      Modelspace 2^K           % visited         % Topmodels 
##                 &quot;8&quot;                 &quot;8&quot;               &quot;100&quot;               &quot;100&quot; 
##            Corr PMP            No. Obs.         Model Prior             g-Prior 
##                &quot;NA&quot;                &quot;80&quot;      &quot;random / 1.5&quot;               &quot;UIP&quot; 
##     Shrinkage-Stats 
##         &quot;Av=0.9877&quot; 
## 
## Time difference of 0.009158134 secs</code></pre>
<p><img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-38-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb1153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1153-1"><a href="模型选择与评估.html#cb1153-1" tabindex="-1"></a><span class="co"># 输出模型平均结果</span></span>
<span id="cb1153-2"><a href="模型选择与评估.html#cb1153-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 贝叶斯模型平均结果 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 贝叶斯模型平均结果 ===</code></pre>
<div class="sourceCode" id="cb1155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1155-1"><a href="模型选择与评估.html#cb1155-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(bma_result))</span></code></pre></div>
<pre><code>## Mean no. regressors               Draws             Burnins                Time 
##            &quot;2.9445&quot;                 &quot;8&quot;                 &quot;0&quot;  &quot;0.009158134 secs&quot; 
##  No. models visited      Modelspace 2^K           % visited         % Topmodels 
##                 &quot;8&quot;                 &quot;8&quot;               &quot;100&quot;               &quot;100&quot; 
##            Corr PMP            No. Obs.         Model Prior             g-Prior 
##                &quot;NA&quot;                &quot;80&quot;      &quot;random / 1.5&quot;               &quot;UIP&quot; 
##     Shrinkage-Stats 
##         &quot;Av=0.9877&quot;</code></pre>
<div class="sourceCode" id="cb1157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1157-1"><a href="模型选择与评估.html#cb1157-1" tabindex="-1"></a><span class="co"># 变量后验包含概率</span></span>
<span id="cb1157-2"><a href="模型选择与评估.html#cb1157-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 变量后验包含概率 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 变量后验包含概率 ===</code></pre>
<div class="sourceCode" id="cb1159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1159-1"><a href="模型选择与评估.html#cb1159-1" tabindex="-1"></a><span class="co"># 使用更稳健的方法提取后验包含概率</span></span>
<span id="cb1159-2"><a href="模型选择与评估.html#cb1159-2" tabindex="-1"></a>pip_values <span class="ot">&lt;-</span> <span class="fu">coef</span>(bma_result, <span class="at">order.by.pip =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1159-3"><a href="模型选择与评估.html#cb1159-3" tabindex="-1"></a><span class="cf">if</span> (<span class="st">&quot;pip&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(pip_values)) {</span>
<span id="cb1159-4"><a href="模型选择与评估.html#cb1159-4" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;栖息地面积:&quot;</span>, <span class="fu">round</span>(pip_values[<span class="st">&quot;area&quot;</span>, <span class="st">&quot;pip&quot;</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1159-5"><a href="模型选择与评估.html#cb1159-5" tabindex="-1"></a>    <span class="st">&quot;植被密度:&quot;</span>, <span class="fu">round</span>(pip_values[<span class="st">&quot;vegetation&quot;</span>, <span class="st">&quot;pip&quot;</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1159-6"><a href="模型选择与评估.html#cb1159-6" tabindex="-1"></a>    <span class="st">&quot;距水源距离:&quot;</span>, <span class="fu">round</span>(pip_values[<span class="st">&quot;water_distance&quot;</span>, <span class="st">&quot;pip&quot;</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1159-7"><a href="模型选择与评估.html#cb1159-7" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1159-8"><a href="模型选择与评估.html#cb1159-8" tabindex="-1"></a>  <span class="co"># 备用方法：直接使用bma_result$pip</span></span>
<span id="cb1159-9"><a href="模型选择与评估.html#cb1159-9" tabindex="-1"></a>  pip <span class="ot">&lt;-</span> bma_result<span class="sc">$</span>pip</span>
<span id="cb1159-10"><a href="模型选择与评估.html#cb1159-10" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.numeric</span>(pip) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>(pip) <span class="sc">&gt;=</span> <span class="dv">3</span>) {</span>
<span id="cb1159-11"><a href="模型选择与评估.html#cb1159-11" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;栖息地面积:&quot;</span>, <span class="fu">round</span>(pip[<span class="dv">1</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1159-12"><a href="模型选择与评估.html#cb1159-12" tabindex="-1"></a>      <span class="st">&quot;植被密度:&quot;</span>, <span class="fu">round</span>(pip[<span class="dv">2</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb1159-13"><a href="模型选择与评估.html#cb1159-13" tabindex="-1"></a>      <span class="st">&quot;距水源距离:&quot;</span>, <span class="fu">round</span>(pip[<span class="dv">3</span>], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1159-14"><a href="模型选择与评估.html#cb1159-14" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb1159-15"><a href="模型选择与评估.html#cb1159-15" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;无法提取后验包含概率，请检查BMS包版本</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1159-16"><a href="模型选择与评估.html#cb1159-16" tabindex="-1"></a>  }</span>
<span id="cb1159-17"><a href="模型选择与评估.html#cb1159-17" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 无法提取后验包含概率，请检查BMS包版本</code></pre>
<p>后验包含概率的解释标准为：后验包含概率大于0.5表示变量很可能重要，大于0.75表示变量很可能非常重要，大于0.95表示变量几乎确定重要。</p>
</div>
<div id="贝叶斯预测评估" class="section level3 hasAnchor" number="9.4.8">
<h3><span class="header-section-number">9.4.8</span> 贝叶斯预测评估<a href="模型选择与评估.html#贝叶斯预测评估" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯方法通过后验预测分布提供完整的预测不确定性量化：</p>
<div class="sourceCode" id="cb1161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1161-1"><a href="模型选择与评估.html#cb1161-1" tabindex="-1"></a><span class="co"># 贝叶斯预测评估演示</span></span>
<span id="cb1161-2"><a href="模型选择与评估.html#cb1161-2" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb1161-3"><a href="模型选择与评估.html#cb1161-3" tabindex="-1"></a></span>
<span id="cb1161-4"><a href="模型选择与评估.html#cb1161-4" tabindex="-1"></a><span class="co"># 使用brms进行贝叶斯泊松回归</span></span>
<span id="cb1161-5"><a href="模型选择与评估.html#cb1161-5" tabindex="-1"></a><span class="co"># 注意：这里使用简化版本，实际应用需要更多MCMC迭代</span></span>
<span id="cb1161-6"><a href="模型选择与评估.html#cb1161-6" tabindex="-1"></a></span>
<span id="cb1161-7"><a href="模型选择与评估.html#cb1161-7" tabindex="-1"></a><span class="co"># 拟合贝叶斯泊松回归模型</span></span>
<span id="cb1161-8"><a href="模型选择与评估.html#cb1161-8" tabindex="-1"></a>bayes_poisson <span class="ot">&lt;-</span> <span class="fu">brm</span>(richness <span class="sc">~</span> area <span class="sc">+</span> vegetation <span class="sc">+</span> water_distance,</span>
<span id="cb1161-9"><a href="模型选择与评估.html#cb1161-9" tabindex="-1"></a>  <span class="at">data =</span> bird_data_bayes,</span>
<span id="cb1161-10"><a href="模型选择与评估.html#cb1161-10" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(),</span>
<span id="cb1161-11"><a href="模型选择与评估.html#cb1161-11" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb1161-12"><a href="模型选择与评估.html#cb1161-12" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.5</span>), <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb1161-13"><a href="模型选择与评估.html#cb1161-13" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>)</span>
<span id="cb1161-14"><a href="模型选择与评估.html#cb1161-14" tabindex="-1"></a>  ),</span>
<span id="cb1161-15"><a href="模型选择与评估.html#cb1161-15" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1161-16"><a href="模型选择与评估.html#cb1161-16" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">1234</span></span>
<span id="cb1161-17"><a href="模型选择与评估.html#cb1161-17" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 
## SAMPLING FOR MODEL &#39;anon_model&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 1.7e-05 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.17 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
## Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
## Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 0.074 seconds (Warm-up)
## Chain 1:                0.049 seconds (Sampling)
## Chain 1:                0.123 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;anon_model&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 7e-06 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.07 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
## Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
## Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
## Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
## Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
## Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
## Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
## Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
## Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
## Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
## Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
## Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 0.074 seconds (Warm-up)
## Chain 2:                0.047 seconds (Sampling)
## Chain 2:                0.121 seconds (Total)
## Chain 2:</code></pre>
<div class="sourceCode" id="cb1163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1163-1"><a href="模型选择与评估.html#cb1163-1" tabindex="-1"></a><span class="co"># 后验预测分布</span></span>
<span id="cb1163-2"><a href="模型选择与评估.html#cb1163-2" tabindex="-1"></a>posterior_predictive <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(bayes_poisson)</span>
<span id="cb1163-3"><a href="模型选择与评估.html#cb1163-3" tabindex="-1"></a></span>
<span id="cb1163-4"><a href="模型选择与评估.html#cb1163-4" tabindex="-1"></a><span class="co"># 计算预测统计量</span></span>
<span id="cb1163-5"><a href="模型选择与评估.html#cb1163-5" tabindex="-1"></a>pred_mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(posterior_predictive, <span class="dv">2</span>, mean)</span>
<span id="cb1163-6"><a href="模型选择与评估.html#cb1163-6" tabindex="-1"></a>pred_ci <span class="ot">&lt;-</span> <span class="fu">apply</span>(posterior_predictive, <span class="dv">2</span>, quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb1163-7"><a href="模型选择与评估.html#cb1163-7" tabindex="-1"></a></span>
<span id="cb1163-8"><a href="模型选择与评估.html#cb1163-8" tabindex="-1"></a><span class="co"># 可视化预测不确定性</span></span>
<span id="cb1163-9"><a href="模型选择与评估.html#cb1163-9" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1163-10"><a href="模型选择与评估.html#cb1163-10" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1163-11"><a href="模型选择与评估.html#cb1163-11" tabindex="-1"></a>  <span class="at">Observed =</span> bird_data_bayes<span class="sc">$</span>richness,</span>
<span id="cb1163-12"><a href="模型选择与评估.html#cb1163-12" tabindex="-1"></a>  <span class="at">Predicted =</span> pred_mean,</span>
<span id="cb1163-13"><a href="模型选择与评估.html#cb1163-13" tabindex="-1"></a>  <span class="at">Lower =</span> pred_ci[<span class="dv">1</span>, ],</span>
<span id="cb1163-14"><a href="模型选择与评估.html#cb1163-14" tabindex="-1"></a>  <span class="at">Upper =</span> pred_ci[<span class="dv">2</span>, ]</span>
<span id="cb1163-15"><a href="模型选择与评估.html#cb1163-15" tabindex="-1"></a>)</span>
<span id="cb1163-16"><a href="模型选择与评估.html#cb1163-16" tabindex="-1"></a></span>
<span id="cb1163-17"><a href="模型选择与评估.html#cb1163-17" tabindex="-1"></a><span class="fu">ggplot</span>(pred_data, <span class="fu">aes</span>(<span class="at">x =</span> Observed, <span class="at">y =</span> Predicted)) <span class="sc">+</span></span>
<span id="cb1163-18"><a href="模型选择与评估.html#cb1163-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1163-19"><a href="模型选择与评估.html#cb1163-19" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Lower, <span class="at">ymax =</span> Upper), <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1163-20"><a href="模型选择与评估.html#cb1163-20" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb1163-21"><a href="模型选择与评估.html#cb1163-21" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb1163-22"><a href="模型选择与评估.html#cb1163-22" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;贝叶斯预测：观测值 vs 预测值&quot;</span>,</span>
<span id="cb1163-23"><a href="模型选择与评估.html#cb1163-23" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;观测鸟类丰富度&quot;</span>,</span>
<span id="cb1163-24"><a href="模型选择与评估.html#cb1163-24" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;预测鸟类丰富度&quot;</span></span>
<span id="cb1163-25"><a href="模型选择与评估.html#cb1163-25" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb1163-26"><a href="模型选择与评估.html#cb1163-26" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-39-1"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-39-1.png" alt="贝叶斯预测：观测值与预测值的比较，包含95%预测区间" width="672" />
<p class="caption">
图9.3: 贝叶斯预测：观测值与预测值的比较，包含95%预测区间
</p>
</div>
<div class="sourceCode" id="cb1164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1164-1"><a href="模型选择与评估.html#cb1164-1" tabindex="-1"></a><span class="co"># 后验预测检查</span></span>
<span id="cb1164-2"><a href="模型选择与评估.html#cb1164-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 后验预测检查 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 后验预测检查 ===</code></pre>
<div class="sourceCode" id="cb1166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1166-1"><a href="模型选择与评估.html#cb1166-1" tabindex="-1"></a><span class="co"># 计算后验预测p值</span></span>
<span id="cb1166-2"><a href="模型选择与评估.html#cb1166-2" tabindex="-1"></a>pp_check <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(bayes_poisson)</span>
<span id="cb1166-3"><a href="模型选择与评估.html#cb1166-3" tabindex="-1"></a><span class="fu">print</span>(pp_check)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-39-2"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-39-2.png" alt="贝叶斯预测：观测值与预测值的比较，包含95%预测区间" width="672" />
<p class="caption">
图9.4: 贝叶斯预测：观测值与预测值的比较，包含95%预测区间
</p>
</div>
<div class="sourceCode" id="cb1167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1167-1"><a href="模型选择与评估.html#cb1167-1" tabindex="-1"></a><span class="co"># 解释后验预测检查</span></span>
<span id="cb1167-2"><a href="模型选择与评估.html#cb1167-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">后验预测检查帮助我们验证模型是否能够生成与观测数据相似的数据。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 后验预测检查帮助我们验证模型是否能够生成与观测数据相似的数据。</code></pre>
<div class="sourceCode" id="cb1169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1169-1"><a href="模型选择与评估.html#cb1169-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;如果模型拟合良好，后验预测分布应该与观测数据分布相似。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 如果模型拟合良好，后验预测分布应该与观测数据分布相似。</code></pre>
</div>
<div id="贝叶斯变量选择" class="section level3 hasAnchor" number="9.4.9">
<h3><span class="header-section-number">9.4.9</span> 贝叶斯变量选择<a href="模型选择与评估.html#贝叶斯变量选择" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯变量选择通过稀疏先验自动进行变量选择：</p>
<div class="sourceCode" id="cb1171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1171-1"><a href="模型选择与评估.html#cb1171-1" tabindex="-1"></a><span class="co"># 贝叶斯变量选择演示</span></span>
<span id="cb1171-2"><a href="模型选择与评估.html#cb1171-2" tabindex="-1"></a><span class="fu">library</span>(monomvn)</span>
<span id="cb1171-3"><a href="模型选择与评估.html#cb1171-3" tabindex="-1"></a></span>
<span id="cb1171-4"><a href="模型选择与评估.html#cb1171-4" tabindex="-1"></a><span class="co"># 使用贝叶斯LASSO进行变量选择</span></span>
<span id="cb1171-5"><a href="模型选择与评估.html#cb1171-5" tabindex="-1"></a><span class="co"># 注意：这里使用连续响应的简化版本</span></span>
<span id="cb1171-6"><a href="模型选择与评估.html#cb1171-6" tabindex="-1"></a></span>
<span id="cb1171-7"><a href="模型选择与评估.html#cb1171-7" tabindex="-1"></a><span class="co"># 创建包含冗余变量的扩展数据集</span></span>
<span id="cb1171-8"><a href="模型选择与评估.html#cb1171-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6060</span>)</span>
<span id="cb1171-9"><a href="模型选择与评估.html#cb1171-9" tabindex="-1"></a>bird_data_extended <span class="ot">&lt;-</span> bird_data_bayes</span>
<span id="cb1171-10"><a href="模型选择与评估.html#cb1171-10" tabindex="-1"></a>bird_data_extended<span class="sc">$</span>redundant1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># 冗余变量1</span></span>
<span id="cb1171-11"><a href="模型选择与评估.html#cb1171-11" tabindex="-1"></a>bird_data_extended<span class="sc">$</span>redundant2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># 冗余变量2</span></span>
<span id="cb1171-12"><a href="模型选择与评估.html#cb1171-12" tabindex="-1"></a></span>
<span id="cb1171-13"><a href="模型选择与评估.html#cb1171-13" tabindex="-1"></a><span class="co"># 贝叶斯LASSO变量选择</span></span>
<span id="cb1171-14"><a href="模型选择与评估.html#cb1171-14" tabindex="-1"></a><span class="co"># 使用monomvn包的blasso函数</span></span>
<span id="cb1171-15"><a href="模型选择与评估.html#cb1171-15" tabindex="-1"></a>blasso_result <span class="ot">&lt;-</span> <span class="fu">blasso</span>(</span>
<span id="cb1171-16"><a href="模型选择与评估.html#cb1171-16" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">as.matrix</span>(bird_data_extended[, <span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb1171-17"><a href="模型选择与评估.html#cb1171-17" tabindex="-1"></a>  <span class="at">y =</span> bird_data_extended<span class="sc">$</span>richness,</span>
<span id="cb1171-18"><a href="模型选择与评估.html#cb1171-18" tabindex="-1"></a>  <span class="at">T =</span> <span class="dv">5000</span>, <span class="at">verb =</span> <span class="dv">0</span></span>
<span id="cb1171-19"><a href="模型选择与评估.html#cb1171-19" tabindex="-1"></a>)</span>
<span id="cb1171-20"><a href="模型选择与评估.html#cb1171-20" tabindex="-1"></a></span>
<span id="cb1171-21"><a href="模型选择与评估.html#cb1171-21" tabindex="-1"></a><span class="co"># 提取后验包含概率</span></span>
<span id="cb1171-22"><a href="模型选择与评估.html#cb1171-22" tabindex="-1"></a>posterior_inclusion <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(blasso_result<span class="sc">$</span>beta <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb1171-23"><a href="模型选择与评估.html#cb1171-23" tabindex="-1"></a></span>
<span id="cb1171-24"><a href="模型选择与评估.html#cb1171-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 贝叶斯LASSO变量选择结果 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 贝叶斯LASSO变量选择结果 ===</code></pre>
<div class="sourceCode" id="cb1173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1173-1"><a href="模型选择与评估.html#cb1173-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(posterior_inclusion)) {</span>
<span id="cb1173-2"><a href="模型选择与评估.html#cb1173-2" tabindex="-1"></a>  <span class="fu">cat</span>(</span>
<span id="cb1173-3"><a href="模型选择与评估.html#cb1173-3" tabindex="-1"></a>    <span class="fu">names</span>(posterior_inclusion)[i], <span class="st">&quot;:&quot;</span>,</span>
<span id="cb1173-4"><a href="模型选择与评估.html#cb1173-4" tabindex="-1"></a>    <span class="fu">round</span>(posterior_inclusion[i], <span class="dv">3</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb1173-5"><a href="模型选择与评估.html#cb1173-5" tabindex="-1"></a>  )</span>
<span id="cb1173-6"><a href="模型选择与评估.html#cb1173-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## b.1 : 1 
## b.2 : 0.928 
## b.3 : 0.999 
## b.4 : 0.974 
## b.5 : 0.263</code></pre>
<p>贝叶斯LASSO通过Laplace先验自动进行变量选择，后验包含概率反映了每个变量被包含在模型中的概率。真实变量应该具有较高的后验包含概率，而冗余变量应该具有较低的概率。</p>
</div>
<div id="生态学应用价值" class="section level3 hasAnchor" number="9.4.10">
<h3><span class="header-section-number">9.4.10</span> 生态学应用价值<a href="模型选择与评估.html#生态学应用价值" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯模型选择与评估在生态学中具有重要的应用价值：</p>
<p><strong>1. 小样本情况下的稳健性</strong> - 贝叶斯方法在小样本情况下通常比频率学派方法更稳健 - 通过合理选择先验分布，可以整合领域知识</p>
<p><strong>2. 不确定性量化</strong> - 贝叶斯方法提供完整的后验分布，而非点估计 - 预测不确定性完全量化，便于风险评估</p>
<p><strong>3. 模型不确定性整合</strong> - 贝叶斯模型平均整合了模型选择的不确定性 - 避免了”赢者通吃”的问题</p>
<p><strong>4. 生态学解释性</strong> - 后验概率提供了更直观的生态学解释 - 变量重要性基于后验包含概率，而非p值</p>
<p><strong>5. 复杂模型的适应性</strong> - 贝叶斯方法特别适合复杂生态模型 - 可以处理层次结构、时空相关性等复杂特征</p>
</div>
<div id="贝叶斯检验的生态学应用案例" class="section level3 hasAnchor" number="9.4.11">
<h3><span class="header-section-number">9.4.11</span> 贝叶斯检验的生态学应用案例<a href="模型选择与评估.html#贝叶斯检验的生态学应用案例" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯方法在生态学研究中具有广泛的应用价值，特别是在处理复杂生态模型、整合多源数据和量化不确定性方面展现出独特优势。以下是三个典型的生态学应用案例：</p>
<p><strong>案例1：物种分布模型与环境因子分析</strong></p>
<p>物种分布模型是生态学中应用贝叶斯方法的经典场景，能够同时处理观测误差、环境异质性和参数不确定性。</p>
<p><strong>案例2：种群动态的状态空间模型</strong></p>
<p>贝叶斯状态空间模型能够分离过程误差和观测误差，重建真实的种群动态轨迹。</p>
<p><strong>案例3：群落生态学的多元分析</strong></p>
<p>在群落生态学中，贝叶斯方法可以处理多物种响应，量化物种间的变异和共性。</p>
<p>这些案例展示了贝叶斯方法在生态学不同领域的强大应用能力：</p>
<ol style="list-style-type: decimal">
<li><strong>物种分布模型</strong>：处理存在-缺失数据，量化环境因子的不确定性</li>
<li><strong>种群动态分析</strong>：分离过程误差和观测误差，重建真实种群轨迹</li>
<li><strong>群落生态学</strong>：处理多物种响应，量化物种间的变异和共性</li>
</ol>
<p>贝叶斯方法的优势在于能够： - 明确量化所有参数的不确定性 - 整合先验知识和观测数据 - 处理复杂的层次结构和随机效应 - 提供完整的后验分布而非点估计</p>
<p>这些特性使得贝叶斯方法特别适合处理生态学中常见的小样本、复杂结构和高度不确定性问题。</p>
</div>
<div id="贝叶斯方法的局限性" class="section level3 hasAnchor" number="9.4.12">
<h3><span class="header-section-number">9.4.12</span> 贝叶斯方法的局限性<a href="模型选择与评估.html#贝叶斯方法的局限性" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>尽管贝叶斯方法具有诸多优势，但也存在一些局限性：</p>
<p><strong>1. 计算复杂性</strong> - MCMC采样计算成本较高 - 需要专业知识设置先验和诊断收敛</p>
<p><strong>2. 先验选择敏感性</strong> - 结果可能对先验分布选择敏感 - 需要谨慎选择合理的先验</p>
<p><strong>3. 收敛诊断</strong> - 需要仔细检查MCMC链的收敛性 - 诊断工具相对复杂</p>
<p><strong>4. 软件学习曲线</strong> - 贝叶斯软件（Stan、JAGS）学习曲线较陡 - 需要掌握新的编程范式</p>
<p>在生态学研究中，贝叶斯方法和频率学派方法各有优势。理想的做法是根据具体研究问题和数据特征选择合适的方法，或者在可能的情况下同时使用两种方法进行交叉验证。</p>
</div>
</div>
<div id="总结-8" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> 总结<a href="模型选择与评估.html#总结-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="综合练习-7" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> 综合练习<a href="模型选择与评估.html#综合练习-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="简单线性回归模型.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="高级回归模型.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": false,
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["ecological-statistics.pdf", "ecological-statistics.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
