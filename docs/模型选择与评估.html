<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 模型选择与评估 | 生态统计学</title>
  <meta name="description" content="9 模型选择与评估 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  <meta name="generator" content="bookdown 0.44 and GitBook 2.6.7" />

  <meta property="og:title" content="9 模型选择与评估 | 生态统计学" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="9 模型选择与评估 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 模型选择与评估 | 生态统计学" />
  
  <meta name="twitter:description" content="9 模型选择与评估 | 生态统计学课程教材，涵盖从基础到高级的生态数据分析方法" />
  

<meta name="author" content="沈国春、李勤" />


<meta name="date" content="2025-10-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="线性回归模型.html"/>
<link rel="next" href="高级回归模型.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7cbaf067c715044120ee231397e9ace3";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">生态统计学AI+</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#为什么"><i class="fa fa-check"></i><b>0.1</b> 为什么</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#在不确定的世界中寻找规律"><i class="fa fa-check"></i><b>0.1.1</b> 在不确定的世界中寻找规律</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#ai时代的机遇与陷阱"><i class="fa fa-check"></i><b>0.1.2</b> AI时代的机遇与陷阱</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#本书介绍"><i class="fa fa-check"></i><b>0.2</b> 本书介绍</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#本书特色与教学理念"><i class="fa fa-check"></i><b>0.2.1</b> 本书特色与教学理念</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#课程在线资源"><i class="fa fa-check"></i><b>0.3</b> 课程在线资源</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#学习方式"><i class="fa fa-check"></i><b>0.4</b> 学习方式</a>
<ul>
<li class="chapter" data-level="0.4.1" data-path="index.html"><a href="index.html#持续学习r语言的重要性"><i class="fa fa-check"></i><b>0.4.1</b> 持续学习R语言的重要性</a></li>
<li class="chapter" data-level="0.4.2" data-path="index.html"><a href="index.html#在错误中快速成长"><i class="fa fa-check"></i><b>0.4.2</b> 在错误中快速成长</a></li>
<li class="chapter" data-level="0.4.3" data-path="index.html"><a href="index.html#实践导向的学习策略"><i class="fa fa-check"></i><b>0.4.3</b> 实践导向的学习策略</a></li>
<li class="chapter" data-level="0.4.4" data-path="index.html"><a href="index.html#正确的上课姿势"><i class="fa fa-check"></i><b>0.4.4</b> 正确的上课姿势</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="index.html"><a href="index.html#重复本书例子"><i class="fa fa-check"></i><b>0.5</b> 重复本书例子</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html"><i class="fa fa-check"></i><b>1</b> AI辅助编程基础</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#引言"><i class="fa fa-check"></i><b>1.1</b> 引言</a></li>
<li class="chapter" data-level="1.2" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#核心能力培养框架"><i class="fa fa-check"></i><b>1.2</b> 核心能力培养框架</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#高阶思维与问题解决能力"><i class="fa fa-check"></i><b>1.2.1</b> 高阶思维与问题解决能力</a></li>
<li class="chapter" data-level="1.2.2" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#与llm协同工作的能力"><i class="fa fa-check"></i><b>1.2.2</b> 与LLM协同工作的能力</a></li>
<li class="chapter" data-level="1.2.3" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#传统但愈发重要的软技能"><i class="fa fa-check"></i><b>1.2.3</b> 传统但愈发重要的软技能</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#通用编程思维基础"><i class="fa fa-check"></i><b>1.3</b> 通用编程思维基础</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#编程核心概念"><i class="fa fa-check"></i><b>1.3.1</b> 编程核心概念</a></li>
<li class="chapter" data-level="1.3.2" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#算法复杂度"><i class="fa fa-check"></i><b>1.3.2</b> 算法复杂度</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#ai协同编程技能"><i class="fa fa-check"></i><b>1.4</b> AI协同编程技能</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#ai编程模块安装"><i class="fa fa-check"></i><b>1.4.1</b> AI编程模块安装</a></li>
<li class="chapter" data-level="1.4.2" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#精准提问技巧"><i class="fa fa-check"></i><b>1.4.2</b> 精准提问技巧</a></li>
<li class="chapter" data-level="1.4.3" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#代码审查能力"><i class="fa fa-check"></i><b>1.4.3</b> 代码审查能力</a></li>
<li class="chapter" data-level="1.4.4" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#调试与错误处理"><i class="fa fa-check"></i><b>1.4.4</b> 调试与错误处理</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#总结"><i class="fa fa-check"></i><b>1.5</b> 总结</a></li>
<li class="chapter" data-level="1.6" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#综合练习"><i class="fa fa-check"></i><b>1.6</b> 综合练习</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="ai辅助编程基础.html"><a href="ai辅助编程基础.html#练习1"><i class="fa fa-check"></i><b>1.6.1</b> 练习1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="概率与分布.html"><a href="概率与分布.html"><i class="fa fa-check"></i><b>2</b> 概率与分布</a>
<ul>
<li class="chapter" data-level="2.1" data-path="概率与分布.html"><a href="概率与分布.html#引言-1"><i class="fa fa-check"></i><b>2.1</b> 引言</a></li>
<li class="chapter" data-level="2.2" data-path="概率与分布.html"><a href="概率与分布.html#蚂蚱午餐与概率"><i class="fa fa-check"></i><b>2.2</b> 蚂蚱午餐与概率</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="概率与分布.html"><a href="概率与分布.html#一只蚱蜢的午餐"><i class="fa fa-check"></i><b>2.2.1</b> 一只蚱蜢的午餐</a></li>
<li class="chapter" data-level="2.2.2" data-path="概率与分布.html"><a href="概率与分布.html#理想的猜测古典概率"><i class="fa fa-check"></i><b>2.2.2</b> 理想的猜测——古典概率</a></li>
<li class="chapter" data-level="2.2.3" data-path="概率与分布.html"><a href="概率与分布.html#数据的语言频率概率"><i class="fa fa-check"></i><b>2.2.3</b> 数据的语言——频率概率</a></li>
<li class="chapter" data-level="2.2.4" data-path="概率与分布.html"><a href="概率与分布.html#动态的更新贝叶斯概率"><i class="fa fa-check"></i><b>2.2.4</b> 动态的更新——贝叶斯概率</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="概率与分布.html"><a href="概率与分布.html#随机变量与分布"><i class="fa fa-check"></i><b>2.3</b> 随机变量与分布</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="概率与分布.html"><a href="概率与分布.html#随机变量"><i class="fa fa-check"></i><b>2.3.1</b> 随机变量</a></li>
<li class="chapter" data-level="2.3.2" data-path="概率与分布.html"><a href="概率与分布.html#概率分布"><i class="fa fa-check"></i><b>2.3.2</b> 概率分布</a></li>
<li class="chapter" data-level="2.3.3" data-path="概率与分布.html"><a href="概率与分布.html#累积概率分布从可能性到确定性"><i class="fa fa-check"></i><b>2.3.3</b> 累积概率分布：从可能性到确定性</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="概率与分布.html"><a href="概率与分布.html#午餐菜单离散随机变量的分布家族"><i class="fa fa-check"></i><b>2.4</b> 午餐菜单：离散随机变量的分布家族</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="概率与分布.html"><a href="概率与分布.html#伯努利分布一个是或否的终极问题"><i class="fa fa-check"></i><b>2.4.1</b> 伯努利分布：一个“是”或“否”的终极问题</a></li>
<li class="chapter" data-level="2.4.2" data-path="概率与分布.html"><a href="概率与分布.html#二项分布重复是非题的计数法则"><i class="fa fa-check"></i><b>2.4.2</b> 二项分布：重复“是非题”的计数法则</a></li>
<li class="chapter" data-level="2.4.3" data-path="概率与分布.html"><a href="概率与分布.html#多项式分布多元选择的全景图"><i class="fa fa-check"></i><b>2.4.3</b> 多项式分布：多元选择的“全景图”</a></li>
<li class="chapter" data-level="2.4.4" data-path="概率与分布.html"><a href="概率与分布.html#泊松分布罕见事件的低语者"><i class="fa fa-check"></i><b>2.4.4</b> 泊松分布：罕见事件的“低语者”</a></li>
<li class="chapter" data-level="2.4.5" data-path="概率与分布.html"><a href="概率与分布.html#几何分布等待第一次成功的耐心"><i class="fa fa-check"></i><b>2.4.5</b> 几何分布：等待“第一次成功”的耐心</a></li>
<li class="chapter" data-level="2.4.6" data-path="概率与分布.html"><a href="概率与分布.html#负二项分布等待最后一次成功的耐心"><i class="fa fa-check"></i><b>2.4.6</b> 负二项分布：等待“最后一次成功”的耐心</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="概率与分布.html"><a href="概率与分布.html#午餐法则连续随机变量的分布家族"><i class="fa fa-check"></i><b>2.5</b> 午餐法则：连续随机变量的分布家族</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="概率与分布.html"><a href="概率与分布.html#均匀分布纯粹的平等"><i class="fa fa-check"></i><b>2.5.1</b> 均匀分布：纯粹的平等</a></li>
<li class="chapter" data-level="2.5.2" data-path="概率与分布.html"><a href="概率与分布.html#指数分布等待的艺术"><i class="fa fa-check"></i><b>2.5.2</b> 指数分布：等待的艺术</a></li>
<li class="chapter" data-level="2.5.3" data-path="概率与分布.html"><a href="概率与分布.html#正态分布高斯分布自然界的钟形法则"><i class="fa fa-check"></i><b>2.5.3</b> 正态分布（高斯分布）：自然界的“钟形”法则</a></li>
<li class="chapter" data-level="2.5.4" data-path="概率与分布.html"><a href="概率与分布.html#威布尔分布生存分析的时间法则"><i class="fa fa-check"></i><b>2.5.4</b> 威布尔分布：生存分析的“时间法则”</a></li>
<li class="chapter" data-level="2.5.5" data-path="概率与分布.html"><a href="概率与分布.html#伽马分布更一般的等待时间模型"><i class="fa fa-check"></i><b>2.5.5</b> 伽马分布：更一般的等待时间模型</a></li>
<li class="chapter" data-level="2.5.6" data-path="概率与分布.html"><a href="概率与分布.html#贝塔分布比例变量的天然选择"><i class="fa fa-check"></i><b>2.5.6</b> 贝塔分布：比例变量的天然选择</a></li>
<li class="chapter" data-level="2.5.7" data-path="概率与分布.html"><a href="概率与分布.html#正态分布的魔力中心极限定理"><i class="fa fa-check"></i><b>2.5.7</b> 正态分布的魔力：中心极限定理</a></li>
<li class="chapter" data-level="2.5.8" data-path="概率与分布.html"><a href="概率与分布.html#生态学应用实例"><i class="fa fa-check"></i><b>2.5.8</b> 生态学应用实例</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="概率与分布.html"><a href="概率与分布.html#混合分布处理异质性数据"><i class="fa fa-check"></i><b>2.6</b> 混合分布：处理异质性数据</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="概率与分布.html"><a href="概率与分布.html#零膨胀分布处理零值过多的数据"><i class="fa fa-check"></i><b>2.6.1</b> 零膨胀分布：处理零值过多的数据</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="概率与分布.html"><a href="概率与分布.html#总结-2"><i class="fa fa-check"></i><b>2.7</b> 总结</a></li>
<li class="chapter" data-level="2.8" data-path="概率与分布.html"><a href="概率与分布.html#综合练习-1"><i class="fa fa-check"></i><b>2.8</b> 综合练习</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="概率与分布.html"><a href="概率与分布.html#练习1蚱蜢觅食行为的概率建模"><i class="fa fa-check"></i><b>2.8.1</b> 练习1：蚱蜢觅食行为的概率建模</a></li>
<li class="chapter" data-level="2.8.2" data-path="概率与分布.html"><a href="概率与分布.html#练习2生存分析与分布拟合"><i class="fa fa-check"></i><b>2.8.2</b> 练习2：生存分析与分布拟合</a></li>
<li class="chapter" data-level="2.8.3" data-path="概率与分布.html"><a href="概率与分布.html#练习3中心极限定理的生态学验证"><i class="fa fa-check"></i><b>2.8.3</b> 练习3：中心极限定理的生态学验证</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="描述统计.html"><a href="描述统计.html"><i class="fa fa-check"></i><b>3</b> 描述统计</a>
<ul>
<li class="chapter" data-level="3.1" data-path="描述统计.html"><a href="描述统计.html#引言-2"><i class="fa fa-check"></i><b>3.1</b> 引言</a></li>
<li class="chapter" data-level="3.2" data-path="描述统计.html"><a href="描述统计.html#描述统计基础"><i class="fa fa-check"></i><b>3.2</b> 描述统计基础</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="描述统计.html"><a href="描述统计.html#中心趋势测量"><i class="fa fa-check"></i><b>3.2.1</b> 中心趋势测量</a></li>
<li class="chapter" data-level="3.2.2" data-path="描述统计.html"><a href="描述统计.html#离散性测量"><i class="fa fa-check"></i><b>3.2.2</b> 离散性测量</a></li>
<li class="chapter" data-level="3.2.3" data-path="描述统计.html"><a href="描述统计.html#分布形状与矩测量"><i class="fa fa-check"></i><b>3.2.3</b> 分布形状与矩测量</a></li>
<li class="chapter" data-level="3.2.4" data-path="描述统计.html"><a href="描述统计.html#统计概念在概率分布图上的可视化"><i class="fa fa-check"></i><b>3.2.4</b> 统计概念在概率分布图上的可视化</a></li>
<li class="chapter" data-level="3.2.5" data-path="描述统计.html"><a href="描述统计.html#标准误的可视化理解"><i class="fa fa-check"></i><b>3.2.5</b> 标准误的可视化理解</a></li>
<li class="chapter" data-level="3.2.6" data-path="描述统计.html"><a href="描述统计.html#不同参数值的分布形状比较"><i class="fa fa-check"></i><b>3.2.6</b> 不同参数值的分布形状比较</a></li>
<li class="chapter" data-level="3.2.7" data-path="描述统计.html"><a href="描述统计.html#生态学意义总结"><i class="fa fa-check"></i><b>3.2.7</b> 生态学意义总结</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="描述统计.html"><a href="描述统计.html#环境异质性描述"><i class="fa fa-check"></i><b>3.3</b> 环境异质性描述</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="描述统计.html"><a href="描述统计.html#环境异质性的概念"><i class="fa fa-check"></i><b>3.3.1</b> 环境异质性的概念</a></li>
<li class="chapter" data-level="3.3.2" data-path="描述统计.html"><a href="描述统计.html#环境异质性的可视化理解"><i class="fa fa-check"></i><b>3.3.2</b> 环境异质性的可视化理解</a></li>
<li class="chapter" data-level="3.3.3" data-path="描述统计.html"><a href="描述统计.html#环境异质性的量化方法"><i class="fa fa-check"></i><b>3.3.3</b> 环境异质性的量化方法</a></li>
<li class="chapter" data-level="3.3.4" data-path="描述统计.html"><a href="描述统计.html#环境异质性的生态学意义"><i class="fa fa-check"></i><b>3.3.4</b> 环境异质性的生态学意义</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="描述统计.html"><a href="描述统计.html#个体特征描述"><i class="fa fa-check"></i><b>3.4</b> 个体特征描述</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="描述统计.html"><a href="描述统计.html#生存函数survival-function"><i class="fa fa-check"></i><b>3.4.1</b> 生存函数（Survival Function）</a></li>
<li class="chapter" data-level="3.4.2" data-path="描述统计.html"><a href="描述统计.html#瞬时死亡风险函数hazard-function"><i class="fa fa-check"></i><b>3.4.2</b> 瞬时死亡风险函数（Hazard Function）</a></li>
<li class="chapter" data-level="3.4.3" data-path="描述统计.html"><a href="描述统计.html#累积风险函数cumulative-hazard-function"><i class="fa fa-check"></i><b>3.4.3</b> 累积风险函数（Cumulative Hazard Function）</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="描述统计.html"><a href="描述统计.html#种群特征描述"><i class="fa fa-check"></i><b>3.5</b> 种群特征描述</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="描述统计.html"><a href="描述统计.html#gini系数"><i class="fa fa-check"></i><b>3.5.1</b> Gini系数</a></li>
<li class="chapter" data-level="3.5.2" data-path="描述统计.html"><a href="描述统计.html#lorenz曲线"><i class="fa fa-check"></i><b>3.5.2</b> Lorenz曲线</a></li>
<li class="chapter" data-level="3.5.3" data-path="描述统计.html"><a href="描述统计.html#基尼系数的生态学应用"><i class="fa fa-check"></i><b>3.5.3</b> 基尼系数的生态学应用</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="描述统计.html"><a href="描述统计.html#群落特征描述"><i class="fa fa-check"></i><b>3.6</b> 群落特征描述</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="描述统计.html"><a href="描述统计.html#物种多样性描述"><i class="fa fa-check"></i><b>3.6.1</b> 物种多样性描述</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="描述统计.html"><a href="描述统计.html#生态网络特征描述"><i class="fa fa-check"></i><b>3.7</b> 生态网络特征描述</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="描述统计.html"><a href="描述统计.html#网络拓扑指标"><i class="fa fa-check"></i><b>3.7.1</b> 网络拓扑指标</a></li>
<li class="chapter" data-level="3.7.2" data-path="描述统计.html"><a href="描述统计.html#食物网特征"><i class="fa fa-check"></i><b>3.7.2</b> 食物网特征</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="描述统计.html"><a href="描述统计.html#稳定性描述"><i class="fa fa-check"></i><b>3.8</b> 稳定性描述</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="描述统计.html"><a href="描述统计.html#抵抗力resistance"><i class="fa fa-check"></i><b>3.8.1</b> 抵抗力（Resistance）</a></li>
<li class="chapter" data-level="3.8.2" data-path="描述统计.html"><a href="描述统计.html#恢复力resilience"><i class="fa fa-check"></i><b>3.8.2</b> 恢复力（Resilience）</a></li>
<li class="chapter" data-level="3.8.3" data-path="描述统计.html"><a href="描述统计.html#持久性persistence"><i class="fa fa-check"></i><b>3.8.3</b> 持久性（Persistence）</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="描述统计.html"><a href="描述统计.html#总结-3"><i class="fa fa-check"></i><b>3.9</b> 总结</a></li>
<li class="chapter" data-level="3.10" data-path="描述统计.html"><a href="描述统计.html#综合练习-2"><i class="fa fa-check"></i><b>3.10</b> 综合练习</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="描述统计.html"><a href="描述统计.html#练习1森林群落多样性分析"><i class="fa fa-check"></i><b>3.10.1</b> 练习1：森林群落多样性分析</a></li>
<li class="chapter" data-level="3.10.2" data-path="描述统计.html"><a href="描述统计.html#练习2生态系统稳定性评估"><i class="fa fa-check"></i><b>3.10.2</b> 练习2：生态系统稳定性评估</a></li>
<li class="chapter" data-level="3.10.3" data-path="描述统计.html"><a href="描述统计.html#练习3种群资源分配与竞争分析"><i class="fa fa-check"></i><b>3.10.3</b> 练习3：种群资源分配与竞争分析</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="参数估计.html"><a href="参数估计.html"><i class="fa fa-check"></i><b>4</b> 参数估计</a>
<ul>
<li class="chapter" data-level="4.1" data-path="参数估计.html"><a href="参数估计.html#引言-3"><i class="fa fa-check"></i><b>4.1</b> 引言</a></li>
<li class="chapter" data-level="4.2" data-path="参数估计.html"><a href="参数估计.html#样本与总体"><i class="fa fa-check"></i><b>4.2</b> 样本与总体</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="参数估计.html"><a href="参数估计.html#抽样方法及其生态学应用"><i class="fa fa-check"></i><b>4.2.1</b> 抽样方法及其生态学应用</a></li>
<li class="chapter" data-level="4.2.2" data-path="参数估计.html"><a href="参数估计.html#r语言中的抽样实现"><i class="fa fa-check"></i><b>4.2.2</b> R语言中的抽样实现</a></li>
<li class="chapter" data-level="4.2.3" data-path="参数估计.html"><a href="参数估计.html#抽样误差与样本量确定"><i class="fa fa-check"></i><b>4.2.3</b> 抽样误差与样本量确定</a></li>
<li class="chapter" data-level="4.2.4" data-path="参数估计.html"><a href="参数估计.html#生态学抽样设计的实践考虑"><i class="fa fa-check"></i><b>4.2.4</b> 生态学抽样设计的实践考虑</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="参数估计.html"><a href="参数估计.html#参数估计基础"><i class="fa fa-check"></i><b>4.3</b> 参数估计基础</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="参数估计.html"><a href="参数估计.html#点估计"><i class="fa fa-check"></i><b>4.3.1</b> 点估计</a></li>
<li class="chapter" data-level="4.3.2" data-path="参数估计.html"><a href="参数估计.html#区间估计"><i class="fa fa-check"></i><b>4.3.2</b> 区间估计</a></li>
<li class="chapter" data-level="4.3.3" data-path="参数估计.html"><a href="参数估计.html#估计方法"><i class="fa fa-check"></i><b>4.3.3</b> 估计方法</a></li>
<li class="chapter" data-level="4.3.4" data-path="参数估计.html"><a href="参数估计.html#估计量性质如何评价一个估计方法的好坏"><i class="fa fa-check"></i><b>4.3.4</b> 估计量性质：如何评价一个估计方法的好坏？</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="参数估计.html"><a href="参数估计.html#种群大小估计"><i class="fa fa-check"></i><b>4.4</b> 种群大小估计</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="参数估计.html"><a href="参数估计.html#标记重捕法"><i class="fa fa-check"></i><b>4.4.1</b> 标记重捕法</a></li>
<li class="chapter" data-level="4.4.2" data-path="参数估计.html"><a href="参数估计.html#面积取样法"><i class="fa fa-check"></i><b>4.4.2</b> 面积取样法</a></li>
<li class="chapter" data-level="4.4.3" data-path="参数估计.html"><a href="参数估计.html#距离抽样法"><i class="fa fa-check"></i><b>4.4.3</b> 距离抽样法</a></li>
<li class="chapter" data-level="4.4.4" data-path="参数估计.html"><a href="参数估计.html#去除法"><i class="fa fa-check"></i><b>4.4.4</b> 去除法</a></li>
<li class="chapter" data-level="4.4.5" data-path="参数估计.html"><a href="参数估计.html#种群大小估计方法的选择与比较"><i class="fa fa-check"></i><b>4.4.5</b> 种群大小估计方法的选择与比较</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="参数估计.html"><a href="参数估计.html#物种多样性估计"><i class="fa fa-check"></i><b>4.5</b> 物种多样性估计</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="参数估计.html"><a href="参数估计.html#外推和内插方法"><i class="fa fa-check"></i><b>4.5.1</b> 外推和内插方法</a></li>
<li class="chapter" data-level="4.5.2" data-path="参数估计.html"><a href="参数估计.html#多样性估计的抽样偏差"><i class="fa fa-check"></i><b>4.5.2</b> 多样性估计的抽样偏差</a></li>
<li class="chapter" data-level="4.5.3" data-path="参数估计.html"><a href="参数估计.html#多样性估计方法的选择与比较"><i class="fa fa-check"></i><b>4.5.3</b> 多样性估计方法的选择与比较</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="参数估计.html"><a href="参数估计.html#总结-4"><i class="fa fa-check"></i><b>4.6</b> 总结</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="参数估计.html"><a href="参数估计.html#参数估计的生态学意义与理论基础"><i class="fa fa-check"></i><b>4.6.1</b> 参数估计的生态学意义与理论基础</a></li>
<li class="chapter" data-level="4.6.2" data-path="参数估计.html"><a href="参数估计.html#点估计与区间估计从单一数值到可信范围"><i class="fa fa-check"></i><b>4.6.2</b> 点估计与区间估计：从单一数值到可信范围</a></li>
<li class="chapter" data-level="4.6.3" data-path="参数估计.html"><a href="参数估计.html#主要估计方法及其生态学应用"><i class="fa fa-check"></i><b>4.6.3</b> 主要估计方法及其生态学应用</a></li>
<li class="chapter" data-level="4.6.4" data-path="参数估计.html"><a href="参数估计.html#种群大小估计生态学实践的核心任务"><i class="fa fa-check"></i><b>4.6.4</b> 种群大小估计：生态学实践的核心任务</a></li>
<li class="chapter" data-level="4.6.5" data-path="参数估计.html"><a href="参数估计.html#物种多样性估计群落生态学的量化基础"><i class="fa fa-check"></i><b>4.6.5</b> 物种多样性估计：群落生态学的量化基础</a></li>
<li class="chapter" data-level="4.6.6" data-path="参数估计.html"><a href="参数估计.html#参数估计在生态学决策中的重要性"><i class="fa fa-check"></i><b>4.6.6</b> 参数估计在生态学决策中的重要性</a></li>
<li class="chapter" data-level="4.6.7" data-path="参数估计.html"><a href="参数估计.html#未来发展方向与挑战"><i class="fa fa-check"></i><b>4.6.7</b> 未来发展方向与挑战</a></li>
<li class="chapter" data-level="4.6.8" data-path="参数估计.html"><a href="参数估计.html#结语"><i class="fa fa-check"></i><b>4.6.8</b> 结语</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="参数估计.html"><a href="参数估计.html#综合练习-3"><i class="fa fa-check"></i><b>4.7</b> 综合练习</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="参数估计.html"><a href="参数估计.html#练习1标记重捕法估计鱼类种群大小"><i class="fa fa-check"></i><b>4.7.1</b> 练习1：标记重捕法估计鱼类种群大小</a></li>
<li class="chapter" data-level="4.7.2" data-path="参数估计.html"><a href="参数估计.html#练习2物种多样性估计与稀有种校正"><i class="fa fa-check"></i><b>4.7.2</b> 练习2：物种多样性估计与稀有种校正</a></li>
<li class="chapter" data-level="4.7.3" data-path="参数估计.html"><a href="参数估计.html#练习3最大似然估计与贝叶斯估计比较"><i class="fa fa-check"></i><b>4.7.3</b> 练习3：最大似然估计与贝叶斯估计比较</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="相关性与相似性.html"><a href="相关性与相似性.html"><i class="fa fa-check"></i><b>5</b> 相关性与相似性</a>
<ul>
<li class="chapter" data-level="5.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#引言-4"><i class="fa fa-check"></i><b>5.1</b> 引言</a></li>
<li class="chapter" data-level="5.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#线性相关性"><i class="fa fa-check"></i><b>5.2</b> 线性相关性</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#pearson相关系数线性关系的度量"><i class="fa fa-check"></i><b>5.2.1</b> Pearson相关系数：线性关系的度量</a></li>
<li class="chapter" data-level="5.2.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#spearman秩相关单调关系的度量"><i class="fa fa-check"></i><b>5.2.2</b> Spearman秩相关：单调关系的度量</a></li>
<li class="chapter" data-level="5.2.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#kendalls-τ基于一致对的比例"><i class="fa fa-check"></i><b>5.2.3</b> Kendall’s τ：基于一致对的比例</a></li>
<li class="chapter" data-level="5.2.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#偏相关分析"><i class="fa fa-check"></i><b>5.2.4</b> 偏相关分析</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#非线性相关"><i class="fa fa-check"></i><b>5.3</b> 非线性相关</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#距离相关"><i class="fa fa-check"></i><b>5.3.1</b> 距离相关</a></li>
<li class="chapter" data-level="5.3.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#互信息"><i class="fa fa-check"></i><b>5.3.2</b> 互信息</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#时间自相关"><i class="fa fa-check"></i><b>5.4</b> 时间自相关</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#生态学中的时间自相关实例"><i class="fa fa-check"></i><b>5.4.1</b> 生态学中的时间自相关实例</a></li>
<li class="chapter" data-level="5.4.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#自相关函数acf时间依赖性的量化"><i class="fa fa-check"></i><b>5.4.2</b> 自相关函数（ACF）：时间依赖性的量化</a></li>
<li class="chapter" data-level="5.4.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#偏自相关函数pacf直接时间依赖的识别"><i class="fa fa-check"></i><b>5.4.3</b> 偏自相关函数（PACF）：直接时间依赖的识别</a></li>
<li class="chapter" data-level="5.4.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#时间序列平稳性分析的基础假设"><i class="fa fa-check"></i><b>5.4.4</b> 时间序列平稳性：分析的基础假设</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#空间自相关"><i class="fa fa-check"></i><b>5.5</b> 空间自相关</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#变异函数variogram空间依赖性的量化"><i class="fa fa-check"></i><b>5.5.1</b> 变异函数（Variogram）：空间依赖性的量化</a></li>
<li class="chapter" data-level="5.5.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#克里金插值基于空间自相关的预测方法"><i class="fa fa-check"></i><b>5.5.2</b> 克里金插值：基于空间自相关的预测方法</a></li>
<li class="chapter" data-level="5.5.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#空间自相关指数全局空间模式的检测"><i class="fa fa-check"></i><b>5.5.3</b> 空间自相关指数：全局空间模式的检测</a></li>
<li class="chapter" data-level="5.5.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#局部空间自相关空间异质性的识别"><i class="fa fa-check"></i><b>5.5.4</b> 局部空间自相关：空间异质性的识别</a></li>
<li class="chapter" data-level="5.5.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#空间平稳性空间分析的基础假设"><i class="fa fa-check"></i><b>5.5.5</b> 空间平稳性：空间分析的基础假设</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育相关性"><i class="fa fa-check"></i><b>5.6</b> 系统发育相关性</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育信号进化历史的印记"><i class="fa fa-check"></i><b>5.6.1</b> 系统发育信号：进化历史的印记</a></li>
<li class="chapter" data-level="5.6.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#系统发育独立对比去除系统发育影响的性状比较"><i class="fa fa-check"></i><b>5.6.2</b> 系统发育独立对比：去除系统发育影响的性状比较</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="相关性与相似性.html"><a href="相关性与相似性.html#群落系统发育结构聚集与分散"><i class="fa fa-check"></i><b>5.7</b> 5.6.3 群落系统发育结构：聚集与分散</a></li>
<li class="chapter" data-level="5.8" data-path="相关性与相似性.html"><a href="相关性与相似性.html#相似性与距离"><i class="fa fa-check"></i><b>5.8</b> 相似性与距离</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#常用相似性系数"><i class="fa fa-check"></i><b>5.8.1</b> 常用相似性系数</a></li>
<li class="chapter" data-level="5.8.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#功能性状间相关性"><i class="fa fa-check"></i><b>5.8.2</b> 功能性状间相关性</a></li>
<li class="chapter" data-level="5.8.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#种内相关性"><i class="fa fa-check"></i><b>5.8.3</b> 种内相关性</a></li>
<li class="chapter" data-level="5.8.4" data-path="相关性与相似性.html"><a href="相关性与相似性.html#种间相关性"><i class="fa fa-check"></i><b>5.8.4</b> 种间相关性</a></li>
<li class="chapter" data-level="5.8.5" data-path="相关性与相似性.html"><a href="相关性与相似性.html#群落相似性"><i class="fa fa-check"></i><b>5.8.5</b> 群落相似性</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="相关性与相似性.html"><a href="相关性与相似性.html#总结-5"><i class="fa fa-check"></i><b>5.9</b> 总结</a></li>
<li class="chapter" data-level="5.10" data-path="相关性与相似性.html"><a href="相关性与相似性.html#综合练习-4"><i class="fa fa-check"></i><b>5.10</b> 综合练习</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="相关性与相似性.html"><a href="相关性与相似性.html#练习一森林生态系统多变量相关性分析"><i class="fa fa-check"></i><b>5.10.1</b> 练习一：森林生态系统多变量相关性分析</a></li>
<li class="chapter" data-level="5.10.2" data-path="相关性与相似性.html"><a href="相关性与相似性.html#练习二鸟类种群时间序列与空间格局分析"><i class="fa fa-check"></i><b>5.10.2</b> 练习二：鸟类种群时间序列与空间格局分析</a></li>
<li class="chapter" data-level="5.10.3" data-path="相关性与相似性.html"><a href="相关性与相似性.html#练习三植物功能性状与系统发育相关性分析"><i class="fa fa-check"></i><b>5.10.3</b> 练习三：植物功能性状与系统发育相关性分析</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html"><i class="fa fa-check"></i><b>6</b> 基于经典分布的假设检验</a>
<ul>
<li class="chapter" data-level="6.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#引言-5"><i class="fa fa-check"></i><b>6.1</b> 引言</a></li>
<li class="chapter" data-level="6.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#梅花鹿保护与假设检验"><i class="fa fa-check"></i><b>6.2</b> 梅花鹿保护与假设检验</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#假设检验的基本步骤"><i class="fa fa-check"></i><b>6.2.1</b> 假设检验的基本步骤</a></li>
<li class="chapter" data-level="6.2.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#零假设与备择假设"><i class="fa fa-check"></i><b>6.2.2</b> 零假设与备择假设</a></li>
<li class="chapter" data-level="6.2.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#检验统计量与p值"><i class="fa fa-check"></i><b>6.2.3</b> 检验统计量与p值</a></li>
<li class="chapter" data-level="6.2.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#显著性水平"><i class="fa fa-check"></i><b>6.2.4</b> 显著性水平</a></li>
<li class="chapter" data-level="6.2.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#效应大小与置信区间"><i class="fa fa-check"></i><b>6.2.5</b> 效应大小与置信区间</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#种群基准单样本检验"><i class="fa fa-check"></i><b>6.3</b> 种群基准：单样本检验</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本t检验"><i class="fa fa-check"></i><b>6.3.1</b> 单样本t检验</a></li>
<li class="chapter" data-level="6.3.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#单样本符号检验"><i class="fa fa-check"></i><b>6.3.2</b> 单样本符号检验</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#保护前后对比双样本检验"><i class="fa fa-check"></i><b>6.4</b> 保护前后对比：双样本检验</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#独立样本t检验"><i class="fa fa-check"></i><b>6.4.1</b> 独立样本t检验</a></li>
<li class="chapter" data-level="6.4.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#配对样本t检验"><i class="fa fa-check"></i><b>6.4.2</b> 配对样本t检验</a></li>
<li class="chapter" data-level="6.4.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#mann-whitney-u检验"><i class="fa fa-check"></i><b>6.4.3</b> Mann-Whitney U检验</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#不同保护区的比较多样本检验"><i class="fa fa-check"></i><b>6.5</b> 不同保护区的比较：多样本检验</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#方差分析anova"><i class="fa fa-check"></i><b>6.5.1</b> 方差分析（ANOVA）</a></li>
<li class="chapter" data-level="6.5.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#kruskal-wallis检验"><i class="fa fa-check"></i><b>6.5.2</b> Kruskal-Wallis检验</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#应对复杂情况非参数检验方法"><i class="fa fa-check"></i><b>6.6</b> 应对复杂情况：非参数检验方法</a></li>
<li class="chapter" data-level="6.7" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#避免决策陷阱多重比较校正"><i class="fa fa-check"></i><b>6.7</b> 避免决策陷阱：多重比较校正</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较问题的本质"><i class="fa fa-check"></i><b>6.7.1</b> 多重比较问题的本质</a></li>
<li class="chapter" data-level="6.7.2" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#bonferroni校正"><i class="fa fa-check"></i><b>6.7.2</b> Bonferroni校正</a></li>
<li class="chapter" data-level="6.7.3" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#tukey-hsd检验"><i class="fa fa-check"></i><b>6.7.3</b> Tukey HSD检验</a></li>
<li class="chapter" data-level="6.7.4" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#fdr错误发现率控制"><i class="fa fa-check"></i><b>6.7.4</b> FDR（错误发现率）控制</a></li>
<li class="chapter" data-level="6.7.5" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#生态学实例不同保护措施对梅花鹿种群的影响"><i class="fa fa-check"></i><b>6.7.5</b> 生态学实例：不同保护措施对梅花鹿种群的影响</a></li>
<li class="chapter" data-level="6.7.6" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#多重比较校正效果的可视化"><i class="fa fa-check"></i><b>6.7.6</b> 多重比较校正效果的可视化</a></li>
<li class="chapter" data-level="6.7.7" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#实用建议与最佳实践"><i class="fa fa-check"></i><b>6.7.7</b> 实用建议与最佳实践</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#保护效果检测功效分析"><i class="fa fa-check"></i><b>6.8</b> 保护效果检测：功效分析</a></li>
<li class="chapter" data-level="6.9" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#总结-6"><i class="fa fa-check"></i><b>6.9</b> 总结</a></li>
<li class="chapter" data-level="6.10" data-path="基于经典分布的假设检验.html"><a href="基于经典分布的假设检验.html#综合练习-5"><i class="fa fa-check"></i><b>6.10</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html"><i class="fa fa-check"></i><b>7</b> 基于模拟的假设检验</a>
<ul>
<li class="chapter" data-level="7.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#引言-6"><i class="fa fa-check"></i><b>7.1</b> 引言</a></li>
<li class="chapter" data-level="7.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学层次与演进脉络"><i class="fa fa-check"></i><b>7.2</b> 方法学层次与演进脉络</a></li>
<li class="chapter" data-level="7.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验"><i class="fa fa-check"></i><b>7.3</b> 置换检验</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验的基本原理"><i class="fa fa-check"></i><b>7.3.1</b> 置换检验的基本原理</a></li>
<li class="chapter" data-level="7.3.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验的技术实现过程"><i class="fa fa-check"></i><b>7.3.2</b> 置换检验的技术实现过程</a></li>
<li class="chapter" data-level="7.3.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例"><i class="fa fa-check"></i><b>7.3.3</b> R语言实现示例</a></li>
<li class="chapter" data-level="7.3.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#置换检验在生态学中的应用价值与局限"><i class="fa fa-check"></i><b>7.3.4</b> 置换检验在生态学中的应用价值与局限</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验"><i class="fa fa-check"></i><b>7.4</b> 蒙特卡洛检验</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛方法的概念体系"><i class="fa fa-check"></i><b>7.4.1</b> 蒙特卡洛方法的概念体系</a></li>
<li class="chapter" data-level="7.4.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验的基本原理"><i class="fa fa-check"></i><b>7.4.2</b> 蒙特卡洛检验的基本原理</a></li>
<li class="chapter" data-level="7.4.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#蒙特卡洛检验的主要类型"><i class="fa fa-check"></i><b>7.4.3</b> 蒙特卡洛检验的主要类型</a></li>
<li class="chapter" data-level="7.4.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例空间分布随机性检验"><i class="fa fa-check"></i><b>7.4.4</b> R语言实现示例：空间分布随机性检验</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法检验"><i class="fa fa-check"></i><b>7.5</b> 自助法检验</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的基本原理"><i class="fa fa-check"></i><b>7.5.1</b> 自助法的基本原理</a></li>
<li class="chapter" data-level="7.5.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的实施步骤"><i class="fa fa-check"></i><b>7.5.2</b> 自助法的实施步骤</a></li>
<li class="chapter" data-level="7.5.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法在生态学中的应用"><i class="fa fa-check"></i><b>7.5.3</b> 自助法在生态学中的应用</a></li>
<li class="chapter" data-level="7.5.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#r语言实现示例-1"><i class="fa fa-check"></i><b>7.5.4</b> R语言实现示例</a></li>
<li class="chapter" data-level="7.5.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#自助法的优势与局限"><i class="fa fa-check"></i><b>7.5.5</b> 自助法的优势与局限</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#基因型频率检验"><i class="fa fa-check"></i><b>7.6</b> 基因型频率检验</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#hardy-weinberg平衡检验"><i class="fa fa-check"></i><b>7.6.1</b> Hardy-Weinberg平衡检验</a></li>
<li class="chapter" data-level="7.6.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#连锁不平衡检验"><i class="fa fa-check"></i><b>7.6.2</b> 连锁不平衡检验</a></li>
<li class="chapter" data-level="7.6.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与选择建议"><i class="fa fa-check"></i><b>7.6.3</b> 方法学比较与选择建议</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#多样性差异检验"><i class="fa fa-check"></i><b>7.7</b> 多样性差异检验</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#群落多样性比较"><i class="fa fa-check"></i><b>7.7.1</b> 群落多样性比较</a></li>
<li class="chapter" data-level="7.7.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#相似性分析anosim"><i class="fa fa-check"></i><b>7.7.2</b> 相似性分析（ANOSIM）</a></li>
<li class="chapter" data-level="7.7.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与生态学应用建议"><i class="fa fa-check"></i><b>7.7.3</b> 方法学比较与生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#物种空间分布检验"><i class="fa fa-check"></i><b>7.8</b> 物种空间分布检验</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#空间分布模式检验"><i class="fa fa-check"></i><b>7.8.1</b> 空间分布模式检验</a></li>
<li class="chapter" data-level="7.8.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#点过程模型检验"><i class="fa fa-check"></i><b>7.8.2</b> 点过程模型检验</a></li>
<li class="chapter" data-level="7.8.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#空间生态学的统计挑战与解决方案"><i class="fa fa-check"></i><b>7.8.3</b> 空间生态学的统计挑战与解决方案</a></li>
<li class="chapter" data-level="7.8.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学应用与保护意义"><i class="fa fa-check"></i><b>7.8.4</b> 生态学应用与保护意义</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育信号检验"><i class="fa fa-check"></i><b>7.9</b> 系统发育信号检验</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育保守性检验"><i class="fa fa-check"></i><b>7.9.1</b> 系统发育保守性检验</a></li>
<li class="chapter" data-level="7.9.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#系统发育独立对比"><i class="fa fa-check"></i><b>7.9.2</b> 系统发育独立对比</a></li>
<li class="chapter" data-level="7.9.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#方法学比较与生态学应用建议-1"><i class="fa fa-check"></i><b>7.9.3</b> 方法学比较与生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学零模型检验"><i class="fa fa-check"></i><b>7.10</b> 生态学零模型检验</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#零模型的基本概念与生态学意义"><i class="fa fa-check"></i><b>7.10.1</b> 零模型的基本概念与生态学意义</a></li>
<li class="chapter" data-level="7.10.2" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#群落组装零模型检验"><i class="fa fa-check"></i><b>7.10.2</b> 群落组装零模型检验</a></li>
<li class="chapter" data-level="7.10.3" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态网络零模型检验"><i class="fa fa-check"></i><b>7.10.3</b> 生态网络零模型检验</a></li>
<li class="chapter" data-level="7.10.4" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#零模型检验的方法学比较与选择"><i class="fa fa-check"></i><b>7.10.4</b> 零模型检验的方法学比较与选择</a></li>
<li class="chapter" data-level="7.10.5" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#生态学应用与保护意义-1"><i class="fa fa-check"></i><b>7.10.5</b> 生态学应用与保护意义</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#总结-7"><i class="fa fa-check"></i><b>7.11</b> 总结</a></li>
<li class="chapter" data-level="7.12" data-path="基于模拟的假设检验.html"><a href="基于模拟的假设检验.html#综合练习-6"><i class="fa fa-check"></i><b>7.12</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="线性回归模型.html"><a href="线性回归模型.html"><i class="fa fa-check"></i><b>8</b> 线性回归模型</a>
<ul>
<li class="chapter" data-level="8.1" data-path="线性回归模型.html"><a href="线性回归模型.html#引言-7"><i class="fa fa-check"></i><b>8.1</b> 引言</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="线性回归模型.html"><a href="线性回归模型.html#为什么需要学习统计建模与预测"><i class="fa fa-check"></i><b>8.1.1</b> 为什么需要学习统计建模与预测？</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="线性回归模型.html"><a href="线性回归模型.html#线性回归模型生态关系的数学表达"><i class="fa fa-check"></i><b>8.2</b> 线性回归模型：生态关系的数学表达</a></li>
<li class="chapter" data-level="8.3" data-path="线性回归模型.html"><a href="线性回归模型.html#最小二乘估计"><i class="fa fa-check"></i><b>8.3</b> 最小二乘估计</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="线性回归模型.html"><a href="线性回归模型.html#r语言中的lm函数详解"><i class="fa fa-check"></i><b>8.3.1</b> R语言中的lm()函数详解</a></li>
<li class="chapter" data-level="8.3.2" data-path="线性回归模型.html"><a href="线性回归模型.html#lm函数的基本语法"><i class="fa fa-check"></i><b>8.3.2</b> lm()函数的基本语法</a></li>
<li class="chapter" data-level="8.3.3" data-path="线性回归模型.html"><a href="线性回归模型.html#模型公式的详细说明"><i class="fa fa-check"></i><b>8.3.3</b> 模型公式的详细说明</a></li>
<li class="chapter" data-level="8.3.4" data-path="线性回归模型.html"><a href="线性回归模型.html#lm函数的返回对象"><i class="fa fa-check"></i><b>8.3.4</b> lm()函数的返回对象</a></li>
<li class="chapter" data-level="8.3.5" data-path="线性回归模型.html"><a href="线性回归模型.html#提取回归结果的常用函数"><i class="fa fa-check"></i><b>8.3.5</b> 提取回归结果的常用函数</a></li>
<li class="chapter" data-level="8.3.6" data-path="线性回归模型.html"><a href="线性回归模型.html#理解summary函数的输出"><i class="fa fa-check"></i><b>8.3.6</b> 理解summary()函数的输出</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="线性回归模型.html"><a href="线性回归模型.html#回归诊断验证模型的生态学合理性"><i class="fa fa-check"></i><b>8.4</b> 回归诊断：验证模型的生态学合理性</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="线性回归模型.html"><a href="线性回归模型.html#回归诊断图的系统解读"><i class="fa fa-check"></i><b>8.4.1</b> 回归诊断图的系统解读</a></li>
<li class="chapter" data-level="8.4.2" data-path="线性回归模型.html"><a href="线性回归模型.html#模型质量的综合评估"><i class="fa fa-check"></i><b>8.4.2</b> 模型质量的综合评估</a></li>
<li class="chapter" data-level="8.4.3" data-path="线性回归模型.html"><a href="线性回归模型.html#生态学诊断问题的应对策略"><i class="fa fa-check"></i><b>8.4.3</b> 生态学诊断问题的应对策略</a></li>
<li class="chapter" data-level="8.4.4" data-path="线性回归模型.html"><a href="线性回归模型.html#生态学应用实例-1"><i class="fa fa-check"></i><b>8.4.4</b> 生态学应用实例</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="线性回归模型.html"><a href="线性回归模型.html#多元线性回归多因子生态关系的综合分析"><i class="fa fa-check"></i><b>8.5</b> 多元线性回归：多因子生态关系的综合分析</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="线性回归模型.html"><a href="线性回归模型.html#多元线性回归的模型公式"><i class="fa fa-check"></i><b>8.5.1</b> 多元线性回归的模型公式</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="线性回归模型.html"><a href="线性回归模型.html#多元线性回归中的变量选择"><i class="fa fa-check"></i><b>8.6</b> 多元线性回归中的变量选择</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="线性回归模型.html"><a href="线性回归模型.html#变量选择的重要性"><i class="fa fa-check"></i><b>8.6.1</b> 变量选择的重要性</a></li>
<li class="chapter" data-level="8.6.2" data-path="线性回归模型.html"><a href="线性回归模型.html#变量选择的基本原则"><i class="fa fa-check"></i><b>8.6.2</b> 变量选择的基本原则</a></li>
<li class="chapter" data-level="8.6.3" data-path="线性回归模型.html"><a href="线性回归模型.html#常用的变量选择方法"><i class="fa fa-check"></i><b>8.6.3</b> 常用的变量选择方法</a></li>
<li class="chapter" data-level="8.6.4" data-path="线性回归模型.html"><a href="线性回归模型.html#r语言中的模型选择实现"><i class="fa fa-check"></i><b>8.6.4</b> R语言中的模型选择实现</a></li>
<li class="chapter" data-level="8.6.5" data-path="线性回归模型.html"><a href="线性回归模型.html#生态学变量选择的实践建议"><i class="fa fa-check"></i><b>8.6.5</b> 生态学变量选择的实践建议</a></li>
<li class="chapter" data-level="8.6.6" data-path="线性回归模型.html"><a href="线性回归模型.html#模型选择的注意事项"><i class="fa fa-check"></i><b>8.6.6</b> 模型选择的注意事项</a></li>
<li class="chapter" data-level="8.6.7" data-path="线性回归模型.html"><a href="线性回归模型.html#完整生态学案例分析森林生态系统与环境因子的关系"><i class="fa fa-check"></i><b>8.6.7</b> 完整生态学案例分析：森林生态系统与环境因子的关系</a></li>
<li class="chapter" data-level="8.6.8" data-path="线性回归模型.html"><a href="线性回归模型.html#完整模型拟合"><i class="fa fa-check"></i><b>8.6.8</b> 完整模型拟合</a></li>
<li class="chapter" data-level="8.6.9" data-path="线性回归模型.html"><a href="线性回归模型.html#变量选择过程"><i class="fa fa-check"></i><b>8.6.9</b> 变量选择过程</a></li>
<li class="chapter" data-level="8.6.10" data-path="线性回归模型.html"><a href="线性回归模型.html#最优模型选择与结果解释"><i class="fa fa-check"></i><b>8.6.10</b> 最优模型选择与结果解释</a></li>
<li class="chapter" data-level="8.6.11" data-path="线性回归模型.html"><a href="线性回归模型.html#模型诊断与假设检验"><i class="fa fa-check"></i><b>8.6.11</b> 模型诊断与假设检验</a></li>
<li class="chapter" data-level="8.6.12" data-path="线性回归模型.html"><a href="线性回归模型.html#模型预测与应用"><i class="fa fa-check"></i><b>8.6.12</b> 模型预测与应用</a></li>
<li class="chapter" data-level="8.6.13" data-path="线性回归模型.html"><a href="线性回归模型.html#模型比较与评估"><i class="fa fa-check"></i><b>8.6.13</b> 模型比较与评估</a></li>
<li class="chapter" data-level="8.6.14" data-path="线性回归模型.html"><a href="线性回归模型.html#生态学解释与模型选择价值"><i class="fa fa-check"></i><b>8.6.14</b> 生态学解释与模型选择价值</a></li>
<li class="chapter" data-level="8.6.15" data-path="线性回归模型.html"><a href="线性回归模型.html#案例分析总结"><i class="fa fa-check"></i><b>8.6.15</b> 案例分析总结</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="线性回归模型.html"><a href="线性回归模型.html#多项式回归非线性生态关系的数学描述"><i class="fa fa-check"></i><b>8.7</b> 多项式回归：非线性生态关系的数学描述</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="线性回归模型.html"><a href="线性回归模型.html#多项式回归模型"><i class="fa fa-check"></i><b>8.7.1</b> 多项式回归模型</a></li>
<li class="chapter" data-level="8.7.2" data-path="线性回归模型.html"><a href="线性回归模型.html#r语言中的多项式回归实现"><i class="fa fa-check"></i><b>8.7.2</b> R语言中的多项式回归实现</a></li>
<li class="chapter" data-level="8.7.3" data-path="线性回归模型.html"><a href="线性回归模型.html#生态学应用实例-2"><i class="fa fa-check"></i><b>8.7.3</b> 生态学应用实例</a></li>
<li class="chapter" data-level="8.7.4" data-path="线性回归模型.html"><a href="线性回归模型.html#多项式回归的生态学意义"><i class="fa fa-check"></i><b>8.7.4</b> 多项式回归的生态学意义</a></li>
<li class="chapter" data-level="8.7.5" data-path="线性回归模型.html"><a href="线性回归模型.html#多项式阶数的选择"><i class="fa fa-check"></i><b>8.7.5</b> 多项式阶数的选择</a></li>
<li class="chapter" data-level="8.7.6" data-path="线性回归模型.html"><a href="线性回归模型.html#多项式回归的注意事项"><i class="fa fa-check"></i><b>8.7.6</b> 多项式回归的注意事项</a></li>
<li class="chapter" data-level="8.7.7" data-path="线性回归模型.html"><a href="线性回归模型.html#过度拟合问题演示"><i class="fa fa-check"></i><b>8.7.7</b> 过度拟合问题演示</a></li>
<li class="chapter" data-level="8.7.8" data-path="线性回归模型.html"><a href="线性回归模型.html#模型可视化与比较"><i class="fa fa-check"></i><b>8.7.8</b> 模型可视化与比较</a></li>
<li class="chapter" data-level="8.7.9" data-path="线性回归模型.html"><a href="线性回归模型.html#统计指标与交叉验证"><i class="fa fa-check"></i><b>8.7.9</b> 统计指标与交叉验证</a></li>
<li class="chapter" data-level="8.7.10" data-path="线性回归模型.html"><a href="线性回归模型.html#生态学应用建议"><i class="fa fa-check"></i><b>8.7.10</b> 生态学应用建议</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="线性回归模型.html"><a href="线性回归模型.html#总结-8"><i class="fa fa-check"></i><b>8.8</b> 总结</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="线性回归模型.html"><a href="线性回归模型.html#研究成果总结"><i class="fa fa-check"></i><b>8.8.1</b> 研究成果总结</a></li>
<li class="chapter" data-level="8.8.2" data-path="线性回归模型.html"><a href="线性回归模型.html#生态学建模的思维转变"><i class="fa fa-check"></i><b>8.8.2</b> 生态学建模的思维转变</a></li>
<li class="chapter" data-level="8.8.3" data-path="线性回归模型.html"><a href="线性回归模型.html#实践价值与生态学意义"><i class="fa fa-check"></i><b>8.8.3</b> 实践价值与生态学意义</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="线性回归模型.html"><a href="线性回归模型.html#综合练习-7"><i class="fa fa-check"></i><b>8.9</b> 综合练习</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="线性回归模型.html"><a href="线性回归模型.html#练习1温度对植物光合作用速率的影响分析"><i class="fa fa-check"></i><b>8.9.1</b> 练习1：温度对植物光合作用速率的影响分析</a></li>
<li class="chapter" data-level="8.9.2" data-path="线性回归模型.html"><a href="线性回归模型.html#练习2森林鸟类多样性的多因子分析"><i class="fa fa-check"></i><b>8.9.2</b> 练习2：森林鸟类多样性的多因子分析</a></li>
<li class="chapter" data-level="8.9.3" data-path="线性回归模型.html"><a href="线性回归模型.html#练习3湖泊生态系统营养级关系的建模"><i class="fa fa-check"></i><b>8.9.3</b> 练习3：湖泊生态系统营养级关系的建模</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="模型选择与评估.html"><a href="模型选择与评估.html"><i class="fa fa-check"></i><b>9</b> 模型选择与评估</a>
<ul>
<li class="chapter" data-level="9.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#引言-8"><i class="fa fa-check"></i><b>9.1</b> 引言</a></li>
<li class="chapter" data-level="9.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型选择"><i class="fa fa-check"></i><b>9.2</b> 模型选择</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型选择原则"><i class="fa fa-check"></i><b>9.2.1</b> 模型选择原则</a></li>
<li class="chapter" data-level="9.2.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#信息准则"><i class="fa fa-check"></i><b>9.2.2</b> 信息准则</a></li>
<li class="chapter" data-level="9.2.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#似然比检验"><i class="fa fa-check"></i><b>9.2.3</b> 似然比检验</a></li>
<li class="chapter" data-level="9.2.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型平均"><i class="fa fa-check"></i><b>9.2.4</b> 模型平均</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型评估"><i class="fa fa-check"></i><b>9.3</b> 模型评估</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#交叉验证"><i class="fa fa-check"></i><b>9.3.1</b> 交叉验证</a></li>
<li class="chapter" data-level="9.3.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#外部验证"><i class="fa fa-check"></i><b>9.3.2</b> 外部验证</a></li>
<li class="chapter" data-level="9.3.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型诊断"><i class="fa fa-check"></i><b>9.3.3</b> 模型诊断</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型选择与评估"><i class="fa fa-check"></i><b>9.4</b> 贝叶斯模型选择与评估</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯与频率学派的根本差异"><i class="fa fa-check"></i><b>9.4.1</b> 贝叶斯与频率学派的根本差异</a></li>
<li class="chapter" data-level="9.4.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型选择基本原理"><i class="fa fa-check"></i><b>9.4.2</b> 贝叶斯模型选择基本原理</a></li>
<li class="chapter" data-level="9.4.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯假设检验流程"><i class="fa fa-check"></i><b>9.4.3</b> 贝叶斯假设检验流程</a></li>
<li class="chapter" data-level="9.4.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型比较与选择"><i class="fa fa-check"></i><b>9.4.4</b> 贝叶斯模型比较与选择</a></li>
<li class="chapter" data-level="9.4.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯可信区间"><i class="fa fa-check"></i><b>9.4.5</b> 贝叶斯可信区间</a></li>
<li class="chapter" data-level="9.4.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯因子计算与解释"><i class="fa fa-check"></i><b>9.4.6</b> 贝叶斯因子计算与解释</a></li>
<li class="chapter" data-level="9.4.7" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯模型平均"><i class="fa fa-check"></i><b>9.4.7</b> 贝叶斯模型平均</a></li>
<li class="chapter" data-level="9.4.8" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯预测评估"><i class="fa fa-check"></i><b>9.4.8</b> 贝叶斯预测评估</a></li>
<li class="chapter" data-level="9.4.9" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯变量选择"><i class="fa fa-check"></i><b>9.4.9</b> 贝叶斯变量选择</a></li>
<li class="chapter" data-level="9.4.10" data-path="模型选择与评估.html"><a href="模型选择与评估.html#生态学应用价值"><i class="fa fa-check"></i><b>9.4.10</b> 生态学应用价值</a></li>
<li class="chapter" data-level="9.4.11" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯检验的生态学应用案例"><i class="fa fa-check"></i><b>9.4.11</b> 贝叶斯检验的生态学应用案例</a></li>
<li class="chapter" data-level="9.4.12" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯方法的局限性"><i class="fa fa-check"></i><b>9.4.12</b> 贝叶斯方法的局限性</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#总结-9"><i class="fa fa-check"></i><b>9.5</b> 总结</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#研究历程的回顾"><i class="fa fa-check"></i><b>9.5.1</b> 研究历程的回顾</a></li>
<li class="chapter" data-level="9.5.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#模型评估的深刻理解"><i class="fa fa-check"></i><b>9.5.2</b> 模型评估的深刻理解</a></li>
<li class="chapter" data-level="9.5.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#贝叶斯方法的新视角"><i class="fa fa-check"></i><b>9.5.3</b> 贝叶斯方法的新视角</a></li>
<li class="chapter" data-level="9.5.4" data-path="模型选择与评估.html"><a href="模型选择与评估.html#生态学研究的方法论启示"><i class="fa fa-check"></i><b>9.5.4</b> 生态学研究的方法论启示</a></li>
<li class="chapter" data-level="9.5.5" data-path="模型选择与评估.html"><a href="模型选择与评估.html#实践应用与保护价值"><i class="fa fa-check"></i><b>9.5.5</b> 实践应用与保护价值</a></li>
<li class="chapter" data-level="9.5.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#研究能力的提升"><i class="fa fa-check"></i><b>9.5.6</b> 研究能力的提升</a></li>
<li class="chapter" data-level="9.5.7" data-path="模型选择与评估.html"><a href="模型选择与评估.html#未来研究方向"><i class="fa fa-check"></i><b>9.5.7</b> 未来研究方向</a></li>
<li class="chapter" data-level="9.5.8" data-path="模型选择与评估.html"><a href="模型选择与评估.html#给生态学本科生的建议"><i class="fa fa-check"></i><b>9.5.8</b> 给生态学本科生的建议</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="模型选择与评估.html"><a href="模型选择与评估.html#综合练习-8"><i class="fa fa-check"></i><b>9.6</b> 综合练习</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="模型选择与评估.html"><a href="模型选择与评估.html#练习一森林生态系统模型选择与评估综合应用"><i class="fa fa-check"></i><b>9.6.1</b> 练习一：森林生态系统模型选择与评估综合应用</a></li>
<li class="chapter" data-level="9.6.2" data-path="模型选择与评估.html"><a href="模型选择与评估.html#练习二贝叶斯模型选择与频率学派方法比较"><i class="fa fa-check"></i><b>9.6.2</b> 练习二：贝叶斯模型选择与频率学派方法比较</a></li>
<li class="chapter" data-level="9.6.3" data-path="模型选择与评估.html"><a href="模型选择与评估.html#练习三模型评估在生态保护决策中的应用"><i class="fa fa-check"></i><b>9.6.3</b> 练习三：模型评估在生态保护决策中的应用</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="高级回归模型.html"><a href="高级回归模型.html"><i class="fa fa-check"></i><b>10</b> 高级回归模型</a>
<ul>
<li class="chapter" data-level="10.1" data-path="高级回归模型.html"><a href="高级回归模型.html#引言-9"><i class="fa fa-check"></i><b>10.1</b> 引言</a></li>
<li class="chapter" data-level="10.2" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型"><i class="fa fa-check"></i><b>10.2</b> 可加性模型</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型的基本原理"><i class="fa fa-check"></i><b>10.2.1</b> 可加性模型的基本原理</a></li>
<li class="chapter" data-level="10.2.2" data-path="高级回归模型.html"><a href="高级回归模型.html#与线性模型的比较"><i class="fa fa-check"></i><b>10.2.2</b> 与线性模型的比较</a></li>
<li class="chapter" data-level="10.2.3" data-path="高级回归模型.html"><a href="高级回归模型.html#常见的平滑函数"><i class="fa fa-check"></i><b>10.2.3</b> 常见的平滑函数</a></li>
<li class="chapter" data-level="10.2.4" data-path="高级回归模型.html"><a href="高级回归模型.html#平滑函数选择的生态学考量"><i class="fa fa-check"></i><b>10.2.4</b> 平滑函数选择的生态学考量</a></li>
<li class="chapter" data-level="10.2.5" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型中的系数概念"><i class="fa fa-check"></i><b>10.2.5</b> 可加性模型中的”系数”概念</a></li>
<li class="chapter" data-level="10.2.6" data-path="高级回归模型.html"><a href="高级回归模型.html#在r中的实现"><i class="fa fa-check"></i><b>10.2.6</b> 在R中的实现</a></li>
<li class="chapter" data-level="10.2.7" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学应用示例"><i class="fa fa-check"></i><b>10.2.7</b> 生态学应用示例</a></li>
<li class="chapter" data-level="10.2.8" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型诊断"><i class="fa fa-check"></i><b>10.2.8</b> 可加性模型诊断</a></li>
<li class="chapter" data-level="10.2.9" data-path="高级回归模型.html"><a href="高级回归模型.html#可加性模型的优势与局限"><i class="fa fa-check"></i><b>10.2.9</b> 可加性模型的优势与局限</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="高级回归模型.html"><a href="高级回归模型.html#广义线性回归"><i class="fa fa-check"></i><b>10.3</b> 广义线性回归</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="高级回归模型.html"><a href="高级回归模型.html#广义线性模型的基本框架"><i class="fa fa-check"></i><b>10.3.1</b> 广义线性模型的基本框架</a></li>
<li class="chapter" data-level="10.3.2" data-path="高级回归模型.html"><a href="高级回归模型.html#与普通线性回归的根本区别"><i class="fa fa-check"></i><b>10.3.2</b> 与普通线性回归的根本区别</a></li>
<li class="chapter" data-level="10.3.3" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的glm实现"><i class="fa fa-check"></i><b>10.3.3</b> R语言中的GLM实现</a></li>
<li class="chapter" data-level="10.3.4" data-path="高级回归模型.html"><a href="高级回归模型.html#常见glm类型及其生态学应用"><i class="fa fa-check"></i><b>10.3.4</b> 常见GLM类型及其生态学应用</a></li>
<li class="chapter" data-level="10.3.5" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与解释"><i class="fa fa-check"></i><b>10.3.5</b> 模型诊断与解释</a></li>
<li class="chapter" data-level="10.3.6" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学意义与注意事项"><i class="fa fa-check"></i><b>10.3.6</b> 生态学意义与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="高级回归模型.html"><a href="高级回归模型.html#广义可加模型"><i class="fa fa-check"></i><b>10.4</b> 广义可加模型</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="高级回归模型.html"><a href="高级回归模型.html#gam的基本原理"><i class="fa fa-check"></i><b>10.4.1</b> GAM的基本原理</a></li>
<li class="chapter" data-level="10.4.2" data-path="高级回归模型.html"><a href="高级回归模型.html#在r中的实现-1"><i class="fa fa-check"></i><b>10.4.2</b> 在R中的实现</a></li>
<li class="chapter" data-level="10.4.3" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学应用示例-1"><i class="fa fa-check"></i><b>10.4.3</b> 生态学应用示例</a></li>
<li class="chapter" data-level="10.4.4" data-path="高级回归模型.html"><a href="高级回归模型.html#gam在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.4.4</b> GAM在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.4.5" data-path="高级回归模型.html"><a href="高级回归模型.html#高级功能"><i class="fa fa-check"></i><b>10.4.5</b> 高级功能</a></li>
<li class="chapter" data-level="10.4.6" data-path="高级回归模型.html"><a href="高级回归模型.html#模型选择与诊断"><i class="fa fa-check"></i><b>10.4.6</b> 模型选择与诊断</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型"><i class="fa fa-check"></i><b>10.5</b> 混合效应模型</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="高级回归模型.html"><a href="高级回归模型.html#固定效应与随机效应的生态学概念"><i class="fa fa-check"></i><b>10.5.1</b> 固定效应与随机效应的生态学概念</a></li>
<li class="chapter" data-level="10.5.2" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型的数学框架"><i class="fa fa-check"></i><b>10.5.2</b> 混合效应模型的数学框架</a></li>
<li class="chapter" data-level="10.5.3" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的混合效应模型实现"><i class="fa fa-check"></i><b>10.5.3</b> R语言中的混合效应模型实现</a></li>
<li class="chapter" data-level="10.5.4" data-path="高级回归模型.html"><a href="高级回归模型.html#固定效应和随机效应的筛选"><i class="fa fa-check"></i><b>10.5.4</b> 固定效应和随机效应的筛选</a></li>
<li class="chapter" data-level="10.5.5" data-path="高级回归模型.html"><a href="高级回归模型.html#混合效应模型在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.5.5</b> 混合效应模型在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.5.6" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项"><i class="fa fa-check"></i><b>10.5.6</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型"><i class="fa fa-check"></i><b>10.6</b> 时空自相关模型</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型与混合效应模型的联系与区别"><i class="fa fa-check"></i><b>10.6.1</b> 时空自相关模型与混合效应模型的联系与区别</a></li>
<li class="chapter" data-level="10.6.2" data-path="高级回归模型.html"><a href="高级回归模型.html#空间自相关与时间自相关的生态学概念"><i class="fa fa-check"></i><b>10.6.2</b> 空间自相关与时间自相关的生态学概念</a></li>
<li class="chapter" data-level="10.6.3" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型的数学框架"><i class="fa fa-check"></i><b>10.6.3</b> 时空自相关模型的数学框架</a></li>
<li class="chapter" data-level="10.6.4" data-path="高级回归模型.html"><a href="高级回归模型.html#时空模型框架的联系与区别"><i class="fa fa-check"></i><b>10.6.4</b> 时空模型框架的联系与区别</a></li>
<li class="chapter" data-level="10.6.5" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的时空自相关模型实现"><i class="fa fa-check"></i><b>10.6.5</b> R语言中的时空自相关模型实现</a></li>
<li class="chapter" data-level="10.6.6" data-path="高级回归模型.html"><a href="高级回归模型.html#时空自相关模型的生态学应用"><i class="fa fa-check"></i><b>10.6.6</b> 时空自相关模型的生态学应用</a></li>
<li class="chapter" data-level="10.6.7" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项-1"><i class="fa fa-check"></i><b>10.6.7</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型"><i class="fa fa-check"></i><b>10.7</b> 结构方程模型</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型的基本框架"><i class="fa fa-check"></i><b>10.7.1</b> 结构方程模型的基本框架</a></li>
<li class="chapter" data-level="10.7.2" data-path="高级回归模型.html"><a href="高级回归模型.html#r语言中的结构方程模型实现"><i class="fa fa-check"></i><b>10.7.2</b> R语言中的结构方程模型实现</a></li>
<li class="chapter" data-level="10.7.3" data-path="高级回归模型.html"><a href="高级回归模型.html#结构方程模型在生态学中的特殊价值"><i class="fa fa-check"></i><b>10.7.3</b> 结构方程模型在生态学中的特殊价值</a></li>
<li class="chapter" data-level="10.7.4" data-path="高级回归模型.html"><a href="高级回归模型.html#模型诊断与注意事项-2"><i class="fa fa-check"></i><b>10.7.4</b> 模型诊断与注意事项</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="高级回归模型.html"><a href="高级回归模型.html#总结-10"><i class="fa fa-check"></i><b>10.8</b> 总结</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="高级回归模型.html"><a href="高级回归模型.html#研究成果总结-1"><i class="fa fa-check"></i><b>10.8.1</b> 研究成果总结</a></li>
<li class="chapter" data-level="10.8.2" data-path="高级回归模型.html"><a href="高级回归模型.html#重要的建模经验"><i class="fa fa-check"></i><b>10.8.2</b> 重要的建模经验</a></li>
<li class="chapter" data-level="10.8.3" data-path="高级回归模型.html"><a href="高级回归模型.html#生态学建模的思维转变-1"><i class="fa fa-check"></i><b>10.8.3</b> 生态学建模的思维转变</a></li>
<li class="chapter" data-level="10.8.4" data-path="高级回归模型.html"><a href="高级回归模型.html#实践价值与生态学意义-1"><i class="fa fa-check"></i><b>10.8.4</b> 实践价值与生态学意义</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="高级回归模型.html"><a href="高级回归模型.html#综合练习-9"><i class="fa fa-check"></i><b>10.9</b> 综合练习</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="机器学习.html"><a href="机器学习.html"><i class="fa fa-check"></i><b>11</b> 机器学习</a>
<ul>
<li class="chapter" data-level="11.1" data-path="机器学习.html"><a href="机器学习.html#引言-10"><i class="fa fa-check"></i><b>11.1</b> 引言</a></li>
<li class="chapter" data-level="11.2" data-path="机器学习.html"><a href="机器学习.html#决策树"><i class="fa fa-check"></i><b>11.2</b> 决策树</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与原理"><i class="fa fa-check"></i><b>11.2.1</b> 基本概念与原理</a></li>
<li class="chapter" data-level="11.2.2" data-path="机器学习.html"><a href="机器学习.html#决策树构建原理"><i class="fa fa-check"></i><b>11.2.2</b> 决策树构建原理</a></li>
<li class="chapter" data-level="11.2.3" data-path="机器学习.html"><a href="机器学习.html#分类树classification-trees"><i class="fa fa-check"></i><b>11.2.3</b> 分类树（Classification Trees）</a></li>
<li class="chapter" data-level="11.2.4" data-path="机器学习.html"><a href="机器学习.html#回归树regression-trees"><i class="fa fa-check"></i><b>11.2.4</b> 回归树（Regression Trees）</a></li>
<li class="chapter" data-level="11.2.5" data-path="机器学习.html"><a href="机器学习.html#分类树与回归树的比较"><i class="fa fa-check"></i><b>11.2.5</b> 分类树与回归树的比较</a></li>
<li class="chapter" data-level="11.2.6" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-3"><i class="fa fa-check"></i><b>11.2.6</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.2.7" data-path="机器学习.html"><a href="机器学习.html#优势与局限"><i class="fa fa-check"></i><b>11.2.7</b> 优势与局限</a></li>
<li class="chapter" data-level="11.2.8" data-path="机器学习.html"><a href="机器学习.html#r代码实现示例"><i class="fa fa-check"></i><b>11.2.8</b> R代码实现示例</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="机器学习.html"><a href="机器学习.html#随机森林"><i class="fa fa-check"></i><b>11.3</b> 随机森林</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="机器学习.html"><a href="机器学习.html#决策树与随机森林的关系"><i class="fa fa-check"></i><b>11.3.1</b> 决策树与随机森林的关系</a></li>
<li class="chapter" data-level="11.3.2" data-path="机器学习.html"><a href="机器学习.html#随机森林的三个随机"><i class="fa fa-check"></i><b>11.3.2</b> 随机森林的三个随机</a></li>
<li class="chapter" data-level="11.3.3" data-path="机器学习.html"><a href="机器学习.html#数学定义与原理"><i class="fa fa-check"></i><b>11.3.3</b> 数学定义与原理</a></li>
<li class="chapter" data-level="11.3.4" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理"><i class="fa fa-check"></i><b>11.3.4</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.3.5" data-path="机器学习.html"><a href="机器学习.html#r代码实现"><i class="fa fa-check"></i><b>11.3.5</b> R代码实现</a></li>
<li class="chapter" data-level="11.3.6" data-path="机器学习.html"><a href="机器学习.html#代码详细说明"><i class="fa fa-check"></i><b>11.3.6</b> 代码详细说明</a></li>
<li class="chapter" data-level="11.3.7" data-path="机器学习.html"><a href="机器学习.html#模型评估与验证"><i class="fa fa-check"></i><b>11.3.7</b> 模型评估与验证</a></li>
<li class="chapter" data-level="11.3.8" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-4"><i class="fa fa-check"></i><b>11.3.8</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.3.9" data-path="机器学习.html"><a href="机器学习.html#生态学应用价值-1"><i class="fa fa-check"></i><b>11.3.9</b> 生态学应用价值</a></li>
<li class="chapter" data-level="11.3.10" data-path="机器学习.html"><a href="机器学习.html#优势与局限的深入分析"><i class="fa fa-check"></i><b>11.3.10</b> 优势与局限的深入分析</a></li>
<li class="chapter" data-level="11.3.11" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望"><i class="fa fa-check"></i><b>11.3.11</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="机器学习.html"><a href="机器学习.html#支持向量机"><i class="fa fa-check"></i><b>11.4</b> 支持向量机</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与几何直觉"><i class="fa fa-check"></i><b>11.4.1</b> 基本概念与几何直觉</a></li>
<li class="chapter" data-level="11.4.2" data-path="机器学习.html"><a href="机器学习.html#数学原理与核心概念"><i class="fa fa-check"></i><b>11.4.2</b> 数学原理与核心概念</a></li>
<li class="chapter" data-level="11.4.3" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理-1"><i class="fa fa-check"></i><b>11.4.3</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.4.4" data-path="机器学习.html"><a href="机器学习.html#r代码实现-1"><i class="fa fa-check"></i><b>11.4.4</b> R代码实现</a></li>
<li class="chapter" data-level="11.4.5" data-path="机器学习.html"><a href="机器学习.html#代码详细说明-1"><i class="fa fa-check"></i><b>11.4.5</b> 代码详细说明</a></li>
<li class="chapter" data-level="11.4.6" data-path="机器学习.html"><a href="机器学习.html#模型评估与验证-1"><i class="fa fa-check"></i><b>11.4.6</b> 模型评估与验证</a></li>
<li class="chapter" data-level="11.4.7" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-5"><i class="fa fa-check"></i><b>11.4.7</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.4.8" data-path="机器学习.html"><a href="机器学习.html#优势与局限-1"><i class="fa fa-check"></i><b>11.4.8</b> 优势与局限</a></li>
<li class="chapter" data-level="11.4.9" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望-1"><i class="fa fa-check"></i><b>11.4.9</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="机器学习.html"><a href="机器学习.html#深度神经网络"><i class="fa fa-check"></i><b>11.5</b> 深度神经网络</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="机器学习.html"><a href="机器学习.html#基本概念与生物学启发"><i class="fa fa-check"></i><b>11.5.1</b> 基本概念与生物学启发</a></li>
<li class="chapter" data-level="11.5.2" data-path="机器学习.html"><a href="机器学习.html#主要神经网络架构"><i class="fa fa-check"></i><b>11.5.2</b> 主要神经网络架构</a></li>
<li class="chapter" data-level="11.5.3" data-path="机器学习.html"><a href="机器学习.html#生动例子阐释原理-2"><i class="fa fa-check"></i><b>11.5.3</b> 生动例子阐释原理</a></li>
<li class="chapter" data-level="11.5.4" data-path="机器学习.html"><a href="机器学习.html#生态学应用实例-6"><i class="fa fa-check"></i><b>11.5.4</b> 生态学应用实例</a></li>
<li class="chapter" data-level="11.5.5" data-path="机器学习.html"><a href="机器学习.html#优势与局限-2"><i class="fa fa-check"></i><b>11.5.5</b> 优势与局限</a></li>
<li class="chapter" data-level="11.5.6" data-path="机器学习.html"><a href="机器学习.html#生态学启示与未来展望-2"><i class="fa fa-check"></i><b>11.5.6</b> 生态学启示与未来展望</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="机器学习.html"><a href="机器学习.html#总结-11"><i class="fa fa-check"></i><b>11.6</b> 总结</a></li>
<li class="chapter" data-level="11.7" data-path="机器学习.html"><a href="机器学习.html#综合练习-10"><i class="fa fa-check"></i><b>11.7</b> 综合练习</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://gitee.com/gcshen/ecological-statistics" target="blank">Gitee</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">生态统计学</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="模型选择与评估" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> 模型选择与评估<a href="模型选择与评估.html#模型选择与评估" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="引言-8" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> 引言<a href="模型选择与评估.html#引言-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>林小雨站在她的研究室里，面对着电脑屏幕上一排排回归模型的结果，陷入了沉思。在过去几个月的研究中，她已经成功建立了多个统计模型：简单线性回归模型揭示了温度与树木生长速率的关系，多元回归模型量化了温度、降水和土壤氮含量对植物生物量的综合影响，多项式回归模型则描绘出物种丰富度随海拔变化的优美曲线。每个模型都讲述着森林生态系统的不同故事，每个模型的统计指标都看起来相当不错。</p>
<p>但现在，她面临着一个新的挑战：在这些候选模型中，哪一个才是最可靠的？哪一个模型的预测结果可以用来指导保护区的实际管理？她的导师提醒她，建立模型只是研究的开始，更重要的是选择和评估模型，确保研究结论的可靠性。林小雨意识到，她需要掌握一套系统的方法来回答这些问题——这正是模型选择与评估的核心所在。</p>
<p>在前面的章节中，我们跟随林小雨学习了多种回归模型——从简单的线性回归到复杂的多元和多项式回归。现在，我们将继续她的研究历程，学习如何在众多候选模型中做出科学的选择，如何评估模型的可靠性，如何确保研究结论能够应用于实际的生态保护工作。</p>
<p>模型选择与评估是生态统计建模中至关重要的环节，它不仅仅是技术性的统计操作，更是连接数据、模型与生态学解释的关键桥梁。在生态学研究中，我们追求的不是数学上最完美的模型，而是最能反映生态过程本质、最具预测能力和解释力的模型。林小雨的困惑代表了所有生态学研究者共同面临的挑战：面对丰富的建模工具和复杂的生态数据，如何做出明智的选择？</p>
<p>生态系统的复杂性决定了单一模型很难捕捉所有生态关系。当林小雨面对她的森林调查数据时，她可以构建线性回归模型、多项式回归模型、广义线性模型等多种统计模型。每种模型都基于不同的假设，捕捉数据中不同层面的信息。模型选择的过程就是系统性地比较这些候选模型，找出最适合当前研究问题的那个模型。</p>
<p>林小雨在研究初期就体会到了模型选择的必要性。她收集了8个环境因子的数据，包括温度、降水、海拔、土壤pH、植被覆盖度等。如果将所有变量都纳入模型，虽然能够获得很高的<span class="math inline">\(R^2\)</span>值，但模型会变得极其复杂，难以解释每个环境因子的独立作用。更严重的是，这种”厨房水槽模型”(把所有变量都塞进去的模型)往往过度适应了训练数据的随机噪声，在预测新样地时表现糟糕。模型选择帮助她确定哪些环境因子真正重要，哪些可以忽略。</p>
<p>其次，生态关系的复杂性要求我们在不同函数形式之间做出选择。林小雨在分析物种丰富度与海拔的关系时，发现线性模型明显不足——物种丰富度在中等海拔最高，而在高海拔和低海拔都较低。她需要决定使用二次多项式、三次多项式，还是更复杂的函数形式。模型选择方法如<span class="math inline">\(\text{AIC}\)</span>帮助她找到了最优的函数复杂度，既充分描述了生态模式，又避免了过度拟合。</p>
<p>更重要的是，模型选择体现了生态学研究的简约性原则。林小雨的导师经常提醒她：“在科学研究中，简单就是美。”奥卡姆剃刀原理告诉我们：在同等解释力的模型中，应该选择最简单的那个。在生态学中，简约模型不仅计算效率更高，更重要的是它们通常具有更好的生态学解释性。一个包含过多参数的复杂模型可能能够完美拟合林小雨的150个样地数据，但其生态学意义往往难以理解，也难以推广到其他森林生态系统。</p>
<p>模型评估是模型选择的必要补充，它回答了一个更根本的问题：我们选择的模型是否真的可靠？林小雨意识到，即使她选择了统计指标最优的模型，也必须通过系统的评估来验证模型的可靠性。模型的可靠性体现在两个方面：统计可靠性和生态学可靠性。</p>
<p>统计可靠性关注模型是否满足基本的统计假设，参数估计是否准确，预测是否稳定。林小雨通过残差分析发现，她的某个模型存在明显的异方差性——在高海拔地区的预测误差明显大于低海拔地区。这提醒她需要重新审视模型假设或考虑数据变换。她还发现某些样地是强影响点，对模型参数估计有不成比例的影响。进一步调查后，她发现这些样地位于火烧迹地或人工林，代表了特殊的生态情境。这些诊断不仅帮助她识别技术问题，更重要的是揭示了森林生态系统的异质性。</p>
<p>生态学可靠性则关注模型结果是否具有生态学意义，是否能够为生态学理论提供支持，是否能够指导生态保护实践。林小雨在模型评估过程中始终牢记：一个统计上完美的模型如果缺乏生态学解释性，其价值就会大打折扣。例如，她构建的一个模型虽然预测精度很高，但包含了负的温度系数——这在生态学上不合理，因为温度升高通常会促进植物生长。这促使她重新检查数据和模型设定，最终发现是变量间的多重共线性导致了参数估计的不稳定。</p>
<p>在林小雨的研究中，模型选择与评估不仅仅是统计技术，它们反映了她对森林生态系统的理解深度。当她系统地比较不同模型时，实际上是在检验不同的生态学假说。每个候选模型都代表了对森林生态过程的一种可能解释，模型选择过程就是通过数据来评估这些解释的相对合理性。</p>
<p>以林小雨研究森林鸟类丰富度为例，她构建了基于不同环境因子的多个模型：一个模型强调栖息地面积的主导作用(基于岛屿生物地理学理论)，另一个模型突出植被结构的重要性(基于生境异质性假说)，第三个模型关注水源可及性的影响(基于资源可获得性理论)。通过<span class="math inline">\(\text{AIC}\)</span>比较，她不仅确定了哪个模型拟合最好，更重要的是能够量化不同生态因子对鸟类分布的相对贡献。这种量化分析为保护区管理提供了科学依据——如果栖息地面积被证明是最重要的预测变量，那么扩大保护区面积就应该成为保护规划的优先策略。</p>
<p>模型评估还帮助林小雨理解模型的局限性。她的导师提醒她：“在生态学中，没有完美的模型，只有在一定条件下适用的模型。”通过交叉验证，林小雨评估了模型在不同样地子集上的表现，发现模型在低海拔阔叶林中预测较准，但在高海拔针叶林中误差较大。这提示她模型的适用范围可能受到森林类型的限制。进一步的外部验证显示，当她将模型应用到邻近山区的另一个保护区时，预测精度有所下降。这种对模型局限性的清醒认识是科学严谨性的体现，也提醒林小雨在向保护区管理者汇报结果时需要明确说明模型的适用范围和不确定性。</p>
<p>在实际研究中，林小雨学会了结合统计准则和生态学知识来做出决策。统计准则如<span class="math inline">\(\text{AIC}\)</span>、<span class="math inline">\(\text{BIC}\)</span>提供了客观的模型比较标准，但她的导师强调它们不应该成为唯一的决策依据。例如，在某个模型中，土壤pH值的系数虽然统计上不显著(p=0.08)，但林小雨知道土壤酸碱度是影响植物生长的重要因子。在与导师讨论后，她决定保留这个变量，因为它具有明确的生态学意义，且p值接近显著性阈值。</p>
<p>林小雨的模型选择过程是迭代的、探索性的。她从最简单的单变量模型开始，逐步增加变量，同时密切关注<span class="math inline">\(\text{AIC}\)</span>值和调整<span class="math inline">\(R^2\)</span>的变化。当添加第四个变量后，<span class="math inline">\(\text{AIC}\)</span>值不再明显下降，她意识到已经找到了复杂度与性能的最优平衡点。这种渐进式的建模策略不仅计算效率高，更重要的是帮助她理解每个环境因子对模型贡献的边际效应——哪些因子是必需的，哪些因子只是锦上添花。</p>
<p>最后，林小雨明确了模型选择应该服务于她的研究目标：为保护区管理提供科学依据。她的研究目标既包括机制探索(理解哪些环境因子驱动了物种分布)，也包括预测应用(预测不同管理措施对生物多样性的影响)。因此，她需要在模型的解释性和预测精度之间寻求平衡。一个高度复杂的机器学习模型可能预测精度更高，但难以向保护区管理者解释；而一个简单的线性模型虽然易于解释，但可能无法捕捉重要的非线性关系。通过系统的模型选择与评估，林小雨最终找到了适合她研究目标的最佳模型。</p>
<p>通过系统的模型选择与评估，林小雨构建了既统计可靠又生态学有意义的模型，为理解森林生态过程、预测气候变化影响、指导保护区管理提供了坚实的科学基础。这个过程不仅提升了她研究的科学质量，更重要的是培养了她对生态统计建模的深刻理解——认识到模型是工具而不是真理，是帮助我们理解复杂生态系统的有力手段。</p>
<p>现在，让我们跟随林小雨的脚步，系统学习模型选择与评估的方法和原理。</p>
</div>
<div id="模型选择" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> 模型选择<a href="模型选择与评估.html#模型选择" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="模型选择原则" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> 模型选择原则<a href="模型选择与评估.html#模型选择原则" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>林小雨开始整理她的森林土壤调查数据，准备研究土壤养分如何影响植物生物量。她面临着一个关键问题：应该选择什么样的模型来描述这种生态关系？是简单的线性模型，还是更复杂的多项式模型？这个问题的答案引出了模型选择的核心原则——在模型复杂度和拟合优度之间寻找最优平衡点。</p>
<p><strong>平衡模型复杂度和拟合优度</strong>是林小雨面临的第一个挑战。模型复杂度通常用参数数量来衡量，而拟合优度则通过模型对数据的解释能力来评估。在生态学中，我们面临着两难选择：过于简单的模型可能无法充分捕捉生态关系的复杂性，导致欠拟合；而过于复杂的模型则可能过度适应训练数据的随机噪声，导致过拟合。</p>
<p>林小雨在分析土壤养分与植物生物量的关系时，首先尝试了最简单的线性模型。但她很快发现，线性模型无法充分描述物种对养分的最适响应——在养分浓度过高或过低时，植物生长都会受到抑制。这种欠拟合不仅降低了模型的预测精度，更重要的是可能掩盖了关键的生态机制，如养分毒性和养分限制的阈值效应。</p>
<p>过拟合则是林小雨在后续建模中遇到的更常见问题。当她尝试使用10次多项式来描述养分与生物量的关系时，模型完美地拟合了训练数据中的随机变异，包括测量误差和偶然的生态现象。但这种过度拟合的模型在预测新样地时表现糟糕。在生态学中，过拟合的典型表现是模型包含了大量统计显著但生态学意义不明确的变量，或者使用了过于复杂的函数形式来描述本质上简单的生态关系。</p>
<p><strong>奥卡姆剃刀原理</strong>在林小雨的模型选择中具有重要的指导意义。她的导师经常引用这个源自14世纪哲学家的原则：“如无必要，勿增实体”。在模型选择的语境下，这意味着在同等解释力的模型中，应该选择最简单的那个。简约模型不仅计算效率更高，更重要的是它们通常具有更好的泛化能力和生态学解释性。</p>
<p>生态学中的简约性原则体现在林小雨研究的多个层面。在变量选择层面，她应该只包含那些对植物生物量有实质性影响的土壤因子；在函数形式层面，她应该选择最能反映生态机制的函数关系；在模型结构层面，她应该避免不必要的复杂交互项和随机效应。</p>
<p><strong>生态学意义</strong>是林小雨模型选择的最终评判标准。一个统计上完美的模型如果缺乏生态学解释性，其价值就会大打折扣。在生态学研究中，模型选择不仅要考虑统计指标，更要考虑模型的生态学合理性。例如，一个预测植物生物量的模型如果包含了生态学上不合理的环境因子组合，即使其预测精度很高，也难以被生态学家接受。</p>
<p>林小雨的模型选择过程本身就是对森林生态机制的深入探索。通过系统比较不同复杂度的模型，她能够识别哪些生态过程是必要的，哪些是冗余的。这种识别过程帮助她更深入地理解土壤养分如何影响森林生态系统的生产力。</p>
<p>林小雨开始实施她的模型复杂度平衡研究。她首先需要生成模拟数据来演示不同复杂度模型的拟合效果。这些数据模拟了她在森林调查中观察到的植物生物量与土壤养分的关系，其中真实生态关系是二次的，反映了物种对养分的最适响应模式。</p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="模型选择与评估.html#cb827-1" tabindex="-1"></a><span class="co"># 林小雨的森林土壤调查数据：演示模型复杂度与拟合优度的平衡</span></span>
<span id="cb827-2"><a href="模型选择与评估.html#cb827-2" tabindex="-1"></a><span class="co"># 设置随机种子确保结果可重现，便于林小雨重复分析</span></span>
<span id="cb827-3"><a href="模型选择与评估.html#cb827-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb827-4"><a href="模型选择与评估.html#cb827-4" tabindex="-1"></a></span>
<span id="cb827-5"><a href="模型选择与评估.html#cb827-5" tabindex="-1"></a><span class="co"># 生成林小雨的森林土壤调查数据：植物生物量与土壤养分的关系</span></span>
<span id="cb827-6"><a href="模型选择与评估.html#cb827-6" tabindex="-1"></a><span class="co"># 样本量设置为100个森林样地观测</span></span>
<span id="cb827-7"><a href="模型选择与评估.html#cb827-7" tabindex="-1"></a>n_forest_plots <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb827-8"><a href="模型选择与评估.html#cb827-8" tabindex="-1"></a></span>
<span id="cb827-9"><a href="模型选择与评估.html#cb827-9" tabindex="-1"></a><span class="co"># 创建土壤养分梯度，从10到100 mg/kg均匀分布</span></span>
<span id="cb827-10"><a href="模型选择与评估.html#cb827-10" tabindex="-1"></a><span class="co"># 模拟真实森林土壤变异</span></span>
<span id="cb827-11"><a href="模型选择与评估.html#cb827-11" tabindex="-1"></a>forest_soil_nutrient <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="at">length.out =</span> n_forest_plots)</span>
<span id="cb827-12"><a href="模型选择与评估.html#cb827-12" tabindex="-1"></a></span>
<span id="cb827-13"><a href="模型选择与评估.html#cb827-13" tabindex="-1"></a><span class="co"># 真实生态关系：二次关系（存在最适养分范围）</span></span>
<span id="cb827-14"><a href="模型选择与评估.html#cb827-14" tabindex="-1"></a><span class="co"># 基础生物量为50 g/m²，线性项系数为0.8，二次项系数为-0.005</span></span>
<span id="cb827-15"><a href="模型选择与评估.html#cb827-15" tabindex="-1"></a>forest_biomass_true <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> forest_soil_nutrient <span class="sc">-</span></span>
<span id="cb827-16"><a href="模型选择与评估.html#cb827-16" tabindex="-1"></a>  <span class="fl">0.005</span> <span class="sc">*</span> forest_soil_nutrient<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb827-17"><a href="模型选择与评估.html#cb827-17" tabindex="-1"></a></span>
<span id="cb827-18"><a href="模型选择与评估.html#cb827-18" tabindex="-1"></a><span class="co"># 添加随机噪声模拟观测误差，标准差为10 g/m²</span></span>
<span id="cb827-19"><a href="模型选择与评估.html#cb827-19" tabindex="-1"></a><span class="co"># 反映野外调查的不确定性</span></span>
<span id="cb827-20"><a href="模型选择与评估.html#cb827-20" tabindex="-1"></a>forest_biomass_observed <span class="ot">&lt;-</span> forest_biomass_true <span class="sc">+</span></span>
<span id="cb827-21"><a href="模型选择与评估.html#cb827-21" tabindex="-1"></a>  <span class="fu">rnorm</span>(n_forest_plots, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb827-22"><a href="模型选择与评估.html#cb827-22" tabindex="-1"></a></span>
<span id="cb827-23"><a href="模型选择与评估.html#cb827-23" tabindex="-1"></a><span class="co"># 创建数据框用于存储林小雨的森林生态数据</span></span>
<span id="cb827-24"><a href="模型选择与评估.html#cb827-24" tabindex="-1"></a><span class="co"># 包含土壤养分浓度和观测植物生物量两个关键变量</span></span>
<span id="cb827-25"><a href="模型选择与评估.html#cb827-25" tabindex="-1"></a>forest_soil_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb827-26"><a href="模型选择与评估.html#cb827-26" tabindex="-1"></a>  <span class="at">soil_nutrient =</span> forest_soil_nutrient,</span>
<span id="cb827-27"><a href="模型选择与评估.html#cb827-27" tabindex="-1"></a>  <span class="at">plant_biomass =</span> forest_biomass_observed</span>
<span id="cb827-28"><a href="模型选择与评估.html#cb827-28" tabindex="-1"></a>)</span></code></pre></div>
<p>数据准备完成后，林小雨开始拟合不同复杂度的模型。她构建了四个模型：线性模型、二次模型、三次模型和10次多项式模型，每个模型代表了对植物生物量与土壤养分关系的不同假设。</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="模型选择与评估.html#cb828-1" tabindex="-1"></a><span class="co"># 拟合不同复杂度的模型</span></span>
<span id="cb828-2"><a href="模型选择与评估.html#cb828-2" tabindex="-1"></a><span class="co"># 线性模型：最简单的模型，假设线性关系</span></span>
<span id="cb828-3"><a href="模型选择与评估.html#cb828-3" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(plant_biomass <span class="sc">~</span> soil_nutrient, <span class="at">data =</span> forest_soil_data)</span>
<span id="cb828-4"><a href="模型选择与评估.html#cb828-4" tabindex="-1"></a></span>
<span id="cb828-5"><a href="模型选择与评估.html#cb828-5" tabindex="-1"></a><span class="co"># 二次模型：包含线性项和二次项，适合描述最适响应</span></span>
<span id="cb828-6"><a href="模型选择与评估.html#cb828-6" tabindex="-1"></a>model_quadratic <span class="ot">&lt;-</span> <span class="fu">lm</span>(plant_biomass <span class="sc">~</span> <span class="fu">poly</span>(soil_nutrient, <span class="dv">2</span>),</span>
<span id="cb828-7"><a href="模型选择与评估.html#cb828-7" tabindex="-1"></a>  <span class="at">data =</span> forest_soil_data)</span>
<span id="cb828-8"><a href="模型选择与评估.html#cb828-8" tabindex="-1"></a></span>
<span id="cb828-9"><a href="模型选择与评估.html#cb828-9" tabindex="-1"></a><span class="co"># 三次模型：包含三次项，可能过度参数化</span></span>
<span id="cb828-10"><a href="模型选择与评估.html#cb828-10" tabindex="-1"></a>model_cubic <span class="ot">&lt;-</span> <span class="fu">lm</span>(plant_biomass <span class="sc">~</span> <span class="fu">poly</span>(soil_nutrient, <span class="dv">3</span>),</span>
<span id="cb828-11"><a href="模型选择与评估.html#cb828-11" tabindex="-1"></a>  <span class="at">data =</span> forest_soil_data)</span>
<span id="cb828-12"><a href="模型选择与评估.html#cb828-12" tabindex="-1"></a></span>
<span id="cb828-13"><a href="模型选择与评估.html#cb828-13" tabindex="-1"></a><span class="co"># 10次多项式：严重过度拟合，完美拟合训练数据噪声</span></span>
<span id="cb828-14"><a href="模型选择与评估.html#cb828-14" tabindex="-1"></a>model_overfit <span class="ot">&lt;-</span> <span class="fu">lm</span>(plant_biomass <span class="sc">~</span> <span class="fu">poly</span>(soil_nutrient, <span class="dv">10</span>),</span>
<span id="cb828-15"><a href="模型选择与评估.html#cb828-15" tabindex="-1"></a>  <span class="at">data =</span> forest_soil_data)</span></code></pre></div>
<p>模型拟合完成后，林小雨需要量化评估每个模型的性能。她计算了两个关键指标：R²衡量模型的拟合优度，AIC平衡拟合优度和模型复杂度。</p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="模型选择与评估.html#cb829-1" tabindex="-1"></a><span class="co"># 计算拟合优度（$R^2$）</span></span>
<span id="cb829-2"><a href="模型选择与评估.html#cb829-2" tabindex="-1"></a><span class="co"># R²衡量模型解释的方差比例</span></span>
<span id="cb829-3"><a href="模型选择与评估.html#cb829-3" tabindex="-1"></a>r2_linear <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_linear)<span class="sc">$</span>r.squared</span>
<span id="cb829-4"><a href="模型选择与评估.html#cb829-4" tabindex="-1"></a>r2_quadratic <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_quadratic)<span class="sc">$</span>r.squared</span>
<span id="cb829-5"><a href="模型选择与评估.html#cb829-5" tabindex="-1"></a>r2_cubic <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_cubic)<span class="sc">$</span>r.squared</span>
<span id="cb829-6"><a href="模型选择与评估.html#cb829-6" tabindex="-1"></a>r2_overfit <span class="ot">&lt;-</span> <span class="fu">summary</span>(model_overfit)<span class="sc">$</span>r.squared</span>
<span id="cb829-7"><a href="模型选择与评估.html#cb829-7" tabindex="-1"></a></span>
<span id="cb829-8"><a href="模型选择与评估.html#cb829-8" tabindex="-1"></a><span class="co"># 计算$\text{AIC}$值</span></span>
<span id="cb829-9"><a href="模型选择与评估.html#cb829-9" tabindex="-1"></a><span class="co"># AIC平衡模型拟合优度和复杂度，值越小越好</span></span>
<span id="cb829-10"><a href="模型选择与评估.html#cb829-10" tabindex="-1"></a>aic_linear <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model_linear)</span>
<span id="cb829-11"><a href="模型选择与评估.html#cb829-11" tabindex="-1"></a>aic_quadratic <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model_quadratic)</span>
<span id="cb829-12"><a href="模型选择与评估.html#cb829-12" tabindex="-1"></a>aic_cubic <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model_cubic)</span>
<span id="cb829-13"><a href="模型选择与评估.html#cb829-13" tabindex="-1"></a>aic_overfit <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model_overfit)</span></code></pre></div>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="模型选择与评估.html#cb830-1" tabindex="-1"></a><span class="co"># 绘制比较图</span></span>
<span id="cb830-2"><a href="模型选择与评估.html#cb830-2" tabindex="-1"></a><span class="co"># 设置图形布局为2行2列，便于比较四个模型</span></span>
<span id="cb830-3"><a href="模型选择与评估.html#cb830-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb830-4"><a href="模型选择与评估.html#cb830-4" tabindex="-1"></a></span>
<span id="cb830-5"><a href="模型选择与评估.html#cb830-5" tabindex="-1"></a><span class="co"># 线性模型图</span></span>
<span id="cb830-6"><a href="模型选择与评估.html#cb830-6" tabindex="-1"></a><span class="co"># 绘制散点图显示观测数据</span></span>
<span id="cb830-7"><a href="模型选择与评估.html#cb830-7" tabindex="-1"></a><span class="fu">plot</span>(plant_biomass <span class="sc">~</span> soil_nutrient,</span>
<span id="cb830-8"><a href="模型选择与评估.html#cb830-8" tabindex="-1"></a>  <span class="at">data =</span> forest_soil_data,</span>
<span id="cb830-9"><a href="模型选择与评估.html#cb830-9" tabindex="-1"></a>  <span class="co"># 标题包含R²和AIC值用于模型比较</span></span>
<span id="cb830-10"><a href="模型选择与评估.html#cb830-10" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;线性模型</span><span class="sc">\n</span><span class="st">$R^2$ =&quot;</span>, <span class="fu">round</span>(r2_linear, <span class="dv">3</span>),</span>
<span id="cb830-11"><a href="模型选择与评估.html#cb830-11" tabindex="-1"></a>  <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">text{AIC}$ =&quot;</span>, <span class="fu">round</span>(aic_linear, <span class="dv">1</span>)),</span>
<span id="cb830-12"><a href="模型选择与评估.html#cb830-12" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;土壤养分&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;植物生物量&quot;</span>,</span>
<span id="cb830-13"><a href="模型选择与评估.html#cb830-13" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>  <span class="co"># 蓝色实心点</span></span>
<span id="cb830-14"><a href="模型选择与评估.html#cb830-14" tabindex="-1"></a>)</span>
<span id="cb830-15"><a href="模型选择与评估.html#cb830-15" tabindex="-1"></a><span class="co"># 添加模型拟合线</span></span>
<span id="cb830-16"><a href="模型选择与评估.html#cb830-16" tabindex="-1"></a><span class="fu">lines</span>(forest_soil_nutrient, <span class="fu">predict</span>(model_linear), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb830-17"><a href="模型选择与评估.html#cb830-17" tabindex="-1"></a></span>
<span id="cb830-18"><a href="模型选择与评估.html#cb830-18" tabindex="-1"></a><span class="co"># 二次模型图</span></span>
<span id="cb830-19"><a href="模型选择与评估.html#cb830-19" tabindex="-1"></a><span class="fu">plot</span>(plant_biomass <span class="sc">~</span> soil_nutrient,</span>
<span id="cb830-20"><a href="模型选择与评估.html#cb830-20" tabindex="-1"></a>  <span class="at">data =</span> forest_soil_data,</span>
<span id="cb830-21"><a href="模型选择与评估.html#cb830-21" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;二次模型</span><span class="sc">\n</span><span class="st">$R^2$ =&quot;</span>, <span class="fu">round</span>(r2_quadratic, <span class="dv">3</span>),</span>
<span id="cb830-22"><a href="模型选择与评估.html#cb830-22" tabindex="-1"></a>  <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">text{AIC}$ =&quot;</span>, <span class="fu">round</span>(aic_quadratic, <span class="dv">1</span>)),</span>
<span id="cb830-23"><a href="模型选择与评估.html#cb830-23" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;土壤养分&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;植物生物量&quot;</span>,</span>
<span id="cb830-24"><a href="模型选择与评估.html#cb830-24" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb830-25"><a href="模型选择与评估.html#cb830-25" tabindex="-1"></a>)</span>
<span id="cb830-26"><a href="模型选择与评估.html#cb830-26" tabindex="-1"></a><span class="fu">lines</span>(forest_soil_nutrient, <span class="fu">predict</span>(model_quadratic), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb830-27"><a href="模型选择与评估.html#cb830-27" tabindex="-1"></a></span>
<span id="cb830-28"><a href="模型选择与评估.html#cb830-28" tabindex="-1"></a><span class="co"># 三次模型图</span></span>
<span id="cb830-29"><a href="模型选择与评估.html#cb830-29" tabindex="-1"></a><span class="fu">plot</span>(plant_biomass <span class="sc">~</span> soil_nutrient,</span>
<span id="cb830-30"><a href="模型选择与评估.html#cb830-30" tabindex="-1"></a>  <span class="at">data =</span> forest_soil_data,</span>
<span id="cb830-31"><a href="模型选择与评估.html#cb830-31" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;三次模型</span><span class="sc">\n</span><span class="st">$R^2$ =&quot;</span>, <span class="fu">round</span>(r2_cubic, <span class="dv">3</span>),</span>
<span id="cb830-32"><a href="模型选择与评估.html#cb830-32" tabindex="-1"></a>  <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">text{AIC}$ =&quot;</span>, <span class="fu">round</span>(aic_cubic, <span class="dv">1</span>)),</span>
<span id="cb830-33"><a href="模型选择与评估.html#cb830-33" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;土壤养分&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;植物生物量&quot;</span>,</span>
<span id="cb830-34"><a href="模型选择与评估.html#cb830-34" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb830-35"><a href="模型选择与评估.html#cb830-35" tabindex="-1"></a>)</span>
<span id="cb830-36"><a href="模型选择与评估.html#cb830-36" tabindex="-1"></a><span class="fu">lines</span>(forest_soil_nutrient, <span class="fu">predict</span>(model_cubic), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb830-37"><a href="模型选择与评估.html#cb830-37" tabindex="-1"></a></span>
<span id="cb830-38"><a href="模型选择与评估.html#cb830-38" tabindex="-1"></a><span class="co"># 过度拟合模型图</span></span>
<span id="cb830-39"><a href="模型选择与评估.html#cb830-39" tabindex="-1"></a><span class="fu">plot</span>(plant_biomass <span class="sc">~</span> soil_nutrient,</span>
<span id="cb830-40"><a href="模型选择与评估.html#cb830-40" tabindex="-1"></a>  <span class="at">data =</span> forest_soil_data,</span>
<span id="cb830-41"><a href="模型选择与评估.html#cb830-41" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;10次多项式</span><span class="sc">\n</span><span class="st">$R^2$ =&quot;</span>, <span class="fu">round</span>(r2_overfit, <span class="dv">3</span>),</span>
<span id="cb830-42"><a href="模型选择与评估.html#cb830-42" tabindex="-1"></a>  <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">text{AIC}$ =&quot;</span>, <span class="fu">round</span>(aic_overfit, <span class="dv">1</span>)),</span>
<span id="cb830-43"><a href="模型选择与评估.html#cb830-43" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;土壤养分&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;植物生物量&quot;</span>,</span>
<span id="cb830-44"><a href="模型选择与评估.html#cb830-44" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb830-45"><a href="模型选择与评估.html#cb830-45" tabindex="-1"></a>)</span>
<span id="cb830-46"><a href="模型选择与评估.html#cb830-46" tabindex="-1"></a><span class="fu">lines</span>(forest_soil_nutrient, <span class="fu">predict</span>(model_overfit), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:model-complexity-comparison"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/model-complexity-comparison-1.png" alt="模型复杂度与拟合优度平衡：线性、二次、三次和10次多项式模型对植物生物量与土壤养分关系的拟合效果比较" width="80%" />
<p class="caption">
图9.1: 模型复杂度与拟合优度平衡：线性、二次、三次和10次多项式模型对植物生物量与土壤养分关系的拟合效果比较
</p>
</div>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="模型选择与评估.html#cb831-1" tabindex="-1"></a><span class="co"># 恢复单图布局</span></span>
<span id="cb831-2"><a href="模型选择与评估.html#cb831-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## === 模型复杂度与拟合优度平衡演示 ===
## 
##  线性模型 (欠拟合):
##  - $R^2$ = 0.383 $\text{AIC}$ = 734.8 
##  - 问题：无法捕捉最适养分范围
## 
##  二次模型 (最优):
##  - $R^2$ = 0.416 $\text{AIC}$ = 731.3 
##  - 优势：正确反映了真实生态关系
## 
##  三次模型 (过度参数化):
##  - $R^2$ = 0.416 $\text{AIC}$ = 733.3 
##  - 问题：不必要的复杂度
## 
##  10次多项式 (严重过拟合):
##  - $R^2$ = 0.455 $\text{AIC}$ = 740.4 
##  - 问题：过度适应随机噪声，预测能力差
## 
##  模型比较结果已生成，请查看图表和性能指标。</code></pre>
<p>通过模型复杂度与拟合优度平衡的演示，我们可以得出重要的生态学启示。在这个植物生物量与土壤养分的例子中，真实生态关系是二次的，反映了物种对养分的最适响应模式。线性模型虽然简单，但过于简化，无法捕捉这种生态学模式；而二次模型既充分捕捉了生态关系，又保持了简约性。高次多项式虽然<span class="math inline">\(R^2\)</span>更高，但生态学意义不明确，<span class="math inline">\(\text{AIC}\)</span>值也确认了二次模型的最优性。</p>
</div>
<div id="信息准则" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> 信息准则<a href="模型选择与评估.html#信息准则" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>林小雨在分析森林鸟类丰富度与环境因子的关系时，面临着多个看似合理的模型选择。栖息地面积、植被密度、距水源距离和土壤pH值都可能影响鸟类分布，但她不确定哪些因子真正重要，哪些可以忽略。信息准则为她提供了客观的模型比较标准，帮助她在多个候选模型中做出科学的选择。</p>
<p>信息准则是模型选择中最重要的统计工具，它们通过数学方法量化了模型复杂度和拟合优度之间的权衡。在生态学研究中，信息准则为我们提供了客观的模型比较标准，帮助我们避免主观偏见对模型选择的影响。</p>
<p><strong>AIC（赤池信息准则）</strong>是由日本统计学家赤池弘次在1974年提出的，其核心思想是基于信息论来衡量模型的相对质量。AIC的计算公式为：<span class="math display">\[\text{AIC} = -2 \ln(L) + 2k\]</span>，其中<span class="math inline">\(L\)</span>是模型的最大似然值，<span class="math inline">\(k\)</span>是模型参数的数量。这个公式体现了信息准则的基本哲学：第一项惩罚模型对数据的拟合不足，第二项惩罚模型的复杂度。</p>
<p><span class="math inline">\(\text{AIC}\)</span>的生态学意义在于它量化了模型的信息损失。当我们用模型来描述生态数据时，总会丢失一些信息。<span class="math inline">\(\text{AIC}\)</span>估计了这种信息损失的大小，<span class="math inline">\(\text{AIC}\)</span>值越小的模型，信息损失越小，模型质量越高。在生态学应用中，<span class="math inline">\(\text{AIC}\)</span>特别适合用于比较非嵌套模型，即那些具有不同变量组合或不同函数形式的模型。</p>
<p><span class="math inline">\(\text{AIC}\)</span>的一个关键特性是它的相对性。<span class="math inline">\(\text{AIC}\)</span>值本身没有绝对意义，只有不同模型之间的<span class="math inline">\(\text{AIC}\)</span>差异<span class="math inline">\(\Delta\text{AIC}\)</span>才有意义。通常认为，<span class="math inline">\(\Delta\text{AIC} &lt; 2\)</span>的模型在统计上难以区分，<span class="math inline">\(2 \leq \Delta\text{AIC} \leq 7\)</span>的模型有实质性差异，<span class="math inline">\(\Delta\text{AIC} &gt; 10\)</span>的模型则明显优劣分明。这种相对比较的特性使得<span class="math inline">\(\text{AIC}\)</span>特别适合生态学研究，因为生态学中很少存在”完美”的模型。</p>
<p><strong>BIC（贝叶斯信息准则）</strong>是AIC的改进版本，由Gideon Schwarz在1978年提出。BIC的计算公式为：<span class="math display">\[\text{BIC} = -2 \ln(L) + k \ln(n)\]</span>，其中<span class="math inline">\(n\)</span>是样本量。与AIC相比，BIC对模型复杂度的惩罚更强，特别是当样本量较大时。</p>
<p><span class="math inline">\(\text{BIC}\)</span>的数学基础是贝叶斯因子，它估计了模型的后验概率。在生态学研究中，<span class="math inline">\(\text{BIC}\)</span>特别适合用于比较具有明确理论基础的模型，因为它倾向于选择那些在贝叶斯框架下更有可能的模型。<span class="math inline">\(\text{BIC}\)</span>的另一个优势是它的一致性特性：当样本量趋于无穷大时，<span class="math inline">\(\text{BIC}\)</span>会选择真实的模型（如果真实模型在候选模型中）。</p>
<p>在生态学实践中，<span class="math inline">\(\text{AIC}\)</span>和<span class="math inline">\(\text{BIC}\)</span>的选择取决于研究目标。如果研究目标是预测，<span class="math inline">\(\text{AIC}\)</span>通常更合适，因为它倾向于选择预测能力更强的模型。如果研究目标是机制探索和模型识别，<span class="math inline">\(\text{BIC}\)</span>可能更合适，因为它倾向于选择更简约的模型。对于小样本情况，推荐使用<span class="math inline">\(\text{AIC}\)</span>的修正版本<span class="math inline">\(\text{AIC}_c\)</span>。</p>
<p>信息准则在生态学中的应用需要谨慎。首先，信息准则只能比较基于相同数据的模型。其次，信息准则假设候选模型已经包含了真实模型，这在生态学中往往不成立。第三，信息准则对样本量敏感，小样本情况下可能需要使用修正版本如<span class="math inline">\(\text{AIC}_c\)</span>。</p>
<p>为了演示信息准则在生态学中的应用，林小雨创建了一个森林鸟类丰富度研究的案例。她模拟了100个森林样地的调查数据，包括栖息地面积、植被密度、距水源距离和土壤pH值等环境因子，其中只有部分因子真正影响鸟类丰富度。</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="模型选择与评估.html#cb833-1" tabindex="-1"></a><span class="co"># 信息准则在生态学中的应用演示：林小雨的森林鸟类丰富度研究</span></span>
<span id="cb833-2"><a href="模型选择与评估.html#cb833-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb833-3"><a href="模型选择与评估.html#cb833-3" tabindex="-1"></a></span>
<span id="cb833-4"><a href="模型选择与评估.html#cb833-4" tabindex="-1"></a><span class="co"># 生成林小雨的森林鸟类调查数据：鸟类丰富度与多个环境因子的关系</span></span>
<span id="cb833-5"><a href="模型选择与评估.html#cb833-5" tabindex="-1"></a>n_forest_birds <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb833-6"><a href="模型选择与评估.html#cb833-6" tabindex="-1"></a></span>
<span id="cb833-7"><a href="模型选择与评估.html#cb833-7" tabindex="-1"></a><span class="co"># 真实环境因子（林小雨在森林调查中测量的变量）</span></span>
<span id="cb833-8"><a href="模型选择与评估.html#cb833-8" tabindex="-1"></a>forest_habitat_area <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_birds, <span class="dv">1</span>, <span class="dv">100</span>) <span class="co"># 栖息地面积(公顷)</span></span>
<span id="cb833-9"><a href="模型选择与评估.html#cb833-9" tabindex="-1"></a>forest_vegetation_density <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_birds, <span class="fl">0.1</span>, <span class="fl">0.9</span>) <span class="co"># 植被密度</span></span>
<span id="cb833-10"><a href="模型选择与评估.html#cb833-10" tabindex="-1"></a>forest_distance_to_water <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_birds, <span class="fl">0.1</span>, <span class="dv">5</span>) <span class="co"># 距水源距离(km)</span></span>
<span id="cb833-11"><a href="模型选择与评估.html#cb833-11" tabindex="-1"></a>forest_soil_ph <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_birds, <span class="fl">4.5</span>, <span class="fl">8.5</span>) <span class="co"># 土壤pH值</span></span>
<span id="cb833-12"><a href="模型选择与评估.html#cb833-12" tabindex="-1"></a></span>
<span id="cb833-13"><a href="模型选择与评估.html#cb833-13" tabindex="-1"></a><span class="co"># 生成鸟类丰富度（只有部分变量有真实影响）</span></span>
<span id="cb833-14"><a href="模型选择与评估.html#cb833-14" tabindex="-1"></a><span class="co"># 真实关系：丰富度 ~ 面积 + 植被密度 + 距水源距离</span></span>
<span id="cb833-15"><a href="模型选择与评估.html#cb833-15" tabindex="-1"></a>forest_bird_richness <span class="ot">&lt;-</span> <span class="fu">rpois</span>(</span>
<span id="cb833-16"><a href="模型选择与评估.html#cb833-16" tabindex="-1"></a>  n_forest_birds,</span>
<span id="cb833-17"><a href="模型选择与评估.html#cb833-17" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fl">1.5</span> <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> forest_habitat_area <span class="sc">+</span></span>
<span id="cb833-18"><a href="模型选择与评估.html#cb833-18" tabindex="-1"></a>    <span class="fl">1.2</span> <span class="sc">*</span> forest_vegetation_density <span class="sc">-</span> <span class="fl">0.3</span> <span class="sc">*</span> forest_distance_to_water <span class="sc">+</span></span>
<span id="cb833-19"><a href="模型选择与评估.html#cb833-19" tabindex="-1"></a>    <span class="fu">rnorm</span>(n_forest_birds, <span class="dv">0</span>, <span class="fl">0.3</span>))</span>
<span id="cb833-20"><a href="模型选择与评估.html#cb833-20" tabindex="-1"></a>)</span>
<span id="cb833-21"><a href="模型选择与评估.html#cb833-21" tabindex="-1"></a></span>
<span id="cb833-22"><a href="模型选择与评估.html#cb833-22" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb833-23"><a href="模型选择与评估.html#cb833-23" tabindex="-1"></a>forest_bird_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb833-24"><a href="模型选择与评估.html#cb833-24" tabindex="-1"></a>  <span class="at">richness =</span> forest_bird_richness,</span>
<span id="cb833-25"><a href="模型选择与评估.html#cb833-25" tabindex="-1"></a>  <span class="at">area =</span> forest_habitat_area,</span>
<span id="cb833-26"><a href="模型选择与评估.html#cb833-26" tabindex="-1"></a>  <span class="at">vegetation =</span> forest_vegetation_density,</span>
<span id="cb833-27"><a href="模型选择与评估.html#cb833-27" tabindex="-1"></a>  <span class="at">water_distance =</span> forest_distance_to_water,</span>
<span id="cb833-28"><a href="模型选择与评估.html#cb833-28" tabindex="-1"></a>  <span class="at">soil_ph =</span> forest_soil_ph</span>
<span id="cb833-29"><a href="模型选择与评估.html#cb833-29" tabindex="-1"></a>)</span></code></pre></div>
<p>基于不同的生态学假说，林小雨构建了六个候选模型。这些模型涵盖了从简单到复杂的各种假设，包括单一因子模型、双因子组合模型、全模型以及过度拟合模型。</p>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="模型选择与评估.html#cb834-1" tabindex="-1"></a><span class="co"># 构建多个候选模型：林小雨基于不同生态学假说构建的鸟类丰富度模型</span></span>
<span id="cb834-2"><a href="模型选择与评估.html#cb834-2" tabindex="-1"></a>forest_bird_models <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb834-3"><a href="模型选择与评估.html#cb834-3" tabindex="-1"></a></span>
<span id="cb834-4"><a href="模型选择与评估.html#cb834-4" tabindex="-1"></a><span class="co"># 简单模型（基于单一因子假说）</span></span>
<span id="cb834-5"><a href="模型选择与评估.html#cb834-5" tabindex="-1"></a>forest_bird_models[[<span class="st">&quot;area_only&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(richness <span class="sc">~</span> area, <span class="at">data =</span> forest_bird_data)</span>
<span id="cb834-6"><a href="模型选择与评估.html#cb834-6" tabindex="-1"></a>forest_bird_models[[<span class="st">&quot;vegetation_only&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(richness <span class="sc">~</span> vegetation, <span class="at">data =</span> forest_bird_data)</span>
<span id="cb834-7"><a href="模型选择与评估.html#cb834-7" tabindex="-1"></a></span>
<span id="cb834-8"><a href="模型选择与评估.html#cb834-8" tabindex="-1"></a><span class="co"># 中等复杂度模型（基于生态学理论组合）</span></span>
<span id="cb834-9"><a href="模型选择与评估.html#cb834-9" tabindex="-1"></a>forest_bird_models[[<span class="st">&quot;area_vegetation&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(richness <span class="sc">~</span> area <span class="sc">+</span> vegetation,</span>
<span id="cb834-10"><a href="模型选择与评估.html#cb834-10" tabindex="-1"></a>  <span class="at">data =</span> forest_bird_data)</span>
<span id="cb834-11"><a href="模型选择与评估.html#cb834-11" tabindex="-1"></a>forest_bird_models[[<span class="st">&quot;area_water&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(richness <span class="sc">~</span> area <span class="sc">+</span> water_distance,</span>
<span id="cb834-12"><a href="模型选择与评估.html#cb834-12" tabindex="-1"></a>  <span class="at">data =</span> forest_bird_data)</span>
<span id="cb834-13"><a href="模型选择与评估.html#cb834-13" tabindex="-1"></a></span>
<span id="cb834-14"><a href="模型选择与评估.html#cb834-14" tabindex="-1"></a><span class="co"># 复杂模型（包含所有可能因子）</span></span>
<span id="cb834-15"><a href="模型选择与评估.html#cb834-15" tabindex="-1"></a>forest_bird_models[[<span class="st">&quot;full_model&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(richness <span class="sc">~</span> area <span class="sc">+</span> vegetation <span class="sc">+</span></span>
<span id="cb834-16"><a href="模型选择与评估.html#cb834-16" tabindex="-1"></a>  water_distance <span class="sc">+</span> soil_ph, <span class="at">data =</span> forest_bird_data)</span>
<span id="cb834-17"><a href="模型选择与评估.html#cb834-17" tabindex="-1"></a>forest_bird_models[[<span class="st">&quot;overfit_model&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(richness <span class="sc">~</span> area <span class="sc">+</span> vegetation <span class="sc">+</span></span>
<span id="cb834-18"><a href="模型选择与评估.html#cb834-18" tabindex="-1"></a>  water_distance <span class="sc">+</span> soil_ph <span class="sc">+</span> <span class="fu">I</span>(area<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(vegetation<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb834-19"><a href="模型选择与评估.html#cb834-19" tabindex="-1"></a>  <span class="at">data =</span> forest_bird_data)</span></code></pre></div>
<p>接下来，林小雨计算了每个模型的信息准则指标。她计算了AIC、BIC、ΔAIC、ΔBIC以及AIC权重，这些指标将帮助她客观地比较不同模型的相对优劣。</p>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="模型选择与评估.html#cb835-1" tabindex="-1"></a><span class="co"># 计算信息准则：林小雨比较不同鸟类丰富度模型</span></span>
<span id="cb835-2"><a href="模型选择与评估.html#cb835-2" tabindex="-1"></a>forest_bird_model_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb835-3"><a href="模型选择与评估.html#cb835-3" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">names</span>(forest_bird_models),</span>
<span id="cb835-4"><a href="模型选择与评估.html#cb835-4" tabindex="-1"></a>  <span class="at">R2 =</span> <span class="fu">sapply</span>(forest_bird_models, <span class="cf">function</span>(m) <span class="fu">summary</span>(m)<span class="sc">$</span>r.squared),</span>
<span id="cb835-5"><a href="模型选择与评估.html#cb835-5" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">sapply</span>(forest_bird_models, AIC),</span>
<span id="cb835-6"><a href="模型选择与评估.html#cb835-6" tabindex="-1"></a>  <span class="at">BIC =</span> <span class="fu">sapply</span>(forest_bird_models, BIC),</span>
<span id="cb835-7"><a href="模型选择与评估.html#cb835-7" tabindex="-1"></a>  <span class="at">Parameters =</span> <span class="fu">sapply</span>(forest_bird_models, <span class="cf">function</span>(m) <span class="fu">length</span>(<span class="fu">coef</span>(m)))</span>
<span id="cb835-8"><a href="模型选择与评估.html#cb835-8" tabindex="-1"></a>)</span>
<span id="cb835-9"><a href="模型选择与评估.html#cb835-9" tabindex="-1"></a></span>
<span id="cb835-10"><a href="模型选择与评估.html#cb835-10" tabindex="-1"></a><span class="co"># 计算$\\text{AIC}$和$\\text{BIC}$差异</span></span>
<span id="cb835-11"><a href="模型选择与评估.html#cb835-11" tabindex="-1"></a>forest_bird_model_comparison<span class="sc">$</span>delta_AIC <span class="ot">&lt;-</span> forest_bird_model_comparison<span class="sc">$</span>AIC <span class="sc">-</span> <span class="fu">min</span>(forest_bird_model_comparison<span class="sc">$</span>AIC)</span>
<span id="cb835-12"><a href="模型选择与评估.html#cb835-12" tabindex="-1"></a>forest_bird_model_comparison<span class="sc">$</span>delta_BIC <span class="ot">&lt;-</span> forest_bird_model_comparison<span class="sc">$</span>BIC <span class="sc">-</span> <span class="fu">min</span>(forest_bird_model_comparison<span class="sc">$</span>BIC)</span>
<span id="cb835-13"><a href="模型选择与评估.html#cb835-13" tabindex="-1"></a></span>
<span id="cb835-14"><a href="模型选择与评估.html#cb835-14" tabindex="-1"></a><span class="co"># 计算$\\text{AIC}$权重</span></span>
<span id="cb835-15"><a href="模型选择与评估.html#cb835-15" tabindex="-1"></a>forest_bird_model_comparison<span class="sc">$</span>AIC_weight <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> forest_bird_model_comparison<span class="sc">$</span>delta_AIC) <span class="sc">/</span></span>
<span id="cb835-16"><a href="模型选择与评估.html#cb835-16" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> forest_bird_model_comparison<span class="sc">$</span>delta_AIC))</span>
<span id="cb835-17"><a href="模型选择与评估.html#cb835-17" tabindex="-1"></a></span>
<span id="cb835-18"><a href="模型选择与评估.html#cb835-18" tabindex="-1"></a><span class="co"># 排序</span></span>
<span id="cb835-19"><a href="模型选择与评估.html#cb835-19" tabindex="-1"></a>forest_bird_model_comparison <span class="ot">&lt;-</span> forest_bird_model_comparison[<span class="fu">order</span>(forest_bird_model_comparison<span class="sc">$</span>AIC), ]</span>
<span id="cb835-20"><a href="模型选择与评估.html#cb835-20" tabindex="-1"></a></span>
<span id="cb835-21"><a href="模型选择与评估.html#cb835-21" tabindex="-1"></a><span class="co"># 确定最优模型</span></span>
<span id="cb835-22"><a href="模型选择与评估.html#cb835-22" tabindex="-1"></a>best_aic <span class="ot">&lt;-</span> forest_bird_model_comparison<span class="sc">$</span>Model[<span class="dv">1</span>]</span>
<span id="cb835-23"><a href="模型选择与评估.html#cb835-23" tabindex="-1"></a>best_bic <span class="ot">&lt;-</span> forest_bird_model_comparison<span class="sc">$</span>Model[<span class="fu">which.min</span>(forest_bird_model_comparison<span class="sc">$</span>BIC)]</span></code></pre></div>
<pre><code>## === 林小雨的森林鸟类丰富度模型比较结果 ===</code></pre>
<pre><code>## 信息准则帮助林小雨在多个候选模型中做出科学选择</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-7">表9.1: </span>信息准则模型比较：通过ΔAIC和ΔBIC差异比较不同鸟类丰富度模型的相对优劣</caption>
<colgroup>
<col width="15%" />
<col width="15%" />
<col width="9%" />
<col width="8%" />
<col width="8%" />
<col width="10%" />
<col width="9%" />
<col width="9%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Model</th>
<th align="right">R2</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">Parameters</th>
<th align="right">delta_AIC</th>
<th align="right">delta_BIC</th>
<th align="right">AIC_weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">full_model</td>
<td align="left">full_model</td>
<td align="right">0.6061475</td>
<td align="right">737.9981</td>
<td align="right">753.6291</td>
<td align="right">5</td>
<td align="right">0.000000</td>
<td align="right">0.000000</td>
<td align="right">0.7596039</td>
</tr>
<tr class="even">
<td align="left">overfit_model</td>
<td align="left">overfit_model</td>
<td align="right">0.6127788</td>
<td align="right">740.3000</td>
<td align="right">761.1414</td>
<td align="right">7</td>
<td align="right">2.301941</td>
<td align="right">7.512282</td>
<td align="right">0.2402851</td>
</tr>
<tr class="odd">
<td align="left">area_water</td>
<td align="left">area_water</td>
<td align="right">0.5108839</td>
<td align="right">755.6604</td>
<td align="right">766.0811</td>
<td align="right">3</td>
<td align="right">17.662332</td>
<td align="right">12.451992</td>
<td align="right">0.0001110</td>
</tr>
<tr class="even">
<td align="left">area_vegetation</td>
<td align="left">area_vegetation</td>
<td align="right">0.4191497</td>
<td align="right">772.8497</td>
<td align="right">783.2704</td>
<td align="right">3</td>
<td align="right">34.851645</td>
<td align="right">29.641305</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">area_only</td>
<td align="left">area_only</td>
<td align="right">0.3416164</td>
<td align="right">783.3792</td>
<td align="right">791.1947</td>
<td align="right">2</td>
<td align="right">45.381119</td>
<td align="right">37.565609</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">vegetation_only</td>
<td align="left">vegetation_only</td>
<td align="right">0.1191910</td>
<td align="right">812.4845</td>
<td align="right">820.3000</td>
<td align="right">2</td>
<td align="right">74.486428</td>
<td align="right">66.670918</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="模型选择与评估.html#cb838-1" tabindex="-1"></a><span class="co"># 可视化信息准则比较：林小雨的森林鸟类丰富度模型</span></span>
<span id="cb838-2"><a href="模型选择与评估.html#cb838-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb838-3"><a href="模型选择与评估.html#cb838-3" tabindex="-1"></a></span>
<span id="cb838-4"><a href="模型选择与评估.html#cb838-4" tabindex="-1"></a><span class="co"># AIC比较</span></span>
<span id="cb838-5"><a href="模型选择与评估.html#cb838-5" tabindex="-1"></a><span class="fu">barplot</span>(forest_bird_model_comparison<span class="sc">$</span>delta_AIC,</span>
<span id="cb838-6"><a href="模型选择与评估.html#cb838-6" tabindex="-1"></a>  <span class="at">names.arg =</span> forest_bird_model_comparison<span class="sc">$</span>Model,</span>
<span id="cb838-7"><a href="模型选择与评估.html#cb838-7" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;林小雨的鸟类模型&quot;</span>, Delta, <span class="st">&quot;AIC差异比较&quot;</span>)),</span>
<span id="cb838-8"><a href="模型选择与评估.html#cb838-8" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;模型&quot;</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(Delta, <span class="st">&quot;AIC&quot;</span>)),</span>
<span id="cb838-9"><a href="模型选择与评估.html#cb838-9" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">ifelse</span>(forest_bird_model_comparison<span class="sc">$</span>delta_AIC <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="st">&quot;green&quot;</span>,</span>
<span id="cb838-10"><a href="模型选择与评估.html#cb838-10" tabindex="-1"></a>    <span class="fu">ifelse</span>(forest_bird_model_comparison<span class="sc">$</span>delta_AIC <span class="sc">&lt;</span> <span class="dv">7</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb838-11"><a href="模型选择与评估.html#cb838-11" tabindex="-1"></a>  ),</span>
<span id="cb838-12"><a href="模型选择与评估.html#cb838-12" tabindex="-1"></a>  <span class="at">las =</span> <span class="dv">2</span>, <span class="at">cex.names =</span> <span class="fl">0.7</span></span>
<span id="cb838-13"><a href="模型选择与评估.html#cb838-13" tabindex="-1"></a>)</span>
<span id="cb838-14"><a href="模型选择与评估.html#cb838-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb838-15"><a href="模型选择与评估.html#cb838-15" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">7</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb838-16"><a href="模型选择与评估.html#cb838-16" tabindex="-1"></a></span>
<span id="cb838-17"><a href="模型选择与评估.html#cb838-17" tabindex="-1"></a><span class="co"># BIC比较</span></span>
<span id="cb838-18"><a href="模型选择与评估.html#cb838-18" tabindex="-1"></a><span class="fu">barplot</span>(forest_bird_model_comparison<span class="sc">$</span>delta_BIC,</span>
<span id="cb838-19"><a href="模型选择与评估.html#cb838-19" tabindex="-1"></a>  <span class="at">names.arg =</span> forest_bird_model_comparison<span class="sc">$</span>Model,</span>
<span id="cb838-20"><a href="模型选择与评估.html#cb838-20" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;林小雨的鸟类模型&quot;</span>, Delta, <span class="st">&quot;BIC差异比较&quot;</span>)),</span>
<span id="cb838-21"><a href="模型选择与评估.html#cb838-21" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;模型&quot;</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(Delta, <span class="st">&quot;BIC&quot;</span>)),</span>
<span id="cb838-22"><a href="模型选择与评估.html#cb838-22" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">ifelse</span>(forest_bird_model_comparison<span class="sc">$</span>delta_BIC <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="st">&quot;green&quot;</span>,</span>
<span id="cb838-23"><a href="模型选择与评估.html#cb838-23" tabindex="-1"></a>    <span class="fu">ifelse</span>(forest_bird_model_comparison<span class="sc">$</span>delta_BIC <span class="sc">&lt;</span> <span class="dv">7</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb838-24"><a href="模型选择与评估.html#cb838-24" tabindex="-1"></a>  ),</span>
<span id="cb838-25"><a href="模型选择与评估.html#cb838-25" tabindex="-1"></a>  <span class="at">las =</span> <span class="dv">2</span>, <span class="at">cex.names =</span> <span class="fl">0.7</span></span>
<span id="cb838-26"><a href="模型选择与评估.html#cb838-26" tabindex="-1"></a>)</span>
<span id="cb838-27"><a href="模型选择与评估.html#cb838-27" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb838-28"><a href="模型选择与评估.html#cb838-28" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">7</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-8-1.png" alt="信息准则可视化：ΔAIC和ΔBIC差异比较" width="80%" />
<p class="caption">
图8.1: 信息准则可视化：ΔAIC和ΔBIC差异比较
</p>
</div>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="模型选择与评估.html#cb839-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>根据信息准则的分析结果，林小雨得出了重要的模型选择启示。根据<span class="math inline">\(\text{AIC}\)</span>准则，最优模型是full_model，其<span class="math inline">\(\text{AIC}\)</span>权重为0.76，表明这个模型在候选模型中最有可能。根据<span class="math inline">\(\text{BIC}\)</span>准则，最优模型是full_model，<span class="math inline">\(\text{BIC}\)</span>倾向于选择更简约的模型。模型选择启示表明，full_model模型在<span class="math inline">\(\text{AIC}\)</span>和<span class="math inline">\(\text{BIC}\)</span>下都表现良好，这个模型包含了真实关系中的关键变量，而过度拟合模型虽然R²更高，但信息准则惩罚了其复杂度。</p>
<p>在林小雨的森林鸟类丰富度研究中，栖息地面积和植被密度是影响鸟类丰富度的关键因子，信息准则帮助她识别了这些关键因子，避免了过度拟合。最优模型既统计可靠又具有明确的生态学意义，为她的森林保护研究提供了科学依据。</p>
</div>
<div id="似然比检验" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> 似然比检验<a href="模型选择与评估.html#似然比检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>林小雨在分析植物生长与温度、光照的关系时，遇到了一个重要的统计问题：是否需要考虑温度与光照的交互作用？这个问题引出了似然比检验的应用。似然比检验是模型选择中用于比较嵌套模型的经典统计方法。在生态学研究中，嵌套模型是指一个模型是另一个模型的特殊情形，通常通过约束某些参数为零或相等来实现。似然比检验通过比较两个嵌套模型的拟合差异，来判断增加模型复杂度是否带来了统计上显著的改善。</p>
<p><strong>基本原理</strong>：似然比检验基于两个嵌套模型的最大似然值比较。设<span class="math inline">\(L_0\)</span>为简单模型（零模型）的最大似然值，<span class="math inline">\(L_1\)</span>为复杂模型（备择模型）的最大似然值。似然比统计量<span class="math display">\[\text{LR} = -2 \ln\left(\frac{L_0}{L_1}\right) = 2(\ln L_1 - \ln L_0)\]</span>。在零假设（简单模型足够好）下，LR统计量近似服从卡方分布，自由度为两个模型参数数量的差异。</p>
<p>似然比检验的生态学意义在于它提供了统计显著性检验，帮助我们判断增加模型复杂度是否值得。例如，在研究物种分布与环境因子的关系时，我们可能想知道是否需要考虑环境因子之间的交互作用。通过比较包含交互项的模型和不包含交互项的模型，似然比检验可以告诉我们交互作用是否统计显著。</p>
<p><strong>应用场景</strong>：似然比检验在生态学中有广泛的应用。在广义线性模型中，它可以用于比较不同的连接函数；在混合效应模型中，它可以用于检验随机效应的显著性；在物种分布模型中，它可以用于比较不同的环境变量组合。</p>
<p><strong>局限性</strong>：似然比检验只能用于比较嵌套模型，对于非嵌套模型的比较无能为力。此外，似然比检验对样本量敏感，大样本情况下即使很小的改善也可能统计显著，但这不一定具有生态学意义。</p>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="模型选择与评估.html#cb840-1" tabindex="-1"></a><span class="co"># 似然比检验数据生成：林小雨的苗圃实验 - 植物生长与温度、光照的关系</span></span>
<span id="cb840-2"><a href="模型选择与评估.html#cb840-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb840-3"><a href="模型选择与评估.html#cb840-3" tabindex="-1"></a></span>
<span id="cb840-4"><a href="模型选择与评估.html#cb840-4" tabindex="-1"></a><span class="co"># 生成林小雨的苗圃实验数据：植物生长与温度、光照的关系</span></span>
<span id="cb840-5"><a href="模型选择与评估.html#cb840-5" tabindex="-1"></a>n_nursery_plants <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb840-6"><a href="模型选择与评估.html#cb840-6" tabindex="-1"></a></span>
<span id="cb840-7"><a href="模型选择与评估.html#cb840-7" tabindex="-1"></a><span class="co"># 林小雨在苗圃中控制的环境因子</span></span>
<span id="cb840-8"><a href="模型选择与评估.html#cb840-8" tabindex="-1"></a>nursery_temperature <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_nursery_plants, <span class="dv">15</span>, <span class="dv">30</span>) <span class="co"># 温度(°C)</span></span>
<span id="cb840-9"><a href="模型选择与评估.html#cb840-9" tabindex="-1"></a>nursery_light_intensity <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_nursery_plants, <span class="dv">100</span>, <span class="dv">1000</span>) <span class="co"># 光照强度(lux)</span></span>
<span id="cb840-10"><a href="模型选择与评估.html#cb840-10" tabindex="-1"></a></span>
<span id="cb840-11"><a href="模型选择与评估.html#cb840-11" tabindex="-1"></a><span class="co"># 生成植物生长数据（存在温度-光照交互作用）</span></span>
<span id="cb840-12"><a href="模型选择与评估.html#cb840-12" tabindex="-1"></a>nursery_growth_rate <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> nursery_temperature <span class="sc">+</span> <span class="fl">0.002</span> <span class="sc">*</span> nursery_light_intensity <span class="sc">+</span></span>
<span id="cb840-13"><a href="模型选择与评估.html#cb840-13" tabindex="-1"></a>  <span class="fl">0.0001</span> <span class="sc">*</span> nursery_temperature <span class="sc">*</span> nursery_light_intensity <span class="sc">+</span> <span class="fu">rnorm</span>(n_nursery_plants, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb840-14"><a href="模型选择与评估.html#cb840-14" tabindex="-1"></a></span>
<span id="cb840-15"><a href="模型选择与评估.html#cb840-15" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb840-16"><a href="模型选择与评估.html#cb840-16" tabindex="-1"></a>nursery_plant_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb840-17"><a href="模型选择与评估.html#cb840-17" tabindex="-1"></a>  <span class="at">growth =</span> nursery_growth_rate,</span>
<span id="cb840-18"><a href="模型选择与评估.html#cb840-18" tabindex="-1"></a>  <span class="at">temp =</span> nursery_temperature,</span>
<span id="cb840-19"><a href="模型选择与评估.html#cb840-19" tabindex="-1"></a>  <span class="at">light =</span> nursery_light_intensity</span>
<span id="cb840-20"><a href="模型选择与评估.html#cb840-20" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="模型选择与评估.html#cb841-1" tabindex="-1"></a><span class="co"># 构建嵌套模型进行比较：林小雨的苗圃实验模型</span></span>
<span id="cb841-2"><a href="模型选择与评估.html#cb841-2" tabindex="-1"></a><span class="co"># 简单模型：只有主效应</span></span>
<span id="cb841-3"><a href="模型选择与评估.html#cb841-3" tabindex="-1"></a>nursery_model_simple <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> temp <span class="sc">+</span> light, <span class="at">data =</span> nursery_plant_data)</span>
<span id="cb841-4"><a href="模型选择与评估.html#cb841-4" tabindex="-1"></a></span>
<span id="cb841-5"><a href="模型选择与评估.html#cb841-5" tabindex="-1"></a><span class="co"># 复杂模型：包含交互项</span></span>
<span id="cb841-6"><a href="模型选择与评估.html#cb841-6" tabindex="-1"></a>nursery_model_complex <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth <span class="sc">~</span> temp <span class="sc">*</span> light, <span class="at">data =</span> nursery_plant_data)</span>
<span id="cb841-7"><a href="模型选择与评估.html#cb841-7" tabindex="-1"></a></span>
<span id="cb841-8"><a href="模型选择与评估.html#cb841-8" tabindex="-1"></a><span class="co"># 执行似然比检验</span></span>
<span id="cb841-9"><a href="模型选择与评估.html#cb841-9" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb841-10"><a href="模型选择与评估.html#cb841-10" tabindex="-1"></a>nursery_lrt_result <span class="ot">&lt;-</span> <span class="fu">lrtest</span>(nursery_model_simple, nursery_model_complex)</span>
<span id="cb841-11"><a href="模型选择与评估.html#cb841-11" tabindex="-1"></a></span>
<span id="cb841-12"><a href="模型选择与评估.html#cb841-12" tabindex="-1"></a><span class="co"># 提取似然比检验的p值</span></span>
<span id="cb841-13"><a href="模型选择与评估.html#cb841-13" tabindex="-1"></a>nursery_lrt_p_value <span class="ot">&lt;-</span> nursery_lrt_result<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chisq)</span><span class="st">`</span>[<span class="dv">2</span>]</span></code></pre></div>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="模型选择与评估.html#cb842-1" tabindex="-1"></a><span class="co"># 输出似然比检验结果</span></span>
<span id="cb842-2"><a href="模型选择与评估.html#cb842-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(nursery_lrt_result, <span class="at">caption =</span> <span class="st">&quot;似然比检验结果：植物生长与温度、光照的关系&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-11">表9.2: </span>似然比检验结果：植物生长与温度、光照的关系</caption>
<thead>
<tr class="header">
<th align="right">#Df</th>
<th align="right">LogLik</th>
<th align="right">Df</th>
<th align="right">Chisq</th>
<th align="right">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">-58.86869</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">-56.40071</td>
<td align="right">1</td>
<td align="right">4.935962</td>
<td align="right">0.0263034</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="模型选择与评估.html#cb843-1" tabindex="-1"></a><span class="co"># 模型摘要比较</span></span>
<span id="cb843-2"><a href="模型选择与评估.html#cb843-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(nursery_model_simple)<span class="sc">$</span>coefficients, <span class="at">caption =</span> <span class="st">&quot;模型比较：简单模型 (只有主效应)&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-11">表9.2: </span>模型比较：简单模型 (只有主效应)</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.9522163</td>
<td align="right">0.3475783</td>
<td align="right">2.739574</td>
<td align="right">0.0076414</td>
</tr>
<tr class="even">
<td align="left">temp</td>
<td align="right">0.1589956</td>
<td align="right">0.0149805</td>
<td align="right">10.613532</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">light</td>
<td align="right">0.0037280</td>
<td align="right">0.0002189</td>
<td align="right">17.031520</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="模型选择与评估.html#cb844-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">复杂模型 (包含交互项):</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 复杂模型 (包含交互项):</code></pre>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="模型选择与评估.html#cb846-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">summary</span>(nursery_model_complex)<span class="sc">$</span>coefficients, <span class="at">caption =</span> <span class="st">&quot;模型比较：复杂模型 (包含交互项)&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-11">表9.2: </span>模型比较：复杂模型 (包含交互项)</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.6217208</td>
<td align="right">0.8314621</td>
<td align="right">3.1531452</td>
<td align="right">0.0023129</td>
</tr>
<tr class="even">
<td align="left">temp</td>
<td align="right">0.0819161</td>
<td align="right">0.0379749</td>
<td align="right">2.1571128</td>
<td align="right">0.0341579</td>
</tr>
<tr class="odd">
<td align="left">light</td>
<td align="right">0.0009324</td>
<td align="right">0.0012889</td>
<td align="right">0.7234173</td>
<td align="right">0.4716442</td>
</tr>
<tr class="even">
<td align="left">temp:light</td>
<td align="right">0.0001286</td>
<td align="right">0.0000585</td>
<td align="right">2.1992829</td>
<td align="right">0.0308988</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="模型选择与评估.html#cb847-1" tabindex="-1"></a><span class="co"># 计算模型改善程度</span></span>
<span id="cb847-2"><a href="模型选择与评估.html#cb847-2" tabindex="-1"></a>nursery_r2_simple <span class="ot">&lt;-</span> <span class="fu">summary</span>(nursery_model_simple)<span class="sc">$</span>r.squared</span>
<span id="cb847-3"><a href="模型选择与评估.html#cb847-3" tabindex="-1"></a>nursery_r2_complex <span class="ot">&lt;-</span> <span class="fu">summary</span>(nursery_model_complex)<span class="sc">$</span>r.squared</span>
<span id="cb847-4"><a href="模型选择与评估.html#cb847-4" tabindex="-1"></a>nursery_r2_improvement <span class="ot">&lt;-</span> nursery_r2_complex <span class="sc">-</span> nursery_r2_simple</span></code></pre></div>
<pre><code>## 
## === 模型改善分析 ===
##  R²改善: 0.0093 
##  参数增加: 1个 (交互项)
##  似然比检验p值: 0.0263</code></pre>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="模型选择与评估.html#cb849-1" tabindex="-1"></a><span class="co"># 解释似然比检验结果</span></span>
<span id="cb849-2"><a href="模型选择与评估.html#cb849-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;似然比检验结果已计算，请查看后续生态学解释。</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 似然比检验结果已计算，请查看后续生态学解释。</code></pre>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="模型选择与评估.html#cb851-1" tabindex="-1"></a><span class="co"># 可视化交互作用</span></span>
<span id="cb851-2"><a href="模型选择与评估.html#cb851-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 交互作用可视化 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 交互作用可视化 ===</code></pre>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="模型选择与评估.html#cb853-1" tabindex="-1"></a><span class="co"># 创建预测网格</span></span>
<span id="cb853-2"><a href="模型选择与评估.html#cb853-2" tabindex="-1"></a>nursery_pred_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb853-3"><a href="模型选择与评估.html#cb853-3" tabindex="-1"></a>  <span class="at">temp =</span> <span class="fu">seq</span>(<span class="dv">15</span>, <span class="dv">30</span>, <span class="at">length.out =</span> <span class="dv">20</span>),</span>
<span id="cb853-4"><a href="模型选择与评估.html#cb853-4" tabindex="-1"></a>  <span class="at">light =</span> <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">600</span>, <span class="dv">900</span>) <span class="co"># 低、中、高光照</span></span>
<span id="cb853-5"><a href="模型选择与评估.html#cb853-5" tabindex="-1"></a>)</span>
<span id="cb853-6"><a href="模型选择与评估.html#cb853-6" tabindex="-1"></a></span>
<span id="cb853-7"><a href="模型选择与评估.html#cb853-7" tabindex="-1"></a><span class="co"># 使用复杂模型进行预测</span></span>
<span id="cb853-8"><a href="模型选择与评估.html#cb853-8" tabindex="-1"></a>nursery_pred_grid<span class="sc">$</span>pred_growth <span class="ot">&lt;-</span> <span class="fu">predict</span>(nursery_model_complex, <span class="at">newdata =</span> nursery_pred_grid)</span>
<span id="cb853-9"><a href="模型选择与评估.html#cb853-9" tabindex="-1"></a></span>
<span id="cb853-10"><a href="模型选择与评估.html#cb853-10" tabindex="-1"></a><span class="co"># 绘制交互作用图</span></span>
<span id="cb853-11"><a href="模型选择与评估.html#cb853-11" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb853-12"><a href="模型选择与评估.html#cb853-12" tabindex="-1"></a><span class="fu">ggplot</span>(nursery_pred_grid, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> pred_growth, <span class="at">color =</span> <span class="fu">factor</span>(light))) <span class="sc">+</span></span>
<span id="cb853-13"><a href="模型选择与评估.html#cb853-13" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb853-14"><a href="模型选择与评估.html#cb853-14" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb853-15"><a href="模型选择与评估.html#cb853-15" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;林小雨的苗圃实验：温度与光照对植物生长的交互作用&quot;</span>,</span>
<span id="cb853-16"><a href="模型选择与评估.html#cb853-16" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;温度 (°C)&quot;</span>,</span>
<span id="cb853-17"><a href="模型选择与评估.html#cb853-17" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;预测生长速率&quot;</span>,</span>
<span id="cb853-18"><a href="模型选择与评估.html#cb853-18" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;光照强度 (lux)&quot;</span></span>
<span id="cb853-19"><a href="模型选择与评估.html#cb853-19" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb853-20"><a href="模型选择与评估.html#cb853-20" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb853-21"><a href="模型选择与评估.html#cb853-21" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;300&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;600&quot;</span> <span class="ot">=</span> <span class="st">&quot;green&quot;</span>, <span class="st">&quot;900&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-14-1.png" alt="林小雨的苗圃实验：温度与光照对植物生长的交互作用。在不同光照强度下温度对植物生长速率的影响，展示了环境因子交互作用在植物生长中的重要性" width="80%" />
<p class="caption">
图8.2: 林小雨的苗圃实验：温度与光照对植物生长的交互作用。在不同光照强度下温度对植物生长速率的影响，展示了环境因子交互作用在植物生长中的重要性
</p>
</div>
<p>根据似然比检验的结果（p值 = 0.0263），我们可以得出重要的生态学解释。似然比检验显著 (p &lt; 0.05)，表明温度与光照的交互作用对植物生长有显著影响，复杂模型显著改善了模型拟合，应该选择包含交互项的模型。</p>
<pre><code>## === 林小雨的苗圃实验生态学解释 ===</code></pre>
<pre><code>## 林小雨的苗圃实验结果表明，温度与光照的交互作用对植物生长有显著影响。
## 生态学意义：
## - 在低光照条件下，温度升高对植物生长的促进作用有限
## - 在高光照条件下，温度升高显著促进植物生长
## - 这种交互作用反映了植物对光热资源的协同利用机制
## 
## 林小雨的启示：在苗圃管理中，需要同时考虑温度和光照的协同效应，
## 而不是单独优化单个环境因子。</code></pre>
</div>
<div id="模型平均" class="section level3 hasAnchor" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> 模型平均<a href="模型选择与评估.html#模型平均" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>林小雨在研究溪流鱼类丰度与环境因子的关系时，面临着多个看似合理的模型选择。水温、溶解氧、pH值和浊度都可能影响鱼类分布，但她不确定哪些因子真正重要。模型平均为她提供了一种系统的方法来处理这种不确定性，通过组合多个候选模型的预测来获得更稳健的结论。</p>
<p>模型平均是现代生态统计建模中的重要方法，它通过组合多个候选模型的预测来减少模型选择的不确定性。在生态学研究中，我们经常面临多个看似合理的模型，每个模型都基于不同的生态学假设。模型平均承认这种不确定性，并通过加权平均的方式利用所有候选模型的信息。</p>
<p><strong>基本原理</strong>：模型平均的核心思想是，没有一个模型是绝对正确的，但每个模型都可能包含部分真理。通过给不同的模型分配权重，然后组合它们的预测，我们可以获得更稳健、更准确的估计。模型权重通常基于信息准则（如<span class="math inline">\(\text{AIC}\)</span>权重）计算，权重反映了每个模型相对其他模型的证据强度。</p>
<p><strong><span class="math inline">\(\text{AIC}\)</span>权重</strong>是最常用的模型权重计算方法。对于每个模型<span class="math inline">\(i\)</span>，其<span class="math inline">\(\text{AIC}\)</span>权重<span class="math display">\[w_i = \frac{\exp(-0.5 \Delta\text{AIC}_i)}{\sum_j \exp(-0.5 \Delta\text{AIC}_j)}\]</span>，其中<span class="math inline">\(\Delta\text{AIC}_i\)</span>是模型<span class="math inline">\(i\)</span>与最优模型的<span class="math inline">\(\text{AIC}\)</span>差异。<span class="math inline">\(\text{AIC}\)</span>权重可以解释为模型<span class="math inline">\(i\)</span>是真实模型的相对概率。</p>
<p><strong>模型平均的类型</strong>：模型平均主要分为两种类型。参数平均是对不同模型的参数估计进行加权平均，适用于模型具有相同参数结构的情况。预测平均是对不同模型的预测值进行加权平均，适用于模型结构不同的情况。在生态学中，预测平均更为常用，因为它可以处理具有不同变量组合的模型。</p>
<p><strong>生态学意义</strong>：模型平均在生态学中具有重要的应用价值。首先，它减少了模型选择的不确定性，避免了”赢者通吃”的问题。其次，它提供了更稳健的参数估计和预测，特别是在小样本情况下。第三，它允许我们量化不同生态学假设的相对支持程度。</p>
<p><strong>局限性</strong>：模型平均需要谨慎使用。首先，它假设候选模型已经包含了真实模型，这在生态学中往往不成立。其次，模型平均可能稀释强信号，如果有一个明显优于其他模型的候选模型，模型平均可能不如直接选择这个最优模型。第三，模型平均的计算复杂度较高，特别是当候选模型数量很多时。</p>
<p>模型平均是现代生态统计建模中的重要方法，它通过组合多个候选模型的预测来减少模型选择的不确定性。在生态学研究中，我们经常面临多个看似合理的模型，每个模型都基于不同的生态学假设。模型平均承认这种不确定性，并通过加权平均的方式利用所有候选模型的信息。</p>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="模型选择与评估.html#cb856-1" tabindex="-1"></a><span class="co"># 模型平均在生态学中的应用 - 数据生成</span></span>
<span id="cb856-2"><a href="模型选择与评估.html#cb856-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb856-3"><a href="模型选择与评估.html#cb856-3" tabindex="-1"></a></span>
<span id="cb856-4"><a href="模型选择与评估.html#cb856-4" tabindex="-1"></a><span class="co"># 生成林小雨的溪流鱼类调查数据：鱼类丰度与水体环境因子的关系</span></span>
<span id="cb856-5"><a href="模型选择与评估.html#cb856-5" tabindex="-1"></a>n_stream_fish <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb856-6"><a href="模型选择与评估.html#cb856-6" tabindex="-1"></a></span>
<span id="cb856-7"><a href="模型选择与评估.html#cb856-7" tabindex="-1"></a><span class="co"># 林小雨在溪流调查中测量的环境因子</span></span>
<span id="cb856-8"><a href="模型选择与评估.html#cb856-8" tabindex="-1"></a>stream_water_temp <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_stream_fish, <span class="dv">10</span>, <span class="dv">25</span>) <span class="co"># 水温(°C)</span></span>
<span id="cb856-9"><a href="模型选择与评估.html#cb856-9" tabindex="-1"></a>stream_dissolved_oxygen <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_stream_fish, <span class="dv">2</span>, <span class="dv">10</span>) <span class="co"># 溶解氧(mg/L)</span></span>
<span id="cb856-10"><a href="模型选择与评估.html#cb856-10" tabindex="-1"></a>stream_ph_level <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_stream_fish, <span class="fl">6.5</span>, <span class="fl">8.5</span>) <span class="co"># pH值</span></span>
<span id="cb856-11"><a href="模型选择与评估.html#cb856-11" tabindex="-1"></a>stream_turbidity <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_stream_fish, <span class="dv">1</span>, <span class="dv">50</span>) <span class="co"># 浊度(NTU)</span></span>
<span id="cb856-12"><a href="模型选择与评估.html#cb856-12" tabindex="-1"></a></span>
<span id="cb856-13"><a href="模型选择与评估.html#cb856-13" tabindex="-1"></a><span class="co"># 生成鱼类丰度数据</span></span>
<span id="cb856-14"><a href="模型选择与评估.html#cb856-14" tabindex="-1"></a><span class="co"># 真实关系：丰度 ~ 水温 + 溶解氧 + pH</span></span>
<span id="cb856-15"><a href="模型选择与评估.html#cb856-15" tabindex="-1"></a>stream_fish_abundance <span class="ot">&lt;-</span> <span class="fu">rpois</span>(</span>
<span id="cb856-16"><a href="模型选择与评估.html#cb856-16" tabindex="-1"></a>  n_stream_fish,</span>
<span id="cb856-17"><a href="模型选择与评估.html#cb856-17" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fl">2.0</span> <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> stream_water_temp <span class="sc">+</span></span>
<span id="cb856-18"><a href="模型选择与评估.html#cb856-18" tabindex="-1"></a>    <span class="fl">0.15</span> <span class="sc">*</span> stream_dissolved_oxygen <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> stream_ph_level <span class="sc">+</span></span>
<span id="cb856-19"><a href="模型选择与评估.html#cb856-19" tabindex="-1"></a>    <span class="fu">rnorm</span>(n_stream_fish, <span class="dv">0</span>, <span class="fl">0.2</span>))</span>
<span id="cb856-20"><a href="模型选择与评估.html#cb856-20" tabindex="-1"></a>)</span>
<span id="cb856-21"><a href="模型选择与评估.html#cb856-21" tabindex="-1"></a></span>
<span id="cb856-22"><a href="模型选择与评估.html#cb856-22" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb856-23"><a href="模型选择与评估.html#cb856-23" tabindex="-1"></a>stream_fish_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb856-24"><a href="模型选择与评估.html#cb856-24" tabindex="-1"></a>  <span class="at">abundance =</span> stream_fish_abundance,</span>
<span id="cb856-25"><a href="模型选择与评估.html#cb856-25" tabindex="-1"></a>  <span class="at">temp =</span> stream_water_temp,</span>
<span id="cb856-26"><a href="模型选择与评估.html#cb856-26" tabindex="-1"></a>  <span class="at">oxygen =</span> stream_dissolved_oxygen,</span>
<span id="cb856-27"><a href="模型选择与评估.html#cb856-27" tabindex="-1"></a>  <span class="at">ph =</span> stream_ph_level,</span>
<span id="cb856-28"><a href="模型选择与评估.html#cb856-28" tabindex="-1"></a>  <span class="at">turbidity =</span> stream_turbidity</span>
<span id="cb856-29"><a href="模型选择与评估.html#cb856-29" tabindex="-1"></a>)</span></code></pre></div>
<p>构建基于不同生态学假设的候选模型是模型平均的第一步。每个模型代表了对生态过程的一种可能解释，模型平均通过AIC权重量化这些解释的相对合理性。</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="模型选择与评估.html#cb857-1" tabindex="-1"></a><span class="co"># 构建多个候选模型（基于林小雨的不同生态学假设）</span></span>
<span id="cb857-2"><a href="模型选择与评估.html#cb857-2" tabindex="-1"></a>stream_fish_models <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb857-3"><a href="模型选择与评估.html#cb857-3" tabindex="-1"></a></span>
<span id="cb857-4"><a href="模型选择与评估.html#cb857-4" tabindex="-1"></a><span class="co"># 模型1：温度主导假说</span></span>
<span id="cb857-5"><a href="模型选择与评估.html#cb857-5" tabindex="-1"></a>stream_fish_models[[<span class="st">&quot;temp_model&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(abundance <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> temp, <span class="at">data =</span> stream_fish_data)</span>
<span id="cb857-6"><a href="模型选择与评估.html#cb857-6" tabindex="-1"></a></span>
<span id="cb857-7"><a href="模型选择与评估.html#cb857-7" tabindex="-1"></a><span class="co"># 模型2：水质综合假说</span></span>
<span id="cb857-8"><a href="模型选择与评估.html#cb857-8" tabindex="-1"></a>stream_fish_models[[<span class="st">&quot;water_quality&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(abundance <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> temp <span class="sc">+</span> oxygen <span class="sc">+</span> ph, <span class="at">data =</span> stream_fish_data)</span>
<span id="cb857-9"><a href="模型选择与评估.html#cb857-9" tabindex="-1"></a></span>
<span id="cb857-10"><a href="模型选择与评估.html#cb857-10" tabindex="-1"></a><span class="co"># 模型3：物理环境假说</span></span>
<span id="cb857-11"><a href="模型选择与评估.html#cb857-11" tabindex="-1"></a>stream_fish_models[[<span class="st">&quot;physical_env&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(abundance <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> temp <span class="sc">+</span> turbidity, <span class="at">data =</span> stream_fish_data)</span>
<span id="cb857-12"><a href="模型选择与评估.html#cb857-12" tabindex="-1"></a></span>
<span id="cb857-13"><a href="模型选择与评估.html#cb857-13" tabindex="-1"></a><span class="co"># 模型4：全模型</span></span>
<span id="cb857-14"><a href="模型选择与评估.html#cb857-14" tabindex="-1"></a>stream_fish_models[[<span class="st">&quot;full_model&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(abundance <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> temp <span class="sc">+</span> oxygen <span class="sc">+</span> ph <span class="sc">+</span> turbidity, <span class="at">data =</span> stream_fish_data)</span>
<span id="cb857-15"><a href="模型选择与评估.html#cb857-15" tabindex="-1"></a></span>
<span id="cb857-16"><a href="模型选择与评估.html#cb857-16" tabindex="-1"></a><span class="co"># 计算$\\text{AIC}$和权重</span></span>
<span id="cb857-17"><a href="模型选择与评估.html#cb857-17" tabindex="-1"></a>stream_aic_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(stream_fish_models, AIC)</span>
<span id="cb857-18"><a href="模型选择与评估.html#cb857-18" tabindex="-1"></a>stream_delta_aic <span class="ot">&lt;-</span> stream_aic_values <span class="sc">-</span> <span class="fu">min</span>(stream_aic_values)</span>
<span id="cb857-19"><a href="模型选择与评估.html#cb857-19" tabindex="-1"></a>stream_aic_weights <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> stream_delta_aic) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> stream_delta_aic))</span>
<span id="cb857-20"><a href="模型选择与评估.html#cb857-20" tabindex="-1"></a></span>
<span id="cb857-21"><a href="模型选择与评估.html#cb857-21" tabindex="-1"></a><span class="co"># 创建模型比较表</span></span>
<span id="cb857-22"><a href="模型选择与评估.html#cb857-22" tabindex="-1"></a>stream_model_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb857-23"><a href="模型选择与评估.html#cb857-23" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">names</span>(stream_fish_models),</span>
<span id="cb857-24"><a href="模型选择与评估.html#cb857-24" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">round</span>(stream_aic_values, <span class="dv">2</span>),</span>
<span id="cb857-25"><a href="模型选择与评估.html#cb857-25" tabindex="-1"></a>  <span class="at">Delta_AIC =</span> <span class="fu">round</span>(stream_delta_aic, <span class="dv">2</span>),</span>
<span id="cb857-26"><a href="模型选择与评估.html#cb857-26" tabindex="-1"></a>  <span class="at">AIC_Weight =</span> <span class="fu">round</span>(stream_aic_weights, <span class="dv">3</span>),</span>
<span id="cb857-27"><a href="模型选择与评估.html#cb857-27" tabindex="-1"></a>  <span class="at">R2 =</span> <span class="fu">round</span>(<span class="fu">sapply</span>(stream_fish_models, <span class="cf">function</span>(m) <span class="fu">summary</span>(m)<span class="sc">$</span>r.squared), <span class="dv">3</span>)</span>
<span id="cb857-28"><a href="模型选择与评估.html#cb857-28" tabindex="-1"></a>)</span>
<span id="cb857-29"><a href="模型选择与评估.html#cb857-29" tabindex="-1"></a></span>
<span id="cb857-30"><a href="模型选择与评估.html#cb857-30" tabindex="-1"></a>stream_model_comparison <span class="ot">&lt;-</span> stream_model_comparison[<span class="fu">order</span>(stream_model_comparison<span class="sc">$</span>AIC), ]</span></code></pre></div>
<p>MuMIn包提供了自动化的模型平均工具。dredge函数生成所有可能的模型组合，model.avg函数执行模型平均，sw函数计算变量重要性。这些工具大大简化了模型平均的实施过程。</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="模型选择与评估.html#cb858-1" tabindex="-1"></a><span class="co"># 执行模型平均</span></span>
<span id="cb858-2"><a href="模型选择与评估.html#cb858-2" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb858-3"><a href="模型选择与评估.html#cb858-3" tabindex="-1"></a></span>
<span id="cb858-4"><a href="模型选择与评估.html#cb858-4" tabindex="-1"></a><span class="co"># 使用dredge函数自动生成所有可能的模型组合</span></span>
<span id="cb858-5"><a href="模型选择与评估.html#cb858-5" tabindex="-1"></a>stream_full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(abundance <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> temp <span class="sc">+</span> oxygen <span class="sc">+</span> ph <span class="sc">+</span> turbidity,</span>
<span id="cb858-6"><a href="模型选择与评估.html#cb858-6" tabindex="-1"></a>  <span class="at">data =</span> stream_fish_data, <span class="at">na.action =</span> <span class="st">&quot;na.fail&quot;</span></span>
<span id="cb858-7"><a href="模型选择与评估.html#cb858-7" tabindex="-1"></a>)</span>
<span id="cb858-8"><a href="模型选择与评估.html#cb858-8" tabindex="-1"></a></span>
<span id="cb858-9"><a href="模型选择与评估.html#cb858-9" tabindex="-1"></a><span class="co"># 生成所有子模型</span></span>
<span id="cb858-10"><a href="模型选择与评估.html#cb858-10" tabindex="-1"></a>stream_all_models <span class="ot">&lt;-</span> <span class="fu">dredge</span>(stream_full_model)</span>
<span id="cb858-11"><a href="模型选择与评估.html#cb858-11" tabindex="-1"></a></span>
<span id="cb858-12"><a href="模型选择与评估.html#cb858-12" tabindex="-1"></a><span class="co"># 执行模型平均</span></span>
<span id="cb858-13"><a href="模型选择与评估.html#cb858-13" tabindex="-1"></a>stream_avg_model <span class="ot">&lt;-</span> <span class="fu">model.avg</span>(stream_all_models, <span class="at">fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb858-14"><a href="模型选择与评估.html#cb858-14" tabindex="-1"></a></span>
<span id="cb858-15"><a href="模型选择与评估.html#cb858-15" tabindex="-1"></a><span class="co"># 输出模型平均结果</span></span>
<span id="cb858-16"><a href="模型选择与评估.html#cb858-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 林小雨的溪流鱼类模型平均结果 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 林小雨的溪流鱼类模型平均结果 ===</code></pre>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="模型选择与评估.html#cb860-1" tabindex="-1"></a><span class="co"># 提取平均模型的系数</span></span>
<span id="cb860-2"><a href="模型选择与评估.html#cb860-2" tabindex="-1"></a>stream_avg_coef <span class="ot">&lt;-</span> <span class="fu">summary</span>(stream_avg_model)<span class="sc">$</span>coefmat.full</span>
<span id="cb860-3"><a href="模型选择与评估.html#cb860-3" tabindex="-1"></a></span>
<span id="cb860-4"><a href="模型选择与评估.html#cb860-4" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(stream_avg_coef, <span class="at">caption =</span> <span class="st">&quot;林小雨的溪流鱼类模型平均结果：平均模型系数&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-18">表9.3: </span>林小雨的溪流鱼类模型平均结果：平均模型系数</caption>
<colgroup>
<col width="15%" />
<col width="14%" />
<col width="14%" />
<col width="15%" />
<col width="14%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">Adjusted SE</th>
<th align="right">z value</th>
<th align="right">Pr(&gt;|z|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.6226421</td>
<td align="right">0.2324172</td>
<td align="right">0.2348710</td>
<td align="right">6.9086519</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">oxygen</td>
<td align="right">0.1702822</td>
<td align="right">0.0075580</td>
<td align="right">0.0076378</td>
<td align="right">22.2946060</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">ph</td>
<td align="right">0.8242705</td>
<td align="right">0.0293587</td>
<td align="right">0.0296689</td>
<td align="right">27.7823265</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">temp</td>
<td align="right">0.0531857</td>
<td align="right">0.0037299</td>
<td align="right">0.0037693</td>
<td align="right">14.1103420</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">turbidity</td>
<td align="right">-0.0001485</td>
<td align="right">0.0007176</td>
<td align="right">0.0007243</td>
<td align="right">0.2050028</td>
<td align="right">0.8375699</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="模型选择与评估.html#cb861-1" tabindex="-1"></a><span class="co"># 计算变量重要性</span></span>
<span id="cb861-2"><a href="模型选择与评估.html#cb861-2" tabindex="-1"></a>stream_var_importance <span class="ot">&lt;-</span> <span class="fu">sw</span>(stream_all_models)</span>
<span id="cb861-3"><a href="模型选择与评估.html#cb861-3" tabindex="-1"></a></span>
<span id="cb861-4"><a href="模型选择与评估.html#cb861-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 变量重要性 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## === 变量重要性 ===</code></pre>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="模型选择与评估.html#cb863-1" tabindex="-1"></a><span class="fu">print</span>(stream_var_importance)</span></code></pre></div>
<pre><code>##                      oxygen ph   temp turbidity
## Sum of weights:      1.00   1.00 1.00 0.27     
## N containing models:    8      8    8    8</code></pre>
<p>可视化是理解模型平均结果的重要工具。变量重要性图显示各环境因子的相对重要性，模型权重分布图展示不同候选模型的相对支持度。</p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="模型选择与评估.html#cb865-1" tabindex="-1"></a><span class="co"># 可视化模型平均结果</span></span>
<span id="cb865-2"><a href="模型选择与评估.html#cb865-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb865-3"><a href="模型选择与评估.html#cb865-3" tabindex="-1"></a></span>
<span id="cb865-4"><a href="模型选择与评估.html#cb865-4" tabindex="-1"></a><span class="co"># 变量重要性图</span></span>
<span id="cb865-5"><a href="模型选择与评估.html#cb865-5" tabindex="-1"></a><span class="fu">barplot</span>(stream_var_importance[<span class="fu">order</span>(stream_var_importance, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)],</span>
<span id="cb865-6"><a href="模型选择与评估.html#cb865-6" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;林小雨的溪流鱼类研究</span><span class="sc">\n</span><span class="st">变量重要性&quot;</span>,</span>
<span id="cb865-7"><a href="模型选择与评估.html#cb865-7" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;环境因子&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;重要性&quot;</span>,</span>
<span id="cb865-8"><a href="模型选择与评估.html#cb865-8" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">las =</span> <span class="dv">2</span></span>
<span id="cb865-9"><a href="模型选择与评估.html#cb865-9" tabindex="-1"></a>)</span>
<span id="cb865-10"><a href="模型选择与评估.html#cb865-10" tabindex="-1"></a></span>
<span id="cb865-11"><a href="模型选择与评估.html#cb865-11" tabindex="-1"></a><span class="co"># 模型权重分布</span></span>
<span id="cb865-12"><a href="模型选择与评估.html#cb865-12" tabindex="-1"></a><span class="fu">barplot</span>(stream_model_comparison<span class="sc">$</span>AIC_Weight,</span>
<span id="cb865-13"><a href="模型选择与评估.html#cb865-13" tabindex="-1"></a>  <span class="at">names.arg =</span> stream_model_comparison<span class="sc">$</span>Model,</span>
<span id="cb865-14"><a href="模型选择与评估.html#cb865-14" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;林小雨的溪流鱼类研究</span><span class="sc">\n</span><span class="st">模型权重分布&quot;</span>,</span>
<span id="cb865-15"><a href="模型选择与评估.html#cb865-15" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;模型&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">text{AIC}$权重&quot;</span>,</span>
<span id="cb865-16"><a href="模型选择与评估.html#cb865-16" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="at">las =</span> <span class="dv">2</span></span>
<span id="cb865-17"><a href="模型选择与评估.html#cb865-17" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-19"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-19-1.png" alt="林小雨的溪流鱼类模型平均结果：变量重要性和模型权重分布。左图显示水温、溶解氧和pH值是影响鱼类丰度的关键因子，右图展示不同候选模型的相对支持度" width="80%" />
<p class="caption">
图8.4: 林小雨的溪流鱼类模型平均结果：变量重要性和模型权重分布。左图显示水温、溶解氧和pH值是影响鱼类丰度的关键因子，右图展示不同候选模型的相对支持度
</p>
</div>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="模型选择与评估.html#cb866-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>模型平均预测通常比单一模型预测更稳健。通过比较单一模型与模型平均的预测结果，我们可以评估模型平均在减少预测不确定性方面的价值。</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="模型选择与评估.html#cb867-1" tabindex="-1"></a><span class="co"># 比较单一模型与模型平均的预测</span></span>
<span id="cb867-2"><a href="模型选择与评估.html#cb867-2" tabindex="-1"></a><span class="co"># 生成测试数据</span></span>
<span id="cb867-3"><a href="模型选择与评估.html#cb867-3" tabindex="-1"></a>stream_test_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb867-4"><a href="模型选择与评估.html#cb867-4" tabindex="-1"></a>  <span class="at">temp =</span> <span class="dv">18</span>,</span>
<span id="cb867-5"><a href="模型选择与评估.html#cb867-5" tabindex="-1"></a>  <span class="at">oxygen =</span> <span class="dv">6</span>,</span>
<span id="cb867-6"><a href="模型选择与评估.html#cb867-6" tabindex="-1"></a>  <span class="at">ph =</span> <span class="fl">7.5</span>,</span>
<span id="cb867-7"><a href="模型选择与评估.html#cb867-7" tabindex="-1"></a>  <span class="at">turbidity =</span> <span class="dv">20</span></span>
<span id="cb867-8"><a href="模型选择与评估.html#cb867-8" tabindex="-1"></a>)</span>
<span id="cb867-9"><a href="模型选择与评估.html#cb867-9" tabindex="-1"></a></span>
<span id="cb867-10"><a href="模型选择与评估.html#cb867-10" tabindex="-1"></a><span class="co"># 单一模型预测</span></span>
<span id="cb867-11"><a href="模型选择与评估.html#cb867-11" tabindex="-1"></a>stream_single_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(stream_fish_models[[<span class="st">&quot;water_quality&quot;</span>]], <span class="at">newdata =</span> stream_test_data)</span>
<span id="cb867-12"><a href="模型选择与评估.html#cb867-12" tabindex="-1"></a></span>
<span id="cb867-13"><a href="模型选择与评估.html#cb867-13" tabindex="-1"></a><span class="co"># 模型平均预测</span></span>
<span id="cb867-14"><a href="模型选择与评估.html#cb867-14" tabindex="-1"></a>stream_avg_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(stream_avg_model, <span class="at">newdata =</span> stream_test_data)</span></code></pre></div>
<pre><code>## 林小雨的溪流测试条件：水温18°C, 溶解氧6mg/L, pH7.5, 浊度20NTU</code></pre>
<pre><code>## 单一模型预测: 17668.2 条鱼</code></pre>
<pre><code>## 模型平均预测: 17688.7 条鱼</code></pre>
<p>Bootstrap方法能够量化预测的不确定性，包括参数估计误差、模型选择不确定性和生态系统的自然变异性。</p>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="模型选择与评估.html#cb871-1" tabindex="-1"></a><span class="co"># 计算预测区间</span></span>
<span id="cb871-2"><a href="模型选择与评估.html#cb871-2" tabindex="-1"></a><span class="co"># 使用bootstrap计算预测区间</span></span>
<span id="cb871-3"><a href="模型选择与评估.html#cb871-3" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb871-4"><a href="模型选择与评估.html#cb871-4" tabindex="-1"></a></span>
<span id="cb871-5"><a href="模型选择与评估.html#cb871-5" tabindex="-1"></a><span class="co"># 定义预测函数</span></span>
<span id="cb871-6"><a href="模型选择与评估.html#cb871-6" tabindex="-1"></a>stream_predict_function <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb871-7"><a href="模型选择与评估.html#cb871-7" tabindex="-1"></a>  boot_data <span class="ot">&lt;-</span> data[indices, ]</span>
<span id="cb871-8"><a href="模型选择与评估.html#cb871-8" tabindex="-1"></a></span>
<span id="cb871-9"><a href="模型选择与评估.html#cb871-9" tabindex="-1"></a>  <span class="co"># 拟合模型并预测</span></span>
<span id="cb871-10"><a href="模型选择与评估.html#cb871-10" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(abundance <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> temp <span class="sc">+</span> oxygen <span class="sc">+</span> ph, <span class="at">data =</span> boot_data)</span>
<span id="cb871-11"><a href="模型选择与评估.html#cb871-11" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> stream_test_data)</span>
<span id="cb871-12"><a href="模型选择与评估.html#cb871-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(pred) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb871-13"><a href="模型选择与评估.html#cb871-13" tabindex="-1"></a>}</span>
<span id="cb871-14"><a href="模型选择与评估.html#cb871-14" tabindex="-1"></a></span>
<span id="cb871-15"><a href="模型选择与评估.html#cb871-15" tabindex="-1"></a><span class="co"># 执行bootstrap</span></span>
<span id="cb871-16"><a href="模型选择与评估.html#cb871-16" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb871-17"><a href="模型选择与评估.html#cb871-17" tabindex="-1"></a>stream_boot_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(stream_fish_data, stream_predict_function, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb871-18"><a href="模型选择与评估.html#cb871-18" tabindex="-1"></a></span>
<span id="cb871-19"><a href="模型选择与评估.html#cb871-19" tabindex="-1"></a><span class="co"># 计算置信区间</span></span>
<span id="cb871-20"><a href="模型选择与评估.html#cb871-20" tabindex="-1"></a>stream_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(stream_boot_results, <span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)</span></code></pre></div>
<pre><code>## 林小雨的溪流鱼类Bootstrap 95% 预测区间: [ 17104.5 ,  18267.4 ] 条鱼</code></pre>
<p>Bootstrap预测区间反映了模型预测中的多种不确定性来源：参数估计的不确定性、模型选择的不确定性以及生态系统的自然变异性。这种全面的不确定性量化使得模型预测更加可靠，为生态决策提供了更科学的依据。</p>
<p>模型平均在生态学中具有重要的应用价值。它减少了模型选择的不确定性，提供了更稳健的参数估计，量化了不同生态学假说的相对支持程度，并通过变量重要性分析揭示了关键环境因子。</p>
</div>
</div>
<div id="模型评估" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> 模型评估<a href="模型选择与评估.html#模型评估" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>模型评估是生态统计建模中至关重要的环节，它回答了一个根本问题：我们选择的模型是否真的可靠？在生态学研究中，模型的可靠性体现在两个方面：统计可靠性和生态学可靠性。通过系统的模型评估，我们能够确保模型不仅统计上合理，更重要的是具有生态学意义和实际应用价值。</p>
<div id="交叉验证" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> 交叉验证<a href="模型选择与评估.html#交叉验证" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>林小雨在构建了多个森林生态系统模型后，面临着一个关键问题：这些模型在未知森林样地上的表现如何？交叉验证为她提供了一种系统的方法来评估模型的泛化能力，确保她的研究结论能够可靠地应用于其他森林生态系统。</p>
<p><strong>k折交叉验证</strong>是林小雨最常用的交叉验证方法。她将收集的150个森林样地数据随机分割为10个大小相似的子集，然后进行10轮训练和测试。在每一轮中，她使用9个子集作为训练数据来拟合模型，剩下的1个子集作为测试数据来评估模型性能。最后，将10轮测试结果的平均值作为模型泛化能力的估计。</p>
<p>k折交叉验证在林小雨的森林研究中具有重要的应用价值。在研究森林鸟类丰富度与环境因子的关系时，她使用k折交叉验证来评估物种分布模型的预测精度。如果模型在不同数据子集上的表现差异很大，说明模型可能过度适应了特定森林区域的生态特征，其泛化能力有限。</p>
<p><strong>留一交叉验证</strong>是k折交叉验证的特殊情况，其中k等于样本量。每次只留一个森林样地作为测试集，其余所有样地作为训练集。这种方法特别适合小样本森林生态学研究，但计算成本较高。</p>
<p>交叉验证的生态学意义在于它帮助林小雨理解模型在不同森林条件下的表现。例如，一个预测森林碳储量的模型可能在湿润阔叶林中表现良好，但在干旱针叶林中表现较差。通过交叉验证，她可以识别模型的适用范围和局限性，为森林管理决策提供更可靠的科学依据。</p>
<p>交叉验证是评估模型泛化能力的重要方法。在森林生态学研究中，由于数据收集成本高且森林生态系统具有时空变异性，交叉验证能够模拟模型在未知森林样地上的表现，帮助林小雨识别过度拟合问题。k折交叉验证将森林样地数据随机分割为k个子集，通过k轮训练和测试来评估模型的稳定性。</p>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="模型选择与评估.html#cb873-1" tabindex="-1"></a><span class="co"># 交叉验证在生态学中的应用演示 - 数据生成</span></span>
<span id="cb873-2"><a href="模型选择与评估.html#cb873-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb873-3"><a href="模型选择与评估.html#cb873-3" tabindex="-1"></a></span>
<span id="cb873-4"><a href="模型选择与评估.html#cb873-4" tabindex="-1"></a><span class="co"># 生成林小雨的森林样地数据：森林鸟类丰富度与环境因子的关系</span></span>
<span id="cb873-5"><a href="模型选择与评估.html#cb873-5" tabindex="-1"></a>n_forest_plots <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb873-6"><a href="模型选择与评估.html#cb873-6" tabindex="-1"></a></span>
<span id="cb873-7"><a href="模型选择与评估.html#cb873-7" tabindex="-1"></a><span class="co"># 环境因子</span></span>
<span id="cb873-8"><a href="模型选择与评估.html#cb873-8" tabindex="-1"></a>forest_habitat_area <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_plots, <span class="dv">1</span>, <span class="dv">100</span>) <span class="co"># 栖息地面积(公顷)</span></span>
<span id="cb873-9"><a href="模型选择与评估.html#cb873-9" tabindex="-1"></a>forest_vegetation_density <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_plots, <span class="fl">0.1</span>, <span class="fl">0.9</span>) <span class="co"># 植被密度</span></span>
<span id="cb873-10"><a href="模型选择与评估.html#cb873-10" tabindex="-1"></a>forest_temperature <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_plots, <span class="dv">10</span>, <span class="dv">25</span>) <span class="co"># 温度(°C)</span></span>
<span id="cb873-11"><a href="模型选择与评估.html#cb873-11" tabindex="-1"></a>forest_soil_ph <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_plots, <span class="fl">6.0</span>, <span class="fl">8.5</span>) <span class="co"># 土壤pH值</span></span>
<span id="cb873-12"><a href="模型选择与评估.html#cb873-12" tabindex="-1"></a></span>
<span id="cb873-13"><a href="模型选择与评估.html#cb873-13" tabindex="-1"></a><span class="co"># 生成鸟类丰富度数据</span></span>
<span id="cb873-14"><a href="模型选择与评估.html#cb873-14" tabindex="-1"></a>forest_bird_richness <span class="ot">&lt;-</span> <span class="fu">rpois</span>(</span>
<span id="cb873-15"><a href="模型选择与评估.html#cb873-15" tabindex="-1"></a>  n_forest_plots,</span>
<span id="cb873-16"><a href="模型选择与评估.html#cb873-16" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fl">1.2</span> <span class="sc">+</span> <span class="fl">0.015</span> <span class="sc">*</span> forest_habitat_area <span class="sc">+</span></span>
<span id="cb873-17"><a href="模型选择与评估.html#cb873-17" tabindex="-1"></a>    <span class="fl">1.2</span> <span class="sc">*</span> forest_vegetation_density <span class="sc">+</span> <span class="fl">0.05</span> <span class="sc">*</span> forest_temperature <span class="sc">+</span></span>
<span id="cb873-18"><a href="模型选择与评估.html#cb873-18" tabindex="-1"></a>    <span class="fl">0.3</span> <span class="sc">*</span> forest_soil_ph <span class="sc">+</span> <span class="fu">rnorm</span>(n_forest_plots, <span class="dv">0</span>, <span class="fl">0.2</span>))</span>
<span id="cb873-19"><a href="模型选择与评估.html#cb873-19" tabindex="-1"></a>)</span>
<span id="cb873-20"><a href="模型选择与评估.html#cb873-20" tabindex="-1"></a></span>
<span id="cb873-21"><a href="模型选择与评估.html#cb873-21" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb873-22"><a href="模型选择与评估.html#cb873-22" tabindex="-1"></a>forest_plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb873-23"><a href="模型选择与评估.html#cb873-23" tabindex="-1"></a>  <span class="at">richness =</span> forest_bird_richness,</span>
<span id="cb873-24"><a href="模型选择与评估.html#cb873-24" tabindex="-1"></a>  <span class="at">area =</span> forest_habitat_area,</span>
<span id="cb873-25"><a href="模型选择与评估.html#cb873-25" tabindex="-1"></a>  <span class="at">vegetation =</span> forest_vegetation_density,</span>
<span id="cb873-26"><a href="模型选择与评估.html#cb873-26" tabindex="-1"></a>  <span class="at">temp =</span> forest_temperature,</span>
<span id="cb873-27"><a href="模型选择与评估.html#cb873-27" tabindex="-1"></a>  <span class="at">ph =</span> forest_soil_ph</span>
<span id="cb873-28"><a href="模型选择与评估.html#cb873-28" tabindex="-1"></a>)</span></code></pre></div>
<p>caret包为林小雨提供了统一的接口来执行各种机器学习算法和交叉验证。通过trainControl函数设置交叉验证参数，她可以控制验证过程的细节，如折数、重复次数等。</p>
<div class="sourceCode" id="cb874"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb874-1"><a href="模型选择与评估.html#cb874-1" tabindex="-1"></a><span class="co"># 执行k折交叉验证</span></span>
<span id="cb874-2"><a href="模型选择与评估.html#cb874-2" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb874-3"><a href="模型选择与评估.html#cb874-3" tabindex="-1"></a></span>
<span id="cb874-4"><a href="模型选择与评估.html#cb874-4" tabindex="-1"></a><span class="co"># 设置交叉验证参数</span></span>
<span id="cb874-5"><a href="模型选择与评估.html#cb874-5" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;cv&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>)</span>
<span id="cb874-6"><a href="模型选择与评估.html#cb874-6" tabindex="-1"></a></span>
<span id="cb874-7"><a href="模型选择与评估.html#cb874-7" tabindex="-1"></a><span class="co"># 训练线性回归模型</span></span>
<span id="cb874-8"><a href="模型选择与评估.html#cb874-8" tabindex="-1"></a>cv_model <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="fu">log</span>(richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> area <span class="sc">+</span> vegetation <span class="sc">+</span> temp <span class="sc">+</span> ph,</span>
<span id="cb874-9"><a href="模型选择与评估.html#cb874-9" tabindex="-1"></a>  <span class="at">data =</span> forest_plot_data,</span>
<span id="cb874-10"><a href="模型选择与评估.html#cb874-10" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb874-11"><a href="模型选择与评估.html#cb874-11" tabindex="-1"></a>  <span class="at">trControl =</span> ctrl</span>
<span id="cb874-12"><a href="模型选择与评估.html#cb874-12" tabindex="-1"></a>)</span>
<span id="cb874-13"><a href="模型选择与评估.html#cb874-13" tabindex="-1"></a></span>
<span id="cb874-14"><a href="模型选择与评估.html#cb874-14" tabindex="-1"></a><span class="co"># 输出交叉验证结果</span></span>
<span id="cb874-15"><a href="模型选择与评估.html#cb874-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 林小雨的森林鸟类模型10折交叉验证结果 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 林小雨的森林鸟类模型10折交叉验证结果 ===</code></pre>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb876-1"><a href="模型选择与评估.html#cb876-1" tabindex="-1"></a><span class="fu">print</span>(cv_model)</span></code></pre></div>
<pre><code>## Linear Regression 
## 
## 150 samples
##   4 predictor
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold) 
## Summary of sample sizes: 136, 136, 134, 134, 135, 135, ... 
## Resampling results:
## 
##   RMSE       Rsquared   MAE      
##   0.2164835  0.8704702  0.1757488
## 
## Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE</code></pre>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="模型选择与评估.html#cb878-1" tabindex="-1"></a><span class="co"># 提取交叉验证统计量</span></span>
<span id="cb878-2"><a href="模型选择与评估.html#cb878-2" tabindex="-1"></a>cv_results <span class="ot">&lt;-</span> cv_model<span class="sc">$</span>results</span></code></pre></div>
<pre><code>## 
## 交叉验证性能指标：
## 平均$R^2$: 0.87 
## 平均RMSE: 0.216 
## 平均MAE: 0.176</code></pre>
<p>交叉验证性能的可视化能够直观展示模型在不同数据子集上的稳定性。如果RMSE在不同折之间波动很大，说明模型可能过度拟合训练数据的特定特征。</p>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="模型选择与评估.html#cb880-1" tabindex="-1"></a><span class="co"># 可视化交叉验证结果</span></span>
<span id="cb880-2"><a href="模型选择与评估.html#cb880-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb880-3"><a href="模型选择与评估.html#cb880-3" tabindex="-1"></a></span>
<span id="cb880-4"><a href="模型选择与评估.html#cb880-4" tabindex="-1"></a><span class="co"># 创建交叉验证性能图</span></span>
<span id="cb880-5"><a href="模型选择与评估.html#cb880-5" tabindex="-1"></a>cv_performance <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb880-6"><a href="模型选择与评估.html#cb880-6" tabindex="-1"></a>  <span class="at">Fold =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb880-7"><a href="模型选择与评估.html#cb880-7" tabindex="-1"></a>  <span class="at">RMSE =</span> cv_model<span class="sc">$</span>resample<span class="sc">$</span>RMSE,</span>
<span id="cb880-8"><a href="模型选择与评估.html#cb880-8" tabindex="-1"></a>  <span class="at">Rsquared =</span> cv_model<span class="sc">$</span>resample<span class="sc">$</span>Rsquared</span>
<span id="cb880-9"><a href="模型选择与评估.html#cb880-9" tabindex="-1"></a>)</span>
<span id="cb880-10"><a href="模型选择与评估.html#cb880-10" tabindex="-1"></a></span>
<span id="cb880-11"><a href="模型选择与评估.html#cb880-11" tabindex="-1"></a><span class="fu">ggplot</span>(cv_performance, <span class="fu">aes</span>(<span class="at">x =</span> Fold, <span class="at">y =</span> RMSE)) <span class="sc">+</span></span>
<span id="cb880-12"><a href="模型选择与评估.html#cb880-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb880-13"><a href="模型选择与评估.html#cb880-13" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb880-14"><a href="模型选择与评估.html#cb880-14" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb880-15"><a href="模型选择与评估.html#cb880-15" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;林小雨的森林鸟类模型10折交叉验证：RMSE变化&quot;</span>,</span>
<span id="cb880-16"><a href="模型选择与评估.html#cb880-16" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;折数&quot;</span>, <span class="at">y =</span> <span class="st">&quot;RMSE&quot;</span></span>
<span id="cb880-17"><a href="模型选择与评估.html#cb880-17" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb880-18"><a href="模型选择与评估.html#cb880-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb880-19"><a href="模型选择与评估.html#cb880-19" tabindex="-1"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb880-20"><a href="模型选择与评估.html#cb880-20" tabindex="-1"></a>    <span class="at">yintercept =</span> <span class="fu">mean</span>(cv_performance<span class="sc">$</span>RMSE),</span>
<span id="cb880-21"><a href="模型选择与评估.html#cb880-21" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb880-22"><a href="模型选择与评估.html#cb880-22" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-27"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-27-1.png" alt="林小雨的森林鸟类模型10折交叉验证：RMSE在不同数据子集上的变化。图中显示RMSE在不同折之间相对稳定，表明模型具有良好的泛化能力" width="80%" />
<p class="caption">
图3.6: 林小雨的森林鸟类模型10折交叉验证：RMSE在不同数据子集上的变化。图中显示RMSE在不同折之间相对稳定，表明模型具有良好的泛化能力
</p>
</div>
<p>训练集和测试集性能的比较是检测过度拟合的直接方法。如果测试集性能明显差于训练集，说明模型可能过度适应训练数据的噪声。</p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="模型选择与评估.html#cb881-1" tabindex="-1"></a><span class="co"># 比较训练集和测试集性能</span></span>
<span id="cb881-2"><a href="模型选择与评估.html#cb881-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb881-3"><a href="模型选择与评估.html#cb881-3" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(forest_plot_data<span class="sc">$</span>richness, <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb881-4"><a href="模型选择与评估.html#cb881-4" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> forest_plot_data[train_index, ]</span>
<span id="cb881-5"><a href="模型选择与评估.html#cb881-5" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> forest_plot_data[<span class="sc">-</span>train_index, ]</span>
<span id="cb881-6"><a href="模型选择与评估.html#cb881-6" tabindex="-1"></a></span>
<span id="cb881-7"><a href="模型选择与评估.html#cb881-7" tabindex="-1"></a><span class="co"># 在训练集上拟合模型</span></span>
<span id="cb881-8"><a href="模型选择与评估.html#cb881-8" tabindex="-1"></a>train_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> area <span class="sc">+</span> vegetation <span class="sc">+</span> temp <span class="sc">+</span> ph, <span class="at">data =</span> train_data)</span>
<span id="cb881-9"><a href="模型选择与评估.html#cb881-9" tabindex="-1"></a></span>
<span id="cb881-10"><a href="模型选择与评估.html#cb881-10" tabindex="-1"></a><span class="co"># 在训练集和测试集上评估模型</span></span>
<span id="cb881-11"><a href="模型选择与评估.html#cb881-11" tabindex="-1"></a>train_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(train_model)</span>
<span id="cb881-12"><a href="模型选择与评估.html#cb881-12" tabindex="-1"></a>test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(train_model, <span class="at">newdata =</span> test_data)</span>
<span id="cb881-13"><a href="模型选择与评估.html#cb881-13" tabindex="-1"></a></span>
<span id="cb881-14"><a href="模型选择与评估.html#cb881-14" tabindex="-1"></a>train_rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((<span class="fu">log</span>(train_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> train_pred)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb881-15"><a href="模型选择与评估.html#cb881-15" tabindex="-1"></a>test_rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((<span class="fu">log</span>(test_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> test_pred)<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## 
## === 林小雨的森林鸟类模型：训练集 vs 测试集性能 ===
##  训练集RMSE: 0.205 
##  测试集RMSE: 0.234</code></pre>
<pre><code>## 模型在训练集和测试集上表现一致，泛化能力良好</code></pre>
<p>交叉验证在生态学中的价值在于它能够评估模型在不同时空条件下的表现。稳定的交叉验证结果增强了模型在实际生态应用中的可靠性，为生态保护决策提供了更可信的科学依据。</p>
</div>
<div id="外部验证" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> 外部验证<a href="模型选择与评估.html#外部验证" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>林小雨在完成了交叉验证后，面临着一个更严峻的挑战：她的森林生态系统模型能否在其他森林地区准确预测？外部验证为她提供了评估模型空间普适性的黄金标准，使用完全独立的数据集来检验模型的预测能力。在生态学研究中，外部验证具有特殊的重要性，因为生态系统的复杂性和时空变异性使得基于单一森林区域数据构建的模型往往难以推广到其他森林生态系统。</p>
<p>外部验证的基本原理是将模型应用于与训练数据完全独立的观测数据，评估模型在这些新数据上的表现。这种验证方式能够真实反映模型在实际应用中的可靠性，特别是在生态保护规划、物种分布预测和生态系统管理等领域。</p>
<p>在生态学中，外部验证可以通过多种方式实现。时间验证使用不同时间收集的数据来验证模型，例如用过去十年的鸟类调查数据构建模型，然后用最近一年的数据验证模型预测。空间验证使用不同地理区域的数据，例如用某个流域的数据构建水质模型，然后用相邻流域的数据验证模型。情境验证则使用不同生态条件的数据，例如用自然保护区数据构建的模型应用于受干扰区域。</p>
<p>外部验证的生态学意义在于它检验了模型的生态学普适性。一个真正有价值的生态模型应该能够适应不同的时空尺度和生态条件。例如，一个基于温带森林数据构建的碳储量预测模型，如果能够准确预测热带森林的碳储量，就说明该模型具有很好的生态学普适性。</p>
<p>外部验证还帮助我们识别模型的边界条件。在生态学中，很少有模型能够适用于所有情境。通过外部验证，我们可以明确模型的适用范围，避免在不适当的条件下应用模型导致错误的生态学结论。</p>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="模型选择与评估.html#cb884-1" tabindex="-1"></a><span class="co"># 外部验证在生态学中的应用演示：林小雨的森林生态系统研究</span></span>
<span id="cb884-2"><a href="模型选择与评估.html#cb884-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3030</span>)</span>
<span id="cb884-3"><a href="模型选择与评估.html#cb884-3" tabindex="-1"></a></span>
<span id="cb884-4"><a href="模型选择与评估.html#cb884-4" tabindex="-1"></a><span class="co"># 生成训练数据集（模拟林小雨研究的森林区域）</span></span>
<span id="cb884-5"><a href="模型选择与评估.html#cb884-5" tabindex="-1"></a>n_train <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb884-6"><a href="模型选择与评估.html#cb884-6" tabindex="-1"></a></span>
<span id="cb884-7"><a href="模型选择与评估.html#cb884-7" tabindex="-1"></a>forest_elevation_train <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_train, <span class="dv">100</span>, <span class="dv">2000</span>) <span class="co"># 海拔(m)</span></span>
<span id="cb884-8"><a href="模型选择与评估.html#cb884-8" tabindex="-1"></a>forest_precipitation_train <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_train, <span class="dv">500</span>, <span class="dv">2000</span>) <span class="co"># 年降水量(mm)</span></span>
<span id="cb884-9"><a href="模型选择与评估.html#cb884-9" tabindex="-1"></a>forest_soil_n_train <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_train, <span class="fl">0.1</span>, <span class="fl">0.5</span>) <span class="co"># 土壤氮含量(%)</span></span>
<span id="cb884-10"><a href="模型选择与评估.html#cb884-10" tabindex="-1"></a></span>
<span id="cb884-11"><a href="模型选择与评估.html#cb884-11" tabindex="-1"></a><span class="co"># 生成植物物种丰富度（训练集）</span></span>
<span id="cb884-12"><a href="模型选择与评估.html#cb884-12" tabindex="-1"></a>forest_richness_train <span class="ot">&lt;-</span> <span class="fu">rpois</span>(</span>
<span id="cb884-13"><a href="模型选择与评估.html#cb884-13" tabindex="-1"></a>  n_train,</span>
<span id="cb884-14"><a href="模型选择与评估.html#cb884-14" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fl">2.0</span> <span class="sc">+</span> <span class="fl">0.001</span> <span class="sc">*</span> forest_elevation_train <span class="sc">+</span></span>
<span id="cb884-15"><a href="模型选择与评估.html#cb884-15" tabindex="-1"></a>    <span class="fl">0.0008</span> <span class="sc">*</span> forest_precipitation_train <span class="sc">+</span></span>
<span id="cb884-16"><a href="模型选择与评估.html#cb884-16" tabindex="-1"></a>    <span class="fl">2.5</span> <span class="sc">*</span> forest_soil_n_train <span class="sc">+</span> <span class="fu">rnorm</span>(n_train, <span class="dv">0</span>, <span class="fl">0.3</span>))</span>
<span id="cb884-17"><a href="模型选择与评估.html#cb884-17" tabindex="-1"></a>)</span>
<span id="cb884-18"><a href="模型选择与评估.html#cb884-18" tabindex="-1"></a></span>
<span id="cb884-19"><a href="模型选择与评估.html#cb884-19" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb884-20"><a href="模型选择与评估.html#cb884-20" tabindex="-1"></a>  <span class="at">richness =</span> forest_richness_train,</span>
<span id="cb884-21"><a href="模型选择与评估.html#cb884-21" tabindex="-1"></a>  <span class="at">elevation =</span> forest_elevation_train,</span>
<span id="cb884-22"><a href="模型选择与评估.html#cb884-22" tabindex="-1"></a>  <span class="at">precipitation =</span> forest_precipitation_train,</span>
<span id="cb884-23"><a href="模型选择与评估.html#cb884-23" tabindex="-1"></a>  <span class="at">soil_n =</span> forest_soil_n_train</span>
<span id="cb884-24"><a href="模型选择与评估.html#cb884-24" tabindex="-1"></a>)</span>
<span id="cb884-25"><a href="模型选择与评估.html#cb884-25" tabindex="-1"></a></span>
<span id="cb884-26"><a href="模型选择与评估.html#cb884-26" tabindex="-1"></a><span class="co"># 生成测试数据集（模拟另一森林区域的调查数据）</span></span>
<span id="cb884-27"><a href="模型选择与评估.html#cb884-27" tabindex="-1"></a>n_test <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb884-28"><a href="模型选择与评估.html#cb884-28" tabindex="-1"></a></span>
<span id="cb884-29"><a href="模型选择与评估.html#cb884-29" tabindex="-1"></a>forest_elevation_test <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_test, <span class="dv">800</span>, <span class="dv">2500</span>) <span class="co"># 海拔范围略有不同</span></span>
<span id="cb884-30"><a href="模型选择与评估.html#cb884-30" tabindex="-1"></a>forest_precipitation_test <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_test, <span class="dv">600</span>, <span class="dv">1800</span>) <span class="co"># 降水量范围不同</span></span>
<span id="cb884-31"><a href="模型选择与评估.html#cb884-31" tabindex="-1"></a>forest_soil_n_test <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_test, <span class="fl">0.05</span>, <span class="fl">0.4</span>) <span class="co"># 土壤氮含量范围不同</span></span>
<span id="cb884-32"><a href="模型选择与评估.html#cb884-32" tabindex="-1"></a></span>
<span id="cb884-33"><a href="模型选择与评估.html#cb884-33" tabindex="-1"></a><span class="co"># 生成植物物种丰富度（测试集）</span></span>
<span id="cb884-34"><a href="模型选择与评估.html#cb884-34" tabindex="-1"></a>forest_richness_test <span class="ot">&lt;-</span> <span class="fu">rpois</span>(</span>
<span id="cb884-35"><a href="模型选择与评估.html#cb884-35" tabindex="-1"></a>  n_test,</span>
<span id="cb884-36"><a href="模型选择与评估.html#cb884-36" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fl">1.8</span> <span class="sc">+</span> <span class="fl">0.0012</span> <span class="sc">*</span> forest_elevation_test <span class="sc">+</span></span>
<span id="cb884-37"><a href="模型选择与评估.html#cb884-37" tabindex="-1"></a>    <span class="fl">0.0009</span> <span class="sc">*</span> forest_precipitation_test <span class="sc">+</span></span>
<span id="cb884-38"><a href="模型选择与评估.html#cb884-38" tabindex="-1"></a>    <span class="fl">2.8</span> <span class="sc">*</span> forest_soil_n_test <span class="sc">+</span> <span class="fu">rnorm</span>(n_test, <span class="dv">0</span>, <span class="fl">0.4</span>))</span>
<span id="cb884-39"><a href="模型选择与评估.html#cb884-39" tabindex="-1"></a>)</span>
<span id="cb884-40"><a href="模型选择与评估.html#cb884-40" tabindex="-1"></a></span>
<span id="cb884-41"><a href="模型选择与评估.html#cb884-41" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb884-42"><a href="模型选择与评估.html#cb884-42" tabindex="-1"></a>  <span class="at">richness =</span> forest_richness_test,</span>
<span id="cb884-43"><a href="模型选择与评估.html#cb884-43" tabindex="-1"></a>  <span class="at">elevation =</span> forest_elevation_test,</span>
<span id="cb884-44"><a href="模型选择与评估.html#cb884-44" tabindex="-1"></a>  <span class="at">precipitation =</span> forest_precipitation_test,</span>
<span id="cb884-45"><a href="模型选择与评估.html#cb884-45" tabindex="-1"></a>  <span class="at">soil_n =</span> forest_soil_n_test</span>
<span id="cb884-46"><a href="模型选择与评估.html#cb884-46" tabindex="-1"></a>)</span>
<span id="cb884-47"><a href="模型选择与评估.html#cb884-47" tabindex="-1"></a></span>
<span id="cb884-48"><a href="模型选择与评估.html#cb884-48" tabindex="-1"></a><span class="co"># 在训练集上构建模型</span></span>
<span id="cb884-49"><a href="模型选择与评估.html#cb884-49" tabindex="-1"></a>model_external <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> elevation <span class="sc">+</span> precipitation <span class="sc">+</span> soil_n,</span>
<span id="cb884-50"><a href="模型选择与评估.html#cb884-50" tabindex="-1"></a>  <span class="at">data =</span> train_data</span>
<span id="cb884-51"><a href="模型选择与评估.html#cb884-51" tabindex="-1"></a>)</span>
<span id="cb884-52"><a href="模型选择与评估.html#cb884-52" tabindex="-1"></a></span>
<span id="cb884-53"><a href="模型选择与评估.html#cb884-53" tabindex="-1"></a><span class="co"># 在训练集上评估模型</span></span>
<span id="cb884-54"><a href="模型选择与评估.html#cb884-54" tabindex="-1"></a>train_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_external)</span>
<span id="cb884-55"><a href="模型选择与评估.html#cb884-55" tabindex="-1"></a>train_r2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">log</span>(train_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>), train_pred)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb884-56"><a href="模型选择与评估.html#cb884-56" tabindex="-1"></a>train_rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((<span class="fu">log</span>(train_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> train_pred)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb884-57"><a href="模型选择与评估.html#cb884-57" tabindex="-1"></a></span>
<span id="cb884-58"><a href="模型选择与评估.html#cb884-58" tabindex="-1"></a><span class="co"># 在测试集上评估模型（外部验证）</span></span>
<span id="cb884-59"><a href="模型选择与评估.html#cb884-59" tabindex="-1"></a>test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_external, <span class="at">newdata =</span> test_data)</span>
<span id="cb884-60"><a href="模型选择与评估.html#cb884-60" tabindex="-1"></a>test_r2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">log</span>(test_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>), test_pred)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb884-61"><a href="模型选择与评估.html#cb884-61" tabindex="-1"></a>test_rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((<span class="fu">log</span>(test_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> test_pred)<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## === 林小雨的森林生态系统外部验证结果 ===
##  训练集性能（原森林区域）：
##  - $R^2$: 0.862 
##  - RMSE: 0.31</code></pre>
<pre><code>## 测试集性能（新森林区域外部验证）：
##  - $R^2$: 0.772 
##  - RMSE: 0.576</code></pre>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="模型选择与评估.html#cb887-1" tabindex="-1"></a><span class="co"># 计算性能下降程度</span></span>
<span id="cb887-2"><a href="模型选择与评估.html#cb887-2" tabindex="-1"></a>r2_decline <span class="ot">&lt;-</span> (train_r2 <span class="sc">-</span> test_r2) <span class="sc">/</span> train_r2 <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb887-3"><a href="模型选择与评估.html#cb887-3" tabindex="-1"></a>rmse_increase <span class="ot">&lt;-</span> (test_rmse <span class="sc">-</span> train_rmse) <span class="sc">/</span> train_rmse <span class="sc">*</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>## 性能变化分析：
##  $R^2$下降: 10.4 %
##  RMSE增加: 85.5 %</code></pre>
<pre><code>## 外部验证结果优秀：模型在新森林区域表现良好</code></pre>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb890-1"><a href="模型选择与评估.html#cb890-1" tabindex="-1"></a><span class="co"># 可视化外部验证结果</span></span>
<span id="cb890-2"><a href="模型选择与评估.html#cb890-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb890-3"><a href="模型选择与评估.html#cb890-3" tabindex="-1"></a></span>
<span id="cb890-4"><a href="模型选择与评估.html#cb890-4" tabindex="-1"></a><span class="co"># 创建预测 vs 观测图</span></span>
<span id="cb890-5"><a href="模型选择与评估.html#cb890-5" tabindex="-1"></a>validation_plot_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb890-6"><a href="模型选择与评估.html#cb890-6" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb890-7"><a href="模型选择与评估.html#cb890-7" tabindex="-1"></a>    <span class="at">Type =</span> <span class="st">&quot;训练集（原森林区域）&quot;</span>,</span>
<span id="cb890-8"><a href="模型选择与评估.html#cb890-8" tabindex="-1"></a>    <span class="at">Observed =</span> <span class="fu">log</span>(train_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb890-9"><a href="模型选择与评估.html#cb890-9" tabindex="-1"></a>    <span class="at">Predicted =</span> train_pred</span>
<span id="cb890-10"><a href="模型选择与评估.html#cb890-10" tabindex="-1"></a>  ),</span>
<span id="cb890-11"><a href="模型选择与评估.html#cb890-11" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb890-12"><a href="模型选择与评估.html#cb890-12" tabindex="-1"></a>    <span class="at">Type =</span> <span class="st">&quot;测试集（新森林区域）&quot;</span>,</span>
<span id="cb890-13"><a href="模型选择与评估.html#cb890-13" tabindex="-1"></a>    <span class="at">Observed =</span> <span class="fu">log</span>(test_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb890-14"><a href="模型选择与评估.html#cb890-14" tabindex="-1"></a>    <span class="at">Predicted =</span> test_pred</span>
<span id="cb890-15"><a href="模型选择与评估.html#cb890-15" tabindex="-1"></a>  )</span>
<span id="cb890-16"><a href="模型选择与评估.html#cb890-16" tabindex="-1"></a>)</span>
<span id="cb890-17"><a href="模型选择与评估.html#cb890-17" tabindex="-1"></a></span>
<span id="cb890-18"><a href="模型选择与评估.html#cb890-18" tabindex="-1"></a><span class="fu">ggplot</span>(validation_plot_data, <span class="fu">aes</span>(<span class="at">x =</span> Observed, <span class="at">y =</span> Predicted, <span class="at">color =</span> Type)) <span class="sc">+</span></span>
<span id="cb890-19"><a href="模型选择与评估.html#cb890-19" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb890-20"><a href="模型选择与评估.html#cb890-20" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb890-21"><a href="模型选择与评估.html#cb890-21" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb890-22"><a href="模型选择与评估.html#cb890-22" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;林小雨的森林生态系统外部验证：预测 vs 观测&quot;</span>,</span>
<span id="cb890-23"><a href="模型选择与评估.html#cb890-23" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;观测值（对数丰富度）&quot;</span>,</span>
<span id="cb890-24"><a href="模型选择与评估.html#cb890-24" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;预测值（对数丰富度）&quot;</span></span>
<span id="cb890-25"><a href="模型选择与评估.html#cb890-25" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb890-26"><a href="模型选择与评估.html#cb890-26" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb890-27"><a href="模型选择与评估.html#cb890-27" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;训练集（原森林区域）&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;测试集（新森林区域）&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb890-28"><a href="模型选择与评估.html#cb890-28" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Type)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-34"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-34-1.png" alt="林小雨的森林生态系统外部验证：训练集和测试集上植物物种丰富度模型的预测性能比较。训练集基于某森林区域数据，测试集代表生态条件不同的另一森林区域" width="80%" />
<p class="caption">
图3.10: 林小雨的森林生态系统外部验证：训练集和测试集上植物物种丰富度模型的预测性能比较。训练集基于某森林区域数据，测试集代表生态条件不同的另一森林区域
</p>
</div>
<p>在林小雨的植物物种丰富度研究中，训练集基于她最初调查的山地森林区域数据，测试集代表邻近但生态条件略有不同的另一个山地森林区域。外部验证检验了她的模型在不同森林生态系统中的空间普适性。如果模型在测试集上表现良好，说明其在不同森林区域的适用性较广；如果性能显著下降，可能需要考虑森林区域特异性因素，如不同的优势树种、土壤类型、地形特征或干扰历史。林小雨通过外部验证深刻理解了森林生态系统的空间异质性，这为她制定更精准的森林保护策略提供了重要启示。</p>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="模型选择与评估.html#cb891-1" tabindex="-1"></a><span class="co"># 林小雨计算预测偏差：评估模型在新森林区域的系统性偏差</span></span>
<span id="cb891-2"><a href="模型选择与评估.html#cb891-2" tabindex="-1"></a>bias_train <span class="ot">&lt;-</span> <span class="fu">mean</span>(train_pred <span class="sc">-</span> <span class="fu">log</span>(train_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb891-3"><a href="模型选择与评估.html#cb891-3" tabindex="-1"></a>bias_test <span class="ot">&lt;-</span> <span class="fu">mean</span>(test_pred <span class="sc">-</span> <span class="fu">log</span>(test_data<span class="sc">$</span>richness <span class="sc">+</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## 
## === 林小雨的预测偏差分析 ===
##  原森林区域（训练集）平均偏差: 0 
##  新森林区域（测试集）平均偏差: -0.343</code></pre>
<pre><code>## 林小雨的发现：模型在新森林区域存在系统性预测偏差
##  可能原因：不同森林区域的环境因子与物种丰富度关系存在差异
##  建议：考虑添加区域特异性变量或使用混合效应模型</code></pre>
</div>
<div id="模型诊断" class="section level3 hasAnchor" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> 模型诊断<a href="模型选择与评估.html#模型诊断" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>林小雨在完成了模型选择和验证后，她的导师提醒她还有一个关键步骤：模型诊断。这是确保统计模型可靠性的基础工作，它通过系统检查模型的残差、影响点和假设条件来识别潜在问题。在她的森林生态系统研究中，模型诊断不仅具有统计意义，更重要的是能够揭示数据中可能存在的生态学异常和特殊模式。</p>
<p><strong>残差分析</strong>是林小雨学习的模型诊断核心内容。残差是观测值与模型预测值之间的差异，理想的残差应该随机分布，没有明显的模式。通过残差分析，她可以检验模型是否充分捕捉了森林生态系统中的生态关系，是否存在未被解释的系统性变异。</p>
<p>在林小雨的森林研究中，残差分析帮助她发现了重要的生态现象。例如，如果残差显示出明显的空间聚集模式，可能意味着存在未被考虑的空间自相关效应；如果残差与某个环境因子（如地形或微气候）相关，可能意味着该因子对物种分布的影响被低估或高估。</p>
<p><strong>影响分析</strong>关注个别森林样地对模型结果的过度影响。在林小雨的生态数据中，某些异常观测可能对模型参数估计产生不成比例的影响。这些异常观测可能代表特殊的森林生态情境，如罕见的生境类型、极端的气候事件或特殊的干扰历史（如火烧迹地、人工林等）。通过识别这些影响点，林小雨不仅能够确保模型的统计稳健性，还能够发现值得深入研究的生态学现象。</p>
<p>模型诊断的生态学意义在于它连接了统计技术与生态学理解。林小雨意识到，一个统计上完美的模型如果无法通过生态学合理性检验，其价值就会大打折扣。例如，她的物种分布模型如果残差显示出明显的海拔梯度模式，可能意味着模型忽略了重要的环境驱动因子。</p>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="模型选择与评估.html#cb894-1" tabindex="-1"></a><span class="co"># 林小雨的森林模型诊断研究 - 数据生成</span></span>
<span id="cb894-2"><a href="模型选择与评估.html#cb894-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4040</span>)</span>
<span id="cb894-3"><a href="模型选择与评估.html#cb894-3" tabindex="-1"></a></span>
<span id="cb894-4"><a href="模型选择与评估.html#cb894-4" tabindex="-1"></a><span class="co"># 生成林小雨的森林生态数据：树木生长速率与环境因子的关系</span></span>
<span id="cb894-5"><a href="模型选择与评估.html#cb894-5" tabindex="-1"></a>n_forest_trees <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb894-6"><a href="模型选择与评估.html#cb894-6" tabindex="-1"></a></span>
<span id="cb894-7"><a href="模型选择与评估.html#cb894-7" tabindex="-1"></a><span class="co"># 林小雨测量的森林环境因子</span></span>
<span id="cb894-8"><a href="模型选择与评估.html#cb894-8" tabindex="-1"></a>forest_canopy_openness <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_trees, <span class="dv">10</span>, <span class="dv">80</span>) <span class="co"># 林冠开度(%)</span></span>
<span id="cb894-9"><a href="模型选择与评估.html#cb894-9" tabindex="-1"></a>forest_soil_moisture <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_trees, <span class="dv">15</span>, <span class="dv">45</span>) <span class="co"># 土壤湿度(%)</span></span>
<span id="cb894-10"><a href="模型选择与评估.html#cb894-10" tabindex="-1"></a>forest_soil_nitrogen <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_trees, <span class="fl">0.5</span>, <span class="fl">5.0</span>) <span class="co"># 土壤氮含量(g/kg)</span></span>
<span id="cb894-11"><a href="模型选择与评估.html#cb894-11" tabindex="-1"></a>forest_slope <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_trees, <span class="dv">0</span>, <span class="dv">35</span>) <span class="co"># 坡度(度)</span></span>
<span id="cb894-12"><a href="模型选择与评估.html#cb894-12" tabindex="-1"></a></span>
<span id="cb894-13"><a href="模型选择与评估.html#cb894-13" tabindex="-1"></a><span class="co"># 生成树木生长速率数据（包含一些异常观测）</span></span>
<span id="cb894-14"><a href="模型选择与评估.html#cb894-14" tabindex="-1"></a><span class="co"># 基本关系：生长速率受光照、水分和养分影响</span></span>
<span id="cb894-15"><a href="模型选择与评估.html#cb894-15" tabindex="-1"></a>tree_growth_rate <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.08</span> <span class="sc">*</span> forest_canopy_openness <span class="sc">+</span> <span class="fl">0.15</span> <span class="sc">*</span> forest_soil_moisture <span class="sc">+</span></span>
<span id="cb894-16"><a href="模型选择与评估.html#cb894-16" tabindex="-1"></a>  <span class="fl">1.2</span> <span class="sc">*</span> forest_soil_nitrogen <span class="sc">-</span> <span class="fl">0.05</span> <span class="sc">*</span> forest_slope <span class="sc">+</span> <span class="fu">rnorm</span>(n_forest_trees, <span class="dv">0</span>, <span class="fl">1.5</span>)</span>
<span id="cb894-17"><a href="模型选择与评估.html#cb894-17" tabindex="-1"></a></span>
<span id="cb894-18"><a href="模型选择与评估.html#cb894-18" tabindex="-1"></a><span class="co"># 林小雨发现的异常观测</span></span>
<span id="cb894-19"><a href="模型选择与评估.html#cb894-19" tabindex="-1"></a><span class="co"># 异常点1：极端高生长速率（可能是人工林或施肥样地）</span></span>
<span id="cb894-20"><a href="模型选择与评估.html#cb894-20" tabindex="-1"></a>tree_growth_rate[<span class="dv">25</span>] <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb894-21"><a href="模型选择与评估.html#cb894-21" tabindex="-1"></a><span class="co"># 异常点2：极端低生长速率（可能是火烧迹地或病虫害样地）</span></span>
<span id="cb894-22"><a href="模型选择与评估.html#cb894-22" tabindex="-1"></a>tree_growth_rate[<span class="dv">60</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb894-23"><a href="模型选择与评估.html#cb894-23" tabindex="-1"></a><span class="co"># 异常点3：高杠杆点（极端环境条件，如全光照但贫瘠土壤）</span></span>
<span id="cb894-24"><a href="模型选择与评估.html#cb894-24" tabindex="-1"></a>forest_canopy_openness[<span class="dv">85</span>] <span class="ot">&lt;-</span> <span class="dv">90</span></span>
<span id="cb894-25"><a href="模型选择与评估.html#cb894-25" tabindex="-1"></a>forest_soil_nitrogen[<span class="dv">85</span>] <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb894-26"><a href="模型选择与评估.html#cb894-26" tabindex="-1"></a></span>
<span id="cb894-27"><a href="模型选择与评估.html#cb894-27" tabindex="-1"></a><span class="co"># 创建林小雨的森林数据框</span></span>
<span id="cb894-28"><a href="模型选择与评估.html#cb894-28" tabindex="-1"></a>forest_diagnostic_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb894-29"><a href="模型选择与评估.html#cb894-29" tabindex="-1"></a>  <span class="at">growth_rate =</span> tree_growth_rate,</span>
<span id="cb894-30"><a href="模型选择与评估.html#cb894-30" tabindex="-1"></a>  <span class="at">canopy_openness =</span> forest_canopy_openness,</span>
<span id="cb894-31"><a href="模型选择与评估.html#cb894-31" tabindex="-1"></a>  <span class="at">soil_moisture =</span> forest_soil_moisture,</span>
<span id="cb894-32"><a href="模型选择与评估.html#cb894-32" tabindex="-1"></a>  <span class="at">soil_nitrogen =</span> forest_soil_nitrogen,</span>
<span id="cb894-33"><a href="模型选择与评估.html#cb894-33" tabindex="-1"></a>  <span class="at">slope =</span> forest_slope</span>
<span id="cb894-34"><a href="模型选择与评估.html#cb894-34" tabindex="-1"></a>)</span>
<span id="cb894-35"><a href="模型选择与评估.html#cb894-35" tabindex="-1"></a></span>
<span id="cb894-36"><a href="模型选择与评估.html#cb894-36" tabindex="-1"></a><span class="co"># 林小雨构建树木生长速率的线性回归模型</span></span>
<span id="cb894-37"><a href="模型选择与评估.html#cb894-37" tabindex="-1"></a>model_diagnostic <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth_rate <span class="sc">~</span> canopy_openness <span class="sc">+</span> soil_moisture <span class="sc">+</span></span>
<span id="cb894-38"><a href="模型选择与评估.html#cb894-38" tabindex="-1"></a>                         soil_nitrogen <span class="sc">+</span> slope,</span>
<span id="cb894-39"><a href="模型选择与评估.html#cb894-39" tabindex="-1"></a>  <span class="at">data =</span> forest_diagnostic_data</span>
<span id="cb894-40"><a href="模型选择与评估.html#cb894-40" tabindex="-1"></a>)</span></code></pre></div>
<p>林小雨开始进行残差分析，这是模型诊断的核心内容。残差是观测值与模型预测值之间的差异，理想的残差应该随机分布，没有明显的模式。通过残差分析，她可以检验模型是否充分捕捉了森林生态系统中的生态关系，是否存在未被解释的系统性变异。</p>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb895-1"><a href="模型选择与评估.html#cb895-1" tabindex="-1"></a><span class="co"># 林小雨执行全面的模型诊断</span></span>
<span id="cb895-2"><a href="模型选择与评估.html#cb895-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 林小雨的森林模型诊断结果 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 林小雨的森林模型诊断结果 ===</code></pre>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="模型选择与评估.html#cb897-1" tabindex="-1"></a><span class="co"># 1. 残差分析</span></span>
<span id="cb897-2"><a href="模型选择与评估.html#cb897-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">1. 残差分析</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 1. 残差分析</code></pre>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="模型选择与评估.html#cb899-1" tabindex="-1"></a><span class="co"># 绘制残差诊断图</span></span>
<span id="cb899-2"><a href="模型选择与评估.html#cb899-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb899-3"><a href="模型选择与评估.html#cb899-3" tabindex="-1"></a><span class="fu">plot</span>(model_diagnostic)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-38"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-38-1.png" alt="林小雨的森林模型残差诊断图：残差vs拟合值、Q-Q图、尺度-位置图和残差vs杠杆图。通过系统诊断，林小雨检查她的树木生长速率模型是否满足统计假设。" width="80%" />
<p class="caption">
图3.14: 林小雨的森林模型残差诊断图：残差vs拟合值、Q-Q图、尺度-位置图和残差vs杠杆图。通过系统诊断，林小雨检查她的树木生长速率模型是否满足统计假设。
</p>
</div>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="模型选择与评估.html#cb900-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="模型选择与评估.html#cb901-1" tabindex="-1"></a><span class="co"># 计算残差统计量</span></span>
<span id="cb901-2"><a href="模型选择与评估.html#cb901-2" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">resid</span>(model_diagnostic)</span>
<span id="cb901-3"><a href="模型选择与评估.html#cb901-3" tabindex="-1"></a>fitted <span class="ot">&lt;-</span> <span class="fu">fitted</span>(model_diagnostic)</span></code></pre></div>
<pre><code>## 林小雨的残差统计量：
##  均值: 0 (理想值: 0)
##  标准差: 2.119 
##  偏度: -2.672 (理想值: 0)</code></pre>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb903-1"><a href="模型选择与评估.html#cb903-1" tabindex="-1"></a><span class="co"># 检验残差正态性</span></span>
<span id="cb903-2"><a href="模型选择与评估.html#cb903-2" tabindex="-1"></a>shapiro_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(residuals)</span></code></pre></div>
<pre><code>## Shapiro-Wilk正态性检验p值: 0</code></pre>
<pre><code>## 林小雨的发现：残差可能不服从正态分布，需要考虑数据变换</code></pre>
<p>影响分析关注个别观测对模型结果的过度影响。在生态数据中，某些异常观测可能对模型参数估计产生不成比例的影响。这些异常观测可能代表特殊的生态情境，如罕见的生境类型、极端的气候事件或特殊的物种行为。</p>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="模型选择与评估.html#cb906-1" tabindex="-1"></a><span class="co"># 2. 影响分析</span></span>
<span id="cb906-2"><a href="模型选择与评估.html#cb906-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">2. 影响分析</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 2. 影响分析</code></pre>
<div class="sourceCode" id="cb908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb908-1"><a href="模型选择与评估.html#cb908-1" tabindex="-1"></a><span class="co"># 计算影响统计量</span></span>
<span id="cb908-2"><a href="模型选择与评估.html#cb908-2" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb908-3"><a href="模型选择与评估.html#cb908-3" tabindex="-1"></a>influence_measures <span class="ot">&lt;-</span> <span class="fu">influence.measures</span>(model_diagnostic)</span>
<span id="cb908-4"><a href="模型选择与评估.html#cb908-4" tabindex="-1"></a></span>
<span id="cb908-5"><a href="模型选择与评估.html#cb908-5" tabindex="-1"></a><span class="co"># 识别高杠杆点（hat values &gt; 2p/n）</span></span>
<span id="cb908-6"><a href="模型选择与评估.html#cb908-6" tabindex="-1"></a>hat_values <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(model_diagnostic)</span>
<span id="cb908-7"><a href="模型选择与评估.html#cb908-7" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(model_diagnostic))</span>
<span id="cb908-8"><a href="模型选择与评估.html#cb908-8" tabindex="-1"></a>high_leverage <span class="ot">&lt;-</span> <span class="fu">which</span>(hat_values <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">*</span> p <span class="sc">/</span> n_forest_trees)</span></code></pre></div>
<p><code>{r, echo=FALSE}` cat("高杠杆点（可能对模型有过度影响）：\n") if (length(high_leverage) &gt; 0) {   cat("观测编号:", high_leverage, "\n",     "对应的hat值:", round(hat_values[high_leverage], 3), "\n") } else {   cat("未发现高杠杆点\n") }</code></p>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="模型选择与评估.html#cb909-1" tabindex="-1"></a><span class="co"># 识别异常残差（标准化残差 &gt; 2）</span></span>
<span id="cb909-2"><a href="模型选择与评估.html#cb909-2" tabindex="-1"></a>std_residuals <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(model_diagnostic)</span>
<span id="cb909-3"><a href="模型选择与评估.html#cb909-3" tabindex="-1"></a>outlier_residuals <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(std_residuals) <span class="sc">&gt;</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
## 异常残差点（|标准化残差| &gt; 2）：</code></pre>
<pre><code>## 观测编号: 25 60 63 
##  对应的标准化残差: 3.133 -7.086 2.377</code></pre>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb912-1"><a href="模型选择与评估.html#cb912-1" tabindex="-1"></a><span class="co"># 识别强影响点（Cook&#39;s distance &gt; 4/(n-p)）</span></span>
<span id="cb912-2"><a href="模型选择与评估.html#cb912-2" tabindex="-1"></a>cooks_d <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(model_diagnostic)</span>
<span id="cb912-3"><a href="模型选择与评估.html#cb912-3" tabindex="-1"></a>influential_points <span class="ot">&lt;-</span> <span class="fu">which</span>(cooks_d <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">/</span> (n_forest_trees <span class="sc">-</span> p))</span></code></pre></div>
<pre><code>## 
## 强影响点（Cook&#39;s distance较大）：</code></pre>
<pre><code>## 观测编号: 25 29 60 63 
##  对应的Cook&#39;s distance: 0.113 0.036 0.328 0.046</code></pre>
<p>多重共线性会影响参数估计的稳定性。当解释变量之间存在高度相关性时，单个变量的独立效应难以准确估计。方差膨胀因子(VIF)是诊断多重共线性的常用指标。</p>
<div class="sourceCode" id="cb915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb915-1"><a href="模型选择与评估.html#cb915-1" tabindex="-1"></a><span class="co"># 3. 多重共线性诊断</span></span>
<span id="cb915-2"><a href="模型选择与评估.html#cb915-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">3. 多重共线性诊断</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 3. 多重共线性诊断</code></pre>
<div class="sourceCode" id="cb917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb917-1"><a href="模型选择与评估.html#cb917-1" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_diagnostic)</span></code></pre></div>
<pre><code>## 方差膨胀因子(VIF)：</code></pre>
<pre><code>## canopy_openness : 1.01
## soil_moisture : 1.03
## soil_nitrogen : 1.02
## slope : 1.03</code></pre>
<p>可视化是理解影响分析结果的重要工具。Cook’s distance图能够直观展示各观测点对模型的影响程度，帮助我们识别需要特别关注的异常观测。</p>
<div class="sourceCode" id="cb920"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb920-1"><a href="模型选择与评估.html#cb920-1" tabindex="-1"></a><span class="co"># 可视化影响分析</span></span>
<span id="cb920-2"><a href="模型选择与评估.html#cb920-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb920-3"><a href="模型选择与评估.html#cb920-3" tabindex="-1"></a></span>
<span id="cb920-4"><a href="模型选择与评估.html#cb920-4" tabindex="-1"></a><span class="co"># Cook&#39;s distance图</span></span>
<span id="cb920-5"><a href="模型选择与评估.html#cb920-5" tabindex="-1"></a>cook_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Observation =</span> <span class="dv">1</span><span class="sc">:</span>n_forest_trees, <span class="at">CooksD =</span> cooks_d)</span>
<span id="cb920-6"><a href="模型选择与评估.html#cb920-6" tabindex="-1"></a><span class="fu">ggplot</span>(cook_data, <span class="fu">aes</span>(<span class="at">x =</span> Observation, <span class="at">y =</span> CooksD)) <span class="sc">+</span></span>
<span id="cb920-7"><a href="模型选择与评估.html#cb920-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb920-8"><a href="模型选择与评估.html#cb920-8" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span> <span class="sc">/</span> (n_forest_trees <span class="sc">-</span> p), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb920-9"><a href="模型选择与评估.html#cb920-9" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb920-10"><a href="模型选择与评估.html#cb920-10" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Cook&#39;s Distance影响分析&quot;</span>,</span>
<span id="cb920-11"><a href="模型选择与评估.html#cb920-11" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;观测编号&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Cook&#39;s Distance&quot;</span></span>
<span id="cb920-12"><a href="模型选择与评估.html#cb920-12" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb920-13"><a href="模型选择与评估.html#cb920-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb920-14"><a href="模型选择与评估.html#cb920-14" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb920-15"><a href="模型选择与评估.html#cb920-15" tabindex="-1"></a>    <span class="at">data =</span> cook_data[influential_points, ],</span>
<span id="cb920-16"><a href="模型选择与评估.html#cb920-16" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> Observation), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb920-17"><a href="模型选择与评估.html#cb920-17" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-50"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-50-1.png" alt="Cook's Distance影响分析：识别对模型参数估计有过度影响的观测点" width="80%" />
<p class="caption">
图2.5: Cook’s Distance影响分析：识别对模型参数估计有过度影响的观测点
</p>
</div>
<p>在生态学中，异常观测往往具有重要的生态学意义。高杠杆点可能代表极端环境条件，异常残差点可能反映特殊的生态情境。通过识别这些点，我们不仅能够确保模型的统计稳健性，还能够发现值得深入研究的生态学现象。</p>
<p>在林小雨的森林树木生长研究中：</p>
<ul>
<li><p>高杠杆点可能代表极端环境条件（如全光照但贫瘠土壤）</p></li>
<li><p>这些观测对模型参数估计有不成比例的影响</p></li>
<li><p>异常残差点可能代表特殊的生态情境</p></li>
<li><p>例如，异常高生长速率可能出现在人工林或施肥样地</p></li>
<li><p>异常低生长速率可能出现在火烧迹地或病虫害样地</p></li>
<li><p>强影响点可能显著改变模型的生态学结论</p></li>
<li><p>需要仔细检查这些观测的生态学合理性</p></li>
</ul>
<p>稳健性检查通过比较移除异常观测前后的模型结果，评估模型对异常观测的敏感性。如果系数变化显著，说明模型对特定观测过度依赖，需要谨慎解释结果。</p>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="模型选择与评估.html#cb921-1" tabindex="-1"></a><span class="co"># 稳健性检查：移除强影响点后的模型</span></span>
<span id="cb921-2"><a href="模型选择与评估.html#cb921-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(influential_points) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb921-3"><a href="模型选择与评估.html#cb921-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== 稳健性检查 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb921-4"><a href="模型选择与评估.html#cb921-4" tabindex="-1"></a></span>
<span id="cb921-5"><a href="模型选择与评估.html#cb921-5" tabindex="-1"></a>  robust_data <span class="ot">&lt;-</span> forest_diagnostic_data[<span class="sc">-</span>influential_points, ]</span>
<span id="cb921-6"><a href="模型选择与评估.html#cb921-6" tabindex="-1"></a>  robust_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(growth_rate <span class="sc">~</span> canopy_openness <span class="sc">+</span> soil_moisture <span class="sc">+</span></span>
<span id="cb921-7"><a href="模型选择与评估.html#cb921-7" tabindex="-1"></a>    soil_nitrogen <span class="sc">+</span> slope, <span class="at">data =</span> robust_data</span>
<span id="cb921-8"><a href="模型选择与评估.html#cb921-8" tabindex="-1"></a>  )</span>
<span id="cb921-9"><a href="模型选择与评估.html#cb921-9" tabindex="-1"></a></span>
<span id="cb921-10"><a href="模型选择与评估.html#cb921-10" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;原始模型系数：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb921-11"><a href="模型选择与评估.html#cb921-11" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">coef</span>(model_diagnostic), <span class="dv">3</span>))</span>
<span id="cb921-12"><a href="模型选择与评估.html#cb921-12" tabindex="-1"></a></span>
<span id="cb921-13"><a href="模型选择与评估.html#cb921-13" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">稳健模型系数（移除强影响点）：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb921-14"><a href="模型选择与评估.html#cb921-14" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">coef</span>(robust_model), <span class="dv">3</span>))</span>
<span id="cb921-15"><a href="模型选择与评估.html#cb921-15" tabindex="-1"></a></span>
<span id="cb921-16"><a href="模型选择与评估.html#cb921-16" tabindex="-1"></a>  <span class="co"># 计算系数变化</span></span>
<span id="cb921-17"><a href="模型选择与评估.html#cb921-17" tabindex="-1"></a>  coef_change <span class="ot">&lt;-</span> <span class="fu">abs</span>((<span class="fu">coef</span>(robust_model) <span class="sc">-</span> <span class="fu">coef</span>(model_diagnostic)) <span class="sc">/</span> <span class="fu">coef</span>(model_diagnostic)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb921-18"><a href="模型选择与评估.html#cb921-18" tabindex="-1"></a></span>
<span id="cb921-19"><a href="模型选择与评估.html#cb921-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">系数变化百分比：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb921-20"><a href="模型选择与评估.html#cb921-20" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(coef_change)) {</span>
<span id="cb921-21"><a href="模型选择与评估.html#cb921-21" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">names</span>(coef_change)[i], <span class="st">&quot;:&quot;</span>, <span class="fu">round</span>(coef_change[i], <span class="dv">1</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb921-22"><a href="模型选择与评估.html#cb921-22" tabindex="-1"></a>  }</span>
<span id="cb921-23"><a href="模型选择与评估.html#cb921-23" tabindex="-1"></a></span>
<span id="cb921-24"><a href="模型选择与评估.html#cb921-24" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(coef_change <span class="sc">&gt;</span> <span class="dv">20</span>)) {</span>
<span id="cb921-25"><a href="模型选择与评估.html#cb921-25" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">警告：某些系数变化超过20%，模型对异常观测敏感</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb921-26"><a href="模型选择与评估.html#cb921-26" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb921-27"><a href="模型选择与评估.html#cb921-27" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">模型对异常观测相对稳健</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb921-28"><a href="模型选择与评估.html#cb921-28" tabindex="-1"></a>  }</span>
<span id="cb921-29"><a href="模型选择与评估.html#cb921-29" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## === 稳健性检查 ===
## 原始模型系数：
##     (Intercept) canopy_openness   soil_moisture   soil_nitrogen           slope 
##           4.223           0.065           0.167           1.445          -0.034 
## 
## 稳健模型系数（移除强影响点）：
##     (Intercept) canopy_openness   soil_moisture   soil_nitrogen           slope 
##           3.982           0.078           0.163           1.368          -0.035 
## 
## 系数变化百分比：
## (Intercept) : 5.7 %
## canopy_openness : 20.5 %
## soil_moisture : 2.6 %
## soil_nitrogen : 5.4 %
## slope : 2.5 %
## 
## 警告：某些系数变化超过20%，模型对异常观测敏感</code></pre>
<p>模型诊断的最终目的是确保研究结论的可靠性。通过系统的诊断分析，我们能够识别潜在问题，采取适当措施，并在生态学解释中考虑模型的局限性。</p>
<p>模型诊断建议：检查异常观测的生态学合理性，考虑是否需要变换变量或使用稳健回归方法，确保模型假设得到满足，并在生态学解释中考虑模型的局限性。</p>
<p>模型诊断连接了统计技术与生态学理解。一个统计上完美的模型如果无法通过生态学合理性检验，其价值就会大打折扣。通过系统的模型诊断，我们能够构建既统计可靠又生态学有意义的模型。</p>
</div>
</div>
<div id="贝叶斯模型选择与评估" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> 贝叶斯模型选择与评估<a href="模型选择与评估.html#贝叶斯模型选择与评估" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>林小雨在完成了频率学派的模型选择与评估后，她的导师向她介绍了另一种统计范式——贝叶斯方法。导师告诉她，贝叶斯方法在处理森林生态系统的复杂性和不确定性方面具有独特优势，特别是在整合先验生态学知识和量化预测不确定性方面。林小雨充满好奇地开始了贝叶斯模型选择与评估的学习之旅。</p>
<p>在前面的章节中，我们主要介绍了基于频率学派的模型选择与评估方法。现在让我们跟随林小雨转向一个完全不同的统计范式——贝叶斯方法。贝叶斯模型选择与评估在哲学基础、方法论和生态学解释上都与频率学派方法存在根本差异。</p>
<div id="贝叶斯与频率学派的根本差异" class="section level3 hasAnchor" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> 贝叶斯与频率学派的根本差异<a href="模型选择与评估.html#贝叶斯与频率学派的根本差异" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>理解贝叶斯方法的第一步是认识到它与频率学派方法的本质区别：</p>
<p><strong>1. 哲学基础不同</strong><br />
- <strong>频率学派</strong>：基于重复抽样思想，关注长期频率性质<br />
- <strong>贝叶斯方法</strong>：基于主观概率解释，将参数视为随机变量</p>
<p><strong>2. 不确定性处理方式不同</strong><br />
- <strong>频率学派</strong>：参数不确定性通过置信区间表示<br />
- <strong>贝叶斯方法</strong>：参数不确定性通过后验分布完全量化</p>
<p><strong>3. 先验信息的使用</strong><br />
- <strong>频率学派</strong>：通常不使用先验信息<br />
- <strong>贝叶斯方法</strong>：明确使用先验分布整合领域知识</p>
<p><strong>4. 模型选择标准不同</strong><br />
- <strong>频率学派</strong>：基于AIC/BIC等信息准则<br />
- <strong>贝叶斯方法</strong>：基于贝叶斯因子和后验模型概率</p>
<p><strong>5. 预测评估方法不同</strong><br />
- <strong>频率学派</strong>：基于点估计的预测<br />
- <strong>贝叶斯方法</strong>：基于后验预测分布的完整预测</p>
<p><strong>6. 变量选择方法不同</strong><br />
- <strong>频率学派</strong>：逐步回归、LASSO等惩罚方法<br />
- <strong>贝叶斯方法</strong>：贝叶斯变量选择、稀疏先验</p>
<p><strong>7. 生态学解释差异</strong><br />
- <strong>频率学派</strong>：“我们有95%置信度参数在区间内”<br />
- <strong>贝叶斯方法</strong>：“参数有95%概率落在区间内”</p>
<p>这些根本差异使得贝叶斯方法在生态学中特别有价值，特别是在处理小样本数据、整合先验知识、量化不确定性等方面具有独特优势。</p>
</div>
<div id="贝叶斯模型选择基本原理" class="section level3 hasAnchor" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> 贝叶斯模型选择基本原理<a href="模型选择与评估.html#贝叶斯模型选择基本原理" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯模型选择的核心是<strong>贝叶斯因子</strong>和<strong>后验模型概率</strong>。</p>
<p><strong>贝叶斯因子</strong>比较两个模型的相对证据强度： <span class="math display">\[BF_{12} = \frac{P(D|M_1)}{P(D|M_2)}\]</span></p>
<p>其中<span class="math inline">\(P(D|M_k)\)</span>是模型<span class="math inline">\(M_k\)</span>的边际似然，表示数据<span class="math inline">\(D\)</span>在模型<span class="math inline">\(M_k\)</span>下的平均拟合程度。</p>
<p><strong>后验模型概率</strong>基于贝叶斯定理： <span class="math display">\[P(M_k|D) = \frac{P(D|M_k)P(M_k)}{\sum_j P(D|M_j)P(M_j)}\]</span></p>
<p>其中<span class="math inline">\(P(M_k)\)</span>是先验模型概率，反映了我们对不同模型的先验偏好。</p>
</div>
<div id="贝叶斯假设检验流程" class="section level3 hasAnchor" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> 贝叶斯假设检验流程<a href="模型选择与评估.html#贝叶斯假设检验流程" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>林小雨开始学习贝叶斯假设检验，她发现这与频率统计方法有本质区别。贝叶斯方法让她能够明确整合森林生态学的先验知识，比如关于不同树种对环境因子响应强度的已有研究结果。</p>
<p><strong>基本步骤</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>定义先验分布</strong>
<ul>
<li>基于已有知识或专家意见设定参数先验</li>
<li>常用先验：无信息先验、弱信息先验、共轭先验</li>
<li>林小雨的应用：基于森林生态学文献设定温度对生长速率影响的先验分布</li>
</ul></li>
<li><strong>构建似然函数</strong>
<ul>
<li>基于观测数据建立概率模型</li>
<li>描述数据在给定参数下的生成过程</li>
<li>林小雨的应用：构建森林鸟类丰富度与环境因子的似然函数</li>
</ul></li>
<li><strong>计算后验分布</strong>
<ul>
<li>使用贝叶斯定理结合先验和似然</li>
<li>通常通过MCMC方法进行抽样</li>
<li>林小雨的应用：计算森林生态系统参数的后验分布</li>
</ul></li>
<li><strong>进行假设检验</strong>
<ul>
<li>基于后验分布计算假设的概率</li>
<li>使用贝叶斯因子或后验概率进行决策</li>
<li>林小雨的应用：检验栖息地面积对鸟类丰富度的影响是否显著</li>
</ul></li>
</ol>
<p><strong>生态学应用示例</strong>：检验保护措施对物种丰富度的影响</p>
</div>
<div id="贝叶斯模型比较与选择" class="section level3 hasAnchor" number="9.4.4">
<h3><span class="header-section-number">9.4.4</span> 贝叶斯模型比较与选择<a href="模型选择与评估.html#贝叶斯模型比较与选择" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在生态学研究中，我们经常面临多个竞争模型的比较问题。贝叶斯方法提供了系统化的框架来处理模型不确定性。</p>
<p><strong>模型证据与边际似然</strong></p>
<p><strong>边际似然</strong>（Marginal Likelihood）是模型比较的核心指标，定义为： <span class="math display">\[P(D|M) = \int P(D|\theta, M)P(\theta|M)d\theta\]</span></p>
<p>边际似然衡量了模型对数据的平均拟合程度，同时考虑了参数不确定性。</p>
<p><strong>贝叶斯模型平均（BMA）</strong></p>
<p>当存在多个竞争模型时，贝叶斯模型平均通过加权平均的方式整合不同模型的预测： <span class="math display">\[P(\theta|D) = \sum_{k=1}^K P(\theta|D, M_k)P(M_k|D)\]</span></p>
<p>其中模型权重<span class="math inline">\(P(M_k|D)\)</span>基于边际似然计算： <span class="math display">\[P(M_k|D) = \frac{P(D|M_k)P(M_k)}{\sum_{j=1}^K P(D|M_j)P(M_j)}\]</span></p>
<p><strong>生态学应用</strong>：处理生态模型的不确定性，如： - 物种分布模型的比较 - 种群动态模型的选择 - 群落构建机制的识别</p>
</div>
<div id="贝叶斯可信区间" class="section level3 hasAnchor" number="9.4.5">
<h3><span class="header-section-number">9.4.5</span> 贝叶斯可信区间<a href="模型选择与评估.html#贝叶斯可信区间" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯可信区间（Credible Interval）是贝叶斯统计中参数不确定性的量化工具，与频率统计中的置信区间有本质区别。</p>
<p><strong>定义与解释</strong>：</p>
<p><strong>贝叶斯可信区间</strong>：对于给定的置信水平<span class="math inline">\(1-\alpha\)</span>，可信区间<span class="math inline">\([L, U]\)</span>满足： <span class="math display">\[P(L \leq \theta \leq U | D) = 1 - \alpha\]</span></p>
<p>这意味着在给定观测数据<span class="math inline">\(D\)</span>的条件下，参数<span class="math inline">\(\theta\)</span>落在区间<span class="math inline">\([L, U]\)</span>内的概率为<span class="math inline">\(1-\alpha\)</span>。</p>
<p><strong>与频率置信区间的区别</strong>： - <strong>贝叶斯可信区间</strong>：参数在区间内的概率 - <strong>频率置信区间</strong>：重复抽样时区间包含参数的概率</p>
<p><strong>计算方法</strong>： 1. <strong>最高后验密度区间（HPDI）</strong>：包含后验分布最高密度区域的区间 2. <strong>等尾区间</strong>：基于后验分布分位数的对称区间</p>
<p><strong>生态学意义</strong>： - 提供参数不确定性的直观解释 - 直接回答”参数在某个范围内的概率是多少” - 特别适合风险评估和决策支持</p>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="模型选择与评估.html#cb923-1" tabindex="-1"></a><span class="co"># 贝叶斯模型选择演示 - 数据生成</span></span>
<span id="cb923-2"><a href="模型选择与评估.html#cb923-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5050</span>)</span>
<span id="cb923-3"><a href="模型选择与评估.html#cb923-3" tabindex="-1"></a></span>
<span id="cb923-4"><a href="模型选择与评估.html#cb923-4" tabindex="-1"></a><span class="co"># 生成林小雨的森林生态数据：森林鸟类丰富度与环境因子的关系</span></span>
<span id="cb923-5"><a href="模型选择与评估.html#cb923-5" tabindex="-1"></a>n_forest_birds <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb923-6"><a href="模型选择与评估.html#cb923-6" tabindex="-1"></a></span>
<span id="cb923-7"><a href="模型选择与评估.html#cb923-7" tabindex="-1"></a><span class="co"># 林小雨测量的森林环境因子</span></span>
<span id="cb923-8"><a href="模型选择与评估.html#cb923-8" tabindex="-1"></a>forest_habitat_area <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_birds, <span class="dv">1</span>, <span class="dv">100</span>) <span class="co"># 栖息地面积(公顷)</span></span>
<span id="cb923-9"><a href="模型选择与评估.html#cb923-9" tabindex="-1"></a>forest_vegetation_density <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_birds, <span class="fl">0.1</span>, <span class="fl">0.9</span>) <span class="co"># 植被密度</span></span>
<span id="cb923-10"><a href="模型选择与评估.html#cb923-10" tabindex="-1"></a>forest_distance_to_water <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_forest_birds, <span class="fl">0.1</span>, <span class="dv">5</span>) <span class="co"># 距水源距离(km)</span></span>
<span id="cb923-11"><a href="模型选择与评估.html#cb923-11" tabindex="-1"></a></span>
<span id="cb923-12"><a href="模型选择与评估.html#cb923-12" tabindex="-1"></a><span class="co"># 生成森林鸟类丰富度数据</span></span>
<span id="cb923-13"><a href="模型选择与评估.html#cb923-13" tabindex="-1"></a>forest_bird_richness <span class="ot">&lt;-</span> <span class="fu">rpois</span>(</span>
<span id="cb923-14"><a href="模型选择与评估.html#cb923-14" tabindex="-1"></a>  n_forest_birds,</span>
<span id="cb923-15"><a href="模型选择与评估.html#cb923-15" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="fl">1.5</span> <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> forest_habitat_area <span class="sc">+</span></span>
<span id="cb923-16"><a href="模型选择与评估.html#cb923-16" tabindex="-1"></a>    <span class="fl">1.2</span> <span class="sc">*</span> forest_vegetation_density <span class="sc">-</span> <span class="fl">0.3</span> <span class="sc">*</span> forest_distance_to_water <span class="sc">+</span></span>
<span id="cb923-17"><a href="模型选择与评估.html#cb923-17" tabindex="-1"></a>    <span class="fu">rnorm</span>(n_forest_birds, <span class="dv">0</span>, <span class="fl">0.3</span>))</span>
<span id="cb923-18"><a href="模型选择与评估.html#cb923-18" tabindex="-1"></a>)</span>
<span id="cb923-19"><a href="模型选择与评估.html#cb923-19" tabindex="-1"></a></span>
<span id="cb923-20"><a href="模型选择与评估.html#cb923-20" tabindex="-1"></a><span class="co"># 创建林小雨的森林数据框</span></span>
<span id="cb923-21"><a href="模型选择与评估.html#cb923-21" tabindex="-1"></a>forest_bird_data_bayes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb923-22"><a href="模型选择与评估.html#cb923-22" tabindex="-1"></a>  <span class="at">richness =</span> forest_bird_richness,</span>
<span id="cb923-23"><a href="模型选择与评估.html#cb923-23" tabindex="-1"></a>  <span class="at">area =</span> forest_habitat_area,</span>
<span id="cb923-24"><a href="模型选择与评估.html#cb923-24" tabindex="-1"></a>  <span class="at">vegetation =</span> forest_vegetation_density,</span>
<span id="cb923-25"><a href="模型选择与评估.html#cb923-25" tabindex="-1"></a>  <span class="at">water_distance =</span> forest_distance_to_water</span>
<span id="cb923-26"><a href="模型选择与评估.html#cb923-26" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="贝叶斯因子计算与解释" class="section level3 hasAnchor" number="9.4.6">
<h3><span class="header-section-number">9.4.6</span> 贝叶斯因子计算与解释<a href="模型选择与评估.html#贝叶斯因子计算与解释" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在R中，我们可以使用<code>BayesFactor</code>包来计算贝叶斯因子：</p>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="模型选择与评估.html#cb924-1" tabindex="-1"></a><span class="co"># 贝叶斯因子计算</span></span>
<span id="cb924-2"><a href="模型选择与评估.html#cb924-2" tabindex="-1"></a><span class="fu">library</span>(BayesFactor)</span>
<span id="cb924-3"><a href="模型选择与评估.html#cb924-3" tabindex="-1"></a></span>
<span id="cb924-4"><a href="模型选择与评估.html#cb924-4" tabindex="-1"></a><span class="co"># 构建候选模型</span></span>
<span id="cb924-5"><a href="模型选择与评估.html#cb924-5" tabindex="-1"></a><span class="co"># 模型1：只有栖息地面积</span></span>
<span id="cb924-6"><a href="模型选择与评估.html#cb924-6" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(richness <span class="sc">~</span> area, <span class="at">data =</span> forest_bird_data_bayes)</span>
<span id="cb924-7"><a href="模型选择与评估.html#cb924-7" tabindex="-1"></a></span>
<span id="cb924-8"><a href="模型选择与评估.html#cb924-8" tabindex="-1"></a><span class="co"># 模型2：栖息地面积 + 植被密度</span></span>
<span id="cb924-9"><a href="模型选择与评估.html#cb924-9" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(richness <span class="sc">~</span> area <span class="sc">+</span> vegetation, <span class="at">data =</span> forest_bird_data_bayes)</span>
<span id="cb924-10"><a href="模型选择与评估.html#cb924-10" tabindex="-1"></a></span>
<span id="cb924-11"><a href="模型选择与评估.html#cb924-11" tabindex="-1"></a><span class="co"># 模型3：栖息地面积 + 植被密度 + 距水源距离</span></span>
<span id="cb924-12"><a href="模型选择与评估.html#cb924-12" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lmBF</span>(richness <span class="sc">~</span> area <span class="sc">+</span> vegetation <span class="sc">+</span> water_distance,</span>
<span id="cb924-13"><a href="模型选择与评估.html#cb924-13" tabindex="-1"></a>  <span class="at">data =</span> forest_bird_data_bayes</span>
<span id="cb924-14"><a href="模型选择与评估.html#cb924-14" tabindex="-1"></a>)</span>
<span id="cb924-15"><a href="模型选择与评估.html#cb924-15" tabindex="-1"></a></span>
<span id="cb924-16"><a href="模型选择与评估.html#cb924-16" tabindex="-1"></a><span class="co"># 计算贝叶斯因子</span></span>
<span id="cb924-17"><a href="模型选择与评估.html#cb924-17" tabindex="-1"></a>bf_12 <span class="ot">&lt;-</span> model2 <span class="sc">/</span> model1</span>
<span id="cb924-18"><a href="模型选择与评估.html#cb924-18" tabindex="-1"></a>bf_23 <span class="ot">&lt;-</span> model3 <span class="sc">/</span> model2</span></code></pre></div>
<p>贝叶斯因子比较结果显示，模型2相对于模型1的贝叶斯因子为 1.28，模型3相对于模型2的贝叶斯因子为 2.1013994^{5}。</p>
<p>根据Jeffreys标准，贝叶斯因子的解释标准为：1-3表示微弱证据，3-10表示实质性证据，10-30表示强证据，30-100表示很强证据，大于100表示决定性证据。</p>
<div class="sourceCode" id="cb925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb925-1"><a href="模型选择与评估.html#cb925-1" tabindex="-1"></a><span class="co"># 计算后验模型概率</span></span>
<span id="cb925-2"><a href="模型选择与评估.html#cb925-2" tabindex="-1"></a><span class="co"># 假设等先验概率</span></span>
<span id="cb925-3"><a href="模型选择与评估.html#cb925-3" tabindex="-1"></a>prior_prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>)</span>
<span id="cb925-4"><a href="模型选择与评估.html#cb925-4" tabindex="-1"></a>bf_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb925-5"><a href="模型选择与评估.html#cb925-5" tabindex="-1"></a>  <span class="dv">1</span>, <span class="fu">exp</span>(bf_12<span class="sc">@</span>bayesFactor<span class="sc">$</span>bf),</span>
<span id="cb925-6"><a href="模型选择与评估.html#cb925-6" tabindex="-1"></a>  <span class="fu">exp</span>(bf_23<span class="sc">@</span>bayesFactor<span class="sc">$</span>bf) <span class="sc">*</span> <span class="fu">exp</span>(bf_12<span class="sc">@</span>bayesFactor<span class="sc">$</span>bf)</span>
<span id="cb925-7"><a href="模型选择与评估.html#cb925-7" tabindex="-1"></a>)</span>
<span id="cb925-8"><a href="模型选择与评估.html#cb925-8" tabindex="-1"></a>posterior_prob <span class="ot">&lt;-</span> bf_vector <span class="sc">*</span> prior_prob <span class="sc">/</span> <span class="fu">sum</span>(bf_vector <span class="sc">*</span> prior_prob)</span></code></pre></div>
<pre><code>## 
## === 林小雨的森林鸟类模型后验模型概率 ===
##  模型1 (只有栖息地面积): 0 
##  模型2 (栖息地面积+植被密度): 0 
##  模型3 (栖息地面积+植被密度+距水源距离): 1</code></pre>
</div>
<div id="贝叶斯模型平均" class="section level3 hasAnchor" number="9.4.7">
<h3><span class="header-section-number">9.4.7</span> 贝叶斯模型平均<a href="模型选择与评估.html#贝叶斯模型平均" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯模型平均通过后验模型概率对多个候选模型的预测进行加权平均，从而整合模型不确定性：</p>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb927-1"><a href="模型选择与评估.html#cb927-1" tabindex="-1"></a><span class="co"># 贝叶斯模型平均演示</span></span>
<span id="cb927-2"><a href="模型选择与评估.html#cb927-2" tabindex="-1"></a><span class="fu">library</span>(BMS)</span>
<span id="cb927-3"><a href="模型选择与评估.html#cb927-3" tabindex="-1"></a></span>
<span id="cb927-4"><a href="模型选择与评估.html#cb927-4" tabindex="-1"></a><span class="co"># 使用BMS包进行贝叶斯模型平均</span></span>
<span id="cb927-5"><a href="模型选择与评估.html#cb927-5" tabindex="-1"></a><span class="co"># 注意：这里使用线性回归的贝叶斯模型平均</span></span>
<span id="cb927-6"><a href="模型选择与评估.html#cb927-6" tabindex="-1"></a><span class="co"># 在实际应用中，对于计数数据应该使用泊松回归</span></span>
<span id="cb927-7"><a href="模型选择与评估.html#cb927-7" tabindex="-1"></a></span>
<span id="cb927-8"><a href="模型选择与评估.html#cb927-8" tabindex="-1"></a><span class="co"># 创建设计矩阵</span></span>
<span id="cb927-9"><a href="模型选择与评估.html#cb927-9" tabindex="-1"></a>design_matrix <span class="ot">&lt;-</span> forest_bird_data_bayes[, <span class="fu">c</span>(<span class="st">&quot;area&quot;</span>, <span class="st">&quot;vegetation&quot;</span>, <span class="st">&quot;water_distance&quot;</span>)]</span>
<span id="cb927-10"><a href="模型选择与评估.html#cb927-10" tabindex="-1"></a>response_var <span class="ot">&lt;-</span> forest_bird_data_bayes<span class="sc">$</span>richness</span>
<span id="cb927-11"><a href="模型选择与评估.html#cb927-11" tabindex="-1"></a></span>
<span id="cb927-12"><a href="模型选择与评估.html#cb927-12" tabindex="-1"></a><span class="co"># 执行贝叶斯模型平均</span></span>
<span id="cb927-13"><a href="模型选择与评估.html#cb927-13" tabindex="-1"></a>bma_result <span class="ot">&lt;-</span> <span class="fu">bms</span>(<span class="fu">cbind</span>(response_var, design_matrix), <span class="at">burn =</span> <span class="dv">1000</span>, <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">g =</span> <span class="st">&quot;UIP&quot;</span>)</span></code></pre></div>
<pre><code>##                      PIP  Post Mean    Post SD Cond.Pos.Sign Idx
## area           1.0000000  0.2638852 0.02977124             1   1
## water_distance 0.9999979 -3.4862236 0.59152078             0   3
## vegetation     0.9444822  9.8845073 4.31007528             1   2
## 
## Mean no. regressors               Draws             Burnins                Time 
##            &quot;2.9445&quot;                 &quot;8&quot;                 &quot;0&quot;  &quot;0.008826017 secs&quot; 
##  No. models visited      Modelspace 2^K           % visited         % Topmodels 
##                 &quot;8&quot;                 &quot;8&quot;               &quot;100&quot;               &quot;100&quot; 
##            Corr PMP            No. Obs.         Model Prior             g-Prior 
##                &quot;NA&quot;                &quot;80&quot;      &quot;random / 1.5&quot;               &quot;UIP&quot; 
##     Shrinkage-Stats 
##         &quot;Av=0.9877&quot; 
## 
## Time difference of 0.008826017 secs</code></pre>
<p><img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-56-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb929-1"><a href="模型选择与评估.html#cb929-1" tabindex="-1"></a><span class="co"># 输出模型平均结果</span></span>
<span id="cb929-2"><a href="模型选择与评估.html#cb929-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 林小雨的森林鸟类贝叶斯模型平均结果 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 林小雨的森林鸟类贝叶斯模型平均结果 ===</code></pre>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="模型选择与评估.html#cb931-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(bma_result))</span></code></pre></div>
<pre><code>## Mean no. regressors               Draws             Burnins                Time 
##            &quot;2.9445&quot;                 &quot;8&quot;                 &quot;0&quot;  &quot;0.008826017 secs&quot; 
##  No. models visited      Modelspace 2^K           % visited         % Topmodels 
##                 &quot;8&quot;                 &quot;8&quot;               &quot;100&quot;               &quot;100&quot; 
##            Corr PMP            No. Obs.         Model Prior             g-Prior 
##                &quot;NA&quot;                &quot;80&quot;      &quot;random / 1.5&quot;               &quot;UIP&quot; 
##     Shrinkage-Stats 
##         &quot;Av=0.9877&quot;</code></pre>
<pre><code>## 
## === 林小雨的森林鸟类变量后验包含概率 ===</code></pre>
<pre><code>## 无法提取后验包含概率，请检查BMS包版本</code></pre>
<p>后验包含概率的解释标准为：后验包含概率大于0.5表示变量很可能重要，大于0.75表示变量很可能非常重要，大于0.95表示变量几乎确定重要。</p>
</div>
<div id="贝叶斯预测评估" class="section level3 hasAnchor" number="9.4.8">
<h3><span class="header-section-number">9.4.8</span> 贝叶斯预测评估<a href="模型选择与评估.html#贝叶斯预测评估" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯方法通过后验预测分布提供完整的预测不确定性量化：</p>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="模型选择与评估.html#cb935-1" tabindex="-1"></a><span class="co"># 贝叶斯预测评估演示</span></span>
<span id="cb935-2"><a href="模型选择与评估.html#cb935-2" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb935-3"><a href="模型选择与评估.html#cb935-3" tabindex="-1"></a></span>
<span id="cb935-4"><a href="模型选择与评估.html#cb935-4" tabindex="-1"></a><span class="co"># 使用brms进行贝叶斯泊松回归</span></span>
<span id="cb935-5"><a href="模型选择与评估.html#cb935-5" tabindex="-1"></a></span>
<span id="cb935-6"><a href="模型选择与评估.html#cb935-6" tabindex="-1"></a><span class="co"># 拟合贝叶斯泊松回归模型</span></span>
<span id="cb935-7"><a href="模型选择与评估.html#cb935-7" tabindex="-1"></a>bayes_poisson <span class="ot">&lt;-</span> <span class="fu">brm</span>(richness <span class="sc">~</span> area <span class="sc">+</span> vegetation <span class="sc">+</span> water_distance,</span>
<span id="cb935-8"><a href="模型选择与评估.html#cb935-8" tabindex="-1"></a>  <span class="at">data =</span> forest_bird_data_bayes,</span>
<span id="cb935-9"><a href="模型选择与评估.html#cb935-9" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(),</span>
<span id="cb935-10"><a href="模型选择与评估.html#cb935-10" tabindex="-1"></a>  <span class="at">prior =</span> <span class="fu">c</span>(</span>
<span id="cb935-11"><a href="模型选择与评估.html#cb935-11" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">2.5</span>), <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb935-12"><a href="模型选择与评估.html#cb935-12" tabindex="-1"></a>    <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>)</span>
<span id="cb935-13"><a href="模型选择与评估.html#cb935-13" tabindex="-1"></a>  ),</span>
<span id="cb935-14"><a href="模型选择与评估.html#cb935-14" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">2</span>, <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb935-15"><a href="模型选择与评估.html#cb935-15" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">1234</span>, <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">refresh =</span> <span class="dv">0</span></span>
<span id="cb935-16"><a href="模型选择与评估.html#cb935-16" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running /usr/lib/R/bin/R CMD SHLIB foo.c
## using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’
## gcc -I&quot;/usr/share/R/include&quot; -DNDEBUG   -I&quot;/home/gcshen/R/x86_64-pc-linux-gnu-library/4.3/Rcpp/include/&quot;  -I&quot;/home/gcshen/R/x86_64-pc-linux-gnu-library/4.3/RcppEigen/include/&quot;  -I&quot;/home/gcshen/R/x86_64-pc-linux-gnu-library/4.3/RcppEigen/include/unsupported&quot;  -I&quot;/home/gcshen/R/x86_64-pc-linux-gnu-library/4.3/BH/include&quot; -I&quot;/home/gcshen/R/x86_64-pc-linux-gnu-library/4.3/StanHeaders/include/src/&quot;  -I&quot;/home/gcshen/R/x86_64-pc-linux-gnu-library/4.3/StanHeaders/include/&quot;  -I&quot;/home/gcshen/R/x86_64-pc-linux-gnu-library/4.3/RcppParallel/include/&quot;  -I&quot;/home/gcshen/R/x86_64-pc-linux-gnu-library/4.3/rstan/include&quot; -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DUSE_STANC3 -DSTRICT_R_HEADERS  -DBOOST_PHOENIX_NO_VARIADIC_EXPRESSION  -D_HAS_AUTO_PTR_ETC=0  -include &#39;/home/gcshen/R/x86_64-pc-linux-gnu-library/4.3/StanHeaders/include/stan/math/prim/fun/Eigen.hpp&#39;  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1       -fpic  -g -O2 -fno-omit-frame-pointer -mno-omit-leaf-frame-pointer -ffile-prefix-map=/build/r-base-FPSnzf/r-base-4.3.3=. -fstack-protector-strong -fstack-clash-protection -Wformat -Werror=format-security -fcf-protection -fdebug-prefix-map=/build/r-base-FPSnzf/r-base-4.3.3=/usr/src/r-base-4.3.3-2build2 -Wdate-time -D_FORTIFY_SOURCE=3  -c foo.c -o foo.o
## In file included from /home/gcshen/R/x86_64-pc-linux-gnu-library/4.3/RcppEigen/include/Eigen/Core:19,
##                  from /home/gcshen/R/x86_64-pc-linux-gnu-library/4.3/RcppEigen/include/Eigen/Dense:1,
##                  from /home/gcshen/R/x86_64-pc-linux-gnu-library/4.3/StanHeaders/include/stan/math/prim/fun/Eigen.hpp:22,
##                  from &lt;command-line&gt;:
## /home/gcshen/R/x86_64-pc-linux-gnu-library/4.3/RcppEigen/include/Eigen/src/Core/util/Macros.h:679:10: fatal error: cmath: No such file or directory
##   679 | #include &lt;cmath&gt;
##       |          ^~~~~~~
## compilation terminated.
## make: *** [/usr/lib/R/etc/Makeconf:191: foo.o] Error 1</code></pre>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="模型选择与评估.html#cb937-1" tabindex="-1"></a><span class="co"># 后验预测分布</span></span>
<span id="cb937-2"><a href="模型选择与评估.html#cb937-2" tabindex="-1"></a>posterior_predictive <span class="ot">&lt;-</span> <span class="fu">posterior_predict</span>(bayes_poisson)</span>
<span id="cb937-3"><a href="模型选择与评估.html#cb937-3" tabindex="-1"></a></span>
<span id="cb937-4"><a href="模型选择与评估.html#cb937-4" tabindex="-1"></a><span class="co"># 计算预测统计量</span></span>
<span id="cb937-5"><a href="模型选择与评估.html#cb937-5" tabindex="-1"></a>pred_mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(posterior_predictive, <span class="dv">2</span>, mean)</span>
<span id="cb937-6"><a href="模型选择与评估.html#cb937-6" tabindex="-1"></a>pred_ci <span class="ot">&lt;-</span> <span class="fu">apply</span>(posterior_predictive, <span class="dv">2</span>, quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb937-7"><a href="模型选择与评估.html#cb937-7" tabindex="-1"></a></span>
<span id="cb937-8"><a href="模型选择与评估.html#cb937-8" tabindex="-1"></a><span class="co"># 可视化预测不确定性</span></span>
<span id="cb937-9"><a href="模型选择与评估.html#cb937-9" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb937-10"><a href="模型选择与评估.html#cb937-10" tabindex="-1"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb937-11"><a href="模型选择与评估.html#cb937-11" tabindex="-1"></a>  <span class="at">Observed =</span> forest_bird_data_bayes<span class="sc">$</span>richness,</span>
<span id="cb937-12"><a href="模型选择与评估.html#cb937-12" tabindex="-1"></a>  <span class="at">Predicted =</span> pred_mean,</span>
<span id="cb937-13"><a href="模型选择与评估.html#cb937-13" tabindex="-1"></a>  <span class="at">Lower =</span> pred_ci[<span class="dv">1</span>, ],</span>
<span id="cb937-14"><a href="模型选择与评估.html#cb937-14" tabindex="-1"></a>  <span class="at">Upper =</span> pred_ci[<span class="dv">2</span>, ]</span>
<span id="cb937-15"><a href="模型选择与评估.html#cb937-15" tabindex="-1"></a>)</span>
<span id="cb937-16"><a href="模型选择与评估.html#cb937-16" tabindex="-1"></a></span>
<span id="cb937-17"><a href="模型选择与评估.html#cb937-17" tabindex="-1"></a><span class="fu">ggplot</span>(pred_data, <span class="fu">aes</span>(<span class="at">x =</span> Observed, <span class="at">y =</span> Predicted)) <span class="sc">+</span></span>
<span id="cb937-18"><a href="模型选择与评估.html#cb937-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb937-19"><a href="模型选择与评估.html#cb937-19" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Lower, <span class="at">ymax =</span> Upper), <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb937-20"><a href="模型选择与评估.html#cb937-20" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb937-21"><a href="模型选择与评估.html#cb937-21" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb937-22"><a href="模型选择与评估.html#cb937-22" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;林小雨的森林鸟类贝叶斯预测：观测值 vs 预测值&quot;</span>,</span>
<span id="cb937-23"><a href="模型选择与评估.html#cb937-23" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;观测鸟类丰富度&quot;</span>,</span>
<span id="cb937-24"><a href="模型选择与评估.html#cb937-24" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;预测鸟类丰富度&quot;</span></span>
<span id="cb937-25"><a href="模型选择与评估.html#cb937-25" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb937-26"><a href="模型选择与评估.html#cb937-26" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-58-1"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-58-1.png" alt="贝叶斯预测：观测值与预测值的比较，包含95%预测区间" width="80%" />
<p class="caption">
图9.2: 贝叶斯预测：观测值与预测值的比较，包含95%预测区间
</p>
</div>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb938-1"><a href="模型选择与评估.html#cb938-1" tabindex="-1"></a><span class="co"># 后验预测检查</span></span>
<span id="cb938-2"><a href="模型选择与评估.html#cb938-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;=== 后验预测检查 ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## === 后验预测检查 ===</code></pre>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="模型选择与评估.html#cb940-1" tabindex="-1"></a><span class="co"># 计算后验预测p值</span></span>
<span id="cb940-2"><a href="模型选择与评估.html#cb940-2" tabindex="-1"></a>pp_check <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(bayes_poisson)</span>
<span id="cb940-3"><a href="模型选择与评估.html#cb940-3" tabindex="-1"></a><span class="fu">print</span>(pp_check)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-58-2"></span>
<img src="09-model_selection_and_evaluation_files/figure-html/unnamed-chunk-58-2.png" alt="贝叶斯预测：观测值与预测值的比较，包含95%预测区间" width="80%" />
<p class="caption">
图9.3: 贝叶斯预测：观测值与预测值的比较，包含95%预测区间
</p>
</div>
<pre><code>## 
## 后验预测检查帮助我们验证模型是否能够生成与观测数据相似的数据。</code></pre>
<pre><code>## 如果模型拟合良好，后验预测分布应该与观测数据分布相似。</code></pre>
</div>
<div id="贝叶斯变量选择" class="section level3 hasAnchor" number="9.4.9">
<h3><span class="header-section-number">9.4.9</span> 贝叶斯变量选择<a href="模型选择与评估.html#贝叶斯变量选择" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯变量选择通过稀疏先验自动进行变量选择：</p>
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb943-1"><a href="模型选择与评估.html#cb943-1" tabindex="-1"></a><span class="co"># 贝叶斯变量选择演示：林小雨的森林鸟类环境因子筛选</span></span>
<span id="cb943-2"><a href="模型选择与评估.html#cb943-2" tabindex="-1"></a><span class="fu">library</span>(monomvn)</span>
<span id="cb943-3"><a href="模型选择与评估.html#cb943-3" tabindex="-1"></a></span>
<span id="cb943-4"><a href="模型选择与评估.html#cb943-4" tabindex="-1"></a><span class="co"># 使用贝叶斯LASSO进行变量选择</span></span>
<span id="cb943-5"><a href="模型选择与评估.html#cb943-5" tabindex="-1"></a><span class="co"># 注意：这里使用连续响应的简化版本</span></span>
<span id="cb943-6"><a href="模型选择与评估.html#cb943-6" tabindex="-1"></a></span>
<span id="cb943-7"><a href="模型选择与评估.html#cb943-7" tabindex="-1"></a><span class="co"># 创建包含冗余变量的扩展数据集</span></span>
<span id="cb943-8"><a href="模型选择与评估.html#cb943-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6060</span>)</span>
<span id="cb943-9"><a href="模型选择与评估.html#cb943-9" tabindex="-1"></a>forest_bird_data_extended <span class="ot">&lt;-</span> forest_bird_data_bayes</span>
<span id="cb943-10"><a href="模型选择与评估.html#cb943-10" tabindex="-1"></a>forest_bird_data_extended<span class="sc">$</span>redundant1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_forest_birds, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># 冗余变量1（林小雨测量的非相关因子）</span></span>
<span id="cb943-11"><a href="模型选择与评估.html#cb943-11" tabindex="-1"></a>forest_bird_data_extended<span class="sc">$</span>redundant2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_forest_birds, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># 冗余变量2（林小雨测量的非相关因子）</span></span>
<span id="cb943-12"><a href="模型选择与评估.html#cb943-12" tabindex="-1"></a></span>
<span id="cb943-13"><a href="模型选择与评估.html#cb943-13" tabindex="-1"></a><span class="co"># 贝叶斯LASSO变量选择</span></span>
<span id="cb943-14"><a href="模型选择与评估.html#cb943-14" tabindex="-1"></a><span class="co"># 使用monomvn包的blasso函数</span></span>
<span id="cb943-15"><a href="模型选择与评估.html#cb943-15" tabindex="-1"></a>blasso_result <span class="ot">&lt;-</span> <span class="fu">blasso</span>(</span>
<span id="cb943-16"><a href="模型选择与评估.html#cb943-16" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">as.matrix</span>(forest_bird_data_extended[, <span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb943-17"><a href="模型选择与评估.html#cb943-17" tabindex="-1"></a>  <span class="at">y =</span> forest_bird_data_extended<span class="sc">$</span>richness,</span>
<span id="cb943-18"><a href="模型选择与评估.html#cb943-18" tabindex="-1"></a>  <span class="at">T =</span> <span class="dv">5000</span>, <span class="at">verb =</span> <span class="dv">0</span></span>
<span id="cb943-19"><a href="模型选择与评估.html#cb943-19" tabindex="-1"></a>)</span>
<span id="cb943-20"><a href="模型选择与评估.html#cb943-20" tabindex="-1"></a></span>
<span id="cb943-21"><a href="模型选择与评估.html#cb943-21" tabindex="-1"></a><span class="co"># 提取后验包含概率</span></span>
<span id="cb943-22"><a href="模型选择与评估.html#cb943-22" tabindex="-1"></a>posterior_inclusion <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(blasso_result<span class="sc">$</span>beta <span class="sc">!=</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## === 林小雨的森林鸟类贝叶斯LASSO变量选择结果 ===</code></pre>
<pre><code>## b.1 : 1 
## b.2 : 0.928 
## b.3 : 0.999 
## b.4 : 0.974 
## b.5 : 0.263</code></pre>
<p>在林小雨的森林鸟类研究中，贝叶斯LASSO通过Laplace先验自动进行变量选择。后验包含概率反映了每个环境因子被包含在模型中的概率。真实影响鸟类丰富度的环境因子（如栖息地面积、植被密度、距水源距离）应该具有较高的后验包含概率，而林小雨测量的冗余变量（如与鸟类丰富度无关的随机因子）应该具有较低的概率。这种自动化的变量选择方法帮助林小雨识别出真正重要的环境驱动因子，避免了主观偏见对模型选择的影响。</p>
</div>
<div id="生态学应用价值" class="section level3 hasAnchor" number="9.4.10">
<h3><span class="header-section-number">9.4.10</span> 生态学应用价值<a href="模型选择与评估.html#生态学应用价值" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯模型选择与评估在生态学中具有重要的应用价值：</p>
<p><strong>1. 小样本情况下的稳健性</strong> - 贝叶斯方法在小样本情况下通常比频率学派方法更稳健 - 通过合理选择先验分布，可以整合领域知识</p>
<p><strong>2. 不确定性量化</strong> - 贝叶斯方法提供完整的后验分布，而非点估计 - 预测不确定性完全量化，便于风险评估</p>
<p><strong>3. 模型不确定性整合</strong> - 贝叶斯模型平均整合了模型选择的不确定性 - 避免了”赢者通吃”的问题</p>
<p><strong>4. 生态学解释性</strong> - 后验概率提供了更直观的生态学解释 - 变量重要性基于后验包含概率，而非p值</p>
<p><strong>5. 复杂模型的适应性</strong> - 贝叶斯方法特别适合复杂生态模型 - 可以处理层次结构、时空相关性等复杂特征</p>
</div>
<div id="贝叶斯检验的生态学应用案例" class="section level3 hasAnchor" number="9.4.11">
<h3><span class="header-section-number">9.4.11</span> 贝叶斯检验的生态学应用案例<a href="模型选择与评估.html#贝叶斯检验的生态学应用案例" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯方法在生态学研究中具有广泛的应用价值，特别是在处理复杂生态模型、整合多源数据和量化不确定性方面展现出独特优势。以下是三个典型的生态学应用案例：</p>
<p><strong>案例1：物种分布模型与环境因子分析</strong></p>
<p>物种分布模型是生态学中应用贝叶斯方法的经典场景，能够同时处理观测误差、环境异质性和参数不确定性。</p>
<p><strong>案例2：种群动态的状态空间模型</strong></p>
<p>贝叶斯状态空间模型能够分离过程误差和观测误差，重建真实的种群动态轨迹。</p>
<p><strong>案例3：群落生态学的多元分析</strong></p>
<p>在群落生态学中，贝叶斯方法可以处理多物种响应，量化物种间的变异和共性。</p>
<p>这些案例展示了贝叶斯方法在生态学不同领域的强大应用能力：</p>
<ol style="list-style-type: decimal">
<li><strong>物种分布模型</strong>：处理存在-缺失数据，量化环境因子的不确定性</li>
<li><strong>种群动态分析</strong>：分离过程误差和观测误差，重建真实种群轨迹</li>
<li><strong>群落生态学</strong>：处理多物种响应，量化物种间的变异和共性</li>
</ol>
<p>贝叶斯方法的优势在于能够： - 明确量化所有参数的不确定性 - 整合先验知识和观测数据 - 处理复杂的层次结构和随机效应 - 提供完整的后验分布而非点估计</p>
<p>这些特性使得贝叶斯方法特别适合处理生态学中常见的小样本、复杂结构和高度不确定性问题。</p>
</div>
<div id="贝叶斯方法的局限性" class="section level3 hasAnchor" number="9.4.12">
<h3><span class="header-section-number">9.4.12</span> 贝叶斯方法的局限性<a href="模型选择与评估.html#贝叶斯方法的局限性" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>尽管贝叶斯方法具有诸多优势，但也存在一些局限性：</p>
<p><strong>1. 计算复杂性</strong> - MCMC采样计算成本较高 - 需要专业知识设置先验和诊断收敛</p>
<p><strong>2. 先验选择敏感性</strong> - 结果可能对先验分布选择敏感 - 需要谨慎选择合理的先验</p>
<p><strong>3. 收敛诊断</strong> - 需要仔细检查MCMC链的收敛性 - 诊断工具相对复杂</p>
<p><strong>4. 软件学习曲线</strong> - 贝叶斯软件（Stan、JAGS）学习曲线较陡 - 需要掌握新的编程范式</p>
<p>在生态学研究中，贝叶斯方法和频率学派方法各有优势。理想的做法是根据具体研究问题和数据特征选择合适的方法，或者在可能的情况下同时使用两种方法进行交叉验证。</p>
</div>
</div>
<div id="总结-9" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> 总结<a href="模型选择与评估.html#总结-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>林小雨站在保护区管理站的办公室里，整理着这几个月来的研究成果。电脑屏幕上显示着一系列森林生态系统模型的分析结果，每个模型都代表着她对森林生态系统的一次深入理解。从最初简单的温度与树木生长关系，到现在能够综合考虑多个环境因子的复杂模型，她的研究历程见证了模型选择与评估在生态学研究中的核心价值。</p>
<div id="研究历程的回顾" class="section level3 hasAnchor" number="9.5.1">
<h3><span class="header-section-number">9.5.1</span> 研究历程的回顾<a href="模型选择与评估.html#研究历程的回顾" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>林小雨的模型选择与评估之旅始于一个关键认识：在众多候选模型中，如何选择最可靠的那一个？她首先学习了模型选择的基本原则，理解了模型复杂度与拟合优度之间的权衡。在分析森林土壤养分与植物生物量关系时，她运用奥卡姆剃刀原则，在简约性和解释力之间找到了最佳平衡点。二次多项式模型成功捕捉了植物对养分的最适响应模式，而过高次数的多项式则导致了过度拟合。</p>
<p>信息准则成为林小雨模型比较的重要工具。在研究森林鸟类丰富度与环境因子关系时，她使用AIC和BIC系统地比较了多个候选模型。通过<span class="math inline">\(\Delta\text{AIC}\)</span>差异，她识别出栖息地面积、植被密度和距水源距离是影响鸟类丰富度的关键因子，而土壤pH值等其他因子的贡献相对有限。信息准则帮助她在统计显著性和生态学意义之间找到了平衡。</p>
<p>似然比检验让林小雨能够系统地评估模型复杂度的必要性。在苗圃实验中研究温度与光照对植物生长的影响时，似然比检验帮助她判断是否需要考虑温度-光照交互作用。统计显著的交互项揭示了环境因子的协同效应，为苗圃管理提供了科学指导。</p>
<p>模型平均方法让林小雨学会了如何处理模型选择的不确定性。在溪流鱼类丰度研究中，面对多个看似合理的候选模型，她没有采用”赢者通吃”的策略，而是通过AIC权重对不同模型的预测进行加权平均。这种方法不仅提供了更稳健的预测，还量化了不同生态假说的相对支持程度。变量重要性分析揭示了水温、溶解氧和pH值是影响鱼类丰度的关键因子，为溪流保护提供了明确的管理目标。</p>
</div>
<div id="模型评估的深刻理解" class="section level3 hasAnchor" number="9.5.2">
<h3><span class="header-section-number">9.5.2</span> 模型评估的深刻理解<a href="模型选择与评估.html#模型评估的深刻理解" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>模型评估让林小雨认识到，选择模型只是第一步，验证模型的可靠性同样重要。交叉验证成为她评估模型泛化能力的标准工具。在分析森林鸟类丰富度模型时，10折交叉验证显示模型在不同数据子集上表现稳定，RMSE的一致性证明了模型没有过度拟合训练数据的特定特征。</p>
<p>外部验证让林小雨理解了模型空间普适性的重要性。当她将在某个山地森林区域构建的植物物种丰富度模型应用到邻近但生态条件略有不同的另一个森林区域时，模型性能的适度下降提醒她注意森林生态系统的空间异质性。这种对模型局限性的清醒认识，使她在向保护区管理者汇报结果时能够明确说明模型的适用范围和不确定性。</p>
<p>模型诊断培养了林小雨对统计假设的敏感性。在树木生长速率模型中，残差分析帮助她识别出异常观测点，这些点代表了特殊的森林生态情境——火烧迹地、人工林或病虫害样地。通过Cook’s距离等影响分析工具，她不仅确保了模型的统计稳健性，还发现了值得深入研究的生态学现象。多重共线性诊断则提醒她注意环境因子间的相关性，避免了参数估计的不稳定。</p>
</div>
<div id="贝叶斯方法的新视角" class="section level3 hasAnchor" number="9.5.3">
<h3><span class="header-section-number">9.5.3</span> 贝叶斯方法的新视角<a href="模型选择与评估.html#贝叶斯方法的新视角" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>贝叶斯模型选择为林小雨打开了一扇新的窗户。与频率学派方法相比，贝叶斯方法通过后验概率提供了更直观的模型比较标准。在森林鸟类丰富度研究中，贝叶斯因子量化了不同模型的相对证据强度，后验模型概率则直接回答了”模型正确的概率是多少”这个生态学家最关心的问题。</p>
<p>贝叶斯模型平均让林小雨学会了如何整合先验知识和观测数据。通过合理设置先验分布，她能够将森林生态学的已有研究成果融入统计分析，使模型结果更加可靠。后验预测分布提供了完整的预测不确定性量化，这对于风险评估和保护决策至关重要。</p>
<p>贝叶斯变量选择通过稀疏先验自动识别重要环境因子，后验包含概率直接反映了每个变量的重要性。这种方法避免了逐步回归可能带来的多重比较问题，为林小雨提供了更可靠的变量选择结果。</p>
</div>
<div id="生态学研究的方法论启示" class="section level3 hasAnchor" number="9.5.4">
<h3><span class="header-section-number">9.5.4</span> 生态学研究的方法论启示<a href="模型选择与评估.html#生态学研究的方法论启示" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>通过系统学习模型选择与评估方法，林小雨深刻理解了几个重要的方法论原则：</p>
<p><strong>统计方法与生态学知识的结合</strong>：模型选择不应仅依赖统计准则，更要结合生态学理论。AIC最小的模型未必是生态学上最合理的模型。在某些情况下，保留统计上不显著但生态学意义明确的变量可能更加合理。</p>
<p><strong>简约性原则的价值</strong>：奥卡姆剃刀在生态建模中具有深刻意义。简约模型不仅计算效率高，更重要的是具有更好的泛化能力和生态学解释性。过度复杂的模型虽然能够完美拟合训练数据，但往往捕捉了随机噪声而非真实的生态机制。</p>
<p><strong>不确定性的诚实评估</strong>：模型评估的核心目的是识别模型的局限性。通过交叉验证、外部验证和模型诊断，林小雨学会了诚实评估模型的不确定性。在向保护区管理者汇报时，她不仅呈现预测结果，还明确说明预测的置信区间和模型的适用条件。</p>
<p><strong>多方法验证的重要性</strong>：单一的模型选择方法可能存在偏差。林小雨学会了同时使用AIC、BIC、交叉验证等多种方法来评估模型，只有在多种方法一致指向某个模型时，她才会确信这个模型的可靠性。</p>
</div>
<div id="实践应用与保护价值" class="section level3 hasAnchor" number="9.5.5">
<h3><span class="header-section-number">9.5.5</span> 实践应用与保护价值<a href="模型选择与评估.html#实践应用与保护价值" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>林小雨的模型选择与评估研究为保护区管理提供了坚实的科学依据：</p>
<p><strong>保护优先区识别</strong>：通过预测物种丰富度模型，她识别出保护价值最高的森林区域。模型显示栖息地面积大、植被密度高、距水源近的区域具有最高的鸟类丰富度，这些区域应该成为保护规划的优先目标。</p>
<p><strong>管理措施评估</strong>：交叉验证确保的模型泛化能力让她能够可靠地预测不同管理措施的生态效果。例如，模型预测扩大保护区面积10公顷将平均增加2-3种鸟类，这为保护区扩展计划提供了定量支持。</p>
<p><strong>气候变化影响预测</strong>：虽然模型的外推需要谨慎，但在合理范围内，林小雨的模型能够预测温度升高对森林生态系统的影响。模型诊断确保的统计可靠性使这些预测能够为适应性管理提供参考。</p>
<p><strong>监测方案优化</strong>：变量重要性分析帮助她优化了生态监测方案。既然栖息地面积、植被密度和距水源距离是最重要的预测变量，那么监测工作就应该优先关注这些因子的变化趋势。</p>
</div>
<div id="研究能力的提升" class="section level3 hasAnchor" number="9.5.6">
<h3><span class="header-section-number">9.5.6</span> 研究能力的提升<a href="模型选择与评估.html#研究能力的提升" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>通过这次模型选择与评估的系统学习，林小雨的研究能力获得了全面提升：</p>
<p><strong>批判性思维</strong>：她学会了批判性评估模型结果，不再盲目相信统计显著性。残差分析培养了她识别异常值的能力，模型诊断让她能够判断模型假设是否满足。</p>
<p><strong>定量分析技能</strong>：从信息准则计算到交叉验证实施，从贝叶斯因子解释到后验概率推断，她掌握了现代生态统计的核心方法。这些技能不仅适用于当前研究，更是她未来科研工作的基础。</p>
<p><strong>科学沟通能力</strong>：模型评估强化了她的科学沟通能力。在向非统计背景的保护区管理者解释模型结果时，她学会了用生态学语言阐述统计概念，用置信区间传达不确定性，用可视化工具展示预测结果。</p>
<p><strong>研究设计能力</strong>：外部验证的经验让她理解了研究设计的重要性。在未来的研究中，她会在数据收集阶段就考虑模型验证的需求，确保有足够的独立数据用于外部验证。</p>
</div>
<div id="未来研究方向" class="section level3 hasAnchor" number="9.5.7">
<h3><span class="header-section-number">9.5.7</span> 未来研究方向<a href="模型选择与评估.html#未来研究方向" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>站在研究的新起点，林小雨规划了未来的研究方向：</p>
<p><strong>模型的时空扩展</strong>：当前模型主要是空间模型，未来她希望纳入时间维度，构建时空模型来预测森林生态系统的动态变化。这需要长期监测数据和更复杂的统计方法。</p>
<p><strong>机制模型与统计模型的整合</strong>：纯统计模型虽然预测能力强，但生态学解释性有限。她希望将生态学机制模型与统计模型整合，既保持预测精度，又增强生态学可解释性。</p>
<p><strong>多物种模型</strong>：当前研究主要关注物种丰富度，未来她希望构建多物种分布模型，同时预测多个物种的分布和丰度，揭示物种间的相互作用。</p>
<p><strong>贝叶斯层次模型</strong>：贝叶斯方法的强大让她意识到层次模型的潜力。通过构建贝叶斯层次模型，她可以同时考虑样地层面、景观层面和区域层面的变异，更全面地理解森林生态系统的结构。</p>
</div>
<div id="给生态学本科生的建议" class="section level3 hasAnchor" number="9.5.8">
<h3><span class="header-section-number">9.5.8</span> 给生态学本科生的建议<a href="模型选择与评估.html#给生态学本科生的建议" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>基于自己的研究经历，林小雨总结了几点建议，希望与正在学习生态统计的同学们分享：</p>
<p><strong>扎实的统计基础</strong>：模型选择与评估需要扎实的统计学基础。不要只满足于会用R代码，要真正理解AIC、交叉验证、贝叶斯推断等方法的数学原理和适用条件。</p>
<p><strong>生态学直觉的培养</strong>：统计方法是工具，生态学直觉是灵魂。在模型选择时，始终问自己：这个模型在生态学上合理吗？参数估计值符合生态学常识吗？预测结果可以用生态学理论解释吗？</p>
<p><strong>批判性思维的重要性</strong>：不要盲目相信模型结果。每个模型都有假设和局限性，通过系统的模型诊断和验证来识别这些局限性。在科学报告中诚实地讨论模型的不确定性。</p>
<p><strong>动手实践的必要性</strong>：统计建模是实践性很强的技能。多做练习，从简单的线性回归开始，逐步尝试更复杂的模型。在实践中理解过度拟合、多重共线性等常见问题。</p>
<p><strong>持续学习的态度</strong>：生态统计方法快速发展，机器学习、深度学习等新方法不断涌现。保持开放的学习态度，关注领域内的方法学进展，但同时也要清醒地认识到，经典的模型选择与评估方法仍然是生态学研究的基石。</p>
<p>夕阳透过窗户洒在林小雨的研究笔记上，她合上笔记本，脸上露出满足的微笑。通过系统学习模型选择与评估方法，她不仅完成了保护区的研究任务，更重要的是建立了科学的思维方式和严谨的研究态度。这些能力将伴随她的整个科研生涯，帮助她在生态学研究的道路上不断前行。她知道，这只是开始，前方还有更多的生态学谜题等待她去探索，更多的统计方法等待她去掌握。但她已经准备好了，带着数学的望远镜和生态学的心，继续她的森林探索之旅。</p>
</div>
</div>
<div id="综合练习-8" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> 综合练习<a href="模型选择与评估.html#综合练习-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="练习一森林生态系统模型选择与评估综合应用" class="section level3 hasAnchor" number="9.6.1">
<h3><span class="header-section-number">9.6.1</span> 练习一：森林生态系统模型选择与评估综合应用<a href="模型选择与评估.html#练习一森林生态系统模型选择与评估综合应用" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>背景</strong>：假设你是一名生态学研究者，正在研究某山地森林生态系统中植物物种丰富度与环境因子的关系。你收集了150个森林样地的数据，包括以下变量：</p>
<ul>
<li><strong>物种丰富度</strong>：样地内植物物种数量<br />
</li>
<li><strong>海拔</strong>：样地海拔高度（米）<br />
</li>
<li><strong>年降水量</strong>：样地年降水量（毫米）<br />
</li>
<li><strong>土壤氮含量</strong>：土壤全氮含量（%）<br />
</li>
<li><strong>林冠开度</strong>：林冠开度百分比（%）<br />
</li>
<li><strong>坡度</strong>：样地坡度（度）</li>
</ul>
<p><strong>任务</strong>：</p>
<ol style="list-style-type: decimal">
<li><p><strong>模型选择</strong>：基于生态学理论和统计准则，构建3-4个候选模型来描述植物物种丰富度与环境因子的关系。解释每个模型背后的生态学假设。</p></li>
<li><p><strong>信息准则分析</strong>：计算每个模型的AIC、BIC、ΔAIC和AIC权重。根据信息准则结果，确定最优模型并解释选择依据。</p></li>
<li><p><strong>模型诊断</strong>：对最优模型进行全面的模型诊断，包括：</p>
<ul>
<li>残差分析（正态性、异方差性）<br />
</li>
<li>影响分析（高杠杆点、异常残差点、强影响点）</li>
<li>多重共线性诊断</li>
</ul></li>
<li><p><strong>交叉验证</strong>：使用10折交叉验证评估最优模型的泛化能力，计算训练集和测试集的RMSE，分析是否存在过度拟合。</p></li>
<li><p><strong>生态学解释</strong>：基于最优模型结果，解释各环境因子对植物物种丰富度的影响，并提出森林保护管理建议。</p></li>
</ol>
<p><strong>思考题</strong>：<br />
- 如果AIC最优模型与BIC最优模型不同，你会如何选择？为什么？<br />
- 在模型诊断中发现强影响点，你会如何处理？这些强影响点可能代表什么生态学现象？</p>
</div>
<div id="练习二贝叶斯模型选择与频率学派方法比较" class="section level3 hasAnchor" number="9.6.2">
<h3><span class="header-section-number">9.6.2</span> 练习二：贝叶斯模型选择与频率学派方法比较<a href="模型选择与评估.html#练习二贝叶斯模型选择与频率学派方法比较" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>背景</strong>：你正在研究溪流生态系统中鱼类丰度与环境因子的关系。数据包括80个溪流样点的鱼类丰度以及水温、溶解氧、pH值、浊度等环境因子。</p>
<p><strong>任务</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>频率学派分析</strong>：
<ul>
<li>使用逐步回归方法选择重要环境因子<br />
</li>
<li>计算AIC和BIC值，确定最优模型<br />
</li>
<li>进行模型诊断和交叉验证</li>
</ul></li>
<li><strong>贝叶斯分析</strong>：
<ul>
<li>使用贝叶斯线性回归拟合模型<br />
</li>
<li>计算贝叶斯因子比较不同模型<br />
</li>
<li>执行贝叶斯模型平均，计算变量后验包含概率<br />
</li>
<li>生成后验预测分布和95%可信区间</li>
</ul></li>
<li><strong>方法比较</strong>：
<ul>
<li>比较频率学派和贝叶斯方法在变量选择结果上的异同<br />
</li>
<li>分析两种方法在不确定性量化方面的差异<br />
</li>
<li>讨论两种方法在生态学解释上的优势和局限性</li>
</ul></li>
<li><strong>生态学应用</strong>：
<ul>
<li>基于分析结果，识别影响溪流鱼类丰度的关键环境因子<br />
</li>
<li>提出溪流生态保护的具体建议<br />
</li>
<li>讨论模型结果在溪流管理决策中的应用价值</li>
</ul></li>
</ol>
<p><strong>思考题</strong>：<br />
- 在什么情况下贝叶斯方法比频率学派方法更适合生态学研究？<br />
- 如何合理设置贝叶斯分析中的先验分布？先验分布的选择对结果有多大影响？<br />
- 贝叶斯模型平均与频率学派的模型平均有何异同？</p>
</div>
<div id="练习三模型评估在生态保护决策中的应用" class="section level3 hasAnchor" number="9.6.3">
<h3><span class="header-section-number">9.6.3</span> 练习三：模型评估在生态保护决策中的应用<a href="模型选择与评估.html#练习三模型评估在生态保护决策中的应用" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>背景</strong>：某自然保护区需要制定鸟类保护策略，你负责构建鸟类丰富度预测模型来指导保护决策。你拥有该保护区过去5年的鸟类调查数据，以及详细的生境特征数据。</p>
<p><strong>任务</strong>：</p>
<ol style="list-style-type: decimal">
<li><strong>模型构建与选择</strong>：
<ul>
<li>构建多个候选模型预测鸟类丰富度<br />
</li>
<li>使用信息准则选择最优模型<br />
</li>
<li>解释最优模型的生态学意义</li>
</ul></li>
<li><strong>内部验证</strong>：
<ul>
<li>使用k折交叉验证评估模型泛化能力<br />
</li>
<li>分析模型在不同数据子集上的稳定性<br />
</li>
<li>识别潜在的过度拟合问题</li>
</ul></li>
<li><strong>外部验证</strong>：
<ul>
<li>使用邻近保护区的独立数据验证模型<br />
</li>
<li>分析模型的空间普适性<br />
</li>
<li>识别模型的边界条件和适用范围</li>
</ul></li>
<li><strong>不确定性量化</strong>：
<ul>
<li>计算预测置信区间<br />
</li>
<li>使用Bootstrap方法量化预测不确定性<br />
</li>
<li>分析不确定性来源（参数估计、模型选择、生态系统变异）</li>
</ul></li>
<li><strong>保护决策支持</strong>：
<ul>
<li>基于模型预测识别保护优先区域<br />
</li>
<li>评估不同管理措施对鸟类丰富度的潜在影响<br />
</li>
<li>制定基于模型证据的保护策略<br />
</li>
<li>明确模型预测的局限性和不确定性</li>
</ul></li>
</ol>
<p><strong>思考题</strong>：<br />
- 在向保护区管理者汇报模型结果时，你会如何平衡模型的预测精度和不确定性？<br />
- 如果外部验证显示模型在新区域表现不佳，你会如何调整保护策略？<br />
- 如何将模型评估结果转化为具体的、可操作的保护管理建议？</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="线性回归模型.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="高级回归模型.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": false,
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["ecological-statistics.pdf", "ecological-statistics.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
