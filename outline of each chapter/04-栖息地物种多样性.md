
## 第4课：栖息地物种多样性

### 生态学背景
不同栖息地类型的物种多样性差异很大。我们需要比较森林、草地、湿地三种生境中的物种数量，这种多组数据的管理需要用到列表结构。

### 演示数据
```r
# 不同栖息地的物种数量调查（每个生境调查了4个样点）
forest_species <- c(25, 30, 28, 32)
grassland_species <- c(15, 18, 20, 16)  
wetland_species <- c(12, 14, 11, 13)
```

### 课堂演示过程
```r
# 1. 创建各栖息地物种数据
forest_species <- c(25, 30, 28, 32)
grassland_species <- c(15, 18, 20, 16)  
wetland_species <- c(12, 14, 11, 13)

# 2. 创建栖息地数据列表
habitats <- list(
  forest = forest_species,
  grassland = grassland_species,  
  wetland = wetland_species
)

# 3. 查看列表内容
habitats
str(habitats)  # 查看列表结构

# 4. 访问列表中的元素
habitats$forest      # 使用$访问
habitats[["forest"]] # 使用[[]]访问
habitats[[1]]        # 使用位置索引

# 5. 计算各生境的平均物种数
forest_mean <- mean(habitats$forest)
grassland_mean <- mean(habitats$grassland)
wetland_mean <- mean(habitats$wetland)

# 6. 创建结果向量
habitat_means <- c(forest_mean, grassland_mean, wetland_mean)
names(habitat_means) <- c("森林", "草地", "湿地")

# 7. 比较结果
habitat_means
max(habitat_means)  # 哪个生境物种最多
which.max(habitat_means)  # 物种最多的生境位置
```

### R语言知识点详解

#### 1. 列表（List）数据结构
- **是什么**：R中最灵活的数据结构，可以存储不同类型、不同长度的数据
- **语法**：`list(名称1 = 数据1, 名称2 = 数据2, ...)`
- **核心特点**：
  - 每个元素可以是不同的数据类型（向量、数据框、甚至其他列表）
  - 每个元素可以有不同的长度
  - 元素可以有名称，也可以没有
  - 是递归数据结构（可以包含其他列表）
- **与向量、数据框的区别**：
  - 向量：同类型，一维
  - 数据框：不同列可以不同类型，但同列必须同类型，二维表格
  - 列表：最灵活，可以存储任何类型的R对象

#### 2. 列表元素访问方法
##### 美元符号 `$` 访问（推荐）
- **语法**：`列表名$元素名`
- **特点**：
  - 最直观、最常用的方法
  - 只能用于有名称的元素
  - 支持RStudio中的自动补全
  - 返回元素的原始类型

##### 双括号 `[[]]` 访问
- **语法**：`列表名[["元素名"]]` 或 `列表名[[位置]]`
- **特点**：
  - 更灵活，可以使用变量作为索引
  - 可以使用数字位置索引
  - 返回元素的原始类型
- **示例**：
  ```r
  element_name <- "forest"
  habitats[[element_name]]  # 使用变量
  habitats[[1]]             # 使用位置
  ```

##### 单括号 `[]` 访问
- **语法**：`列表名[元素名或位置]`
- **特点**：返回包含该元素的子列表（仍然是列表类型）
- **与[[]]的区别**：
  - `habitats[1]` 返回包含第一个元素的列表
  - `habitats[[1]]` 返回第一个元素本身（向量）

#### 3. 向量命名系统
##### `names()` 函数
- **作用**：为向量的每个元素分配名称
- **语法**：`names(向量) <- c("名称1", "名称2", ...)`
- **好处**：
  - 增加数据的可读性
  - 便于后续的数据访问和处理
  - 在图表中自动显示有意义的标签
- **应用**：
  ```r
  # 创建时命名
  scores <- c(数学 = 95, 英语 = 88, 物理 = 92)
  
  # 后续命名
  scores <- c(95, 88, 92)
  names(scores) <- c("数学", "英语", "物理")
  ```

#### 4. 比较和查找函数
##### `max()` 和 `min()`
- **作用**：找到向量中的最大值或最小值
- **语法**：`max(x, na.rm = FALSE)`
- **参数**：`na.rm` 控制是否忽略缺失值

##### `which.max()` 和 `which.min()`
- **作用**：返回最大值或最小值的**位置索引**
- **语法**：`which.max(x)`
- **返回值**：整数，表示最大值在向量中的位置
- **应用场景**：找到最优样地、最佳条件等
- **注意**：如果有多个相同的最大值，只返回第一个的位置

#### 5. 数据组织策略
- **何时使用列表**：
  - 存储相关但结构不同的数据
  - 分组存储实验数据
  - 存储分析结果的不同组成部分
- **命名的重要性**：
  - 提高代码可读性
  - 便于数据访问
  - 减少错误发生
- **最佳实践**：
  - 使用有意义的名称
  - 保持命名风格一致
  - 适当添加注释说明数据来源

### 课后练习
**题目**：某保护区三个监测站的哺乳动物目击次数：
```r
station_a <- c(8, 12, 6, 10)
station_b <- c(15, 18, 14, 16)
station_c <- c(3, 5, 2, 4)
```

请完成（使用向量、列表、命名等已学内容）：
1. 将三个监测站的数据组织成一个列表（使用list()函数）
2. 计算每个监测站的平均目击次数（使用mean()和列表访问）
3. 创建一个命名向量显示三个站点的平均值（使用names()函数）
4. 找出哪个监测站的平均目击次数最高（使用which.max()函数）
5. 计算所有监测站的总目击次数（使用sum()和向量合并）
6. 创建一个数据框，包含站点名称和对应的平均目击次数
7. 比较站点A和站点B的数据变异程度（使用sd()函数计算标准差）
