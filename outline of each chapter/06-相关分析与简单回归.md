## 第06课：相关分析与回归分析

### 生态学背景
在生态学研究中，理解环境因子与生物响应之间的定量关系是核心问题之一。例如，温度如何影响植物的生长速率？降雨量与物种多样性之间存在怎样的关系？海拔高度对鸟类群落结构有什么影响？相关分析和简单回归为这些问题提供了统计工具，帮助我们量化变量间的线性关系强度和预测能力。

### 演示数据
```r
# 某山地生态系统海拔梯度调查数据
set.seed(123)
elevation_gradient <- data.frame(
  site_id = paste0("S", sprintf("%02d", 1:30)),
  elevation = seq(1000, 2900, by = 100) + rnorm(30, 0, 50),
  temperature = 20 - 0.006 * seq(1000, 2900, by = 100) + rnorm(30, 0, 1.5),
  species_richness = 25 + 0.01 * seq(1000, 2900, by = 100) - 0.000003 * seq(1000, 2900, by = 100)^2 + rnorm(30, 0, 3),
  soil_ph = 6.5 + 0.0003 * seq(1000, 2900, by = 100) + rnorm(30, 0, 0.3),
  biomass_kg_ha = 150 - 0.03 * seq(1000, 2900, by = 100) + rnorm(30, 0, 15)
)
```

### 课堂演示过程

#### 1. 相关分析基础
```r
# 创建海拔梯度数据
set.seed(123)
elevation_data <- data.frame(
  elevation = seq(1000, 2500, by = 100),
  temperature = 20 - 0.006 * seq(1000, 2500, by = 100) + rnorm(16, 0, 1),
  species_count = 15 + 0.008 * seq(1000, 2500, by = 100) + rnorm(16, 0, 2)
)

# 1. 计算相关系数
cor_temp_elev <- cor(elevation_data$elevation, elevation_data$temperature)
cor_species_elev <- cor(elevation_data$elevation, elevation_data$species_count)
cor_temp_species <- cor(elevation_data$temperature, elevation_data$species_count)

print(paste("海拔与温度相关性:", round(cor_temp_elev, 3)))
print(paste("海拔与物种数相关性:", round(cor_species_elev, 3)))
print(paste("温度与物种数相关性:", round(cor_temp_species, 3)))

# 2. 相关性显著性检验
cor.test(elevation_data$elevation, elevation_data$temperature)
cor.test(elevation_data$elevation, elevation_data$species_count)

# 3. 相关矩阵计算
cor_matrix <- cor(elevation_data[, c("elevation", "temperature", "species_count")])
print(cor_matrix)
```

#### 2. 散点图与相关性可视化
```r
# 基础散点图
plot(elevation_data$elevation, elevation_data$temperature,
     xlab = "海拔 (m)", ylab = "温度 (°C)",
     main = "海拔与温度关系",
     pch = 19, col = "blue")

# 添加相关系数到图上
text(1200, 18, paste("r =", round(cor_temp_elev, 3)), pos = 4)

# 多个变量的散点图矩阵
pairs(elevation_data[, c("elevation", "temperature", "species_count")],
      main = "变量间关系矩阵")
```

#### 3. 简单线性回归分析
```r
# 1. 建立回归模型
temp_model <- lm(temperature ~ elevation, data = elevation_data)
species_model <- lm(species_count ~ elevation, data = elevation_data)

# 2. 查看回归结果
summary(temp_model)
summary(species_model)

# 3. 提取重要信息
temp_r_squared <- summary(temp_model)$r.squared
temp_p_value <- summary(temp_model)$coefficients[2, 4]
temp_slope <- coef(temp_model)[2]
temp_intercept <- coef(temp_model)[1]

print(paste("温度模型 R² =", round(temp_r_squared, 3)))
print(paste("斜率 =", round(temp_slope, 6), "°C/m"))
print(paste("p值 =", round(temp_p_value, 6)))
```

#### 4. 回归线绘制和预测
```r
# 绘制回归线
plot(elevation_data$elevation, elevation_data$temperature,
     xlab = "海拔 (m)", ylab = "温度 (°C)",
     main = "海拔与温度线性关系",
     pch = 19, col = "blue")

# 添加回归线
abline(temp_model, col = "red", lwd = 2)

# 添加回归方程
equation <- paste("温度 =", round(temp_intercept, 2), "+", 
                 round(temp_slope, 6), "× 海拔")
text(1200, 18, equation, pos = 4, col = "red")
text(1200, 17, paste("R² =", round(temp_r_squared, 3)), pos = 4, col = "red")

# 进行预测
new_elevations <- data.frame(elevation = c(1800, 2200, 2600))
predicted_temps <- predict(temp_model, new_elevations, interval = "prediction")
print(predicted_temps)
```

#### 5. 回归诊断
```r
# 1. 残差分析
par(mfrow = c(2, 2))

# 残差vs拟合值图
plot(fitted(temp_model), residuals(temp_model),
     xlab = "拟合值", ylab = "残差",
     main = "残差vs拟合值")
abline(h = 0, col = "red", lty = 2)

# Q-Q图检验正态性
qqnorm(residuals(temp_model), main = "残差Q-Q图")
qqline(residuals(temp_model), col = "red")

# 残差直方图
hist(residuals(temp_model), main = "残差分布", 
     xlab = "残差", breaks = 8, col = "lightblue")

# 残差vs海拔图
plot(elevation_data$elevation, residuals(temp_model),
     xlab = "海拔", ylab = "残差",
     main = "残差vs海拔")
abline(h = 0, col = "red", lty = 2)

par(mfrow = c(1, 1))

# 2. 正态性检验
shapiro.test(residuals(temp_model))

# 3. 模型诊断图（R内置）
plot(temp_model)
```

### R语言知识点详解

#### 1. 相关分析深入

##### 皮尔逊相关系数
- **适用条件**：
  - 变量为连续型数据
  - 变量呈线性关系
  - 数据近似正态分布
- **解释**：
  - r = 1: 完全正相关
  - r = -1: 完全负相关
  - r = 0: 无线性相关
  - |r| > 0.7: 强相关
  - 0.3 < |r| < 0.7: 中等相关
  - |r| < 0.3: 弱相关

##### `cor.test()` 函数详解
- **语法**：`cor.test(x, y, method = "pearson", alternative = "two.sided")`
- **参数说明**：
  - `method`: "pearson", "spearman", "kendall"
  - `alternative`: "two.sided", "greater", "less"
  - `conf.level`: 置信水平，默认0.95
- **输出解释**：
  - t统计量和p值
  - 相关系数及其置信区间
  - 原假设：真实相关系数等于0

##### 非参数相关
- **Spearman等级相关**：
  - 适用于单调关系（不一定线性）
  - 对异常值稳健
  - 适用于有序分类数据
- **Kendall相关**：
  - 基于秩次一致性
  - 样本量小时更稳健
  - 解释更直观

#### 2. 简单线性回归深入

##### 回归模型假设
1. **线性关系**：Y与X之间存在线性关系
2. **独立性**：观察值之间相互独立
3. **同方差性**：残差方差恒定
4. **正态性**：残差服从正态分布
5. **无多重共线性**：（多元回归时）

##### `lm()` 函数详解
- **语法**：`lm(formula, data, subset, weights, na.action)`
- **公式语法**：
  - `y ~ x`: 简单线性回归
  - `y ~ x + 0`: 通过原点的回归
  - `y ~ I(x^2)`: 二次项回归
  - `y ~ log(x)`: 对数变换

##### 回归结果解读
- **Coefficients表**：
  - Estimate: 系数估计值
  - Std. Error: 标准误
  - t value: t统计量
  - Pr(>|t|): p值
- **模型拟合度**：
  - Multiple R-squared: 决定系数
  - Adjusted R-squared: 调整决定系数
  - F-statistic: F检验统计量
  - p-value: 模型整体显著性

#### 3. 回归诊断技术

##### 残差分析
- **残差vs拟合值图**：
  - 检查线性关系假设
  - 发现异方差问题
  - 识别异常值
- **Q-Q图**：
  - 检验残差正态性
  - 点应沿直线分布
  - 偏离直线表示非正态

##### 影响点识别
- **杠杆值(Leverage)**：衡量X值的极端程度
- **Cook距离**：衡量观测点对回归的影响
- **标准化残差**：标准化的残差值

#### 4. 预测与置信区间

##### `predict()` 函数高级用法
- **置信区间类型**：
  - `interval = "confidence"`: 均值的置信区间
  - `interval = "prediction"`: 个体预测区间
- **置信水平**：通过`level`参数控制

##### 预测精度评估
- **均方误差(MSE)**：`mean(residuals(model)^2)`
- **均方根误差(RMSE)**：`sqrt(MSE)`
- **平均绝对误差(MAE)**：`mean(abs(residuals(model)))`

#### 5. 模型比较和选择

##### 模型拟合度指标
- **AIC (Akaike Information Criterion)**：
  - AIC = -2log(L) + 2k
  - 越小越好
  - 平衡拟合度和复杂度
- **BIC (Bayesian Information Criterion)**：
  - BIC = -2log(L) + k*log(n)
  - 对复杂度惩罚更严格

##### 模型验证方法
- **交叉验证**：留一法、k折交叉验证
- **训练-测试分割**：随机分割数据集
- **引导法(Bootstrap)**：重复抽样验证

### 课后练习

**题目**：某湿地生态系统水质与鸟类多样性关系研究数据：
```r
wetland_study <- data.frame(
  site = paste0("W", 1:20),
  water_clarity = c(2.1, 3.5, 1.8, 4.2, 2.9, 3.8, 1.5, 4.5, 2.3, 3.1,
                   4.0, 2.7, 3.3, 1.9, 4.1, 2.5, 3.6, 2.0, 4.3, 2.8),
  bird_diversity = c(1.2, 1.8, 1.0, 2.1, 1.5, 1.9, 0.9, 2.3, 1.3, 1.6,
                    2.0, 1.4, 1.7, 1.1, 2.2, 1.3, 1.8, 1.2, 2.4, 1.5),
  ph_value = c(7.2, 7.8, 6.9, 8.1, 7.5, 7.9, 6.8, 8.2, 7.3, 7.6,
              8.0, 7.4, 7.7, 7.0, 8.1, 7.3, 7.8, 7.1, 8.3, 7.5)
)
```

请完成以下分析（使用相关分析、线性回归等本课内容）：

1. **相关分析**：
   - 计算水体透明度与鸟类多样性的皮尔逊相关系数
   - 进行相关性显著性检验
   - 计算所有变量间的相关矩阵

2. **回归建模**：
   - 建立鸟类多样性对水体透明度的简单线性回归模型
   - 解释回归系数的生态学意义
   - 报告模型的R²和p值

3. **可视化分析**：
   - 绘制水体透明度与鸟类多样性的散点图
   - 添加回归线和回归方程
   - 创建变量间关系的散点图矩阵

4. **模型诊断**：
   - 进行残差分析，检查模型假设
   - 绘制残差诊断图
   - 检验残差的正态性

5. **预测应用**：
   - 预测透明度为3.0和4.0时的鸟类多样性
   - 计算预测的置信区间
   - 讨论预测结果的可靠性

6. **结果解释**：
   - 从生态学角度解释水质与鸟类多样性的关系
   - 讨论该模型在湿地管理中的应用价值
   - 指出研究的局限性和改进方向

7. **扩展分析**：
   - 探索pH值与其他变量的关系
   - 比较不同相关方法（Pearson vs Spearman）的结果
   - 识别可能的异常值及其对结果的影响

### 多元线性回归

### 生态学背景
在现实的生态系统中，生物响应往往受到多个环境因子的同时影响。例如，植物的生长不仅受到温度的影响，还受到降水量、土壤养分、光照强度等多个因子的共同作用。单一变量的简单回归往往无法充分解释生态现象的复杂性。多元线性回归允许我们同时考虑多个预测变量，建立更现实、更准确的生态学预测模型，并量化各个环境因子的相对重要性。

### 演示数据
```r
# 某森林生态系统植物生产力影响因子研究
set.seed(123)
forest_productivity <- data.frame(
  plot_id = paste0("P", sprintf("%02d", 1:50)),
  # 响应变量：植物净初级生产力 (g/m²/year)
  npp = 800 + 15 * rnorm(50, 15, 3) + 8 * rnorm(50, 25, 5) + 
        12 * rnorm(50, 6.5, 0.5) - 3 * rnorm(50, 1200, 200) + rnorm(50, 0, 50),
  # 预测变量
  temperature = rnorm(50, 15, 3),          # 年平均温度 (°C)
  precipitation = rnorm(50, 1200, 200),    # 年降水量 (mm)
  soil_nitrogen = rnorm(50, 25, 5),        # 土壤氮含量 (mg/kg)
  soil_ph = rnorm(50, 6.5, 0.5),         # 土壤pH值
  elevation = rnorm(50, 1500, 300),        # 海拔 (m)
  canopy_cover = rnorm(50, 75, 15)         # 冠层覆盖度 (%)
)

# 确保数据在合理范围内
forest_productivity$npp[forest_productivity$npp < 400] <- 400
forest_productivity$canopy_cover[forest_productivity$canopy_cover > 100] <- 100
forest_productivity$canopy_cover[forest_productivity$canopy_cover < 30] <- 30
```

### 课堂演示过程

#### 6. 多元回归模型建立
```r
# 创建简化的示例数据
set.seed(123)
plant_data <- data.frame(
  biomass = 100 + 2*rnorm(30, 20, 3) + 1.5*rnorm(30, 800, 100) + 
            3*rnorm(30, 6.8, 0.4) + rnorm(30, 0, 8),
  temperature = rnorm(30, 20, 3),
  rainfall = rnorm(30, 800, 100), 
  soil_ph = rnorm(30, 6.8, 0.4)
)

# 1. 建立多元线性回归模型
full_model <- lm(biomass ~ temperature + rainfall + soil_ph, data = plant_data)
summary(full_model)

# 2. 查看模型系数
coef(full_model)

# 3. 检查各预测变量的显著性
summary(full_model)$coefficients

# 4. 模型整体显著性检验
anova(full_model)
```

#### 7. 相关性和多重共线性检查
```r
# 1. 预测变量间相关性矩阵
predictors <- plant_data[, c("temperature", "rainfall", "soil_ph")]
cor_matrix <- cor(predictors)
print(cor_matrix)

# 2. 相关性可视化
pairs(predictors, main = "预测变量间相关性")

# 3. 方差膨胀因子（VIF）检查多重共线性
# 安装和加载car包
# install.packages("car")
library(car)
vif(full_model)

# VIF解释：
# VIF < 5: 无严重多重共线性问题
# 5 ≤ VIF < 10: 中等多重共线性
# VIF ≥ 10: 严重多重共线性

# 4. 条件数检查
X <- model.matrix(full_model)[, -1]  # 移除截距列
condition_number <- kappa(cor(X))
print(paste("条件数:", round(condition_number, 2)))
```

#### 8. 模型选择与比较
```r
# 1. 向前选择法
null_model <- lm(biomass ~ 1, data = plant_data)
forward_model <- step(null_model, 
                     scope = list(lower = null_model, 
                                 upper = full_model),
                     direction = "forward")

# 2. 向后消除法
backward_model <- step(full_model, direction = "backward")

# 3. 双向选择法
both_model <- step(null_model, 
                  scope = list(lower = null_model, 
                              upper = full_model),
                  direction = "both")

# 4. 比较不同模型
AIC(full_model, forward_model, backward_model, both_model)
BIC(full_model, forward_model, backward_model, both_model)

# 5. 嵌套模型比较（F检验）
# 比较简化模型vs完整模型
reduced_model <- lm(biomass ~ temperature + soil_ph, data = plant_data)
anova(reduced_model, full_model)
```

#### 9. 模型诊断
```r
# 1. 残差分析
par(mfrow = c(2, 2))

# 残差vs拟合值
plot(fitted(full_model), residuals(full_model),
     xlab = "拟合值", ylab = "残差",
     main = "残差vs拟合值")
abline(h = 0, col = "red", lty = 2)

# Q-Q图
qqnorm(residuals(full_model), main = "残差Q-Q图")
qqline(residuals(full_model), col = "red")

# 标准化残差vs拟合值
plot(fitted(full_model), rstandard(full_model),
     xlab = "拟合值", ylab = "标准化残差", 
     main = "标准化残差vs拟合值")
abline(h = c(-2, 0, 2), col = c("red", "black", "red"), lty = c(2, 1, 2))

# Cook距离
plot(cooks.distance(full_model), type = "h",
     ylab = "Cook距离", main = "影响点分析")
abline(h = 4/(nrow(plant_data)-length(coef(full_model))), col = "red", lty = 2)

par(mfrow = c(1, 1))

# 2. 正态性检验
shapiro.test(residuals(full_model))

# 3. 同方差性检验（Breusch-Pagan检验）
library(lmtest)
bptest(full_model)

# 4. 独立性检验（Durbin-Watson检验）
dwtest(full_model)
```

#### 10. 预测和解释
```r
# 1. 模型预测
new_data <- data.frame(
  temperature = c(18, 22, 25),
  rainfall = c(750, 900, 1000),
  soil_ph = c(6.5, 7.0, 7.2)
)

# 点预测
predictions <- predict(full_model, new_data)
print(predictions)

# 置信区间和预测区间
conf_pred <- predict(full_model, new_data, interval = "confidence")
pred_intervals <- predict(full_model, new_data, interval = "prediction")

print("置信区间:")
print(conf_pred)
print("预测区间:")
print(pred_intervals)

# 2. 标准化系数（相对重要性）
# 标准化数据
standardized_data <- data.frame(scale(plant_data))
std_model <- lm(biomass ~ temperature + rainfall + soil_ph, 
                data = standardized_data)
std_coef <- coef(std_model)[-1]  # 移除截距
print("标准化系数:")
print(std_coef)

# 3. 偏相关系数
library(ppcor)
partial_cor <- pcor(plant_data[, c("biomass", "temperature", "rainfall", "soil_ph")])
print("偏相关系数:")
print(partial_cor$estimate[1, -1])
```

### R语言知识点详解

#### 1. 多元线性回归模型

##### 模型形式
- **数学表达式**：Y = β₀ + β₁X₁ + β₂X₂ + ... + βₚXₚ + ε
- **矩阵形式**：Y = Xβ + ε
- **假设条件**：
  - 线性关系：响应变量与预测变量呈线性关系
  - 独立性：观测值相互独立
  - 同方差性：残差方差恒定
  - 正态性：残差服从正态分布
  - 无多重共线性：预测变量间无强相关

##### 参数估计
- **最小二乘法**：β̂ = (X'X)⁻¹X'Y
- **系数解释**：
  - βᵢ表示在其他变量不变的情况下，Xᵢ增加一个单位时Y的变化量
  - β₀为截距，表示所有预测变量为0时Y的预期值

#### 2. 多重共线性问题

##### 多重共线性的后果
- **系数不稳定**：小样本变化导致系数大幅波动
- **标准误增大**：降低系数显著性
- **解释困难**：难以确定各变量的独立作用

##### 诊断方法
- **相关系数矩阵**：|r| > 0.8提示可能存在共线性
- **方差膨胀因子(VIF)**：
  - VIF = 1/(1-R²ᵢ)
  - VIF > 10表示严重共线性
  - VIF > 5需要关注
- **条件数(Condition Number)**：
  - κ > 30表示严重共线性

##### 处理方法
- **删除变量**：移除冗余的预测变量
- **主成分回归**：使用主成分作为预测变量
- **岭回归**：添加正则化项
- **合并变量**：创建综合指标

#### 3. 变量选择方法

##### 逐步回归法
- **向前选择**：从空模型开始逐步添加变量
- **向后消除**：从全模型开始逐步删除变量  
- **双向选择**：结合向前和向后选择

##### `step()` 函数详解
- **语法**：`step(object, scope, direction, k)`
- **参数说明**：
  - `scope`：变量选择范围
  - `direction`：选择方向("forward", "backward", "both")
  - `k`：惩罚系数，AIC=2，BIC=log(n)

##### 信息准则
- **AIC (Akaike Information Criterion)**：
  - 平衡拟合度和模型复杂度
  - AIC = -2log(L) + 2p
  - 越小越好
- **BIC (Bayesian Information Criterion)**：
  - 对复杂度惩罚更严格
  - BIC = -2log(L) + p*log(n)

#### 4. 模型诊断技术

##### 残差分析扩展
- **标准化残差**：rᵢ = eᵢ/√(MSE(1-hᵢᵢ))
- **学生化残差**：考虑删除第i个观测后的残差
- **杠杆值**：hᵢᵢ = x'ᵢ(X'X)⁻¹xᵢ
- **Cook距离**：Dᵢ = (r²ᵢ/(p+1)) * (hᵢᵢ/(1-hᵢᵢ))

##### 假设检验
- **正态性检验**：
  - Shapiro-Wilk检验：`shapiro.test()`
  - Anderson-Darling检验
  - Kolmogorov-Smirnov检验
- **同方差性检验**：
  - Breusch-Pagan检验：`bptest()`
  - White检验
  - 残差图目视检查
- **独立性检验**：
  - Durbin-Watson检验：`dwtest()`
  - Ljung-Box检验

#### 5. 模型解释与应用

##### 系数解释
- **原始系数**：实际单位的影响大小
- **标准化系数**：相对重要性比较
- **弹性系数**：百分比变化的影响

##### 预测评估
- **模型拟合度**：
  - R²：决定系数
  - 调整R²：考虑变量数量的修正
  - F统计量：模型整体显著性
- **预测精度**：
  - RMSE：均方根误差
  - MAE：平均绝对误差
  - MAPE：平均绝对百分比误差

##### 变量重要性
- **标准化回归系数**：β*ᵢ = βᵢ * (sₓᵢ/sᵧ)
- **偏相关系数**：控制其他变量后的相关性
- **增量R²**：单个变量的独特贡献

#### 6. 结构方程模型简介

##### SEM与回归的关系
结构方程模型（Structural Equation Modeling, SEM）本质上是多个回归方程的联立系统，扩展了多元回归的概念：

```r
# SEM模型示例 - 多个回归方程的系统
# 直接效应路径（类似于多元回归）
plant_growth ~ temperature + soil_moisture + nutrients

# 间接效应路径（中介关系）
soil_moisture ~ precipitation + topography
nutrients ~ decomposition_rate + soil_type

# 相关关系（变量间协变）
temperature ~~ precipitation
```

##### 基本概念
- **测量模型**：潜变量与观测指标的关系（验证性因子分析）
- **结构模型**：变量间的因果关系路径（路径分析）
- **路径系数**：类似于回归系数，表示标准化影响强度
- **拟合指标**：χ²、CFI、RMSEA等评估模型与数据的匹配程度

##### R语言实现
```r
# 使用lavaan包进行SEM分析
# install.packages("lavaan")
library(lavaan)

# 定义SEM模型
sem_model <- '
  # 测量模型（潜变量）
  climate =~ temperature + precipitation + humidity
  soil_quality =~ organic_matter + ph + nutrients
  
  # 结构模型（路径分析）
  plant_biomass ~ climate + soil_quality + elevation
  biodiversity ~ plant_biomass + climate + disturbance
  
  # 变量间协变关系
  climate ~~ soil_quality
  elevation ~~ climate
'

# 拟合模型
sem_fit <- sem(sem_model, data = ecosystem_data)

# 查看详细结果
summary(sem_fit, standardized = TRUE, fit.measures = TRUE, rsq = TRUE)

# 路径图可视化
library(semPlot)
semPaths(sem_fit, what = "std", layout = "tree", 
         style = "lisrel", edge.label.cex = 0.8)

# 模型修正建议
modificationIndices(sem_fit, sort = TRUE)
```

##### 生态学应用优势
1. **处理复杂因果关系**：同时分析直接、间接和总效应
2. **整合潜变量**：处理无法直接测量的生态概念（如"环境压力"）
3. **模型验证**：通过拟合指标检验生态理论模型
4. **中介效应分析**：量化生态过程中的间接影响路径

##### 典型应用案例
- 气候变化对生态系统服务的多路径影响机制
- 生物多样性-生态系统功能关系的网络分析
- 景观格局与生态过程的耦合关系研究
- 人类干扰生态系统的恢复力与阈值分析

##### 注意事项
- 需要较大的样本量（通常n > 200）
- 模型设定需要坚实的理论基础
- 解释结果时需谨慎因果推断
- 适合探索性分析后的验证性建模

### 课后练习

**题目**：某草原生态系统植被生物量影响因子研究数据：
```r
grassland_study <- data.frame(
  site_id = paste0("G", 1:40),
  biomass = c(145, 178, 132, 198, 156, 189, 167, 143, 201, 174,
             188, 159, 176, 134, 192, 161, 183, 149, 196, 171,
             157, 185, 141, 203, 168, 179, 153, 187, 165, 194,
             172, 181, 147, 199, 163, 175, 139, 191, 169, 177),
  temperature = c(12.5, 15.2, 11.8, 16.1, 13.7, 15.8, 14.3, 12.1, 16.5, 14.9,
                 15.6, 13.4, 14.7, 11.9, 15.9, 13.8, 15.3, 12.6, 16.2, 14.5,
                 13.2, 15.4, 12.3, 16.7, 14.1, 14.8, 13.0, 15.7, 14.0, 16.0,
                 14.6, 15.1, 12.4, 16.3, 13.9, 14.7, 11.7, 15.8, 14.2, 14.9),
  precipitation = c(380, 450, 320, 510, 410, 480, 430, 350, 520, 460,
                   490, 400, 470, 330, 500, 420, 485, 370, 515, 445,
                   395, 475, 340, 525, 415, 465, 385, 495, 425, 505,
                   455, 485, 360, 518, 405, 470, 315, 500, 435, 475),
  soil_organic = c(2.1, 2.8, 1.9, 3.2, 2.4, 3.0, 2.6, 2.0, 3.4, 2.7,
                  3.1, 2.3, 2.9, 1.8, 3.3, 2.5, 3.0, 2.2, 3.2, 2.6,
                  2.4, 3.0, 2.0, 3.5, 2.5, 2.8, 2.3, 3.1, 2.6, 3.3,
                  2.7, 3.0, 2.1, 3.4, 2.4, 2.9, 1.7, 3.2, 2.6, 2.8),
  elevation = c(1150, 1380, 1020, 1450, 1250, 1420, 1320, 1080, 1480, 1350,
               1410, 1200, 1370, 1050, 1440, 1280, 1400, 1120, 1460, 1340,
               1230, 1390, 1090, 1490, 1300, 1360, 1180, 1430, 1270, 1470,
               1330, 1395, 1110, 1465, 1260, 1375, 1040, 1445, 1310, 1385)
)
```

请完成以下多元回归分析（使用多元线性回归方法）：

1. **探索性数据分析**：
   - 计算所有变量的描述性统计
   - 创建变量间的相关系数矩阵和散点图矩阵
   - 识别可能的异常值

2. **多元回归建模**：
   - 建立生物量对所有环境变量的完整多元回归模型
   - 解释各回归系数的生态学意义
   - 评估模型的整体显著性和拟合度

3. **多重共线性诊断**：
   - 计算各预测变量的方差膨胀因子(VIF)
   - 分析预测变量间的相关性
   - 判断是否存在多重共线性问题

4. **模型选择**：
   - 使用向前选择、向后消除和双向选择方法
   - 比较不同模型的AIC和BIC值
   - 选择最优模型并说明理由

5. **模型诊断**：
   - 绘制残差诊断图（残差vs拟合值、Q-Q图等）
   - 检验残差的正态性、同方差性和独立性
   - 识别异常值和高影响点

6. **模型解释与应用**：
   - 计算标准化回归系数，比较各变量的相对重要性
   - 进行模型预测，计算置信区间和预测区间
   - 从生态学角度解释模型结果

7. **结果报告**：
   - 撰写模型结果的统计报告
   - 讨论各环境因子对草原生物量的影响机制
   - 提出模型的应用价值和局限性

8. **扩展分析**：
   - 探索变量间可能的交互作用
   - 尝试非线性变换（如对数变换）
   - 比较简单回归与多元回归的预测效果
