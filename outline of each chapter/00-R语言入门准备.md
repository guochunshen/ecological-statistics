# 第0课：R语言入门准备

## 学习目标
- 理解为什么生态学专业需要学习R语言
- 掌握R和RStudio的安装和配置
- 建立良好的项目文件组织习惯
- 了解R包管理的基本方法

---

## 为什么生态学专业需要学习R？

### 1. 数据分析能力的必要性
现代生态学研究产生海量数据：野外调查数据、实验室测量数据、遥感影像数据、基因序列数据等。传统的Excel已无法满足复杂的统计分析需求，而R语言提供了完整的数据科学工具链。

### 2. 可重现研究的科学要求
- **重现性危机**：越来越多的科学研究无法被重现，影响科学可信度
- **R脚本的优势**：每一步分析都有记录，任何人都可以重现你的分析过程
- **错误检查**：代码可以被审查，减少人为错误
- **版本控制**：分析过程的每次修改都有记录

### 3. 职业发展的核心竞争力
- **学术界要求**：顶级期刊越来越要求提供数据和代码
- **就业市场需求**：环保部门、研究院所、咨询公司都需要数据分析能力
- **跨学科合作**：与计算机科学、统计学等领域合作的桥梁
- **终身学习**：编程思维有助于快速学习新的分析方法

### 4. 开源免费的经济优势
- **成本优势**：SPSS单机版数万元，SAS更昂贵，R完全免费
- **功能更新**：商业软件更新缓慢，R社区每天都有新功能
- **全球社区**：遇到问题可以在全球社区寻求帮助
- **未来保障**：开源软件不会因为公司倒闭而消失

### 5. 学术发表的必要工具
- **期刊要求**：Nature、Science等顶级期刊要求提供分析代码
- **同行评议**：审稿人可以检查你的分析方法是否正确
- **引用优势**：提供代码的论文被引用次数更高
- **学术诚信**：透明的分析过程展现严谨的科学态度

### 6. 国际交流的通用语言
- **国际会议**：生态学国际会议上，R是数据分析的主流工具
- **合作研究**：与国外学者合作时，R是共同的工作语言
- **在线学习**：全球最优秀的生态学分析教程都使用R
- **职业流动**：掌握R可以在全球范围内寻求工作机会

---

## R语言简介与趣味应用

### 1. 什么是R语言？
- **统计计算语言**：专门为统计分析和数据可视化设计的编程语言
- **开源免费**：由全球统计学家共同维护发展
- **交互式环境**：可以立即看到代码执行结果
- **扩展性强**：超过18,000个专业扩展包

### 2. 如何获取帮助？
```r
# 查看函数帮助文档
?plot
help("plot")

# 搜索帮助文档
??"regression"

# 示例代码演示
example(plot)

# 在线资源：
# - R官方文档：https://cran.r-project.org/manuals.html
# - RStudio社区：https://community.rstudio.com
```

### 3. R语言的趣味应用示例

#### 生态数据动态可视化
```r
# 安装必要包(首次需要)
install.packages(c("ggplot2", "gganimate", "gapminder"))
library(ggplot2)
library(gganimate)
library(gapminder)

# 使用gapminder数据集(包含各国多年生态经济数据)
# 绘制动态变化图
ggplot(gapminder, aes(gdpPercap, lifeExp, size = pop, color = continent)) +
  geom_point() +
  scale_size(range = c(2, 12)) +
  scale_x_log10() +
  labs(title = '年份: {frame_time}', x = '人均GDP', y = '预期寿命') +
  transition_time(year) +
  ease_aes('linear')

# 提示：运行后会生成展示生态经济数据随时间变化的动画
# 可以清楚地看到不同大陆国家生态经济指标的变化趋势
```

#### 生成音乐
```r
install.packages("audio")
library(audio)

# 创建简单旋律
notes <- c("C4","D4","E4","F4","G4","A4","B4","C5")
durations <- rep(0.3, 8)

play(notes, durations)
```

#### 更多有趣功能
- **动态报告**：用R Markdown生成可交互报告
- **网络爬虫**：抓取生态监测站数据
- **地图绘制**：可视化物种分布
- **机器学习**：预测生态变化趋势

---

## 环境设置和配置

### R和RStudio安装

#### 1. 下载和安装R

**Windows系统:**
1. 访问 https://cran.r-project.org/bin/windows/base/
2. 下载最新版R安装包(.exe)
3. 右键以管理员身份运行安装程序
4. 安装路径不要包含中文或空格
5. 勾选"创建桌面快捷方式"

**macOS系统:**
1. 访问 https://cran.r-project.org/bin/macosx/
2. 下载最新版R安装包(.pkg)
3. 双击安装，可能需要右键"打开"绕过Gatekeeper限制
4. 或通过Homebrew安装: `brew install --cask r`

**Linux系统:**
- Ubuntu/Debian: `sudo apt-get install r-base`
- CentOS/RHEL: `sudo yum install R`

#### 2. 下载和安装RStudio

1. 访问 https://www.rstudio.com/products/rstudio/download/
2. 选择适合你系统的RStudio Desktop免费版
3. 安装注意事项:
   - Windows: 确保已安装R后再安装RStudio
   - macOS: 可能需要允许来自"未识别开发者"的应用
   - Linux: 可能需要安装依赖库`libssl-dev`等

#### 3. 常见安装问题解决

- **中文路径问题**: 安装路径和用户名不要包含中文
- **防火墙拦截**: 临时关闭防火墙或添加R/RStudio为例外
- **镜像源设置**: 安装后运行:
  ```r
  options(repos = c(CRAN="https://mirrors.tuna.tsinghua.edu.cn/CRAN/"))
  ```
- **依赖缺失**: 
  - Windows: 安装Rtools
  - macOS: 安装Xcode命令行工具
  - Linux: 安装开发工具链

#### 4. 验证安装
```r
# 在RStudio中运行这行代码，应该显示R的版本信息
R.version.string

# 检查基本功能是否正常
1+1
plot(1:10)
```

### 项目文件夹结构设置
建立良好的文件组织习惯是数据分析的基础：

```
生态学R语言课程/
├── 第01课-森林调查/
│   ├── 数据/
│   ├── 脚本/
│   └── 结果/
├── 第02课-物种名称/
│   ├── 数据/
│   ├── 脚本/
│   └── 结果/
├── ...
└── 参考资料/
```

### 基本包管理

#### 1. R包的概念
- **什么是R包**：R包是扩展R功能的代码、数据和文档集合
- **包的作用**：提供专业统计方法、可视化工具、数据导入等功能
- **生态学常用包**：vegan(群落分析)、ggplot2(可视化)、dplyr(数据处理)等

#### 2. Rtools的作用
- **Windows专用**：用于编译需要C/C++/Fortran代码的R包
- **适用场景**：
  - 安装需要编译的包(如部分生态学模型包)
  - 开发自己的R包
  - 使用某些高性能计算功能
- **安装方法**：从CRAN下载对应R版本的Rtools安装包

#### 3. 包管理基础
```r
# 检查已安装的包
installed.packages()

# 安装新包(从CRAN)
install.packages("ggplot2") 

# 从GitHub安装开发版包
# install.packages("devtools")
# devtools::install_github("作者/包名")

# 加载包
library(ggplot2)

# 更新所有包
update.packages()

# 查看包帮助文档
help(package="ggplot2")
```

#### 4. 如何寻找合适的包
- **CRAN任务视图**：https://cran.r-project.org/web/views/
  - 如Environmetrics任务视图包含生态学相关包
- **RStudio包推荐**：通过RStudio的Packages面板浏览
- **学术文献**：参考领域内论文使用的方法和包
- **社区推荐**：R-bloggers、Stack Overflow等平台

### 工作目录设置

#### 1. 什么是工作目录？
- **简单理解**：就像你办公桌上的文件夹，R会默认从这个文件夹里找文件
- **作用**：告诉R在哪里读取数据和保存结果
- **类比**：就像在图书馆找书需要知道书架位置一样

#### 2. 为什么要设置工作目录？
- **方便管理**：所有课程文件可以分类存放
- **避免错误**：R能准确找到你的数据文件
- **提高效率**：不用每次都输入完整文件路径

#### 3. 基本操作
```r
# 查看当前工作目录(就像查看你现在在哪个文件夹)
getwd()

# 设置工作目录(告诉R使用哪个文件夹)
# 注意：路径中的斜杠方向
setwd("C:/Users/你的用户名/生态学R语言课程") 

# 列出当前目录下的文件(看看这个文件夹里有什么)
list.files()

# 小技巧：在RStudio中可以通过菜单设置工作目录更简单：
# Session → Set Working Directory → Choose Directory
```

#### 4. 注意事项
- 路径中不要有中文
- Windows系统使用正斜杠"/"或双反斜杠"\\"
- 建议为每节课创建单独的子文件夹

---

## 课前准备检查清单
- [ ] R软件安装成功
- [ ] RStudio安装成功  
- [ ] 能够运行简单的R代码
- [ ] 创建了课程文件夹结构
- [ ] 理解了学习R语言的重要性
- [ ] 准备好投入时间学习编程思维
