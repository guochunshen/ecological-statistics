
## 第5课：鸟类监测数据导入

### 生态学背景
长期鸟类监测项目通常将数据保存在Excel或CSV文件中。我们需要学会将这些外部数据导入R中进行分析，并根据研究需要筛选特定时间段的数据。

### 演示数据文件（bird_monitoring.csv）
```csv
date,month,species,count,observer
2023-03-15,3,白头鹎,12,张三
2023-03-15,3,麻雀,25,张三
2023-04-20,4,喜鹊,8,李四
2023-04-20,4,白头鹎,15,李四
2023-05-10,5,燕子,20,王五
2023-06-05,6,麻雀,18,张三
2023-06-05,6,白头鹎,22,张三
2023-07-12,7,喜鹊,10,李四
```

### 课堂演示过程
```r
# 1. 读取鸟类监测数据
bird_data <- read.csv("bird_monitoring.csv", stringsAsFactors = FALSE)

# 2. 查看数据概况
head(bird_data)     # 前几行
tail(bird_data)     # 后几行
str(bird_data)      # 数据结构
summary(bird_data)  # 数据摘要

# 3. 查看数据维度
nrow(bird_data)  # 有多少条记录
ncol(bird_data)  # 有多少个变量

# 4. 查看具体列的信息
unique(bird_data$species)   # 观察到哪些物种
unique(bird_data$observer)  # 有哪些调查员
range(bird_data$month)      # 调查的月份范围

# 5. 筛选春季数据（3-5月）
spring_birds <- subset(bird_data, month %in% c(3, 4, 5))
spring_birds

# 6. 筛选特定物种
baijitou_data <- subset(bird_data, species == "白头鹎")
baijitou_data

# 7. 条件组合筛选
spring_baijitou <- subset(bird_data, month %in% c(3, 4, 5) & species == "白头鹎")
spring_baijitou

# 8. 计算统计量
total_count <- sum(bird_data$count)
mean_count <- mean(bird_data$count)
paste("总观察个体数:", total_count, "平均每次观察:", round(mean_count, 1))
```

### R语言知识点详解

#### 1. 数据导入函数 `read.csv()`
- **作用**：从CSV（逗号分隔值）文件中读取数据，创建数据框
- **语法**：`read.csv(file, header = TRUE, sep = ",", stringsAsFactors = FALSE, ...)`
- **重要参数详解**：
  - `file`：文件路径，可以是本地文件或网络URL
  - `header = TRUE`：第一行是否为列名，默认TRUE
  - `sep = ","`：字段分隔符，CSV默认逗号
  - `stringsAsFactors = FALSE`：是否将字符串转换为因子，建议设为FALSE
  - `encoding`：文件编码，中文文件可能需要设置为"UTF-8"
- **文件路径注意事项**：
  - Windows系统使用反斜杠`\`，但R中需要转义`\\`或使用正斜杠`/`
  - 使用相对路径时，基于当前工作目录
  - 可用`getwd()`查看当前工作目录，`setwd()`设置工作目录

#### 2. 数据概览函数集
##### `summary()` - 数据摘要
- **作用**：提供每列数据的统计摘要
- **不同数据类型的摘要**：
  - 数值型：最小值、第一四分位数、中位数、均值、第三四分位数、最大值
  - 字符型：长度、类别、模式
  - 因子型：各水平的频数
- **应用价值**：快速了解数据分布、发现异常值

##### `unique()` - 唯一值
- **作用**：返回向量中的所有不重复值
- **语法**：`unique(x)`
- **应用场景**：
  - 查看分类变量的所有类别
  - 检查数据录入是否有错误（如拼写错误）
  - 了解数据的多样性
- **相关函数**：`duplicated()`检查重复值

##### `range()` - 值域范围
- **作用**：返回向量的最小值和最大值
- **语法**：`range(x, na.rm = FALSE)`
- **返回值**：长度为2的向量，c(最小值, 最大值)
- **应用**：快速了解数据的取值范围

#### 3. 数据筛选系统
##### `subset()` 函数（推荐方式）
- **作用**：根据条件筛选数据框的行
- **语法**：`subset(x, subset, select)`
- **参数详解**：
  - `x`：要筛选的数据框
  - `subset`：逻辑条件表达式
  - `select`：选择的列（可选）
- **优势**：语法简洁，不需要重复写数据框名称

##### 逻辑操作符详解
###### `%in%` 操作符
- **作用**：检查左边的值是否在右边的向量中
- **语法**：`x %in% y`
- **示例**：`month %in% c(3, 4, 5)` 检查月份是否是3、4、5中的一个
- **与 `==` 的区别**：
  - `==` 只能比较单个值
  - `%in%` 可以同时比较多个值

###### `==` 等于操作符
- **作用**：检查两个值是否相等
- **注意事项**：
  - 区分大小写：`"A" == "a"` 为FALSE
  - 精确匹配：`"cat" == "cats"` 为FALSE
  - 用于字符串时必须完全匹配

###### `&` 逻辑与操作符
- **作用**：连接多个条件，所有条件都必须为TRUE
- **语法**：`条件1 & 条件2 & ...`
- **相关操作符**：
  - `|`：逻辑或，任一条件为TRUE即可
  - `!`：逻辑非，取反

#### 4. 数值处理函数
##### `round()` - 四舍五入
- **语法**：`round(x, digits = 0)`
- **参数**：
  - `x`：要舍入的数值
  - `digits`：保留的小数位数
- **应用**：美化输出结果，控制精度

#### 5. 数据导入最佳实践
- **文件检查**：导入前先用文本编辑器查看文件格式
- **编码处理**：中文数据注意编码问题
- **数据验证**：导入后立即检查数据结构和内容
- **备份原始数据**：避免在原始数据上直接修改
- **路径管理**：使用项目文件夹，保持文件路径的一致性

### 课后练习
**题目**：假设有一个植被监测数据文件包含以下列：
- date：调查日期
- season：季节（春、夏、秋、冬）  
- plot：样地编号
- coverage：植被覆盖度(%)
- height：平均高度(cm)

请完成（使用数据导入、数据框操作、条件筛选等已学内容）：
1. 创建模拟数据或读取数据文件
2. 查看数据的基本信息（使用nrow(), ncol(), str(), summary()）
3. 筛选夏季的数据（使用subset()函数）
4. 筛选植被覆盖度大于80%的记录（使用subset()函数和条件）
5. 计算所有样地的平均植被覆盖度和平均高度（使用mean()函数）
6. 找出覆盖度最高的样地（使用which.max()函数）
7. 创建一个汇总报告（使用paste()函数）
